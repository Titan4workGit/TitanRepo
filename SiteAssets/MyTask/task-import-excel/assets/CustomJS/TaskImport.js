var a392_0x51e637=a392_0x2115;(function(_0x1ddb5b,_0x3d5412){var _0x2f002b=a392_0x2115,_0x358041=_0x1ddb5b();while(!![]){try{var _0x1e1a88=-parseInt(_0x2f002b(0x20d))/0x1*(parseInt(_0x2f002b(0x199))/0x2)+parseInt(_0x2f002b(0x1a8))/0x3*(parseInt(_0x2f002b(0x1de))/0x4)+-parseInt(_0x2f002b(0x224))/0x5*(-parseInt(_0x2f002b(0x19f))/0x6)+parseInt(_0x2f002b(0x20c))/0x7*(-parseInt(_0x2f002b(0x1d0))/0x8)+parseInt(_0x2f002b(0x1f3))/0x9+-parseInt(_0x2f002b(0x227))/0xa*(-parseInt(_0x2f002b(0x1a4))/0xb)+-parseInt(_0x2f002b(0x1f9))/0xc*(parseInt(_0x2f002b(0x1ee))/0xd);if(_0x1e1a88===_0x3d5412)break;else _0x358041['push'](_0x358041['shift']());}catch(_0x5a632e){_0x358041['push'](_0x358041['shift']());}}}(a392_0x52a1,0x2f591));var currentDlg='';$(document)[a392_0x51e637(0x205)](function(){var _0x1a9c8d=a392_0x51e637;$('#ExcelUpload')[_0x1a9c8d(0x1c5)](function(){var _0x5e65bc=_0x1a9c8d;this[_0x5e65bc(0x214)]=null;}),$(_0x1a9c8d(0x232))['change'](function(){var _0x3db11e=_0x1a9c8d;$(_0x3db11e(0x1c2))['text']('0'),$(_0x3db11e(0x1c1))['text']('0'),ReadExcel();}),$(_0x1a9c8d(0x1b4))[_0x1a9c8d(0x1c5)](function(_0x21bd63){var _0x4fbb83=_0x1a9c8d,_0x559998=$(_0x21bd63[_0x4fbb83(0x22e)])['closest'](_0x4fbb83(0x1f4));$('td\x20input:checkbox',_0x559998)[_0x4fbb83(0x1b6)](_0x4fbb83(0x1b2),this[_0x4fbb83(0x1b2)]),this[_0x4fbb83(0x1b2)]==!![]?$('tr',_0x559998)[_0x4fbb83(0x244)](_0x4fbb83(0x1e3)):$('tr',_0x559998)[_0x4fbb83(0x1d2)](_0x4fbb83(0x1e3)),this[_0x4fbb83(0x1b2)]==!![]?$('#txtSelectedRows')['text']($('td\x20.ExcelRow:checkbox:checked')[_0x4fbb83(0x218)]):$(_0x4fbb83(0x223))[_0x4fbb83(0x1ff)]('0');}),$(_0x1a9c8d(0x1b0))[_0x1a9c8d(0x1c5)](function(_0x2a9fb3){var _0x468cb=_0x1a9c8d;location[_0x468cb(0x20b)]=_0x468cb(0x234)+titanForWork[_0x468cb(0x1af)](_0x468cb(0x1e0));});});function ReadExcel(){var _0x560763=a392_0x51e637,_0x2c2463=/^([a-zA-Z0-9\s_\\.\-:])+(.xlsx|.xls)$/;if(_0x2c2463['test']($(_0x560763(0x232))[_0x560763(0x1b8)]()[_0x560763(0x23a)]())){var _0x49e041=![];$(_0x560763(0x232))[_0x560763(0x1b8)]()[_0x560763(0x23a)]()[_0x560763(0x191)](_0x560763(0x1d1))>0x0&&(_0x49e041=!![]);if(typeof FileReader!=_0x560763(0x1ea)){var _0x32ff33=new FileReader();_0x32ff33[_0x560763(0x1ef)]=function(_0x12f8c1){var _0x125035=_0x560763,_0x226469=_0x12f8c1[_0x125035(0x22e)][_0x125035(0x216)];if(_0x49e041)var _0x135161=XLSX[_0x125035(0x194)](_0x226469,{'type':_0x125035(0x1c9)});else var _0x135161=XLS[_0x125035(0x194)](_0x226469,{'type':_0x125035(0x1c9)});var _0x51d8a9=_0x135161[_0x125035(0x202)],_0x2bd69b=0x0;_0x51d8a9['forEach'](function(_0x461df1){var _0x1fb48c=_0x125035;if(_0x49e041)var _0x57a42f=XLSX[_0x1fb48c(0x209)][_0x1fb48c(0x247)](_0x135161['Sheets'][_0x461df1]);else var _0x57a42f=XLS[_0x1fb48c(0x209)][_0x1fb48c(0x1f2)](_0x135161[_0x1fb48c(0x225)][_0x461df1]);_0x57a42f['length']>0x0&&_0x2bd69b==0x0&&(ValidateExcel(_0x57a42f)==!![]?BindExcelToTable(_0x57a42f):$(_0x1fb48c(0x232))['val'](''),_0x2bd69b++);});},_0x49e041?_0x32ff33[_0x560763(0x1f7)]($(_0x560763(0x232))[0x0][_0x560763(0x211)][0x0]):_0x32ff33[_0x560763(0x208)]($(_0x560763(0x232))[0x0][_0x560763(0x211)][0x0]);}else alert(_0x560763(0x1fd));}else alert(_0x560763(0x1e1));}function ValidateExcel(_0x734be7){var _0x235152=a392_0x51e637;IsAllCorrect=!![];if(_0x734be7[_0x235152(0x218)]>0x0){for(var _0x2f0536=0x0;_0x2f0536<_0x734be7[_0x235152(0x218)]-0x1;_0x2f0536++){var _0x5ce89e=_0x734be7[_0x2f0536];if($[_0x235152(0x18d)](_0x5ce89e[_0x235152(0x230)])==''||$[_0x235152(0x18d)](_0x5ce89e['Type'])==''||$[_0x235152(0x18d)](_0x5ce89e[_0x235152(0x197)])==''||$[_0x235152(0x18d)](_0x5ce89e[_0x235152(0x1a7)])=='')return alert(_0x235152(0x246)),IsAllCorrect=![],![];else{if(validateEmail($[_0x235152(0x18d)](_0x5ce89e[_0x235152(0x1cd)]))==![])return alert(_0x235152(0x1c0)),IsAllCorrect=![],![];else{if($[_0x235152(0x18d)](_0x5ce89e[_0x235152(0x197)])!=''){var _0x1a30f6=$[_0x235152(0x18d)](_0x5ce89e[_0x235152(0x197)])['split'](';');for(var _0x46c143=0x0;_0x46c143<_0x1a30f6['length'];_0x46c143++){if(validateEmail($[_0x235152(0x18d)](_0x1a30f6[_0x46c143][_0x235152(0x18d)]()))==![]||$[_0x235152(0x18d)](_0x1a30f6[_0x46c143][_0x235152(0x18d)]())[_0x235152(0x1bf)](';')==!![])return alert(_0x235152(0x1c3)),IsAllCorrect=![],![];}}else IsAllCorrect=!![];}}_0x5ce89e[_0x235152(0x1cd)]==null&&(_0x5ce89e[_0x235152(0x1cd)]=''),_0x5ce89e[_0x235152(0x245)]==null&&(_0x5ce89e['Project']=''),_0x5ce89e['Module']==null&&(_0x5ce89e[_0x235152(0x1a3)]=''),_0x5ce89e['Customer']==null&&(_0x5ce89e[_0x235152(0x22b)]=''),_0x5ce89e[_0x235152(0x1f8)]==null&&(_0x5ce89e[_0x235152(0x1f8)]=''),_0x5ce89e[_0x235152(0x195)]==null&&(_0x5ce89e['Priority']='');}return IsAllCorrect;}else return![];}function BindExcelToTable(_0x37e4a4){var _0x4d413d=a392_0x51e637,_0x433171='',_0x3edb7b='';$(_0x4d413d(0x23f))[_0x4d413d(0x23b)]();if(_0x37e4a4[_0x4d413d(0x218)]>0x0){$(_0x4d413d(0x1c6))[_0x4d413d(0x1ab)]();for(var _0x40ffb4=0x0;_0x40ffb4<_0x37e4a4[_0x4d413d(0x218)];_0x40ffb4++){_0x3edb7b=_0x37e4a4[_0x40ffb4],_0x433171+=_0x4d413d(0x203),_0x433171+=_0x4d413d(0x18b),_0x433171+=_0x4d413d(0x1ad)+_0x3edb7b['Task']+_0x4d413d(0x1ae),_0x433171+=_0x4d413d(0x1ad)+_0x3edb7b[_0x4d413d(0x248)]+'</td>',_0x433171+=_0x4d413d(0x1ad)+_0x3edb7b[_0x4d413d(0x245)]+'</td>',_0x433171+=_0x4d413d(0x1ad)+_0x3edb7b[_0x4d413d(0x1a3)]+_0x4d413d(0x1ae),_0x433171+=_0x4d413d(0x1ad)+_0x3edb7b[_0x4d413d(0x22b)]+_0x4d413d(0x1ae),_0x433171+='<td>'+_0x3edb7b[_0x4d413d(0x1f8)]+_0x4d413d(0x1ae),_0x433171+=_0x4d413d(0x1ad)+_0x3edb7b[_0x4d413d(0x1cd)]+_0x4d413d(0x1ae),_0x433171+=_0x4d413d(0x1ad)+_0x3edb7b[_0x4d413d(0x197)]+_0x4d413d(0x1ae),_0x433171+=_0x4d413d(0x1ad)+_0x3edb7b['Due\x20Date']+_0x4d413d(0x1ae),_0x433171+=_0x4d413d(0x1ad)+_0x3edb7b['Priority']+_0x4d413d(0x1ae),_0x433171+='<td></td></tr>';}$(_0x4d413d(0x23f))[_0x4d413d(0x236)](_0x433171),TableConfiguration(),$('#selectAllChk')['trigger']('click'),$(_0x4d413d(0x1f0))['empty']()['append']('<button\x20type=\x22button\x22\x20class=\x22btn\x20custom-btn\x20mr-8\x20w-87\x22\x20data-toggle=\x22modal\x22\x20data-target=\x22#template-modal\x22>Template</button><button\x20type=\x22button\x22\x20class=\x22btn\x20custom-btn\x20mr-8\x20w-87\x22\x20id=\x22btnSubmitTasks\x22>Submit</button><button\x20type=\x22button\x22\x20class=\x22btn\x20custom-btn-two-danger\x20w-87\x22\x20id=\x22btnCloseTasks\x22>Close</button>'),$(_0x4d413d(0x201))['click'](function(_0x2082c5){var _0x123c23=_0x4d413d,_0x1bcef3=_0x123c23(0x235),_0x3bcc7a=_0x123c23(0x226),_0x15e8d1=0xc8,_0x49ad86=0x190;SP['SOD'][_0x123c23(0x198)]([_0x123c23(0x1b7),_0x123c23(0x1a6)],function(){var _0x2c84aa=_0x123c23;currentDlg=SP['UI'][_0x2c84aa(0x193)]['showWaitScreenWithNoClose'](_0x1bcef3,_0x3bcc7a,_0x15e8d1,_0x49ad86);}),setTimeout(function(){SubmitTasks(_0x37e4a4);});}),$('#btnCloseTasks')[_0x4d413d(0x1c5)](function(_0x120dfb){var _0x41cc19=_0x4d413d;location[_0x41cc19(0x20b)]=_0x41cc19(0x234)+titanForWork[_0x41cc19(0x1af)]('source');});}else $(_0x4d413d(0x1c6))['hide']();}var sorter='';function TableConfiguration(){var _0x4c6da3=a392_0x51e637;sorter=new TINY[(_0x4c6da3(0x1f4))][(_0x4c6da3(0x1fc))]('sorter',_0x4c6da3(0x1f6),{'ascclass':'asc','descclass':_0x4c6da3(0x222),'evenclass':_0x4c6da3(0x196),'oddclass':_0x4c6da3(0x1dd),'evenselclass':_0x4c6da3(0x1e9),'oddselclass':_0x4c6da3(0x1d9),'paginate':!![],'size':0xa,'colddid':_0x4c6da3(0x1db),'currentid':'currentpage','totalid':_0x4c6da3(0x1e5),'startingrecid':_0x4c6da3(0x1d8),'endingrecid':_0x4c6da3(0x20e),'totalrecid':_0x4c6da3(0x1d5),'hoverid':'selectedrow','pageddid':_0x4c6da3(0x1fa),'navid':_0x4c6da3(0x22a),'sortdir':0x1,'init':!![]}),$('#txtSelectedRows')[_0x4c6da3(0x1ff)]($(_0x4c6da3(0x221))[_0x4c6da3(0x218)]),$(_0x4c6da3(0x1e4))[_0x4c6da3(0x1aa)](function(){var _0x24a46a=_0x4c6da3;this[_0x24a46a(0x1b2)]==![]?$(_0x24a46a(0x1b4))[_0x24a46a(0x1b6)](_0x24a46a(0x1b2),''):$(_0x24a46a(0x23f))[_0x24a46a(0x238)]('tr')[_0x24a46a(0x218)]==$(_0x24a46a(0x221))[_0x24a46a(0x218)]?$('#selectAllChk')[_0x24a46a(0x1b6)](_0x24a46a(0x1b2),_0x24a46a(0x1b2)):$(_0x24a46a(0x1b4))[_0x24a46a(0x1b6)]('checked',''),$(this)[_0x24a46a(0x219)]('tr')[_0x24a46a(0x1c8)]('selected')==!![]?$(this)[_0x24a46a(0x219)]('tr')[_0x24a46a(0x1d2)](_0x24a46a(0x1e3)):$(this)[_0x24a46a(0x219)]('tr')['addClass']('selected'),$('#txtSelectedRows')['text']($('td\x20.ExcelRow:checkbox:checked')[_0x24a46a(0x218)]);});}function SubmitTasks(_0x1b706d){var _0x3b400e=a392_0x51e637,_0x380c2a='',_0xc556a5=![];_0x1b706d['length']>0x0&&($(_0x3b400e(0x1b4))[_0x3b400e(0x1b6)](_0x3b400e(0x1b2),_0x3b400e(0x1b2)),$('#btnExpandAll')[_0x3b400e(0x1ce)](_0x3b400e(0x1c5)),$(_0x3b400e(0x22c))[_0x3b400e(0x218)]>0x0&&(_0xc556a5=!![]),$(_0x3b400e(0x22c))[_0x3b400e(0x1d4)](function(_0xd32115,_0x3301d5){var _0x40e204=_0x3b400e,_0x7119dc=$[_0x40e204(0x18d)](_0x3301d5[_0x40e204(0x21e)][0x9][_0x40e204(0x1cf)])[_0x40e204(0x21c)](';');_0x3301d5[_0x40e204(0x21e)][0x3][_0x40e204(0x1cf)]['toLowerCase']()==_0x40e204(0x1cb)?getProjectID(_0x3301d5[_0x40e204(0x21e)][0x4][_0x40e204(0x1cf)],_0x7119dc,_0x3301d5[_0x40e204(0x21e)],_0xd32115,_0x3301d5):getCustomerID(_0x3301d5['children'][0x6]['innerText'],_0x7119dc,_0x3301d5[_0x40e204(0x21e)],_0xd32115,_0x3301d5);}),_0xc556a5==!![]&&alert(_0x3b400e(0x22f))),currentDlg[_0x3b400e(0x19a)]();}function getProjectID(_0x3321d8,_0xce8361,_0x5b8ad3,_0x4eef05,_0x2cdcbb){var _0x28fd3c=a392_0x51e637,_0xd2003a='?$select=Id,ProjectCode,Title&$orderby=Modified\x20desc&$expand=&$filter=ProjectCode\x20eq\x20\x27'+_0x3321d8+_0x28fd3c(0x213)+_0x3321d8+_0x28fd3c(0x1a5)+_0x3321d8+_0x28fd3c(0x18a),_0x2f5324=$[_0x28fd3c(0x204)](),_0x5e8be6=![],_0x485462=[],_0x396645=_spPageContextInfo[_0x28fd3c(0x242)]+_0x28fd3c(0x1a1)+_0xd2003a;$['when'](getItems(_0x396645,_0x2f5324))['done'](function(_0x1cb555){var _0x32c5de=_0x28fd3c;response=[];if(_0x1cb555[_0x32c5de(0x218)]>0x0){var _0x4ce29b='';_0x5b8ad3[0x8][_0x32c5de(0x1cf)]!=''&&_0x5b8ad3[0x8][_0x32c5de(0x1cf)]!=null?_0x4ce29b=_0x5b8ad3[0x8]['innerText']:_0x4ce29b=_spPageContextInfo[_0x32c5de(0x1ec)],_0xd2003a=_0x32c5de(0x23c)+_0x4ce29b+_0x32c5de(0x241)+_0x1cb555[0x0]['Id']+'\x27\x20',_0x2f5324=$[_0x32c5de(0x204)](),_0x396645=_spPageContextInfo[_0x32c5de(0x242)]+_0x32c5de(0x1fe)+_0xd2003a,$[_0x32c5de(0x190)](getItems(_0x396645,_0x2f5324))[_0x32c5de(0x1a2)](function(_0x2d8567){var _0x43e628=_0x32c5de;response=[];if(_0x2d8567[_0x43e628(0x218)]>0x0){if(_0x2d8567[0x0]['TaskPermission']==!![])for(var _0x373abf=0x0;_0x373abf<_0xce8361[_0x43e628(0x218)];_0x373abf++){_0x5e8be6=IsProjectTeamMembers(_0x1cb555[0x0]['Id'],_0xce8361[_0x373abf][_0x43e628(0x18d)](),_0x5b8ad3,_0x2cdcbb);if(_0x5e8be6==![]||_0x5e8be6==null){_0x5b8ad3[0x1]['innerText']='Failed',_0x5b8ad3[0xc][_0x43e628(0x1cf)]=_0xce8361[_0x373abf][_0x43e628(0x18d)]()+_0x43e628(0x22d),$(_0x43e628(0x1c1))['text'](parseInt($(_0x43e628(0x1c1))[_0x43e628(0x1ff)]())+0x1),_0x2cdcbb['style'][_0x43e628(0x1c7)]=_0x43e628(0x19c);break;}else _0x485462[_0x43e628(0x215)](_0x5e8be6);}else _0x5b8ad3[0x1][_0x43e628(0x1cf)]='Failed',_0x5b8ad3[0xc]['innerText']=_0x43e628(0x1a0),$('#txtFailedTasks')[_0x43e628(0x1ff)](parseInt($(_0x43e628(0x1c1))[_0x43e628(0x1ff)]())+0x1),_0x2cdcbb[_0x43e628(0x1d6)]['color']='#ff0000';}}),_0x5e8be6!=![]&&_0x5e8be6!=null&&_0x5e8be6!=''&&GetModule(_0x1cb555[0x0]['Id'],_0x5b8ad3[0x5][_0x32c5de(0x1cf)],_0x5b8ad3,_0x485462,_0x1cb555[0x0][_0x32c5de(0x20f)],_0x4eef05,_0x2cdcbb);}else _0x5b8ad3[0x1][_0x32c5de(0x1cf)]=_0x32c5de(0x200),_0x5b8ad3[0xc]['innerText']=_0x3321d8+_0x32c5de(0x21f),$(_0x32c5de(0x1c1))[_0x32c5de(0x1ff)](parseInt($('#txtFailedTasks')[_0x32c5de(0x1ff)]())+0x1),_0x2cdcbb[_0x32c5de(0x1d6)][_0x32c5de(0x1c7)]=_0x32c5de(0x19c);})[_0x28fd3c(0x21a)](function(_0x322a64){var _0x49b4f8=_0x28fd3c;_0x322a64[_0x49b4f8(0x18e)][_0x49b4f8(0x1fb)][_0x49b4f8(0x1d7)][_0x49b4f8(0x214)][_0x49b4f8(0x191)]('The\x20attempted\x20operation\x20is\x20prohibited\x20because\x20it\x20exceeds\x20the\x20list\x20view\x20threshold.')!=-0x1&&(_0x5b8ad3[0x1][_0x49b4f8(0x1cf)]=_0x49b4f8(0x200),_0x5b8ad3[0xc][_0x49b4f8(0x1cf)]=_0x49b4f8(0x206),$(_0x49b4f8(0x1c1))['text'](parseInt($(_0x49b4f8(0x1c1))[_0x49b4f8(0x1ff)]())+0x1),_0x2cdcbb[_0x49b4f8(0x1d6)][_0x49b4f8(0x1c7)]='#ff0000');});}function IsProjectTeamMembers(_0x525534,_0x2d10b9,_0x239424,_0xf68634){var _0x3975e9=a392_0x51e637,_0x5ab868=![],_0x426ef2='?$select=*,TeamMember/EMail,TeamMember/Id&$expand=TeamMember&$top=100&$filter=\x20Status\x20eq\x20\x27Active\x27\x20and\x20TeamMember/EMail\x20eq\x20\x27'+_0x2d10b9+_0x3975e9(0x241)+_0x525534+'\x27\x20',_0x2e5550=$[_0x3975e9(0x204)]();return url=_spPageContextInfo[_0x3975e9(0x242)]+_0x3975e9(0x1fe)+_0x426ef2,$[_0x3975e9(0x190)](getItems(url,_0x2e5550))[_0x3975e9(0x1a2)](function(_0x871644){var _0x59ba4e=_0x3975e9;response=[];if(_0x871644[_0x59ba4e(0x218)]>0x0)_0x5ab868=_0x871644[0x0]['TeamMember']['Id'];else{}})[_0x3975e9(0x21a)](function(_0x3d6099){var _0x533f36=_0x3975e9;_0x3d6099[_0x533f36(0x18e)][_0x533f36(0x1fb)][_0x533f36(0x1d7)][_0x533f36(0x214)][_0x533f36(0x191)](_0x533f36(0x206))!=-0x1&&(_0x239424[0x1][_0x533f36(0x1cf)]=_0x533f36(0x200),_0x239424[0xc][_0x533f36(0x1cf)]=_0x533f36(0x206),$(_0x533f36(0x1c1))[_0x533f36(0x1ff)](parseInt($(_0x533f36(0x1c1))['text']())+0x1),_0xf68634[_0x533f36(0x1d6)]['color']=_0x533f36(0x19c));}),_0x5ab868;}function GetModule(_0x13b24e,_0x5aaa3d,_0x1f2bff,_0x17f636,_0x30569d,_0x3380b5,_0x2da160){var _0x2af809=a392_0x51e637,_0x19f848=_0x2af809(0x18c)+_0x13b24e+'\x27\x20and\x20Status\x20eq\x20\x27Active\x27\x20and\x20Title\x20eq\x20\x27'+_0x5aaa3d+'\x27\x20';$['when'](getItemsWithQueryItem('ProjectModules',_0x19f848))[_0x2af809(0x1a2)](function(_0x51c48c){_0x51c48c['length']>0x0?AddProjectTask(_0x13b24e,_0x1f2bff,_0x30569d,_0x17f636,_0x51c48c[0x0]['Id'],_0x3380b5,_0x2da160):AddProjectTask(_0x13b24e,_0x1f2bff,_0x30569d,_0x17f636,'',_0x3380b5,_0x2da160);});}function AddProjectTask(_0x3b7036,_0x43d366,_0x49e1d2,_0x13b643,_0x51e093,_0x54c403,_0x18e597){var _0x2bb13e=a392_0x51e637,_0x17665e,_0x3fb684='1',_0x42d9f3=_0x2bb13e(0x1ed),_0x585c65='';_0x43d366[0x8][_0x2bb13e(0x1cf)]!=''&&_0x43d366[0x8]['innerText']!=null?_0x585c65=GetUserId(_0x43d366[0x8][_0x2bb13e(0x1cf)]):_0x585c65=_spPageContextInfo['userId'];var _0x1e4831=GetDateStandardFormat(moment(_0x43d366[0xa][_0x2bb13e(0x1cf)])[_0x2bb13e(0x1e8)](_0x2bb13e(0x207)));_0x43d366[0xb][_0x2bb13e(0x1cf)]!=''&&_0x43d366[0xb][_0x2bb13e(0x1cf)]!=null&&(_0x42d9f3=_0x43d366[0xb]['innerText']);var _0x1fb2b1=0x0;_0x51e093==''&&(_0x51e093=0x0);var _0x5e2f5e=GetItemTypeForListName('EmployeeTaskDetails');_0x17665e={'__metadata':{'type':_0x5e2f5e},'Title':$[_0x2bb13e(0x18d)](_0x43d366[0x2][_0x2bb13e(0x1cf)]),'TaskType':_0x3fb684,'ProjectName':_0x3b7036[_0x2bb13e(0x1b9)](),'ProjectFullName':_0x49e1d2,'ProjectIDId':_0x3b7036,'TaskAssignToId':{'results':_0x13b643},'AssignedById':_0x585c65,'Description':'','StartDate':new Date()[_0x2bb13e(0x21b)](),'DueDate':_0x1e4831,'TaskPriority':_0x42d9f3,'CurrentPhase':_0x2bb13e(0x1ca),'CompletionPersent':'0','CompanyId':Logged_CompanyId,'Distribution':_0x2bb13e(0x1df),'ClientIDId':_0x1fb2b1,'ModuleId':_0x51e093,'Worktype':$[_0x2bb13e(0x18d)](_0x43d366[0x7][_0x2bb13e(0x1cf)]),'ReferenceLink':{'__metadata':{'type':_0x2bb13e(0x20a)},'Description':'','Url':''}},AddItemToList(_0x17665e,_0x54c403,_0x43d366,_0x18e597);}function AddItemToList(_0x138646,_0x513802,_0x3a1b7f,_0x2288cf){var _0x3e552b=a392_0x51e637,_0x2c6632=$['Deferred']();return $[_0x3e552b(0x1f1)]({'url':_spPageContextInfo[_0x3e552b(0x242)]+_0x3e552b(0x19e),'type':_0x3e552b(0x1ba),'async':![],'headers':{'accept':_0x3e552b(0x1c4),'X-RequestDigest':$(_0x3e552b(0x229))[_0x3e552b(0x1b8)](),'content-Type':_0x3e552b(0x1c4)},'data':JSON[_0x3e552b(0x228)](_0x138646),'success':function(_0x57507f){var _0x473c0b=_0x3e552b;_0x3a1b7f[0x1][_0x473c0b(0x1cf)]=_0x473c0b(0x212),_0x3a1b7f[0x0][_0x473c0b(0x21e)][0x0][_0x473c0b(0x21e)][0x0][_0x473c0b(0x1b5)](),$('#txtAddedCount')['text'](parseInt($(_0x473c0b(0x1c2))[_0x473c0b(0x1ff)]())+0x1),_0x2288cf['style']['color']=_0x473c0b(0x1cc),$(_0x2288cf)['removeClass'](_0x473c0b(0x1e3)),_0x2c6632[_0x473c0b(0x1a9)](_0x57507f);},'error':function(_0xae23f4){var _0x180d56=_0x3e552b;_0x3a1b7f[0x1]['innerText']=_0x180d56(0x200),_0x3a1b7f[0xc][_0x180d56(0x1cf)]=JSON['stringify'](_0xae23f4)+_0x180d56(0x23e),$(_0x180d56(0x1c1))[_0x180d56(0x1ff)](parseInt($(_0x180d56(0x1c1))['text']())+0x1),_0x2288cf[_0x180d56(0x1d6)][_0x180d56(0x1c7)]=_0x180d56(0x19c),console[_0x180d56(0x1b3)](JSON[_0x180d56(0x228)](_0xae23f4)),_0x2c6632[_0x180d56(0x217)](_0xae23f4);}}),_0x2c6632[_0x3e552b(0x243)]();}function GetUserId(_0x5a9b65){var _0x35ebb2=a392_0x51e637,_0x2eeee8='',_0x511edc=_0x35ebb2(0x19b),_0x217f1b=_spPageContextInfo['siteAbsoluteUrl'],_0x224127=_0x511edc+_0x5a9b65;return $[_0x35ebb2(0x1f1)]({'url':_0x217f1b+'/_api/web/siteusers(@v)?@v=\x27'+encodeURIComponent(_0x224127)+'\x27','method':_0x35ebb2(0x1bb),'headers':{'Accept':'application/json;\x20odata=verbose'},'async':![],'success':function(_0x25d0f4){_0x2eeee8=_0x25d0f4['d']['Id'];},'error':function(_0x4e5fe9){var _0x23e909=_0x35ebb2;console['log'](JSON[_0x23e909(0x228)](_0x4e5fe9));}}),_0x2eeee8;}function getCustomerID(_0x77058b,_0x2aa72a,_0x3f283f,_0x5ef3d0,_0x281cfb){var _0x599a0e=a392_0x51e637,_0x24f619=0x0,_0x2b5aa3=[],_0x15367e=_0x599a0e(0x23d);if(_0x77058b!=null&&_0x77058b!=null&&_0x77058b!=''){RestQuery='?$select=SelfCompany,Title,ID,Client_Code&$filter=IsActive\x20eq\x201\x20and\x20(Title\x20eq\x20\x27'+_0x77058b+'\x27\x20or\x20Client_Code\x20eq\x20\x27'+_0x77058b+_0x599a0e(0x1e6);var _0x554c13=$['Deferred'](),_0x15eb11=_spPageContextInfo[_0x599a0e(0x242)]+_0x599a0e(0x1d3)+RestQuery;$['when'](getItems(_0x15eb11,_0x554c13))[_0x599a0e(0x1a2)](function(_0x375401){var _0x1005de=_0x599a0e;response=[];if(_0x375401[_0x1005de(0x218)]>0x0){ClientID=_0x375401[0x0]['ID'];for(var _0x4d4282=0x0;_0x4d4282<_0x2aa72a[_0x1005de(0x218)];_0x4d4282++){_0x24f619=checkUserValid(_0x2aa72a[_0x4d4282]['trim']());if(_0x24f619==''||_0x24f619==null){_0x3f283f[0x1][_0x1005de(0x1cf)]=_0x1005de(0x200),_0x3f283f[0xc][_0x1005de(0x1cf)]=_0x2aa72a[_0x4d4282][_0x1005de(0x18d)]()+_0x1005de(0x1f5),$(_0x1005de(0x1c1))[_0x1005de(0x1ff)](parseInt($(_0x1005de(0x1c1))[_0x1005de(0x1ff)]())+0x1),_0x281cfb[_0x1005de(0x1d6)][_0x1005de(0x1c7)]=_0x1005de(0x19c),_0x2b5aa3=[];break;}else _0x2b5aa3[_0x1005de(0x215)](_0x24f619);}AddGeneralTask(ClientID,_0x3f283f,_0x2b5aa3,_0x5ef3d0,_0x281cfb);}else _0x3f283f[0x1][_0x1005de(0x1cf)]=_0x1005de(0x200),_0x3f283f[0xc]['innerText']=_0x77058b+_0x1005de(0x21d),$(_0x1005de(0x1c1))[_0x1005de(0x1ff)](parseInt($('#txtFailedTasks')[_0x1005de(0x1ff)]())+0x1),_0x281cfb['style'][_0x1005de(0x1c7)]=_0x1005de(0x19c);});}else{RestQuery='?$select=SelfCompany,Title,ID,Client_Code&$filter=SelfCompany\x20eq\x201&$top=5000';var _0x554c13=$[_0x599a0e(0x204)](),_0x15eb11=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/getbytitle(\x27ClientMaster\x27)/items/'+RestQuery;$[_0x599a0e(0x190)](getItems(_0x15eb11,_0x554c13))['done'](function(_0x5d25c9){var _0x1563ef=_0x599a0e;response=[];if(_0x5d25c9[_0x1563ef(0x218)]>0x0){ClientID=_0x5d25c9[0x0]['ID'];for(var _0x4553=0x0;_0x4553<_0x2aa72a['length'];_0x4553++){_0x24f619=checkUserValid(_0x2aa72a[_0x4553][_0x1563ef(0x18d)]());if(_0x24f619==''||_0x24f619==null){_0x2b5aa3=[],_0x3f283f[0x1][_0x1563ef(0x1cf)]='Failed',_0x3f283f[0xc][_0x1563ef(0x1cf)]=_0x2aa72a[_0x4553][_0x1563ef(0x18d)]()+_0x1563ef(0x1f5),$(_0x1563ef(0x1c1))[_0x1563ef(0x1ff)](parseInt($(_0x1563ef(0x1c1))['text']())+0x1),_0x281cfb[_0x1563ef(0x1d6)][_0x1563ef(0x1c7)]=_0x1563ef(0x19c);break;}else _0x2b5aa3['push'](_0x24f619);}AddGeneralTask(ClientID,_0x3f283f,_0x2b5aa3,_0x5ef3d0,_0x281cfb);}else _0x3f283f[0x1]['innerText']=_0x1563ef(0x200),_0x3f283f[0xc][_0x1563ef(0x1cf)]='There\x20is\x20not\x20self\x20company\x20assigned.',$('#txtFailedTasks')['text'](parseInt($(_0x1563ef(0x1c1))[_0x1563ef(0x1ff)]())+0x1),_0x281cfb['style'][_0x1563ef(0x1c7)]=_0x1563ef(0x19c);});}}function AddGeneralTask(_0x13e6e8,_0x26c2e2,_0x387695,_0x22fbd6,_0x587d21){var _0x5a2714=a392_0x51e637,_0x22c841,_0x59af7e='2',_0x1466fb=_0x5a2714(0x1ed);_0x26c2e2[0xa][_0x5a2714(0x1cf)]=moment(new Date(_0x26c2e2[0xa][_0x5a2714(0x1cf)]))[_0x5a2714(0x1e8)](_0x5a2714(0x1ac));var _0x541830=GetDateStandardFormat(_0x26c2e2[0xa][_0x5a2714(0x1cf)]),_0x506526='';_0x26c2e2[0x8][_0x5a2714(0x1cf)]!=''&&_0x26c2e2[0x8][_0x5a2714(0x1cf)]!=null?_0x506526=GetUserId(_0x26c2e2[0x8][_0x5a2714(0x1cf)]):_0x506526=_spPageContextInfo[_0x5a2714(0x1eb)];_0x26c2e2[0xb][_0x5a2714(0x1cf)]!=''&&_0x26c2e2[0xb][_0x5a2714(0x1cf)]!=null&&(_0x1466fb=_0x26c2e2[0xb][_0x5a2714(0x1cf)]);var _0x3b6306=GetItemTypeForListName(_0x5a2714(0x1b1));_0x22c841={'__metadata':{'type':_0x3b6306},'Title':$['trim'](_0x26c2e2[0x2][_0x5a2714(0x1cf)]),'TaskType':_0x59af7e,'ProjectName':'','ProjectFullName':'','ProjectIDId':0x0,'TaskAssignToId':{'results':_0x387695},'AssignedById':_0x506526,'Description':'','StartDate':new Date()[_0x5a2714(0x21b)](),'DueDate':_0x541830,'TaskPriority':_0x1466fb,'CurrentPhase':_0x5a2714(0x1ca),'CompletionPersent':'0','CompanyId':Logged_CompanyId,'Distribution':'Consolidated','ClientIDId':_0x13e6e8,'ModuleId':0x0,'Worktype':$[_0x5a2714(0x18d)](_0x26c2e2[0x7][_0x5a2714(0x1cf)]),'ReferenceLink':{'__metadata':{'type':'SP.FieldUrlValue'},'Description':'','Url':''}},(_0x506526==''||_0x506526=='null'||_0x506526==null||_0x506526==_0x5a2714(0x1ea))&&delete _0x22c841[_0x5a2714(0x240)],(_0x1466fb==''||_0x1466fb==_0x5a2714(0x1e7)||_0x1466fb==null||_0x1466fb==_0x5a2714(0x1ea))&&(_0x22c841['TaskPriority']=_0x5a2714(0x1be)),AddItemToList(_0x22c841,_0x22fbd6,_0x26c2e2,_0x587d21);}function checkUserValid(_0x3f611b){var _0x3a0859=a392_0x51e637,_0x5b85fc='';return RestQuery=_0x3a0859(0x1e2)+_0x3f611b+_0x3a0859(0x18a),(dfds=$[_0x3a0859(0x204)](),url=_spPageContextInfo[_0x3a0859(0x242)]+_0x3a0859(0x19d)+RestQuery),$[_0x3a0859(0x190)](getItems(url,dfds))['done'](function(_0x4510b4){var _0x5aa080=_0x3a0859;response=[];if(_0x4510b4[_0x5aa080(0x218)]>0x0)_0x5b85fc=_0x4510b4[0x0][_0x5aa080(0x233)]['Id'];else{var _0x2ee28b=_0x5aa080(0x192)+_0x3f611b+_0x5aa080(0x18a);dfds=$[_0x5aa080(0x204)](),url=_spPageContextInfo[_0x5aa080(0x242)]+_0x5aa080(0x1dc)+_0x2ee28b,$[_0x5aa080(0x190)](getItems(url,dfds))['done'](function(_0x1960aa){var _0x2a149b=_0x5aa080;response=[],_0x1960aa[_0x2a149b(0x218)]>0x0&&(_0x5b85fc=_0x1960aa[0x0][_0x2a149b(0x1bd)]['Id']);});}}),_0x5b85fc;}function validateEmail(_0x54d0f8){var _0x4e6fc5=a392_0x51e637;result=![];if(_0x54d0f8!=''){const _0x3167c1=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;result=_0x3167c1['test'](String(_0x54d0f8)[_0x4e6fc5(0x23a)]());}else result=!![];return result;}var response=response||[];function getItems(_0x1d23dd,_0x166cc6){var _0x470ab0=a392_0x51e637;return $[_0x470ab0(0x1f1)]({'url':_0x1d23dd,'type':_0x470ab0(0x1bb),'async':![],'headers':{'accept':_0x470ab0(0x1c4)},'success':function(_0x5eec05){var _0x5b005b=_0x470ab0;response=response[_0x5b005b(0x231)](_0x5eec05['d'][_0x5b005b(0x18f)]),_0x5eec05['d'][_0x5b005b(0x237)]?(_0x1d23dd=_0x5eec05['d']['__next'],getItems(_0x1d23dd,_0x166cc6)):_0x166cc6[_0x5b005b(0x1a9)](response);},'error':function(_0x385005){var _0x3a97ed=_0x470ab0;_0x166cc6[_0x3a97ed(0x217)](_0x385005),console[_0x3a97ed(0x1b3)](_0x385005);}}),_0x166cc6[_0x470ab0(0x243)]();}function GetDateStandardFormat(_0x1a0964){var _0x28b229=a392_0x51e637,_0x3f2a88=ConvertDateFormatToddMMyyyy(_0x1a0964),_0x17fab4=new Date(_0x3f2a88),_0x63af73=0x3c*0x3c*0x18*0x3e8,_0x1d6918=new Date(_0x17fab4['getTime']()),_0x2fe1db=_0x1d6918[_0x28b229(0x21b)]();return _0x2fe1db;}function ConvertDateFormatToddMMyyyy(_0x105e1d){var _0x55ca20=a392_0x51e637,_0x1a9aaf=stringToDate(_0x105e1d,_0x55ca20(0x1da),'/');return _0x1a9aaf;}function stringToDate(_0x4bc147,_0xd618db,_0x402979){var _0x11603b=a392_0x51e637,_0x440aeb=_0xd618db[_0x11603b(0x23a)](),_0x3b8801=_0x440aeb['split'](_0x402979),_0x54d968=_0x4bc147[_0x11603b(0x21c)](_0x402979),_0x3b4a5e=_0x3b8801[_0x11603b(0x191)]('mm'),_0x31f3cc=_0x3b8801[_0x11603b(0x191)]('dd'),_0x29059e=_0x3b8801['indexOf']('yyyy'),_0x2318aa=parseInt(_0x54d968[_0x3b4a5e]);_0x2318aa-=0x1;var _0x4e6f7e=new Date(_0x54d968[_0x29059e],_0x2318aa,_0x54d968[_0x31f3cc]);return _0x4e6f7e;}function a392_0x52a1(){var _0x531167=['toString','POST','GET','slice','LoginName','Low','includes','Assigned\x20By\x20email\x20Id\x20is\x20not\x20in\x20correct\x20format.','#txtFailedTasks','#txtAddedCount','Assigned\x20To\x20email\x20Id\x20is\x20not\x20in\x20correct\x20format.','application/json;odata=verbose','click','#btnViewAll','color','hasClass','binary','Open','project\x20task','#039203','Assigned\x20By','trigger','innerText','1072YnKEqv','.xlsx','removeClass','/_api/web/lists/getbytitle(\x27ClientMaster\x27)/items/','each','totalrecords','style','message','startrecord','oddselected','dd/MM/yyyy','columns','/_api/web/lists/getbytitle(\x27ExternalUsers\x27)/items/','oddrow','240116OuAtKw','Consolidated','source','Please\x20upload\x20a\x20valid\x20excel\x20file!','?$select=Status,LogonName/Id,LogonName/EMail&$expand=LogonName&$filter=\x20Status\x20eq\x20\x27Active\x27\x20and\x20LogonName/EMail\x20eq\x20\x27','selected','.ExcelRow','totalpages','\x27)&$top=5000','null','format','evenselected','undefined','userId','userEmail','Medium','585247MWCzTl','onload','#parentSubmit','ajax','sheet_to_row_object_array','2801637HBjQby','table','\x20is\x20not\x20a\x20valid\x20user.','tblImportTasks','readAsArrayBuffer','Work\x20Type','72fUjbjy','pageDropDown','error','sorter','Sorry!\x20Your\x20browser\x20does\x20not\x20support\x20HTML5!','/_api/web/lists/getbytitle(\x27ProjectTeamDetails\x27)/items/','text','Failed','#btnSubmitTasks','SheetNames','<tr><td><div\x20class=\x22checkbox\x20task-import-thead-checkbox\x20m-0\x22><input\x20type=\x22checkbox\x22\x20class=\x22ExcelRow\x22></div></td>','Deferred','ready','The\x20attempted\x20operation\x20is\x20prohibited\x20because\x20it\x20exceeds\x20the\x20list\x20view\x20threshold.','DD/MM/YYYY','readAsBinaryString','utils','SP.FieldUrlValue','href','9548RzkVrF','541SNfuZT','endrecord','Title','join','files','Done','\x27\x20or\x20Title\x20eq\x20\x27','value','push','result','reject','length','closest','fail','toISOString','split','\x20is\x20not\x20a\x20valid\x20ClientName/ClientCode.','children','\x20is\x20not\x20a\x20project\x20name/project\x20code.','charAt','td\x20.ExcelRow:checkbox:checked','desc','#txtSelectedRows','295ACqpSK','Sheets','<br\x20/>Please\x20wait!!','3761230LQpaUy','stringify','#__REQUESTDIGEST','tablenav','Customer','.tbdyImportTasks\x20tr.selected','\x20is\x20not\x20a\x20valid\x20team\x20member.','target','Process\x20has\x20been\x20completed.','Task','concat','#ExcelUpload','LogonName','../Pages/MyDashboard.aspx?Location=','Adding...','append','__next','find','ListItem','toLowerCase','empty','?$select=*,TeamMember/EMail,TeamMember/Id&$expand=TeamMember&$top=100&$filter=\x20Status\x20eq\x20\x27Active\x27\x20and\x20TeamMember/EMail\x20eq\x20\x27','ClientMaster','\x20Error\x20while\x20adding.','.tbdyImportTasks','AssignedById','\x27\x20and\x20ProjectId\x20eq\x20\x27','webAbsoluteUrl','promise','addClass','Project','Kindly\x20fill\x20all\x20the\x20mandatory\x20fields.','sheet_to_json','Type','\x27&$top=5000','<td>Ready</td>','?$select=*&$Filter=ProjectId\x20eq\x20\x27','trim','responseJSON','results','when','indexOf','?$select=LoginName/EMail,LoginName/Id&$expand=LoginName&$filter=LoginName/EMail\x20eq\x20\x27','ModalDialog','read','Priority','evenrow','Assigned\x20To','loadMultiple','394eteKVe','close','i:0#.f|membership|','#ff0000','/_api/web/lists/getbytitle(\x27Employees\x27)/items/','/_api/web/lists/getbytitle(\x27EmployeeTaskDetails\x27)/items','606ZptepA','You\x20do\x20not\x20have\x20the\x20permission\x20to\x20create\x20Task.','/_api/web/lists/getbytitle(\x27ProjectDetails\x27)/items/','done','Module','11JGGWIR','\x27\x20or\x20ProjectName\x20eq\x20\x27','sp.ui.dialog.js','Due\x20Date','3AvxVRi','resolve','change','show','MM/DD/YYYY','<td>','</td>','getQueryStringParameter','#btnCloseTasks','EmployeeTaskDetails','checked','log','#selectAllChk','remove','prop','strings.js','val'];a392_0x52a1=function(){return _0x531167;};return a392_0x52a1();}function a392_0x2115(_0x32ad70,_0x3280dd){var _0x52a193=a392_0x52a1();return a392_0x2115=function(_0x2115ab,_0x2b0fe1){_0x2115ab=_0x2115ab-0x18a;var _0x1cbd76=_0x52a193[_0x2115ab];return _0x1cbd76;},a392_0x2115(_0x32ad70,_0x3280dd);}function GetItemTypeForListName(_0x126865){var _0x4840e6=a392_0x51e637;return'SP.Data.'+_0x126865[_0x4840e6(0x220)](0x0)['toUpperCase']()+_0x126865['split']('\x20')[_0x4840e6(0x210)]('')[_0x4840e6(0x1bc)](0x1)+_0x4840e6(0x239);}function getItemsWithQueryItem(_0x22b8b0,_0x1dbf42){var _0x7644b=a392_0x51e637;return DeferredObj=$['Deferred'](),$['ajax']({'url':_spPageContextInfo[_0x7644b(0x242)]+'/_api/web/lists/getbytitle(\x27'+_0x22b8b0+'\x27)/items/'+_0x1dbf42,'type':_0x7644b(0x1bb),'async':![],'headers':{'ACCEPT':_0x7644b(0x1c4),'X-RequestDigest':$(_0x7644b(0x229))[_0x7644b(0x1b8)]()},'success':function(_0x3feec3){var _0x303bf2=_0x7644b;DeferredObj[_0x303bf2(0x1a9)](_0x3feec3['d'][_0x303bf2(0x18f)]);},'error':function(_0x68609c){var _0x5e5f8a=_0x7644b;DeferredObj[_0x5e5f8a(0x217)](_0x68609c);}}),DeferredObj[_0x7644b(0x243)]();}