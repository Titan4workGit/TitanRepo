var a7_0x24c71a=a7_0x2302;function a7_0x1324(){var _0x3deccd=['display','userId','Attendance\x20has\x20been\x20saved.','GET','/_api/web/lists/getbytitle(\x27EmpAttendance\x27)/items?$filter=EmployeeId\x20eq\x20\x27','Holiday','#__REQUESTDIGEST','5721443kbDJRd','SP.Data.EmpAttendanceListItem','prop','5076JeJvzL','UpdateAttendance\x20function\x20failed','webAbsoluteUrl','Plese\x20select\x20proper\x20attandence.','\x27\x20\x20','results','getMonth','3OyHFUA','text','186520sYNeVO','userDisplayName','\x27)and\x20Holiday_start\x20eq\x20\x27','modal','3TCJSTv','length','6zmWGJR','application/json;odata=verbose','#HolidayMessage','Attendance\x20function\x20failed','ManagerLoginNameId','/_api/web/lists/getbytitle(\x27EnvironmentalSettings\x27)/items?$select=Title,Active,ListOfUsers/Title&$filter=Title\x20eq\x20\x27Attendance\x20Entry\x27\x20or\x20Title\x20eq\x20\x27Timesheet\x20Entry\x27\x20&$expand=ListOfUsers/Id','432tFtoGf','#Submit-attendance','HrAction','hide','Active','ready','getDate','Attendance','2188PryQYv','#timesheetdate','This\x20feature\x20has\x20been\x20deactivated\x20!','POST','ajax','block','stringify','32505jbFxEW','\x27\x20and\x20AttendanceDate\x20eq\x20\x27','/_api/web/lists/getbytitle(\x27Employees\x27)/items?$filter=LogonName\x20eq\x20(\x27','#HolidayMessagediv','css','getQueryStringParameter','Title','340412UJUuQz','#Attendance-toggle-li','MERGE','split','datepicker','dd/mm/yy','setDate','#AttendanceDDL','inline-block','disabled','This\x20is\x20a\x20Holiday,\x20are\x20you\x20sure\x20to\x20submit\x20your\x20attendance.','getFullYear','#MyAttendance','#HR-Message','#Reports-menu>ul\x20li','log','AttendanceType','872715EshyHq','/_api/web/lists/GetByTitle(\x27EmpAttendance\x27)/items','An\x20error\x20occurred.\x20Please\x20try\x20again.','toggle','/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?$filter=OfficeLocationID\x20eq\x20(\x27','3427408iAzSDm','none','val','Timesheet\x20Entry'];a7_0x1324=function(){return _0x3deccd;};return a7_0x1324();}(function(_0x5ce638,_0xdcb0dd){var _0x5884b3=a7_0x2302,_0x961063=_0x5ce638();while(!![]){try{var _0x4c6579=-parseInt(_0x5884b3(0x12a))/0x1*(parseInt(_0x5884b3(0x13a))/0x2)+parseInt(_0x5884b3(0x124))/0x3*(-parseInt(_0x5884b3(0xf9))/0x4)+-parseInt(_0x5884b3(0x10a))/0x5+parseInt(_0x5884b3(0x12c))/0x6*(parseInt(_0x5884b3(0x11a))/0x7)+-parseInt(_0x5884b3(0x10f))/0x8+-parseInt(_0x5884b3(0x132))/0x9*(parseInt(_0x5884b3(0x126))/0xa)+parseInt(_0x5884b3(0xf2))/0xb*(parseInt(_0x5884b3(0x11d))/0xc);if(_0x4c6579===_0xdcb0dd)break;else _0x961063['push'](_0x961063['shift']());}catch(_0x1b4e95){_0x961063['push'](_0x961063['shift']());}}}(a7_0x1324,0x75598));var Attendancechck=!![];$(document)[a7_0x24c71a(0x137)](function(){authentication(),GetManagerID();});function a7_0x2302(_0x8970ee,_0x33e356){var _0x132426=a7_0x1324();return a7_0x2302=function(_0x230255,_0x32c0a3){_0x230255=_0x230255-0xf1;var _0x260ebf=_0x132426[_0x230255];return _0x260ebf;},a7_0x2302(_0x8970ee,_0x33e356);}function Attendance(){var _0x390b64=a7_0x24c71a,_0x4361db=_spPageContextInfo['userId'];if(Attendancechck==![])return alert(_0x390b64(0x13c)),$(_0x390b64(0x105))[_0x390b64(0x129)](_0x390b64(0x10d)),![];var _0x554896=new Date(ConvertDateTimeFormat($(_0x390b64(0x13b))[_0x390b64(0x111)](),'/')),_0x455a30=_0x554896[_0x390b64(0x104)]()+'-'+(_0x554896['getMonth']()+0x1)+'-'+_0x554896[_0x390b64(0x138)](),_0x254559=_spPageContextInfo[_0x390b64(0x11f)]+_0x390b64(0x117)+_0x4361db+'\x27\x20and\x20AttendanceDate\x20eq\x20\x27'+_0x455a30+_0x390b64(0x121);$['ajax']({'url':_0x254559,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x3a4cf1){var _0x36679f=_0x390b64,_0x1723ac=_0x3a4cf1['d'][_0x36679f(0x122)];if(_0x1723ac[_0x36679f(0x12b)]>0x0){if(G_Validateholiday==!![]){if(confirm(_0x36679f(0x103))){var _0xa9c564=_0x1723ac[0x0]['ID'];UpdateAttendance(_0xa9c564);}}else{var _0xa9c564=_0x1723ac[0x0]['ID'];UpdateAttendance(_0xa9c564);}}else G_Validateholiday==!![]?confirm(_0x36679f(0x103))&&SetAttendance():SetAttendance();},'error':function(_0x576055){var _0x1aeb26=_0x390b64;console[_0x1aeb26(0x108)]('Attendance\x20function\x20failed'),console['log'](_0x576055);}});}function UpdateAttendance(_0x45a484){var _0x11bbab=a7_0x24c71a,_0x9029e7=ConvertDateTimeFormat($('#timesheetdate')[_0x11bbab(0x111)](),'/');_0x9029e7=new Date(_0x9029e7);;var _0x2b1437=_spPageContextInfo[_0x11bbab(0x114)];$(_0x11bbab(0x100))[_0x11bbab(0x111)]()!='0'&&$(_0x11bbab(0x100))['val']()!=_0x11bbab(0x118)||G_Validateholiday==!![]?$['ajax']({'url':_spPageContextInfo[_0x11bbab(0x11f)]+'/_api/web/lists/GetByTitle(\x27EmpAttendance\x27)/items(\x27'+_0x45a484+'\x27)','type':_0x11bbab(0x13d),'data':JSON[_0x11bbab(0xf1)]({'__metadata':{'type':_0x11bbab(0x11b)},'Title':_0x11bbab(0x139),'EmployeeId':_0x2b1437,'ManagerIDId':parseInt(G_ManagerID),'AttendanceType':$('#AttendanceDDL')['val'](),'AttendanceDate':_0x9029e7}),'headers':{'Accept':_0x11bbab(0x12d),'Content-Type':_0x11bbab(0x12d),'X-RequestDigest':$(_0x11bbab(0x119))[_0x11bbab(0x111)](),'IF-MATCH':'*','X-HTTP-Method':_0x11bbab(0xfb)},'success':function(_0x215f06,_0x6b06ae,_0x5b7510){var _0xe9c2fc=_0x11bbab;alert('Attendance\x20has\x20been\x20saved.'),$(_0xe9c2fc(0x105))[_0xe9c2fc(0x129)](_0xe9c2fc(0x10d)),$(_0xe9c2fc(0x13b))[_0xe9c2fc(0xfd)]({'dateFormat':_0xe9c2fc(0xfe),'maxDate':0x0})['datepicker']('setDate',new Date());},'error':function(_0x2145ee){var _0x2a36d2=_0x11bbab;console[_0x2a36d2(0x108)](_0x2a36d2(0x11e)),console[_0x2a36d2(0x108)](_0x2145ee);}}):alert(_0x11bbab(0x120));}function SetAttendance(){var _0x2b607b=a7_0x24c71a,_0x394296=ConvertDateTimeFormat($(_0x2b607b(0x13b))[_0x2b607b(0x111)](),'/');_0x394296=new Date(_0x394296);;var _0x36142c=_spPageContextInfo['userId'];$(_0x2b607b(0x100))['val']()!='0'&&$('#AttendanceDDL')[_0x2b607b(0x111)]()!='Holiday'||G_Validateholiday==!![]?$['ajax']({'url':_spPageContextInfo[_0x2b607b(0x11f)]+_0x2b607b(0x10b),'type':_0x2b607b(0x13d),'data':JSON[_0x2b607b(0xf1)]({'__metadata':{'type':_0x2b607b(0x11b)},'Title':'Attendance','EmployeeId':_0x36142c,'ManagerIDId':parseInt(G_ManagerID),'AttendanceType':$(_0x2b607b(0x100))[_0x2b607b(0x111)](),'AttendanceDate':_0x394296}),'headers':{'Accept':_0x2b607b(0x12d),'Content-Type':'application/json;odata=verbose','X-RequestDigest':$(_0x2b607b(0x119))['val'](),'X-HTTP-Method':_0x2b607b(0x13d)},'success':function(_0x4cafdf,_0x37a385,_0x680d23){var _0x1c414b=_0x2b607b;alert(_0x1c414b(0x115)),$(_0x1c414b(0x105))[_0x1c414b(0x129)](_0x1c414b(0x10d)),$(_0x1c414b(0x13b))['datepicker']({'dateFormat':_0x1c414b(0xfe),'maxDate':0x0})[_0x1c414b(0xfd)](_0x1c414b(0xff),new Date());},'error':function(_0x343671){var _0x551452=_0x2b607b;console['log']('SetAttendance\x20function\x20failed'),console[_0x551452(0x108)](_0x343671);}}):alert(_0x2b607b(0x120));}function SetAttendanceDDL(){var _0x41910d=a7_0x24c71a,_0x1590b6=_spPageContextInfo[_0x41910d(0x114)],_0x49714d=new Date(ConvertDateTimeFormat($('#timesheetdate')['val'](),'/')),_0x32ed7d=_0x49714d[_0x41910d(0x104)]()+'-'+(_0x49714d[_0x41910d(0x123)]()+0x1)+'-'+_0x49714d[_0x41910d(0x138)]();GetHolidays(_0x32ed7d);var _0xa60474=_spPageContextInfo[_0x41910d(0x11f)]+_0x41910d(0x117)+_0x1590b6+_0x41910d(0xf3)+_0x32ed7d+'\x27';$[_0x41910d(0x13e)]({'url':_0xa60474,'headers':{'Accept':_0x41910d(0x12d)},'async':![],'success':function(_0xec9f4d){var _0x4b6592=_0x41910d,_0x4b5e3a=_0xec9f4d['d'][_0x4b6592(0x122)];_0x4b5e3a[_0x4b6592(0x12b)]>0x0?($(_0x4b6592(0x100))[_0x4b6592(0x111)](_0x4b5e3a[0x0][_0x4b6592(0x109)]),_0x4b5e3a[0x0][_0x4b6592(0x134)]==!![]?($('#AttendanceDDL')[_0x4b6592(0x11c)](_0x4b6592(0x102),!![]),$(_0x4b6592(0x106))[_0x4b6592(0xf6)]('display',_0x4b6592(0x13f)),$(_0x4b6592(0x133))[_0x4b6592(0xf6)](_0x4b6592(0x113),_0x4b6592(0x110))):($(_0x4b6592(0x100))[_0x4b6592(0x11c)](_0x4b6592(0x102),![]),$(_0x4b6592(0x106))[_0x4b6592(0xf6)]('display',_0x4b6592(0x110)),$(_0x4b6592(0x133))['css'](_0x4b6592(0x113),_0x4b6592(0x101)))):($('#AttendanceDDL')[_0x4b6592(0x111)]()=='0'&&$(_0x4b6592(0x100))[_0x4b6592(0x111)]('0'),$('#AttendanceDDL')[_0x4b6592(0x11c)](_0x4b6592(0x102),![]),$(_0x4b6592(0x106))[_0x4b6592(0xf6)](_0x4b6592(0x113),_0x4b6592(0x110)),$('#AttendanceDDL')[_0x4b6592(0x111)]('0'),$('#Submit-attendance')['css'](_0x4b6592(0x113),_0x4b6592(0x101)));},'error':function(_0x379bd2){var _0x27d94d=_0x41910d;console[_0x27d94d(0x108)](_0x27d94d(0x12f)),console[_0x27d94d(0x108)](_0x379bd2);}});}function ConvertDateTimeFormat(_0xd72000,_0x45653c){var _0xaeff0=a7_0x24c71a;return _0xd72000['split'](_0x45653c)[0x1]+''+_0x45653c+''+_0xd72000[_0xaeff0(0xfc)](_0x45653c)[0x0]+''+_0x45653c+''+_0xd72000[_0xaeff0(0xfc)](_0x45653c)[0x2];}var G_ManagerID=0x0;function GetManagerID(){var _0x57b3e6=a7_0x24c71a,_0x53a75c=_spPageContextInfo[_0x57b3e6(0x11f)]+_0x57b3e6(0xf4)+_spPageContextInfo[_0x57b3e6(0x114)]+'\x27)';$['ajax']({'url':_0x53a75c,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x3bc491){var _0x57813d=_0x57b3e6,_0x729413=_0x3bc491['d'][_0x57813d(0x122)];_0x729413[_0x57813d(0x12b)]>0x0?G_ManagerID=_0x729413[0x0][_0x57813d(0x130)]:G_ManagerID=0x0;},'error':function(_0x284774){var _0x1fba38=_0x57b3e6;alert(_0x1fba38(0x10c));}});}function SetCurrentdate(){var _0x4205cd=a7_0x24c71a;$(_0x4205cd(0x13b))[_0x4205cd(0xfd)]({'dateFormat':_0x4205cd(0xfe),'maxDate':0x0})[_0x4205cd(0xfd)](_0x4205cd(0xff),new Date());}var G_Validateholiday=![];function GetHolidays(_0x781e3b){var _0x4e28bc=a7_0x24c71a,_0xbcf70=_spPageContextInfo['webAbsoluteUrl']+_0x4e28bc(0x10e)+Logged_Location+_0x4e28bc(0x128)+_0x781e3b+'\x27\x20and\x20CompanyID\x20eq\x20\x27'+titanForWork[_0x4e28bc(0xf7)]('CompanyId')+'\x27&$top=200&$orderby=Holiday_start\x20asc';$[_0x4e28bc(0x13e)]({'url':_0xbcf70,'headers':{'Accept':_0x4e28bc(0x12d)},'async':![],'success':function(_0x324c47){var _0x4513fd=_0x4e28bc,_0x474c3f=_0x324c47['d']['results'];_0x474c3f['length']>0x0?($(_0x4513fd(0xf5))[_0x4513fd(0x125)](_0x474c3f[0x0][_0x4513fd(0xf8)]),$(_0x4513fd(0x12e))[_0x4513fd(0xf6)](_0x4513fd(0x113),_0x4513fd(0x13f)),G_Validateholiday=!![]):($(_0x4513fd(0xf5))[_0x4513fd(0x125)](''),$(_0x4513fd(0x12e))[_0x4513fd(0xf6)](_0x4513fd(0x113),'none'),G_Validateholiday=![]);},'error':function(_0xe4ec42){var _0x33279d=_0x4e28bc;alert(_0x33279d(0x10c));}});}var AttendanceEntry=!![];function authentication(){var _0x42f23f=a7_0x24c71a,_0x3fd9ef=_spPageContextInfo[_0x42f23f(0x127)],_0x5bd797=_spPageContextInfo[_0x42f23f(0x11f)]+_0x42f23f(0x131);$[_0x42f23f(0x13e)]({'url':_0x5bd797,'async':![],'type':_0x42f23f(0x116),'headers':{'accept':'application/json;\x20odata=verbose'},'success':function(_0x87af3b){var _0x99e325=_0x42f23f,_0x2c79a6=_0x87af3b['d'][_0x99e325(0x122)];if(_0x2c79a6[_0x99e325(0x12b)]>0x0)for(var _0x64e163=0x0;_0x64e163<_0x2c79a6[_0x99e325(0x12b)];_0x64e163++){_0x2c79a6[_0x64e163]['Title']==_0x99e325(0x112)&&(_0x2c79a6[_0x64e163][_0x99e325(0x136)]==![]&&(Attendancechck=![],$('#Timesheet-toggle-li')[_0x99e325(0x135)](),$('#Reports-menu>ul\x20li')['eq'](0x2)[_0x99e325(0xf6)](_0x99e325(0x113),'none'))),_0x2c79a6[_0x64e163][_0x99e325(0xf8)]=='Attendance\x20Entry'&&(_0x2c79a6[_0x64e163]['Active']==![]&&($(_0x99e325(0xfa))[_0x99e325(0x135)](),$(_0x99e325(0x107))['eq'](0x0)['css']('display',_0x99e325(0x110)),$(_0x99e325(0x107))['eq'](0x1)[_0x99e325(0xf6)]('display',_0x99e325(0x110))));}},'error':function(_0x49295d){var _0x3b56c5=_0x42f23f;alert(JSON[_0x3b56c5(0xf1)](_0x49295d));}});}