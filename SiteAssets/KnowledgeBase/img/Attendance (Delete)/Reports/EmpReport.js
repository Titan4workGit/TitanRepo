var a304_0x29d7e7=a304_0x1359;(function(_0xff9944,_0x2c5a67){var _0xe945ca=a304_0x1359,_0x4100ba=_0xff9944();while(!![]){try{var _0x40b384=-parseInt(_0xe945ca(0x125))/0x1*(parseInt(_0xe945ca(0x111))/0x2)+-parseInt(_0xe945ca(0x12d))/0x3*(-parseInt(_0xe945ca(0x131))/0x4)+parseInt(_0xe945ca(0x144))/0x5+parseInt(_0xe945ca(0x15e))/0x6+parseInt(_0xe945ca(0x12b))/0x7+parseInt(_0xe945ca(0x1be))/0x8*(-parseInt(_0xe945ca(0x103))/0x9)+parseInt(_0xe945ca(0x100))/0xa*(-parseInt(_0xe945ca(0x1ad))/0xb);if(_0x40b384===_0x2c5a67)break;else _0x4100ba['push'](_0x4100ba['shift']());}catch(_0x366a79){_0x4100ba['push'](_0x4100ba['shift']());}}}(a304_0x14af,0xf3904));var Totaldays=0x0,CompanyID='',GstartDate='',GEmpID=0x0;$(document)[a304_0x29d7e7(0x138)](function(){var _0x166299=a304_0x29d7e7;ValidateHrAdmin(),initializePeoplePicker(_0x166299(0x1af)),CompanyID=titanForWork['getQueryStringParameter'](_0x166299(0x15d));var _0x3e0093=$[_0x166299(0x166)]('EID'),_0x390787=$[_0x166299(0x166)](_0x166299(0x17c)),_0x142cd3=$['urlParam']('end');if(_0x3e0093!=null){GEmpID=_0x3e0093;var _0x596c3e=_0x390787[_0x166299(0x1a3)](0x0,0x4)+'-'+_0x390787[_0x166299(0x1a3)](0x4,0x6)+'-'+_0x390787['slice'](0x6,0x8),_0x4c6d40=_0x142cd3[_0x166299(0x1a3)](0x0,0x4)+'-'+_0x142cd3['slice'](0x4,0x6)+'-'+_0x142cd3[_0x166299(0x1a3)](0x6,0x8),_0x50bed7=new Date(_0x4c6d40);_0x50bed7[_0x166299(0x1a1)](_0x50bed7[_0x166299(0x162)]()+0x1);var _0x584a29=_0x50bed7[_0x166299(0x19b)](),_0xcb9441=_0x584a29[_0x166299(0x1b0)]('T');GstartDate=_0x596c3e,$('#EmpreportFrom')[_0x166299(0x153)]({'dateFormat':'dd/mm/yy','maxDate':new Date()})[_0x166299(0x153)]('setDate',new Date(_0x596c3e)),$(_0x166299(0x171))[_0x166299(0x153)]({'dateFormat':_0x166299(0x181),'maxDate':new Date()})[_0x166299(0x153)]('setDate',new Date(_0x4c6d40));var _0x3ff6bb=$(_0x166299(0xff))[_0x166299(0x153)](_0x166299(0x162)),_0xbc0906=$(_0x166299(0x171))[_0x166299(0x153)](_0x166299(0x162));days=(_0xbc0906-_0x3ff6bb)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math[_0x166299(0x13c)](days)+0x1,$(_0x166299(0x1bb))['text'](formatDateReportEmp(ConvertDateTimeFormat($('#EmpreportFrom')[_0x166299(0x126)](),'/'))),$(_0x166299(0x1a9))['text'](formatDateReportEmp(ConvertDateTimeFormat($(_0x166299(0x171))[_0x166299(0x126)](),'/')));var _0x119e73=_spPageContextInfo[_0x166299(0x185)]+_0x166299(0x124)+_0x3e0093+_0x166299(0x11c)+CompanyID+'\x27';EmployeeListDat(_0x119e73),LoadAllHolidays();var _0x1ecc3a=_spPageContextInfo['webAbsoluteUrl']+'/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27'+_0x596c3e+_0x166299(0x10b)+_0xcb9441+'\x27\x20and\x20Employee\x20eq\x20\x27'+_0x3e0093+'\x27\x20';EmpReportUsageUrl=_0x1ecc3a,getFileData();var _0x119e73=_spPageContextInfo[_0x166299(0x185)]+_0x166299(0x124)+_0x3e0093+'\x27\x20and\x20Company/ID\x20\x20eq\x20\x27'+CompanyID+'\x27';EmployeeListDat(_0x119e73),LoadAllHolidays();}});var EmployeeID='',ItemID='',SelectedDate='',TDID='';function attendanceEditModal(_0x1543b7,_0x4833a9,_0x3ad5ed){var _0x1bf6f8=a304_0x29d7e7;EmployeeID=0x0,ItemID=0x0,SelectedDate='',TDID=_0x3ad5ed,EmployeeID=_0x1543b7,ItemID=_0x4833a9;var _0x7b78db=_0x3ad5ed[_0x1bf6f8(0xfd)](),_0x4b2166=_0x7b78db['slice'](0x0,0x4)+'-'+_0x7b78db[_0x1bf6f8(0x1a3)](0x4,0x6)+'-'+_0x7b78db[_0x1bf6f8(0x1a3)](0x6,0x8),_0x26793c=new Date(_0x4b2166);SelectedDate=_0x26793c['toISOString']()[_0x1bf6f8(0x1b0)]('T')[0x0];var _0x27d9fc=formatDateReportEmp(_0x26793c);$(_0x1bf6f8(0x159))[_0x1bf6f8(0x133)](_0x27d9fc),GetHolidays(_0x4b2166);}function UpdateAttendance(){ItemID==0x0?(G_Validateholiday==!![]?confirm('This\x20is\x20a\x20Holiday,\x20are\x20you\x20sure\x20to\x20submit\x20your\x20attendance.')&&PushNewAttendance():PushNewAttendance(),Applyfilter(),LoadAllHolidays()):(G_Validateholiday==!![]?confirm('This\x20is\x20a\x20Holiday,\x20are\x20you\x20sure\x20to\x20submit\x20your\x20attendance.')&&ModifyAttendance():ModifyAttendance(),Applyfilter(),LoadAllHolidays());}function PushNewAttendance(){var _0x56fdcb=a304_0x29d7e7;$(_0x56fdcb(0x176))[_0x56fdcb(0x126)]()!=_0x56fdcb(0xf9)||G_Validateholiday==!![]?$[_0x56fdcb(0x16c)]({'url':_spPageContextInfo[_0x56fdcb(0x185)]+'/_api/web/lists/GetByTitle(\x27EmpAttendance\x27)/items','type':'POST','async':![],'data':JSON[_0x56fdcb(0x1a4)]({'__metadata':{'type':_0x56fdcb(0x113)},'AttendanceDate':SelectedDate,'EmployeeId':EmployeeID,'AttendanceType':$(_0x56fdcb(0x176))[_0x56fdcb(0x126)]()}),'headers':{'Accept':_0x56fdcb(0x14a),'Content-Type':'application/json;odata=verbose','X-RequestDigest':$(_0x56fdcb(0xf8))[_0x56fdcb(0x126)](),'X-HTTP-Method':_0x56fdcb(0x155)},'success':function(_0x44ccd8,_0x27f171,_0x3088c1){var _0x48bee5=_0x56fdcb;$(_0x48bee5(0x107)+TDID)['text']($(_0x48bee5(0x176))['val']()),alert(_0x48bee5(0x18d)),$(_0x48bee5(0x178))[_0x48bee5(0x146)]('hide'),GetAttendanceorLeaves();},'error':function(_0x583b56,_0x4a861e,_0x47bbec){var _0x3b5fdb=_0x56fdcb;alert(_0x3b5fdb(0x170));}}):alert(_0x56fdcb(0x11d));}function ModifyAttendance(){var _0x4d24d0=a304_0x29d7e7;$('#AttendanceDDL')[_0x4d24d0(0x126)]()!=_0x4d24d0(0xf9)||G_Validateholiday==!![]?$['ajax']({'url':_spPageContextInfo[_0x4d24d0(0x185)]+_0x4d24d0(0x18a)+ItemID+')','type':'POST','async':![],'data':JSON[_0x4d24d0(0x1a4)]({'__metadata':{'type':_0x4d24d0(0x113)},'AttendanceType':$(_0x4d24d0(0x176))[_0x4d24d0(0x126)]()}),'headers':{'Accept':_0x4d24d0(0x14a),'Content-Type':_0x4d24d0(0x14a),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x4d24d0(0x126)](),'IF-MATCH':'*','X-HTTP-Method':_0x4d24d0(0x160)},'success':function(_0x5d11ed,_0x365f82,_0x5f89a6){var _0xcca6a5=_0x4d24d0;$(_0xcca6a5(0x107)+TDID)[_0xcca6a5(0x133)]($(_0xcca6a5(0x176))[_0xcca6a5(0x126)]()),$(_0xcca6a5(0x11f)+TDID)[_0xcca6a5(0x133)](_0xcca6a5(0x183)),alert(_0xcca6a5(0x18d)),$('#attendance-reportEdit')['modal']('hide'),GetAttendanceorLeaves();},'error':function(_0x499b57,_0xfebc68,_0x437915){var _0x187522=_0x4d24d0;alert(_0x187522(0x170));}}):alert(_0x4d24d0(0x11d));}function initializePeoplePicker(_0xd9f58){var _0x1b3d10=a304_0x29d7e7,_0x1ee362={};_0x1ee362['PrincipalAccountType']='User,DL,SecGroup,SPGroup',_0x1ee362[_0x1b3d10(0x1bf)]=0xf,_0x1ee362[_0x1b3d10(0x120)]=0xf,_0x1ee362[_0x1b3d10(0x177)]=![],_0x1ee362['MaximumEntitySuggestions']=0x32,_0x1ee362[_0x1b3d10(0x1ae)]=_0x1b3d10(0x1bd),this[_0x1b3d10(0x119)](_0xd9f58,null,_0x1ee362);}function Applyfilter(){var _0x787931=a304_0x29d7e7;OpenMyCustomLoader(),EmpReportData=[];var _0x562252=$[_0x787931(0x166)](_0x787931(0x15f)),_0x3c8ae1=$(_0x787931(0xff))['datepicker'](_0x787931(0x162)),_0x3ce4ad=$(_0x787931(0x171))[_0x787931(0x153)](_0x787931(0x162));days=(_0x3ce4ad-_0x3c8ae1)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math['round'](days)+0x1,$(_0x787931(0x1bb))['text'](formatDateReportEmp(ConvertDateTimeFormat($(_0x787931(0xff))['val'](),'/'))),$(_0x787931(0x1a9))['text'](formatDateReportEmp(ConvertDateTimeFormat($('#EmpreportTo')['val'](),'/')));var _0x3fb02b=moment($(_0x787931(0xff))[_0x787931(0x126)](),'DD/MM/YYYY')['format'](_0x787931(0x1a6)),_0x24a22f=moment($(_0x787931(0x171))['val'](),_0x787931(0x1c6))['format'](_0x787931(0x1a6)),_0x467c5b=new Date(_0x24a22f);_0x467c5b[_0x787931(0x1a1)](_0x467c5b[_0x787931(0x162)]()+0x1);var _0x4b7fad=_0x467c5b['toISOString'](),_0x409f98=_0x4b7fad[_0x787931(0x1b0)]('T');GstartDate=_0x3fb02b;var _0x5abde9=ensureUser($(_0x787931(0x1ba))[_0x787931(0x102)]()[_0x787931(0x102)]()[_0x787931(0x1a5)]('id'));if(_0x5abde9==0x0){_0x562252=_0x562252,GEmpID=_0x562252;var _0x3bb027=_spPageContextInfo[_0x787931(0x185)]+_0x787931(0x16e)+_0x3fb02b+_0x787931(0x10b)+_0x409f98+'\x27\x20and\x20Employee\x20eq\x20\x27'+_0x562252+'\x27\x20';EmpReportUsageUrl=_0x3bb027,getFileData();var _0x40b1ea=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27'+_0x562252+'\x27\x20and\x20Company/ID\x20\x20eq\x20\x27'+CompanyID+'\x27';EmployeeListDat(_0x40b1ea);}else{if(ISHRADMIN==!![]){_0x562252=_0x5abde9,GEmpID=_0x5abde9;var _0x3bb027=_spPageContextInfo[_0x787931(0x185)]+_0x787931(0x16e)+_0x3fb02b+'\x27\x20and\x20AttendanceDate\x20le\x20\x27'+_0x409f98+_0x787931(0x10a)+_0x562252+'\x27\x20';EmpReportUsageUrl=_0x3bb027,getFileData();var _0x40b1ea=_spPageContextInfo[_0x787931(0x185)]+_0x787931(0x124)+_0x562252+'\x27\x20and\x20Company/ID\x20\x20eq\x20\x27'+CompanyID+'\x27';EmployeeListDat(_0x40b1ea);}else alert(_0x787931(0x1bc));}LoadAllHolidays();}var DataIdList=[],EmpAttendanceData=[],TotalLeavesorAbsent=[],EmpReportUsageUrl='',EmpReportData=EmpReportData||[];function getFileData(){var _0x428ebf=a304_0x29d7e7;jQuery[_0x428ebf(0x16c)]({'url':EmpReportUsageUrl,'headers':{'Accept':_0x428ebf(0x14a)},'async':!![],'success':function(_0x151eed){var _0x13f3ca=_0x428ebf;EmpReportData=EmpReportData[_0x13f3ca(0x19f)](_0x151eed['d'][_0x13f3ca(0xfa)]);if(_0x151eed['d'][_0x13f3ca(0x16d)])EmpReportUsageUrl=_0x151eed['d'][_0x13f3ca(0x16d)],getFileData();else{if(EmpReportData[_0x13f3ca(0x190)]>0x0){var _0x3740fd=ensureUser($(_0x13f3ca(0x1ba))[_0x13f3ca(0x102)]()['children']()['attr']('id')),_0xcfb43f=$[_0x13f3ca(0x166)](_0x13f3ca(0x15f));_0x3740fd!=0x0?EmpReportData=$[_0x13f3ca(0x19d)](EmpReportData,function(_0x4c8c7f){var _0x40073e=_0x13f3ca;return _0x4c8c7f[_0x40073e(0x1b1)]['ID']==_0x3740fd;}):EmpReportData=$['grep'](EmpReportData,function(_0x3fbb76){var _0x3e9352=_0x13f3ca;return _0x3fbb76[_0x3e9352(0x1b1)]['ID']==_0xcfb43f;});var _0x359fd0=moment(ConvertDateTimeFormat($(_0x13f3ca(0xff))['val'](),'/'))[_0x13f3ca(0x19a)]('MM/DD/YYYY'),_0x3cc283=moment(ConvertDateTimeFormat($(_0x13f3ca(0x171))[_0x13f3ca(0x126)](),'/'))[_0x13f3ca(0x19a)](_0x13f3ca(0x1c7)),_0x3189c4=EmpReportData[_0x13f3ca(0x158)](function(_0x26c6bc){var _0x4cf3be=_0x13f3ca;return Created=moment(_0x26c6bc['AttendanceDate'])['format'](_0x4cf3be(0x1c7)),(_0x359fd0==''?Created!='':Created>=_0x359fd0)&&(_0x3cc283==''?Created!='':Created<=_0x3cc283);});GenerateEmpReport(_0x3189c4);}else{var _0x3189c4=[];GenerateEmpReport(_0x3189c4);}CloseMyCustomLoader();}},'error':function(_0x5d5955,_0x8e2d7d,_0x405ef4){var _0x34780f=_0x428ebf;console[_0x34780f(0x169)](_0x34780f(0x161)),console[_0x34780f(0x169)](_0x5d5955[_0x34780f(0x15b)][_0x34780f(0x13f)]['message']['value']);var _0x1433b6=_0x5d5955[_0x34780f(0x15b)][_0x34780f(0x13f)][_0x34780f(0x109)]['value'],_0x45ff0a=_0x1433b6[_0x34780f(0x17f)](_0x34780f(0x129));if(_0x45ff0a==!![]){EmpReportData=[];var _0x103113=_spPageContextInfo[_0x34780f(0x185)]+'/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=2000';EmpReportUsageUrl=_0x103113,getFileData();}}});}function GenerateEmpReport(_0x490bb7){var _0x34ffe8=a304_0x29d7e7;EmpAttendanceData=[],DataIdList=[];var _0x47685d=[];TotalLeavesorAbsent=[];for(var _0x51c1f2=0x0;_0x51c1f2<_0x490bb7[_0x34ffe8(0x190)];_0x51c1f2++){if(_0x490bb7[_0x51c1f2][_0x34ffe8(0x14f)]!=_0x34ffe8(0x1c5)&&_0x490bb7[_0x51c1f2][_0x34ffe8(0x14f)]!=_0x34ffe8(0xf9))_0x47685d[_0x34ffe8(0x16b)](_0x490bb7[_0x51c1f2]['AttendanceType']);else{if(_0x490bb7[_0x51c1f2][_0x34ffe8(0x14f)]==_0x34ffe8(0x1c5))TotalLeavesorAbsent[_0x34ffe8(0x16b)](_0x490bb7[_0x51c1f2]['AttendanceType']);else _0x490bb7[_0x51c1f2][_0x34ffe8(0x14f)]==_0x34ffe8(0xf9)&&TotalLeavesorAbsent[_0x34ffe8(0x16b)](_0x490bb7[_0x51c1f2][_0x34ffe8(0x14f)]);}var _0x13743f=_0x490bb7[_0x51c1f2]['ID'],_0x4ccc0a=_0x490bb7[_0x51c1f2]['Employee'][_0x34ffe8(0x152)],_0x38e234=_0x490bb7[_0x51c1f2][_0x34ffe8(0x1b1)]['ID'],_0x503c11=formatDateReportEmp(_0x490bb7[_0x51c1f2]['AttendanceDate']),_0x3b7441=_0x490bb7[_0x51c1f2][_0x34ffe8(0x14f)],_0x32d3bf=_0x490bb7[_0x51c1f2][_0x34ffe8(0x104)],_0xdd2886=_0x490bb7[_0x51c1f2][_0x34ffe8(0x11e)];EmpAttendanceData['push']({'UserId':_0x38e234,'EmpName':_0x4ccc0a,'AttendanceDate':_0x503c11,'AttendanceType':_0x3b7441,'AttendanceItemId':_0x13743f,'EmpWorkHours':_0x32d3bf,'HrAction':_0xdd2886});}var _0x1e3355='';$(_0x34ffe8(0x184))[_0x34ffe8(0x122)]();var _0x4de636=0x0,_0x532f6c=0x0;for(var _0x32af20=0x0;_0x32af20<Totaldays;_0x32af20++){var _0x1af066=new Date(GstartDate);_0x1af066[_0x34ffe8(0x1a1)](_0x1af066[_0x34ffe8(0x162)]()+_0x32af20);var _0x5bafe3=moment(_0x1af066,'DD/MM/YYYY')[_0x34ffe8(0x19a)](_0x34ffe8(0x1a6)),_0x5bafe3=_0x5bafe3[_0x34ffe8(0x1b0)]('-')['join']('');DataIdList[_0x34ffe8(0x16b)](_0x5bafe3);var _0x531131=formatDateReportEmp(_0x1af066),_0xd4b527=EmpAttendanceData[_0x34ffe8(0x193)](function(_0x3048e3){return _0x3048e3['AttendanceDate'];})['indexOf'](_0x531131);if(_0xd4b527!=-0x1){var _0x3373f2=EmpAttendanceData[_0xd4b527][_0x34ffe8(0x14f)],_0xe8368a=EmpAttendanceData[_0xd4b527][_0x34ffe8(0x10d)],_0xdd2886=EmpAttendanceData[_0xd4b527][_0x34ffe8(0x11e)],_0x439fbe=EmpAttendanceData[_0xd4b527][_0x34ffe8(0x10e)],_0x2ef761=EmpAttendanceData[_0xd4b527][_0x34ffe8(0x157)],_0x567d63=_0x34ffe8(0x151),_0x58cfd2='block';_0xdd2886==!![]&&(_0x567d63='block',_0x58cfd2=_0x34ffe8(0x151));if(_0x3373f2!='On-Leave'&&_0x3373f2!=_0x34ffe8(0xf9)){if(_0xe8368a==null)var _0x242722=_0x34ffe8(0x12a)+_spPageContextInfo[_0x34ffe8(0x185)]+_0x34ffe8(0x1c1)+_0x5bafe3+_0x34ffe8(0x182)+window[_0x34ffe8(0x15c)]('View')+_0x34ffe8(0x12f)+_0x5bafe3+_0x34ffe8(0x15a);else var _0x242722=_0x34ffe8(0x187)+_spPageContextInfo[_0x34ffe8(0x185)]+_0x34ffe8(0x1c1)+_0x5bafe3+_0x34ffe8(0x182)+window[_0x34ffe8(0x15c)]('View')+_0x34ffe8(0x105)+ConvertHHMM(_0xe8368a)+'</a>';}else var _0x242722='';_0x532f6c=_0x532f6c+0x1,_0x1e3355+=_0x34ffe8(0x1c2),_0x1e3355+=_0x34ffe8(0x1a0)+_0x5bafe3+_0x34ffe8(0x112)+formatDateReportEmp(_0x1af066)+_0x34ffe8(0x121)+_0x5bafe3+_0x34ffe8(0x148),_0x1e3355+=_0x34ffe8(0x12e)+_0x5bafe3+'>'+_0x3373f2+_0x34ffe8(0x19e),_0x1e3355+=_0x34ffe8(0x1c8)+_0x5bafe3+'>'+_0x242722+'</div></td>',_0x1e3355+=_0x34ffe8(0x147)+_0x567d63+_0x34ffe8(0x139),_0x1e3355+='<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27\x20style=\x27display:\x20'+_0x58cfd2+_0x34ffe8(0x17e)+GEmpID+','+_0x2ef761+','+_0x5bafe3+_0x34ffe8(0x165),_0x1e3355+='</tr>';}else{_0x4de636=_0x4de636+0x1;var _0xdb42e1=_0x34ffe8(0x12a)+_spPageContextInfo[_0x34ffe8(0x185)]+_0x34ffe8(0x1c1)+_0x5bafe3+_0x34ffe8(0x182)+window[_0x34ffe8(0x15c)](_0x34ffe8(0x1a7))+_0x34ffe8(0x12f)+_0x5bafe3+_0x34ffe8(0x15a);_0x1e3355+=_0x34ffe8(0x1c2),_0x1e3355+=_0x34ffe8(0x1a0)+_0x5bafe3+_0x34ffe8(0x112)+formatDateReportEmp(_0x1af066)+_0x34ffe8(0x121)+_0x5bafe3+'\x27\x20class=\x27employee-report-holiday\x27></span></div></td>',_0x1e3355+=_0x34ffe8(0x12e)+_0x5bafe3+_0x34ffe8(0x156),_0x1e3355+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Time'+_0x5bafe3+'></div></td>',_0x1e3355+=_0x34ffe8(0x17d),_0x1e3355+=_0x34ffe8(0x150)+GEmpID+',0,'+_0x5bafe3+_0x34ffe8(0x165),_0x1e3355+='</tr>';}}var _0x11ac2d=parseInt(TotalLeavesorAbsent[_0x34ffe8(0x190)])+parseInt(_0x4de636)-parseInt($('#HoliaysTotal')[_0x34ffe8(0x133)]());_0x11ac2d<0x0&&(_0x11ac2d=0x0);$(_0x34ffe8(0x17a))['hide'](),$('#EmpTotalItemscount')[_0x34ffe8(0x133)](Totaldays);var _0x252598=parseInt(_0x532f6c)-parseInt(TotalLeavesorAbsent['length']);$('#Total-Attendance')['text'](Math['abs'](_0x252598)),$(_0x34ffe8(0x184))[_0x34ffe8(0x197)](_0x1e3355),EmpTableConfiguration();}function ConvertDateTimeFormat(_0x32a574,_0x1ef0e8){var _0x4ef3f0=a304_0x29d7e7;return _0x32a574[_0x4ef3f0(0x1b0)](_0x1ef0e8)[0x1]+''+_0x1ef0e8+''+_0x32a574[_0x4ef3f0(0x1b0)](_0x1ef0e8)[0x0]+''+_0x1ef0e8+''+_0x32a574[_0x4ef3f0(0x1b0)](_0x1ef0e8)[0x2];}var GEmployeeID=0x0,LocID=0x0;function EmployeeListDat(_0x8862f9){var _0x286831=a304_0x29d7e7;GEmployeeID=0x0,$[_0x286831(0x16c)]({'url':_0x8862f9,'headers':{'Accept':_0x286831(0x14a)},'async':![],'success':function(_0x50b2a2){var _0x257b58=_0x286831,_0x372ca0=_0x50b2a2['d'][_0x257b58(0xfa)];_0x372ca0['length']>0x0?($(_0x257b58(0x194))[_0x257b58(0x133)](_0x372ca0[0x0][_0x257b58(0x17b)][_0x257b58(0x152)]),GEmployeeID=_0x372ca0[0x0][_0x257b58(0x17b)]['ID'],$(_0x257b58(0x1a2))[_0x257b58(0x133)](_0x372ca0[0x0][_0x257b58(0x17b)][_0x257b58(0x152)]),$(_0x257b58(0x1ca))['text'](_0x372ca0[0x0][_0x257b58(0x1ab)][_0x257b58(0x196)]),$('#officeLocTH')[_0x257b58(0x133)](_0x372ca0[0x0][_0x257b58(0x1ab)][_0x257b58(0x196)]),LocID=_0x372ca0[0x0]['OfficeLocation']['ID']):($(_0x257b58(0x194))[_0x257b58(0x133)](''),$(_0x257b58(0x1ca))['text'](''),LocID=0x0);},'error':function(_0x420180){console['log'](_0x420180);}});}function EmpTableConfiguration(){var _0xcb5747=a304_0x29d7e7;sorter=new TINY['table'][(_0xcb5747(0x1b9))](_0xcb5747(0x1b9),'EmpReportTableData',{'ascclass':'asc','descclass':_0xcb5747(0x167),'evenclass':_0xcb5747(0x13b),'oddclass':_0xcb5747(0x19c),'evenselclass':_0xcb5747(0x142),'oddselclass':_0xcb5747(0x140),'paginate':!![],'size':0xa,'colddid':_0xcb5747(0x163),'currentid':'Empcurrentpage','totalid':'Emptotalpages','startingrecid':'Empstartrecord','endingrecid':_0xcb5747(0x1b4),'totalrecid':_0xcb5747(0x191),'hoverid':_0xcb5747(0x134),'pageddid':_0xcb5747(0x18c),'navid':_0xcb5747(0x108),'sortdir':0x1,'init':!![]});}$[a304_0x29d7e7(0x166)]=function(_0x57bbaf){var _0x584928=a304_0x29d7e7,_0x242188=new RegExp(_0x584928(0x1c0)+_0x57bbaf+'=([^&#]*)')[_0x584928(0x1b2)](window[_0x584928(0x101)][_0x584928(0x18f)]);if(_0x242188==null)return null;return decodeURI(_0x242188[0x1])||0x0;};function formatDateReportEmp(_0x2d99a9){var _0x1e66c2=a304_0x29d7e7,_0x3a457c=[_0x1e66c2(0x180),_0x1e66c2(0x179),_0x1e66c2(0x132),'Wednesday',_0x1e66c2(0x128),_0x1e66c2(0x14c),'Saturday'],_0x573ccc=new Date(_0x2d99a9);if(isNaN(_0x573ccc[_0x1e66c2(0x1b8)]()))return _0x2d99a9;else{var _0xf6377f=new Array();return _0xf6377f[0x0]='Jan',_0xf6377f[0x1]=_0x1e66c2(0x136),_0xf6377f[0x2]=_0x1e66c2(0x1a8),_0xf6377f[0x3]=_0x1e66c2(0x192),_0xf6377f[0x4]='May',_0xf6377f[0x5]=_0x1e66c2(0x130),_0xf6377f[0x6]=_0x1e66c2(0x172),_0xf6377f[0x7]=_0x1e66c2(0x145),_0xf6377f[0x8]=_0x1e66c2(0x11a),_0xf6377f[0x9]='Oct',_0xf6377f[0xa]=_0x1e66c2(0x168),_0xf6377f[0xb]=_0x1e66c2(0xfc),day=_0x573ccc[_0x1e66c2(0x162)](),day<0xa&&(day='0'+day),day+'\x20'+_0xf6377f[_0x573ccc[_0x1e66c2(0x13e)]()]+'\x20'+_0x573ccc[_0x1e66c2(0x18b)]()+',\x20'+_0x3a457c[_0x573ccc['getDay']()];}}function ConvertHHMM(_0x5b51d2){if(_0x5b51d2!=null){var _0x430738=Math['floor'](_0x5b51d2/0x3c),_0x4ab643=_0x5b51d2%0x3c;_0x430738<0xa&&(_0x430738='0'+_0x430738);_0x4ab643<0xa&&(_0x4ab643='0'+_0x4ab643);var _0x1abff4=_0x430738+':'+_0x4ab643;}else var _0x1abff4='';return _0x1abff4;}var AttandenceOnHolidays=0x0,HolidaysListDTL=[];function LoadAllHolidays(){var _0x5aae9e=a304_0x29d7e7;TotalOfficeDays=0x0,HolidaysListDTL=[];var _0x57c8cc=new Date(ConvertDateTimeFormat($(_0x5aae9e(0xff))[_0x5aae9e(0x126)](),'/')),_0x5c60a5=_0x57c8cc[_0x5aae9e(0x18b)]()+'-'+(_0x57c8cc[_0x5aae9e(0x13e)]()+0x1)+'-'+_0x57c8cc[_0x5aae9e(0x162)](),_0x403741=new Date(ConvertDateTimeFormat($(_0x5aae9e(0x171))[_0x5aae9e(0x126)](),'/')),_0x312f70=_0x403741[_0x5aae9e(0x18b)]()+'-'+(_0x403741[_0x5aae9e(0x13e)]()+0x1)+'-'+_0x403741['getDate'](),_0x4ed5c3=_spPageContextInfo['webAbsoluteUrl']+_0x5aae9e(0x14e)+LocID+'\x27\x20and\x20CompanyID\x20eq\x20\x27'+CompanyID+_0x5aae9e(0x189)+_0x5c60a5+_0x5aae9e(0x14d)+_0x312f70+'\x27';$['ajax']({'url':_0x4ed5c3,'headers':{'Accept':_0x5aae9e(0x14a)},'async':![],'success':function(_0x49d973){var _0x4843c5=_0x5aae9e,_0x226f1d=_0x49d973['d'][_0x4843c5(0xfa)][_0x4843c5(0x190)],_0x3b1c05=0x0;for(var _0x399592=0x0;_0x399592<_0x226f1d;_0x399592++){var _0x576bf1=new Date(_0x49d973['d'][_0x4843c5(0xfa)][_0x399592][_0x4843c5(0x164)]),_0x484ac3=moment(_0x576bf1,_0x4843c5(0x1c6))[_0x4843c5(0x19a)](_0x4843c5(0x1a6)),_0x484ac3=_0x484ac3[_0x4843c5(0x1b0)]('-')['join'](''),_0x525db3=_0x49d973['d'][_0x4843c5(0xfa)][_0x399592][_0x4843c5(0x152)];HolidaysListDTL[_0x4843c5(0x16b)]({'Hdate':_0x484ac3,'Title':_0x525db3}),$('#'+_0x484ac3)[_0x4843c5(0x18e)](_0x4843c5(0xfe),_0x4843c5(0x1ac)),$('#H'+_0x484ac3)[_0x4843c5(0x133)](_0x525db3),$(_0x4843c5(0x107)+_0x484ac3)[_0x4843c5(0x133)]()!=''&&(_0x3b1c05=_0x3b1c05+0x1);}AttandenceOnHolidays=0x0;for(var _0x1e71dc=0x0;_0x1e71dc<HolidaysListDTL[_0x4843c5(0x190)];_0x1e71dc++){var _0x25113a=$(_0x4843c5(0x107)+HolidaysListDTL[_0x1e71dc][_0x4843c5(0x117)])['text']();_0x25113a!=''&&_0x25113a!='On-Leave'&&_0x25113a!='Holiday'&&(AttandenceOnHolidays=AttandenceOnHolidays+0x1);}var _0x4f4415=0x0,_0x182a98=0x0,_0xd813c0=0x0;for(var _0x168f36=0x0;_0x168f36<DataIdList['length'];_0x168f36++){var _0x358ac1=$(_0x4843c5(0x107)+DataIdList[_0x168f36])['text']();(_0x358ac1==''||_0x358ac1==_0x4843c5(0x1c5))&&(_0x182a98=_0x182a98+0x1),_0x358ac1==_0x4843c5(0x1c5)&&(_0xd813c0=_0xd813c0+0x1),_0x358ac1==_0x4843c5(0xf9)&&(_0x4f4415=_0x4f4415+0x1);}var _0x553abe=_0x182a98+AttandenceOnHolidays-(_0x226f1d-_0x4f4415);_0x553abe<0x0&&(_0x553abe=0x0),_0x553abe!='0'?$('#Total-Leave-Absent')[_0x4843c5(0x133)](_0x553abe):_0xd813c0>0x0&&$(_0x4843c5(0x137))[_0x4843c5(0x133)](_0xd813c0),$('#HoliaysTotal')['text'](_0x226f1d),$(_0x4843c5(0x11b))[_0x4843c5(0x133)](parseInt(Totaldays)-parseInt(_0x226f1d)),$(_0x4843c5(0x116))[_0x4843c5(0x133)](formatDateReportEmp(ConvertDateTimeFormat($(_0x4843c5(0xff))[_0x4843c5(0x126)](),'/'))),$(_0x4843c5(0x1b3))['text'](formatDateReportEmp(ConvertDateTimeFormat($(_0x4843c5(0x171))[_0x4843c5(0x126)](),'/'))),$(_0x4843c5(0x149))[_0x4843c5(0x133)](parseInt(Totaldays)-parseInt(_0x226f1d)),$(_0x4843c5(0x198))['text'](_0x226f1d);},'myError':function(_0x4fb935){}});}function ensureUser(_0x5c9482){var _0x53f3b2=a304_0x29d7e7,_0x37bd7f=0x0,_0x4d10cd=_0x5c9482,_0x999829=this[_0x53f3b2(0x114)][_0x53f3b2(0x195)][_0x4d10cd],_0xa6ef60=_0x999829[_0x53f3b2(0x1c3)](),_0x3b5ae8=_0xa6ef60[0x0];if(_0x3b5ae8){var _0x1f3a2e={'logonName':_0x3b5ae8[_0x53f3b2(0x175)]};$[_0x53f3b2(0x16c)]({'url':_spPageContextInfo[_0x53f3b2(0x185)]+_0x53f3b2(0x1b5),'type':_0x53f3b2(0x155),'async':![],'contentType':_0x53f3b2(0x14a),'data':JSON['stringify'](_0x1f3a2e),'headers':{'X-RequestDigest':$(_0x53f3b2(0xf8))[_0x53f3b2(0x126)](),'accept':_0x53f3b2(0x14a)},'success':function(_0x31273e,_0x43ec51,_0x75d3ad){_0x37bd7f=_0x31273e['d']['Id'];},'error':function(_0x111f90,_0x5aa24b,_0x382ee6){}});}else _0x37bd7f=0x0;return _0x37bd7f;}var tableToExcel=(function(){var _0x56b975=a304_0x29d7e7,_0x4e3d2d=_0x56b975(0x1b6),_0x49427c=_0x56b975(0x13d),_0xfd02af=function(_0x5ae9ea){return window['btoa'](unescape(encodeURIComponent(_0x5ae9ea)));},_0x17993b=function(_0x4a6221,_0x494dd2){var _0x335165=_0x56b975;return _0x4a6221[_0x335165(0x188)](/{(\w+)}/g,function(_0x3e5dd0,_0x2e00b8){return _0x494dd2[_0x2e00b8];});};return function(_0x309ac5,_0x50524a){var _0x2ae56b=_0x56b975;if(!_0x309ac5[_0x2ae56b(0x16f)])_0x309ac5=document['getElementById'](_0x309ac5);var _0x1b290a={'worksheet':_0x50524a||_0x2ae56b(0x1cb),'table':_0x309ac5[_0x2ae56b(0x123)]};window[_0x2ae56b(0x101)]['href']=_0x4e3d2d+_0xfd02af(_0x17993b(_0x49427c,_0x1b290a));};}()),ISHRADMIN=![];function a304_0x14af(){var _0x592b47=['AttendanceDate','EmpWorkHours','UserId','ProcessApprovers','\x27&$top=200&$orderby=Holiday_start\x20asc','2946gCmCHU','><span>','SP.Data.EmpAttendanceListItem','SPClientPeoplePicker','ModalDialog','#FdateTH','Hdate','abs','SPClientPeoplePicker_InitStandaloneControlWrapper','Sept','#Workingdays','\x27\x20and\x20Company/ID\x20\x20eq\x20\x27','Plese\x20select\x20proper\x20attandence.','HrAction','#Timeview','ResolvePrincipalSource','</span><span\x20id=\x27H','empty','innerHTML','/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27','1169EzDqsL','val','\x27\x20and\x20(WebPartName\x20eq\x20\x27HR\x20Admin\x27)','Thursday','it\x20exceeds\x20the\x20list\x20view','<a\x20class=\x27LinkBtn\x27\x20href=\x27','8092084ZpIosC','\x27)/items?$select=*,Department/DepartmentName,Department/ID&$expand=Department&$filter=CompanyId\x20eq\x20\x27','3aLGLPT','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Att','&sourcelocation=../Pages/Myworkplace.aspx\x27\x20><span\x20id=\x27Timeview','Jun','7088980LBYeAH','Tuesday','text','selectedrow','\x27)and\x20Holiday_start\x20eq\x20\x27','Feb','#Total-Leave-Absent','ready','\x20\x27><label><i\x20class=\x27fa\x20fa-check\x27\x20aria-hidden=\x27true\x27\x20style=\x27color:\x20red;\x27></i></label></div></td>','getQueryStringParameter','evenrow','round','<html\x20xmlns:o=\x22urn:schemas-microsoft-com:office:office\x22\x20xmlns:x=\x22urn:schemas-microsoft-com:office:excel\x22\x20xmlns=\x22http://www.w3.org/TR/REC-html40\x22><head><!--[if\x20gte\x20mso\x209]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>','getMonth','error','oddselected','\x27\x20and\x20CompanyID\x20eq\x20\x27','evenselected','#HoliaysTotal','5347015CDLIir','Aug','modal','<td><div\x20class=\x27checkbox\x20m-0\x27\x20style=\x27display:\x20','\x27\x20class=\x27employee-report-holiday\x27></span></div></td>','#TotalWorkdayTH','application/json;odata=verbose','userId','Friday','\x27\x20and\x20Holiday_start\x20le\x20\x27','/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?select=*,ID,Title&$filter=OfficeLocationID\x20eq\x20\x27','AttendanceType','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27><a\x20href=\x27#\x27\x20class=\x27custom-edit-btn\x27\x20data-toggle=\x27modal\x27\x20data-target=\x27#attendance-reportEdit\x27\x20onclick=\x27attendanceEditModal(','none','Title','datepicker','#HolidayMessage','POST','></div></td>','AttendanceItemId','filter','#SelDate','\x27>Fill</span></a>','responseJSON','btoa','CompanyId','8777688baqZYY','EID','MERGE','Error\x20in\x20getFileData.','getDate','columns','Holiday_start',')\x27><i\x20class=\x27fa\x20fa-pencil\x27></i></a></div></td>','urlParam','desc','Nov','log','Loading...','push','ajax','__next','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$orderby\x20=\x20AttendanceDate\x20asc&$filter=AttendanceDate\x20ge\x20\x27','nodeType','Error!\x20Something\x20went\x20wrong.','#EmpreportTo','Jul','hide','#HolidayMessagediv','Key','#AttendanceDDL','AllowMultipleValues','#attendance-reportEdit','Monday','.NoRecordFound','LogonName','start','<td><div\x20class=\x27checkbox\x20m-0\x27></div></td>','\x20\x27><a\x20href=\x27#\x27\x20class=\x27custom-edit-btn\x27\x20data-toggle=\x27modal\x27\x20data-target=\x27#attendance-reportEdit\x27\x20onclick=\x27attendanceEditModal(','includes','Sunday','dd/mm/yy','&Mode=','00:00','#EmpReportTable','webAbsoluteUrl','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27','<a\x20href=\x27','replace','\x27\x20and\x20Holiday_start\x20ge\x20\x27','/_api/web/lists/GetByTitle(\x27EmpAttendance\x27)/items(','getFullYear','Emppagedropdown','Data\x20has\x20been\x20saved.','css','href','length','Emptotalrecords','Apr','map','#EmpName','SPClientPeoplePickerDict','OfficeName','append','#HolidaysTH','#EmpTotalItemscount','format','toISOString','oddrow','grep','</div></td>','concat','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=','setDate','#EmpTitle','slice','stringify','attr','YYYY-MM-DD','View','Mar','#EndDate','#Total-Attendance','OfficeLocation','red','143HDeJDh','Width','EmployeeName','split','Employee','exec','#EdateTH','Empendrecord','/_api/web/ensureuser','data:application/vnd.ms-excel;base64,','display','getTime','sorter','#EmployeeName','#StartDate','Unauthorized\x20access!','280px','3128PXGdhS','SearchPrincipalSource','[?&]','/Pages/TimeSheetEntry.aspx?WebAppId=2&Recall=','<tr\x20class=\x27text-center\x27\x20>','GetAllUserInfo','<br\x20/>Please\x20wait!!','On-Leave','DD/MM/YYYY','MM/DD/YYYY','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Time','get','#OfficeLoc','Worksheet','#__REQUESTDIGEST','Holiday','results','indexOf','Dec','toString','color','#EmpreportFrom','603740inetvF','location','children','45027rNtVVP','WorkHours','&sourcelocation=../Pages/Myworkplace.aspx\x27>','block','#Att','tablenav','message','\x27\x20and\x20Employee\x20eq\x20\x27','\x27\x20and\x20AttendanceDate\x20le\x20\x27'];a304_0x14af=function(){return _0x592b47;};return a304_0x14af();}function ValidateHrAdmin(){var _0x38a89e=a304_0x29d7e7,_0x4c0d85=_0x38a89e(0x10f),_0x2eae06=_spPageContextInfo[_0x38a89e(0x185)]+'/_api/web/lists/getbytitle(\x27'+_0x4c0d85+_0x38a89e(0x12c)+titanForWork[_0x38a89e(0x13a)](_0x38a89e(0x15d))+'\x27\x20and\x20ContributorsId\x20eq\x20\x27'+_spPageContextInfo[_0x38a89e(0x14b)]+_0x38a89e(0x127);$[_0x38a89e(0x16c)]({'url':_0x2eae06,'async':![],'type':_0x38a89e(0x1c9),'headers':{'Accept':'application/json;odata=verbose'},'success':function(_0x548ae6){var _0x4c3ddf=_0x38a89e,_0x25075f=_0x548ae6['d'][_0x4c3ddf(0xfa)];_0x25075f[_0x4c3ddf(0x190)]>0x0?($('#EmpRow')[_0x4c3ddf(0x18e)]('display',_0x4c3ddf(0x106)),ISHRADMIN=!![]):(ISHRADMIN=![],$('#EmpRow')[_0x4c3ddf(0x173)]());},'error':function(_0x1e0793){var _0x4a343a=_0x38a89e;console[_0x4a343a(0x169)](_0x1e0793['responseJSON'][_0x4a343a(0x13f)]);}});}function GetAttendanceorLeaves(){var _0x3b40ec=a304_0x29d7e7,_0x4cae68=$['urlParam'](_0x3b40ec(0x15f)),_0x43ecd4=$(_0x3b40ec(0xff))[_0x3b40ec(0x153)](_0x3b40ec(0x162)),_0x25aeb7=$(_0x3b40ec(0x171))[_0x3b40ec(0x153)](_0x3b40ec(0x162));days=(_0x25aeb7-_0x43ecd4)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math[_0x3b40ec(0x13c)](days)+0x1,$(_0x3b40ec(0x1bb))[_0x3b40ec(0x133)](formatDateReportEmp(ConvertDateTimeFormat($(_0x3b40ec(0xff))[_0x3b40ec(0x126)](),'/'))),$(_0x3b40ec(0x1a9))[_0x3b40ec(0x133)](formatDateReportEmp(ConvertDateTimeFormat($(_0x3b40ec(0x171))[_0x3b40ec(0x126)](),'/')));var _0x198962=moment($(_0x3b40ec(0xff))[_0x3b40ec(0x126)](),_0x3b40ec(0x1c6))[_0x3b40ec(0x19a)]('YYYY-MM-DD'),_0x5b690c=moment($(_0x3b40ec(0x171))[_0x3b40ec(0x126)](),_0x3b40ec(0x1c6))[_0x3b40ec(0x19a)](_0x3b40ec(0x1a6)),_0x187dd0=new Date(_0x5b690c);_0x187dd0[_0x3b40ec(0x1a1)](_0x187dd0[_0x3b40ec(0x162)]()+0x1);var _0x43d090=_0x187dd0[_0x3b40ec(0x19b)](),_0x266950=_0x43d090[_0x3b40ec(0x1b0)]('T');GstartDate=_0x198962;var _0x2c2925=ensureUser($(_0x3b40ec(0x1ba))['children']()[_0x3b40ec(0x102)]()[_0x3b40ec(0x1a5)]('id'));if(_0x2c2925==0x0){var _0x3f53f6=_spPageContextInfo[_0x3b40ec(0x185)]+_0x3b40ec(0x124)+_0x4cae68+'\x27\x20and\x20Company/ID\x20\x20eq\x20\x27'+CompanyID+'\x27';EmployeeListDat(_0x3f53f6),LoadAllHolidays(),_0x4cae68=_0x4cae68,GEmpID=_0x4cae68;var _0x2fb1cf=_spPageContextInfo['webAbsoluteUrl']+'/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27'+_0x198962+_0x3b40ec(0x10b)+_0x266950+_0x3b40ec(0x10a)+_0x4cae68+'\x27\x20';UpdateHeaderfields(_0x2fb1cf);}else{if(ISHRADMIN==!![]){_0x4cae68=_0x2c2925,GEmpID=_0x2c2925;var _0x3f53f6=_spPageContextInfo[_0x3b40ec(0x185)]+_0x3b40ec(0x124)+_0x4cae68+'\x27\x20and\x20Company/ID\x20\x20eq\x20\x27'+CompanyID+'\x27';EmployeeListDat(_0x3f53f6),LoadAllHolidays();var _0x2fb1cf=_spPageContextInfo['webAbsoluteUrl']+_0x3b40ec(0x186)+_0x198962+'\x27\x20and\x20AttendanceDate\x20le\x20\x27'+_0x266950+_0x3b40ec(0x10a)+_0x4cae68+'\x27\x20';UpdateHeaderfields(_0x2fb1cf);var _0x3f53f6=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27'+_0x4cae68+'\x27\x20and\x20Company/ID\x20\x20eq\x20\x27'+CompanyID+'\x27';}else alert(_0x3b40ec(0x1bc));}LoadAllHolidays();}function GetFilterData(_0x502e4b){var _0x2a4c59=a304_0x29d7e7;jQuery[_0x2a4c59(0x16c)]({'url':_0x502e4b,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x316921){var _0x4b41fa=_0x2a4c59,_0x1e394d=_0x316921['d'][_0x4b41fa(0xfa)],_0x358cd9=[];TotalLeavesorAbsent=[];for(var _0x177532=0x0;_0x177532<_0x1e394d[_0x4b41fa(0x190)];_0x177532++){if(_0x1e394d[_0x177532][_0x4b41fa(0x14f)]!=_0x4b41fa(0x1c5)&&_0x1e394d[_0x177532][_0x4b41fa(0x14f)]!=_0x4b41fa(0xf9))_0x358cd9[_0x4b41fa(0x16b)](_0x1e394d[_0x177532][_0x4b41fa(0x14f)]);else _0x1e394d[_0x177532][_0x4b41fa(0x14f)]=='On-Leave'&&TotalLeavesorAbsent['push'](_0x1e394d[_0x177532][_0x4b41fa(0x14f)]);}$(_0x4b41fa(0x1aa))[_0x4b41fa(0x133)](_0x358cd9[_0x4b41fa(0x190)]);},'error':function(_0x5ebe84,_0x3f471c){console['log'](JSON['stringify'](_0x5ebe84));}});}var G_Validateholiday=![];function GetHolidays(_0xad7fe){var _0x242cfa=a304_0x29d7e7,_0x4547ce=_spPageContextInfo[_0x242cfa(0x185)]+'/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?$filter=OfficeLocationID\x20eq\x20(\x27'+LocID+_0x242cfa(0x135)+_0xad7fe+_0x242cfa(0x141)+titanForWork[_0x242cfa(0x13a)]('CompanyId')+_0x242cfa(0x110);$['ajax']({'url':_0x4547ce,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x370548){var _0x25c065=_0x242cfa,_0x265b43=_0x370548['d'][_0x25c065(0xfa)];_0x265b43[_0x25c065(0x190)]>0x0?($('#HolidayMessagediv')[_0x25c065(0x133)](_0x265b43[0x0][_0x25c065(0x152)]),$(_0x25c065(0x154))[_0x25c065(0x18e)](_0x25c065(0x1b7),_0x25c065(0x106)),G_Validateholiday=!![]):($(_0x25c065(0x174))[_0x25c065(0x133)](''),$(_0x25c065(0x154))['css']('display','none'),G_Validateholiday=![]);},'error':function(_0x390d5b){alert('An\x20error\x20occurred.\x20Please\x20try\x20again.');}});}var EmpAttendanceData=[],TotalLeavesorAbsent=[];function a304_0x1359(_0x23a0e8,_0x481a70){var _0x14af05=a304_0x14af();return a304_0x1359=function(_0x1359d7,_0x4b1a58){_0x1359d7=_0x1359d7-0xf8;var _0x539252=_0x14af05[_0x1359d7];return _0x539252;},a304_0x1359(_0x23a0e8,_0x481a70);}function UpdateHeaderfields(_0x222d98){var _0x536830=a304_0x29d7e7;jQuery['ajax']({'url':_0x222d98,'headers':{'Accept':_0x536830(0x14a)},'async':!![],'success':function(_0x1d0d84){var _0x14d895=_0x536830;EmpAttendanceData=[];var _0x4b376b=_0x1d0d84['d'][_0x14d895(0xfa)],_0x541acf=[];TotalLeavesorAbsent=[];for(var _0x9e9c5c=0x0;_0x9e9c5c<_0x4b376b[_0x14d895(0x190)];_0x9e9c5c++){if(_0x4b376b[_0x9e9c5c][_0x14d895(0x14f)]!=_0x14d895(0x1c5)&&_0x4b376b[_0x9e9c5c][_0x14d895(0x14f)]!=_0x14d895(0xf9))_0x541acf[_0x14d895(0x16b)](_0x4b376b[_0x9e9c5c][_0x14d895(0x14f)]);else{if(_0x4b376b[_0x9e9c5c][_0x14d895(0x14f)]==_0x14d895(0x1c5))TotalLeavesorAbsent['push'](_0x4b376b[_0x9e9c5c][_0x14d895(0x14f)]);else _0x4b376b[_0x9e9c5c][_0x14d895(0x14f)]==_0x14d895(0xf9)&&TotalLeavesorAbsent[_0x14d895(0x16b)](_0x4b376b[_0x9e9c5c][_0x14d895(0x14f)]);}var _0x508cb7=_0x4b376b[_0x9e9c5c]['ID'],_0x32b034=_0x4b376b[_0x9e9c5c]['Employee'][_0x14d895(0x152)],_0x123b61=_0x4b376b[_0x9e9c5c]['Employee']['ID'],_0xf8f9a9=formatDateReportEmp(_0x4b376b[_0x9e9c5c][_0x14d895(0x10c)]),_0x590cfd=_0x4b376b[_0x9e9c5c][_0x14d895(0x14f)],_0x54500b=_0x4b376b[_0x9e9c5c][_0x14d895(0x104)],_0x51e906=_0x4b376b[_0x9e9c5c][_0x14d895(0x11e)];EmpAttendanceData['push']({'UserId':_0x123b61,'EmpName':_0x32b034,'AttendanceDate':_0xf8f9a9,'AttendanceType':_0x590cfd,'AttendanceItemId':_0x508cb7,'EmpWorkHours':_0x54500b,'HrAction':_0x51e906});}var _0x5e8dd7='',_0x1c7f4a=0x0,_0xa4b044=0x0;for(var _0x3107f4=0x0;_0x3107f4<Totaldays;_0x3107f4++){var _0x29629b=new Date(GstartDate);_0x29629b[_0x14d895(0x1a1)](_0x29629b[_0x14d895(0x162)]()+_0x3107f4);var _0x683378=moment(_0x29629b,_0x14d895(0x1c6))[_0x14d895(0x19a)](_0x14d895(0x1a6)),_0x683378=_0x683378[_0x14d895(0x1b0)]('-')['join'](''),_0x3b1814=formatDateReportEmp(_0x29629b),_0x57dbf1=EmpAttendanceData['map'](function(_0x4182fd){var _0x544c20=_0x14d895;return _0x4182fd[_0x544c20(0x10c)];})[_0x14d895(0xfb)](_0x3b1814);if(_0x57dbf1!=-0x1){var _0x33523b=EmpAttendanceData[_0x57dbf1][_0x14d895(0x14f)],_0xc0870e=EmpAttendanceData[_0x57dbf1][_0x14d895(0x10d)],_0x51e906=EmpAttendanceData[_0x57dbf1][_0x14d895(0x11e)],_0x19a9c7=EmpAttendanceData[_0x57dbf1][_0x14d895(0x10e)],_0x53cb19=EmpAttendanceData[_0x57dbf1][_0x14d895(0x157)];_0xa4b044=_0xa4b044+0x1;}else _0x1c7f4a=_0x1c7f4a+0x1;}var _0x573caa=parseInt(TotalLeavesorAbsent['length'])+parseInt(_0x1c7f4a)-parseInt($(_0x14d895(0x143))[_0x14d895(0x133)]());_0x573caa<0x0&&(_0x573caa=0x0);$(_0x14d895(0x199))[_0x14d895(0x133)](Totaldays);var _0x2b8228=parseInt(_0xa4b044)-parseInt(TotalLeavesorAbsent[_0x14d895(0x190)]);$('#Total-Attendance')[_0x14d895(0x133)](Math[_0x14d895(0x118)](_0x2b8228));},'error':function(_0x295d5b,_0x413473){var _0x2283ca=_0x536830;console[_0x2283ca(0x169)](JSON[_0x2283ca(0x1a4)](_0x295d5b));}});}function OpenMyCustomLoader(){var _0x4e60b3=a304_0x29d7e7,_0x3c8e0e=_0x4e60b3(0x16a),_0x3fee12=_0x4e60b3(0x1c4),_0x19792f=0xc8,_0x5ca12e=0x190;currentDlg=SP['UI'][_0x4e60b3(0x115)]['showWaitScreenWithNoClose'](_0x3c8e0e,_0x3fee12,_0x19792f,_0x5ca12e);}function CloseMyCustomLoader(){currentDlg['close']();}