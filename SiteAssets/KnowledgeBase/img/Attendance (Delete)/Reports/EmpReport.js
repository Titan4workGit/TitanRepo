var a290_0x3d8d26=a290_0x1acd;(function(_0x130904,_0xe54355){var _0x1fd666=a290_0x1acd,_0x449d3e=_0x130904();while(!![]){try{var _0x59687c=-parseInt(_0x1fd666(0x120))/0x1+-parseInt(_0x1fd666(0xaf))/0x2+parseInt(_0x1fd666(0x10d))/0x3*(parseInt(_0x1fd666(0xe5))/0x4)+parseInt(_0x1fd666(0xf3))/0x5*(-parseInt(_0x1fd666(0x10c))/0x6)+-parseInt(_0x1fd666(0x13a))/0x7*(parseInt(_0x1fd666(0x10e))/0x8)+parseInt(_0x1fd666(0xc7))/0x9*(parseInt(_0x1fd666(0xe3))/0xa)+parseInt(_0x1fd666(0x106))/0xb;if(_0x59687c===_0xe54355)break;else _0x449d3e['push'](_0x449d3e['shift']());}catch(_0x26d49d){_0x449d3e['push'](_0x449d3e['shift']());}}}(a290_0x16ab,0x1ba5c));var Totaldays=0x0,CompanyID='',GstartDate='',GEmpID=0x0;function a290_0x1acd(_0x5a0935,_0x48c5fa){var _0x16ab40=a290_0x16ab();return a290_0x1acd=function(_0x1acd7c,_0x48d6ce){_0x1acd7c=_0x1acd7c-0xae;var _0x15b381=_0x16ab40[_0x1acd7c];return _0x15b381;},a290_0x1acd(_0x5a0935,_0x48c5fa);}$(document)[a290_0x3d8d26(0x119)](function(){var _0x1878d7=a290_0x3d8d26;ValidateHrAdmin(),initializePeoplePicker(_0x1878d7(0x104)),CompanyID=titanForWork[_0x1878d7(0x136)]('CompanyId');var _0x535720=$[_0x1878d7(0x15c)]('EID'),_0x42a9e6=$[_0x1878d7(0x15c)](_0x1878d7(0x126)),_0x2f5029=$[_0x1878d7(0x15c)](_0x1878d7(0xb8));if(_0x535720!=null){GEmpID=_0x535720;var _0x3b925e=_0x42a9e6[_0x1878d7(0xb6)](0x0,0x4)+'-'+_0x42a9e6['slice'](0x4,0x6)+'-'+_0x42a9e6[_0x1878d7(0xb6)](0x6,0x8),_0x11150c=_0x2f5029['slice'](0x0,0x4)+'-'+_0x2f5029[_0x1878d7(0xb6)](0x4,0x6)+'-'+_0x2f5029[_0x1878d7(0xb6)](0x6,0x8),_0x57025b=new Date(_0x11150c);_0x57025b[_0x1878d7(0xd9)](_0x57025b['getDate']()+0x1);var _0x441d55=_0x57025b['toISOString'](),_0x1c6b25=_0x441d55['split']('T');GstartDate=_0x3b925e,$('#EmpreportFrom')[_0x1878d7(0x137)]({'dateFormat':_0x1878d7(0x149),'maxDate':new Date()})['datepicker']('setDate',new Date(_0x3b925e)),$(_0x1878d7(0x10f))[_0x1878d7(0x137)]({'dateFormat':_0x1878d7(0x149),'maxDate':new Date()})[_0x1878d7(0x137)](_0x1878d7(0xd9),new Date(_0x11150c));var _0x5d6153=$(_0x1878d7(0xe7))[_0x1878d7(0x137)]('getDate'),_0x2a99fb=$(_0x1878d7(0x10f))[_0x1878d7(0x137)]('getDate');days=(_0x2a99fb-_0x5d6153)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math['round'](days)+0x1,$('#StartDate')['text'](formatDateReportEmp(ConvertDateTimeFormat($('#EmpreportFrom')[_0x1878d7(0x143)](),'/'))),$(_0x1878d7(0xfd))[_0x1878d7(0x133)](formatDateReportEmp(ConvertDateTimeFormat($(_0x1878d7(0x10f))['val'](),'/')));var _0x205253=_spPageContextInfo[_0x1878d7(0xcf)]+_0x1878d7(0x147)+_0x535720+'\x27\x20and\x20Company/ID\x20\x20eq\x20\x27'+CompanyID+'\x27';EmployeeListDat(_0x205253),LoadAllHolidays();var _0x1ab007=_spPageContextInfo['webAbsoluteUrl']+_0x1878d7(0x16a)+_0x3b925e+'\x27\x20and\x20AttendanceDate\x20le\x20\x27'+_0x1c6b25+'\x27\x20and\x20Employee\x20eq\x20\x27'+_0x535720+'\x27\x20';EmpReportUsageUrl=_0x1ab007,getFileData();var _0x205253=_spPageContextInfo[_0x1878d7(0xcf)]+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27'+_0x535720+_0x1878d7(0xbb)+CompanyID+'\x27';EmployeeListDat(_0x205253),LoadAllHolidays();}});var EmployeeID='',ItemID='',SelectedDate='',TDID='';function attendanceEditModal(_0x5b45d6,_0x1779cd,_0x4b39ad){var _0x4c349f=a290_0x3d8d26;EmployeeID=0x0,ItemID=0x0,SelectedDate='',TDID=_0x4b39ad,EmployeeID=_0x5b45d6,ItemID=_0x1779cd;var _0x294f54=_0x4b39ad[_0x4c349f(0x162)](),_0x59fc00=_0x294f54[_0x4c349f(0xb6)](0x0,0x4)+'-'+_0x294f54[_0x4c349f(0xb6)](0x4,0x6)+'-'+_0x294f54[_0x4c349f(0xb6)](0x6,0x8),_0x2449e9=new Date(_0x59fc00);SelectedDate=_0x2449e9['toISOString']()['split']('T')[0x0];var _0x37d043=formatDateReportEmp(_0x2449e9);$(_0x4c349f(0x139))[_0x4c349f(0x133)](_0x37d043),GetHolidays(_0x59fc00);}function UpdateAttendance(){var _0x51bd58=a290_0x3d8d26;ItemID==0x0?(G_Validateholiday==!![]?confirm(_0x51bd58(0xff))&&PushNewAttendance():PushNewAttendance(),Applyfilter(),LoadAllHolidays()):(G_Validateholiday==!![]?confirm(_0x51bd58(0xff))&&ModifyAttendance():ModifyAttendance(),Applyfilter(),LoadAllHolidays());}function PushNewAttendance(){var _0x40ff2d=a290_0x3d8d26;$(_0x40ff2d(0x182))[_0x40ff2d(0x143)]()!=_0x40ff2d(0xc6)||G_Validateholiday==!![]?$['ajax']({'url':_spPageContextInfo[_0x40ff2d(0xcf)]+'/_api/web/lists/GetByTitle(\x27EmpAttendance\x27)/items','type':_0x40ff2d(0xeb),'async':![],'data':JSON[_0x40ff2d(0x155)]({'__metadata':{'type':_0x40ff2d(0xc4)},'AttendanceDate':SelectedDate,'EmployeeId':EmployeeID,'AttendanceType':$(_0x40ff2d(0x182))[_0x40ff2d(0x143)]()}),'headers':{'Accept':_0x40ff2d(0x15b),'Content-Type':_0x40ff2d(0x15b),'X-RequestDigest':$(_0x40ff2d(0x12c))[_0x40ff2d(0x143)](),'X-HTTP-Method':'POST'},'success':function(_0x38c655,_0x83ea8f,_0x210a75){var _0x29bb80=_0x40ff2d;$(_0x29bb80(0x121)+TDID)['text']($(_0x29bb80(0x182))[_0x29bb80(0x143)]()),alert(_0x29bb80(0x144)),$(_0x29bb80(0xb7))['modal'](_0x29bb80(0x13e)),GetAttendanceorLeaves();},'error':function(_0x27a9be,_0x4d0bfa,_0x24b36e){var _0x476f58=_0x40ff2d;alert(_0x476f58(0xb1));}}):alert(_0x40ff2d(0xf6));}function ModifyAttendance(){var _0xf92154=a290_0x3d8d26;$(_0xf92154(0x182))['val']()!=_0xf92154(0xc6)||G_Validateholiday==!![]?$[_0xf92154(0x171)]({'url':_spPageContextInfo[_0xf92154(0xcf)]+_0xf92154(0x156)+ItemID+')','type':_0xf92154(0xeb),'async':![],'data':JSON[_0xf92154(0x155)]({'__metadata':{'type':_0xf92154(0xc4)},'AttendanceType':$(_0xf92154(0x182))['val']()}),'headers':{'Accept':_0xf92154(0x15b),'Content-Type':_0xf92154(0x15b),'X-RequestDigest':$(_0xf92154(0x12c))['val'](),'IF-MATCH':'*','X-HTTP-Method':_0xf92154(0x11d)},'success':function(_0x24ebba,_0x3cd107,_0x443088){var _0x1e3ffd=_0xf92154;$(_0x1e3ffd(0x121)+TDID)[_0x1e3ffd(0x133)]($(_0x1e3ffd(0x182))[_0x1e3ffd(0x143)]()),$(_0x1e3ffd(0x125)+TDID)['text']('00:00'),alert(_0x1e3ffd(0x144)),$(_0x1e3ffd(0xb7))[_0x1e3ffd(0x150)](_0x1e3ffd(0x13e)),GetAttendanceorLeaves();},'error':function(_0x24b6de,_0x13771e,_0x47ce22){var _0x48ad96=_0xf92154;alert(_0x48ad96(0xb1));}}):alert('Plese\x20select\x20proper\x20attandence.');}function initializePeoplePicker(_0x5534c8){var _0x23b14b=a290_0x3d8d26,_0x2ad55f={};_0x2ad55f[_0x23b14b(0x185)]='User,DL,SecGroup,SPGroup',_0x2ad55f[_0x23b14b(0x140)]=0xf,_0x2ad55f[_0x23b14b(0x10b)]=0xf,_0x2ad55f[_0x23b14b(0xc1)]=![],_0x2ad55f[_0x23b14b(0x186)]=0x32,_0x2ad55f[_0x23b14b(0xf2)]=_0x23b14b(0x14f),this[_0x23b14b(0x17d)](_0x5534c8,null,_0x2ad55f);}function Applyfilter(){var _0x20a72f=a290_0x3d8d26;OpenMyCustomLoader(),EmpReportData=[];var _0x3f9875=$[_0x20a72f(0x15c)](_0x20a72f(0x168)),_0x2a1067=$(_0x20a72f(0xe7))[_0x20a72f(0x137)](_0x20a72f(0x107)),_0x541628=$(_0x20a72f(0x10f))[_0x20a72f(0x137)](_0x20a72f(0x107));days=(_0x541628-_0x2a1067)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math[_0x20a72f(0x12a)](days)+0x1,$(_0x20a72f(0x123))['text'](formatDateReportEmp(ConvertDateTimeFormat($(_0x20a72f(0xe7))[_0x20a72f(0x143)](),'/'))),$('#EndDate')[_0x20a72f(0x133)](formatDateReportEmp(ConvertDateTimeFormat($('#EmpreportTo')[_0x20a72f(0x143)](),'/')));var _0x1739b8=moment($(_0x20a72f(0xe7))['val'](),_0x20a72f(0x12f))['format'](_0x20a72f(0xc5)),_0x4ac671=moment($(_0x20a72f(0x10f))['val'](),'DD/MM/YYYY')[_0x20a72f(0xea)](_0x20a72f(0xc5)),_0x24a57e=new Date(_0x4ac671);_0x24a57e[_0x20a72f(0xd9)](_0x24a57e['getDate']()+0x1);var _0x3cf0a1=_0x24a57e[_0x20a72f(0xb3)](),_0x54b70b=_0x3cf0a1[_0x20a72f(0x14a)]('T');GstartDate=_0x1739b8;var _0x21149c=ensureUser($('#EmployeeName')[_0x20a72f(0x16e)]()[_0x20a72f(0x16e)]()[_0x20a72f(0xc8)]('id'));if(_0x21149c==0x0){_0x3f9875=_0x3f9875,GEmpID=_0x3f9875;var _0x4ff0e9=_spPageContextInfo['webAbsoluteUrl']+_0x20a72f(0xcb)+_0x1739b8+_0x20a72f(0x128)+_0x54b70b+'\x27\x20and\x20Employee\x20eq\x20\x27'+_0x3f9875+'\x27\x20';EmpReportUsageUrl=_0x4ff0e9,getFileData();var _0x2f705c=_spPageContextInfo[_0x20a72f(0xcf)]+_0x20a72f(0x147)+_0x3f9875+'\x27\x20and\x20Company/ID\x20\x20eq\x20\x27'+CompanyID+'\x27';EmployeeListDat(_0x2f705c);}else{if(ISHRADMIN==!![]){_0x3f9875=_0x21149c,GEmpID=_0x21149c;var _0x4ff0e9=_spPageContextInfo[_0x20a72f(0xcf)]+_0x20a72f(0xcb)+_0x1739b8+_0x20a72f(0x128)+_0x54b70b+_0x20a72f(0x17a)+_0x3f9875+'\x27\x20';EmpReportUsageUrl=_0x4ff0e9,getFileData();var _0x2f705c=_spPageContextInfo['webAbsoluteUrl']+_0x20a72f(0x147)+_0x3f9875+_0x20a72f(0xbb)+CompanyID+'\x27';EmployeeListDat(_0x2f705c);}else alert(_0x20a72f(0x167));}LoadAllHolidays();}var DataIdList=[],EmpAttendanceData=[],TotalLeavesorAbsent=[],EmpReportUsageUrl='',EmpReportData=EmpReportData||[];function getFileData(){var _0x479407=a290_0x3d8d26;jQuery[_0x479407(0x171)]({'url':EmpReportUsageUrl,'headers':{'Accept':_0x479407(0x15b)},'async':!![],'success':function(_0x4c1bf3){var _0x3de2d6=_0x479407;EmpReportData=EmpReportData[_0x3de2d6(0xbe)](_0x4c1bf3['d'][_0x3de2d6(0xdb)]);if(_0x4c1bf3['d']['__next'])EmpReportUsageUrl=_0x4c1bf3['d'][_0x3de2d6(0xcc)],getFileData();else{if(EmpReportData['length']>0x0){var _0x5f26b=ensureUser($(_0x3de2d6(0x113))[_0x3de2d6(0x16e)]()[_0x3de2d6(0x16e)]()[_0x3de2d6(0xc8)]('id')),_0x1c6baf=$[_0x3de2d6(0x15c)](_0x3de2d6(0x168));_0x5f26b!=0x0?EmpReportData=$[_0x3de2d6(0x15a)](EmpReportData,function(_0x53ad09){return _0x53ad09['Employee']['ID']==_0x5f26b;}):EmpReportData=$[_0x3de2d6(0x15a)](EmpReportData,function(_0xdfccd6){return _0xdfccd6['Employee']['ID']==_0x1c6baf;});var _0x5fe33b=moment(ConvertDateTimeFormat($(_0x3de2d6(0xe7))[_0x3de2d6(0x143)](),'/'))[_0x3de2d6(0xea)](_0x3de2d6(0x153)),_0x1c4729=moment(ConvertDateTimeFormat($(_0x3de2d6(0x10f))['val'](),'/'))[_0x3de2d6(0xea)](_0x3de2d6(0x153)),_0xf6db10=EmpReportData[_0x3de2d6(0x177)](function(_0x4b9936){var _0x50f4ed=_0x3de2d6;return Created=moment(_0x4b9936[_0x50f4ed(0x163)])['format'](_0x50f4ed(0x153)),(_0x5fe33b==''?Created!='':Created>=_0x5fe33b)&&(_0x1c4729==''?Created!='':Created<=_0x1c4729);});GenerateEmpReport(_0xf6db10);}else{var _0xf6db10=[];GenerateEmpReport(_0xf6db10);}CloseMyCustomLoader();}},'error':function(_0xdf17fd,_0x3485b9,_0x57e689){var _0x316dc6=_0x479407;console[_0x316dc6(0x124)](_0x316dc6(0x111)),console[_0x316dc6(0x124)](_0xdf17fd['responseJSON']['error'][_0x316dc6(0xd5)][_0x316dc6(0x152)]);var _0x50db0d=_0xdf17fd[_0x316dc6(0xed)][_0x316dc6(0x160)][_0x316dc6(0xd5)]['value'],_0xb4e48d=_0x50db0d[_0x316dc6(0x112)]('it\x20exceeds\x20the\x20list\x20view');if(_0xb4e48d==!![]){EmpReportData=[];var _0x136032=_spPageContextInfo['webAbsoluteUrl']+_0x316dc6(0x145);EmpReportUsageUrl=_0x136032,getFileData();}}});}function GenerateEmpReport(_0x38095d){var _0x5baf9b=a290_0x3d8d26;EmpAttendanceData=[],DataIdList=[];var _0x3d6755=[];TotalLeavesorAbsent=[];for(var _0x28b288=0x0;_0x28b288<_0x38095d['length'];_0x28b288++){if(_0x38095d[_0x28b288][_0x5baf9b(0x180)]!='On-Leave'&&_0x38095d[_0x28b288][_0x5baf9b(0x180)]!=_0x5baf9b(0xc6))_0x3d6755[_0x5baf9b(0x179)](_0x38095d[_0x28b288][_0x5baf9b(0x180)]);else{if(_0x38095d[_0x28b288][_0x5baf9b(0x180)]==_0x5baf9b(0xd3))TotalLeavesorAbsent['push'](_0x38095d[_0x28b288]['AttendanceType']);else _0x38095d[_0x28b288][_0x5baf9b(0x180)]=='Holiday'&&TotalLeavesorAbsent[_0x5baf9b(0x179)](_0x38095d[_0x28b288][_0x5baf9b(0x180)]);}var _0x38996e=_0x38095d[_0x28b288]['ID'],_0x17d288=_0x38095d[_0x28b288][_0x5baf9b(0x170)][_0x5baf9b(0xd1)],_0x198f43=_0x38095d[_0x28b288]['Employee']['ID'],_0x7c402d=formatDateReportEmp(_0x38095d[_0x28b288][_0x5baf9b(0x163)]),_0x195f93=_0x38095d[_0x28b288][_0x5baf9b(0x180)],_0x538032=_0x38095d[_0x28b288][_0x5baf9b(0x146)],_0x755c1c=_0x38095d[_0x28b288][_0x5baf9b(0xf9)];EmpAttendanceData[_0x5baf9b(0x179)]({'UserId':_0x198f43,'EmpName':_0x17d288,'AttendanceDate':_0x7c402d,'AttendanceType':_0x195f93,'AttendanceItemId':_0x38996e,'EmpWorkHours':_0x538032,'HrAction':_0x755c1c});}var _0x5cc5cf='';$(_0x5baf9b(0xbf))[_0x5baf9b(0x164)]();var _0x4032a2=0x0,_0xbe3cb7=0x0;for(var _0x5b1775=0x0;_0x5b1775<Totaldays;_0x5b1775++){var _0x2fa8dc=new Date(GstartDate);_0x2fa8dc['setDate'](_0x2fa8dc[_0x5baf9b(0x107)]()+_0x5b1775);var _0x5a90ed=moment(_0x2fa8dc,_0x5baf9b(0x12f))[_0x5baf9b(0xea)]('YYYY-MM-DD'),_0x5a90ed=_0x5a90ed[_0x5baf9b(0x14a)]('-')[_0x5baf9b(0x174)]('');DataIdList['push'](_0x5a90ed);var _0x54e228=formatDateReportEmp(_0x2fa8dc),_0x1bffb9=EmpAttendanceData[_0x5baf9b(0x157)](function(_0x1eab4b){var _0x128620=_0x5baf9b;return _0x1eab4b[_0x128620(0x163)];})[_0x5baf9b(0x11a)](_0x54e228);if(_0x1bffb9!=-0x1){var _0x376cd4=EmpAttendanceData[_0x1bffb9][_0x5baf9b(0x180)],_0x597f6d=EmpAttendanceData[_0x1bffb9][_0x5baf9b(0x17b)],_0x755c1c=EmpAttendanceData[_0x1bffb9]['HrAction'],_0x520a02=EmpAttendanceData[_0x1bffb9][_0x5baf9b(0x161)],_0x1feb63=EmpAttendanceData[_0x1bffb9][_0x5baf9b(0x130)],_0x3ab84e='none',_0x389c82='block';_0x755c1c==!![]&&(_0x3ab84e='block',_0x389c82=_0x5baf9b(0x158));if(_0x376cd4!=_0x5baf9b(0xd3)&&_0x376cd4!=_0x5baf9b(0xc6)){if(_0x597f6d==null)var _0x3aa924='<a\x20class=\x27LinkBtn\x27\x20href=\x27'+_spPageContextInfo[_0x5baf9b(0xcf)]+'/Pages/TimeSheetEntry.aspx?WebAppId=2&Recall='+_0x5a90ed+'&Mode='+window[_0x5baf9b(0xd8)](_0x5baf9b(0x14d))+_0x5baf9b(0x13d)+_0x5a90ed+_0x5baf9b(0x154);else var _0x3aa924=_0x5baf9b(0xc2)+_spPageContextInfo[_0x5baf9b(0xcf)]+_0x5baf9b(0x15d)+_0x5a90ed+'&Mode='+window[_0x5baf9b(0xd8)](_0x5baf9b(0x14d))+_0x5baf9b(0xe1)+ConvertHHMM(_0x597f6d)+_0x5baf9b(0x17e);}else var _0x3aa924='';_0xbe3cb7=_0xbe3cb7+0x1,_0x5cc5cf+='<tr\x20class=\x27text-center\x27\x20>',_0x5cc5cf+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id='+_0x5a90ed+_0x5baf9b(0x173)+formatDateReportEmp(_0x2fa8dc)+_0x5baf9b(0x13b)+_0x5a90ed+_0x5baf9b(0x176),_0x5cc5cf+=_0x5baf9b(0x11e)+_0x5a90ed+'>'+_0x376cd4+_0x5baf9b(0x110),_0x5cc5cf+=_0x5baf9b(0xf0)+_0x5a90ed+'>'+_0x3aa924+_0x5baf9b(0x110),_0x5cc5cf+=_0x5baf9b(0xb0)+_0x3ab84e+'\x20\x27><label><i\x20class=\x27fa\x20fa-check\x27\x20aria-hidden=\x27true\x27\x20style=\x27color:\x20red;\x27></i></label></div></td>',_0x5cc5cf+=_0x5baf9b(0xb4)+_0x389c82+_0x5baf9b(0x12d)+GEmpID+','+_0x1feb63+','+_0x5a90ed+')\x27><i\x20class=\x27fa\x20fa-pencil\x27></i></a></div></td>',_0x5cc5cf+='</tr>';}else{_0x4032a2=_0x4032a2+0x1;var _0xdcc268=_0x5baf9b(0x131)+_spPageContextInfo[_0x5baf9b(0xcf)]+_0x5baf9b(0x15d)+_0x5a90ed+_0x5baf9b(0xd4)+window[_0x5baf9b(0xd8)]('View')+_0x5baf9b(0x13d)+_0x5a90ed+_0x5baf9b(0x154);_0x5cc5cf+='<tr\x20class=\x27text-center\x27\x20>',_0x5cc5cf+=_0x5baf9b(0x115)+_0x5a90ed+_0x5baf9b(0x173)+formatDateReportEmp(_0x2fa8dc)+'</span><span\x20id=\x27H'+_0x5a90ed+_0x5baf9b(0x176),_0x5cc5cf+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Att'+_0x5a90ed+_0x5baf9b(0xe9),_0x5cc5cf+=_0x5baf9b(0xf0)+_0x5a90ed+_0x5baf9b(0xe9),_0x5cc5cf+='<td><div\x20class=\x27checkbox\x20m-0\x27></div></td>',_0x5cc5cf+=_0x5baf9b(0xbc)+GEmpID+',0,'+_0x5a90ed+_0x5baf9b(0x118),_0x5cc5cf+=_0x5baf9b(0x13c);}}var _0x42fd06=parseInt(TotalLeavesorAbsent[_0x5baf9b(0xe2)])+parseInt(_0x4032a2)-parseInt($(_0x5baf9b(0xdc))[_0x5baf9b(0x133)]());_0x42fd06<0x0&&(_0x42fd06=0x0);$(_0x5baf9b(0x108))[_0x5baf9b(0x13e)](),$(_0x5baf9b(0x14b))[_0x5baf9b(0x133)](Totaldays);var _0x26f2a8=parseInt(_0xbe3cb7)-parseInt(TotalLeavesorAbsent['length']);$(_0x5baf9b(0x16f))['text'](Math[_0x5baf9b(0xae)](_0x26f2a8)),$(_0x5baf9b(0xbf))['append'](_0x5cc5cf),EmpTableConfiguration();}function a290_0x16ab(){var _0x894bdf=['#SelDate','35dIAbrN','</span><span\x20id=\x27H','</tr>','&sourcelocation=../Pages/Myworkplace.aspx\x27\x20><span\x20id=\x27Timeview','hide','<br\x20/>Please\x20wait!!','SearchPrincipalSource','Hdate','floor','val','Data\x20has\x20been\x20saved.','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=2000','WorkHours','/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27','exec','dd/mm/yy','split','#EmpTotalItemscount','Empcurrentpage','View','/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?select=*,ID,Title&$filter=OfficeLocationID\x20eq\x20\x27','280px','modal','OfficeName','value','MM/DD/YYYY','\x27>Fill</span></a>','stringify','/_api/web/lists/GetByTitle(\x27EmpAttendance\x27)/items(','map','none','Loading...','grep','application/json;odata=verbose','urlParam','/Pages/TimeSheetEntry.aspx?WebAppId=2&Recall=','getTime','EmpReportTableData','error','UserId','toString','AttendanceDate','empty','#OfficeLoc','Monday','Unauthorized\x20access!','EID','close','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27','\x27&$top=200&$orderby=Holiday_start\x20asc','css','showWaitScreenWithNoClose','children','#Total-Attendance','Employee','ajax','getElementById','><span>','join','table','\x27\x20class=\x27employee-report-holiday\x27></span></div></td>','filter','Tuesday','push','\x27\x20and\x20Employee\x20eq\x20\x27','EmpWorkHours','SPClientPeoplePickerDict','SPClientPeoplePicker_InitStandaloneControlWrapper','</a>','display','AttendanceType','href','#AttendanceDDL','Nov','Emptotalpages','PrincipalAccountType','MaximumEntitySuggestions','abs','317428pXyrmF','<td><div\x20class=\x27checkbox\x20m-0\x27\x20style=\x27display:\x20','Error!\x20Something\x20went\x20wrong.','location','toISOString','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27\x20style=\x27display:\x20','getFullYear','slice','#attendance-reportEdit','end','#EdateTH','Jul','\x27\x20and\x20Company/ID\x20\x20eq\x20\x27','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27><a\x20href=\x27#\x27\x20class=\x27custom-edit-btn\x27\x20data-toggle=\x27modal\x27\x20data-target=\x27#attendance-reportEdit\x27\x20onclick=\x27attendanceEditModal(','Saturday','concat','#EmpReportTable','\x27\x20and\x20Holiday_start\x20ge\x20\x27','AllowMultipleValues','<a\x20href=\x27','OfficeLocation','SP.Data.EmpAttendanceListItem','YYYY-MM-DD','Holiday','9QaVkHz','attr','\x27\x20and\x20ContributorsId\x20eq\x20\x27','ProcessApprovers','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$orderby\x20=\x20AttendanceDate\x20asc&$filter=AttendanceDate\x20ge\x20\x27','__next','/_api/web/lists/getbytitle(\x27','\x27)/items?$select=*,Department/DepartmentName,Department/ID&$expand=Department&$filter=CompanyId\x20eq\x20\x27','webAbsoluteUrl','sorter','Title','replace','On-Leave','&Mode=','message','getMonth','=([^&#]*)','btoa','setDate','Dec','results','#HoliaysTotal','Oct','oddrow','GetAllUserInfo','#Total-Leave-Absent','&sourcelocation=../Pages/Myworkplace.aspx\x27>','length','2185550CzLzgY','red','4jzavBj','Thursday','#EmpreportFrom','#HolidayMessagediv','></div></td>','format','POST','ModalDialog','responseJSON','tablenav','\x27\x20and\x20CompanyID\x20eq\x20\x27','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Time','Holiday_start','Width','30BAXKzd','Apr','Worksheet','Plese\x20select\x20proper\x20attandence.','Mar','data:application/vnd.ms-excel;base64,','HrAction','getDay','block','/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?$filter=OfficeLocationID\x20eq\x20(\x27','#EndDate','get','This\x20is\x20a\x20Holiday,\x20are\x20you\x20sure\x20to\x20submit\x20your\x20attendance.','selectedrow','evenrow','#EmpName','CompanyId','EmployeeName','LogonName','1107018VZhmiD','getDate','.NoRecordFound','Empstartrecord','May','ResolvePrincipalSource','14262uQIeNr','261819xMfFKZ','130792fHUAkx','#EmpreportTo','</div></td>','Error\x20in\x20getFileData.','includes','#EmployeeName','Aug','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=','#EmpTitle','#EmpRow',')\x27><i\x20class=\x27fa\x20fa-pencil\x27></i></a></div></td>','ready','indexOf','An\x20error\x20occurred.\x20Please\x20try\x20again.','columns','MERGE','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Att','#officeLocTH','38501uHjyDd','#Att','/_api/web/ensureuser','#StartDate','log','#Timeview','start','#HolidaysTH','\x27\x20and\x20AttendanceDate\x20le\x20\x27','Friday','round','\x27)and\x20Holiday_start\x20eq\x20\x27','#__REQUESTDIGEST','\x20\x27><a\x20href=\x27#\x27\x20class=\x27custom-edit-btn\x27\x20data-toggle=\x27modal\x27\x20data-target=\x27#attendance-reportEdit\x27\x20onclick=\x27attendanceEditModal(','\x27\x20and\x20(WebPartName\x20eq\x20\x27HR\x20Admin\x27)','DD/MM/YYYY','AttendanceItemId','<a\x20class=\x27LinkBtn\x27\x20href=\x27','innerHTML','text','Emptotalrecords','#TotalWorkdayTH','getQueryStringParameter','datepicker','evenselected'];a290_0x16ab=function(){return _0x894bdf;};return a290_0x16ab();}function ConvertDateTimeFormat(_0x5ca8a4,_0x131e40){var _0x4e841f=a290_0x3d8d26;return _0x5ca8a4[_0x4e841f(0x14a)](_0x131e40)[0x1]+''+_0x131e40+''+_0x5ca8a4['split'](_0x131e40)[0x0]+''+_0x131e40+''+_0x5ca8a4[_0x4e841f(0x14a)](_0x131e40)[0x2];}var GEmployeeID=0x0,LocID=0x0;function EmployeeListDat(_0x2e5996){var _0x4340cf=a290_0x3d8d26;GEmployeeID=0x0,$[_0x4340cf(0x171)]({'url':_0x2e5996,'headers':{'Accept':_0x4340cf(0x15b)},'async':![],'success':function(_0x5045c4){var _0xdbdfda=_0x4340cf,_0x485fd0=_0x5045c4['d'][_0xdbdfda(0xdb)];_0x485fd0[_0xdbdfda(0xe2)]>0x0?($(_0xdbdfda(0x102))[_0xdbdfda(0x133)](_0x485fd0[0x0][_0xdbdfda(0x105)][_0xdbdfda(0xd1)]),GEmployeeID=_0x485fd0[0x0][_0xdbdfda(0x105)]['ID'],$(_0xdbdfda(0x116))['text'](_0x485fd0[0x0][_0xdbdfda(0x105)][_0xdbdfda(0xd1)]),$(_0xdbdfda(0x165))[_0xdbdfda(0x133)](_0x485fd0[0x0]['OfficeLocation'][_0xdbdfda(0x151)]),$(_0xdbdfda(0x11f))[_0xdbdfda(0x133)](_0x485fd0[0x0][_0xdbdfda(0xc3)][_0xdbdfda(0x151)]),LocID=_0x485fd0[0x0][_0xdbdfda(0xc3)]['ID']):($(_0xdbdfda(0x102))[_0xdbdfda(0x133)](''),$(_0xdbdfda(0x165))[_0xdbdfda(0x133)](''),LocID=0x0);},'error':function(_0x146320){console['log'](_0x146320);}});}function EmpTableConfiguration(){var _0x4a5f5e=a290_0x3d8d26;sorter=new TINY[(_0x4a5f5e(0x175))][(_0x4a5f5e(0xd0))](_0x4a5f5e(0xd0),_0x4a5f5e(0x15f),{'ascclass':'asc','descclass':'desc','evenclass':_0x4a5f5e(0x101),'oddclass':_0x4a5f5e(0xde),'evenselclass':_0x4a5f5e(0x138),'oddselclass':'oddselected','paginate':!![],'size':0xa,'colddid':_0x4a5f5e(0x11c),'currentid':_0x4a5f5e(0x14c),'totalid':_0x4a5f5e(0x184),'startingrecid':_0x4a5f5e(0x109),'endingrecid':'Empendrecord','totalrecid':_0x4a5f5e(0x134),'hoverid':_0x4a5f5e(0x100),'pageddid':'Emppagedropdown','navid':_0x4a5f5e(0xee),'sortdir':0x1,'init':!![]});}$[a290_0x3d8d26(0x15c)]=function(_0x5aee17){var _0xf7845=a290_0x3d8d26,_0xd16ed0=new RegExp('[?&]'+_0x5aee17+_0xf7845(0xd7))[_0xf7845(0x148)](window[_0xf7845(0xb2)][_0xf7845(0x181)]);if(_0xd16ed0==null)return null;return decodeURI(_0xd16ed0[0x1])||0x0;};function formatDateReportEmp(_0x36ad0a){var _0x21f7b8=a290_0x3d8d26,_0x33f698=['Sunday',_0x21f7b8(0x166),_0x21f7b8(0x178),'Wednesday',_0x21f7b8(0xe6),_0x21f7b8(0x129),_0x21f7b8(0xbd)],_0x3a3c3e=new Date(_0x36ad0a);if(isNaN(_0x3a3c3e[_0x21f7b8(0x15e)]()))return _0x36ad0a;else{var _0x29f691=new Array();return _0x29f691[0x0]='Jan',_0x29f691[0x1]='Feb',_0x29f691[0x2]=_0x21f7b8(0xf7),_0x29f691[0x3]=_0x21f7b8(0xf4),_0x29f691[0x4]=_0x21f7b8(0x10a),_0x29f691[0x5]='Jun',_0x29f691[0x6]=_0x21f7b8(0xba),_0x29f691[0x7]=_0x21f7b8(0x114),_0x29f691[0x8]='Sept',_0x29f691[0x9]=_0x21f7b8(0xdd),_0x29f691[0xa]=_0x21f7b8(0x183),_0x29f691[0xb]=_0x21f7b8(0xda),day=_0x3a3c3e[_0x21f7b8(0x107)](),day<0xa&&(day='0'+day),day+'\x20'+_0x29f691[_0x3a3c3e['getMonth']()]+'\x20'+_0x3a3c3e[_0x21f7b8(0xb5)]()+',\x20'+_0x33f698[_0x3a3c3e[_0x21f7b8(0xfa)]()];}}function ConvertHHMM(_0x252e88){var _0xb78f2a=a290_0x3d8d26;if(_0x252e88!=null){var _0x49a788=Math[_0xb78f2a(0x142)](_0x252e88/0x3c),_0x1e8737=_0x252e88%0x3c;_0x49a788<0xa&&(_0x49a788='0'+_0x49a788);_0x1e8737<0xa&&(_0x1e8737='0'+_0x1e8737);var _0x59417a=_0x49a788+':'+_0x1e8737;}else var _0x59417a='';return _0x59417a;}var AttandenceOnHolidays=0x0,HolidaysListDTL=[];function LoadAllHolidays(){var _0x5cda06=a290_0x3d8d26;TotalOfficeDays=0x0,HolidaysListDTL=[];var _0x1280ea=new Date(ConvertDateTimeFormat($('#EmpreportFrom')[_0x5cda06(0x143)](),'/')),_0x3e202b=_0x1280ea[_0x5cda06(0xb5)]()+'-'+(_0x1280ea[_0x5cda06(0xd6)]()+0x1)+'-'+_0x1280ea[_0x5cda06(0x107)](),_0x2ea709=new Date(ConvertDateTimeFormat($(_0x5cda06(0x10f))['val'](),'/')),_0x5cdba5=_0x2ea709[_0x5cda06(0xb5)]()+'-'+(_0x2ea709[_0x5cda06(0xd6)]()+0x1)+'-'+_0x2ea709['getDate'](),_0x243549=_spPageContextInfo[_0x5cda06(0xcf)]+_0x5cda06(0x14e)+LocID+_0x5cda06(0xef)+CompanyID+_0x5cda06(0xc0)+_0x3e202b+'\x27\x20and\x20Holiday_start\x20le\x20\x27'+_0x5cdba5+'\x27';$[_0x5cda06(0x171)]({'url':_0x243549,'headers':{'Accept':_0x5cda06(0x15b)},'async':![],'success':function(_0x45696e){var _0x2603b0=_0x5cda06,_0x4ddf86=_0x45696e['d']['results'][_0x2603b0(0xe2)],_0xc24a33=0x0;for(var _0x3a2a84=0x0;_0x3a2a84<_0x4ddf86;_0x3a2a84++){var _0x168c2d=new Date(_0x45696e['d'][_0x2603b0(0xdb)][_0x3a2a84][_0x2603b0(0xf1)]),_0x581a61=moment(_0x168c2d,_0x2603b0(0x12f))[_0x2603b0(0xea)](_0x2603b0(0xc5)),_0x581a61=_0x581a61['split']('-')[_0x2603b0(0x174)](''),_0x31f6e5=_0x45696e['d'][_0x2603b0(0xdb)][_0x3a2a84][_0x2603b0(0xd1)];HolidaysListDTL[_0x2603b0(0x179)]({'Hdate':_0x581a61,'Title':_0x31f6e5}),$('#'+_0x581a61)['css']('color',_0x2603b0(0xe4)),$('#H'+_0x581a61)['text'](_0x31f6e5),$(_0x2603b0(0x121)+_0x581a61)[_0x2603b0(0x133)]()!=''&&(_0xc24a33=_0xc24a33+0x1);}AttandenceOnHolidays=0x0;for(var _0x30ad97=0x0;_0x30ad97<HolidaysListDTL[_0x2603b0(0xe2)];_0x30ad97++){var _0x2ea51b=$(_0x2603b0(0x121)+HolidaysListDTL[_0x30ad97][_0x2603b0(0x141)])[_0x2603b0(0x133)]();_0x2ea51b!=''&&_0x2ea51b!=_0x2603b0(0xd3)&&_0x2ea51b!='Holiday'&&(AttandenceOnHolidays=AttandenceOnHolidays+0x1);}var _0x196e16=0x0,_0x1f7404=0x0,_0x2eb793=0x0;for(var _0x5358a4=0x0;_0x5358a4<DataIdList[_0x2603b0(0xe2)];_0x5358a4++){var _0x475c7c=$(_0x2603b0(0x121)+DataIdList[_0x5358a4])['text']();(_0x475c7c==''||_0x475c7c==_0x2603b0(0xd3))&&(_0x1f7404=_0x1f7404+0x1),_0x475c7c==_0x2603b0(0xd3)&&(_0x2eb793=_0x2eb793+0x1),_0x475c7c==_0x2603b0(0xc6)&&(_0x196e16=_0x196e16+0x1);}var _0x58bf9b=_0x1f7404+AttandenceOnHolidays-(_0x4ddf86-_0x196e16);_0x58bf9b<0x0&&(_0x58bf9b=0x0),_0x58bf9b!='0'?$('#Total-Leave-Absent')[_0x2603b0(0x133)](_0x58bf9b):_0x2eb793>0x0&&$(_0x2603b0(0xe0))[_0x2603b0(0x133)](_0x2eb793),$(_0x2603b0(0xdc))[_0x2603b0(0x133)](_0x4ddf86),$('#Workingdays')[_0x2603b0(0x133)](parseInt(Totaldays)-parseInt(_0x4ddf86)),$('#FdateTH')[_0x2603b0(0x133)](formatDateReportEmp(ConvertDateTimeFormat($(_0x2603b0(0xe7))[_0x2603b0(0x143)](),'/'))),$(_0x2603b0(0xb9))['text'](formatDateReportEmp(ConvertDateTimeFormat($('#EmpreportTo')[_0x2603b0(0x143)](),'/'))),$(_0x2603b0(0x135))['text'](parseInt(Totaldays)-parseInt(_0x4ddf86)),$(_0x2603b0(0x127))[_0x2603b0(0x133)](_0x4ddf86);},'myError':function(_0x27f8ae){}});}function ensureUser(_0x243d5b){var _0x309c39=a290_0x3d8d26,_0x46bc0f=0x0,_0x29189d=_0x243d5b,_0x1c7798=this['SPClientPeoplePicker'][_0x309c39(0x17c)][_0x29189d],_0x30bbe9=_0x1c7798[_0x309c39(0xdf)](),_0x16dde0=_0x30bbe9[0x0];if(_0x16dde0){var _0x4ce919={'logonName':_0x16dde0['Key']};$[_0x309c39(0x171)]({'url':_spPageContextInfo[_0x309c39(0xcf)]+_0x309c39(0x122),'type':'POST','async':![],'contentType':_0x309c39(0x15b),'data':JSON[_0x309c39(0x155)](_0x4ce919),'headers':{'X-RequestDigest':$(_0x309c39(0x12c))[_0x309c39(0x143)](),'accept':'application/json;odata=verbose'},'success':function(_0x4f8456,_0x49f09f,_0x38b22e){_0x46bc0f=_0x4f8456['d']['Id'];},'error':function(_0x3aa201,_0x359d07,_0x3d9f9a){}});}else _0x46bc0f=0x0;return _0x46bc0f;}var tableToExcel=(function(){var _0x1a3ea=a290_0x3d8d26,_0x32bbf3=_0x1a3ea(0xf8),_0x2c491b='<html\x20xmlns:o=\x22urn:schemas-microsoft-com:office:office\x22\x20xmlns:x=\x22urn:schemas-microsoft-com:office:excel\x22\x20xmlns=\x22http://www.w3.org/TR/REC-html40\x22><head><!--[if\x20gte\x20mso\x209]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>',_0x73a35=function(_0x59ab91){var _0x2e2ec1=_0x1a3ea;return window[_0x2e2ec1(0xd8)](unescape(encodeURIComponent(_0x59ab91)));},_0x499a91=function(_0x4bb5d3,_0x8166d1){var _0x396432=_0x1a3ea;return _0x4bb5d3[_0x396432(0xd2)](/{(\w+)}/g,function(_0x41b519,_0x367a01){return _0x8166d1[_0x367a01];});};return function(_0x4a8b7d,_0x53944a){var _0x23825f=_0x1a3ea;if(!_0x4a8b7d['nodeType'])_0x4a8b7d=document[_0x23825f(0x172)](_0x4a8b7d);var _0x5eef9c={'worksheet':_0x53944a||_0x23825f(0xf5),'table':_0x4a8b7d[_0x23825f(0x132)]};window['location']['href']=_0x32bbf3+_0x73a35(_0x499a91(_0x2c491b,_0x5eef9c));};}()),ISHRADMIN=![];function ValidateHrAdmin(){var _0xa067ed=a290_0x3d8d26,_0x1d4b7f=_0xa067ed(0xca),_0x278d30=_spPageContextInfo[_0xa067ed(0xcf)]+_0xa067ed(0xcd)+_0x1d4b7f+_0xa067ed(0xce)+titanForWork[_0xa067ed(0x136)]('CompanyId')+_0xa067ed(0xc9)+_spPageContextInfo['userId']+_0xa067ed(0x12e);$['ajax']({'url':_0x278d30,'async':![],'type':_0xa067ed(0xfe),'headers':{'Accept':_0xa067ed(0x15b)},'success':function(_0x4fe11d){var _0x23cf1a=_0xa067ed,_0x7c519d=_0x4fe11d['d'][_0x23cf1a(0xdb)];_0x7c519d[_0x23cf1a(0xe2)]>0x0?($(_0x23cf1a(0x117))[_0x23cf1a(0x16c)](_0x23cf1a(0x17f),_0x23cf1a(0xfb)),ISHRADMIN=!![]):(ISHRADMIN=![],$(_0x23cf1a(0x117))['hide']());},'error':function(_0x22975e){var _0x1ba359=_0xa067ed;console[_0x1ba359(0x124)](_0x22975e[_0x1ba359(0xed)][_0x1ba359(0x160)]);}});}function GetAttendanceorLeaves(){var _0x1949cc=a290_0x3d8d26,_0x2afc61=$[_0x1949cc(0x15c)]('EID'),_0x531881=$(_0x1949cc(0xe7))[_0x1949cc(0x137)]('getDate'),_0x31acd3=$('#EmpreportTo')[_0x1949cc(0x137)](_0x1949cc(0x107));days=(_0x31acd3-_0x531881)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math[_0x1949cc(0x12a)](days)+0x1,$(_0x1949cc(0x123))['text'](formatDateReportEmp(ConvertDateTimeFormat($('#EmpreportFrom')[_0x1949cc(0x143)](),'/'))),$(_0x1949cc(0xfd))[_0x1949cc(0x133)](formatDateReportEmp(ConvertDateTimeFormat($(_0x1949cc(0x10f))[_0x1949cc(0x143)](),'/')));var _0x3ee408=moment($(_0x1949cc(0xe7))[_0x1949cc(0x143)](),_0x1949cc(0x12f))[_0x1949cc(0xea)](_0x1949cc(0xc5)),_0x18a126=moment($(_0x1949cc(0x10f))['val'](),_0x1949cc(0x12f))['format'](_0x1949cc(0xc5)),_0x40d4c1=new Date(_0x18a126);_0x40d4c1[_0x1949cc(0xd9)](_0x40d4c1['getDate']()+0x1);var _0xeb98a1=_0x40d4c1['toISOString'](),_0x2a00d8=_0xeb98a1[_0x1949cc(0x14a)]('T');GstartDate=_0x3ee408;var _0x35b738=ensureUser($(_0x1949cc(0x113))['children']()[_0x1949cc(0x16e)]()[_0x1949cc(0xc8)]('id'));if(_0x35b738==0x0){var _0x5a27fd=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27'+_0x2afc61+_0x1949cc(0xbb)+CompanyID+'\x27';EmployeeListDat(_0x5a27fd),LoadAllHolidays(),_0x2afc61=_0x2afc61,GEmpID=_0x2afc61;var _0x2aea2b=_spPageContextInfo['webAbsoluteUrl']+_0x1949cc(0x16a)+_0x3ee408+_0x1949cc(0x128)+_0x2a00d8+_0x1949cc(0x17a)+_0x2afc61+'\x27\x20';UpdateHeaderfields(_0x2aea2b);}else{if(ISHRADMIN==!![]){_0x2afc61=_0x35b738,GEmpID=_0x35b738;var _0x5a27fd=_spPageContextInfo[_0x1949cc(0xcf)]+_0x1949cc(0x147)+_0x2afc61+_0x1949cc(0xbb)+CompanyID+'\x27';EmployeeListDat(_0x5a27fd),LoadAllHolidays();var _0x2aea2b=_spPageContextInfo[_0x1949cc(0xcf)]+_0x1949cc(0x16a)+_0x3ee408+_0x1949cc(0x128)+_0x2a00d8+_0x1949cc(0x17a)+_0x2afc61+'\x27\x20';UpdateHeaderfields(_0x2aea2b);var _0x5a27fd=_spPageContextInfo[_0x1949cc(0xcf)]+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27'+_0x2afc61+_0x1949cc(0xbb)+CompanyID+'\x27';}else alert(_0x1949cc(0x167));}LoadAllHolidays();}function GetFilterData(_0x5ba922){var _0x24cee1=a290_0x3d8d26;jQuery[_0x24cee1(0x171)]({'url':_0x5ba922,'headers':{'Accept':_0x24cee1(0x15b)},'async':![],'success':function(_0x5e73a2){var _0x1f96fa=_0x24cee1,_0x3bc1e4=_0x5e73a2['d']['results'],_0x478454=[];TotalLeavesorAbsent=[];for(var _0x55f868=0x0;_0x55f868<_0x3bc1e4[_0x1f96fa(0xe2)];_0x55f868++){if(_0x3bc1e4[_0x55f868][_0x1f96fa(0x180)]!=_0x1f96fa(0xd3)&&_0x3bc1e4[_0x55f868][_0x1f96fa(0x180)]!=_0x1f96fa(0xc6))_0x478454[_0x1f96fa(0x179)](_0x3bc1e4[_0x55f868][_0x1f96fa(0x180)]);else _0x3bc1e4[_0x55f868][_0x1f96fa(0x180)]==_0x1f96fa(0xd3)&&TotalLeavesorAbsent[_0x1f96fa(0x179)](_0x3bc1e4[_0x55f868][_0x1f96fa(0x180)]);}$(_0x1f96fa(0x16f))[_0x1f96fa(0x133)](_0x478454[_0x1f96fa(0xe2)]);},'error':function(_0xfe28d4,_0x3ed7ae){var _0x22c718=_0x24cee1;console[_0x22c718(0x124)](JSON[_0x22c718(0x155)](_0xfe28d4));}});}var G_Validateholiday=![];function GetHolidays(_0x9f7555){var _0x36b00b=a290_0x3d8d26,_0x39dc76=_spPageContextInfo[_0x36b00b(0xcf)]+_0x36b00b(0xfc)+LocID+_0x36b00b(0x12b)+_0x9f7555+'\x27\x20and\x20CompanyID\x20eq\x20\x27'+titanForWork[_0x36b00b(0x136)](_0x36b00b(0x103))+_0x36b00b(0x16b);$[_0x36b00b(0x171)]({'url':_0x39dc76,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x6d1238){var _0x5e62f6=_0x36b00b,_0xf3d1b7=_0x6d1238['d'][_0x5e62f6(0xdb)];_0xf3d1b7[_0x5e62f6(0xe2)]>0x0?($(_0x5e62f6(0xe8))[_0x5e62f6(0x133)](_0xf3d1b7[0x0][_0x5e62f6(0xd1)]),$('#HolidayMessage')['css'](_0x5e62f6(0x17f),_0x5e62f6(0xfb)),G_Validateholiday=!![]):($(_0x5e62f6(0xe8))[_0x5e62f6(0x133)](''),$('#HolidayMessage')[_0x5e62f6(0x16c)]('display',_0x5e62f6(0x158)),G_Validateholiday=![]);},'error':function(_0x103a04){var _0x3bee36=_0x36b00b;alert(_0x3bee36(0x11b));}});}var EmpAttendanceData=[],TotalLeavesorAbsent=[];function UpdateHeaderfields(_0x6bb84d){var _0x1848a0=a290_0x3d8d26;jQuery[_0x1848a0(0x171)]({'url':_0x6bb84d,'headers':{'Accept':_0x1848a0(0x15b)},'async':!![],'success':function(_0x1f8ebc){var _0x36817b=_0x1848a0;EmpAttendanceData=[];var _0x526dc6=_0x1f8ebc['d'][_0x36817b(0xdb)],_0x342e04=[];TotalLeavesorAbsent=[];for(var _0x11cf5e=0x0;_0x11cf5e<_0x526dc6[_0x36817b(0xe2)];_0x11cf5e++){if(_0x526dc6[_0x11cf5e][_0x36817b(0x180)]!=_0x36817b(0xd3)&&_0x526dc6[_0x11cf5e][_0x36817b(0x180)]!=_0x36817b(0xc6))_0x342e04['push'](_0x526dc6[_0x11cf5e][_0x36817b(0x180)]);else{if(_0x526dc6[_0x11cf5e][_0x36817b(0x180)]==_0x36817b(0xd3))TotalLeavesorAbsent['push'](_0x526dc6[_0x11cf5e]['AttendanceType']);else _0x526dc6[_0x11cf5e]['AttendanceType']=='Holiday'&&TotalLeavesorAbsent[_0x36817b(0x179)](_0x526dc6[_0x11cf5e][_0x36817b(0x180)]);}var _0x190c77=_0x526dc6[_0x11cf5e]['ID'],_0x5d4927=_0x526dc6[_0x11cf5e][_0x36817b(0x170)][_0x36817b(0xd1)],_0x1c452b=_0x526dc6[_0x11cf5e][_0x36817b(0x170)]['ID'],_0xac91bb=formatDateReportEmp(_0x526dc6[_0x11cf5e][_0x36817b(0x163)]),_0xb1e7c6=_0x526dc6[_0x11cf5e][_0x36817b(0x180)],_0x1b9b9d=_0x526dc6[_0x11cf5e][_0x36817b(0x146)],_0x42fbcf=_0x526dc6[_0x11cf5e][_0x36817b(0xf9)];EmpAttendanceData[_0x36817b(0x179)]({'UserId':_0x1c452b,'EmpName':_0x5d4927,'AttendanceDate':_0xac91bb,'AttendanceType':_0xb1e7c6,'AttendanceItemId':_0x190c77,'EmpWorkHours':_0x1b9b9d,'HrAction':_0x42fbcf});}var _0x5d88c1='',_0x1a16a0=0x0,_0x2098f1=0x0;for(var _0x710e7e=0x0;_0x710e7e<Totaldays;_0x710e7e++){var _0x192dc5=new Date(GstartDate);_0x192dc5[_0x36817b(0xd9)](_0x192dc5[_0x36817b(0x107)]()+_0x710e7e);var _0x5a28b9=moment(_0x192dc5,_0x36817b(0x12f))[_0x36817b(0xea)](_0x36817b(0xc5)),_0x5a28b9=_0x5a28b9[_0x36817b(0x14a)]('-')[_0x36817b(0x174)](''),_0x7f2796=formatDateReportEmp(_0x192dc5),_0x352ef6=EmpAttendanceData[_0x36817b(0x157)](function(_0x85f5c3){var _0x4f63b9=_0x36817b;return _0x85f5c3[_0x4f63b9(0x163)];})[_0x36817b(0x11a)](_0x7f2796);if(_0x352ef6!=-0x1){var _0x57c1bb=EmpAttendanceData[_0x352ef6][_0x36817b(0x180)],_0x311d38=EmpAttendanceData[_0x352ef6][_0x36817b(0x17b)],_0x42fbcf=EmpAttendanceData[_0x352ef6][_0x36817b(0xf9)],_0x4230a7=EmpAttendanceData[_0x352ef6][_0x36817b(0x161)],_0x5d68c9=EmpAttendanceData[_0x352ef6][_0x36817b(0x130)];_0x2098f1=_0x2098f1+0x1;}else _0x1a16a0=_0x1a16a0+0x1;}var _0x253d9c=parseInt(TotalLeavesorAbsent['length'])+parseInt(_0x1a16a0)-parseInt($(_0x36817b(0xdc))[_0x36817b(0x133)]());_0x253d9c<0x0&&(_0x253d9c=0x0);$(_0x36817b(0x14b))[_0x36817b(0x133)](Totaldays);var _0x2e2edb=parseInt(_0x2098f1)-parseInt(TotalLeavesorAbsent['length']);$(_0x36817b(0x16f))[_0x36817b(0x133)](Math[_0x36817b(0xae)](_0x2e2edb));},'error':function(_0x1f9df0,_0x3a67cb){var _0x25c506=_0x1848a0;console[_0x25c506(0x124)](JSON[_0x25c506(0x155)](_0x1f9df0));}});}function OpenMyCustomLoader(){var _0x530722=a290_0x3d8d26,_0x1777ce=_0x530722(0x159),_0x3c6cfc=_0x530722(0x13f),_0x155043=0xc8,_0x2bcf41=0x190;currentDlg=SP['UI'][_0x530722(0xec)][_0x530722(0x16d)](_0x1777ce,_0x3c6cfc,_0x155043,_0x2bcf41);}function CloseMyCustomLoader(){var _0xe097d1=a290_0x3d8d26;currentDlg[_0xe097d1(0x169)]();}