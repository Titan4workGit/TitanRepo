(function(_0x3307d4,_0x1cdfff){var _0x2aa52f=a298_0x1e20,_0x23b1ed=_0x3307d4();while(!![]){try{var _0x4659d7=-parseInt(_0x2aa52f(0x1ed))/0x1*(parseInt(_0x2aa52f(0x218))/0x2)+parseInt(_0x2aa52f(0x1ec))/0x3+-parseInt(_0x2aa52f(0x1e7))/0x4+parseInt(_0x2aa52f(0x201))/0x5+parseInt(_0x2aa52f(0x1e5))/0x6*(parseInt(_0x2aa52f(0x206))/0x7)+parseInt(_0x2aa52f(0x208))/0x8*(parseInt(_0x2aa52f(0x1eb))/0x9)+parseInt(_0x2aa52f(0x1ef))/0xa*(parseInt(_0x2aa52f(0x21e))/0xb);if(_0x4659d7===_0x1cdfff)break;else _0x23b1ed['push'](_0x23b1ed['shift']());}catch(_0x457f97){_0x23b1ed['push'](_0x23b1ed['shift']());}}}(a298_0x1419,0x9399c));function getProjects(){var _0x49fb44=a298_0x1e20,_0x21e22f=_0x49fb44(0x21f);return DeferredObj=$[_0x49fb44(0x1d9)](),$[_0x49fb44(0x1f7)]({'url':_spPageContextInfo[_0x49fb44(0x1f0)]+_0x49fb44(0x1de)+_0x21e22f+_0x49fb44(0x1f2),'type':_0x49fb44(0x20e),'async':![],'headers':{'ACCEPT':_0x49fb44(0x1dc),'X-RequestDigest':$(_0x49fb44(0x1d8))[_0x49fb44(0x222)]()},'success':function(_0x26dcc5){var _0x44a323=_0x49fb44,_0x219687=_0x26dcc5['d']['results'];if(_0x219687['length']>0x0){for(var _0x4b7f47=0x0;_0x4b7f47<_0x219687[_0x44a323(0x200)];_0x4b7f47++){getEmployeeTaskDetails(_0x219687[_0x4b7f47]['ID']);}alert(_0x44a323(0x217));}waitingDialog[_0x44a323(0x1f5)]();},'error':function(_0x5c87f4){var _0x292d55=_0x49fb44;alert(JSON[_0x292d55(0x1e3)](_0x5c87f4)),DeferredObj[_0x292d55(0x1e6)](_0x5c87f4);}}),DeferredObj['promise']();};function getEmployeeTaskDetails(_0x46d73f){var _0x121e1a=a298_0x1e20;$['ajax']({'url':_spPageContextInfo[_0x121e1a(0x1f0)]+_0x121e1a(0x1ee)+_0x46d73f+_0x121e1a(0x211),'method':_0x121e1a(0x20e),'async':![],'headers':{'Accept':_0x121e1a(0x1dc)},'success':function(_0x46eae4,_0x10cc82,_0x19af69){var _0x8a0cbe=_0x121e1a,_0x41a850=_0x46eae4['d'][_0x8a0cbe(0x216)],_0x272bb0,_0x3ac589,_0x293678,_0x32baeb,_0x2d3402=0x0;_0x41a850['length']>0x0&&(_0x272bb0=_0x41a850[_0x8a0cbe(0x1df)](function(_0x1757ea){var _0x3a6bb7=_0x8a0cbe;return _0x1757ea[_0x3a6bb7(0x204)]=='Open';}),_0x3ac589=_0x41a850['filter'](function(_0x18f81b){var _0x1ce494=_0x8a0cbe;return _0x18f81b[_0x1ce494(0x204)]==_0x1ce494(0x1e2);}),_0x293678=_0x41a850['filter'](function(_0x43a589){var _0x4342e1=_0x8a0cbe;return _0x43a589['CurrentPhase']==_0x4342e1(0x1e0);}),_0x32baeb=_0x41a850[_0x8a0cbe(0x1df)](function(_0x4d1ded){var _0xde662f=_0x8a0cbe;return _0x4d1ded[_0xde662f(0x204)]==_0xde662f(0x1db);}),_0x2d3402=_0x41a850['filter'](function(_0x2c724a){var _0x529ede=_0x8a0cbe;return _0x2c724a['CurrentPhase']==_0x529ede(0x1f6);}),_0x272bb0=_0x272bb0[_0x8a0cbe(0x200)],_0x3ac589=_0x3ac589['length'],_0x293678=_0x293678[_0x8a0cbe(0x200)],_0x32baeb=_0x32baeb[_0x8a0cbe(0x200)],_0x2d3402=_0x2d3402['length']),updateProjectCounter(_0x46d73f,_0x272bb0,_0x3ac589,_0x293678,_0x32baeb,_0x2d3402);},'error':function(_0x3811f5,_0x2858f8,_0x53f887){var _0x44ae10=_0x121e1a;console['log'](_0x3811f5[_0x44ae10(0x1fc)]);}});}function updateProjectCounter(_0xb87344,_0x923d64,_0x4e9ac3,_0x4f7200,_0x489d67,_0x75892e){var _0x5c9a71=a298_0x1e20,_0x4001aa=GetItemTypeForListName(_0x5c9a71(0x21f));Metadata={'__metadata':{'type':_0x4001aa},'OpenTasks':_0x923d64,'OnHoldTasks':_0x4e9ac3,'CompletedTasks':_0x4f7200,'CloseTasks':_0x489d67,'CompletedTasks':_0x75892e};var _0x29696e=$[_0x5c9a71(0x1d9)]();return $['ajax']({'url':_spPageContextInfo[_0x5c9a71(0x1f0)]+'/_api/web/lists/getbytitle(\x27ProjectDetails\x27)/GetItemById('+_0xb87344+')','type':_0x5c9a71(0x21a),'async':![],'headers':{'accept':_0x5c9a71(0x1dc),'X-RequestDigest':$(_0x5c9a71(0x1d8))[_0x5c9a71(0x222)](),'content-Type':_0x5c9a71(0x1dc),'X-Http-Method':'PATCH','If-Match':'*'},'data':JSON[_0x5c9a71(0x1e3)](Metadata),'success':function(_0x55f73a){var _0x13c8bb=_0x5c9a71;_0x29696e[_0x13c8bb(0x213)](_0x55f73a),console['log'](_0x13c8bb(0x1e9));},'eror':function(_0x518e32){var _0x4f55a9=_0x5c9a71;_0x29696e['reject'](error),console[_0x4f55a9(0x215)]('An\x20error\x20occurred\x20while\x20deleting\x20Application.\x20'+JSON['stringify'](_0x518e32));}}),_0x29696e[_0x5c9a71(0x20f)]();}function addEnvironmentalSettingsEntry(){var _0x5e5869=a298_0x1e20;listItems=[_0x5e5869(0x203),_0x5e5869(0x1e4),_0x5e5869(0x1fb),_0x5e5869(0x221)];for(var _0x37a121=0x0;_0x37a121<=0x3;_0x37a121++){var _0x1653a6=_0x5e5869(0x1f9),_0x81a56b;_0x81a56b={'__metadata':{'type':_0x5e5869(0x210)},'Title':listItems[_0x37a121],'Active':_0x5e5869(0x20a)};var _0x4a4038=getItemByTitle(listItems[_0x37a121]);_0x4a4038[_0x5e5869(0x200)]==0x0&&$[_0x5e5869(0x1fa)](AddItemEmp(_0x1653a6,_0x81a56b))['done'](function(_0x4ef2ab){var _0xd8ba22=_0x5e5869;_0x37a121==0x4&&alert(_0xd8ba22(0x214));});}}function getItemByTitle(_0xbd13a1){var _0x27cba5=a298_0x1e20,_0x19cfb7=_0x27cba5(0x1f9),_0x59444f='';return DeferredObj=$[_0x27cba5(0x1d9)](),$[_0x27cba5(0x1f7)]({'url':_spPageContextInfo[_0x27cba5(0x1f0)]+_0x27cba5(0x1de)+_0x19cfb7+'\x27)/items/?$select=Id,Title&$filter=Title\x20eq\x20\x27'+_0xbd13a1+'\x27','type':_0x27cba5(0x20e),'async':![],'headers':{'ACCEPT':_0x27cba5(0x1dc),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x27cba5(0x222)]()},'success':function(_0x298f26){var _0x48627a=_0x27cba5;return _0x59444f=_0x298f26['d'][_0x48627a(0x216)],_0x59444f;},'error':function(_0x58c5aa){var _0x2dd73e=_0x27cba5;alert(JSON['stringify'](_0x58c5aa)),DeferredObj[_0x2dd73e(0x1e6)](_0x58c5aa);}}),_0x59444f;}function a298_0x1419(){var _0x385642=['\x27)/items/?$select=*&$top=5000&$filter=TaskCategory\x20eq\x20null','resolve','Submit\x20successfully','log','results','Successfully!','1894ZpTWHa','SP.Data.MediaGalleryItem','POST','getQueryStringParameter','SiteURL','#txtSomethingWentWrong','9306WCemWh','ProjectDetails','\x27)/items?$select=ID,SiteURL&$filter=ID\x20eq\x20\x27','Attendance','val','General','/_api/web/lists/getbytitle(\x27Event\x27)/items?$filter=ID\x20eq\x20(\x27','#__REQUESTDIGEST','Deferred','EndDate','Close','application/json;odata=verbose','MERGE','/_api/web/lists/getbytitle(\x27','filter','Completed','EmployeeTaskDetails','Hold','stringify','Attendance\x20Entry','503682pWpgkI','reject','167336KsQwjv','Location','Successfully.','Successfully\x20done!','27qVXVUu','1475706OBTZLu','1247uUmGPs','/_api/web/lists/getByTitle(\x27EmployeeTaskDetails\x27)/items/?$top=5000&$filter=ProjectIDId\x20eq\x20','430lsXUAl','webAbsoluteUrl','empty','\x27)/items/?$select=*&$top=5000','/_api/Web/lists/GetByTitle(\x27MediaGallery\x27)/Items?$select=*,File_x0020_Type,Author/Title,Author/EMail,FileRef,FileLeafRef&$expand=Author/Title&$filter=FileRef\x20eq\x20\x27','All\x20Task\x27s\x20Priority\x20has\x20been\x20changed.','hide','Cancelled','ajax','Created','EnvironmentalSettings','when','Timesheet','responseText','Description','Name','MM/dd/yyyy','length','1384165ueijRg','/_api/Web/lists/GetByTitle(\x27MediaGallery\x27)/rootfolder/folders?$select=*,FileRef,FileLeafRef&$orderby=TimeCreated\x20desc&$top=5000','Timesheet\x20Entry','CurrentPhase','Category','84RGuWeO','/_api/web/lists/GetByTitle(\x27MediaGallery\x27)/items(\x27','39568yFQMVI','Department','Yes','show','PATCH','format','GET','promise','SP.Data.EnvironmentalSettingsListItem','&$select=ID,CurrentPhase'];a298_0x1419=function(){return _0x385642;};return a298_0x1419();};function getTaskItemByTaskCategory(){var _0x59fa85=a298_0x1e20,_0x78c949=_0x59fa85(0x1e1);return DeferredObj=$['Deferred'](),$[_0x59fa85(0x1f7)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x59fa85(0x1de)+_0x78c949+_0x59fa85(0x212),'type':'GET','async':![],'headers':{'ACCEPT':_0x59fa85(0x1dc),'X-RequestDigest':$(_0x59fa85(0x1d8))['val']()},'success':function(_0x3cb373){var _0xc5b743=_0x59fa85,_0x5533f3=_0x3cb373['d'][_0xc5b743(0x216)];if(_0x5533f3['length']>0x0){for(var _0x29c119=0x0;_0x29c119<_0x5533f3[_0xc5b743(0x200)];_0x29c119++){updateTaskCategory(_0x5533f3[_0x29c119]['ID']);}alert('Successfully!');}waitingDialog['hide']();},'error':function(_0x2bb8f3){var _0x151b96=_0x59fa85;alert(JSON[_0x151b96(0x1e3)](_0x2bb8f3)),DeferredObj['reject'](_0x2bb8f3);}}),DeferredObj['promise']();};function a298_0x1e20(_0x55afdc,_0x1a846d){var _0x141987=a298_0x1419();return a298_0x1e20=function(_0x1e20d5,_0x276623){_0x1e20d5=_0x1e20d5-0x1d6;var _0x355bb3=_0x141987[_0x1e20d5];return _0x355bb3;},a298_0x1e20(_0x55afdc,_0x1a846d);}function updateTaskCategory(_0x185b92){var _0x4617c1=a298_0x1e20,_0x35fc89=GetItemTypeForListName(_0x4617c1(0x1e1));Metadata={'__metadata':{'type':_0x35fc89},'TaskCategory':_0x4617c1(0x1d6)};var _0x1ad36a=$[_0x4617c1(0x1d9)]();return $[_0x4617c1(0x1f7)]({'url':_spPageContextInfo[_0x4617c1(0x1f0)]+'/_api/web/lists/getbytitle(\x27EmployeeTaskDetails\x27)/GetItemById(\x27'+_0x185b92+'\x27)','type':_0x4617c1(0x21a),'async':![],'headers':{'accept':_0x4617c1(0x1dc),'X-RequestDigest':$(_0x4617c1(0x1d8))[_0x4617c1(0x222)](),'content-Type':_0x4617c1(0x1dc),'X-Http-Method':_0x4617c1(0x20c),'If-Match':'*'},'data':JSON[_0x4617c1(0x1e3)](Metadata),'success':function(_0x5e14a4){var _0x3a176d=_0x4617c1;_0x1ad36a[_0x3a176d(0x213)](_0x5e14a4),console[_0x3a176d(0x215)](_0x3a176d(0x1f4));},'eror':function(_0x35224f){var _0x591dd3=_0x4617c1;_0x1ad36a[_0x591dd3(0x1e6)](error),console['log']('An\x20error\x20occurred\x20while\x20deleting\x20task.\x20'+JSON[_0x591dd3(0x1e3)](_0x35224f));}}),_0x1ad36a['promise']();}var CompanySiteURL='';function getCurrentCopaniesURL(){var _0x415e6f=a298_0x1e20,_0x2dc1d2='Companies',_0x58b762=Logged_CompanyId;siteURL=_spPageContextInfo[_0x415e6f(0x1f0)]+'/_api/web/lists/getbytitle(\x27'+_0x2dc1d2+_0x415e6f(0x220)+_0x58b762+'\x27',$[_0x415e6f(0x1f7)]({'url':siteURL,'headers':{'Accept':_0x415e6f(0x1dc)},'async':![],'success':function(_0x13b971){var _0x6b5a8d=_0x415e6f,_0xc8ea8e=_0x13b971['d']['results'];_0xc8ea8e[_0x6b5a8d(0x200)]>0x0&&(CompanySiteURL=_0xc8ea8e[0x0][_0x6b5a8d(0x21c)],waitingDialog[_0x6b5a8d(0x20b)](),setTimeout(function(){getMediaGalleryAllItems();},0x1f4));},'eror':function(_0x2d693e){var _0x3b567f=_0x415e6f;alert($(_0x3b567f(0x21d))[_0x3b567f(0x222)]());}});}function getMediaGalleryAllItems(){var _0x3f4eee=a298_0x1e20,_0x2d7200=CompanySiteURL+_0x3f4eee(0x202);$['ajax']({'url':_0x2d7200,'headers':{'Accept':_0x3f4eee(0x1dc)},'async':![],'success':function(_0x2a08fd){var _0xe8cf61=_0x3f4eee,_0x43cadc=_0x2a08fd['d'][_0xe8cf61(0x216)];console[_0xe8cf61(0x215)](_0x2a08fd),$('#galleryFirstImgThumb')[_0xe8cf61(0x1f1)](),mediaGalleryCounter=0x0;for(var _0x1d4a72=0x0;_0x1d4a72<_0x43cadc['length'];_0x1d4a72++){if(_0x43cadc[_0x1d4a72][_0xe8cf61(0x1fe)]!='Forms'&&_0x43cadc[_0x1d4a72][_0xe8cf61(0x1fe)]!='_t'&&_0x43cadc[_0x1d4a72][_0xe8cf61(0x1fe)]!='_w'){var _0x1d2ebf=_0x43cadc[_0x1d4a72]['ServerRelativeUrl'];GetFolderDetails(_0x1d2ebf);}}alert(_0xe8cf61(0x1ea)),waitingDialog[_0xe8cf61(0x1f5)]();},'error':function(_0x5a86d1){alert(_0x5a86d1);}});}function GetFolderDetails(_0x15b7b6){var _0x330189=a298_0x1e20;fileLeafRef=_0x15b7b6;var _0xec4eab=CompanySiteURL+_0x330189(0x1f3)+_0x15b7b6+'\x27\x20and\x20ImageCreateDate\x20eq\x20null';$[_0x330189(0x1f7)]({'url':_0xec4eab,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0xd90f81){var _0x382d8b=_0x330189,_0x2fb403=_0xd90f81['d']['results'];if(_0x2fb403[_0x382d8b(0x200)]>0x0){var _0x498ce6=_0x2fb403[0x0]['FileLeafRef'],_0x2b9882=_0x2fb403[0x0]['Id'],_0x513e29=_0x2fb403[0x0][_0x382d8b(0x1f8)];fillDateTakenInMedia(_0x2b9882,_0x498ce6,_0x513e29);}},'error':function(_0x45dca3){alert(_0x45dca3);}});}function fillDateTakenInMedia(_0x1abf77,_0x3bd314,_0x2c27f0){var _0x2fb9a8=a298_0x1e20,_0x20b21b=new Date(_0x2c27f0);_0x20b21b=_0x20b21b[_0x2fb9a8(0x20d)](_0x2fb9a8(0x1ff)),$[_0x2fb9a8(0x1f7)]({'url':CompanySiteURL+_0x2fb9a8(0x207)+_0x1abf77+'\x27)','type':'POST','async':![],'data':JSON[_0x2fb9a8(0x1e3)]({'__metadata':{'type':_0x2fb9a8(0x219)},'Title':_0x3bd314,'ImageCreateDate':_0x20b21b}),'headers':{'Accept':_0x2fb9a8(0x1dc),'Content-Type':_0x2fb9a8(0x1dc),'X-RequestDigest':$('#__REQUESTDIGEST')['val'](),'IF-MATCH':'*','X-HTTP-Method':_0x2fb9a8(0x1dd)},'success':function(_0x192fc7,_0xf76dbe,_0x1e3a6c){var _0x246150=_0x2fb9a8;console[_0x246150(0x215)]('Updated!');},'error':function(_0x2dbc9c){alert(_0x2dbc9c);}});}function Addto_outlook(_0x492807){var _0x318e23=a298_0x1e20,_0xff3429=titanForWork[_0x318e23(0x21b)]('CompanySiteUrl')+_0x318e23(0x1d7)+_0x492807+'\x27)&$select=FieldValuesAsText/EventDate';$[_0x318e23(0x1f7)]({'url':_0xff3429,'headers':{'Accept':_0x318e23(0x1dc)},'async':![],'success':function(_0x2b1815){var _0x2943f8=_0x318e23,_0x1e3a1c=_0x2b1815['d'][_0x2943f8(0x216)];if(_0x1e3a1c[_0x2943f8(0x200)]>0x0)var _0x50f5da=_0x1e3a1c[0x0]['EventDate'],_0x2aab8a=_0x1e3a1c[0x0][_0x2943f8(0x1da)],_0x2f9e38=_0x1e3a1c[0x0]['Title'],_0x2918fd=_0x1e3a1c[0x0][_0x2943f8(0x205)],_0x137793=_0x1e3a1c[0x0][_0x2943f8(0x209)],_0xbe9cb=_0x1e3a1c[0x0][_0x2943f8(0x1fd)],_0x2c6d0d=_0x1e3a1c[0x0][_0x2943f8(0x1e8)];},'error':function(_0x2deeb0){var _0x3f0e39=_0x318e23;console[_0x3f0e39(0x215)](_0x2deeb0);}});}