var _0x1671fa=_0x5bec;(function(_0x2d75ff,_0x1ae402){var _0x51594f=_0x5bec,_0x174065=_0x2d75ff();while(!![]){try{var _0x1a3732=parseInt(_0x51594f(0x77))/0x1+-parseInt(_0x51594f(0xb9))/0x2+parseInt(_0x51594f(0x6e))/0x3*(-parseInt(_0x51594f(0x16b))/0x4)+parseInt(_0x51594f(0x163))/0x5+parseInt(_0x51594f(0x181))/0x6+parseInt(_0x51594f(0x93))/0x7+parseInt(_0x51594f(0x74))/0x8*(-parseInt(_0x51594f(0xe2))/0x9);if(_0x1a3732===_0x1ae402)break;else _0x174065['push'](_0x174065['shift']());}catch(_0x19f3a6){_0x174065['push'](_0x174065['shift']());}}}(_0x500e,0xc85bd),$(document)[_0x1671fa(0x6f)](function(){var _0x370941=_0x1671fa,_0x53753c=$(_0x370941(0xb6))[_0x370941(0x10d)](_0x370941(0x115))[_0x370941(0xd7)]();GetDepartmentUrl(),LoadAllDepartment(),departmentOnChange(),$(_0x370941(0xff))[_0x370941(0x109)](function(){getDataFromShareDocument();}),$(_0x370941(0x7a))[_0x370941(0x109)](function(){createNewCustomColumn();}),$(_0x370941(0xc2))[_0x370941(0x109)](function(){addEnvironmentalSettingsEntry();}),$(_0x370941(0x78))[_0x370941(0x109)](function(){getProjects();}),$(_0x370941(0x15b))['click'](function(){getDepartmentalItems();}),$('input[name=\x27optradio\x27]:checked'),$('#btncustomer')['click'](function(){AddCustomer();}),$('#btnCreateCustomColumns')[_0x370941(0x109)](function(){CreateListColumns();}),$(_0x370941(0x89))[_0x370941(0x109)](function(){Addemployee();}),$(_0x370941(0xc7))[_0x370941(0x109)](function(){AddCommentInAnnouncement();}),$(_0x370941(0x165))[_0x370941(0x109)](function(){addProjectkDetails();}),$(_0x370941(0x145))[_0x370941(0x109)](function(){var _0x48c5fa=_0x370941;confirm(_0x48c5fa(0xbf))&&ChangePriority();}),$(_0x370941(0xf2))[_0x370941(0x109)](function(){var _0x323eed=_0x370941;confirm(_0x323eed(0xbf))&&getBlankAssignedBy();}),$(_0x370941(0x101))[_0x370941(0x109)](function(){var _0x1bc12c=_0x370941;confirm(_0x1bc12c(0xbf))&&(waitingDialog[_0x1bc12c(0x184)](),setTimeout(function(){getInternalEmployees();},0x1f4));}),$(_0x370941(0xb7))[_0x370941(0x109)](function(){ChangeCompanyId();}),$(_0x370941(0xe5))[_0x370941(0x109)](function(){var _0x28544c=_0x370941;confirm(_0x28544c(0xbf))&&(waitingDialog[_0x28544c(0x184)](),setTimeout(function(){fileShareDocumentColumn();},0x1f4));}),$(_0x370941(0x14d))['click'](function(){var _0x4e7b46=_0x370941;confirm('The\x20related\x20MS\x20Flow\x20must\x20be\x20stopped.\x20\x0a\x20Do\x20want\x20to\x20continue\x20?')&&(waitingDialog[_0x4e7b46(0x184)](),setTimeout(function(){getTaskItemByTaskCategory();},0x1f4));});}));var TaskAssignTo=[0x74,0x14,0x20];function addEmployeeTaskDetails(){var _0x3d5084=_0x1671fa,_0x1dde73='EmployeeTaskDetails',_0x4037f1=new Date(),_0x32a5dc=_0x4037f1['toISOString']()[_0x3d5084(0xfe)](0x0,0x32);for(var _0x48879e=0x1;_0x48879e<=0x1f4;_0x48879e++){var _0xf0937a=_0x3d5084(0xa5)+_0x48879e,_0x37f8a3;_0x37f8a3={'__metadata':{'type':_0x3d5084(0x11b)},'TaskAssignToId':{'results':TaskAssignTo},'Title':_0xf0937a,'CurrentPhase':_0x3d5084(0x164),'TaskType':_0x3d5084(0x179),'StartDate':_0x32a5dc,'DueDate':'01/01/2023','TaskPriority':'Medium','Worktype':'Fixed\x20Bugs','Distribution':_0x3d5084(0x81),'CompanyId':Logged_CompanyId},$[_0x3d5084(0x84)](AddItemEmp(_0x1dde73,_0x37f8a3))[_0x3d5084(0x10a)](function(_0x1ac61a){var _0x4bb3f9=_0x3d5084;_0x48879e==0x1f4&&alert(_0x4bb3f9(0x178));});}}function addProjectkDetails(){var _0x4af49e=_0x1671fa,_0x1f7d62=_0x4af49e(0xf1),_0xb154c0=_0x4af49e(0x71),_0x4b405c=new Date(),_0x40296c=new Date(_0x4af49e(0x7f)),_0x1f7a9d=_0x4b405c[_0x4af49e(0x7c)]()[_0x4af49e(0xfe)](0x0,0x32);for(var _0x8c0066=0xbb8;_0x8c0066<=0x1388;_0x8c0066++){var _0xa2b70a='TestProject'+_0x8c0066,_0x1cd789;_0x1cd789={'__metadata':{'type':_0x4af49e(0xae)},'Title':_0xa2b70a,'ProjectCode':_0x4af49e(0x134),'ProjectName':_0xa2b70a,'ProjectDescription':_0xb154c0,'ProjectSiteURL':'','DepartmentId':'50','Department_IDId':Logged_DepartmentId,'ActualStartDate':_0x1f7a9d,'PlanedStartDate':_0x1f7a9d,'PlanedEndDate':_0x4af49e(0x148),'TechnologyUsed':'','Status':_0x4af49e(0x116),'DepartmentName':'50','ManagerNameId':0x20,'OfficeLocation':_0x4af49e(0x130),'Domain':_0x4af49e(0x112),'Office_Location_IdId':Logged_Location,'CompanyId':'2','ClientIDId':0x3,'ProgramIDId':0x2},$['when'](AddItemEmp(_0x1f7d62,_0x1cd789))[_0x4af49e(0x10a)](function(_0x38b7e1){var _0x835b82=_0x4af49e;_0x8c0066==0x1388&&alert(_0x835b82(0x178));});}}function AddItemEmp(_0x4fd393,_0x41bf25){var _0x1b27b9=_0x1671fa,_0x39ebd2=$['Deferred'](),_0x2e2ed6=_spPageContextInfo[_0x1b27b9(0xa2)]+'/_api/web/Lists/GetByTitle(\x27'+_0x4fd393+'\x27)/Items';return $[_0x1b27b9(0xca)]({'url':_0x2e2ed6,'type':'POST','async':![],'headers':{'accept':_0x1b27b9(0x9c),'X-RequestDigest':$(_0x1b27b9(0xef))[_0x1b27b9(0xd7)](),'content-Type':_0x1b27b9(0x9c)},'data':JSON[_0x1b27b9(0x13b)](_0x41bf25),'success':function(_0x25f033){var _0x1c6e7e=_0x1b27b9;_0x39ebd2[_0x1c6e7e(0x15a)](_0x25f033);},'error':function(_0x36240f){var _0x4ff0d4=_0x1b27b9;alert(JSON[_0x4ff0d4(0x13b)](_0x36240f)),_0x39ebd2[_0x4ff0d4(0xed)](_0x36240f);}}),_0x39ebd2[_0x1b27b9(0xdd)]();}function AddCustomer(){var _0x561052=_0x1671fa,_0x335115='';for(var _0x7225f5=0x1;_0x7225f5<=0x1f4;_0x7225f5++){var _0x1e629c='',_0x13ab09='';_0x335115=_0x561052(0x9f)+_0x7225f5;var _0x1794cc=_0x561052(0xfd)+_0x7225f5+_0x561052(0x9d),_0x12cd23=_0x561052(0xad)+_0x7225f5,_0x59fa38='New\x20York',_0x1cb72f='',_0x5b247f='',_0x2c6754='',_0xe699cb=_0x561052(0x9f),_0x563f22='',_0x15f62c=_0x561052(0x126),_0x1626ed='',_0x48dfed='ClientMaster',_0x3c1c72;_0x3c1c72={'__metadata':{'type':'SP.Data.ClientMasterListItem'},'Title':_0x335115,'Client_Code':_0x561052(0x141),'Attn_Name':_0x12cd23,'BillingAddress':_0x1e629c,'EmailId':_0x1794cc,'Country':_0x13ab09,'IsActive':!![],'City':_0x59fa38,'State':'Up','SalesPersonId':TaskAssignTo[0x0],'InternalMembersId':{'results':TaskAssignTo},'TemplateType':_0x561052(0x142),'InternalSupervisorId':TaskAssignTo[0x1],'CustType':_0x561052(0x136),'Contact_No':_0x561052(0xcf),'CompanyIDId':Logged_CompanyId},$['when'](AddItemEmp(_0x48dfed,_0x3c1c72))[_0x561052(0x10a)](function(_0x5956e7){_0x7225f5==0x1f4&&alert('Submit\x20successfully');});}}function Create_List(){var _0x157a94=_0x1671fa;createList(_0x157a94(0x16e));}function createList(_0x97f0fd){var _0x2505ce=_0x1671fa,_0x1224d6=_spPageContextInfo[_0x2505ce(0xa2)]+_0x2505ce(0x73);$['ajax']({'url':_0x1224d6,'type':'POST','data':JSON[_0x2505ce(0x13b)]({'__metadata':{'type':_0x2505ce(0x103)},'BaseTemplate':0x65,'Title':_0x97f0fd}),'headers':{'accept':_0x2505ce(0x9c),'content-type':_0x2505ce(0x9c),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x2505ce(0xd7)]()},'success':onQuerySucceeded,'error':onQueryFailed});}function onQuerySucceeded(_0x2ebae0){var _0x451315=_0x1671fa;alert(_0x2ebae0['d'][_0x451315(0x107)]+_0x451315(0x88));}function onQueryFailed(){var _0x464104=_0x1671fa;alert(_0x464104(0xbe));}function Addemployee(){var _0x319be2=_0x1671fa,_0x15fa15='Employees',_0x672b7b=new Date(),_0x173fea=_0x672b7b['toISOString']()[_0x319be2(0xfe)](0x0,0x32),_0x3f7e8c;for(var _0x2435be=0x12c6;_0x2435be<=0x1324;_0x2435be++){_0x3f7e8c={'__metadata':{'type':_0x319be2(0xfa)},'LogonNameId':0x74,'FullName':'Lakhan\x20sharma'+_0x2435be,'Title':_0x319be2(0x91)+_0x2435be,'ParentId':0x190,'Designation':'BA','Manager':_0x319be2(0x17a),'ManagerLoginNameId':0x14,'Email':'lakhan.sharma@adapt-india.com','Gender':'Male','CompanyId':Logged_CompanyId,'DepartmentId':Logged_DepartmentId,'OfficeLocationId':Logged_Location,'Status':_0x319be2(0xc6),'JoiningDate':_0x173fea,'PrimaryCompany':'Primary'},$[_0x319be2(0x84)](AddItemEmp(_0x15fa15,_0x3f7e8c))['done'](function(_0x32ec05){var _0x2dec4f=_0x319be2;_0x2435be==0x1324&&alert(_0x2dec4f(0x178));});}}function AddCommentInAnnouncement(){var _0xd1c680=_0x1671fa,_0x1d12ce;for(var _0xfd87ca=0x1;_0xfd87ca<=0x3e8;_0xfd87ca++){var _0x4aec91=_spPageContextInfo[_0xd1c680(0xb3)],_0x466dcd=_0xd1c680(0x161),_0x113d7a=_0xd1c680(0x96),_0x35101={'__metadata':{'type':_0xd1c680(0x16d)+_0x113d7a+_0xd1c680(0x135)},'Item_ID':_0xd1c680(0x131),'WebPartName':'Banner','Comment':'test'+_0xfd87ca,'ReplierId':parseInt(_0x4aec91),'Initials':_0xd1c680(0x85),'ReplyforId':parseInt(_0x4aec91),'UserImage':_0x466dcd};$[_0xd1c680(0x84)](AddItemEmp(_0x113d7a,_0x35101))['done'](function(_0x1d5851){var _0x3a766e=_0xd1c680;_0xfd87ca==0x3e8&&alert(_0x3a766e(0x178));});}}var arrMeta=[{'FieldTypeKind':0x2,'Title':_0x1671fa(0x16a)},{'FieldTypeKind':0x2,'Title':_0x1671fa(0x119)},{'FieldTypeKind':0x2,'Title':_0x1671fa(0x160)},{'FieldTypeKind':0x3,'Title':_0x1671fa(0x137)},{'FieldTypeKind':0x14,'Title':_0x1671fa(0x151)},{'FieldTypeKind':0x2,'Title':_0x1671fa(0x12a)},{'FieldTypeKind':0x14,'Title':_0x1671fa(0x17f)},{'FieldTypeKind':0x2,'Title':_0x1671fa(0xdc)},{'FieldTypeKind':0x2,'Title':_0x1671fa(0x138)},{'FieldTypeKind':0x2,'Title':'PermissionLevel'},{'FieldTypeKind':0x2,'Title':'PermissionLevelId'},{'FieldTypeKind':0x6,'Title':_0x1671fa(0xb5)},{'FieldTypeKind':0x2,'Title':_0x1671fa(0xa1)},{'FieldTypeKind':0x14,'Title':'ApprovedBy'},{'FieldTypeKind':0x4,'Title':'ApprovedDate'},{'FieldTypeKind':0x4,'Title':_0x1671fa(0x14a)},{'FieldTypeKind':0x4,'Title':_0x1671fa(0xd6)},{'FieldTypeKind':0x2,'Title':'ApprovedVersion'},{'FieldTypeKind':0x2,'Title':_0x1671fa(0x97)},{'FieldTypeKind':0x9,'Title':_0x1671fa(0xe0)},{'FieldTypeKind':0x3,'Title':'Titan_Permission'}];function _0x500e(){var _0x2b3c94=['find','test','Draft','LibraryURL','No\x20Task\x20with\x20Priority\x20\x27Top\x27\x20has\x20been\x20found.','ABC','FileLeafRef','/_api/web/lists/getbytitle(\x27EmployeeTaskDetails\x27)/GetItemById(\x27','.panel-heading-bg-txt-clr','Live','Please\x20select\x20radio\x20button','MM/DD/YYYY','DocumentType','join','SP.Data.EmployeeTaskDetailsListItem','__metadata','Inbox','\x27)/Items?$select=*,Author/EMail,Author/Title,FileRef,FileLeafRef&$expand=Author/Title&$filter=ID\x20eq\x20','push','All\x20Task\x27s\x20Priority\x20has\x20been\x20changed.','/_api/web/lists/getbytitle(\x27EmployeeTaskCounter\x27)/GetItemById(\x27','Guid\x20Field','Status','Logger','EmployeeTaskCounter','Gust','LogLevel','/sites/','results','SubCategory','ListItemAllFields','membership|','change','FieldTypeKind','/_api/Web/Lists/getByTitle(\x27SharedDocument\x27)/Items','Gurgaon\x20Main\x20Office','1357','LogonName','SP.Field','2540D','ListItem','Guest','Details','SecurityLevel','Deferred','&$filter=((TaskAssignTo/EMail\x20eq\x20\x27','stringify','expand','then','Author','Rejected','ExternalUsers','205','Template1','No\x20record\x20found.','\x27)/fields/getbytitle(','#btnChangePriority','SP.Data.EmployeeTaskCounterListItem','email','2022-10-26T12:10:10.641Z','/Titan/InformationTechnology22255/_api/web/lists/getByTitle(\x27DepartmentalDMS\x27)/fields','FileValidity','/_api/web/lists/getByTitle(\x27EmployeeTaskDetails\x27)/items/?$top=5000','\x27)?$select=*,Author/EMail,File_x0020_Type&$top=5000&$expand=Author/EMail,Folders,Folders/ListItemAllFields,Files,Folders/ListItemAllFields/Created_x0020_By,Files/ListItemAllFields/Created_x0020_By,Files/ListItemAllFields&$orderby=ListItemAllFields/TimeLastModified\x20desc','#btnTaskItemByTaskCategory','DocumentManagementSystem','LoginName','activeLogLevel','Shared','value','High','ConsoleListener','EMail','?$top=5000&$select=*,UserId/Id,UserId/EMail&$expand=UserId&$filter=UserId/EMail\x20eq\x20\x27','Not\x20Required','SP.FieldDateTime','Item','resolve','#btnSharingHistory','\x27\x20or\x20DependencyTo/EMail\x20eq\x20\x27','Success','PATCH','lastIndexOf','DocumentWrittenBy','/sites/Titan_2_2_1_DEV/Lists/Employees/Attachments/400/dipankar1.jpg','Employee','6756320wdeWCk','Open','#btnaddProject','select','?$top=5000&$select=*,Approvers/EMail,Approvers/Title,Approvers/Id&$Expand=Approvers&$OrderBy=Modified\x20asc','An\x20error\x20occurred\x20while\x20deleting\x20task.\x20','/_api/Web/lists/GetByTitle(\x27','DocumentNo','185316QaPtqJ','\x27)/fields?$filter=Title\x20eq\x20\x27','SP.Data.','Test\x20by\x20lakhan','\x27)/Items?$select=ID,*&$top=5000&$filter=SharedId\x20ne\x20null','&$filter=((Approvers/EMail\x20eq\x20\x27','get','slice','filter','Updated\x20','format','?$top=5000&$select=*,ClientID/ID,ClientID/Title,Module/Title,Module/ID,AssignedBy/EMail,AssignedBy/Title,AssignedBy/Id,Author/Title,Author/EMail,DependencyTo/EMail,DependencyTo/Title,TaskAssignTo/EMail,TaskAssignTo/Title,TaskAssignTo/ID,AttachmentFiles&$Expand=ClientID,Module,Author,AssignedBy,AttachmentFiles,TaskAssignTo,DependencyTo&$OrderBy=Modified\x20asc','CompanyIDId','Submit\x20successfully','General\x20task','Dipankar\x20Goswami','trim','ApplicationLink','items','DocumentURL','Shared\x20With','Success\x20','1841100PaSFIK','/_api/web/Lists/GetByTitle(\x27DepartmentalDMS\x27)/Items?$select=*,ID,DocumentWrittenBy,Modified,Editor/EMail,Editor/Title,File_x0020_Type,DocumentType,Title,AccessLevel,File/Name,File/ServerRelativeUrl&$top=5000&$expand=File,Editor/Id&$orderby=Modified\x20desc&$filter=startswith(AccessLevel,\x20\x27Everyone\x27)\x20and\x20ApprovalStatus\x20eq\x20\x27Approved\x27','charAt','show','60qXftPD','ready','All\x20counters\x20have\x20been\x20updated.','A\x20pie\x20chart\x20(or\x20a\x20circle\x20chart)\x20is\x20a\x20circular\x20statistical\x20graphic,\x20which\x20is\x20divided\x20into\x20slices\x20to\x20illustrate\x20numerical\x20proportion.\x20In\x20a\x20pie\x20chart,\x20the\x20arc\x20length\x20of\x20each\x20slice\x20(and\x20consequently\x20its\x20central\x20angle\x20and\x20area),\x20is\x20proportional\x20to\x20the\x20quantity\x20it\x20represents.\x20While\x20it\x20is\x20named\x20for\x20its\x20resemblance\x20to\x20a\x20pie\x20which\x20has\x20been\x20sliced,\x20there\x20are\x20variations\x20on\x20the\x20way\x20it\x20can\x20be\x20presented.\x20The\x20earliest\x20known\x20pie\x20chart\x20is\x20generally\x20credited\x20to\x20William\x20Playfair\x20ie\x20charts\x20are\x20very\x20widely\x20used\x20in\x20the\x20business\x20world\x20and\x20the\x20mass\x20media.[3]\x20However,\x20they\x20have\x20been\x20criticized,[4]\x20and\x20many\x20experts\x20recommend\x20avoiding\x20them,[5][6][7][8]','append','/_api/web/lists','6003448sXwoFK','getAll','No\x20record\x20found','154873fNwXFG','#btnFilProject','&$filter=((Author/EMail\x20eq\x20\x27','#btnCreateCustomColumn','Name','toISOString','Enter\x20valit\x20url','\x20and\x20PermissionStatus\x20ne\x20\x27Revoked\x27&$select=Id','26/5/2022','/_api/web/lists/getbytitle(\x27ApplicationLink\x27)/GetItemById(','Consolidated','\x27)\x20and\x20(Status\x20eq\x20\x27Initiated\x27\x20or\x20Status\x20eq\x20\x27Forwarded\x27))','/_api/web/lists/getByTitle(\x27SharedDocument\x27)/items/?$select=*&$filter=DocumentID\x20eq\x20\x27','when','Parent','.radioBtnClass','getByTitle','\x20successfully\x20created!','#btnAddEmployee','/DocumentManagementSystem','error','\x27)\x20and\x20(CurrentPhase\x20eq\x20\x27Open\x27))','GET','SP.FieldChoice','#txtSubsiteURL','responseText','Lakhan\x20sharma','An\x20error\x20occurred\x20while\x20deleting\x20Application.\x20','8465520pnCxAF','please\x20enter\x20DMS\x20url','Info','AnnouncementsChild','ApprovedByOutsider','DeptId','/_api/web/lists/getByTitle(\x27EmployeeTaskDetails\x27)/items/?$top=5000&$filter=TaskPriority\x20eq\x20\x27Top\x27&$select=Id,TaskPriority&$OrderBy=Modified\x20asc','length','message','application/json;odata=verbose','@x.com','Required','Adapt','AuthorEMail','Approval','webAbsoluteUrl','Outbox','empty','TestTask','Please\x20enter\x20DMS\x20url','split','SharedUsersId','ApprovedBy','\x27\x20or\x20AssignedBy/EMail\x20eq\x20\x27','lists','/_api/Web/Lists/getByTitle(\x27SharedDocument\x27)/Items(','Lakhan','SP.Data.ProjectDetailsListItem','toUpperCase','/_api/web/lists/getByTitle(\x27ApplicationLink\x27)/items/?$top=5000&$filter=Company/ID\x20ne\x20null&$select=*,Company/ID,Id&$expand=Company&$OrderBy=Modified\x20asc','setHours','/_api/web/lists/getByTitle(\x27','userId','Successfully\x20done!','Acknowledgement','#btnSubmit','#btnChangeCompanyId','DELETE','1049334UJSSLO','GuestUser','File','All\x20Task\x27s\x20\x27Assigned\x20By\x27\x20column\x20have\x20been\x20set.','SP.FieldUser','Error!','The\x20related\x20MS\x20Flow\x20must\x20be\x20stopped.\x20\x0a\x20Do\x20want\x20to\x20continue\x20?',':checked','Update\x20Successfully','#btnenvironmental','ID,Status,LoginName/EMail,LoginName/ID,email','&$filter=AssignedBy/EMail\x20eq\x20null&$select=Id,AssignedBy/EMail,Author/EMail,Author/Id&$expand=AssignedBy,Author&$OrderBy=Modified\x20asc','Approved','Active','#btnaddComment','/_api/web/lists/getByTitle(\x27SharedDocument\x27)/items/?$select=ID,LibraryURL&$filter=LibraryName\x20eq\x20\x27DepartmentalDMS\x27\x20and\x20CompanyIDId\x20eq\x20null\x20and\x20DepartmentIDId\x20eq\x20null&$top5000','SharedUsers','ajax','All\x20ready\x20Add\x20','guid\x27','uri','<option\x20value=\x22','02546580','EmployeeTaskDetails','Employees','SP.Data.SharedDocumentListItem','forEach','\x27)/items/','Update\x20successfully','email_date','val','Files','#DepartmentDDL','Wrong\x20Url\x20!','SiteURL','AccessLevel','promise','CompanyID','/_api/web/lists/getbytitle(\x27Departments\x27)/items?$select=CompanyIDId,ID,Title,SiteURL','CommentCount','No\x20Task\x20with\x20blank\x20\x27Assigned\x20By\x27\x20value\x20has\x20been\x20found.','9gdeCCt','responseJSON','log','#btnDocumentColumn','DueDate','\x27)/fields','_api/web/Lists/GetByTitle(\x27','subscribe','SharedDocument','</option>','hide','reject','Failed','#__REQUESTDIGEST','orderBy','ProjectDetails','#btnFillAssignedByTask','\x27)/items','Email','input[name=\x27optradio\x27]:checked','true','/DepartmentalDMS','/_api/web/lists/getbytitle(\x27Departments\x27)/items?select=*,ID,Title&$orderby=Title\x20asc&$top=5000','web','SP.Data.EmployeesListItem','#sharedDmsURL','Created_x0020_By','Demo','substring','#btnFillcompanyAndDepartmentId','?$top=5000&$select=*,Author/EMail,Author/Title,Author/Id&$Expand=Author&$OrderBy=Modified\x20asc','#btnUpdateTaskCounter','_api/Web/Lists/getByTitle(\x27','SP.List','text','POST','\x27)/Items(','Title','\x27)/fields/getbytitle(\x27','click','done','ApprovedDate','each'];_0x500e=function(){return _0x2b3c94;};return _0x500e();}function CreateListColumn(){var _0x148331=_0x1671fa;console[_0x148331(0xe4)](arrMeta);for(var _0x204df5=0x0;_0x204df5<arrMeta['length'];_0x204df5++){var _0x26fab7;_0x26fab7={'__metadata':{'type':_0x148331(0xbd),'addToDefaultView':_0x148331(0xf6)},'FieldTypeKind':arrMeta[_0x204df5][_0x148331(0x12e)],'Title':arrMeta[_0x204df5][_0x148331(0x107)],'SelectionMode':0x0,'AllowMultipleValues':!![]},$[_0x148331(0xca)]({'url':_spPageContextInfo[_0x148331(0xa2)]+_0x148331(0x149),'type':'POST','async':![],'data':JSON[_0x148331(0x13b)](_0x26fab7),'headers':{'Accept':_0x148331(0x9c),'Content-Type':'application/json;odata=verbose','X-RequestDigest':$(_0x148331(0xef))[_0x148331(0xd7)]()},'success':function(_0x5c190d,_0x304ea1,_0x1f4cff){var _0x5e7e2f=_0x148331;console['log'](_0x5e7e2f(0x15d)+Title),alert('Created');},'error':function(_0x3d63e4,_0x2b0fc5,_0x1f0082){var _0x355700=_0x148331;alert(_0x3d63e4[_0x355700(0x90)]);}});}}function getGUID(){var _0x29b8b5=_0x1671fa,_0x1ebfc8=_spPageContextInfo[_0x29b8b5(0xa2)]+'/Titan/IT/_api/web/lists/getByTitle(\x27KnowledgeBaseCategory\x27)/Items?$select=GUID';$[_0x29b8b5(0xca)]({'url':_0x1ebfc8,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x2b0758){var _0x7c2d56=_0x29b8b5,_0x281fa6=_0x2b0758['d'][_0x7c2d56(0x129)][0x0][_0x7c2d56(0x11c)];return console[_0x7c2d56(0xe4)](_0x2b0758['d'][_0x7c2d56(0x129)][0x0][_0x7c2d56(0x11c)][_0x7c2d56(0xcd)]),_0x281fa6['uri'][_0x7c2d56(0xa7)](_0x7c2d56(0xcc))[0x1]['split']('\x27)')[0x0],_0x281fa6;},'error':function(_0x3ef0e7){var _0x229dca=_0x29b8b5;console['log'](_0x229dca(0x122));}});}function createNewCustomColumn(){var _0x91a098=_0x1671fa,_0x5cd894=$(_0x91a098(0x8f))[_0x91a098(0xd7)]()[_0x91a098(0x17b)](),_0x5ca7b2=_0x5cd894[_0x91a098(0x15f)]('/');if(_0x5cd894[_0x91a098(0x9a)]==0x0)return alert('Please\x20Enter\x20DMS\x20site\x20URl'),![];if($(_0x91a098(0x86))['is'](_0x91a098(0xc0))==![])return alert(_0x91a098(0x117)),![];var _0x4e2320=_0x5cd894['split']('/');_0x4e2320=_0x4e2320[_0x4e2320['length']-0x1];_0x4e2320=='/'&&(_0x4e2320=_0x4e2320[_0x4e2320['length']-0x2]);for(var _0x422f70=0x0;_0x422f70<arrMeta[_0x91a098(0x9a)];_0x422f70++){var _0x315d73;GetAllFieldsFromList(_0x5cd894['slice'](0x0,_0x5ca7b2),_0x4e2320,arrMeta[_0x422f70][_0x91a098(0x107)]);if(urlValidation==![])return![];if(exists==![]){var _0x4f733='';_0x4f733=_0x5cd894[_0x91a098(0x172)](0x0,_0x5ca7b2)+'/_api/web/lists/getByTitle(\x27'+_0x4e2320+_0x91a098(0xe7),arrMeta[_0x422f70][_0x91a098(0x12e)]==0x6?arrMeta[_0x422f70]['Title']==_0x91a098(0xb5)?_0x315d73={'__metadata':{'type':'SP.FieldChoice','addToDefaultView':'true'},'FieldTypeKind':arrMeta[_0x422f70][_0x91a098(0x12e)],'Title':arrMeta[_0x422f70][_0x91a098(0x107)],'Choices':{'results':[_0x91a098(0x9e),_0x91a098(0x157),'N/A']}}:_0x315d73={'__metadata':{'type':_0x91a098(0x8e),'addToDefaultView':_0x91a098(0xf6)},'FieldTypeKind':arrMeta[_0x422f70][_0x91a098(0x12e)],'Title':arrMeta[_0x422f70][_0x91a098(0x107)],'Choices':{'results':[_0x91a098(0x10f),_0x91a098(0xc5),'Pending',_0x91a098(0x13f)]}}:arrMeta[_0x422f70][_0x91a098(0x12e)]!=0x7&&(_0x315d73={'__metadata':{'type':_0x91a098(0x133),'addToDefaultView':_0x91a098(0xf6)},'FieldTypeKind':arrMeta[_0x422f70][_0x91a098(0x12e)],'Title':arrMeta[_0x422f70][_0x91a098(0x107)]}),arrMeta[_0x422f70][_0x91a098(0x107)]==_0x91a098(0x151)&&(_0x4f733=_0x5cd894[_0x91a098(0x172)](0x0,_0x5ca7b2)+_0x91a098(0xb2)+_0x4e2320+'\x27)/fields',_0x315d73={'__metadata':{'type':'SP.FieldUser','addToDefaultView':_0x91a098(0xf6)},'FieldTypeKind':arrMeta[_0x422f70][_0x91a098(0x12e)],'Title':arrMeta[_0x422f70]['Title'],'AllowMultipleValues':!![]}),arrMeta[_0x422f70][_0x91a098(0x107)]==_0x91a098(0x17f)&&(_0x4f733=_0x5cd894[_0x91a098(0x172)](0x0,_0x5ca7b2)+'/_api/web/lists/getByTitle(\x27'+_0x4e2320+_0x91a098(0xe7),_0x315d73={'__metadata':{'type':_0x91a098(0xbd),'addToDefaultView':_0x91a098(0xf6)},'FieldTypeKind':arrMeta[_0x422f70][_0x91a098(0x12e)],'Title':arrMeta[_0x422f70]['Title']}),arrMeta[_0x422f70][_0x91a098(0x107)]==_0x91a098(0xa9)&&(_0x4f733=_0x5cd894[_0x91a098(0x172)](0x0,_0x5ca7b2)+_0x91a098(0xb2)+_0x4e2320+_0x91a098(0xe7),_0x315d73={'__metadata':{'type':'SP.FieldUser','addToDefaultView':'true'},'FieldTypeKind':arrMeta[_0x422f70][_0x91a098(0x12e)],'Title':arrMeta[_0x422f70][_0x91a098(0x107)],'SelectionMode':0x0}),arrMeta[_0x422f70][_0x91a098(0x107)]=='FileValidity'&&(_0x4f733=_0x5cd894[_0x91a098(0x172)](0x0,_0x5ca7b2)+_0x91a098(0xb2)+_0x4e2320+_0x91a098(0xe7),_0x315d73={'__metadata':{'type':_0x91a098(0x158)},'FieldTypeKind':arrMeta[_0x422f70][_0x91a098(0x12e)],'Title':arrMeta[_0x422f70]['Title'],'DisplayFormat':0x0}),arrMeta[_0x422f70][_0x91a098(0x107)]==_0x91a098(0xd6)&&(_0x4f733=_0x5cd894['slice'](0x0,_0x5ca7b2)+_0x91a098(0xb2)+_0x4e2320+_0x91a098(0xe7),_0x315d73={'__metadata':{'type':'SP.FieldDateTime'},'FieldTypeKind':arrMeta[_0x422f70]['FieldTypeKind'],'Title':arrMeta[_0x422f70][_0x91a098(0x107)],'DisplayFormat':0x0}),arrMeta[_0x422f70][_0x91a098(0x107)]==_0x91a098(0x10b)&&(_0x4f733=_0x5cd894['slice'](0x0,_0x5ca7b2)+'/_api/web/lists/getByTitle(\x27'+_0x4e2320+_0x91a098(0xe7),_0x315d73={'__metadata':{'type':'SP.FieldDateTime'},'FieldTypeKind':arrMeta[_0x422f70][_0x91a098(0x12e)],'Title':arrMeta[_0x422f70][_0x91a098(0x107)],'DisplayFormat':0x0}),$[_0x91a098(0xca)]({'url':_0x4f733,'type':_0x91a098(0x105),'async':![],'data':JSON[_0x91a098(0x13b)](_0x315d73),'headers':{'Accept':_0x91a098(0x9c),'Content-Type':_0x91a098(0x9c),'X-RequestDigest':$(_0x91a098(0xef))['val']()},'success':function(_0x228957,_0x14eb91,_0x3a4cd0){var _0x1f2013=_0x91a098;console[_0x1f2013(0xe4)](_0x1f2013(0x180)+arrMeta[_0x422f70][_0x1f2013(0x107)]),arrMeta[_0x1f2013(0x9a)]-0x1==_0x422f70&&alert('Created\x20successfully\x20!');},'error':function(_0x48ad2a,_0x1c5b78,_0xab2b19){var _0x21e1af=_0x91a098;console[_0x21e1af(0xe4)](_0x21e1af(0xee));}});}else console[_0x91a098(0xe4)](_0x91a098(0xcb)+arrMeta[_0x422f70][_0x91a098(0x107)]),arrMeta[_0x91a098(0x9a)]-0x1==_0x422f70&&alert('Successfully\x20done!');}}var arrColumn=_0x1671fa(0x10e),urlValidation=!![],exists=![];function GetAllFieldsFromList(_0x4078d4,_0xa4c51f,_0x5d1314){var _0xa8b675=_0x1671fa;arrColumn='',exists=![],$[_0xa8b675(0xca)]({'url':_0x4078d4+_0xa8b675(0xb2)+_0xa4c51f+_0xa8b675(0x16c)+_0x5d1314+'\x27','method':_0xa8b675(0x8d),'async':![],'headers':{'Accept':_0xa8b675(0x9c)},'success':function(_0x30e550,_0xed01c3,_0x3bef97){var _0x29d670=_0xa8b675,_0xfac090=_0x30e550['d'][_0x29d670(0x129)];if(_0xfac090[_0x29d670(0x9a)]>0x0)for(var _0x20e552=0x0;_0x20e552<_0xfac090['length'];_0x20e552++){ColumnTitle=_0xfac090[_0x20e552][_0x29d670(0x107)],exists=!![],$(_0x29d670(0xf5))['val']()=='2'&&DeleteListColumn(_0x4078d4,ColumnTitle,_0xa4c51f),console[_0x29d670(0xe4)](_0xfac090[_0x20e552][_0x29d670(0x107)]);}},'error':function(_0x5104ee,_0x2d93d7,_0x4d6739){var _0x713569=_0xa8b675;alert(_0x713569(0xda)),urlValidation=![];}});}function UpdateFieldFromList(_0x5dcf34,_0x48ff18,_0x7a62d6){var _0x1c6018=_0x1671fa;$[_0x1c6018(0xca)]({'url':_0x5dcf34+'/_api/web/lists/getByTitle(\x27'+_0x48ff18+_0x1c6018(0x144)+_0x7a62d6+')','method':'POST','data':JSON['stringify']({'__metadata':{'type':_0x1c6018(0xbd),'addToDefaultView':_0x1c6018(0xf6)},'Description':'Updated\x20Description\x20of\x20the\x20field','FieldTypeKind':0x14,'Title':_0x7a62d6,'AllowMultipleValues':!![]}),'headers':{'IF-MATCH':'*','X-HTTP-Method':_0x1c6018(0x15e),'Accept':_0x1c6018(0x9c),'Content-Type':_0x1c6018(0x9c),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x1c6018(0xd7)]()},'success':function(_0x106dee,_0x3722dd,_0x3e6342){var _0x5d89c6=_0x1c6018;console[_0x5d89c6(0xe4)](_0x5d89c6(0x174)+_0x7a62d6);},'error':function(_0x3c7db8,_0x1aa1dc,_0x1b54b0){var _0x5008c4=_0x1c6018;console[_0x5008c4(0xe4)](_0x5008c4(0xee));}});}function DeleteListColumn(_0x3941b3,_0x3039fc,_0x5997a5){var _0x1593b4=_0x1671fa;$[_0x1593b4(0xca)]({'url':_0x3941b3+'/_api/web/lists/getByTitle(\x27'+_0x5997a5+_0x1593b4(0x108)+_0x3039fc+'\x27)','type':_0x1593b4(0x105),'async':![],'headers':{'Accept':_0x1593b4(0x9c),'Content-Type':_0x1593b4(0x9c),'IF-MATCH':'*','X-HTTP-Method':_0x1593b4(0xb8),'X-RequestDigest':$(_0x1593b4(0xef))[_0x1593b4(0xd7)]()},'success':function(_0x31f0fa,_0x9a3161,_0x516b93){console['log']('Delete\x20Success\x20'+_0x3039fc),exists=![],urlValidation=!![];},'error':function(_0x5675c6,_0x1c2993,_0x48c9e7){var _0x95eec1=_0x1593b4;console[_0x95eec1(0xe4)](_0x95eec1(0xee));}});}function GetItemTypeForListName(_0x15e2ce){var _0x174176=_0x1671fa;return _0x174176(0x16d)+_0x15e2ce[_0x174176(0x183)](0x0)[_0x174176(0xaf)]()+_0x15e2ce[_0x174176(0xa7)]('\x20')[_0x174176(0x11a)]('')[_0x174176(0x172)](0x1)+_0x174176(0x135);}function ChangePriority(){var _0x53cacd=_0x1671fa;$[_0x53cacd(0xca)]({'url':_spPageContextInfo[_0x53cacd(0xa2)]+_0x53cacd(0x99),'method':_0x53cacd(0x8d),'async':![],'headers':{'Accept':'application/json;odata=verbose'},'success':function(_0x110773,_0x82b41b,_0xe7aea9){var _0x494285=_0x53cacd,_0x34ab87=_0x110773['d'][_0x494285(0x129)];if(_0x34ab87[_0x494285(0x9a)]>0x0)updatePriority(_0x34ab87);else return alert(_0x494285(0x111)),![];},'error':function(_0x49d106,_0x41fdda,_0x41716d){var _0x1ce73c=_0x53cacd;console[_0x1ce73c(0xe4)](_0x49d106[_0x1ce73c(0x90)]);}});}function updatePriority(_0x1068eb){var _0x24484d=_0x1671fa,_0x243265=GetItemTypeForListName(_0x24484d(0xd0));Metadata={'__metadata':{'type':_0x243265},'TaskPriority':_0x24484d(0x153)},_0x1068eb[_0x24484d(0xd3)](function(_0x4d5138,_0x54e32b){var _0x332790=_0x24484d,_0x3760b1=$[_0x332790(0x139)]();return $['ajax']({'url':_spPageContextInfo['webAbsoluteUrl']+_0x332790(0x114)+_0x4d5138['Id']+'\x27)','type':_0x332790(0x105),'async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$('#__REQUESTDIGEST')[_0x332790(0xd7)](),'content-Type':'application/json;odata=verbose','X-Http-Method':_0x332790(0x15e),'If-Match':'*'},'data':JSON['stringify'](Metadata),'success':function(_0xef8c87){var _0x1a61b3=_0x332790;_0x3760b1[_0x1a61b3(0x15a)](_0xef8c87),_0x1068eb['length']==_0x54e32b+0x1&&alert(_0x1a61b3(0x120));},'eror':function(_0x20cae0){var _0x2f325d=_0x332790;_0x3760b1[_0x2f325d(0xed)](error),console[_0x2f325d(0xe4)](_0x2f325d(0x168)+JSON[_0x2f325d(0x13b)](_0x20cae0));}}),_0x3760b1['promise']();});}function getBlankAssignedBy(){var _0x512e48=_0x1671fa;$['ajax']({'url':_spPageContextInfo[_0x512e48(0xa2)]+_0x512e48(0x14b)+_0x512e48(0xc4),'method':_0x512e48(0x8d),'async':![],'headers':{'Accept':_0x512e48(0x9c)},'success':function(_0x13ae20,_0x5aa846,_0x544032){var _0x50827b=_0x512e48,_0x38a9ba=_0x13ae20['d'][_0x50827b(0x129)];if(_0x38a9ba[_0x50827b(0x9a)]>0x0)updateAssignedBy(_0x38a9ba);else return alert(_0x50827b(0xe1)),![];},'error':function(_0x3a160e,_0x289f30,_0x537021){var _0x47c3ed=_0x512e48;alert(_0x3a160e[_0x47c3ed(0x90)]);return;}});}function updateAssignedBy(_0x141464){var _0x9f58e4=_0x1671fa,_0x3a853a=GetItemTypeForListName('EmployeeTaskDetails');_0x141464[_0x9f58e4(0xd3)](function(_0x871eaa,_0x1ad415){var _0x22b4e7=_0x9f58e4;Metadata={'__metadata':{'type':_0x3a853a},'AssignedById':_0x871eaa[_0x22b4e7(0x13e)]['Id']};var _0x3d9994=$[_0x22b4e7(0x139)]();return $[_0x22b4e7(0xca)]({'url':_spPageContextInfo[_0x22b4e7(0xa2)]+_0x22b4e7(0x114)+_0x871eaa['Id']+'\x27)','type':_0x22b4e7(0x105),'async':![],'headers':{'accept':_0x22b4e7(0x9c),'X-RequestDigest':$(_0x22b4e7(0xef))[_0x22b4e7(0xd7)](),'content-Type':_0x22b4e7(0x9c),'X-Http-Method':'PATCH','If-Match':'*'},'data':JSON['stringify'](Metadata),'success':function(_0x33552c){var _0x24a03e=_0x22b4e7;_0x3d9994['resolve'](_0x33552c),_0x141464[_0x24a03e(0x9a)]==_0x1ad415+0x1&&alert(_0x24a03e(0xbc));},'eror':function(_0x20e96e){var _0x1c5035=_0x22b4e7;_0x3d9994[_0x1c5035(0xed)](error),console[_0x1c5035(0xe4)]('An\x20error\x20occurred\x20while\x20changing\x20task.\x20'+JSON[_0x1c5035(0x13b)](_0x20e96e));}}),_0x3d9994[_0x22b4e7(0xdd)]();});}function getInternalEmployees(){var _0x10f120=_0x1671fa,_0x1e9f0a='';pnp[_0x10f120(0x124)][_0x10f120(0xe9)](new pnp['ConsoleListener']()),pnp[_0x10f120(0x124)][_0x10f120(0x150)]=pnp[_0x10f120(0x127)][_0x10f120(0x95)],pnp['sp'][_0x10f120(0xf9)][_0x10f120(0x171)]()[_0x10f120(0x13d)](function(_0x25bf4e){var _0x621f51=_0x10f120;console[_0x621f51(0xe4)](JSON[_0x621f51(0x13b)](_0x25bf4e,null,0x4));});try{result=pnp['sp'][_0x10f120(0xf9)][_0x10f120(0xab)][_0x10f120(0x87)](_0x10f120(0xd1))[_0x10f120(0x17d)][_0x10f120(0x166)]('ID,Status,LogonName/EMail,LogonName/ID,Email')['expand'](_0x10f120(0x132))[_0x10f120(0x173)]('')[_0x10f120(0xf0)]('','')[_0x10f120(0x75)]()[_0x10f120(0x13d)](function(_0x4b2842){var _0x3780d1=_0x10f120;_0x1e9f0a=_0x4b2842[_0x3780d1(0x173)](function(_0x59d5ca){var _0x411cf6=_0x3780d1;return _0x59d5ca[_0x411cf6(0x123)]==_0x411cf6(0xc6);}),getExternalEmployees(_0x1e9f0a);});}catch(_0x24df33){waitingDialog[_0x10f120(0xec)](),console[_0x10f120(0xe4)](_0x24df33);}}function getExternalEmployees(_0x543d6f){var _0x5c6586=_0x1671fa,_0x576333='';pnp[_0x5c6586(0x124)][_0x5c6586(0xe9)](new pnp[(_0x5c6586(0x154))]()),pnp[_0x5c6586(0x124)]['activeLogLevel']=pnp[_0x5c6586(0x127)][_0x5c6586(0x95)],pnp['sp']['web'][_0x5c6586(0x171)]()[_0x5c6586(0x13d)](function(_0x8ba739){var _0x42bccb=_0x5c6586;console[_0x42bccb(0xe4)](JSON[_0x42bccb(0x13b)](_0x8ba739,null,0x4));});try{result=pnp['sp'][_0x5c6586(0xf9)][_0x5c6586(0xab)][_0x5c6586(0x87)](_0x5c6586(0x140))[_0x5c6586(0x17d)][_0x5c6586(0x166)](_0x5c6586(0xc3))[_0x5c6586(0x13c)]('LoginName')[_0x5c6586(0x173)]('')[_0x5c6586(0xf0)]('','')[_0x5c6586(0x75)]()[_0x5c6586(0x13d)](function(_0x1ffff5){var _0x3fcf40=_0x5c6586;_0x576333=_0x1ffff5[_0x3fcf40(0x173)](function(_0xd6adce){var _0x47c23e=_0x3fcf40;return _0xd6adce[_0x47c23e(0x123)]=='Active';}),checkInCounterList(_0x543d6f,_0x576333);});}catch(_0x41ffd4){waitingDialog[_0x5c6586(0xec)](),console[_0x5c6586(0xe4)](_0x41ffd4);}}function checkInCounterList(_0x3b081c,_0xd59977){var _0x1a6fd2=_0x1671fa;$[_0x1a6fd2(0x10c)](_0x3b081c,function(_0x3c05c4,_0x4271c7){var _0x369f11=_0x1a6fd2,_0x1779e8='?$top=5000&$select=*,UserId/Id,UserId/EMail&$expand=UserId&$filter=UserId/EMail\x20eq\x20\x27'+_0x4271c7[_0x369f11(0xf4)]+'\x27\x20';$[_0x369f11(0x84)](getItemsWithQueryItem(_0x369f11(0x125),_0x1779e8))[_0x369f11(0x10a)](function(_0x29d275){var _0x1eca94=_0x369f11;_0x29d275['length']>0x0?(GetTaskInboxCount(_0x4271c7[_0x1eca94(0xf4)],_0x29d275[0x0]['Id']),GetTaskOutboxCount(_0x4271c7[_0x1eca94(0xf4)],_0x29d275[0x0]['Id']),GetApprovalInboxCount(_0x4271c7[_0x1eca94(0xf4)],_0x29d275[0x0]['Id'])):AddUserInCounterList(_0x4271c7[_0x1eca94(0x132)]['ID'],'Employee',_0x4271c7[_0x1eca94(0xf4)],_0x1eca94(0x162));});}),$[_0x1a6fd2(0x10c)](_0xd59977,function(_0x2d6d20,_0x91b0a5){var _0x545073=_0x1a6fd2,_0x2dc74b=_0x545073(0x156)+_0x91b0a5[_0x545073(0x147)]+'\x27\x20';$['when'](getItemsWithQueryItem(_0x545073(0x125),_0x2dc74b))['done'](function(_0x3fa4cc){var _0x4a270e=_0x545073;_0x3fa4cc[_0x4a270e(0x9a)]>0x0?(GetTaskInboxCount(_0x91b0a5[_0x4a270e(0x147)],_0x3fa4cc[0x0]['Id']),GetTaskOutboxCount(_0x91b0a5[_0x4a270e(0x147)],_0x3fa4cc[0x0]['Id'])):AddUserInCounterList(_0x91b0a5[_0x4a270e(0x14f)]['ID'],_0x4a270e(0xba),_0x91b0a5[_0x4a270e(0x147)],_0x4a270e(0x136));});}),alert(_0x1a6fd2(0x70)),waitingDialog['hide']();}function AddUserInCounterList(_0x57cece,_0x2d2ddd,_0x388d44,_0x34664a){var _0x403c34=_0x1671fa;Metadata={'__metadata':{'type':_0x403c34(0x146)},'Title':_0x2d2ddd,'UserIdId':_0x57cece},AddedItemId=AddToSPList('EmployeeTaskCounter',Metadata),GetTaskInboxCount(_0x388d44,AddedItemId),GetTaskOutboxCount(_0x388d44,AddedItemId),_0x34664a=='Employee'&&GetApprovalInboxCount(_0x388d44,AddedItemId);}function GetTaskInboxCount(_0x3c54ee,_0x597b2a){var _0x47a6fd=_0x1671fa;restQuery=_0x47a6fd(0x13a)+_0x3c54ee+_0x47a6fd(0x15c)+_0x3c54ee+_0x47a6fd(0x8c);var _0x1f906b=_0x47a6fd(0x176)+restQuery;$[_0x47a6fd(0x84)](getItemsWithQueryItem(_0x47a6fd(0xd0),_0x1f906b))[_0x47a6fd(0x10a)](function(_0x6d2d1b){var _0x1a5318=_0x47a6fd,_0x12d023='',_0x4d2116=0x0,_0x2e51a5=0x0,_0x2d5f59=new Date();_0x2d5f59=_0x2d5f59[_0x1a5318(0xb1)](0x0,0x0,0x0,0x0),_0x2d5f59=new Date(_0x2d5f59);for(var _0x540daf=0x0;_0x540daf<_0x6d2d1b[_0x1a5318(0x9a)];_0x540daf++){var _0x35e6b7=new Date(moment(_0x6d2d1b[_0x540daf][_0x1a5318(0xe6)][_0x1a5318(0xa7)]('T')[0x0])[_0x1a5318(0x175)](_0x1a5318(0x118)));_0x35e6b7['setDate'](_0x35e6b7['getDate']()),_0x35e6b7=new Date(_0x35e6b7),_0x35e6b7>=_0x2d5f59?_0x4d2116++:_0x2e51a5++;}UpdateTaskCounter(_0x597b2a,_0x4d2116,_0x2e51a5,_0x1a5318(0x11d));});}function GetTaskOutboxCount(_0xfd6c30,_0xde751e){var _0xdaf7c1=_0x1671fa;restQuery=_0xdaf7c1(0x79)+_0xfd6c30+_0xdaf7c1(0xaa)+_0xfd6c30+'\x27)\x20and\x20(CurrentPhase\x20eq\x20\x27Open\x27))';var _0x7493be=_0xdaf7c1(0x176)+restQuery;$[_0xdaf7c1(0x84)](getItemsWithQueryItem(_0xdaf7c1(0xd0),_0x7493be))['done'](function(_0x5c3d36){var _0x705917=_0xdaf7c1,_0x2ad9f0=0x0,_0x3f8b0f=0x0;for(var _0x1e96e3=0x0;_0x1e96e3<_0x5c3d36['length'];_0x1e96e3++){var _0x16212d=new Date(_0x5c3d36[_0x1e96e3][_0x705917(0xe6)]),_0x29b731=new Date();_0x29b731[_0x705917(0xb1)](0x0,0x0,0x0,0x0),_0x29b731>_0x16212d?_0x3f8b0f++:_0x2ad9f0++;}UpdateTaskCounter(_0xde751e,_0x2ad9f0,_0x3f8b0f,_0x705917(0xa3));});}function UpdateTaskCounter(_0x283349,_0x56e016,_0x443ad1,_0x379671){var _0x2fe024=_0x1671fa,_0x2c2c08=GetItemTypeForListName(_0x2fe024(0x125));_0x379671==_0x2fe024(0x11d)?Metadata={'__metadata':{'type':_0x2c2c08},'OpenTasksCount':parseInt(_0x56e016),'OverdueCount':parseInt(_0x443ad1)}:Metadata={'__metadata':{'type':_0x2c2c08},'OpenTasksCount_Out':parseInt(_0x56e016),'OverdueCount_Out':parseInt(_0x443ad1)};var _0x1b5369=$['Deferred']();return $[_0x2fe024(0xca)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x2fe024(0x121)+_0x283349+'\x27)','type':_0x2fe024(0x105),'async':![],'headers':{'accept':_0x2fe024(0x9c),'X-RequestDigest':$(_0x2fe024(0xef))[_0x2fe024(0xd7)](),'content-Type':'application/json;odata=verbose','X-Http-Method':_0x2fe024(0x15e),'If-Match':'*'},'data':JSON['stringify'](Metadata),'success':function(_0x2b587d){var _0xb99c10=_0x2fe024;_0x1b5369[_0xb99c10(0x15a)](_0x2b587d);},'eror':function(_0x5a5cfb){var _0xb0a7e7=_0x2fe024;_0x1b5369['reject'](error),console[_0xb0a7e7(0xe4)](_0xb0a7e7(0x168)+JSON[_0xb0a7e7(0x13b)](_0x5a5cfb));}}),_0x1b5369[_0x2fe024(0xdd)]();}function GetApprovalInboxCount(_0x449510,_0x31d7cc){var _0x1e8480=_0x1671fa,_0x4aa73b=0x0;restQuery=_0x1e8480(0x170)+_0x449510+_0x1e8480(0x82);var _0x5dd69b=_0x1e8480(0x167)+restQuery;$[_0x1e8480(0x84)](getItemsWithQueryItem('ApprovalTaskList',_0x5dd69b))[_0x1e8480(0x10a)](function(_0x3811f3){var _0x50315b=_0x1e8480;_0x4aa73b=_0x3811f3[_0x50315b(0x9a)],restQuery=_0x50315b(0x79)+_0x449510+'\x27)\x20and\x20(Status\x20eq\x20\x27Initiated\x27\x20or\x20Status\x20eq\x20\x27Forwarded\x27))';var _0x520c3d=_0x50315b(0x100)+restQuery;$[_0x50315b(0x84)](getItemsWithQueryItem('ApprovalTaskList',_0x520c3d))[_0x50315b(0x10a)](function(_0x476e4b){UpdateApprovalCounter(_0x31d7cc,_0x4aa73b,_0x476e4b['length']);});});}function UpdateApprovalCounter(_0x42cd72,_0x4b039e,_0x280556){var _0x1974df=_0x1671fa,_0x4355c1=GetItemTypeForListName(_0x1974df(0x125));Metadata={'__metadata':{'type':_0x4355c1},'ApprovalCount_IN':parseInt(_0x4b039e),'ApprovalCount_OUT':parseInt(_0x280556)};var _0x18b60e=$[_0x1974df(0x139)]();return $[_0x1974df(0xca)]({'url':_spPageContextInfo[_0x1974df(0xa2)]+_0x1974df(0x121)+_0x42cd72+'\x27)','type':_0x1974df(0x105),'async':![],'headers':{'accept':_0x1974df(0x9c),'X-RequestDigest':$(_0x1974df(0xef))[_0x1974df(0xd7)](),'content-Type':_0x1974df(0x9c),'X-Http-Method':_0x1974df(0x15e),'If-Match':'*'},'data':JSON[_0x1974df(0x13b)](Metadata),'success':function(_0x59b8cf){var _0x5d67b6=_0x1974df;_0x18b60e[_0x5d67b6(0x15a)](_0x59b8cf);},'eror':function(_0x304046){var _0x84a530=_0x1974df;_0x18b60e[_0x84a530(0xed)](error),console[_0x84a530(0xe4)]('An\x20error\x20occurred\x20while\x20deleting\x20task.\x20'+JSON[_0x84a530(0x13b)](_0x304046));}}),_0x18b60e[_0x1974df(0xdd)]();}function AddToSPList(_0x110e5e,_0x25ac8d){var _0x5dcd37=_0x1671fa,_0x5f43b1='';return $[_0x5dcd37(0xca)]({'url':_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/getbytitle(\x27'+_0x110e5e+_0x5dcd37(0xf3),'type':_0x5dcd37(0x105),'async':![],'headers':{'accept':_0x5dcd37(0x9c),'X-RequestDigest':$(_0x5dcd37(0xef))['val'](),'content-Type':'application/json;odata=verbose'},'data':JSON['stringify'](_0x25ac8d),'success':function(_0x3aecfd){_0x5f43b1=_0x3aecfd['d']['Id'];},'error':function(_0x556fdf){console['log'](JSON['stringify'](_0x556fdf));}}),_0x5f43b1;}function getItemsWithQueryItem(_0x4f29ee,_0x3fd6d9){var _0x59501e=_0x1671fa;return DeferredObj=$[_0x59501e(0x139)](),$[_0x59501e(0xca)]({'url':_spPageContextInfo[_0x59501e(0xa2)]+'/_api/web/lists/getbytitle(\x27'+_0x4f29ee+_0x59501e(0xd4)+_0x3fd6d9,'type':_0x59501e(0x8d),'async':![],'headers':{'ACCEPT':_0x59501e(0x9c),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x59501e(0xd7)]()},'success':function(_0x21a339){var _0x5b47ee=_0x59501e;DeferredObj[_0x5b47ee(0x15a)](_0x21a339['d']['results']);},'error':function(_0x2b180e){DeferredObj['reject'](_0x2b180e);}}),DeferredObj['promise']();};function ChangeCompanyId(){var _0x29a536=_0x1671fa;$['ajax']({'url':_spPageContextInfo[_0x29a536(0xa2)]+_0x29a536(0xb0),'method':_0x29a536(0x8d),'async':![],'headers':{'Accept':_0x29a536(0x9c)},'success':function(_0x42ad1e,_0x42ab88,_0x5d7db1){var _0x3ba4d2=_0x29a536,_0x37f326=_0x42ad1e['d'][_0x3ba4d2(0x129)];if(_0x37f326['length']>0x0)updateCompanyId(_0x37f326);else return alert(_0x3ba4d2(0x143)),![];},'error':function(_0x524d28,_0x2e2fc6,_0x4458ab){var _0x175ea3=_0x29a536;console[_0x175ea3(0xe4)](_0x524d28[_0x175ea3(0x90)]);}});}function updateCompanyId(_0x212595){var _0x2fa92c=_0x1671fa,_0x22941e=GetItemTypeForListName(_0x2fa92c(0x17c)),_0x2e3a94=[];_0x212595[_0x2fa92c(0xd3)](function(_0x4c87d4,_0x394817){var _0x44f478=_0x2fa92c;_0x2e3a94=[],_0x2e3a94[_0x44f478(0x11f)](_0x4c87d4['Company']['ID']),Metadata={'__metadata':{'type':_0x22941e},'CompanyIdId':{'results':_0x2e3a94}};var _0x595893=$[_0x44f478(0x139)]();return $[_0x44f478(0xca)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x44f478(0x80)+_0x4c87d4['Id']+')','type':_0x44f478(0x105),'async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x44f478(0xef))['val'](),'content-Type':'application/json;odata=verbose','X-Http-Method':_0x44f478(0x15e),'If-Match':'*'},'data':JSON[_0x44f478(0x13b)](Metadata),'success':function(_0x5cba5e){var _0x1afc02=_0x44f478;_0x595893[_0x1afc02(0x15a)](_0x5cba5e),_0x212595[_0x1afc02(0x9a)]==_0x394817+0x1&&alert('Successfully.');},'eror':function(_0x51dd1d){var _0xaad428=_0x44f478;_0x595893[_0xaad428(0xed)](error),console[_0xaad428(0xe4)](_0xaad428(0x92)+JSON[_0xaad428(0x13b)](_0x51dd1d));}}),_0x595893[_0x44f478(0xdd)]();});}function fileShareDocumentColumn(){var _0x33e3c2=_0x1671fa;$[_0x33e3c2(0xca)]({'url':_spPageContextInfo[_0x33e3c2(0xa2)]+'/_api/web/lists/getByTitle(\x27SharedDocument\x27)/items/?$top=5000&$filter=SiteURL\x20eq\x20null\x20and\x20DocumentID\x20ne\x20null&$select=*,SharedUsers/EMail&$expand=SharedUsers/EMail&$OrderBy=Modified\x20desc','method':_0x33e3c2(0x8d),'async':![],'headers':{'Accept':_0x33e3c2(0x9c)},'success':function(_0x4b18bc,_0xbea772,_0x1f52aa){var _0x16798b=_0x33e3c2,_0x3c497f=_0x4b18bc['d'][_0x16798b(0x129)];if(_0x3c497f[_0x16798b(0x9a)]>0x0)for(var _0x122fea=0x0;_0x122fea<_0x3c497f[_0x16798b(0x9a)];_0x122fea++){var _0x4481c0=_0x3c497f[_0x122fea][_0x16798b(0x17e)],_0x22489e=_0x3c497f[_0x122fea]['DocumentID'],_0x31596a='';_0x3c497f[_0x122fea][_0x16798b(0xa8)]!=null&&(_0x31596a=_0x3c497f[_0x122fea][_0x16798b(0xc9)][_0x16798b(0x129)][0x0][_0x16798b(0x155)]);var _0x350185=_0x3c497f[_0x122fea]['Id'],_0x172e99=_0x4481c0['split'](_0x16798b(0x8a)),_0x37d0bb=_0x16798b(0x14e),_0x47c304=_spPageContextInfo[_0x16798b(0xa2)],_0x100488=_spPageContextInfo[_0x16798b(0xa2)]+_0x16798b(0x8a);if(_0x172e99[_0x16798b(0x9a)]>0x1){}else{var _0x47d4b2=_0x4481c0[_0x16798b(0xa7)]('/DepartmentalDMS');_0x47d4b2=_0x47d4b2[0x0][_0x16798b(0xa7)](_0x16798b(0x128))[0x1][_0x16798b(0xa7)]('/'),_0x37d0bb='DepartmentalDMS',_0x47d4b2[_0x16798b(0x9a)]>0x2?(_0x47c304=_spPageContextInfo[_0x16798b(0xa2)]+'/'+_0x47d4b2[0x1]+'/'+_0x47d4b2[0x2],_0x100488=_spPageContextInfo[_0x16798b(0xa2)]+'/'+_0x47d4b2[0x1]+'/'+_0x47d4b2[0x2]+_0x16798b(0xf7)):(_0x47c304=_spPageContextInfo[_0x16798b(0xa2)]+'/'+_0x47d4b2[0x1],_0x100488=_spPageContextInfo[_0x16798b(0xa2)]+'/'+_0x47d4b2[0x1]+'/'+'/DepartmentalDMS');}var _0x5a2a98=_0x4481c0['split'](_0x16798b(0x128));_0x5a2a98=_0x16798b(0x128)+_0x5a2a98[0x1];var _0x18617e=_0x5a2a98[_0x16798b(0xa7)]('/'),_0x297e9b=_0x18617e[_0x18617e[_0x16798b(0x9a)]-0x1][_0x16798b(0xa7)]('.');_0x297e9b['length']>0x1?(_0x4481c0=_0x5a2a98['split']('/'+_0x18617e[_0x18617e[_0x16798b(0x9a)]-0x1]),_0x4481c0=_0x5a2a98):_0x4481c0=_0x5a2a98,_0x37d0bb=='DepartmentalDMS'?GetFolderDetails(_0x4481c0,_0x22489e,_0x350185,_0x37d0bb,_0x47c304,_0x100488,_0x31596a):GetDocumentsFiles(_0x4481c0,_0x22489e,_0x350185,_0x37d0bb,_0x47c304,_0x100488,_0x31596a);}else return alert(_0x16798b(0x143)),![];waitingDialog[_0x16798b(0xec)]();},'error':function(_0x241aee,_0x4216c3,_0x298f7f){console['log'](_0x241aee['responseText']);}});}function updateShareDocument(_0x2462e4,_0xfbf100,_0x2e5a60,_0x2a8ce7,_0x124dca,_0x1077c6){var _0x351e25=_0x1671fa,_0x49b8ec=GetItemTypeForListName(_0x351e25(0xea)),_0x2e17c1='',_0x104591='';_0x2e5a60=='DepartmentalDMS'?(_0x2e17c1=_0x2462e4[0x0][_0x351e25(0x13e)][_0x351e25(0x155)],_0x104591=_0x2462e4[0x0][_0x351e25(0x119)]):(_0x2e17c1=_0x2462e4[0x0][_0x351e25(0xa0)],_0x104591=_0x2462e4[0x0][_0x351e25(0x119)]);Metadata={'__metadata':{'type':_0x49b8ec},'LibraryURL':_0x124dca,'LibraryName':_0x2e5a60,'SiteURL':_0x2a8ce7,'DocType':_0x104591,'SharedFileTitle':_0x2462e4[0x0][_0x351e25(0x113)],'SharedUserEmail':_0x1077c6};var _0x27fba3=$[_0x351e25(0x139)]();return $[_0x351e25(0xca)]({'url':_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/getbytitle(\x27SharedDocument\x27)/GetItemById('+_0xfbf100+')','type':_0x351e25(0x105),'async':![],'headers':{'accept':_0x351e25(0x9c),'X-RequestDigest':$(_0x351e25(0xef))['val'](),'content-Type':_0x351e25(0x9c),'X-Http-Method':_0x351e25(0x15e),'If-Match':'*'},'data':JSON[_0x351e25(0x13b)](Metadata),'success':function(_0x40a4a5){var _0x40e681=_0x351e25;_0x27fba3[_0x40e681(0x15a)](_0x40a4a5);},'eror':function(_0x3f69ab){var _0x27573c=_0x351e25;_0x27fba3[_0x27573c(0xed)](error),console[_0x27573c(0xe4)](_0x27573c(0x92)+JSON[_0x27573c(0x13b)](_0x3f69ab));}}),_0x27fba3[_0x351e25(0xdd)]();}function GetFolderDetails(_0x2ae19d,_0x1688aa,_0x2f573c,_0x3a505c,_0x25b3f1,_0x205200,_0x3c86b8){var _0x4d45d9=_0x1671fa;debugger;var _0x1a9d5e=_0x2ae19d[_0x4d45d9(0xa7)](_0x4d45d9(0xf7));_0x1a9d5e=_0x1a9d5e[0x0][_0x4d45d9(0xa7)]('/sites/')[0x1][_0x4d45d9(0xa7)]('/');_0x1a9d5e[_0x4d45d9(0x9a)]>0x2?_0x1a9d5e=_0x1a9d5e[0x1]+'/'+_0x1a9d5e[0x2]:_0x1a9d5e=_0x1a9d5e[0x1];var _0x28b42a=_0x25b3f1,_0xbdd588=_0x205200,_0x49dd00=_spPageContextInfo[_0x4d45d9(0xa2)]+'/'+_0x1a9d5e+_0x4d45d9(0x169)+_0x3a505c+_0x4d45d9(0x11e)+_0x1688aa+'';$[_0x4d45d9(0xca)]({'url':_0x49dd00,'headers':{'Accept':_0x4d45d9(0x9c)},'async':![],'success':function(_0x1e9748){var _0x21c6bd=_0x4d45d9,_0x2ad50f=_0x1e9748['d'][_0x21c6bd(0x129)];_0x2ad50f[_0x21c6bd(0x9a)]>0x0&&updateShareDocument(_0x2ad50f,_0x2f573c,_0x3a505c,_0x28b42a,_0xbdd588,_0x3c86b8),console['log'](_0x2ad50f);},'eror':function(_0x507e26){console['log'](_0x507e26);}});}function GetDocumentsFiles(_0x56731e,_0x1a5db4,_0xaa8ce5,_0x5ac1cd,_0x145509,_0x22f029,_0x53ccb5){var _0x49360d=_0x1671fa,_0x5b1ba3=_0x56731e['split']('/');_0x5b1ba3=_0x5b1ba3[_0x5b1ba3[_0x49360d(0x9a)]-0x1],_0x56731e=_0x56731e['split']('/'+_0x5b1ba3);var _0x36e503=[],_0x1c6713=_spPageContextInfo[_0x49360d(0xa2)]+'/_api/Web/GetFolderByServerRelativeUrl(\x27'+_0x56731e[0x0]+_0x49360d(0x14c);$['ajax']({'url':_0x1c6713,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x3785ac){var _0x6be644=_0x49360d,_0x219daf=_0x3785ac['d'][_0x6be644(0xd8)][_0x6be644(0x129)],_0x59873a=_0x219daf[_0x6be644(0x173)](function(_0x28bd1f){var _0x5d684b=_0x6be644;return _0x28bd1f[_0x5d684b(0x12b)]['ID']==_0x1a5db4;});if(_0x59873a[_0x6be644(0x9a)]>0x0){var _0x13b427=_0x59873a[0x0][_0x6be644(0x12b)][_0x6be644(0xfc)];_0x13b427=_0x13b427[_0x6be644(0xa7)](_0x6be644(0x12c)),_0x36e503[_0x6be644(0x11f)]({'DocumentType':_0x59873a[0x0][_0x6be644(0x12b)][_0x6be644(0x119)],'FileLeafRef':_0x59873a[0x0][_0x6be644(0x107)],'AuthorEMail':_0x13b427[0x1]}),updateShareDocument(_0x36e503,_0xaa8ce5,_0x5ac1cd,_0x145509,_0x22f029,_0x53ccb5);}},'eror':function(_0x50a11c){var _0x1536a5=_0x49360d;console['log'](_0x1536a5(0x8b));}});}function getDepartmentalItems(){var _0x3ff8d1=_0x1671fa,_0x3cded5=$('#HistoryURL')[_0x3ff8d1(0xd7)]()[_0x3ff8d1(0x17b)]();_0x3cded5[_0x3ff8d1(0x9a)]<=0x0&&alert(_0x3ff8d1(0xa6));var _0x1fb2f1=_0x3cded5[_0x3ff8d1(0xa7)]('/');_0x1fb2f1=_0x1fb2f1[_0x1fb2f1[_0x3ff8d1(0x9a)]-0x1];var _0x2461e6=_0x3cded5[_0x3ff8d1(0xa7)](_0x1fb2f1),_0x4b4b98=_0x2461e6[0x0]+_0x3ff8d1(0xe8)+_0x1fb2f1+_0x3ff8d1(0x16f);$[_0x3ff8d1(0xca)]({'url':_0x4b4b98,'headers':{'Accept':_0x3ff8d1(0x9c)},'async':![],'success':function(_0x390aa9){var _0x47bd56=_0x3ff8d1,_0x4b5298=_0x390aa9['d'][_0x47bd56(0x129)];for(var _0x210019=0x0;_0x210019<_0x4b5298['length'];_0x210019++){getShareDocumentItemsById(_0x2461e6[0x0],_0x1fb2f1,_0x4b5298[_0x210019]['ID']),_0x4b5298['length']==_0x210019+0x1&&alert(_0x47bd56(0xd5));}},'error':function(_0x1c92c0){console['log'](_0x1c92c0);}});}function getShareDocumentItemsById(_0x1f40e4,_0x3ee0ee,_0x30c3f2){var _0x59719b=_0x1671fa,_0x299ac0=_0x1f40e4;$[_0x59719b(0xca)]({'url':_spPageContextInfo[_0x59719b(0xa2)]+_0x59719b(0x83)+_0x30c3f2+'\x27','method':_0x59719b(0x8d),'async':![],'headers':{'Accept':'application/json;odata=verbose'},'success':function(_0x415e8c,_0x43e562,_0x17d525){var _0x327415=_0x59719b,_0x2ab4ae=_0x415e8c['d'][_0x327415(0x129)];if(_0x2ab4ae[_0x327415(0x9a)]>0x0){}else updateDocumentPropertiesOnItemSharing(_0x299ac0,_0x3ee0ee,_0x30c3f2);},'error':function(_0x5ed886){console['log'](_0x5ed886);}});}function GetItemTypeForListNames(_0x1f11b4){var _0x510cee=_0x1671fa;return _0x510cee(0x16d)+_0x1f11b4['charAt'](0x0)['toUpperCase']()+_0x1f11b4[_0x510cee(0xa7)]('\x20')[_0x510cee(0x11a)]('')[_0x510cee(0x172)](0x1)+_0x510cee(0x135);}function updateDocumentPropertiesOnItemSharing(_0x14e02c,_0x4cc730,_0x2eada7){var _0x1459ae=_0x1671fa,_0x1717af,_0x12bdae='SP.Data.'+_0x4cc730+_0x1459ae(0x159),_0x1608fb=[];_0x1717af={'__metadata':{'type':_0x12bdae},'SharedId':{'results':_0x1608fb}},updateItemWithIDItemListDocuments(_0x14e02c,_0x4cc730,_0x1717af,_0x2eada7);}function updateItemWithIDItemListDocuments(_0xe6d7b5,_0x4a0957,_0x4032d1,_0x2da344){var _0x12fdf7=_0x1671fa,_0x2f99e3=_0xe6d7b5+_0x12fdf7(0x102)+_0x4a0957+_0x12fdf7(0x106)+_0x2da344+')';$[_0x12fdf7(0xca)]({'url':_0x2f99e3,'type':_0x12fdf7(0x105),'async':![],'headers':{'accept':_0x12fdf7(0x9c),'X-RequestDigest':$(_0x12fdf7(0xef))[_0x12fdf7(0xd7)](),'content-Type':_0x12fdf7(0x9c),'X-Http-Method':_0x12fdf7(0x15e),'If-Match':'*'},'data':JSON[_0x12fdf7(0x13b)](_0x4032d1),'success':function(_0x143566){var _0x5bfc77=_0x12fdf7;console[_0x5bfc77(0xe4)](_0x143566);},'error':function(_0x123b3f){var _0x2fd5ff=_0x12fdf7;alert(_0x123b3f[_0x2fd5ff(0xe3)][_0x2fd5ff(0x8b)][_0x2fd5ff(0x9b)]['value']);}});}function getDataFromShareDocument(){var _0x147a16=_0x1671fa,_0x59d4fd=URL;$['ajax']({'url':_spPageContextInfo[_0x147a16(0xa2)]+_0x147a16(0xc8),'method':_0x147a16(0x8d),'async':![],'headers':{'Accept':'application/json;odata=verbose'},'success':function(_0x126bd7,_0x290118,_0x3bd8ce){var _0x56ab68=_0x147a16,_0x5ec95c=_0x126bd7['d']['results'];if(_0x5ec95c[_0x56ab68(0x9a)]>0x0){for(let _0x829f4b=0x0;_0x829f4b<_0x5ec95c['length'];_0x829f4b++){FillCompanyCompanyAndDepartmentIdInShareDocument(_0x5ec95c[_0x829f4b]['ID'],_0x5ec95c[_0x829f4b][_0x56ab68(0x110)]);}alert(_0x56ab68(0xc1));}else alert(_0x56ab68(0x76));},'error':function(_0x1e2647){var _0x3a9c3c=_0x147a16;console[_0x3a9c3c(0xe4)](_0x1e2647);}});}function FillCompanyCompanyAndDepartmentIdInShareDocument(_0x225793,_0x53a0ec){var _0x16c298=_0x1671fa,_0x416bd7,_0x2be21f=_0x16c298(0xea);if(_0x53a0ec!=null)var _0x53a0ec=_0x53a0ec[_0x16c298(0xa7)]('/DepartmentalDMS')[0x0];var _0x299e22=departmentArr[_0x16c298(0x173)](function(_0x58327d){return _0x58327d['SiteURL']==_0x53a0ec;});if(_0x299e22[_0x16c298(0x9a)]>0x0){var _0x1147c6=_0x16c298(0xd2);_0x416bd7={'__metadata':{'type':_0x1147c6},'CompanyIDId':_0x299e22[0x0]['ComId'],'DepartmentIDId':_0x299e22[0x0][_0x16c298(0x98)]};var _0x1ca156=_spPageContextInfo[_0x16c298(0xa2)]+_0x16c298(0xac)+_0x225793+')';$['ajax']({'url':_0x1ca156,'type':'POST','async':![],'headers':{'accept':_0x16c298(0x9c),'X-RequestDigest':$(_0x16c298(0xef))['val'](),'content-Type':'application/json;odata=verbose','X-Http-Method':_0x16c298(0x15e),'If-Match':'*'},'data':JSON['stringify'](_0x416bd7),'success':function(_0x2f0c7f){var _0x457bad=_0x16c298;console[_0x457bad(0xe4)](_0x2f0c7f);},'error':function(_0x1a3eee){var _0x15f40e=_0x16c298;alert(_0x1a3eee[_0x15f40e(0xe3)]['message'][_0x15f40e(0x152)]);}});}}var departmentArr=[];function GetDepartmentUrl(){var _0x333023=_0x1671fa,_0x5ebf19=_spPageContextInfo[_0x333023(0xa2)]+_0x333023(0xdf);$[_0x333023(0xca)]({'url':_0x5ebf19,'headers':{'Accept':_0x333023(0x9c)},'async':![],'success':function(_0x3bbad8){var _0x5ca400=_0x333023,_0x3f6733=_0x3bbad8['d'][_0x5ca400(0x129)];if(_0x3f6733[_0x5ca400(0x9a)]>0x0)for(let _0x1007cf=0x0;_0x1007cf<_0x3f6733[_0x5ca400(0x9a)];_0x1007cf++){departmentArr[_0x5ca400(0x11f)]({'SiteURL':_0x3f6733[_0x1007cf]['SiteURL'],'DeptId':_0x3f6733[_0x1007cf]['ID'],'ComId':_0x3f6733[_0x1007cf][_0x5ca400(0x177)]});}console[_0x5ca400(0xe4)](departmentArr);},'eror':function(_0x4cac33){var _0x3b5080=_0x333023;console[_0x3b5080(0xe4)](_0x4cac33);}});}function GetDMSDocuments(){var _0x225590=_0x1671fa,_0x41942c=$(_0x225590(0xfb))['val']();if(_0x41942c=='')return alert(_0x225590(0x94)),![];var _0x4a6490=_0x41942c+_0x225590(0x182);$[_0x225590(0xca)]({'url':_0x4a6490,'headers':{'Accept':_0x225590(0x9c)},'async':![],'success':function(_0x2ea620){var _0x1072ec=_0x225590,_0x53b61c=_0x2ea620['d'][_0x1072ec(0x129)];arrMetadata=[];if(_0x53b61c[_0x1072ec(0x9a)]>0x0){arrMetadata=_0x53b61c,console[_0x1072ec(0xe4)](arrMetadata);for(var _0xc35309=0x0;_0xc35309<_0x53b61c['length'];_0xc35309++){getShareDocumentItemsByTitle(_0xc35309,_0x53b61c[_0xc35309]['ID'],_0x53b61c[_0xc35309][_0x1072ec(0xbb)][_0x1072ec(0x7b)]);}alert(_0x1072ec(0xb4));}else alert(_0x1072ec(0x76));},'error':function(_0x313552){var _0x17f949=_0x225590;alert(_0x17f949(0x7d));}});}var arrMetadata=[];function CopyDmsToSharedocumentItems(_0x4374c2){var _0x28f172=_0x1671fa,_0x43d73a,_0x2308d0='SharedDocument',_0x3ccc85=arrMetadata[_0x4374c2][_0x28f172(0xb5)];_0x3ccc85==_0x28f172(0x9e)?_0x3ccc85=!![]:_0x3ccc85=![];var _0x5e8d6d=String(arrMetadata[_0x4374c2]['Id']);if(arrMetadata[_0x28f172(0x9a)]>0x0){var _0x1b2280='SP.Data.SharedDocumentListItem';_0x43d73a={'__metadata':{'type':_0x1b2280},'CompanyIDId':CompanyID,'DepartmentIDId':$(_0x28f172(0xd9))[_0x28f172(0xd7)](),'DocumentID':_0x5e8d6d,'Title':arrMetadata[_0x4374c2][_0x28f172(0xbb)]['Name']?arrMetadata[_0x4374c2]['File']['Name']:'','DocumentNo':arrMetadata[_0x4374c2]['DocumentNo']?arrMetadata[_0x4374c2][_0x28f172(0x16a)]:'','DocType':arrMetadata[_0x4374c2][_0x28f172(0x119)]?arrMetadata[_0x4374c2]['DocumentType']:'','DocumentType':_0x28f172(0xbb),'NeedAcknowledgement':_0x3ccc85,'Department':$(_0x28f172(0xd9))[_0x28f172(0x104)](),'Details':arrMetadata[_0x4374c2]['Details']?arrMetadata[_0x4374c2]['Details']:'','SubCategory':arrMetadata[_0x4374c2][_0x28f172(0x12a)]?arrMetadata[_0x4374c2][_0x28f172(0x12a)]:'','SharedGroup':arrMetadata[_0x4374c2][_0x28f172(0xdc)]?arrMetadata[_0x4374c2][_0x28f172(0xdc)]:'','PermissionType':'Read','DocumentURL':arrMetadata[_0x4374c2][_0x28f172(0xbb)]['ServerRelativeUrl'],'LibraryName':'DepartmentalDMS','SiteURL':$(_0x28f172(0xfb))[_0x28f172(0xd7)](),'LibraryURL':$(_0x28f172(0xfb))[_0x28f172(0xd7)]()+'/DepartmentalDMS'};var _0x396128=_spPageContextInfo[_0x28f172(0xa2)]+_0x28f172(0x12f);$[_0x28f172(0xca)]({'url':_0x396128,'type':_0x28f172(0x105),'async':![],'headers':{'accept':_0x28f172(0x9c),'X-RequestDigest':$(_0x28f172(0xef))[_0x28f172(0xd7)](),'content-Type':_0x28f172(0x9c)},'data':JSON['stringify'](_0x43d73a),'success':function(_0x138263){var _0x28293a=_0x28f172;console[_0x28293a(0xe4)](_0x138263);},'error':function(_0x18f81c){var _0x201a95=_0x28f172;alert(_0x18f81c[_0x201a95(0x90)]);}});}}function getShareDocumentItemsByTitle(_0x35077f,_0x1965bb,_0x5f77de){var _0x5d8d1a=_0x1671fa,_0x321517=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/getByTitle(\x27SharedDocument\x27)/items/?$filter=SharedGroup\x20eq\x20\x27Everyone\x27\x20and\x20Title\x20eq\x20\x27'+_0x5f77de+'\x27\x20and\x20DocumentID\x20eq\x20'+_0x1965bb+_0x5d8d1a(0x7e);$[_0x5d8d1a(0xca)]({'url':_0x321517,'method':_0x5d8d1a(0x8d),'async':![],'headers':{'Accept':_0x5d8d1a(0x9c)},'success':function(_0x57d37f,_0x30b9e8,_0x14ba8c){var _0x4e87df=_0x5d8d1a,_0x706476=_0x57d37f['d'][_0x4e87df(0x129)];_0x706476[_0x4e87df(0x9a)]==0x0&&CopyDmsToSharedocumentItems(_0x35077f);},'error':function(_0xef80f3,_0x23a652,_0x4e4be8){var _0x326e17=_0x5d8d1a;console['log'](_0xef80f3[_0x326e17(0x90)]);}});}var departmentItemsArr=[],CompanyID='';function _0x5bec(_0x503cee,_0xedab1){var _0x500e3a=_0x500e();return _0x5bec=function(_0x5becca,_0xa84c64){_0x5becca=_0x5becca-0x6e;var _0x536ea7=_0x500e3a[_0x5becca];return _0x536ea7;},_0x5bec(_0x503cee,_0xedab1);}function LoadAllDepartment(){var _0x45e6f1=_0x1671fa;$(_0x45e6f1(0xd9))[_0x45e6f1(0xa4)]();var _0x1055a2=_spPageContextInfo['webAbsoluteUrl']+_0x45e6f1(0xf8);$[_0x45e6f1(0xca)]({'url':_0x1055a2,'headers':{'Accept':'application/json;odata=verbose'},'async':!![],'success':function(_0x505cb1){var _0x26d444=_0x45e6f1;for(var _0x5c6e6e=0x0;_0x5c6e6e<_0x505cb1['d'][_0x26d444(0x129)][_0x26d444(0x9a)];_0x5c6e6e++){departmentItemsArr[_0x26d444(0x11f)]({'SiteURL':_0x505cb1['d'][_0x26d444(0x129)][_0x5c6e6e]['SiteURL'],'ID':_0x505cb1['d'][_0x26d444(0x129)][_0x5c6e6e]['ID'],'CompanyID':_0x505cb1['d']['results'][_0x5c6e6e]['CompanyID']}),$(_0x26d444(0xd9))[_0x26d444(0x72)](_0x26d444(0xce)+_0x505cb1['d'][_0x26d444(0x129)][_0x5c6e6e]['ID']+'\x22>'+_0x505cb1['d'][_0x26d444(0x129)][_0x5c6e6e]['Title']+_0x26d444(0xeb)),$(_0x26d444(0xfb))[_0x26d444(0xd7)](_0x505cb1['d'][_0x26d444(0x129)][0x0][_0x26d444(0xdb)]);}console[_0x26d444(0xe4)](departmentItemsArr);},'myError':function(_0x3cb5fb){}});}function departmentOnChange(){var _0x49a8a4=_0x1671fa;$(_0x49a8a4(0xd9))[_0x49a8a4(0x12d)](function(){departmentItemsArr['filter'](function(_0x3f963a){var _0x4a1483=_0x5bec;_0x3f963a['ID']==$(_0x4a1483(0xd9))['val']()&&($(_0x4a1483(0xfb))['val'](_0x3f963a[_0x4a1483(0xdb)]),CompanyID=_0x3f963a[_0x4a1483(0xde)]);});});}