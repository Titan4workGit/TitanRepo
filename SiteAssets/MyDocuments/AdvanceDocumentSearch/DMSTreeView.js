var _0x43aca4=_0x3e39;(function(_0x16fa0d,_0x1dbba0){var _0x10e77c=_0x3e39,_0x3a942f=_0x16fa0d();while(!![]){try{var _0x4e6a12=parseInt(_0x10e77c(0xc7))/0x1+-parseInt(_0x10e77c(0x165))/0x2*(-parseInt(_0x10e77c(0x22c))/0x3)+parseInt(_0x10e77c(0x1bf))/0x4+parseInt(_0x10e77c(0x182))/0x5+parseInt(_0x10e77c(0x22d))/0x6+parseInt(_0x10e77c(0x168))/0x7+-parseInt(_0x10e77c(0x18d))/0x8;if(_0x4e6a12===_0x1dbba0)break;else _0x3a942f['push'](_0x3a942f['shift']());}catch(_0x2a4737){_0x3a942f['push'](_0x3a942f['shift']());}}}(_0x3192,0x6f269));var SharingUserEmail=[],SharingUserId=[],SharingUserName=[];$(document)[_0x43aca4(0xe9)](function(){var _0x2e15bf=_0x43aca4;InitializePeoplePicker(_0x2e15bf(0x234),!![]),onChangeSharing('SharingPplPicker_TopSpan',_0x2e15bf(0x234),_0x2e15bf(0x1ac)),$('#sharewith')['change'](function(){var _0x3b6f17=_0x2e15bf,_0x1ab0a7=this['value'];SharingUserEmail=[],SharingUserId=[],SharingUserName=[],$('.parentremove')['remove']();if(_0x1ab0a7=='My-Groups')$(_0x3b6f17(0x23d))[_0x3b6f17(0x1a9)](),$(_0x3b6f17(0x14a))[_0x3b6f17(0x125)](),$(_0x3b6f17(0x186))[_0x3b6f17(0x125)](),$(_0x3b6f17(0x1c9))[_0x3b6f17(0x125)](),$(_0x3b6f17(0x15d))[_0x3b6f17(0x1a9)](),$(_0x3b6f17(0x162))[_0x3b6f17(0x1a9)](),$(_0x3b6f17(0x15d))['show'](),$(_0x3b6f17(0x218))[_0x3b6f17(0x1a1)]()==''&&getMyGroups();else{if(_0x1ab0a7==_0x3b6f17(0xcc))$(_0x3b6f17(0x23d))[_0x3b6f17(0x125)](),$(_0x3b6f17(0x14a))[_0x3b6f17(0x1a9)](),$('.Project-Team')[_0x3b6f17(0x125)](),$(_0x3b6f17(0x1c9))[_0x3b6f17(0x125)](),$(_0x3b6f17(0x15d))[_0x3b6f17(0x1a9)](),$(_0x3b6f17(0x162))[_0x3b6f17(0x125)](),$(_0x3b6f17(0x15d))[_0x3b6f17(0x125)](),$(_0x3b6f17(0xf7))[_0x3b6f17(0x1a1)]()==''&&getGuestClientShare();else{if(_0x1ab0a7==_0x3b6f17(0x18e))$(_0x3b6f17(0x23d))[_0x3b6f17(0x125)](),$(_0x3b6f17(0x14a))[_0x3b6f17(0x125)](),$('.Project-Team')[_0x3b6f17(0x1a9)](),$('.Selective')[_0x3b6f17(0x125)](),$(_0x3b6f17(0x15d))[_0x3b6f17(0x1a9)](),$('#AddUserPplPicker')['show'](),$(_0x3b6f17(0x15d))['show'](),$('#projectList')['html']()==''&&loadProjects();else _0x1ab0a7==_0x3b6f17(0x213)?($('.My-Groups')[_0x3b6f17(0x125)](),$(_0x3b6f17(0x14a))['hide'](),$('.Project-Team')[_0x3b6f17(0x125)](),$(_0x3b6f17(0x1c9))[_0x3b6f17(0x1a9)](),$('#AddUserPplPicker')[_0x3b6f17(0x1a9)](),$(_0x3b6f17(0x15d))['show'](),$(_0x3b6f17(0x15d))[_0x3b6f17(0x1a9)]()):($('.My-Groups')[_0x3b6f17(0x125)](),$('.Organization')[_0x3b6f17(0x125)](),$('.Project-Team')[_0x3b6f17(0x125)](),$(_0x3b6f17(0x1c9))[_0x3b6f17(0x125)](),$('#AddUserPplPicker')[_0x3b6f17(0x1a9)](),$(_0x3b6f17(0x15d))[_0x3b6f17(0x125)]());}}}),$(_0x2e15bf(0x1e5))[_0x2e15bf(0x180)](function(){ShareFileValidation()==!![]&&shareFile();}),$('#txtSharingHistoy')[_0x2e15bf(0x180)](function(){var _0x287937=_0x2e15bf;GetSharedHistory(DocumentId,$(_0x287937(0x1e2))[_0x287937(0x1c1)](),$(_0x287937(0x21c))['text'](),$(_0x287937(0x14b))[_0x287937(0x1c1)](),$(_0x287937(0x1b0))[_0x287937(0x1c1)](),_0x287937(0x152));}),$(_0x2e15bf(0x120))['click'](function(){var _0x39572a=_0x2e15bf;$(_0x39572a(0x1fb))[_0x39572a(0xd7)](_0x39572a(0x19a),$(this)[_0x39572a(0xd7)]('checked')),selectedHistoryDoc=[],selectedHistoryDocrelativeurl=[],$(_0x39572a(0x1fb))['each'](function(){var _0x501e80=_0x39572a;$(this)['prop']('checked')==!![]?(selectedHistoryDoc[_0x501e80(0x1eb)]($(this)[_0x501e80(0xf9)]()),$(_0x501e80(0xfb))[_0x501e80(0x1a9)]()):$('#revokebtn')['hide']();});}),$(_0x2e15bf(0x16e))[_0x2e15bf(0x135)](function(){var _0x3e2e7d=_0x2e15bf;if(new Date()>new Date($(_0x3e2e7d(0x16e))['val']()))return alert(_0x3e2e7d(0xdf)),![];}),$(_0x2e15bf(0x161))['click'](function(){var _0x219229=_0x2e15bf;$('#txtShareMessage')[_0x219229(0xf9)](''),$(_0x219229(0x248))['val'](_0x219229(0xef)),$(_0x219229(0x248))[_0x219229(0x1c5)]('change'),$(_0x219229(0x18a))['prop']('checked',_0x219229(0x19a)),$(_0x219229(0x1b9))[_0x219229(0xd7)](_0x219229(0x19a),''),$(_0x219229(0x16e))['removeClass'](_0x219229(0x21f)),$(_0x219229(0x1f0))[_0x219229(0xd7)]('checked',''),$(_0x219229(0x15a))['prop'](_0x219229(0x19a),''),$('.chkClientName')['prop'](_0x219229(0x19a),''),$(_0x219229(0x195))['prop']('checked',''),$('#Acknowledgment')[_0x219229(0xd7)](_0x219229(0x19a),''),$(_0x219229(0x1a7))[_0x219229(0x1c1)]('Select'),$(_0x219229(0x1e9))['val'](_0x219229(0x239)),$(_0x219229(0x1e9))[_0x219229(0x1c5)]('change');});});function shareFile(){var _0x2870ec=_0x43aca4,_0x5f412d=[],_0x425137=[],_0x365e85=!![];sharedUsersIdArrayListItemCollection=[],sharedUsersIdArrayListItemCollection=SharingUserId[_0x2870ec(0x208)](function(_0x277462){return _0x277462;});var _0x94827c=$('#sharewith')[_0x2870ec(0xf9)](),_0x2d484e=$(_0x2870ec(0x248))['val'](),_0x388402=DocumentId[_0x2870ec(0x140)](),_0x3fe883=$(_0x2870ec(0x1e2))[_0x2870ec(0x1c1)]();_0x5f412d=getSharedUsersId(_0x388402);if(sharedUsersIdArrayListItemCollection['length']==0x0){for(var _0x295463=0x0;_0x295463<SharingUserEmail[_0x2870ec(0x10e)];_0x295463++){SharingUserId[_0x2870ec(0x1eb)](parseInt(SharingUserEmail[_0x295463][_0x2870ec(0x223)]));}sharedUsersIdArrayListItemCollection=SharingUserId['filter'](function(_0x20cb67){return _0x20cb67;});}_0x425137=$['grep'](_0x5f412d,function(_0x3a2eb6){var _0x293236=_0x2870ec;return $[_0x293236(0x196)](_0x3a2eb6,sharedUsersIdArrayListItemCollection)!==-0x1;}),sharedUsersIdArrayListItemCollection=sharedUsersIdArrayListItemCollection[_0x2870ec(0x1c8)](_0x5f412d);_0x94827c==_0x2870ec(0xcc)?_0x365e85=getTargetRoleDefinitionId():_0x365e85=ShareFilesFolder(_0x3fe883,'File','',_0x94827c);_0x365e85!=![]&&(_0x365e85=!![]);if(sharedUsersIdArrayListItemCollection['length']>0x0&&_0x365e85==!![]){var _0x57f77f=$(_0x2870ec(0x1e9))[_0x2870ec(0xf9)]();updateDocumentPropertiesOnItemSharing(_0x388402,_0x3fe883,_0x94827c,sharedUsersIdArrayListItemCollection,CopySourceURL,![]),GetDocumentsRevoke(_0x425137,_0x388402);var _0x531814=[];_0x531814=getSharedType();_0x94827c==_0x2870ec(0xcc)?AddSharedLinkToListOrg(_0x3fe883,_0x388402,'File',$('#sharewith')[_0x2870ec(0xf9)](),$('#sharedWithPermission')['val'](),_0x531814[0x0],$(_0x2870ec(0x14b))[_0x2870ec(0x1c1)](),_0x531814[0x1]):AddSharedLinkToList(_0x3fe883,SharingUserId,_0x388402,_0x2870ec(0x152),$(_0x2870ec(0x1e9))['val'](),$(_0x2870ec(0x248))[_0x2870ec(0xf9)](),_0x531814[0x0],$(_0x2870ec(0x14b))[_0x2870ec(0x1c1)](),_0x531814[0x1]);if($(_0x2870ec(0x1f0))[_0x2870ec(0xd7)](_0x2870ec(0x19a))==!![]){var _0x38d97e=[],_0x142c43=$('#sharedWithPermission\x20:selected')[_0x2870ec(0x1c1)]();if(SharingUserEmail[_0x2870ec(0x10e)]>0x0){var _0x435a44='';_0x435a44=_0x2870ec(0x15e)+_spPageContextInfo[_0x2870ec(0x1f6)]+_0x2870ec(0x225),_0x435a44=_0x435a44+_0x2870ec(0x221)+$(_0x2870ec(0x1b0))[_0x2870ec(0x1c1)]()+_0x2870ec(0x1c0)+_0x2870ec(0x1f9)+$(_0x2870ec(0x155))[_0x2870ec(0x1c1)]()+_0x2870ec(0x1c0)+_0x2870ec(0x19d)+$(_0x2870ec(0x21c))[_0x2870ec(0x1c1)]()+_0x2870ec(0x1c0)+'<div><strong>Type:</strong>\x20'+$('#FileDocType')['text']()+'</div>'+_0x2870ec(0x113)+_0x142c43+_0x2870ec(0x1c0)+'<div><strong>Message:</strong>\x20'+$(_0x2870ec(0x163))[_0x2870ec(0xf9)]()+_0x2870ec(0x1c0)+_0x2870ec(0x100)+$('.txtCopyLink')[_0x2870ec(0xf9)]()+_0x2870ec(0x126)+_0x2870ec(0x1de),_0x435a44+=_0x2870ec(0x19b);}var _0xc14ec1=$(_0x2870ec(0x1ca))[_0x2870ec(0x1c1)](),_0x1ad019;$('#sharewith')[_0x2870ec(0xf9)]()==_0x2870ec(0xcc)?SharingUserEmail[_0x2870ec(0x14f)](function(_0x44ea86,_0x5b07a6){var _0x1b012c=_0x2870ec;_0x38d97e[_0x1b012c(0x1eb)](_0x44ea86[_0x1b012c(0xdb)]);}):_0x38d97e=SharingUserEmail[_0x2870ec(0x208)](function(_0x58e87f){return _0x58e87f;}),_0x1ad019={'properties':{'__metadata':{'type':_0x2870ec(0xdd)},'From':_spPageContextInfo[_0x2870ec(0x1d7)],'To':{'results':_0x38d97e},'Body':_0x435a44,'Subject':'Shared\x20Documents'}},SendEmailSharedNotification(_0x1ad019);}else alert(_0x2870ec(0x1cd)),$(_0x2870ec(0x15f))[_0x2870ec(0x1c1)]('Shared\x20with\x20'+$(_0x2870ec(0x1e9))[_0x2870ec(0xf9)]()),$('#txtSharingHistoy')[_0x2870ec(0x1a9)](),$(_0x2870ec(0x161))[_0x2870ec(0x1c5)]('click');}}function getSharedType(){var _0x8f5b94=_0x43aca4,_0x2abe3e=[];if($(_0x8f5b94(0x237))[_0x8f5b94(0x1c1)]()==_0x8f5b94(0x1da))_0x2abe3e[_0x8f5b94(0x1eb)](_0x8f5b94(0x138)),_0x2abe3e[_0x8f5b94(0x1eb)](_spPageContextInfo['userDisplayName']);else{if($(_0x8f5b94(0x237))[_0x8f5b94(0x1c1)]()[_0x8f5b94(0x17c)](_0x8f5b94(0x127))!=-0x1)_0x2abe3e['push'](_0x8f5b94(0x127)),_0x2abe3e[_0x8f5b94(0x1eb)]($(_0x8f5b94(0x237))[_0x8f5b94(0x1c1)]()[_0x8f5b94(0x1e1)](':\x20')[0x1]);else{if($('#LibProject')[_0x8f5b94(0x1c1)]()['indexOf'](_0x8f5b94(0x1c7))!=-0x1)_0x2abe3e[_0x8f5b94(0x1eb)]('Group'),_0x2abe3e['push']($(_0x8f5b94(0x237))[_0x8f5b94(0x1c1)]()[_0x8f5b94(0x1e1)](':\x20')[0x1]);else{if($(_0x8f5b94(0x237))[_0x8f5b94(0x1c1)]()[_0x8f5b94(0x17c)]('Project')!=-0x1)_0x2abe3e['push'](_0x8f5b94(0x1cb)),_0x2abe3e[_0x8f5b94(0x1eb)]($('#LibProject')[_0x8f5b94(0x1c1)]()['split'](':\x20')[0x1]);else $(_0x8f5b94(0x237))[_0x8f5b94(0x1c1)]()[_0x8f5b94(0x17c)](_0x8f5b94(0x151))!=-0x1&&(_0x2abe3e['push'](_0x8f5b94(0xd4)),_0x2abe3e[_0x8f5b94(0x1eb)]($('#LibProject')['text']()['split'](':\x20')[0x1]));}}}return _0x2abe3e;}function _0x3e39(_0xd03ae7,_0x3f8391){var _0x319299=_0x3192();return _0x3e39=function(_0x3e3962,_0xfe704b){_0x3e3962=_0x3e3962-0xc4;var _0x54acbc=_0x319299[_0x3e3962];return _0x54acbc;},_0x3e39(_0xd03ae7,_0x3f8391);}function SendEmailSharedNotification(_0x4ba1b7){var _0x1e3390=_0x43aca4,_0x577283=_spPageContextInfo['webServerRelativeUrl']+_0x1e3390(0xfa);$['ajax']({'contentType':'application/json','url':_0x577283,'type':_0x1e3390(0x212),'data':JSON[_0x1e3390(0x141)](_0x4ba1b7),'headers':{'Accept':_0x1e3390(0x10a),'content-type':_0x1e3390(0x10a),'X-RequestDigest':$(_0x1e3390(0x210))[_0x1e3390(0xf9)]()},'success':function(_0x4c0361){var _0x2486ea=_0x1e3390;alert(_0x2486ea(0x1cd)),$('#FileSharing')[_0x2486ea(0x1c1)](_0x2486ea(0x192)+$(_0x2486ea(0x1e9))[_0x2486ea(0xf9)]()),$(_0x2486ea(0x1e8))[_0x2486ea(0x1a9)](),$(_0x2486ea(0x161))['trigger'](_0x2486ea(0x180));},'error':function(_0x1c7037){var _0x1c13c8=_0x1e3390;waitingDialog[_0x1c13c8(0x125)](),alert('SendEmailSharedNotification\x20\x20'+JSON[_0x1c13c8(0x141)](_0x1c7037));}});}function AddSharedLinkToListOrg(_0x4fde64,_0x572ef8,_0x27350e,_0x30f9fc,_0x4a7cd7,_0xb335bc,_0x55ae31,_0x3d0dd1){var _0x1b3f2d=_0x43aca4;IsBlock='No';var _0xa84008='SharedDocument',_0x5e24af=GetItemTypeForListName(_0xa84008);for(k=0x0;k<SharingUserEmail[_0x1b3f2d(0x10e)];k++){if(SharingUserEmail[k][_0x1b3f2d(0x223)]!=null&&SharingUserEmail[k]['GroupId']!=''&&SharingUserEmail[k][_0x1b3f2d(0x223)]!=_0x1b3f2d(0x231)&&SharingUserEmail[k][_0x1b3f2d(0x223)]!=_0x1b3f2d(0x1ef)){var _0x266123=[];_0x266123['push'](SharingUserEmail[k][_0x1b3f2d(0x223)]);var _0x2bb0f7;_0x4a7cd7=='Restricted\x20View'&&(IsBlock=_0x1b3f2d(0x21b));var _0x2ea8cf=null;$('#expiredats')[_0x1b3f2d(0xf9)]()!=''&&(_0x2ea8cf=GetDateStandardFormat(moment($(_0x1b3f2d(0x16e))['val']())['format'](_0x1b3f2d(0x143)))),_0x2bb0f7={'__metadata':{'type':_0x5e24af},'Title':$(_0x1b3f2d(0x1b0))['text'](),'DocumentURL':_0x4fde64,'SharedUsersId':{'results':_0x266123},'DocumentID':_0x572ef8,'DOC_IDId':_0x572ef8,'SharedClientId':parseInt(SharingUserEmail[k]['ClientId']),'DocumentType':_0x27350e,'SharedGroup':_0x30f9fc,'PermissionType':_0x4a7cd7,'ServerRedirectedEmbedURL':'','IsBlock':IsBlock,'SharedType':_0xb335bc,'SharedFrom':_0x3d0dd1,'SharedMessage':$('#txtShareMessage')[_0x1b3f2d(0xf9)](),'SharingValidity':_0x2ea8cf,'NeedAcknowledgement':$('#Acknowledgment')[_0x1b3f2d(0xd7)](_0x1b3f2d(0x19a)),'LibraryURL':'','LibraryName':CopyLibrary,'SiteURL':CopySourceURL,'DocType':_0x55ae31},$[_0x1b3f2d(0x1f8)](AddItemToListGroups(_0xa84008,_0x2bb0f7))['done'](function(_0x3d572d){});}}}function AddSharedLinkToList(_0x3133b7,_0x56411a,_0x303584,_0x15dabe,_0x438d75,_0x260494,_0x36a669,_0x343aae,_0x12f521){var _0x504165=_0x43aca4;IsBlock='No';var _0x45eb28=_0x504165(0x1f3),_0x122774=GetItemTypeForListName(_0x45eb28);for(k=0x0;k<_0x56411a[_0x504165(0x10e)];k++){var _0x12a5df=[];_0x12a5df[_0x504165(0x1eb)](_0x56411a[k]);var _0x9df11b;_0x260494=='Restricted\x20View'&&(IsBlock=_0x504165(0x21b));var _0x54a56f=null;$(_0x504165(0x16e))[_0x504165(0xf9)]()!=''&&(_0x54a56f=GetDateStandardFormat(moment($('#expiredats')[_0x504165(0xf9)]())[_0x504165(0x187)](_0x504165(0x143)))),_0x9df11b={'__metadata':{'type':_0x122774},'Title':$(_0x504165(0x1b0))[_0x504165(0x1c1)](),'DocumentURL':_0x3133b7,'SharedUsersId':{'results':_0x12a5df},'SharedUserEmail':SharingUserEmail[k],'DocumentID':_0x303584,'DOC_IDId':_0x303584,'DocumentType':_0x15dabe,'SharedGroup':_0x438d75,'PermissionType':_0x260494,'ServerRedirectedEmbedURL':'','IsBlock':IsBlock,'SharedType':_0x36a669,'SharedFrom':_0x12f521,'SharedMessage':$(_0x504165(0x163))[_0x504165(0xf9)](),'SharingValidity':_0x54a56f,'NeedAcknowledgement':$(_0x504165(0x1ee))[_0x504165(0xd7)]('checked'),'LibraryURL':'','LibraryName':CopyLibrary,'SiteURL':CopySourceURL,'DocType':_0x343aae},$['when'](AddItemToListGroups(_0x45eb28,_0x9df11b))[_0x504165(0x215)](function(_0x22c1e0){});}}function AddItemToListGroups(_0x1eb41e,_0x190cc5){var _0x3b197d=_0x43aca4,_0x456f59=$[_0x3b197d(0x18b)]();return $[_0x3b197d(0xf2)]({'url':_spPageContextInfo[_0x3b197d(0x179)]+_0x3b197d(0x178)+_0x1eb41e+_0x3b197d(0x12f),'type':'POST','async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x3b197d(0x210))[_0x3b197d(0xf9)](),'content-Type':_0x3b197d(0x10a)},'data':JSON['stringify'](_0x190cc5),'success':function(_0x22bda3){var _0xc7b59c=_0x3b197d;_0x456f59[_0xc7b59c(0x130)](_0x22bda3);},'error':function(_0x38a651){var _0x265245=_0x3b197d;alert(JSON[_0x265245(0x141)](_0x38a651)),_0x456f59[_0x265245(0xc8)](_0x38a651);}}),_0x456f59[_0x3b197d(0x1ed)]();}function updateItemWithIDItemListDocuments(_0x5059c9,_0x3a7ef6,_0x3ba10a,_0x5ebdda,_0x4a47e2){var _0x26990b=_0x43aca4,_0x244d56=$['Deferred']();_0x5059c9==_0x26990b(0xfe)&&(_0x5059c9=_0x26990b(0x20f));_0x5ebdda!=_spPageContextInfo[_0x26990b(0x179)]&&$['when'](GetFormDigestValue(_0x5ebdda))[_0x26990b(0x215)](function(_0x5ec13a){RequestDigest=_0x5ec13a;});var _0x5258eb=_0x5ebdda+_0x26990b(0x102)+_0x5059c9+'\x27)/Items('+_0x3ba10a+')';return $['ajax']({'url':_0x5258eb,'type':_0x26990b(0x212),'async':_0x4a47e2,'headers':{'accept':_0x26990b(0x10a),'X-RequestDigest':RequestDigest,'content-Type':_0x26990b(0x10a),'X-Http-Method':'PATCH','If-Match':'*'},'data':JSON[_0x26990b(0x141)](_0x3a7ef6),'success':function(_0x202377){var _0x333ae1=_0x26990b;RequestDigest=$('#__REQUESTDIGEST')['val'](),console[_0x333ae1(0x19c)](_0x3ba10a+_0x333ae1(0x106)),_0x244d56[_0x333ae1(0x130)](!![]);},'error':function(_0x5f340e){var _0x524744=_0x26990b;RequestDigest=$(_0x524744(0x210))[_0x524744(0xf9)](),_0x5f340e[_0x524744(0x219)]['indexOf']('does\x20not\x20exist\x20on\x20type')!=-0x1&&alert(_0x524744(0xd3)),_0x244d56[_0x524744(0xc8)](_0x5f340e),waitingDialog[_0x524744(0x125)]();}}),_0x244d56[_0x26990b(0x1ed)]();}function GetDocumentsRevoke(_0xbbf654,_0x3e745a){var _0x2a9165=_0x43aca4;arrSharedUser=[];$(_0x2a9165(0x1e9))[_0x2a9165(0xf9)]()==_0x2a9165(0xcc)?SharingUserEmail[_0x2a9165(0x14f)](function(_0x227a05,_0x3e4a32){var _0x2ff14b=_0x2a9165;arrSharedUser[_0x2ff14b(0x1eb)](_0x227a05['GroupId']);}):arrSharedUser=_0xbbf654[_0x2a9165(0x208)](function(_0x45ad6a){return _0x45ad6a;});for(k=0x0;k<arrSharedUser[_0x2a9165(0x10e)];k++){var _0x25fad1=_0x2a9165(0x197)+arrSharedUser[k]+'\x27\x20and\x20DocumentID\x20eq\x20\x27'+_0x3e745a+_0x2a9165(0xcd),_0x350b43='?$select=ID,DocumentNo,Details,ServerRedirectedEmbedURL,Title,DocumentURL,DocumentID,DocumentType,SharedGroup,PermissionStatus,PermissionType,SharedUsers/Title,SharedUsers/ID,Author/Title,Author/ID&$expand=SharedUsers,Author'+_0x25fad1;$[_0x2a9165(0x1f8)](getItemsWithQuery('SharedDocument',_0x350b43))[_0x2a9165(0x215)](function(_0x4a5c56){var _0x1dc0d9=_0x2a9165;for(var _0x35d5fb=0x0;_0x35d5fb<_0x4a5c56[_0x1dc0d9(0x10e)];_0x35d5fb++){currentItemId=_0x4a5c56[_0x35d5fb]['ID'];var _0xbb3bbc=_0x1dc0d9(0x1f3),_0xf30309,_0x5338b0=GetItemTypeForListName(_0xbb3bbc);_0xf30309={'__metadata':{'type':_0x5338b0},'PermissionStatus':_0x1dc0d9(0x17d),'share_remarks':_0x1dc0d9(0xe4),'SharedEnd':new Date()[_0x1dc0d9(0x244)]()},$[_0x1dc0d9(0x1f8)](updateItemWithIDItemListDocuments(_0xbb3bbc,_0xf30309,currentItemId,_spPageContextInfo[_0x1dc0d9(0x179)]))[_0x1dc0d9(0x215)](function(_0x31a211){var _0x1febcb=_0x1dc0d9;console[_0x1febcb(0x19c)](_0x1febcb(0xf4));});}});}}function updateDocumentPropertiesOnItemSharing(_0x1a139f,_0xe34ea2,_0x2b06b8,_0xb7a12b,_0x33a4c7,_0xf7b96e){var _0x1a69b7=_0x43aca4,_0x592da2=$(_0x1a69b7(0x248))['val'](),_0x1fd2f2='';if($(_0x1a69b7(0x248))[_0x1a69b7(0xf9)]()==_0x1a69b7(0xef))_0x1fd2f2=_0x1a69b7(0x101);else $('#sharedWithPermission')[_0x1a69b7(0xf9)]()=='Read'?_0x1fd2f2=_0x1a69b7(0x1ab):_0x1fd2f2=_0x1a69b7(0x1d2);var _0x185eae=CopyLibrary,_0x10cf43;if(_0x185eae[_0x1a69b7(0x24d)]('Documents')==!![])var _0x23585d=GetItemTypeForLibraryName('Shared_x0020_Documents');else var _0x23585d=GetItemTypeForLibraryName(_0x185eae);_0x10cf43={'__metadata':{'type':_0x23585d},'SecurityLevel':_0x2b06b8,'PermissionLevel':_0x592da2,'PermissionLevelId':_0x1fd2f2,'SharedId':{'results':_0xb7a12b}},updateItemWithIDItemListDocuments(_0x185eae,_0x10cf43,_0x1a139f,_0x33a4c7,_0xf7b96e)[_0x1a69b7(0x215)](function(){})['fail'](function(_0x17be9e){var _0x3f8d89=_0x1a69b7;console[_0x3f8d89(0x19c)](_0x17be9e);});}function ShareFilesFolder(_0x2eefcb,_0x18842e,_0x495068){var _0x404863=_0x43aca4,_0x124661=[],_0x2675c1=0x2;if($('#sharedWithPermission')[_0x404863(0xf9)]()=='Read')_0x2675c1=0x1;else $(_0x404863(0x248))['val']()==_0x404863(0x1e6)&&(_0x2675c1=0x4);_0x2eefcb[_0x404863(0x24d)](_0x404863(0x20f))==!![]&&_0x2eefcb[_0x404863(0x24d)]('Shared%20Documents')==![]&&(_0x2eefcb=_0x2eefcb['replace'](_0x404863(0x20f),_0x404863(0xfe)));var _0x4e01dc=createJSONMetadata(SharingUserEmail,_0x2675c1),_0x1e0648=_spPageContextInfo['webAbsoluteUrl']+_0x404863(0x23c);return $[_0x404863(0xf2)]({'url':_0x1e0648,'method':'POST','async':![],'data':JSON['stringify']({'resourceAddress':document[_0x404863(0x23b)][_0x404863(0x189)]+_0x2eefcb,'userRoleAssignments':_0x4e01dc,'validateExistingPermissions':![],'additiveMode':![],'sendServerManagedNotification':![],'customMessage':_0x404863(0x1bd),'includeAnonymousLinksInNotification':![]}),'headers':{'accept':_0x404863(0x10a),'content-type':_0x404863(0x10a),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x404863(0xf9)]()},'success':function(_0x764eea){var _0x4e5298=_0x404863;console['log'](_0x4e5298(0x13e)),SharingRespose=!![];},'error':function(_0x226eef){var _0x11ca52=_0x404863;return SharingRespose=![],_0x226eef[_0x11ca52(0x219)][_0x11ca52(0x24d)](_0x11ca52(0x16a))==!![]?(alert(_0x11ca52(0x137)+$(_0x11ca52(0x1b0))[_0x11ca52(0x1c1)]()+_0x11ca52(0x20a)),![]):(alert(_0x226eef[_0x11ca52(0x219)]),![]);}}),SharingRespose;}function _0x3192(){var _0x30e119=['<td><div\x20class=\x27flexingtwo\x27><div\x20class=\x27empoyeeimg\x20clientnameshow\x27><span\x20class=\x27clienttext\x27><div\x20id=\x27profileImage\x27>','remove','file-list','executeAsync','\x27)/items','resolve','folder-root\x20closed','\x20Successfully\x20removed\x20Permission\x20!','body','\x27\x20and\x20WebPartName\x20eq\x20\x27Documents\x27)\x20','change','toLowerCase','You\x20don\x27t\x20have\x20the\x20required\x20permission\x20on\x20','My-DMS','<option\x20value=\x22\x22>All</option>','/Forms','.DmsTree','Not\x20Required','</option>','Assigned','convertJSONDateAMPMWithDate','toString','stringify','\x22\x20alt=\x22\x22>','DD/MM/YYYY','<td\x20class=\x22text-left\x22>Guest\x20Client</td>','/_api/web/lists/GetByTitle(\x27','#projectList','text-shadow','Kindly\x20enter\x20expiry\x20date.','<td\x20class=\x22text-left\x22>My\x20Documents</td><td\x20class=\x22text-left\x22></td></tr>','.Organization','#FileDocType','TeamMember','SharingLevel','json','forEach','<td><div\x20class=\x27flexingtwo\x27><div\x20id=\x27profileImage\x27>','Guest\x20Client','File','DocumentManagementSystem','<li\x20class=\x22parent\x22><a\x20class=\x22DmsTree\x20RootFolder\x22\x20onclick=\x22ClickFolder(this,\x20\x27','#FileReference','\x22\x20title=\x22','</div><div\x20class=\x22employeeinfo\x22><h3>','<span>','<a\x20href=\x27javascript:void(0);\x27\x20class=\x27emailsec\x27\x20onclick=\x27OpenEmail(\x22','.chkGpName','</span>\x20|\x20<span>','\x22\x20value=\x22\x22></label></div></td>','#userDiv','Dear\x20User,<br/><br/>','#FileSharing','endrecord','.btnClosePopup','#AddUserPplPicker','#txtShareMessage','</div></div><td>','1759068RIgtNB','message','GET','4298812gPhGtz','#tbdyCopyFileLib','The\x20caller\x20has\x20no\x20permissions\x20to\x20grant\x20permission','<span\x20onclick=\x22removeShareUser(this,\x20\x27','\x22><div\x20class=\x22employeesection\x22>','Select','#expiredats','totalpages','</div></div></div>','\x27\x20and\x20Owner\x20eq\x20\x27','/_layouts/15/userphoto.aspx?accountname=','\x27)>Revoke</a></td>','</ul></li>','tablenav','/_api/contextinfo','GetContextWebInformation','/_api/web/lists/getbytitle(\x27','webAbsoluteUrl','\x27)?$select=ID,File_x0020_Type,FSObjType,FileLeafRef,EncodedAbsUrl,FileRef&$top=5000&$expand=Folders,Folders/ListItemAllFields,Files,Files/ListItemAllFields','<span\x20onclick=\x22RemoveGroup(\x27','indexOf','Revoked','<div\x20class=\x22col-sm-6\x20parentremove\x20User','disabled','click','\x27)/items(\x27','1077775sNgSxG','.select_all','\x27)\x22>','<li><input\x20type=\x22checkbox\x22\x20class=\x22chkClientName\x20chk','.Project-Team','format','.treesec','origin','#forever','Deferred','</span></td>','16030456wOcRmc','Project-Team','ListItemAllFields','SPClientPeoplePickerDict','Modified','Shared\x20with\x20','<td\x20class=\x22text-left\x22>Project</td>','#selectClientName','.chkProjectName','inArray','&$filter=SharedUsers/ID\x20eq\x20\x27','evenrow','?$top=5000&$select=*,Author/Id,CompanyID/Id&$expand=Author,CompanyID&$orderby=Title\x20asc&$filter=EmployeeName/Id\x20eq\x20\x27','checked','This\x20is\x20an\x20auto\x20generated\x20email.\x20Please\x20don\x27t\x20reply.','log','<div><strong>Title:</strong>\x20','Everyone','#myModalShareHistory','ClientMaster','html','<td\x20class=\x22text-left\x22>Department</td>','<tr><td><div\x20class=\x22checkbox\x20m-0\x22><label><input\x20class=\x22DocLib\x22\x20name=\x22Library\x22\x20type=\x22radio\x22\x20id=\x22chkDepartments\x22\x20value=\x22\x22></label></div></td>','substring','</a></td></tr>','<div\x20class=\x22empoyeeimg\x22><img\x20src=\x22','.txtselect','<li><input\x20type=\x22checkbox\x22\x20id=\x22ProjectId','show','?$select=*,Department/DepartmentName,Department/ID&$top=5000&$expand=Department&$filter=(CompanyId\x20eq\x20\x27','1073741826','AddUserPplPicker','SharingValidity','css','sorter','#FileName','#shreduser','</p>','</li>','lastIndexOf','User','Shared\x20Documents','Role','find','#expiredon','\x27,\x27','\x20does\x20not\x20exist\x20in\x20the\x20file\x20exploerer\x20plugin','\x27\x20data-themekey=\x27#\x27><div\x20class=\x27designationtype\x27>','Please\x20look\x20at\x20the\x20following\x20File/Folder.','\x27,overwrite=true)','459828dWxpsO','</div>','text','#sharedHistoryList','\x22><div\x20class=\x22insidemygroup\x22><h3>','RequestExecutor','trigger','Required','Custom','concat','.Selective','#lblSelectedCurrentEmail','Project','<tr><td></td>','File\x20has\x20been\x20shared.',');\x22\x20class=\x22crosebox\x22><i\x20class=\x22fa\x20fa-times\x22></i></span>','ProjectDetails',',roledefid=','\x27\x20and\x20ID\x20eq\x20\x27','1073741937','#filetitle','#Backbtn','init','append','userEmail','modal','\x22></li>','My\x20Documents','type','SharedClient','apply','<br/><br/>','#selectProjectNames','addClass','split','#FilePath','...','Name','#btnShare','Restricted\x20View','Documents/','#txtSharingHistoy','#sharewith','/_api/web/GetFileByServerRelativeUrl(\x27','push','</span></div></li>','promise','#Acknowledgment','null','#notifymail','table','<span\x20class=\x22employeeemail\x22\x20style=\x22cursor:pointer;color:blue\x22\x20onclick=\x22OpenEmail(\x27','SharedDocument','value','each','userDisplayName','.chk','when','<div><strong>Reference\x20No\x20:</strong>\x20','\x27)/getItemById(','.historydocid','EMail','innerHTML','PermissionType','<tr>','\x27)/ListItemAllFields/roleassignments/getbyprincipalid(','/_api/Web/GetFolderByServerRelativeUrl(\x27','replace','join','?$select=ID,SharedUsers/ID,SharedUsers/Title,SharedUsers/EMail,LogonUser/ID,LogonUser/EMail,LogonUser/Title,LogonUser/UserName,SharingLevel&$expand=SharedUsers,LogonUser&$orderby=ID\x20asc&$filter=LogonUser/EMail\x20eq\x20\x27','ProcessApprovers','fail','<div\x20class=\x22\x22>Document\x20library\x20cannot\x20be\x20found.</div>','filter','Title','\x20to\x20perform\x20this\x20operation.','<tr><td><div\x20class=\x22checkbox\x20m-0\x22><label><input\x20class=\x22DocLib\x22\x20name=\x22Library\x22\x20type=\x22radio\x22\x20id=\x22chkProcessApprovers','DocumentLibrary','PersonalDMS_Setting','</div><div\x20class=\x27designationtype\x27>','Documents','#__REQUESTDIGEST','\x27,\x20','POST','Selective','\x27);\x22\x20href=\x22javascript:void(0);\x22>','done','#referNo','</div><div\x20class=\x27designationtype\x27><h3\x20class=\x27namesection\x27>','#GroupNameList','responseText','ProjectTeamDetails','Yes','#FileTitle','</div></div></td>','My_Doc','activating','error','<div><strong>File\x20Name\x20:</strong>','<div\x20class=\x22col-sm-6\x20parentremove\x20GpUser','GroupId','\x20title=\x27',',\x20shared\x20the\x20following\x20document\x20with\x20you.<br/><br/>','.parentremove','.GpUser','</tr>','.chkClientName:checked','<ul>','parents','3MbqXam','1554126dFaPoM','<td>','<h3\x20class=\x27namesection\x27>','<li\x20class=\x22parent\x22\x20id=\x22treeNode_','undefined','results','cells','SharingPplPicker','Active','\x22);\x27>','#LibProject','\x27,\x20\x27','--Select--','<tr><td><div\x20class=\x22checkbox\x20m-0\x22><label><input\x20class=\x22DocLib\x22\x20name=\x22Library\x22\x20type=\x22radio\x22\x20id=\x22chkProjectTeamDetails','location','/_api/SP.Sharing.DocumentSharingManager.UpdateDocumentSharingInfo','.My-Groups','\x27);\x22\x20href=\x22javascript:void(0);\x22>Root</a>','permission\x20deleted\x20sucessfully.','\x27)/id','input[name=\x22Library\x22]','<td><input\x20type=\x27checkbox\x27\x20class=\x27historydocid\x27\x20value=','File\x20has\x20been\x20successfully\x20deleted.','toISOString','DELETE','?$select=DocumentPermission,TeamMember/Id,Project/Id,Project/ProjectName&$top=5000&$orderby=Project/ProjectName\x20asc&$expand=TeamMember,Project&$filter=CompanyId\x20eq\x20\x27','\x27\x20and\x20Status\x20eq\x20\x27Active\x27','#sharedWithPermission','<td\x20class=\x22text-left\x22>Custom</td>','Status','name=\x22','SharedUsers','includes','DisplayText','File\x20has\x20been\x20successfully\x20copied.','columns','/DepartmentalDMS/Forms/AllItems.aspx','<td><div\x20class=\x27flexingtwo\x27><img\x20src=\x27','</span>','PermissionStatus','375897eVfyPy','reject','userId','\x27\x27></td>','UserId','Organization','\x27\x20and\x20PermissionStatus\x20ne\x20\x27Revoked\x27','</a></div></div></td>','evenselected','closed','\x27title=\x27','Access\x20is\x20denied','Required\x20columns\x20does\x20not\x20exists.\x20Kindly\x20contact\x20administrator.','Guest','<td><div\x20class=\x27RevokedDetails\x27><span\x20style=\x27cursor:\x20not-allowed;color:\x20Red;\x27>Revoked</span><span>','Key','prop','File\x20has\x20been\x20successfully\x20moved.','responseJSON','<option\x20value=\x27','GroupTitle','SharedId','SP.Utilities.EmailProperties','#selectedGroupNames','Expiry\x20date\x20should\x20me\x20greater\x20than\x20today.','Author','</h3>','#FolderNameCopy','Forms','Revoked\x20due\x20to\x20re-share','DocumentManagementSystem/','.NoRecordFound','<span\x20class=\x22employeeemail\x22>','DMS_Link','ready','head','\x22><a\x20class=\x22DmsTree\x22\x20onclick=\x22ClickFolder(this,\x20\x27','SP.Sharing.UserRoleAssignment','DepartmentName','DeleteFile','Contribute','</td>','SharedGroup','ajax','ProjectName','sucessfully\x20revoke','\x27)/ListItemAllFields/breakroleinheritance(true)','</ul>','#ClientList','Folders','val','/_api/SP.Utilities.Utility.SendEmail','#revokebtn','.ProjectUser','<td><a\x20href=javascript:void(0)\x20style=\x22cursor:text;color:black;\x22\x20name\x20=\x20','Shared%20Documents','You\x20don\x27t\x20have\x20the\x20required\x20permission\x20to\x20perform\x20this\x20operation.','<div><a\x20href=','1073741827','/_api/Web/Lists/getByTitle(\x27','\x27);\x22\x20class=\x22crosebox\x22><i\x20class=\x22fa\x20fa-times\x22></i></span>','?$select=Id,ProjectName,DepartmentName,ClientID/Title,ManagerName/EMail,Status&$top=5000&$expand=ClientID,ManagerName&$filter=ManagerName/EMail\x20eq\x20\x27','application/json;\x20odata=verbose',':\x20Item\x20is\x20set\x20permission','?$select=Id,Project/Id,TeamMember/EMail,TeamMember/Title,TeamMember/Id,Status&$top=5000&$expand=Project,TeamMember&$filter=Project/Id\x20eq\x20\x27','Attempted\x20to\x20perform\x20an\x20unauthorized\x20operation','GroupName','application/json;odata=verbose','</div></span>','before','#txtPleaseWait','length','\x27)/$value','asc','#TotalItemscount','slice','<div><strong>Permission:</strong>\x20','desc','selectedrow','\x27\x20or\x20InternalSupervisor/EMail\x20eq\x20\x27','/_api/web/GetFolderByServerRelativeUrl(\x27','charAt','Permission\x20has\x20been\x20revoked.','currentpage','oddselected','DocumentSharedGroups','<td\x20class=\x22text-left\x22><a\x20href=javascript:void(0)\x20style=\x22cursor:text;color:black;\x22\x20name\x20=\x20','Shared\x20Documents/','extend','#selectAllHist','</a>','toggleClass','\x27)/ListItemAllFields/roleassignments/addroleassignment(principalid=','FormDigestValue','hide','>Click\x20here</a>\x20to\x20open\x20the\x20document.</div>','Department','<td><a\x20style=\x27cursor:\x20pointer;\x27\x20onclick=RevokePermission(\x27','title','Created'];_0x3192=function(){return _0x30e119;};return _0x3192();}function createJSONMetadata(_0x4c217c,_0x15f301){var _0x579f86=_0x43aca4,_0x5d886f=[],_0x29a935={};_0x29a935[_0x579f86(0x1db)]=_0x579f86(0xec);for(var _0x36e08b=0x0;_0x36e08b<_0x4c217c['length'];_0x36e08b++){var _0x374206={};_0x374206['__metadata']=_0x29a935,_0x374206[_0x579f86(0x1b7)]=parseInt(_0x15f301),_0x374206[_0x579f86(0xcb)]=_0x4c217c[_0x36e08b],_0x5d886f[_0x579f86(0x1eb)](_0x374206);}return _0x5d886f;}function getSharedUsersId(_0x4ae441){var _0x4d6ae1=_0x43aca4,_0x143c60=[];CopyLibrary=='Shared%20Documents'&&(CopyLibrary='Documents');CopySourceURL!=_spPageContextInfo['webAbsoluteUrl']&&$[_0x4d6ae1(0x1f8)](GetFormDigestValue(CopySourceURL))[_0x4d6ae1(0x215)](function(_0x5a3c0c){RequestDigest=_0x5a3c0c;});var _0x159315=CopySourceURL+'/_api/web/Lists/GetByTitle(\x27'+CopyLibrary+_0x4d6ae1(0x1fa)+_0x4ae441+')?$select=ServerRedirectedEmbedUri,File/Name,File/ServerRelativeUrl,Folder/Name,Folder/ServerRelativeUrl,Shared/Title,SharedId&$expand=File,Folder,SharedId';return $[_0x4d6ae1(0xf2)]({'url':_0x159315,'headers':{'accept':_0x4d6ae1(0x10a),'content-type':_0x4d6ae1(0x10a),'X-RequestDigest':RequestDigest},'async':![],'success':function(_0x3a6970){var _0x105a7d=_0x4d6ae1;RequestDigest=$(_0x105a7d(0x210))[_0x105a7d(0xf9)]();if(_0x3a6970['d'][_0x105a7d(0xdc)]!=null)for(var _0x56e00e=0x0;_0x56e00e<_0x3a6970['d']['SharedId'][_0x105a7d(0x232)]['length'];_0x56e00e++){var _0x1d6ed2=_0x3a6970['d']['SharedId'][_0x105a7d(0x232)][_0x56e00e];_0x143c60[_0x105a7d(0x1eb)](_0x1d6ed2);}},'eror':function(_0x4fa559){var _0x3dfa04=_0x4d6ae1;RequestDigest=$(_0x3dfa04(0x210))[_0x3dfa04(0xf9)](),console[_0x3dfa04(0x19c)](_0x4fa559);}}),_0x143c60;}function ShareFileValidation(){var _0x14833f=_0x43aca4;if(SharingUserEmail[_0x14833f(0x10e)]==0x0){alert('Kindly\x20select\x20any\x20users\x20first.');return;}else{if($('#expiredon')[_0x14833f(0xd7)](_0x14833f(0x19a))&&$(_0x14833f(0x16e))[_0x14833f(0xf9)]()==''){alert(_0x14833f(0x148));return;}else return new Date()>new Date($('#expiredats')[_0x14833f(0xf9)]())?(alert('Expiry\x20date\x20should\x20me\x20greater\x20than\x20today.'),![]):!![];}}function loadProjects(){var _0x1986da=_0x43aca4,_0x25d4a9='',_0x143b66=_0x1986da(0x104)+_spPageContextInfo[_0x1986da(0x1d7)]+'\x27\x20';$['when'](getItemsWithQuery(_0x1986da(0x1cf),_0x143b66))['done'](function(_0x596ebc){var _0x2292cc=_0x1986da;if(_0x596ebc[_0x2292cc(0x10e)]>0x0){for(var _0x2fcaeb=0x0;_0x2fcaeb<_0x596ebc['length'];_0x2fcaeb++){_0x25d4a9+=_0x2292cc(0x1a8)+_0x596ebc[_0x2fcaeb]['Id']+_0x2292cc(0x156)+_0x596ebc[_0x2fcaeb][_0x2292cc(0xf3)]+'\x22\x20class=\x22chkProjectName\x22><div\x20class=\x22teamprojectcontent\x22><p>'+_0x596ebc[_0x2fcaeb]['ProjectName']+_0x2292cc(0x1b2),_0x25d4a9+=_0x2292cc(0x158)+_0x596ebc[_0x2fcaeb][_0x2292cc(0x24a)]+_0x2292cc(0x15b)+_0x596ebc[_0x2fcaeb][_0x2292cc(0xed)]+_0x2292cc(0x1ec);}$(_0x2292cc(0x146))['append'](_0x25d4a9);}}),$(_0x1986da(0x195))[_0x1986da(0x180)](function(){var _0x1a6bad=_0x1986da;getProjectUsers(this['title'],this['id']['replace']('ProjectId',''),this[_0x1a6bad(0x19a)]);var _0x11c007=[],_0x35132f=this[_0x1a6bad(0x129)];$(_0x1a6bad(0x1df))[_0x1a6bad(0x1c1)]()!=_0x1a6bad(0x16d)&&$(_0x1a6bad(0x1df))[_0x1a6bad(0x1c1)]()!=''&&(_0x11c007=$(_0x1a6bad(0x1df))['text']()[_0x1a6bad(0x1e1)](',')),this['checked']?($('#selectProjectNames')[_0x1a6bad(0x1c1)](''),_0x11c007[_0x1a6bad(0x1eb)](this['title'])):_0x11c007=_0x11c007['filter'](function(_0x2e050e){return _0x2e050e!==_0x35132f;}),_0x11c007['length']==0x0?$('#selectProjectNames')[_0x1a6bad(0x1c1)](_0x1a6bad(0x16d)):$('#selectProjectNames')[_0x1a6bad(0x1c1)](_0x11c007[_0x1a6bad(0x140)]());});}function getProjectUsers(_0x265e4c,_0x2146da,_0x4c882b){var _0x28fb8c=_0x43aca4,_0x4a1b78='',_0x3c5ecb=_0x28fb8c(0x107)+_0x2146da+'\x27\x20';$[_0x28fb8c(0x1f8)](getItemsWithQuery(_0x28fb8c(0x21a),_0x3c5ecb))[_0x28fb8c(0x215)](function(_0x27485c){var _0x1f79b6=_0x28fb8c;if(_0x27485c['length']>0x0)for(var _0x42bc68=0x0;_0x42bc68<_0x27485c['length'];_0x42bc68++){if(_0x4c882b==!![]){_0x4a1b78='';var _0x5ca94c=_0x27485c[_0x42bc68]['TeamMember'][_0x1f79b6(0x1fc)];_0x5ca94c[_0x1f79b6(0x24d)]('#')==!![]&&(_0x5ca94c=_0x5ca94c[_0x1f79b6(0x202)]('#ext#@adaptindia.onmicrosoft.com',''),_0x5ca94c=_0x5ca94c[_0x1f79b6(0x202)]('_','@')),SharingUserEmail[_0x1f79b6(0x1eb)](_0x5ca94c),SharingUserId[_0x1f79b6(0x1eb)](_0x27485c[_0x42bc68][_0x1f79b6(0x14c)]['Id']),SharingUserName[_0x1f79b6(0x1eb)](_0x27485c[_0x42bc68][_0x1f79b6(0x14c)][_0x1f79b6(0x209)]),attachment=_spPageContextInfo['webAbsoluteUrl']+_0x1f79b6(0x172)+escapeProperly(_0x5ca94c),_0x4a1b78+='<div\x20class=\x22col-sm-6\x20parentremove\x20ProjectUser'+_0x27485c[_0x42bc68]['Id']+_0x1f79b6(0x16c),_0x4a1b78+='<span\x20onclick=\x22removeShareUser(this,\x20\x27'+_0x5ca94c+'\x27,\x20\x27'+_0x27485c[_0x42bc68]['TeamMember']['Title']+'\x27,\x20'+_0x27485c[_0x42bc68][_0x1f79b6(0x14c)]['Id']+');\x22\x20class=\x22crosebox\x22><i\x20class=\x22fa\x20fa-times\x22></i></span>',_0x4a1b78+=_0x1f79b6(0x1a6)+attachment+_0x1f79b6(0x142),_0x4a1b78+=_0x1f79b6(0x157)+_0x27485c[_0x42bc68][_0x1f79b6(0x14c)]['Title']+_0x1f79b6(0xe1),_0x4a1b78+=_0x1f79b6(0x1f2)+_0x27485c[_0x42bc68][_0x1f79b6(0x14c)][_0x1f79b6(0x209)]+_0x1f79b6(0x184)+_0x27485c[_0x42bc68]['TeamMember']['Title']+_0x1f79b6(0xc5),_0x4a1b78+=_0x1f79b6(0x170),$('#AddUserPplPicker')['before'](_0x4a1b78);}else $(_0x1f79b6(0xfc)+_0x27485c[_0x42bc68]['Id'])[_0x1f79b6(0x12c)](),SharingUserEmail=SharingUserEmail[_0x1f79b6(0x208)](function(_0x5f2091){var _0x42ac5c=_0x1f79b6;return _0x5f2091[_0x42ac5c(0x136)]()!==_0x5ca94c['toLowerCase']();}),SharingUserId=SharingUserId[_0x1f79b6(0x208)](function(_0x29924b){return _0x29924b!==_0x27485c[_0x42bc68]['TeamMember']['Id'];}),SharingUserName=SharingUserName['filter'](function(_0x549163){var _0x3e6915=_0x1f79b6;return _0x549163[_0x3e6915(0x136)]()!==_0x27485c[_0x42bc68][_0x3e6915(0x14c)]['Title'][_0x3e6915(0x136)]();});}});}function getGuestClientShare(){var _0x1257b4=_0x43aca4,_0x551ceb='',_0x1cdafb='?$select=Id,Title,IsActive,GroupName/Id,GroupName/Title,DocumentLibrary,CompanyID/Id,DocumentLibrary,InternalMembers/EMail,InternalSupervisor/EMail&$orderby=Title\x20asc&$expand=GroupName,CompanyID,InternalMembers,InternalSupervisor&$top=5000&$filter=IsActive\x20eq\x20\x271\x27\x20and\x20InternalMembers/EMail\x20eq\x20\x27'+_spPageContextInfo['userEmail']+_0x1257b4(0x116)+_spPageContextInfo[_0x1257b4(0x1d7)]+'\x27\x20';$[_0x1257b4(0x1f8)](getItemsWithQuery(_0x1257b4(0x1a0),_0x1cdafb))[_0x1257b4(0x215)](function(_0x41fe2b){var _0x28029e=_0x1257b4;if(_0x41fe2b['length']>0x0){for(var _0xb41a2a=0x0;_0xb41a2a<_0x41fe2b[_0x28029e(0x10e)];_0xb41a2a++){var _0x4cb18b=_0x41fe2b[_0xb41a2a];_0x4cb18b['DocumentLibrary']!=null&&(_0x551ceb+=_0x28029e(0x185)+_0x4cb18b[_0x28029e(0x109)]['Id']+_0x28029e(0x156)+_0x4cb18b['Title']+'\x22\x20onclick=\x22ShowGetClient(\x27'+_0x4cb18b[_0x28029e(0x209)]+_0x28029e(0x238)+_0x4cb18b[_0x28029e(0x109)]['Id']+_0x28029e(0x238)+_0x4cb18b[_0x28029e(0x109)][_0x28029e(0x209)]+_0x28029e(0x238)+_0x4cb18b['Id']+'\x27,\x20this)\x22>'+_0x4cb18b['Title']+_0x28029e(0x1b3));}$('#ClientList')[_0x28029e(0x1d6)](_0x551ceb);}});}function ShowGetClient(_0x499993,_0x163d79,_0xe76e28,_0x40f4f5,_0x6a531){var _0x3fd9bd=_0x43aca4;getClientUsers(_0x499993,_0x163d79,_0xe76e28,_0x6a531['checked']);var _0x232d6e=[];_0x6a531[_0x3fd9bd(0x19a)]?SharingUserEmail[_0x3fd9bd(0x1eb)]({'GroupId':_0x163d79,'ClientName':_0x499993,'ClientId':_0x40f4f5,'GroupTitle':_0xe76e28}):SharingUserEmail=SharingUserEmail[_0x3fd9bd(0x208)](function(_0x23c42a){var _0x4c3df4=_0x3fd9bd;return _0x23c42a[_0x4c3df4(0x223)]!=_0x163d79;}),$(_0x3fd9bd(0x229))[_0x3fd9bd(0x10e)]!=0x0?($('#userDiv')['show'](),$(_0x3fd9bd(0x229))[_0x3fd9bd(0x1f5)](function(){var _0x36aa0c=_0x3fd9bd;_0x232d6e[_0x36aa0c(0x1eb)](this[_0x36aa0c(0x129)]);}),_0x232d6e['join'](',\x20')[_0x3fd9bd(0x10e)]>0x3e?(selectedClientNameTemp=_0x232d6e[_0x3fd9bd(0x203)](','),selectedClientNameTemp=selectedClientNameTemp[_0x3fd9bd(0x1a4)](0x0,0x3e),$(_0x3fd9bd(0x194))[_0x3fd9bd(0x1c1)](selectedClientNameTemp+_0x3fd9bd(0x1e3))):$(_0x3fd9bd(0x194))[_0x3fd9bd(0x1c1)](_0x232d6e['join'](','))):($(_0x3fd9bd(0x194))[_0x3fd9bd(0x1c1)]('Select'),$(_0x3fd9bd(0x15d))[_0x3fd9bd(0x125)]());}function getClientUsers(_0x255a68,_0x4470cd,_0x15920c,_0x5b1f96){var _0x5486d8=_0x43aca4,_0xb1feae='',_0x37de83='';_0x5b1f96==!![]?(_0xb1feae='',_0x37de83=_spPageContextInfo['webAbsoluteUrl']+'/_layouts/15/userphoto.aspx?accountname='+escapeProperly(_0x15920c),_0xb1feae+=_0x5486d8(0x222)+_0x4470cd+_0x5486d8(0x16c),_0xb1feae+=_0x5486d8(0x17b)+_0x4470cd+_0x5486d8(0x103),_0xb1feae+=_0x5486d8(0x1a6)+_0x37de83+'\x22\x20alt=\x22\x22>',_0xb1feae+=_0x5486d8(0x157)+_0x255a68+_0x5486d8(0xe1),_0xb1feae+=_0x5486d8(0xe7)+_0x15920c+_0x5486d8(0xc5),_0xb1feae+='</div></div></div>',$(_0x5486d8(0x162))[_0x5486d8(0x10c)](_0xb1feae)):$(_0x5486d8(0x227)+_0x4470cd)[_0x5486d8(0x12c)]();}function RemoveGroup(_0x20878c){var _0x1dcc35=_0x43aca4;SharingUserEmail=SharingUserEmail[_0x1dcc35(0x208)](function(_0x19aacd){return _0x19aacd['GroupId']!=_0x20878c;}),$(_0x1dcc35(0x227)+_0x20878c)['remove'](),$(_0x1dcc35(0x1f7)+_0x20878c)['prop'](_0x1dcc35(0x17f),'disabled'),SharingUserEmail[_0x1dcc35(0x10e)]==0x0&&$('#userDiv')['hide']();}function onChangeSharing(_0x12d1e7,_0x5e0727,_0x215ef2){var _0x29cb06=_0x43aca4,_0x3ad711=SPClientPeoplePicker[_0x29cb06(0x190)][_0x12d1e7],_0x3cfde3='';_0x3ad711['OnValueChangedClientScript']=function(_0x4d65fe,_0x3cc699){var _0x118795=_0x29cb06;if(_0x3cc699['length']>0x0){_0x3cfde3='',tempUserId=parseInt(getUserInformation(_0x5e0727)),SharingUserId[_0x118795(0x1eb)](tempUserId);var _0x28a986=_0x3cc699[0x0][_0x118795(0xd6)][_0x118795(0x1e1)]('|')[0x2];_0x28a986[_0x118795(0x24d)]('#')==!![]&&(_0x28a986=_0x28a986[_0x118795(0x202)]('#ext#@adaptindia.onmicrosoft.com',''),_0x28a986=_0x28a986[_0x118795(0x202)]('_','@')),SharingUserEmail[_0x118795(0x1eb)](_0x28a986),SharingUserName['push'](_0x3cc699[0x0]['DisplayText']),attachment=_spPageContextInfo[_0x118795(0x179)]+'/_layouts/15/userphoto.aspx?accountname='+escapeProperly(_0x28a986),_0x3cfde3+='<div\x20class=\x22col-sm-6\x20parentremove\x20User'+tempUserId+_0x118795(0x16c),_0x3cfde3+=_0x118795(0x16b)+_0x28a986+_0x118795(0x238)+_0x3cc699[0x0][_0x118795(0x24e)]+_0x118795(0x211)+tempUserId+_0x118795(0x1ce),_0x3cfde3+=_0x118795(0x1a6)+attachment+_0x118795(0x142),_0x3cfde3+=_0x118795(0x157)+_0x3cc699[0x0][_0x118795(0x24e)]+_0x118795(0xe1),_0x3cfde3+='<span\x20class=\x22employeeemail\x22\x20style=\x22cursor:pointer;color:blue\x22\x20onclick=\x22OpenEmail(\x27'+_0x28a986+'\x27)\x22>'+_0x28a986+_0x118795(0xc5),_0x3cfde3+=_0x118795(0x170),$('#'+_0x215ef2)[_0x118795(0x10c)](_0x3cfde3),EmptyPeoplePicker(_0x5e0727);}else{}};}function getMyGroups(){var _0xde7e03=_0x43aca4,_0xf9b065='',_0xdf1afd='',_0x25b74d=_0xde7e03(0x204)+_spPageContextInfo[_0xde7e03(0x1d7)]+'\x27\x20';$[_0xde7e03(0x1f8)](getItemsWithQuery(_0xde7e03(0x11c),_0x25b74d))[_0xde7e03(0x215)](function(_0x3c2c01){var _0x51a326=_0xde7e03;if(_0x3c2c01[_0x51a326(0x10e)]>0x0){for(var _0x24b8d5=0x0;_0x24b8d5<_0x3c2c01[_0x51a326(0x10e)];_0x24b8d5++){_0xf9b065+='<li><input\x20type=\x22checkbox\x22\x20class=\x22chkGpName\x22\x20id=\x22GroupId'+_0x3c2c01[_0x24b8d5]['Id']+_0x51a326(0x156)+_0x3c2c01[_0x24b8d5]['SharingLevel']+_0x51a326(0x1c3)+_0x3c2c01[_0x24b8d5][_0x51a326(0x14d)]+'</h3><ul\x20class=\x22listingroups\x22>';if(_0x3c2c01[_0x24b8d5][_0x51a326(0x24c)][_0x51a326(0x232)]!=null)for(var _0x20c4d3=0x0;_0x20c4d3<_0x3c2c01[_0x24b8d5][_0x51a326(0x24c)][_0x51a326(0x232)][_0x51a326(0x10e)];_0x20c4d3++){_0xdf1afd=_spPageContextInfo[_0x51a326(0x179)]+_0x51a326(0x172)+escapeProperly(_0x3c2c01[_0x24b8d5][_0x51a326(0x24c)][_0x51a326(0x232)][_0x20c4d3][_0x51a326(0x1fc)]),_0xf9b065+='<li><img\x20src=\x22'+_0xdf1afd+'\x22\x20title=\x22'+_0x3c2c01[_0x24b8d5]['SharedUsers'][_0x51a326(0x232)][_0x20c4d3][_0x51a326(0x209)]+_0x51a326(0x1d9);}_0xf9b065+=_0x51a326(0x174);}$(_0x51a326(0x218))[_0x51a326(0x1d6)](_0xf9b065);}}),$(_0xde7e03(0x15a))['click'](function(){var _0x115912=_0xde7e03;getMyGroupsUsers(parseInt(this['id']['replace'](_0x115912(0x223),'')),this[_0x115912(0x19a)]);var _0x2fffbb=[],_0x4495c7=this[_0x115912(0x129)];$('#selectedGroupNames')[_0x115912(0x1c1)]()!=_0x115912(0x16d)&&$('#selectedGroupNames')['text']()!=''&&(_0x2fffbb=$(_0x115912(0xde))['text']()[_0x115912(0x1e1)](',')),this['checked']?($(_0x115912(0xde))[_0x115912(0x1c1)](''),_0x2fffbb[_0x115912(0x1eb)](this[_0x115912(0x129)])):_0x2fffbb=_0x2fffbb['filter'](function(_0x178188){return _0x178188!==_0x4495c7;}),_0x2fffbb[_0x115912(0x10e)]==0x0?$(_0x115912(0xde))[_0x115912(0x1c1)](_0x115912(0x16d)):$('#selectedGroupNames')['text'](_0x2fffbb['toString']());});}function getMyGroupsUsers(_0x460dbc,_0x7783f5){var _0x4b89a2=_0x43aca4,_0x1d83c4='',_0xf3ac03='',_0x475552=_0x4b89a2(0x204)+_spPageContextInfo[_0x4b89a2(0x1d7)]+_0x4b89a2(0x1d1)+_0x460dbc+'\x27\x20';$['when'](getItemsWithQuery(_0x4b89a2(0x11c),_0x475552))['done'](function(_0x511cbe){var _0x193e5e=_0x4b89a2;if(_0x511cbe[_0x193e5e(0x10e)]>0x0)for(var _0xb722c2=0x0;_0xb722c2<_0x511cbe[_0x193e5e(0x10e)];_0xb722c2++){if(_0x511cbe[_0xb722c2][_0x193e5e(0x24c)][_0x193e5e(0x232)]!=null)for(var _0x36fff0=0x0;_0x36fff0<_0x511cbe[_0xb722c2][_0x193e5e(0x24c)]['results'][_0x193e5e(0x10e)];_0x36fff0++){_0x7783f5==!![]?(_0x1d83c4='',SharingUserEmail[_0x193e5e(0x1eb)](_0x511cbe[_0xb722c2]['SharedUsers'][_0x193e5e(0x232)][_0x36fff0][_0x193e5e(0x1fc)]),SharingUserId[_0x193e5e(0x1eb)](_0x511cbe[_0xb722c2]['SharedUsers'][_0x193e5e(0x232)][_0x36fff0]['ID']),SharingUserName[_0x193e5e(0x1eb)](_0x511cbe[_0xb722c2]['SharedUsers']['results'][_0x36fff0][_0x193e5e(0x209)]),_0xf3ac03=_spPageContextInfo[_0x193e5e(0x179)]+'/_layouts/15/userphoto.aspx?accountname='+escapeProperly(_0x511cbe[_0xb722c2][_0x193e5e(0x24c)][_0x193e5e(0x232)][_0x36fff0][_0x193e5e(0x1fc)]),_0x1d83c4+=_0x193e5e(0x17e)+_0x511cbe[_0xb722c2]['Id']+_0x193e5e(0x16c),_0x1d83c4+='<span\x20onclick=\x22removeShareUser(this,\x20\x27'+_0x511cbe[_0xb722c2][_0x193e5e(0x24c)]['results'][_0x36fff0]['EMail']+_0x193e5e(0x238)+_0x511cbe[_0xb722c2]['SharedUsers'][_0x193e5e(0x232)][_0x36fff0][_0x193e5e(0x209)]+_0x193e5e(0x211)+_0x511cbe[_0xb722c2][_0x193e5e(0x24c)]['results'][_0x36fff0]['ID']+_0x193e5e(0x1ce),_0x1d83c4+=_0x193e5e(0x1a6)+_0xf3ac03+_0x193e5e(0x142),_0x1d83c4+=_0x193e5e(0x157)+_0x511cbe[_0xb722c2][_0x193e5e(0x24c)][_0x193e5e(0x232)][_0x36fff0][_0x193e5e(0x209)]+_0x193e5e(0xe1),_0x1d83c4+=_0x193e5e(0x1f2)+_0x511cbe[_0xb722c2][_0x193e5e(0x24c)][_0x193e5e(0x232)][_0x36fff0][_0x193e5e(0x1fc)]+_0x193e5e(0x184)+_0x511cbe[_0xb722c2][_0x193e5e(0x24c)][_0x193e5e(0x232)][_0x36fff0]['EMail']+'</span>',_0x1d83c4+='</div></div></div>',$(_0x193e5e(0x162))[_0x193e5e(0x10c)](_0x1d83c4)):($('.User'+_0x511cbe[_0xb722c2]['Id'])[_0x193e5e(0x12c)](),SharingUserEmail=SharingUserEmail[_0x193e5e(0x208)](function(_0x5edb1e){var _0x339b06=_0x193e5e;return _0x5edb1e[_0x339b06(0x136)]()!==_0x511cbe[_0xb722c2][_0x339b06(0x24c)][_0x339b06(0x232)][_0x36fff0][_0x339b06(0x1fc)][_0x339b06(0x136)]();}),SharingUserId=SharingUserId['filter'](function(_0x14d233){var _0x46f34c=_0x193e5e;return _0x14d233!==_0x511cbe[_0xb722c2][_0x46f34c(0x24c)][_0x46f34c(0x232)][_0x36fff0]['ID'];}),SharingUserName=SharingUserName['filter'](function(_0x436c9c){var _0x928403=_0x193e5e;return _0x436c9c[_0x928403(0x136)]()!==_0x511cbe[_0xb722c2][_0x928403(0x24c)][_0x928403(0x232)][_0x36fff0][_0x928403(0x209)][_0x928403(0x136)]();}));}}});}function removeShareUser(_0x16b627,_0x3b23c5,_0x41b278,_0x3c30ca,_0x451aa8){var _0x5c5a05=_0x43aca4;$(_0x16b627)[_0x5c5a05(0x22b)](_0x5c5a05(0x226))['remove'](),SharingUserEmail=SharingUserEmail[_0x5c5a05(0x208)](function(_0x21e14b){var _0x58fc60=_0x5c5a05;return _0x21e14b['toLowerCase']()!==_0x3b23c5[_0x58fc60(0x136)]();}),SharingUserName=SharingUserName[_0x5c5a05(0x208)](function(_0x35e5f2){var _0x4f8e45=_0x5c5a05;return _0x35e5f2[_0x4f8e45(0x136)]()!==_0x41b278[_0x4f8e45(0x136)]();}),SharingUserId=SharingUserId[_0x5c5a05(0x208)](function(_0x4e9eff){return _0x4e9eff!=_0x3c30ca;});}function GetSharedHistory(_0x45c6d9,_0xa5d84,_0x454ea2,_0x304673,_0x357c88,_0x3cd681){var _0x37ad28=_0x43aca4;selectedHistoryDoc=[];var _0x3d6ea2='',_0x123bd9=[],_0x4606b5=[],_0x1b6b08=[],_0x3d809c=[],_0x1e5cb4=[];SharedTo='';var _0x16b134=_0x37ad28(0x21e);$(_0x37ad28(0x183))[_0x37ad28(0xd7)](_0x37ad28(0x19a),![]),$(_0x37ad28(0xfb))[_0x37ad28(0x125)](),$('.context-menu')[_0x37ad28(0x125)](),$('#sharedHistoryList')[_0x37ad28(0x1a1)](''),$('#shreduser')[_0x37ad28(0x1a1)](''),$(_0x37ad28(0x19f))[_0x37ad28(0x1d8)]('show');var _0xcf848e='?$select=*,SharedUsers/Id,SharedUsers/Title,SharedClient/Title,Author/Title&$expand=Author,SharedUsers,SharedClient&$Filter=DocumentID\x20eq\x20\x27'+_0x45c6d9+'\x27&$orderby=Created\x20desc';$[_0x37ad28(0x1f8)](getItemsWithQuery('SharedDocument',_0xcf848e))[_0x37ad28(0x215)](function(_0x300228){var _0x5c3e46=_0x37ad28;$('#filenamee')[_0x5c3e46(0x1a1)](_0x357c88);_0x454ea2=='null'?$(_0x5c3e46(0x1d3))[_0x5c3e46(0x1a1)](''):$(_0x5c3e46(0x1d3))[_0x5c3e46(0x1a1)](_0x454ea2);_0x304673==_0x5c3e46(0x1ef)?$(_0x5c3e46(0x216))[_0x5c3e46(0x1a1)](''):$(_0x5c3e46(0x216))['html'](_0x304673);if(_0x300228[_0x5c3e46(0x10e)]>0x0){var _0x590da3='';$(_0x5c3e46(0x1b1))[_0x5c3e46(0x1d6)](_0x5c3e46(0x139));for(var _0x1ae94c=0x0;_0x1ae94c<_0x300228['length'];_0x1ae94c++){var _0x494f33=_0x300228[_0x1ae94c][_0x5c3e46(0x209)],_0x2a43bb=_0x300228[_0x1ae94c][_0x5c3e46(0x1fe)],_0x3a72aa=_0x300228[_0x1ae94c]['ID'],_0x93629=_0x300228[_0x1ae94c][_0x5c3e46(0xc6)],_0x1799dd='',_0x87ce9f='',_0x3fe8a6='',_0x429083=_0x300228[_0x1ae94c]['NeedAcknowledgement'];_0x429083==!![]?_0x429083=_0x5c3e46(0x1c6):_0x429083=_0x5c3e46(0x13c);var _0x51e825='';_0x300228[_0x1ae94c][_0x5c3e46(0x1ad)]!=null&&(_0x51e825=titanForWork[_0x5c3e46(0x13f)](_0x300228[_0x1ae94c][_0x5c3e46(0x1ad)]));for(var _0x5424ec=0x0;_0x5424ec<_0x300228[_0x1ae94c]['SharedUsers'][_0x5c3e46(0x232)][_0x5c3e46(0x10e)];_0x5424ec++){_0x123bd9[_0x5c3e46(0x17c)](_0x300228[_0x1ae94c][_0x5c3e46(0x24c)][_0x5c3e46(0x232)][_0x5424ec]['Title'])==-0x1&&(_0x123bd9[_0x5c3e46(0x1eb)](_0x300228[_0x1ae94c][_0x5c3e46(0x24c)]['results'][_0x5424ec][_0x5c3e46(0x209)]),_0x300228[_0x1ae94c][_0x5c3e46(0xf1)]!=_0x5c3e46(0xcc)?_0x3d6ea2+=_0x5c3e46(0xda)+_0x300228[_0x1ae94c][_0x5c3e46(0x24c)][_0x5c3e46(0x232)][_0x5424ec]['Title']+_0x5c3e46(0xd1)+_0x300228[_0x1ae94c]['SharedUsers']['results'][_0x5424ec][_0x5c3e46(0x209)]+'\x27>'+_0x300228[_0x1ae94c][_0x5c3e46(0x24c)][_0x5c3e46(0x232)][_0x5424ec]['Title']+'</option>':jQuery[_0x5c3e46(0x196)](_0x300228[_0x1ae94c]['SharedClient'][_0x5c3e46(0x209)],_0x1e5cb4)=='-1'&&(_0x3d6ea2+='<option\x20value=\x27'+_0x300228[_0x1ae94c][_0x5c3e46(0x1dc)][_0x5c3e46(0x209)]+'\x27title=\x27'+_0x300228[_0x1ae94c][_0x5c3e46(0x1dc)][_0x5c3e46(0x209)]+'\x27>'+_0x300228[_0x1ae94c][_0x5c3e46(0x1dc)][_0x5c3e46(0x209)]+_0x5c3e46(0x13d),_0x1e5cb4['push'](_0x300228[_0x1ae94c][_0x5c3e46(0x1dc)]['Title']))),_0x1799dd=_0x300228[_0x1ae94c][_0x5c3e46(0x24c)][_0x5c3e46(0x232)][_0x5424ec][_0x5c3e46(0x209)],_0x87ce9f=_0x300228[_0x1ae94c]['SharedUserEmail'],_0x87ce9f=_0x87ce9f?_0x87ce9f:'',_0x3fe8a6=_0x300228[_0x1ae94c][_0x5c3e46(0x24c)][_0x5c3e46(0x232)][_0x5424ec]['Id'];}if(_0x300228[_0x1ae94c][_0x5c3e46(0xf1)]!='Organization'){var _0x2d5463=_spPageContextInfo[_0x5c3e46(0x179)]+_0x5c3e46(0x172)+escapeProperly(_0x87ce9f);_0x93629==_0x5c3e46(0x17d)?(_0x590da3+='<tr><td></td>',_0x300228[_0x1ae94c][_0x5c3e46(0xf1)]==_0x5c3e46(0x19e)?_0x590da3+=_0x5c3e46(0x150)+_0x1799dd['charAt'](0x0)+_0x5c3e46(0x20e):_0x590da3+='<td><div\x20class=\x27flexingtwo\x27><img\x20src=\x27'+_0x2d5463+_0x5c3e46(0x1bc),_0x590da3+=_0x5c3e46(0x22f)+_0x1799dd+_0x5c3e46(0xe1),_0x590da3+=_0x5c3e46(0x159)+_0x87ce9f+_0x5c3e46(0x236)+_0x87ce9f+_0x5c3e46(0xce),_0x590da3+=_0x5c3e46(0x22e)+_0x2a43bb+_0x5c3e46(0xf0),_0x590da3+=_0x5c3e46(0x22e)+titanForWork[_0x5c3e46(0x13f)](_0x300228[_0x1ae94c][_0x5c3e46(0x12a)])+_0x5c3e46(0xf0),_0x590da3+=_0x5c3e46(0x22e)+_0x300228[_0x1ae94c][_0x5c3e46(0xe0)][_0x5c3e46(0x209)]+'</td>',_0x590da3+=_0x5c3e46(0x22e)+_0x51e825+_0x5c3e46(0xf0),_0x590da3+=_0x5c3e46(0x22e)+_0x429083+_0x5c3e46(0xf0),_0x590da3+=_0x5c3e46(0xd5)+titanForWork[_0x5c3e46(0x13f)](_0x300228[_0x1ae94c][_0x5c3e46(0x191)])+_0x5c3e46(0x18c),_0x590da3+=_0x5c3e46(0x228)):(SharedTo='User',_0x590da3+=_0x5c3e46(0x1ff),_0x590da3+=_0x5c3e46(0x242)+_0x45c6d9+','+encodeURI(_0xa5d84)+','+_0x3fe8a6+','+_0x3a72aa+','+_0x16b134+','+_0x3cd681+','+SharedTo+_0x5c3e46(0x224)+_0x3fe8a6+'\x27\x27></td>',_0x300228[_0x1ae94c][_0x5c3e46(0xf1)]=='Everyone'?_0x590da3+='<td><div\x20class=\x27flexingtwo\x27><div\x20id=\x27profileImage\x27>'+_0x1799dd['charAt'](0x0)+'</div><div\x20class=\x27designationtype\x27>':_0x590da3+=_0x5c3e46(0xc4)+_0x2d5463+'\x27\x20data-themekey=\x27#\x27><div\x20class=\x27designationtype\x27>',_0x590da3+=_0x5c3e46(0x22f)+_0x1799dd+_0x5c3e46(0xe1),_0x590da3+=_0x5c3e46(0x159)+_0x87ce9f+'\x22);\x27>'+_0x87ce9f+_0x5c3e46(0xce),_0x590da3+=_0x5c3e46(0x22e)+_0x2a43bb+_0x5c3e46(0xf0),_0x590da3+=_0x5c3e46(0x22e)+titanForWork[_0x5c3e46(0x13f)](_0x300228[_0x1ae94c][_0x5c3e46(0x12a)])+_0x5c3e46(0xf0),_0x590da3+=_0x5c3e46(0x22e)+_0x300228[_0x1ae94c][_0x5c3e46(0xe0)][_0x5c3e46(0x209)]+_0x5c3e46(0xf0),_0x590da3+='<td>'+_0x51e825+_0x5c3e46(0xf0),_0x590da3+=_0x5c3e46(0x22e)+_0x429083+'</td>',_0x590da3+=_0x5c3e46(0x128)+_0x45c6d9+_0x5c3e46(0x1ba)+encodeURI(_0xa5d84)+_0x5c3e46(0x1ba)+_0x3fe8a6+_0x5c3e46(0x1ba)+_0x3a72aa+_0x5c3e46(0x173),_0x590da3+=_0x5c3e46(0x228));}else _0x93629=='Revoked'?(_0x590da3+=_0x5c3e46(0x1cc),_0x590da3+=_0x5c3e46(0x12b)+_0x300228[_0x1ae94c][_0x5c3e46(0x1dc)][_0x5c3e46(0x209)][_0x5c3e46(0x118)](0x0)+_0x5c3e46(0x10b),_0x590da3+=_0x5c3e46(0x217)+_0x300228[_0x1ae94c][_0x5c3e46(0x1dc)][_0x5c3e46(0x209)]+'</h3><p>Guest\x20Client</p></td>',_0x590da3+=_0x5c3e46(0x164)+_0x2a43bb+_0x5c3e46(0xf0),_0x590da3+=_0x5c3e46(0x22e)+titanForWork[_0x5c3e46(0x13f)](_0x300228[_0x1ae94c][_0x5c3e46(0x12a)])+_0x5c3e46(0xf0),_0x590da3+='<td>'+_0x300228[_0x1ae94c]['Author'][_0x5c3e46(0x209)]+_0x5c3e46(0xf0),_0x590da3+=_0x5c3e46(0x22e)+_0x51e825+'</td>',_0x590da3+=_0x5c3e46(0x22e)+_0x429083+'</td>',_0x590da3+='<td><div\x20class=\x27RevokedDetails\x27><span\x20style=\x27cursor:\x20not-allowed;color:\x20Red;\x27>Revoked</span><span>'+titanForWork[_0x5c3e46(0x13f)](_0x300228[_0x1ae94c][_0x5c3e46(0x191)])+_0x5c3e46(0x18c)):(SharedTo=_0x5c3e46(0xcc),_0x590da3+=_0x5c3e46(0x1ff),_0x590da3+='<td><input\x20type=\x27checkbox\x27\x20class=\x27historydocid\x27\x20value='+_0x45c6d9+','+encodeURI(_0xa5d84)+','+_0x3fe8a6+','+_0x3a72aa+','+_0x16b134+','+_0x3cd681+','+SharedTo+_0x5c3e46(0x224)+_0x3fe8a6+_0x5c3e46(0xca),_0x590da3+=_0x5c3e46(0x150)+_0x300228[_0x1ae94c]['SharedClient'][_0x5c3e46(0x209)][_0x5c3e46(0x118)](0x0)+_0x5c3e46(0x20e),_0x590da3+=_0x5c3e46(0x22f)+_0x300228[_0x1ae94c][_0x5c3e46(0x1dc)][_0x5c3e46(0x209)]+_0x5c3e46(0xe1),_0x590da3+=_0x5c3e46(0x21d),_0x590da3+=_0x5c3e46(0x22e)+_0x2a43bb+_0x5c3e46(0xf0),_0x590da3+='<td>'+titanForWork[_0x5c3e46(0x13f)](_0x300228[_0x1ae94c][_0x5c3e46(0x12a)])+_0x5c3e46(0xf0),_0x590da3+='<td>'+_0x300228[_0x1ae94c]['Author'][_0x5c3e46(0x209)]+_0x5c3e46(0xf0),_0x590da3+='<td>'+_0x51e825+_0x5c3e46(0xf0),_0x590da3+=_0x5c3e46(0x22e)+_0x429083+'</td>',_0x590da3+='<td><a\x20style=\x27cursor:\x20pointer;\x27\x20onclick=RevokeGpPermission(\x27'+_0x3fe8a6+_0x5c3e46(0x1ba)+_0x3a72aa+'\x27)>Revoke</a></td>',_0x590da3+=_0x5c3e46(0x228));}_0x300228['length']==0x0?$(_0x5c3e46(0xe6))['show']():$('.NoRecordFound')[_0x5c3e46(0x125)](),$(_0x5c3e46(0x1c2))[_0x5c3e46(0x1d6)](_0x590da3),$('#TotalItemscount')[_0x5c3e46(0x1c1)](_0x300228[_0x5c3e46(0x10e)]),_0x300228[_0x5c3e46(0x10e)]>0x0&&($('#shreduser')[_0x5c3e46(0x1d6)](_0x3d6ea2),TableConfiguration(),selectedHistoryDocEvent());}else $(_0x5c3e46(0xe6))[_0x5c3e46(0x1a9)](),$(_0x5c3e46(0x111))[_0x5c3e46(0x1c1)]('0');});}function RevokeGpPermission(_0x48ddc0,_0x520515,_0x22d46f){var _0x4fb346=_0x43aca4;$(_0x4fb346(0x1e2))['text']()[_0x4fb346(0x24d)](_0x4fb346(0x20f))==!![]&&$('#FilePath')[_0x4fb346(0x1c1)]()[_0x4fb346(0x24d)](_0x4fb346(0xfe))==![]&&$(_0x4fb346(0x1e2))[_0x4fb346(0x1c1)]($('#FilePath')[_0x4fb346(0x1c1)]()['replace'](_0x4fb346(0x20f),_0x4fb346(0xfe)));CopySourceURL!=_spPageContextInfo[_0x4fb346(0x179)]&&$[_0x4fb346(0x1f8)](GetFormDigestValue(CopySourceURL))[_0x4fb346(0x215)](function(_0x25fe1e){RequestDigest=_0x25fe1e;});var _0x39e7d3=CopySourceURL+'/_api/web/GetFileByServerRelativeUrl(\x27'+$(_0x4fb346(0x1e2))[_0x4fb346(0x1c1)]()+_0x4fb346(0x200)+_0x48ddc0+')';$[_0x4fb346(0xf2)]({'url':_0x39e7d3,'type':_0x4fb346(0x212),'async':![],'headers':{'X-RequestDigest':RequestDigest,'Accept':_0x4fb346(0x10a),'content-Type':_0x4fb346(0x10a),'X-HTTP-Method':_0x4fb346(0x245)},'async':![],'success':function(_0x5d8ca4){var _0x4f2c31=_0x4fb346;RequestDigest=$('#__REQUESTDIGEST')['val']();var _0x2ee92e=GetItemTypeForListName(_0x4f2c31(0x1f3));Metadata={'__metadata':{'type':_0x2ee92e},'PermissionStatus':_0x4f2c31(0x17d),'SharedEnd':new Date()['toISOString']()},$['when'](updateItemWithIDItemListDocuments(_0x4f2c31(0x1f3),Metadata,_0x520515,_spPageContextInfo[_0x4f2c31(0x179)],![]))[_0x4f2c31(0x215)](function(_0x55498c){var _0x1dce83=_0x4f2c31;return _0x22d46f!=![]&&(alert(_0x1dce83(0x119)),$(_0x1dce83(0x19f))['modal'](_0x1dce83(0x125))),![];});},'error':function(_0x254bb1){var _0x2a1ae6=_0x4fb346;RequestDigest=$(_0x2a1ae6(0x210))[_0x2a1ae6(0xf9)](),_0x254bb1['responseText'][_0x2a1ae6(0x24d)](_0x2a1ae6(0x108))==!![]?alert('You\x20don\x27t\x20have\x20the\x20required\x20permission\x20on\x20'+$('#FileName')[_0x2a1ae6(0x1c1)]()+'\x20to\x20perform\x20this\x20operation.'):alert(_0x254bb1[_0x2a1ae6(0xd9)][_0x2a1ae6(0x220)][_0x2a1ae6(0x166)][_0x2a1ae6(0x1f4)]);}});}var selectedHistoryDoc=[];function TableConfiguration(){var _0x251de4=_0x43aca4;sorter=new TINY[(_0x251de4(0x1f1))][(_0x251de4(0x1af))]('sorter','sharedHistoryTable',{'headclass':_0x251de4(0xea),'ascclass':_0x251de4(0x110),'descclass':_0x251de4(0x114),'evenclass':_0x251de4(0x198),'oddclass':'oddrow','evenselclass':_0x251de4(0xcf),'oddselclass':_0x251de4(0x11b),'paginate':!![],'size':0xa,'colddid':_0x251de4(0x250),'currentid':_0x251de4(0x11a),'totalid':_0x251de4(0x16f),'startingrecid':'startrecord','endingrecid':_0x251de4(0x160),'totalrecid':'totalrecords','hoverid':_0x251de4(0x115),'pageddid':'pagedropdown','navid':_0x251de4(0x175),'sortdir':0x1,'init':!![]});}function selectedHistoryDocEvent(){var _0x5da685=_0x43aca4;$(_0x5da685(0x1fb))[_0x5da685(0x135)](function(){var _0x5d5935=_0x5da685;selectedHistoryDoc=[],selectedHistoryDocrelativeurl=[],$(_0x5d5935(0x1fb))[_0x5d5935(0x1f5)](function(){var _0x11f071=_0x5d5935;$(this)[_0x11f071(0xd7)]('checked')==!![]&&selectedHistoryDoc[_0x11f071(0x1eb)]($(this)['val']());}),selectedHistoryDoc[_0x5d5935(0x10e)]==0x0?$('#revokebtn')[_0x5d5935(0x125)]():$(_0x5d5935(0xfb))[_0x5d5935(0x1a9)](),$('.historydocid:checked')[_0x5d5935(0x10e)]==$(_0x5d5935(0x1fb))[_0x5d5935(0x10e)]?$('.select_all')[_0x5d5935(0xd7)]('checked',!![]):$(_0x5d5935(0x183))[_0x5d5935(0xd7)](_0x5d5935(0x19a),![]);});}function RevokePermission(_0x5f10af,_0x35095d,_0xc41523,_0x75c1b1,_0x364142){var _0x1fc24a=_0x43aca4;CopySourceURL!=_spPageContextInfo[_0x1fc24a(0x179)]&&$['when'](GetFormDigestValue(CopySourceURL))[_0x1fc24a(0x215)](function(_0x29db16){RequestDigest=_0x29db16;});var _0x4e6166={'Accept':_0x1fc24a(0x10a),'content-Type':_0x1fc24a(0x10a),'X-RequestDigest':RequestDigest},_0x3780ef=CopySourceURL+'/_api/web/GetFileByServerRelativeUrl(\x27'+_0x35095d+_0x1fc24a(0xf5);$['ajax']({'url':_0x3780ef,'type':'POST','headers':_0x4e6166,'dataType':_0x1fc24a(0x14e),'success':function(_0x2927d4){var _0x36a0bd=_0x1fc24a;RequestDigest=$(_0x36a0bd(0x210))[_0x36a0bd(0xf9)](),DeleateUserPermission(_0xc41523,_0x35095d,_0x5f10af,_0x75c1b1,_0x36a0bd(0x213),0x0,0x0,_0x364142);},'error':function(_0x2dcccf){var _0x26fa49=_0x1fc24a;RequestDigest=$(_0x26fa49(0x210))[_0x26fa49(0xf9)](),console[_0x26fa49(0x19c)](JSON[_0x26fa49(0x141)](_0x2dcccf));}});}function DeleateUserPermission(_0x4b54ee,_0x4a2cfb,_0x5a9747,_0x3f3e8d,_0x194513,_0x3bcbcb,_0x34de84,_0x573bb9){var _0x939364=_0x43aca4;CopySourceURL!=_spPageContextInfo[_0x939364(0x179)]&&$[_0x939364(0x1f8)](GetFormDigestValue(CopySourceURL))[_0x939364(0x215)](function(_0x27f3ea){RequestDigest=_0x27f3ea;});var _0x42ffdf={'X-RequestDigest':RequestDigest,'X-HTTP-Method':_0x939364(0x245)},_0x4ca778=CopySourceURL+_0x939364(0x1ea)+_0x4a2cfb+_0x939364(0x200)+_0x4b54ee+')';$[_0x939364(0xf2)]({'url':_0x4ca778,'type':_0x939364(0x212),'headers':_0x42ffdf,'async':![],'success':function(_0x5f3543){var _0x4a232b=_0x939364;RequestDigest=$(_0x4a232b(0x210))['val']();var _0x1a8ddd=_0x4a232b(0x1f3),_0x4cfee1,_0x1a5bdb=GetItemTypeForListName(_0x1a8ddd);_0x4cfee1={'__metadata':{'type':_0x1a5bdb},'PermissionStatus':'Revoked','SharedEnd':new Date()[_0x4a232b(0x244)]()},$[_0x4a232b(0x1f8)](updateItemWithIDItemListDocuments(_0x1a8ddd,_0x4cfee1,_0x3f3e8d,_spPageContextInfo['webAbsoluteUrl']))[_0x4a232b(0x215)](function(_0x152f81){var _0x5ec09f=_0x4a232b;_0x573bb9!=![]&&alert(_0x5ec09f(0x23f)),$(_0x5ec09f(0x19f))['modal']('hide');}),console[_0x4a232b(0x19c)](_0x4b54ee+_0x4a232b(0x132));},'error':function(_0x25bd16){var _0x156dd8=_0x939364;RequestDigest=$(_0x156dd8(0x210))[_0x156dd8(0xf9)](),_0x25bd16[_0x156dd8(0x219)]['includes'](_0x156dd8(0x108))==!![]?alert(_0x156dd8(0x137)+$(_0x156dd8(0x1b0))[_0x156dd8(0x1c1)]()+_0x156dd8(0x20a)):alert(_0x25bd16['responseText']);}});}function RevokeOnCheckBox(){var _0x576f76=_0x43aca4;if(selectedHistoryDoc['length']>0x0){var _0x5eabd9=0x1;for(var _0x4e45e7=0x0;_0x4e45e7<selectedHistoryDoc['length'];_0x4e45e7++){var _0xe5fb39=selectedHistoryDoc[_0x4e45e7],_0x1ebb99=[];_0x1ebb99=_0xe5fb39['split'](','),_0x1ebb99[0x6]==_0x576f76(0x1b5)?RevokePermission(_0x1ebb99[0x0],_0x1ebb99[0x1],_0x1ebb99[0x2],_0x1ebb99[0x3],![]):RevokeGpPermission(_0x1ebb99[0x2],_0x1ebb99[0x3],![]);}return alert('Permissions\x20has\x20been\x20revoked.'),![];}else alert('Please\x20select\x20one\x20or\x20more\x20history\x20for\x20revoke.');}function getTargetRoleDefinitionId(){var _0x47bf92=_0x43aca4,_0x51d5f4=!![];return $[_0x47bf92(0xf2)]({'url':_spPageContextInfo[_0x47bf92(0x179)]+'/_api/web/roledefinitions/getbyname(\x27'+$(_0x47bf92(0x248))[_0x47bf92(0xf9)]()+_0x47bf92(0x240),'type':_0x47bf92(0x167),'async':![],'headers':{'accept':'application/json;odata=verbose'},'success':function(_0x34a800){targetRoleDefinitionId=_0x34a800['d']['Id'],_0x51d5f4=breakRoleInheritanceOfList(targetRoleDefinitionId);},'error':errorHandler}),_0x51d5f4;}function breakRoleInheritanceOfList(_0x3429b6){var _0xee0aa4=_0x43aca4,_0x4228ef=!![];CopySourceURL!=_spPageContextInfo['webAbsoluteUrl']&&$[_0xee0aa4(0x1f8)](GetFormDigestValue(CopySourceURL))['done'](function(_0x1f41f4){RequestDigest=_0x1f41f4;});var _0x2f9838={'Accept':_0xee0aa4(0x10a),'content-Type':_0xee0aa4(0x10a),'X-RequestDigest':RequestDigest};$('#FilePath')[_0xee0aa4(0x1c1)]()[_0xee0aa4(0x24d)](_0xee0aa4(0x20f))==!![]&&$(_0xee0aa4(0x1e2))[_0xee0aa4(0x1c1)]()['includes'](_0xee0aa4(0xfe))==![]&&$(_0xee0aa4(0x1e2))[_0xee0aa4(0x1c1)]($(_0xee0aa4(0x1e2))[_0xee0aa4(0x1c1)]()['replace'](_0xee0aa4(0x20f),_0xee0aa4(0xfe)));var _0x2e6081=CopySourceURL+_0xee0aa4(0x1ea)+$('#FilePath')[_0xee0aa4(0x1c1)]()+_0xee0aa4(0xf5);return $[_0xee0aa4(0xf2)]({'url':_0x2e6081,'type':_0xee0aa4(0x212),'headers':_0x2f9838,'async':![],'dataType':_0xee0aa4(0x14e),'success':function(_0x30f291){var _0x41f963=_0xee0aa4;RequestDigest=$('#__REQUESTDIGEST')[_0x41f963(0xf9)](),_0x4228ef=deleteCurrentRoleForGroup(_0x3429b6);},'error':function(_0x2c4c8e){var _0x4041ba=_0xee0aa4;RequestDigest=$(_0x4041ba(0x210))[_0x4041ba(0xf9)](),console[_0x4041ba(0x19c)](JSON[_0x4041ba(0x141)](_0x2c4c8e));}}),_0x4228ef;}function deleteCurrentRoleForGroup(_0x1a36f8){var _0x316bbd=_0x43aca4,_0x1263d3=!![];CopySourceURL!=_spPageContextInfo[_0x316bbd(0x179)]&&$[_0x316bbd(0x1f8)](GetFormDigestValue(CopySourceURL))['done'](function(_0x5777d6){RequestDigest=_0x5777d6;});for(var _0x502b97=0x0;_0x502b97<SharingUserEmail[_0x316bbd(0x10e)];_0x502b97++){if(SharingUserEmail[_0x502b97][_0x316bbd(0x223)]!=null&&SharingUserEmail[_0x502b97][_0x316bbd(0x223)]!=''&&SharingUserEmail[_0x502b97]['GroupId']!=_0x316bbd(0x231)&&SharingUserEmail[_0x502b97]['GroupId']!='null'){var _0x39e872=CopySourceURL+_0x316bbd(0x1ea)+$(_0x316bbd(0x1e2))['text']()+_0x316bbd(0x200)+SharingUserEmail[_0x502b97][_0x316bbd(0x223)]+')';$['ajax']({'url':_0x39e872,'type':'POST','async':![],'headers':{'X-RequestDigest':RequestDigest,'Accept':_0x316bbd(0x10a),'content-Type':_0x316bbd(0x10a),'X-HTTP-Method':'DELETE'},'async':![],'success':function(_0x52b477){var _0x572e82=_0x316bbd;_0x1263d3=!![],RequestDigest=$(_0x572e82(0x210))[_0x572e82(0xf9)](),setNewPermissionsForGroup(_0x1a36f8,parseInt(SharingUserEmail[_0x502b97][_0x572e82(0x223)]));},'error':function(_0xf3a10f){var _0x1b88da=_0x316bbd;RequestDigest=$(_0x1b88da(0x210))[_0x1b88da(0xf9)]();if(_0xf3a10f[_0x1b88da(0x219)][_0x1b88da(0x24d)](_0x1b88da(0x108))==!![])return alert('You\x20don\x27t\x20have\x20the\x20required\x20permission\x20on\x20'+$(_0x1b88da(0x1b0))[_0x1b88da(0x1c1)]()+_0x1b88da(0x20a)),![];else console['log'](_0xf3a10f['responseText']),setNewPermissionsForGroup(_0x1a36f8,parseInt(SharingUserEmail[_0x502b97][_0x1b88da(0x223)]));}});}}return _0x1263d3;}function setNewPermissionsForGroup(_0x514ec3,_0x39fab9){var _0x346c4a=_0x43aca4;CopySourceURL!=_spPageContextInfo[_0x346c4a(0x179)]&&$[_0x346c4a(0x1f8)](GetFormDigestValue(CopySourceURL))[_0x346c4a(0x215)](function(_0x2a611d){RequestDigest=_0x2a611d;});var _0x12c24e=CopySourceURL+_0x346c4a(0x1ea)+$(_0x346c4a(0x1e2))[_0x346c4a(0x1c1)]()+_0x346c4a(0x123)+_0x39fab9+_0x346c4a(0x1d0)+_0x514ec3+')';$['ajax']({'url':_0x12c24e,'type':_0x346c4a(0x212),'async':![],'headers':{'X-RequestDigest':RequestDigest},'success':successHandler,'error':errorHandler});}function successHandler(){RequestDigest=$('#__REQUESTDIGEST')['val']();}function errorHandler(_0x4859b4,_0x4e7359,_0xd1088b){var _0x5e7736=_0x43aca4;return RequestDigest=$(_0x5e7736(0x210))['val'](),_0x4859b4[_0x5e7736(0x219)][_0x5e7736(0x24d)](_0x5e7736(0x108))==!![]?(alert(_0x5e7736(0x137)+$(_0x5e7736(0x1b0))[_0x5e7736(0x1c1)]()+_0x5e7736(0x20a)),![]):(alert(_0x4859b4['responseText']),![]);}function myShareDepartmentCopy(){var _0x422395=_0x43aca4,_0x552e9b='',_0xc962b4=_0x422395(0x1aa)+Logged_CompanyId+'\x27\x20and\x20ContributorsId\x20eq\x20\x27'+_spPageContextInfo['userId']+'\x27\x20and\x20WebPartName\x20eq\x20\x27DepartmentDocument_Access\x27)\x20or\x20(CompanyId\x20eq\x20\x27'+Logged_CompanyId+_0x422395(0x171)+_spPageContextInfo[_0x422395(0xc9)]+_0x422395(0x134);$[_0x422395(0x1f8)](getItemsWithQuery(_0x422395(0x205),_0xc962b4))[_0x422395(0x215)](function(_0x41e66c){var _0x1da7f0=_0x422395;_0x552e9b+='<tr><td><div\x20class=\x22checkbox\x20m-0\x22><label><input\x20class=\x22DocLib\x22\x20name=\x22Library\x22\x20type=\x22radio\x22\x20value=\x22\x22></label></div></td>',_0x552e9b+=_0x1da7f0(0x149);var _0x8eb93f=getDepartmentURL(Logged_DepartmentId);_0x8eb93f=_0x8eb93f+_0x1da7f0(0x251),_0x552e9b+=_0x1da7f0(0x1a3),_0x552e9b+=_0x1da7f0(0x1a2),_0x552e9b+=_0x1da7f0(0x11d)+_0x8eb93f+'>'+Logged_DepartmentName+_0x1da7f0(0x1a5),$[_0x1da7f0(0x1f5)](_0x41e66c,function(_0x541f40,_0x31041f){var _0x48c7ed=_0x1da7f0,_0x763b32=getDepartmentURL(_0x31041f[_0x48c7ed(0x127)]['ID']);_0x763b32=_0x763b32+'/DepartmentalDMS/Forms/AllItems.aspx',_0x552e9b+=_0x48c7ed(0x20b)+_0x541f40+_0x48c7ed(0x15c),_0x552e9b+=_0x48c7ed(0x1a2),_0x552e9b+='<td\x20class=\x22text-left\x22><a\x20href=javascript:void(0)\x20style=\x22cursor:text;color:black;\x22\x20name\x20=\x20'+_0x763b32+'>'+_0x31041f[_0x48c7ed(0x127)]['DepartmentName']+_0x48c7ed(0x1a5);}),$(_0x1da7f0(0x169))['append'](_0x552e9b),BindProjectsCopy();});}function BindProjectsCopy(){var _0x14d8a6=_0x43aca4,_0x58b8cb='',_0x5b6211=[],_0x52afe5=_0x14d8a6(0x246)+Logged_CompanyId+'\x27\x20and\x20TeamMemberId\x20eq\x20\x27'+_spPageContextInfo[_0x14d8a6(0xc9)]+_0x14d8a6(0x247);$[_0x14d8a6(0x1f8)](getItemsWithQuery(_0x14d8a6(0x21a),_0x52afe5))[_0x14d8a6(0x215)](function(_0x57495b){var _0x33a248=_0x14d8a6;$['each'](_0x57495b,function(_0x4ea9b2,_0x2b2406){var _0x195d89=_0x3e39;if(_0x5b6211[_0x195d89(0x17c)](_0x2b2406[_0x195d89(0x1cb)]['Id'])==-0x1){var _0x428ce9=getProjectDMS(_0x2b2406[_0x195d89(0x1cb)]['Id']);_0x5b6211[_0x195d89(0x1eb)](_0x2b2406[_0x195d89(0x1cb)]['Id']),_0x58b8cb+=_0x195d89(0x23a)+_0x4ea9b2+_0x195d89(0x15c),_0x58b8cb+=_0x195d89(0x193),_0x58b8cb+=_0x195d89(0xfd)+_0x428ce9+'>'+_0x2b2406['Project']['ProjectName']+_0x195d89(0x1a5);}}),$(_0x33a248(0x169))[_0x33a248(0x1d6)](_0x58b8cb);}),getGuestClientsCopy();}function getGuestClientsCopy(){var _0x4e60ab=_0x43aca4,_0x5c3b0a='',_0x41d24e='?$select=Id,Title,IsActive,CompanyID/Id,DocumentLibrary,InternalMembers/EMail,InternalSupervisor/EMail&$orderby=Title\x20asc&$expand=CompanyID,InternalMembers,InternalSupervisor&$top=5000&$filter=DocumentLibrary\x20ne\x20null\x20and\x20IsActive\x20eq\x20\x271\x27\x20and\x20InternalMembers/EMail\x20eq\x20\x27'+_spPageContextInfo['userEmail']+_0x4e60ab(0x116)+_spPageContextInfo[_0x4e60ab(0x1d7)]+'\x27\x20';$[_0x4e60ab(0x1f8)](getItemsWithQuery(_0x4e60ab(0x1a0),_0x41d24e))['done'](function(_0x48a4ff){var _0x135bb0=_0x4e60ab;if(_0x48a4ff['length']>0x0)for(var _0x21b775=0x0;_0x21b775<_0x48a4ff[_0x135bb0(0x10e)];_0x21b775++){var _0xf1cfac=_0x48a4ff[_0x21b775];_0xf1cfac['DocumentLibrary']!=null&&(_0x5c3b0a+='<tr><td><div\x20class=\x22checkbox\x20m-0\x22><label><input\x20class=\x22DocLib\x22\x20name=\x22Library\x22\x20type=\x22radio\x22\x20id=\x22chkClientMaster'+_0x21b775+'\x22\x20value=\x22\x22></label></div></td>',_0x5c3b0a+=_0x135bb0(0x144),_0x5c3b0a+=_0x135bb0(0xfd)+_0xf1cfac[_0x135bb0(0x20c)]+'>'+_0xf1cfac[_0x135bb0(0x209)]+_0x135bb0(0x1a5));}$(_0x135bb0(0x169))['append'](_0x5c3b0a);}),getCustomDMSCopy();}function getCustomDMSCopy(){var _0x20110e=_0x43aca4,_0x570290='',_0x2a056f=_0x20110e(0x199)+_spPageContextInfo[_0x20110e(0xc9)]+_0x20110e(0x247);$[_0x20110e(0x1f8)](getItemsWithQuery(_0x20110e(0x20d),_0x2a056f))[_0x20110e(0x215)](function(_0x34c40b){var _0x2ae133=_0x20110e;if(_0x34c40b[_0x2ae133(0x10e)]>0x0){for(var _0x11ab27=0x0;_0x11ab27<_0x34c40b[_0x2ae133(0x10e)];_0x11ab27++){_0x34c40b[_0x11ab27][_0x2ae133(0x24a)]==_0x2ae133(0x235)&&(_0x570290+='<tr><td><div\x20class=\x22checkbox\x20m-0\x22><label><input\x20class=\x22DocLib\x22\x20name=\x22Library\x22\x20type=\x22radio\x22\x20id=\x22chkPersonalDMS'+_0x11ab27+_0x2ae133(0x15c),_0x570290+=_0x2ae133(0x249),_0x570290+=_0x2ae133(0xfd)+_0x34c40b[_0x11ab27][_0x2ae133(0xe8)]+'>'+_0x34c40b[_0x11ab27][_0x2ae133(0x209)]+'</a></td></tr>');}$(_0x2ae133(0x169))['append'](_0x570290);}});}function getTreeView(_0x3a4032){var _0x3df163=_0x43aca4,_0x6e70eb='',_0x47eca7='',_0x430b4f='',_0x109df3='';if(_0x3a4032[_0x3df163(0x233)][0x1]['innerHTML']=='My\x20Documents')_0x6e70eb=_spPageContextInfo[_0x3df163(0x179)],_0x430b4f=_0x3df163(0xe5)+_spPageContextInfo[_0x3df163(0x1d7)]+'/',_0x47eca7=_0x3df163(0x153),_0x109df3=_0x3df163(0x1da);else{var _0x1b868a=_0x3a4032['cells'][0x2][_0x3df163(0x1fd)][_0x3df163(0x1e1)]('name=\x22')[0x1][_0x3df163(0x1e1)]('\x22>')[0x0];const _0xb1ce6f=_0x1b868a['split'](_0x3df163(0x13a))[0x0];_0x6e70eb=_0xb1ce6f[_0x3df163(0x112)](0x0,_0xb1ce6f[_0x3df163(0x1b4)]('/'));;_0x430b4f=_0xb1ce6f[_0x3df163(0x1e1)]('/')[_0xb1ce6f['split']('/')['length']-0x1]+'/',_0x430b4f==_0x3df163(0x1e7)&&(_0x430b4f=_0x3df163(0x11e)),_0x47eca7=_0x430b4f[_0x3df163(0x1a4)](0x0,_0x430b4f[_0x3df163(0x10e)]-0x1),_0x109df3=_0x3a4032[_0x3df163(0x233)][0x1]['innerHTML']+'\x20:\x20'+_0x3a4032[_0x3df163(0x233)][0x2][_0x3df163(0x1fd)]['split'](_0x3df163(0x24b))[0x1][_0x3df163(0x1e1)]('\x22>')[0x1][_0x3df163(0x1e1)]('</a>')[0x0];}bindTreeView(_0x6e70eb,_0x430b4f,_0x47eca7,_0x109df3);}function bindTreeView(_0x279a02,_0x12dd4c,_0x2a9d61,_0x11541d){var _0x4ef680=_0x43aca4;$(_0x4ef680(0x188))['empty'](),$(_0x4ef680(0xe2))[_0x4ef680(0x1c1)](_0x11541d);var _0xfa7c42='',_0x418c66=_0x279a02+_0x4ef680(0x201)+_0x12dd4c+_0x4ef680(0x17a);$['ajax']({'url':_0x418c66,'type':'GET','headers':{'accept':_0x4ef680(0x10a)},'async':![],'success':function(_0x19fc53){var _0x327ce0=_0x4ef680,_0x11a124=_0x19fc53['d'][_0x327ce0(0xf8)][_0x327ce0(0x232)];if(_0x11a124[_0x327ce0(0x10e)]>0x0){_0xfa7c42+=_0x327ce0(0x22a),_0xfa7c42+=_0x327ce0(0x154)+_0x279a02+_0x327ce0(0x238)+_0x12dd4c+_0x327ce0(0x238)+_0x2a9d61+'\x27);\x22\x20href=\x22javascript:void(0);\x22>Root</a>',_0xfa7c42+=_0x327ce0(0x22a);for(var _0x33ace7=0x0;_0x33ace7<_0x11a124[_0x327ce0(0x10e)];_0x33ace7++){_0x11a124[_0x33ace7]['Name']!=_0x327ce0(0xe3)&&(_0xfa7c42+=_0x327ce0(0x230)+_0x11a124[_0x33ace7][_0x327ce0(0x18f)]['Id']+_0x327ce0(0xeb)+_0x279a02+'\x27,\x20\x27'+_0x12dd4c+_0x11a124[_0x33ace7][_0x327ce0(0x1e4)]+_0x327ce0(0x238)+_0x2a9d61+'\x27);\x22\x20href=\x22javascript:void(0);\x22>'+_0x11a124[_0x33ace7]['Name']+_0x327ce0(0x121),_0xfa7c42+=_0x327ce0(0x22a),_0xfa7c42+=BindSubFolders(_0x279a02,_0x12dd4c+_0x11a124[_0x33ace7][_0x327ce0(0x1e4)]+'/',_0x2a9d61),_0xfa7c42+=_0x327ce0(0xf6),_0xfa7c42+=_0x327ce0(0x1b3));}_0xfa7c42+=_0x327ce0(0xf6),_0xfa7c42+=_0x327ce0(0xf6),$('.treesec')[_0x327ce0(0x1d6)](_0xfa7c42);}else _0xfa7c42+=_0x327ce0(0x22a),_0xfa7c42+=_0x327ce0(0x154)+_0x279a02+_0x327ce0(0x238)+_0x12dd4c+_0x327ce0(0x238)+_0x2a9d61+_0x327ce0(0x23e),_0xfa7c42+='<ul></ul></ul>',$(_0x327ce0(0x188))['append'](_0xfa7c42);}})[_0x4ef680(0x206)](function(_0x3c7617){var _0x3401a3=_0x4ef680;_0xfa7c42+=_0x3401a3(0x207),$('.treesec')[_0x3401a3(0x1d6)](_0xfa7c42),$(_0x3401a3(0x10d))[_0x3401a3(0x125)]();}),$('#txtPleaseWait')[_0x4ef680(0x125)]();}function BindSubFolders(_0x5f0978,_0x5256d6,_0x312ec0){var _0x59e137=_0x43aca4;try{var _0x40724d='',_0x5eaa4e=_0x5f0978+_0x59e137(0x201)+_0x5256d6+_0x59e137(0x17a);return $[_0x59e137(0xf2)]({'url':_0x5eaa4e,'type':'GET','headers':{'accept':'application/json;odata=verbose'},'async':![],'success':function(_0x291012){var _0x3f7851=_0x59e137,_0xbfb75=_0x291012['d']['Folders']['results'];if(_0xbfb75[_0x3f7851(0x10e)]>0x0){_0x40724d+=_0x3f7851(0x22a);for(var _0x312a92=0x0;_0x312a92<_0xbfb75[_0x3f7851(0x10e)];_0x312a92++){_0xbfb75[_0x312a92][_0x3f7851(0x1e4)]!='Forms'&&(_0x40724d+=_0x3f7851(0x230)+_0xbfb75[_0x312a92][_0x3f7851(0x18f)]['Id']+'\x22><a\x20class=\x22DmsTree\x22\x20onclick=\x22ClickFolder(this,\x20\x27'+_0x5f0978+'\x27,\x20\x27'+_0x5256d6+_0xbfb75[_0x312a92][_0x3f7851(0x1e4)]+_0x3f7851(0x238)+_0x312ec0+_0x3f7851(0x214)+_0xbfb75[_0x312a92][_0x3f7851(0x1e4)]+'</a>',_0x40724d+=_0x3f7851(0x22a),_0x40724d+=BindSubFolders(_0x5f0978,_0x5256d6+_0xbfb75[_0x312a92][_0x3f7851(0x1e4)]+'/',_0x312ec0),_0x40724d+=_0x3f7851(0xf6),_0x40724d+='</li>');}_0x40724d+='</ul>';}}}),_0x40724d;}catch(_0x47d8e0){alert(_0x47d8e0[_0x59e137(0x166)]),$(_0x59e137(0x10d))[_0x59e137(0x125)]();}}var CopyLibrary='';function ClickFolder(_0x15aa76,_0xacb563,_0x4e6c59,_0xc80ade){var _0xbfb24a=_0x43aca4;CopyDestURL=_0xacb563,CopyFolderName=_0x4e6c59;if(CopyFolderName['indexOf'](_0xbfb24a(0xfe))!=-0x1)CopyFolderName=CopyFolderName[_0xbfb24a(0x202)](_0xbfb24a(0xfe),_0xbfb24a(0x20f));else CopyFolderName[_0xbfb24a(0x17c)](_0xbfb24a(0x1b6))!=-0x1&&(CopyFolderName=CopyFolderName[_0xbfb24a(0x202)](_0xbfb24a(0x1b6),_0xbfb24a(0x20f)));$(_0xbfb24a(0x13b))[_0xbfb24a(0x1ae)]({'text-shadow':''}),$(_0x15aa76)[_0xbfb24a(0x1ae)](_0xbfb24a(0x147),'2px\x200px\x205px\x20#1e90ff');}function copyFile(){var _0x434670=_0x43aca4,_0x3bd96b=CopySourceURL,_0x37a51e=CopyDestURL,_0x5e08fb=new SP[(_0x434670(0x1c4))](_0x3bd96b),_0x3e8eb2=new SP['RequestExecutor'](_0x37a51e),_0x13f7f4=$('#FilePath')[_0x434670(0x1c1)](),_0x478575=_0x3bd96b+_0x434670(0x1ea)+_0x13f7f4+_0x434670(0x10f),_0x375f88=_0x37a51e,_0x4e83d9=$(_0x434670(0x1b0))[_0x434670(0x1c1)](),_0x24e7cc=_0x375f88+_0x434670(0x117)+encodeURIComponent(CopyFolderName)+'\x27)/Files/Add(url=\x27'+_0x4e83d9+_0x434670(0x1be);$[_0x434670(0xf2)]({'url':_0x375f88+_0x434670(0x176),'type':_0x434670(0x212),'headers':{'Accept':_0x434670(0x10a)},'success':function(_0x166f1e){var _0x160769=_0x434670,_0x1e6074=_0x166f1e['d'][_0x160769(0x177)][_0x160769(0x124)];_0x478575[_0x160769(0x17c)](_0x160769(0x20f))!=-0x1&&(_0x478575=_0x478575[_0x160769(0x202)](_0x160769(0x20f),_0x160769(0x1b6)));var _0x574757={'url':_0x478575,'method':_0x160769(0x167),'binaryStringResponseBody':!![],'success':function(_0x25e621){var _0x9a6783=_0x160769,_0x436548=_0x166f1e[_0x9a6783(0x133)];_0x24e7cc[_0x9a6783(0x17c)](_0x9a6783(0x20f))!=-0x1&&(_0x24e7cc=_0x24e7cc[_0x9a6783(0x202)]('Documents',_0x9a6783(0x1b6)));$[_0x9a6783(0x1f8)](GetFormDigestValue(_0x375f88))[_0x9a6783(0x215)](function(_0x5b675d){RequestDigest=_0x5b675d;});var _0x279d9c={'url':_0x24e7cc,'method':_0x9a6783(0x212),'headers':{'Accept':_0x9a6783(0x105),'X-RequestDigest':RequestDigest},'contentType':_0x9a6783(0x10a),'binaryStringRequestBody':!![],'body':_0x25e621['body'],'success':function(_0x5e5add){var _0x5ab929=_0x9a6783;RequestDigest=$(_0x5ab929(0x210))['val'](),$(_0x5ab929(0x1d4))[_0x5ab929(0x1c5)](_0x5ab929(0x180)),$(_0x5ab929(0x241))['attr'](_0x5ab929(0x19a),![]),$('#copymove')[_0x5ab929(0x1d8)](_0x5ab929(0x125)),IsMoving==!![]?DeleteFileFromSource(''):(alert(_0x5ab929(0x24f)),CopyDestURL='',CopyFolderName='');},'error':function(_0xb29c5e){var _0x3fd98b=_0x9a6783;return RequestDigest=$(_0x3fd98b(0x210))[_0x3fd98b(0xf9)](),_0xb29c5e[_0x3fd98b(0x133)][_0x3fd98b(0x24d)](_0x3fd98b(0xd2))==!![]?(alert('You\x20don\x27t\x20have\x20the\x20required\x20permission\x20to\x20perform\x20this\x20operation.'),![]):(alert(_0xb29c5e['body']),![]);}};_0x3e8eb2[_0x9a6783(0x12e)](_0x279d9c);},'error':function(_0xe6b670){var _0x4ac78f=_0x160769;return RequestDigest=$(_0x4ac78f(0x210))[_0x4ac78f(0xf9)](),_0xe6b670[_0x4ac78f(0x133)][_0x4ac78f(0x24d)](_0x4ac78f(0xd2))==!![]?(alert(_0x4ac78f(0xff)),![]):(alert(_0xe6b670[_0x4ac78f(0x133)]),![]);}};_0x5e08fb[_0x160769(0x12e)](_0x574757);},'error':function(_0x25f159){var _0x429f19=_0x434670;return _0x25f159['body'][_0x429f19(0x24d)](_0x429f19(0xd2))==!![]?(alert(_0x429f19(0xff)),![]):(alert(_0x25f159[_0x429f19(0x133)]),![]);}});}function DeleteFileFromSource(_0x3a1382){var _0x509a1c=_0x43aca4;$[_0x509a1c(0x1f8)](GetFormDigestValue(CopySourceURL))['done'](function(_0x1511e2){RequestDigest=_0x1511e2;}),$['ajax']({'url':CopySourceURL+_0x509a1c(0x145)+CopyLibrary+_0x509a1c(0x181)+DocumentId+'\x27)','type':_0x509a1c(0x212),'async':![],'headers':{'X-RequestDigest':RequestDigest,'IF-MATCH':'*','X-HTTP-Method':_0x509a1c(0x245)},'success':function(_0x8fef6,_0xfb316e,_0xe9c631){var _0x5bd58a=_0x509a1c;RequestDigest=$(_0x5bd58a(0x210))[_0x5bd58a(0xf9)](),$('#ModalDisplayProperty')['modal'](_0x5bd58a(0x125)),CopyLibrary='',CopyDestURL='',CopyFolderName='',_0x3a1382==_0x5bd58a(0xee)?alert(_0x5bd58a(0x243)):alert(_0x5bd58a(0xd8));},'error':function(_0x3bf3a0,_0x1a27a7,_0x1391b0){var _0x26665a=_0x509a1c;return RequestDigest=$(_0x26665a(0x210))[_0x26665a(0xf9)](),_0x3bf3a0[_0x26665a(0x219)][_0x26665a(0x24d)](_0x26665a(0xd2))==!![]?(alert(_0x26665a(0xff)),![]):(alert(_0x3bf3a0[_0x26665a(0x219)]),![]);}});}function TreeStructure(){var _0x4840b0=_0x43aca4;$['fn']['filetree']=function(_0x5a8f66){var _0x1026b2=_0x3e39,_0x9d428f={'collapsed':!![],'console':![]},_0x133cbf={'init':function(_0x560d98){var _0x184178=_0x3e39,_0x560d98=$[_0x184178(0x11f)](_0x9d428f,_0x560d98);return this[_0x184178(0x1f5)](function(){var _0x4f4a6c=_0x184178,_0x5ae447=$(this);_0x5ae447[_0x4f4a6c(0x1e0)](_0x4f4a6c(0x12d))[_0x4f4a6c(0x1b8)]('li')[_0x4f4a6c(0x1e0)](_0x4f4a6c(0x131))['on'](_0x4f4a6c(0x180),'a[href=\x22#\x22]',function(_0x58f979){var _0x3cd43e=_0x4f4a6c;return _0x58f979['preventDefault'](),$(this)['parent']()[_0x3cd43e(0x122)](_0x3cd43e(0xd0))[_0x3cd43e(0x122)]('open'),![];});});}};if(typeof _0x5a8f66==='object'||!_0x5a8f66)return _0x133cbf[_0x1026b2(0x1d5)][_0x1026b2(0x1dd)](this,arguments);else $['on'](_0x1026b2(0x220),function(){var _0x570744=_0x1026b2;console[_0x570744(0x19c)](_0x5a8f66+_0x570744(0x1bb));});},waitingDialog[_0x4840b0(0x125)]();}