var a329_0x223a7a=a329_0x2d2e;(function(_0x4965dd,_0x4891bb){var _0x316b18=a329_0x2d2e,_0x151c93=_0x4965dd();while(!![]){try{var _0x15f087=parseInt(_0x316b18(0x1f1))/0x1+-parseInt(_0x316b18(0x239))/0x2+-parseInt(_0x316b18(0x1de))/0x3*(parseInt(_0x316b18(0x256))/0x4)+parseInt(_0x316b18(0x24f))/0x5+-parseInt(_0x316b18(0x1c2))/0x6*(parseInt(_0x316b18(0x29a))/0x7)+parseInt(_0x316b18(0x292))/0x8+-parseInt(_0x316b18(0x28f))/0x9*(-parseInt(_0x316b18(0x213))/0xa);if(_0x15f087===_0x4891bb)break;else _0x151c93['push'](_0x151c93['shift']());}catch(_0x52facc){_0x151c93['push'](_0x151c93['shift']());}}}(a329_0x3996,0x2490e));var GloblListId='',GloblSiteurl='',table,getFileDetails=[],itemsShareWithme=[],RestQuery,path='',AddDocumentLib,linkDocumentLib,IsMyDocument=![],withoutLastChunk,Documentname,RequestDigest=$(a329_0x223a7a(0x276))[a329_0x223a7a(0x1f8)](),IsShareDocumnet=![],ShareAllItemswithFolder=[],txtContent='',txtTitle='',folderpath='';$(document)[a329_0x223a7a(0x2aa)](function(){var _0x34482e=a329_0x223a7a;console['log'](_0x34482e(0x2a0)),GetCatogeryName();}),$(function(_0x2fa5da){var _0x261829=a329_0x223a7a;_0x2fa5da(_0x261829(0x1e9))[_0x261829(0x201)](function(){var _0x43daa2=_0x261829;_0x2fa5da[_0x43daa2(0x241)]({'type':_0x43daa2(0x210),'beforeSend':function(){var _0x1f3839=_0x43daa2;if(_0x2fa5da(_0x1f3839(0x259))[_0x1f3839(0x1c0)]>0x0)_0x2fa5da(_0x1f3839(0x20d))[_0x1f3839(0x20c)](),getFileDetails=[],GenrateHtmlGrid(getFileDetails);else return alert(_0x1f3839(0x29f)),![];},'success':function(_0x112bce){var _0x3b1915=_0x43daa2;console[_0x3b1915(0x1af)](_0x112bce),executeSearch();}})['done'](function(){});});});function executeSearch(){var _0x35dbfc=a329_0x223a7a;try{txtContent=$(_0x35dbfc(0x21a))[_0x35dbfc(0x1f8)]()[_0x35dbfc(0x204)](),txtTitle=$(_0x35dbfc(0x261))['val']()[_0x35dbfc(0x204)](),AddDocumentLib='',$('#chkShareWithme')[_0x35dbfc(0x294)]('checked')==!![]&&SharewithMe(),$(_0x35dbfc(0x259))['each'](function(){var _0x557dd6=_0x35dbfc,_0x183bd2=$(this)[_0x557dd6(0x250)]('tr')[0x0];IsShareDocumnet=![];if(_0x183bd2[_0x557dd6(0x23d)][0x1][_0x557dd6(0x1b4)]==_0x557dd6(0x1ea))return;if(_0x183bd2['cells'][0x1][_0x557dd6(0x1b4)]==_0x557dd6(0x1dc)){IsMyDocument=!![],IsShareDocumnet=![];var _0x4af793=_spPageContextInfo['webAbsoluteUrl']+_0x557dd6(0x207);GetListId(_0x4af793),AddDocumentLib=_0x183bd2[_0x557dd6(0x23d)][0x1][_0x557dd6(0x1b4)];}else{if($(_0x557dd6(0x26d))==!![]){IsShareDocumnet=!![],IsMyDocument=![];if(ShareAllItemswithFolder[_0x557dd6(0x1c0)]==0x0){itemsShareWithme=GetDocumentsSharedWithMeSearch('SharedWithMe'),itemsShareWithme=removeDuplicates(itemsShareWithme),console[_0x557dd6(0x1af)]('StartLoop');var _0x5d056='';for(var _0x4884d8=0x0;_0x4884d8<itemsShareWithme[_0x557dd6(0x1c0)];_0x4884d8++){console['log'](itemsShareWithme[_0x4884d8][_0x557dd6(0x297)]),_0x5d056=_0x4884d8;if(itemsShareWithme[_0x4884d8][_0x557dd6(0x200)][_0x557dd6(0x29b)]()==_0x557dd6(0x1d4)){console['log'](itemsShareWithme[_0x4884d8]['DocumentURL']),RequestDigest=$(_0x557dd6(0x276))[_0x557dd6(0x1f8)]();itemsShareWithme[_0x4884d8][_0x557dd6(0x22b)]!=_spPageContextInfo[_0x557dd6(0x1ff)]&&$['when'](GetFormDigestValue(itemsShareWithme[_0x4884d8][_0x557dd6(0x22b)]))[_0x557dd6(0x1fa)](function(_0x58a6a2){RequestDigest=_0x58a6a2;});var _0x511f40=itemsShareWithme[_0x4884d8][_0x557dd6(0x297)],_0x43670b=itemsShareWithme[_0x4884d8][_0x557dd6(0x22b)],_0x4b0867=itemsShareWithme[_0x4884d8]['LibraryName'];$[_0x557dd6(0x295)](getItemsWithQueryUsersDocuments(_0x511f40,_0x43670b))[_0x557dd6(0x1fa)](function(_0x5c70d8){var _0x23375e=_0x557dd6;for(var _0x5770a8=0x0;_0x5770a8<_0x5c70d8[_0x23375e(0x1c8)][_0x23375e(0x2a1)][_0x23375e(0x1c0)];_0x5770a8++){console[_0x23375e(0x1af)](_0x5c70d8[_0x23375e(0x1c8)][_0x23375e(0x2a1)][_0x5770a8][_0x23375e(0x293)]),ShareAllItemswithFolder[_0x23375e(0x28a)]({'Path':_0x5c70d8[_0x23375e(0x1c8)][_0x23375e(0x2a1)][_0x5770a8]['ServerRelativeUrl'],'FileExtension':_0x5c70d8[_0x23375e(0x1c8)][_0x23375e(0x2a1)][_0x5770a8][_0x23375e(0x293)][_0x23375e(0x234)]('.')[0x1],'Author':_0x5c70d8[_0x23375e(0x1c8)][_0x23375e(0x2a1)][_0x5770a8][_0x23375e(0x1c4)]['DocumentWrittenBy']==null?'':_0x5c70d8[_0x23375e(0x1c8)][_0x23375e(0x2a1)][_0x5770a8][_0x23375e(0x1c4)][_0x23375e(0x283)],'Size':_0x5c70d8[_0x23375e(0x1c8)][_0x23375e(0x2a1)][_0x5770a8][_0x23375e(0x1d8)],'Name':_0x5c70d8[_0x23375e(0x1c8)][_0x23375e(0x2a1)][_0x5770a8][_0x23375e(0x293)],'Title':_0x5c70d8[_0x23375e(0x1c8)][_0x23375e(0x2a1)][_0x5770a8][_0x23375e(0x225)]==null||_0x5c70d8['Files']['results'][_0x5770a8][_0x23375e(0x225)]==''?_0x5c70d8[_0x23375e(0x1c8)][_0x23375e(0x2a1)][_0x5770a8][_0x23375e(0x293)][_0x23375e(0x234)]('.')[0x0]:_0x5c70d8[_0x23375e(0x1c8)]['results'][_0x5770a8]['Title'],'DocumentNo':_0x5c70d8[_0x23375e(0x1c8)][_0x23375e(0x2a1)][_0x5770a8]['ListItemAllFields'][_0x23375e(0x270)]==null?'':_0x5c70d8['Files']['results'][_0x5770a8]['ListItemAllFields'][_0x23375e(0x270)],'Details':_0x5c70d8[_0x23375e(0x1c8)]['results'][_0x5770a8]['ListItemAllFields'][_0x23375e(0x27e)],'DocumentType':_0x5c70d8[_0x23375e(0x1c8)]['results'][_0x5770a8][_0x23375e(0x1c4)]['DocumentType']==null?'':_0x5c70d8['Files'][_0x23375e(0x2a1)][_0x5770a8][_0x23375e(0x1c4)][_0x23375e(0x200)],'LastModifiedTime':_0x5c70d8[_0x23375e(0x1c8)][_0x23375e(0x2a1)][_0x5770a8][_0x23375e(0x26e)],'Library':_0x4b0867,'ServerUrl':_0x43670b,'SubCategory':_0x5c70d8[_0x23375e(0x1c8)][_0x23375e(0x2a1)][_0x5770a8][_0x23375e(0x1c4)][_0x23375e(0x21c)]==null?'':_0x5c70d8[_0x23375e(0x1c8)][_0x23375e(0x2a1)][_0x5770a8][_0x23375e(0x1c4)][_0x23375e(0x21c)],'FileVersion':DocumentsubFolderfiles[_0x23375e(0x1cf)]['results'][_0x5770a8][_0x23375e(0x230)]==_0x23375e(0x203)?'1.0':parseInt(DocumentsubFolderfiles[_0x23375e(0x1cf)][_0x23375e(0x2a1)][_0x5770a8]['UIVersionLabel'])-0x1+'.0'});}for(var _0x1888db=0x0;_0x1888db<_0x5c70d8['Folders'][_0x23375e(0x2a1)][_0x23375e(0x1c0)];_0x1888db++){console[_0x23375e(0x1af)](_0x5c70d8['Folders'][_0x23375e(0x2a1)][_0x1888db][_0x23375e(0x293)]),$[_0x23375e(0x295)](getItemsWithQueryUsersDocuments(_0x5c70d8[_0x23375e(0x277)]['results'][_0x1888db]['ServerRelativeUrl'],_0x43670b))['done'](function(_0x10346a){var _0x49c055=_0x23375e;for(var _0x11c667=0x0;_0x11c667<_0x10346a[_0x49c055(0x1c8)][_0x49c055(0x2a1)][_0x49c055(0x1c0)];_0x11c667++){console[_0x49c055(0x1af)](_0x10346a[_0x49c055(0x1c8)][_0x49c055(0x2a1)][_0x11c667]['Name']),ShareAllItemswithFolder[_0x49c055(0x28a)]({'Path':_0x10346a[_0x49c055(0x1c8)]['results'][_0x11c667][_0x49c055(0x288)],'FileExtension':_0x10346a[_0x49c055(0x1c8)][_0x49c055(0x2a1)][_0x11c667][_0x49c055(0x293)][_0x49c055(0x234)]('.')[0x1],'Author':_0x10346a[_0x49c055(0x1c8)][_0x49c055(0x2a1)][_0x11c667][_0x49c055(0x1c4)][_0x49c055(0x283)]==null?'':_0x10346a[_0x49c055(0x1c8)][_0x49c055(0x2a1)][_0x11c667]['ListItemAllFields']['DocumentWrittenBy'],'Size':_0x10346a[_0x49c055(0x1c8)]['results'][_0x11c667][_0x49c055(0x1d8)],'Name':_0x10346a[_0x49c055(0x1c8)]['results'][_0x11c667][_0x49c055(0x293)],'Title':_0x10346a['Files'][_0x49c055(0x2a1)][_0x11c667][_0x49c055(0x225)]==null||_0x10346a['Files'][_0x49c055(0x2a1)][_0x11c667][_0x49c055(0x225)]==''?_0x10346a[_0x49c055(0x1c8)][_0x49c055(0x2a1)][_0x11c667][_0x49c055(0x293)][_0x49c055(0x234)]('.')[0x0]:_0x10346a[_0x49c055(0x1c8)][_0x49c055(0x2a1)][_0x11c667][_0x49c055(0x225)],'DocumentNo':_0x10346a['Files'][_0x49c055(0x2a1)][_0x11c667][_0x49c055(0x1c4)]['DocumentNo']==null?'':_0x10346a['Files']['results'][_0x11c667][_0x49c055(0x1c4)]['DocumentNo'],'Details':_0x10346a[_0x49c055(0x1c8)][_0x49c055(0x2a1)][_0x11c667][_0x49c055(0x1c4)][_0x49c055(0x27e)],'DocumentType':_0x10346a[_0x49c055(0x1c8)]['results'][_0x11c667][_0x49c055(0x1c4)][_0x49c055(0x200)]==null?'':_0x10346a[_0x49c055(0x1c8)][_0x49c055(0x2a1)][_0x11c667][_0x49c055(0x1c4)]['DocumentType'],'LastModifiedTime':_0x10346a[_0x49c055(0x1c8)][_0x49c055(0x2a1)][_0x11c667]['TimeLastModified'],'Library':_0x4b0867,'ServerUrl':_0x43670b,'SubCategory':_0x10346a[_0x49c055(0x1c8)][_0x49c055(0x2a1)][_0x11c667][_0x49c055(0x1c4)][_0x49c055(0x21c)]==null?'':_0x10346a[_0x49c055(0x1c8)]['results'][_0x11c667]['ListItemAllFields'][_0x49c055(0x21c)],'FileVersion':_0x10346a[_0x49c055(0x1cf)]['results'][_0x11c667][_0x49c055(0x230)]==_0x49c055(0x203)?_0x49c055(0x203):parseInt(_0x10346a[_0x49c055(0x1cf)][_0x49c055(0x2a1)][_0x11c667][_0x49c055(0x230)])-0x1+'.0'});}for(var _0x11c667=0x0;_0x11c667<_0x10346a[_0x49c055(0x277)][_0x49c055(0x2a1)][_0x49c055(0x1c0)];_0x11c667++){_0x5c70d8[_0x49c055(0x277)]['results'][_0x49c055(0x28a)](_0x10346a[_0x49c055(0x277)][_0x49c055(0x2a1)][_0x11c667]);}});}});}console['log'](_0x5d056+_0x557dd6(0x1a6));}}}else{var _0x18c038=_0x183bd2[_0x557dd6(0x23d)][0x2][_0x557dd6(0x1b4)];IsMyDocument=![],IsShareDocumnet=![],linkDocumentLib=_0x18c038[_0x557dd6(0x234)]('name=\x22')[0x1][_0x557dd6(0x234)]('\x22>')[0x0],GetListId(linkDocumentLib),AddDocumentLib=_0x183bd2[_0x557dd6(0x23d)][0x1][_0x557dd6(0x1b4)]+'\x20:\x20'+_0x18c038['split']('name=\x22')[0x1]['split']('\x22>')[0x1][_0x557dd6(0x234)]('</a>')[0x0];}}if(txtContent!=''){SPSearchResults={'element':'','url':'','init':function(_0x49f390){var _0x3bbb14=_0x557dd6;SPSearchResults['element']=_0x49f390,IsShareDocumnet?SPSearchResults[_0x3bbb14(0x1a9)]=GloblSiteurl+'/_api/search/query?querytext=\x20\x27'+txtContent+_0x3bbb14(0x275)+txtTitle+_0x3bbb14(0x20a):SPSearchResults[_0x3bbb14(0x1a9)]=GloblSiteurl+_0x3bbb14(0x28c)+txtContent+_0x3bbb14(0x2a9)+GloblListId+'),IsDocument:(true),Title:('+txtTitle+_0x3bbb14(0x20a);},'load':function(){var _0x5efb13=_0x557dd6;$[_0x5efb13(0x241)]({'url':SPSearchResults[_0x5efb13(0x1a9)],'method':_0x5efb13(0x210),'async':![],'headers':{'accept':_0x5efb13(0x1b3)},'success':SPSearchResults['onSuccess'],'error':SPSearchResults[_0x5efb13(0x2a6)]});},'onSuccess':function(_0xc51c0f){var _0x90f76e=_0x557dd6,_0x404e32=_0xc51c0f['d'][_0x90f76e(0x1c6)][_0x90f76e(0x25f)][_0x90f76e(0x264)][_0x90f76e(0x215)][_0x90f76e(0x23e)][_0x90f76e(0x2a1)];for(var _0x482f40=0x0;_0x482f40<_0x404e32[_0x90f76e(0x1c0)];_0x482f40++){var _0xf73b24=_0x404e32[_0x482f40][_0x90f76e(0x2a4)][_0x90f76e(0x2a1)][0x0]['Value'];if(_0xf73b24['toLowerCase']()[_0x90f76e(0x1ee)](_0x90f76e(0x269)+_spPageContextInfo[_0x90f76e(0x1df)]['toLowerCase']())>=0x0&&IsMyDocument==!![]){RestQuery='?$orderby=Id\x20desc\x20&$select=*,Author/Title\x20&$expand=File,File/Author/Title,\x20Author,File/ListItemAllFields\x20&$filter=FileLeafRef\x20eq\x20\x27'+_0x404e32[_0x482f40]['Cells'][_0x90f76e(0x2a1)][0x0][_0x90f76e(0x205)][_0x90f76e(0x234)]('/')[_0x404e32[_0x482f40][_0x90f76e(0x2a4)][_0x90f76e(0x2a1)][0x0][_0x90f76e(0x205)][_0x90f76e(0x234)]('/')[_0x90f76e(0x1c0)]-0x1]+'\x27\x20';var _0x1b920b=GetFileDetails(RestQuery,'DocumentManagementSystem',withoutLastChunk);for(var _0x513833=0x0;_0x513833<_0x1b920b[_0x90f76e(0x1c0)];_0x513833++){_0x1b920b[_0x513833][_0x90f76e(0x1cf)][_0x90f76e(0x288)]['toLowerCase']()[_0x90f76e(0x1ee)](_0x90f76e(0x269)+_spPageContextInfo['userLoginName'][_0x90f76e(0x29b)]())>=0x0&&(folderpath=_0x1b920b[_0x513833][_0x90f76e(0x1cf)][_0x90f76e(0x288)][_0x90f76e(0x234)](_0x90f76e(0x1c9)+_spPageContextInfo['userEmail'])[0x1][_0x90f76e(0x254)](0x0,_0x1b920b[_0x513833][_0x90f76e(0x1cf)][_0x90f76e(0x288)]['split'](_0x90f76e(0x1c9)+_spPageContextInfo['userEmail'])[0x1][_0x90f76e(0x1dd)]('/')));}if($(_0x90f76e(0x1d2))[_0x90f76e(0x1f8)]()!=''&&$(_0x90f76e(0x28e))[_0x90f76e(0x1f8)]()!=_0x90f76e(0x1f3)){var _0x1d2bac=_0x1b920b['filter'](function(_0x3a90db){var _0x29db92=_0x90f76e;return _0x3a90db[_0x29db92(0x270)][_0x29db92(0x29b)]()[_0x29db92(0x211)]($(_0x29db92(0x1d2))[_0x29db92(0x1f8)]()[_0x29db92(0x29b)]())&&_0x3a90db[_0x29db92(0x200)][_0x29db92(0x29b)]()[_0x29db92(0x211)]($('#ddlDocumentType\x20option:selected')[_0x29db92(0x1f8)]()[_0x29db92(0x29b)]());});_0x1d2bac[_0x90f76e(0x1c0)]>0x0&&getFileDetails['push']({'Path':_0x1d2bac[0x0]['File']['ServerRelativeUrl'],'FolderPath':folderpath,'FileExtension':_0x1d2bac[0x0]['File'][_0x90f76e(0x293)]['split']('.')[0x1],'Author':_0x1d2bac[0x0]['File']['Author'][_0x90f76e(0x225)],'Size':_0x1d2bac[0x0][_0x90f76e(0x1cf)][_0x90f76e(0x1d8)],'Name':_0x1d2bac[0x0][_0x90f76e(0x1cf)]['Name'],'Title':_0x1d2bac[0x0]['File'][_0x90f76e(0x225)]==null||_0x1d2bac[0x0][_0x90f76e(0x1cf)]['Title']==''?_0x1d2bac[0x0][_0x90f76e(0x1cf)][_0x90f76e(0x293)][_0x90f76e(0x234)]('.')[0x0]:_0x1d2bac[0x0]['File']['Title'],'DocumentNo':_0x1d2bac[0x0][_0x90f76e(0x270)],'Details':_0x1d2bac[0x0]['Details'],'DocumentType':_0x1d2bac[0x0][_0x90f76e(0x200)],'LastModifiedTime':_0x1d2bac[0x0][_0x90f76e(0x1cf)][_0x90f76e(0x26e)],'Library':AddDocumentLib,'ServerUrl':withoutLastChunk,'SubCategory':_0x1d2bac[0x0]['SubCategory']==null?'':_0x1d2bac[0x0][_0x90f76e(0x21c)],'FileVersion':_0x1d2bac[0x0][_0x90f76e(0x1cf)][_0x90f76e(0x230)]==_0x90f76e(0x203)?_0x90f76e(0x203):parseInt(_0x1d2bac[0x0][_0x90f76e(0x1cf)][_0x90f76e(0x230)])-0x1+'.0'});}else{if($(_0x90f76e(0x1d2))[_0x90f76e(0x1f8)]()!='')_0x1b920b[0x0][_0x90f76e(0x270)]!=null&&(_0x1b920b[0x0]['DocumentNo'][_0x90f76e(0x1ee)]($('#txtReference')['val']())>=0x0&&getFileDetails[_0x90f76e(0x28a)]({'Path':_0x1b920b[0x0][_0x90f76e(0x1cf)][_0x90f76e(0x288)],'FolderPath':folderpath,'FileExtension':_0x1b920b[0x0]['File'][_0x90f76e(0x293)][_0x90f76e(0x234)]('.')[0x1],'Author':_0x1b920b[0x0][_0x90f76e(0x1cf)][_0x90f76e(0x27a)][_0x90f76e(0x225)],'Size':_0x1b920b[0x0][_0x90f76e(0x1cf)][_0x90f76e(0x1d8)],'Name':_0x1b920b[0x0][_0x90f76e(0x1cf)][_0x90f76e(0x293)],'Title':_0x1b920b[0x0][_0x90f76e(0x1cf)][_0x90f76e(0x225)]==null||_0x1b920b[0x0][_0x90f76e(0x1cf)]['Title']==''?_0x1b920b[0x0]['File']['Name'][_0x90f76e(0x234)]('.')[0x0]:_0x1b920b[0x0][_0x90f76e(0x1cf)][_0x90f76e(0x225)],'DocumentNo':_0x1b920b[0x0][_0x90f76e(0x270)],'Details':_0x1b920b[0x0]['Details'],'DocumentType':_0x1b920b[0x0]['DocumentType'],'LastModifiedTime':_0x1b920b[0x0]['File'][_0x90f76e(0x26e)],'Library':AddDocumentLib,'ServerUrl':withoutLastChunk,'SubCategory':_0x1b920b[0x0][_0x90f76e(0x21c)]==null?'':_0x1b920b[0x0]['SubCategory'],'FileVersion':_0x1b920b[0x0][_0x90f76e(0x1cf)][_0x90f76e(0x230)]==_0x90f76e(0x203)?_0x90f76e(0x203):parseInt(_0x1b920b[0x0][_0x90f76e(0x1cf)]['UIVersionLabel'])-0x1+'.0'}));else $(_0x90f76e(0x28e))[_0x90f76e(0x1f8)]()!='ALL'?_0x1b920b[0x0][_0x90f76e(0x200)]!=null&&(_0x1b920b[0x0][_0x90f76e(0x200)][_0x90f76e(0x1ee)]($(_0x90f76e(0x28e))[_0x90f76e(0x1f8)]())>=0x0&&getFileDetails[_0x90f76e(0x28a)]({'Path':_0x1b920b[0x0]['File'][_0x90f76e(0x288)],'FolderPath':folderpath,'FileExtension':_0x1b920b[0x0]['File'][_0x90f76e(0x293)][_0x90f76e(0x234)]('.')[0x1],'Author':_0x1b920b[0x0][_0x90f76e(0x1cf)][_0x90f76e(0x27a)][_0x90f76e(0x225)],'Size':_0x1b920b[0x0][_0x90f76e(0x1cf)][_0x90f76e(0x1d8)],'Name':_0x1b920b[0x0][_0x90f76e(0x1cf)][_0x90f76e(0x293)],'Title':_0x1b920b[0x0]['File'][_0x90f76e(0x225)]==null||_0x1b920b[0x0][_0x90f76e(0x1cf)]['Title']==''?_0x1b920b[0x0][_0x90f76e(0x1cf)][_0x90f76e(0x293)][_0x90f76e(0x234)]('.')[0x0]:_0x1b920b[0x0][_0x90f76e(0x1cf)][_0x90f76e(0x225)],'DocumentNo':_0x1b920b[0x0][_0x90f76e(0x270)],'Details':_0x1b920b[0x0][_0x90f76e(0x27e)],'DocumentType':_0x1b920b[0x0][_0x90f76e(0x200)],'LastModifiedTime':_0x1b920b[0x0][_0x90f76e(0x1cf)][_0x90f76e(0x26e)],'Library':AddDocumentLib,'ServerUrl':withoutLastChunk,'SubCategory':_0x1b920b[0x0][_0x90f76e(0x21c)]==null?'':_0x1b920b[0x0]['SubCategory'],'FileVersion':_0x1b920b[0x0]['File'][_0x90f76e(0x230)]=='1.0'?_0x90f76e(0x203):parseInt(_0x1b920b[0x0][_0x90f76e(0x1cf)][_0x90f76e(0x230)])-0x1+'.0'})):getFileDetails[_0x90f76e(0x28a)]({'Path':_0x1b920b[0x0][_0x90f76e(0x1cf)][_0x90f76e(0x288)],'FolderPath':folderpath,'FileExtension':_0x1b920b[0x0][_0x90f76e(0x1cf)][_0x90f76e(0x293)][_0x90f76e(0x234)]('.')[0x1],'Author':_0x1b920b[0x0]['File'][_0x90f76e(0x27a)]['Title'],'Size':_0x1b920b[0x0]['File'][_0x90f76e(0x1d8)],'Name':_0x1b920b[0x0][_0x90f76e(0x1cf)]['Name'],'Title':_0x1b920b[0x0]['File'][_0x90f76e(0x225)]==null||_0x1b920b[0x0][_0x90f76e(0x1cf)][_0x90f76e(0x225)]==''?_0x1b920b[0x0][_0x90f76e(0x1cf)]['Name']['split']('.')[0x0]:_0x1b920b[0x0]['File'][_0x90f76e(0x225)],'DocumentNo':_0x1b920b[0x0][_0x90f76e(0x270)],'Details':_0x1b920b[0x0][_0x90f76e(0x27e)],'DocumentType':_0x1b920b[0x0][_0x90f76e(0x200)],'LastModifiedTime':_0x1b920b[0x0]['File'][_0x90f76e(0x26e)],'Library':AddDocumentLib,'ServerUrl':withoutLastChunk,'SubCategory':_0x1b920b[0x0]['SubCategory']==null?'':_0x1b920b[0x0][_0x90f76e(0x21c)],'FileVersion':_0x1b920b[0x0][_0x90f76e(0x1cf)][_0x90f76e(0x230)]==_0x90f76e(0x203)?_0x90f76e(0x203):parseInt(_0x1b920b[0x0][_0x90f76e(0x1cf)][_0x90f76e(0x230)])-0x1+'.0'});}}else{if(IsMyDocument==![]){var _0x1b920b='';if(itemsShareWithme[_0x90f76e(0x1c0)]>0x0&&IsShareDocumnet==!![]){var _0x4969a6=itemsShareWithme[_0x90f76e(0x24a)](function(_0x1df8fb){var _0x21d280=_0x90f76e,_0x3c5c5b=window['origin']+_0x1df8fb['DocumentURL'];return _0xf73b24[_0x21d280(0x29b)]()==_0x3c5c5b[_0x21d280(0x29b)]();});_0x4969a6['length']>0x0&&(_0x1b920b='',RequestDigest=$(_0x90f76e(0x276))[_0x90f76e(0x1f8)](),_0x4969a6[0x0][_0x90f76e(0x22b)]!=_spPageContextInfo[_0x90f76e(0x1ff)]&&$[_0x90f76e(0x295)](GetFormDigestValue(_0x4969a6[0x0][_0x90f76e(0x22b)]))[_0x90f76e(0x1fa)](function(_0x53166a){RequestDigest=_0x53166a;}),RestQuery='&$filter=Id\x20eq\x20\x27'+_0x4969a6[0x0][_0x90f76e(0x212)]['ID']+'\x27',_0x1b920b=GetFileDetails(_0x90f76e(0x21b)+RestQuery,_0x4969a6[0x0][_0x90f76e(0x226)],_0x4969a6[0x0][_0x90f76e(0x22b)]),folderpath=_0x1b920b[0x0]['File'][_0x90f76e(0x288)][_0x90f76e(0x234)](_0x4969a6[0x0][_0x90f76e(0x226)])[0x1]['substr'](0x0,_0x1b920b[0x0]['File'][_0x90f76e(0x288)][_0x90f76e(0x234)](_0x4969a6[0x0][_0x90f76e(0x226)]+'/')[0x1][_0x90f76e(0x1dd)]('/')),_0x1b920b!=undefined&&getFileDetails['push']({'Path':_0x1b920b[0x0]['File'][_0x90f76e(0x288)],'FolderPath':folderpath,'FileExtension':_0x1b920b[0x0][_0x90f76e(0x1cf)][_0x90f76e(0x293)][_0x90f76e(0x234)]('.')[0x1],'Author':_0x1b920b[0x0][_0x90f76e(0x283)]==null?'':_0x1b920b[0x0][_0x90f76e(0x283)],'Size':_0x1b920b[0x0][_0x90f76e(0x1cf)]['Length'],'Name':_0x1b920b[0x0]['File'][_0x90f76e(0x293)],'Title':_0x1b920b[0x0][_0x90f76e(0x1cf)]['Title']==null||_0x1b920b[0x0][_0x90f76e(0x1cf)][_0x90f76e(0x225)]==''?_0x1b920b[0x0][_0x90f76e(0x1cf)][_0x90f76e(0x293)][_0x90f76e(0x234)]('.')[0x0]:_0x1b920b[0x0]['File'][_0x90f76e(0x225)],'DocumentNo':_0x1b920b[0x0][_0x90f76e(0x270)]==null?'':_0x1b920b[0x0]['DocumentNo'],'Details':_0x1b920b[0x0][_0x90f76e(0x27e)],'DocumentType':_0x1b920b[0x0][_0x90f76e(0x200)]==null?'':_0x1b920b[0x0]['DocumentType'],'LastModifiedTime':_0x1b920b[0x0]['File'][_0x90f76e(0x26e)],'Library':_0x4969a6[0x0][_0x90f76e(0x226)],'ServerUrl':_0x4969a6[0x0][_0x90f76e(0x22b)],'SubCategory':_0x1b920b[0x0][_0x90f76e(0x21c)]==null?'':_0x1b920b[0x0]['SubCategory'],'FileVersion':_0x1b920b[0x0]['File'][_0x90f76e(0x230)]=='1.0'?_0x90f76e(0x203):parseInt(_0x1b920b[0x0]['File']['UIVersionLabel'])-0x1+'.0'}));var _0x3bcd39=ShareAllItemswithFolder[_0x90f76e(0x24a)](function(_0x3dd36f){var _0x5c393e=_0x90f76e,_0x5afde1=window[_0x5c393e(0x1d9)]+_0x3dd36f['Path'];return _0xf73b24['toLowerCase']()==_0x5afde1[_0x5c393e(0x29b)]();});_0x3bcd39[_0x90f76e(0x1c0)]>0x0&&(getFileDetails=getFileDetails[_0x90f76e(0x233)](_0x3bcd39));if(txtTitle!=''){var _0x434e80=txtTitle[_0x90f76e(0x1ac)]();getFileDetails=getFileDetails[_0x90f76e(0x24a)](_0xf25925=>_0xf25925['Title']['toString']()[_0x90f76e(0x211)](_0x434e80));}$('#txtReference')[_0x90f76e(0x1f8)]()!=''&&(getFileDetails=getFileDetails[_0x90f76e(0x24a)](_0x3c44c7=>_0x3c44c7['DocumentNo'][_0x90f76e(0x211)]($(_0x90f76e(0x1d2))['val']()))),$(_0x90f76e(0x28e))[_0x90f76e(0x1f8)]()!='ALL'&&(getFileDetails=getFileDetails[_0x90f76e(0x24a)](_0xd5b127=>_0xd5b127[_0x90f76e(0x200)]['includes']($(_0x90f76e(0x28e))[_0x90f76e(0x1f8)]())));}else{RestQuery=_0x90f76e(0x24d)+_0x404e32[_0x482f40]['Cells'][_0x90f76e(0x2a1)][0x0]['Value'][_0x90f76e(0x234)]('/')[_0x404e32[_0x482f40][_0x90f76e(0x2a4)][_0x90f76e(0x2a1)][0x0]['Value']['split']('/')[_0x90f76e(0x1c0)]-0x1]+'\x27\x20',_0x1b920b=GetFileDetails(RestQuery,Documentname,withoutLastChunk);if(_0x1b920b!=undefined)for(var _0xef33cc=0x0;_0xef33cc<_0x1b920b[_0x90f76e(0x1c0)];_0xef33cc++){folderpath=_0x1b920b[_0xef33cc]['File']['ServerRelativeUrl'][_0x90f76e(0x234)](Documentname)[0x1]['substr'](0x0,_0x1b920b[_0xef33cc]['File']['ServerRelativeUrl']['split'](Documentname+'/')[0x1]['lastIndexOf']('/')),getFileDetails[_0x90f76e(0x28a)]({'Path':_0x1b920b[_0xef33cc][_0x90f76e(0x1cf)][_0x90f76e(0x288)],'FolderPath':folderpath,'FileExtension':_0x1b920b[_0xef33cc][_0x90f76e(0x1cf)][_0x90f76e(0x293)]['split']('.')[0x1],'Author':_0x1b920b[_0xef33cc][_0x90f76e(0x1cf)][_0x90f76e(0x27a)]['Title'],'Size':_0x1b920b[_0xef33cc][_0x90f76e(0x1cf)][_0x90f76e(0x1d8)],'Name':_0x1b920b[_0xef33cc][_0x90f76e(0x1cf)][_0x90f76e(0x293)],'Title':_0x1b920b[_0xef33cc]['File'][_0x90f76e(0x225)]==null||_0x1b920b[_0xef33cc][_0x90f76e(0x1cf)][_0x90f76e(0x225)]==''?_0x1b920b[_0xef33cc][_0x90f76e(0x1cf)][_0x90f76e(0x293)]['split']('.')[0x0]:_0x1b920b[_0xef33cc][_0x90f76e(0x1cf)][_0x90f76e(0x225)],'DocumentNo':_0x1b920b[_0xef33cc]['DocumentNo'],'Details':_0x1b920b[_0xef33cc][_0x90f76e(0x27e)],'DocumentType':_0x1b920b[_0xef33cc]['DocumentType'],'LastModifiedTime':_0x1b920b[_0xef33cc][_0x90f76e(0x1cf)][_0x90f76e(0x26e)],'Library':AddDocumentLib,'ServerUrl':withoutLastChunk,'SubCategory':_0x1b920b[_0xef33cc]['SubCategory']==null?'':_0x1b920b[_0xef33cc][_0x90f76e(0x21c)],'FileVersion':_0x1b920b[_0xef33cc][_0x90f76e(0x1cf)]['UIVersionLabel']=='1.0'?_0x90f76e(0x203):parseInt(_0x1b920b[_0xef33cc]['File'][_0x90f76e(0x230)])-0x1+'.0'});}}}}}},'onError':function(_0x313458){var _0x4d0f7b=_0x557dd6;$(_0x4d0f7b(0x237))[_0x4d0f7b(0x2a5)](_0x4d0f7b(0x262)+JSON[_0x4d0f7b(0x28d)](_0x313458));}},SPSearchResults[_0x557dd6(0x287)]($('#searchResults')),SPSearchResults[_0x557dd6(0x260)](),RestQuery='&$filter=\x20';var _0x391fc1=![];txtTitle!=''&&(_0x391fc1=!![],RestQuery+=_0x557dd6(0x1d1)+txtTitle+_0x557dd6(0x1bb)+txtTitle+'\x27,Title)\x20'),$('#txtReference')[_0x557dd6(0x1f8)]()!=''&&(_0x391fc1?RestQuery+=_0x557dd6(0x1cc)+$(_0x557dd6(0x1d2))['val']()+_0x557dd6(0x27b):(RestQuery+='substringof(\x27'+$('#txtReference')[_0x557dd6(0x1f8)]()+_0x557dd6(0x27b),_0x391fc1=!![])),$(_0x557dd6(0x28e))['val']()!=_0x557dd6(0x1f3)&&(_0x391fc1?(RestQuery+=_0x557dd6(0x1f9)+$(_0x557dd6(0x28e))[_0x557dd6(0x1f8)]()+'\x27',_0x391fc1=![]):RestQuery+=_0x557dd6(0x1e8)+$(_0x557dd6(0x28e))[_0x557dd6(0x1f8)]()+'\x27');}else{debugger;RestQuery='&$filter=\x20';var _0x391fc1=![];txtTitle!=''&&(_0x391fc1=!![],RestQuery+=_0x557dd6(0x1d1)+txtTitle+_0x557dd6(0x1bb)+txtTitle+_0x557dd6(0x23a));$(_0x557dd6(0x1d2))[_0x557dd6(0x1f8)]()!=''&&(_0x391fc1?RestQuery+='and\x20substringof(\x27'+$('#txtReference')[_0x557dd6(0x1f8)]()+_0x557dd6(0x27b):(RestQuery+=_0x557dd6(0x1d1)+$(_0x557dd6(0x1d2))[_0x557dd6(0x1f8)]()+_0x557dd6(0x27b),_0x391fc1=!![]));$(_0x557dd6(0x28e))[_0x557dd6(0x1f8)]()!=_0x557dd6(0x1f3)&&(_0x391fc1?(RestQuery+='and\x20DocumentType\x20eq\x20\x27'+$('#ddlDocumentType\x20option:selected')[_0x557dd6(0x1f8)]()+'\x27',_0x391fc1=![]):RestQuery+='DocumentType\x20eq\x20\x27'+$(_0x557dd6(0x28e))[_0x557dd6(0x1f8)]()+'\x27');var _0x391765='';if(itemsShareWithme['length']>0x0&&IsShareDocumnet==!![]){}else{_0x391765=GetFileDetails(_0x557dd6(0x1d0)+RestQuery,Documentname,withoutLastChunk),folderpath=_0x391765[0x0][_0x557dd6(0x1cf)][_0x557dd6(0x288)][_0x557dd6(0x234)](Documentname)[0x1]['substr'](0x0,_0x391765[0x0][_0x557dd6(0x1cf)][_0x557dd6(0x288)][_0x557dd6(0x234)](Documentname+'/')[0x1][_0x557dd6(0x1dd)]('/'));if(_0x391765!=undefined)for(var _0x4884d8=0x0;_0x4884d8<_0x391765['length'];_0x4884d8++){var _0x37d649=_0x391765[_0x4884d8][_0x557dd6(0x1cf)][_0x557dd6(0x288)];if(_0x37d649!=undefined){if(_0x37d649[_0x557dd6(0x29b)]()['search']('/documentmanagementsystem/'+_spPageContextInfo[_0x557dd6(0x1df)][_0x557dd6(0x29b)]())>=0x0&&IsMyDocument==!![])getFileDetails[_0x557dd6(0x28a)]({'Path':_0x391765[_0x4884d8][_0x557dd6(0x1cf)][_0x557dd6(0x288)],'FolderPath':folderpath,'FileExtension':_0x391765[_0x4884d8]['File'][_0x557dd6(0x293)][_0x557dd6(0x234)]('.')[0x1],'Author':_0x391765[_0x4884d8][_0x557dd6(0x1cf)][_0x557dd6(0x27a)][_0x557dd6(0x225)],'Size':_0x391765[_0x4884d8][_0x557dd6(0x1cf)][_0x557dd6(0x1d8)],'Name':_0x391765[_0x4884d8][_0x557dd6(0x1cf)][_0x557dd6(0x293)],'Title':_0x391765[_0x4884d8][_0x557dd6(0x1cf)][_0x557dd6(0x225)]==null||_0x391765[_0x4884d8][_0x557dd6(0x1cf)][_0x557dd6(0x225)]==''?_0x391765[_0x4884d8]['File'][_0x557dd6(0x293)]['split']('.')[0x0]:_0x391765[_0x4884d8][_0x557dd6(0x1cf)]['Title'],'DocumentNo':_0x391765[_0x4884d8][_0x557dd6(0x270)]==null?'':_0x391765[_0x4884d8][_0x557dd6(0x270)],'Details':_0x391765[_0x4884d8][_0x557dd6(0x27e)],'DocumentType':_0x391765[_0x4884d8][_0x557dd6(0x200)]==null?'':_0x391765[_0x4884d8][_0x557dd6(0x200)],'LastModifiedTime':_0x391765[_0x4884d8]['File']['TimeLastModified'],'Library':AddDocumentLib,'ServerUrl':withoutLastChunk,'SubCategory':_0x391765[_0x4884d8]['SubCategory']==null?'':_0x391765[_0x4884d8][_0x557dd6(0x21c)],'FileVersion':_0x391765[_0x4884d8][_0x557dd6(0x1cf)]['UIVersionLabel']==_0x557dd6(0x203)?'1.0':parseInt(_0x391765[_0x4884d8][_0x557dd6(0x1cf)][_0x557dd6(0x230)])-0x1+'.0'});else IsMyDocument==![]&&getFileDetails[_0x557dd6(0x28a)]({'Path':_0x391765[_0x4884d8][_0x557dd6(0x1cf)]['ServerRelativeUrl'],'FolderPath':folderpath,'FileExtension':_0x391765[_0x4884d8][_0x557dd6(0x1cf)][_0x557dd6(0x293)][_0x557dd6(0x234)]('.')[0x1],'Author':_0x391765[_0x4884d8]['File'][_0x557dd6(0x27a)][_0x557dd6(0x225)],'Size':_0x391765[_0x4884d8][_0x557dd6(0x1cf)][_0x557dd6(0x1d8)],'Name':_0x391765[_0x4884d8][_0x557dd6(0x1cf)][_0x557dd6(0x293)],'Title':_0x391765[_0x4884d8][_0x557dd6(0x1cf)][_0x557dd6(0x225)]==null||_0x391765[_0x4884d8][_0x557dd6(0x1cf)]['Title']==''?_0x391765[_0x4884d8][_0x557dd6(0x1cf)][_0x557dd6(0x293)][_0x557dd6(0x234)]('.')[0x0]:_0x391765[_0x4884d8]['File']['Title'],'DocumentNo':_0x391765[_0x4884d8][_0x557dd6(0x270)]==null?'':_0x391765[_0x4884d8][_0x557dd6(0x270)],'Details':_0x391765[_0x4884d8]['Details'],'DocumentType':_0x391765[_0x4884d8][_0x557dd6(0x200)]==null?'':_0x391765[_0x4884d8][_0x557dd6(0x200)],'LastModifiedTime':_0x391765[_0x4884d8][_0x557dd6(0x1cf)]['TimeLastModified'],'Library':AddDocumentLib,'ServerUrl':withoutLastChunk,'SubCategory':_0x391765[_0x4884d8][_0x557dd6(0x21c)]==null?'':_0x391765[_0x4884d8]['SubCategory'],'FileVersion':_0x391765[_0x4884d8][_0x557dd6(0x1cf)][_0x557dd6(0x230)]==_0x557dd6(0x203)?'1.0':parseInt(_0x391765[_0x4884d8]['File'][_0x557dd6(0x230)])-0x1+'.0'});}}}}}),GenrateHtmlGrid(getFileDetails),$('#overlaysearch')[_0x35dbfc(0x247)]();}catch(_0x2574fb){$('#overlaysearch')['fadeOut'](),console[_0x35dbfc(0x1af)](_0x2574fb),alert(_0x35dbfc(0x209));}}function SharewithMe(){var _0x19b1e4=a329_0x223a7a;IsShareDocumnet=!![],IsMyDocument=![];if(ShareAllItemswithFolder['length']==0x0){itemsShareWithme=GetDocumentsSharedWithMeSearch('SharedWithMe'),itemsShareWithme=removeDuplicates(itemsShareWithme);var _0x229345='';for(var _0x420615=0x0;_0x420615<itemsShareWithme['length'];_0x420615++){console[_0x19b1e4(0x1af)](itemsShareWithme[_0x420615][_0x19b1e4(0x297)]),_0x229345=_0x420615;if(itemsShareWithme[_0x420615][_0x19b1e4(0x200)][_0x19b1e4(0x29b)]()==_0x19b1e4(0x1d4)){console[_0x19b1e4(0x1af)](itemsShareWithme[_0x420615]['DocumentURL']),RequestDigest=$(_0x19b1e4(0x276))[_0x19b1e4(0x1f8)]();itemsShareWithme[_0x420615][_0x19b1e4(0x22b)]!=_spPageContextInfo[_0x19b1e4(0x1ff)]&&$[_0x19b1e4(0x295)](GetFormDigestValue(itemsShareWithme[_0x420615]['SiteURL']))['done'](function(_0x17a0c6){RequestDigest=_0x17a0c6;});var _0x1fa01c=itemsShareWithme[_0x420615][_0x19b1e4(0x297)],_0xca03c0=itemsShareWithme[_0x420615][_0x19b1e4(0x22b)],_0x9e2d62=itemsShareWithme[_0x420615][_0x19b1e4(0x226)];$[_0x19b1e4(0x295)](getItemsWithQueryUsersDocuments(_0x1fa01c,_0xca03c0))[_0x19b1e4(0x1fa)](function(_0x425a87){var _0x18e709=_0x19b1e4;for(var _0x347772=0x0;_0x347772<_0x425a87[_0x18e709(0x1c8)][_0x18e709(0x2a1)][_0x18e709(0x1c0)];_0x347772++){folderpath=_0x425a87[_0x18e709(0x1c8)][_0x18e709(0x2a1)][_0x347772][_0x18e709(0x288)][_0x18e709(0x234)](_0x9e2d62)[0x1][_0x18e709(0x254)](0x0,_0x425a87[_0x18e709(0x1c8)][_0x18e709(0x2a1)][_0x347772][_0x18e709(0x288)][_0x18e709(0x234)](_0x9e2d62+'/')[0x1][_0x18e709(0x1dd)]('/')),ShareAllItemswithFolder[_0x18e709(0x28a)]({'Path':_0x425a87[_0x18e709(0x1c8)][_0x18e709(0x2a1)][_0x347772][_0x18e709(0x288)],'FolderPath':folderpath,'FileExtension':_0x425a87[_0x18e709(0x1c8)][_0x18e709(0x2a1)][_0x347772][_0x18e709(0x293)][_0x18e709(0x234)]('.')[0x1],'Author':_0x425a87[_0x18e709(0x1c8)][_0x18e709(0x2a1)][_0x347772][_0x18e709(0x1c4)][_0x18e709(0x283)]==null?'':_0x425a87[_0x18e709(0x1c8)]['results'][_0x347772][_0x18e709(0x1c4)][_0x18e709(0x283)],'Size':_0x425a87[_0x18e709(0x1c8)]['results'][_0x347772]['Length'],'Name':_0x425a87[_0x18e709(0x1c8)][_0x18e709(0x2a1)][_0x347772][_0x18e709(0x293)],'Title':_0x425a87[_0x18e709(0x1c8)][_0x18e709(0x2a1)][_0x347772][_0x18e709(0x225)]==null||_0x425a87[_0x18e709(0x1c8)][_0x18e709(0x2a1)][_0x347772][_0x18e709(0x225)]==''?_0x425a87['Files']['results'][_0x347772]['Name'][_0x18e709(0x234)]('.')[0x0]:_0x425a87[_0x18e709(0x1c8)][_0x18e709(0x2a1)][_0x347772][_0x18e709(0x225)],'DocumentNo':_0x425a87[_0x18e709(0x1c8)][_0x18e709(0x2a1)][_0x347772][_0x18e709(0x1c4)]['DocumentNo']==null?'':_0x425a87['Files'][_0x18e709(0x2a1)][_0x347772][_0x18e709(0x1c4)][_0x18e709(0x270)],'Details':_0x425a87[_0x18e709(0x1c8)]['results'][_0x347772][_0x18e709(0x1c4)][_0x18e709(0x27e)],'DocumentType':_0x425a87['Files'][_0x18e709(0x2a1)][_0x347772][_0x18e709(0x1c4)][_0x18e709(0x200)]==null?'':_0x425a87[_0x18e709(0x1c8)]['results'][_0x347772][_0x18e709(0x1c4)][_0x18e709(0x200)],'LastModifiedTime':_0x425a87[_0x18e709(0x1c8)][_0x18e709(0x2a1)][_0x347772]['TimeLastModified'],'Library':_0x9e2d62,'ServerUrl':_0xca03c0,'SubCategory':_0x425a87[_0x18e709(0x1c8)][_0x18e709(0x2a1)][_0x347772][_0x18e709(0x1c4)][_0x18e709(0x21c)]==null?'':_0x425a87[_0x18e709(0x1c8)]['results'][_0x347772][_0x18e709(0x1c4)]['SubCategory'],'FileVersion':_0x425a87['Files']['results'][_0x347772][_0x18e709(0x230)]=='1.0'?_0x18e709(0x203):parseInt(_0x425a87[_0x18e709(0x1c8)][_0x18e709(0x2a1)][_0x347772][_0x18e709(0x230)])-0x1+'.0'});}for(var _0x5657ee=0x0;_0x5657ee<_0x425a87['Folders'][_0x18e709(0x2a1)]['length'];_0x5657ee++){var _0x53016=_0x425a87[_0x18e709(0x277)]['results'][_0x5657ee][_0x18e709(0x288)];$[_0x18e709(0x295)](getItemsWithQueryUsersDocuments(_0x425a87[_0x18e709(0x277)][_0x18e709(0x2a1)][_0x5657ee][_0x18e709(0x288)],_0xca03c0))[_0x18e709(0x1fa)](function(_0x3eebbc){var _0x178af4=_0x18e709;for(var _0x1e219f=0x0;_0x1e219f<_0x3eebbc[_0x178af4(0x1c8)][_0x178af4(0x2a1)][_0x178af4(0x1c0)];_0x1e219f++){folderpath=_0x425a87[_0x178af4(0x1c8)][_0x178af4(0x2a1)][_0x1e219f][_0x178af4(0x288)][_0x178af4(0x234)](_0x9e2d62)[0x1]['substr'](0x0,_0x425a87[_0x178af4(0x1c8)][_0x178af4(0x2a1)][_0x1e219f]['ServerRelativeUrl'][_0x178af4(0x234)](_0x9e2d62+'/')[0x1][_0x178af4(0x1dd)]('/')),ShareAllItemswithFolder['push']({'Path':_0x3eebbc[_0x178af4(0x1c8)][_0x178af4(0x2a1)][_0x1e219f][_0x178af4(0x288)],'FolderPath':folderpath,'FileExtension':_0x3eebbc['Files'][_0x178af4(0x2a1)][_0x1e219f]['Name'][_0x178af4(0x234)]('.')[0x1],'Author':_0x3eebbc['Files'][_0x178af4(0x2a1)][_0x1e219f][_0x178af4(0x1c4)][_0x178af4(0x283)]==null?'':_0x3eebbc[_0x178af4(0x1c8)][_0x178af4(0x2a1)][_0x1e219f]['ListItemAllFields'][_0x178af4(0x283)],'Size':_0x3eebbc[_0x178af4(0x1c8)]['results'][_0x1e219f][_0x178af4(0x1d8)],'Name':_0x3eebbc['Files'][_0x178af4(0x2a1)][_0x1e219f]['Name'],'Title':_0x3eebbc[_0x178af4(0x1c8)][_0x178af4(0x2a1)][_0x1e219f][_0x178af4(0x225)]==null||_0x3eebbc[_0x178af4(0x1c8)][_0x178af4(0x2a1)][_0x1e219f]['Title']==''?_0x3eebbc[_0x178af4(0x1c8)][_0x178af4(0x2a1)][_0x1e219f][_0x178af4(0x293)][_0x178af4(0x234)]('.')[0x0]:_0x3eebbc[_0x178af4(0x1c8)][_0x178af4(0x2a1)][_0x1e219f][_0x178af4(0x225)],'DocumentNo':_0x3eebbc['Files'][_0x178af4(0x2a1)][_0x1e219f][_0x178af4(0x1c4)][_0x178af4(0x270)]==null?'':_0x3eebbc[_0x178af4(0x1c8)]['results'][_0x1e219f][_0x178af4(0x1c4)][_0x178af4(0x270)],'Details':_0x3eebbc[_0x178af4(0x1c8)][_0x178af4(0x2a1)][_0x1e219f][_0x178af4(0x1c4)][_0x178af4(0x27e)],'DocumentType':_0x3eebbc[_0x178af4(0x1c8)]['results'][_0x1e219f]['ListItemAllFields'][_0x178af4(0x200)]==null?'':_0x3eebbc[_0x178af4(0x1c8)][_0x178af4(0x2a1)][_0x1e219f][_0x178af4(0x1c4)][_0x178af4(0x200)],'LastModifiedTime':_0x3eebbc[_0x178af4(0x1c8)]['results'][_0x1e219f][_0x178af4(0x26e)],'Library':_0x9e2d62,'ServerUrl':_0xca03c0,'SubCategory':_0x3eebbc[_0x178af4(0x1c8)]['results'][_0x1e219f][_0x178af4(0x1c4)]['SubCategory']==null?'':_0x3eebbc[_0x178af4(0x1c8)]['results'][_0x1e219f][_0x178af4(0x1c4)][_0x178af4(0x21c)],'FileVersion':_0x3eebbc[_0x178af4(0x1c8)][_0x178af4(0x2a1)][_0x1e219f]['UIVersionLabel']==_0x178af4(0x203)?_0x178af4(0x203):parseInt(_0x3eebbc['Files'][_0x178af4(0x2a1)][_0x1e219f][_0x178af4(0x230)])-0x1+'.0'});}for(var _0x1e219f=0x0;_0x1e219f<_0x3eebbc[_0x178af4(0x277)]['results']['length'];_0x1e219f++){_0x425a87['Folders'][_0x178af4(0x2a1)][_0x178af4(0x28a)](_0x3eebbc[_0x178af4(0x277)][_0x178af4(0x2a1)][_0x1e219f]);}});}});}}}RestQuery=_0x19b1e4(0x25c);var _0x4a25bc=![];txtTitle!=''&&(_0x4a25bc=!![],RestQuery+='substringof(\x27'+txtTitle+'\x27,FileLeafRef)\x20or\x20substringof(\x27'+txtTitle+_0x19b1e4(0x23a));$(_0x19b1e4(0x1d2))['val']()!=''&&(_0x4a25bc?RestQuery+='and\x20substringof(\x27'+$('#txtReference')[_0x19b1e4(0x1f8)]()+_0x19b1e4(0x27b):(RestQuery+=_0x19b1e4(0x1d1)+$('#txtReference')[_0x19b1e4(0x1f8)]()+_0x19b1e4(0x27b),_0x4a25bc=!![]));$('#ddlDocumentType\x20option:selected')[_0x19b1e4(0x1f8)]()!='All'&&(_0x4a25bc?(RestQuery+='and\x20DocumentType\x20eq\x20\x27'+$(_0x19b1e4(0x28e))[_0x19b1e4(0x1f8)]()+'\x27',_0x4a25bc=![]):RestQuery+=_0x19b1e4(0x1e8)+$(_0x19b1e4(0x28e))[_0x19b1e4(0x1f8)]()+'\x27');var _0x264ec5='';if(itemsShareWithme[_0x19b1e4(0x1c0)]>0x0&&IsShareDocumnet==!![]){for(var _0x420615=0x0;_0x420615<itemsShareWithme[_0x19b1e4(0x1c0)];_0x420615++){if(itemsShareWithme[_0x420615][_0x19b1e4(0x200)][_0x19b1e4(0x29b)]()==_0x19b1e4(0x219)){RestQuery=_0x19b1e4(0x26c)+itemsShareWithme[_0x420615][_0x19b1e4(0x212)]['ID']+'\x27',RequestDigest=$(_0x19b1e4(0x276))['val']();itemsShareWithme[_0x420615][_0x19b1e4(0x22b)]!=_spPageContextInfo[_0x19b1e4(0x1ff)]&&$['when'](GetFormDigestValue(itemsShareWithme[_0x420615][_0x19b1e4(0x22b)]))[_0x19b1e4(0x1fa)](function(_0x488835){RequestDigest=_0x488835;});_0x264ec5='';(itemsShareWithme[_0x420615][_0x19b1e4(0x226)]==_0x19b1e4(0x266)||itemsShareWithme[_0x420615]['LibraryName']==_0x19b1e4(0x2a3))&&(itemsShareWithme[_0x420615][_0x19b1e4(0x226)]=_0x19b1e4(0x232));_0x264ec5=GetFileDetails(_0x19b1e4(0x291)+RestQuery,itemsShareWithme[_0x420615]['LibraryName'],itemsShareWithme[_0x420615]['SiteURL']);if(_0x264ec5!=undefined){folderpath=_0x264ec5[0x0][_0x19b1e4(0x1cf)][_0x19b1e4(0x288)]['split'](itemsShareWithme[_0x420615][_0x19b1e4(0x226)])[0x1][_0x19b1e4(0x254)](0x0,_0x264ec5[0x0][_0x19b1e4(0x1cf)][_0x19b1e4(0x288)][_0x19b1e4(0x234)](itemsShareWithme[_0x420615][_0x19b1e4(0x226)]+'/')[0x1][_0x19b1e4(0x1dd)]('/'));var _0x9718b7=_0x264ec5[0x0][_0x19b1e4(0x1cf)][_0x19b1e4(0x288)];_0x9718b7!=undefined&&getFileDetails[_0x19b1e4(0x28a)]({'Path':_0x264ec5[0x0]['File'][_0x19b1e4(0x288)],'FolderPath':folderpath,'FileExtension':_0x264ec5[0x0][_0x19b1e4(0x1cf)][_0x19b1e4(0x293)][_0x19b1e4(0x234)]('.')[0x1],'Author':_0x264ec5[0x0]['File'][_0x19b1e4(0x27a)][_0x19b1e4(0x225)],'Size':_0x264ec5[0x0][_0x19b1e4(0x1cf)][_0x19b1e4(0x1d8)],'Name':_0x264ec5[0x0][_0x19b1e4(0x1cf)][_0x19b1e4(0x293)],'Title':_0x264ec5[0x0][_0x19b1e4(0x1cf)][_0x19b1e4(0x225)]==null||_0x264ec5[0x0][_0x19b1e4(0x1cf)][_0x19b1e4(0x225)]==''?_0x264ec5[0x0][_0x19b1e4(0x1cf)][_0x19b1e4(0x293)]['split']('.')[0x0]:_0x264ec5[0x0][_0x19b1e4(0x1cf)]['Title'],'DocumentNo':_0x264ec5[0x0]['DocumentNo']==null?'':_0x264ec5[0x0]['DocumentNo'],'Details':_0x264ec5[0x0][_0x19b1e4(0x27e)],'DocumentType':_0x264ec5[0x0][_0x19b1e4(0x200)]==null?'':_0x264ec5[0x0][_0x19b1e4(0x200)],'LastModifiedTime':_0x264ec5[0x0][_0x19b1e4(0x1cf)][_0x19b1e4(0x26e)],'Library':itemsShareWithme[_0x420615]['LibraryName'],'ServerUrl':itemsShareWithme[_0x420615][_0x19b1e4(0x22b)],'FileVersion':_0x264ec5[0x0][_0x19b1e4(0x1cf)][_0x19b1e4(0x230)]=='1.0'?_0x19b1e4(0x203):parseInt(_0x264ec5[0x0][_0x19b1e4(0x1cf)][_0x19b1e4(0x230)])-0x1+'.0'});}}}getFileDetails=getFileDetails[_0x19b1e4(0x233)](ShareAllItemswithFolder);if(txtContent!=''){var _0x54f0c5=txtContent[_0x19b1e4(0x1ac)]();getFileDetails=getFileDetails[_0x19b1e4(0x24a)](_0x475ebd=>_0x475ebd['Title']['toString']()['includes'](_0x54f0c5));}if(txtTitle!=''){var _0x54f0c5=txtTitle[_0x19b1e4(0x1ac)]();getFileDetails=getFileDetails['filter'](_0x378898=>_0x378898[_0x19b1e4(0x225)]['toString']()['includes'](_0x54f0c5));}$('#txtReference')[_0x19b1e4(0x1f8)]()!=''&&(getFileDetails=getFileDetails[_0x19b1e4(0x24a)](_0x2da148=>_0x2da148[_0x19b1e4(0x270)][_0x19b1e4(0x211)]($(_0x19b1e4(0x1d2))[_0x19b1e4(0x1f8)]()))),$(_0x19b1e4(0x28e))['val']()!=_0x19b1e4(0x1f3)&&(getFileDetails=getFileDetails['filter'](_0x44e356=>_0x44e356['DocumentType'][_0x19b1e4(0x211)]($('#ddlDocumentType\x20option:selected')['val']())));}}function GenrateHtmlGrid(_0x7d21e){var _0x204f75=a329_0x223a7a,_0x1337c4='';$('#SearchResultsGrid')[_0x204f75(0x2a5)](''),_0x1337c4+=_0x204f75(0x26a)+'<tr>'+'<th></th>'+_0x204f75(0x1f0)+'<th></th>'+'<th></th>'+_0x204f75(0x221)+_0x204f75(0x2a8)+'<tbody>';for(var _0x15142c=0x0;_0x15142c<_0x7d21e[_0x204f75(0x1c0)];_0x15142c++){var _0x9a7806=_0x204f75(0x253);if('docx'==_0x7d21e[_0x15142c][_0x204f75(0x263)]||_0x204f75(0x29d)==_0x7d21e[_0x15142c]['FileExtension'])_0x9a7806='docx.png';else{if(_0x204f75(0x285)==_0x7d21e[_0x15142c][_0x204f75(0x263)])_0x9a7806=_0x204f75(0x24e);else{if(_0x204f75(0x298)==_0x7d21e[_0x15142c][_0x204f75(0x263)]||_0x204f75(0x282)==_0x7d21e[_0x15142c]['FileExtension']||_0x204f75(0x20b)==_0x7d21e[_0x15142c][_0x204f75(0x263)]||_0x204f75(0x1d3)==_0x7d21e[_0x15142c]['FileExtension']||_0x204f75(0x1b5)==_0x7d21e[_0x15142c][_0x204f75(0x263)]||_0x204f75(0x268)==_0x7d21e[_0x15142c][_0x204f75(0x263)]||'png'==_0x7d21e[_0x15142c]['FileExtension'])_0x9a7806=_0x204f75(0x249);else{if(_0x204f75(0x1a5)==_0x7d21e[_0x15142c][_0x204f75(0x263)])_0x9a7806=_0x204f75(0x1ce);else{if('pptx'==_0x7d21e[_0x15142c][_0x204f75(0x263)])_0x9a7806=_0x204f75(0x22c);else{if(_0x204f75(0x2ab)==_0x7d21e[_0x15142c][_0x204f75(0x263)])_0x9a7806=_0x204f75(0x1ca);else{if('csv'==_0x7d21e[_0x15142c]['FileExtension'])_0x9a7806=_0x204f75(0x255);else{if('zip'==_0x7d21e[_0x15142c][_0x204f75(0x263)]||'rar'==_0x7d21e[_0x15142c][_0x204f75(0x263)]||'7z'==_0x7d21e[_0x15142c][_0x204f75(0x263)]||_0x204f75(0x1db)==_0x7d21e[_0x15142c][_0x204f75(0x263)]||_0x204f75(0x1f6)==_0x7d21e[_0x15142c][_0x204f75(0x263)]||'rpm'==_0x7d21e[_0x15142c][_0x204f75(0x263)]||_0x204f75(0x23b)==_0x7d21e[_0x15142c]['FileExtension'])_0x9a7806=_0x204f75(0x222);else{if(_0x204f75(0x21d)==_0x7d21e[_0x15142c][_0x204f75(0x263)]||_0x204f75(0x1e3)==_0x7d21e[_0x15142c][_0x204f75(0x263)]||_0x204f75(0x1f4)==_0x7d21e[_0x15142c][_0x204f75(0x263)]||_0x204f75(0x243)==_0x7d21e[_0x15142c][_0x204f75(0x263)]||_0x204f75(0x1bc)==_0x7d21e[_0x15142c]['FileExtension']||_0x204f75(0x244)==_0x7d21e[_0x15142c][_0x204f75(0x263)]||'wav'==_0x7d21e[_0x15142c][_0x204f75(0x263)]||_0x204f75(0x281)==_0x7d21e[_0x15142c]['FileExtension'])_0x9a7806='video.png';else('mp3'==_0x7d21e[_0x15142c][_0x204f75(0x263)]||'wma'==_0x7d21e[_0x15142c]['FileExtension']||'aac'==_0x7d21e[_0x15142c][_0x204f75(0x263)]||'pcm'==_0x7d21e[_0x15142c]['FileExtension'])&&(_0x9a7806=_0x204f75(0x22f));}}}}}}}}var _0xddbe4=_0x7d21e[_0x15142c][_0x204f75(0x21c)];_0xddbe4==''||_0xddbe4==null||_0xddbe4==_0x204f75(0x248)?_0xddbe4='':_0xddbe4='\x20('+_0xddbe4+')';(_0x7d21e[_0x15142c][_0x204f75(0x200)]==_0x204f75(0x1c3)||_0x7d21e[_0x15142c][_0x204f75(0x200)]==null||_0x7d21e[_0x15142c]['DocumentType']==_0x204f75(0x248)||_0x7d21e[_0x15142c][_0x204f75(0x200)]==_0x204f75(0x267))&&(_0x7d21e[_0x15142c][_0x204f75(0x200)]='');(_0x7d21e[_0x15142c]['DocumentNo']==null||_0x7d21e[_0x15142c]['DocumentNo']==_0x204f75(0x248))&&(_0x7d21e[_0x15142c][_0x204f75(0x270)]='');var _0x3364d7='';_0x3364d7=_0x7d21e[_0x15142c][_0x204f75(0x1b1)]==''?_0x204f75(0x25d):_0x7d21e[_0x15142c][_0x204f75(0x1b1)]+'/';if(_0x7d21e[_0x15142c][_0x204f75(0x1e6)][_0x204f75(0x211)](_0x204f75(0x25b))==!![]){}else{}_0x1337c4+='<tr>'+_0x204f75(0x299)+_0x204f75(0x272)+'<input\x20type=\x22checkbox\x22\x20id=\x22myCheckbox'+_0x15142c+'\x22\x20/>'+_0x204f75(0x1da)+_0x15142c+'\x22>'+'<img\x20width=\x2230px\x22\x20src=\x22https://cdn.jsdelivr.net/gh/Titan4workGit/TitanRepo@main/SiteAssets/MyDocuments/AdvanceDocumentSearch/assets/images/'+_0x9a7806+_0x204f75(0x245)+_0x204f75(0x1f7)+'</div>'+_0x204f75(0x27f)+_0x204f75(0x227)+'<a\x20href=\x22javascript:void(0);\x22\x20id=\x22Fileid'+_0x15142c+_0x204f75(0x1d7)+_0x7d21e[_0x15142c]['ServerUrl']+_0x204f75(0x1ad)+_0x7d21e[_0x15142c][_0x204f75(0x273)]+_0x204f75(0x21e)+_0x7d21e[_0x15142c][_0x204f75(0x1e6)]+_0x204f75(0x1d6)+_0x7d21e[_0x15142c][_0x204f75(0x225)]+_0x204f75(0x251)+'<div\x20class=\x22ellipsis-1\x22>'+'<span>File\x20name:</span>\x20<span>'+_0x7d21e[_0x15142c][_0x204f75(0x293)]+_0x204f75(0x1b8)+_0x204f75(0x202)+_0x204f75(0x27f)+_0x204f75(0x1d5)+_0x204f75(0x1e2)+_0x204f75(0x25a)+_0x7d21e[_0x15142c][_0x204f75(0x200)]+_0xddbe4+_0x204f75(0x1b8)+'</div>'+_0x204f75(0x1e2)+_0x204f75(0x278)+_0x7d21e[_0x15142c][_0x204f75(0x270)]+_0x204f75(0x1b8)+_0x204f75(0x202)+'<div\x20class=\x22ellipsis-1\x22>'+'<span\x20data-localize=\x22Library\x22>Library</span><span>:</span>\x20<span>'+_0x7d21e[_0x15142c][_0x204f75(0x273)]+_0x204f75(0x1b8)+_0x204f75(0x202)+_0x204f75(0x1e2)+'<span\x20data-localize=\x22\x22>Path:</span><span>'+_0x7d21e[_0x15142c][_0x204f75(0x1b1)]+_0x204f75(0x1b8)+_0x204f75(0x202)+_0x204f75(0x27f)+'<td\x20class=\x22w-18\x22>'+_0x204f75(0x290)+_0x204f75(0x206)+titanForWork['convertJSONDateAMPMWithDate'](_0x7d21e[_0x15142c][_0x204f75(0x257)])+'</span>'+_0x204f75(0x202)+'<div\x20class=\x22ellipsis-1\x22>'+'<span\x20data-localize=\x22Author\x22>Author</span><span>:</span>\x20<span>'+_0x7d21e[_0x15142c][_0x204f75(0x27a)]+_0x204f75(0x1b8)+'</div>'+_0x204f75(0x290)+_0x204f75(0x1ed)+bytesToSize(_0x7d21e[_0x15142c][_0x204f75(0x220)])+'</span>'+'<div>'+'<span\x20data-localize=\x22Size\x22>Version</span><span>:</span>\x20<span>'+_0x7d21e[_0x15142c][_0x204f75(0x20f)]+_0x204f75(0x1b8)+_0x204f75(0x202)+_0x204f75(0x202)+'</td>'+_0x204f75(0x221);}$(_0x204f75(0x26f))[_0x204f75(0x2a5)](_0x1337c4),$['fn']['dataTable']['isDataTable']('#SearchResultsGrid')?(table[_0x204f75(0x29e)](),table=$(_0x204f75(0x26f))[_0x204f75(0x289)]({'bPaginate':!![],'bJQueryUI':!![],'bLengthChange':![],'bFilter':!![],'bSort':!![],'bInfo':!![],'bAutoWidth':!![],'bProcessing':!![],'iDisplayLength':0x8,'dom':'Rlfrtip','colReorder':{'allowReorder':!![]},'language':{'searchPlaceholder':_0x204f75(0x2a2),'sSearch':''}})):table=$(_0x204f75(0x26f))['DataTable']({'bPaginate':!![],'bJQueryUI':!![],'bLengthChange':![],'bFilter':!![],'bSort':!![],'bInfo':!![],'bAutoWidth':!![],'bProcessing':!![],'iDisplayLength':0x8,'dom':'Rlfrtip','colReorder':{'allowReorder':!![]},'language':{'searchPlaceholder':'Type\x20to\x20find....','sSearch':''}}),ChangeLabels();}function bytesToSize(_0x487990){var _0x62e331=a329_0x223a7a,_0x49591b=['Bytes','KB','MB','GB','TB'];if(_0x487990==0x0)return _0x62e331(0x26b);var _0x18f4ee=parseInt(Math[_0x62e331(0x1c5)](Math['log'](_0x487990)/Math[_0x62e331(0x1af)](0x400)));return Math[_0x62e331(0x1cb)](_0x487990/Math[_0x62e331(0x1bd)](0x400,_0x18f4ee),0x2)+'\x20'+_0x49591b[_0x18f4ee];}function GetDocumentsMyDocuments(_0x58fb3c,_0x541283,_0x521f40){var _0x40f64d=a329_0x223a7a,_0xc2c15=_0x541283+'/_api/Web/GetFolderByServerRelativeUrl(\x27'+_0x521f40+_0x40f64d(0x280)+_0x58fb3c;$[_0x40f64d(0x241)]({'url':_0xc2c15,'headers':{'Accept':_0x40f64d(0x1b3)},'async':!![],'success':function(_0x35d4b7){},'eror':function(_0x4f3b68){var _0x8d858c=_0x40f64d;console[_0x8d858c(0x1af)](_0x8d858c(0x1b9));}});}function GetCatogeryName(){var _0x3f5dba=a329_0x223a7a;RestQuery=_0x3f5dba(0x28b),$['when'](CommonFunction['getItemsWithQueryItem']('CategoryMaster',RestQuery))[_0x3f5dba(0x1fa)](function(_0x4774eb){var _0x5670bd=_0x3f5dba;try{$('#ddlDocumentType')[_0x5670bd(0x1f8)]('');var _0x4c1546=document[_0x5670bd(0x1fb)](_0x5670bd(0x1fc));for(var _0xd07496=0x0;_0xd07496<_0x4774eb[_0x5670bd(0x2a1)][_0x5670bd(0x1c0)];_0xd07496++){$('#ddlDocumentType')[_0x5670bd(0x1e5)]('<option\x20value=\x22'+_0x4774eb[_0x5670bd(0x2a1)][_0xd07496][_0x5670bd(0x27d)]+'\x22>'+_0x4774eb[_0x5670bd(0x2a1)][_0xd07496][_0x5670bd(0x27d)]+_0x5670bd(0x1eb));}}catch(_0xcb25ac){alert(_0xcb25ac);}});}function GetFileDetails(_0x22040c,_0x4b478e,_0x1481ea){var _0x50a47c=a329_0x223a7a,_0x3a401e;return $[_0x50a47c(0x295)](getDocItemsWithQueryItem(_0x4b478e,_0x22040c,_0x1481ea))[_0x50a47c(0x1fa)](function(_0x186c90){var _0x172529=_0x50a47c;_0x186c90[_0x172529(0x2a1)][_0x172529(0x1c0)]>0x0&&(_0x3a401e=_0x186c90[_0x172529(0x2a1)]);}),_0x3a401e;}function a329_0x2d2e(_0xaa2622,_0x3cd1eb){var _0x399662=a329_0x3996();return a329_0x2d2e=function(_0x2d2eb3,_0x493d24){_0x2d2eb3=_0x2d2eb3-0x1a5;var _0x4496e7=_0x399662[_0x2d2eb3];return _0x4496e7;},a329_0x2d2e(_0xaa2622,_0x3cd1eb);}function GetListId(_0x1b2686){var _0x1c69ea=a329_0x223a7a;const _0x5d2115=_0x1b2686[_0x1c69ea(0x234)](_0x1c69ea(0x22e))[0x0];Documentname=_0x5d2115['split']('/')[_0x5d2115[_0x1c69ea(0x234)]('/')[_0x1c69ea(0x1c0)]-0x1];Documentname==_0x1c69ea(0x2a3)&&(Documentname=_0x1c69ea(0x232));withoutLastChunk=_0x5d2115[_0x1c69ea(0x224)](0x0,_0x5d2115['lastIndexOf']('/')),GloblSiteurl=withoutLastChunk;var _0x53f64a=withoutLastChunk+'/_api/lists/GetByTitle(\x27'+Documentname+_0x1c69ea(0x1e1);GloblListId=GetListItemById(_0x53f64a);}function a329_0x3996(){var _0x101cfe=['pdf','href','init','ServerRelativeUrl','DataTable','push','?$select=*,CatogeryName\x20&$filter=CategoryType\x20eq\x20\x27Document\x27\x20and\x20Status\x20eq\x20\x27Yes\x27\x20','/_api/search/query?querytext=\x20\x27','stringify','#ddlDocumentType\x20option:selected','4057353egAviC','<div>','?$orderby=Id\x20desc\x20&$top=4999\x20&$select=*,Author/Title,OData__UIVersionString\x20&$expand=File,File/Author/Title,\x20Author,File/ListItemAllFields','801816cvLjBZ','Name','prop','when','?$select=*,ID,SharedFrom,SharedType,DocumentNo,IsBlock,Details,ServerRedirectedEmbedURL,Title,DocumentURL,DocumentID,DocumentType,SharedGroup,PermissionStatus,PermissionType,SharedUsers/Title,SharedUsers/ID,Author/Title,Author/ID,Author/EMail,DOC_ID/ID,DOC_ID/Title,DOC_ID/DocumentNo,DOC_ID/DocumentType&$orderby=Modified\x20desc&$expand=DOC_ID,SharedUsers,Author&$filter=(SharedUsers/Id\x20eq\x20\x27','DocumentURL','jpg','<td\x20class=\x22vertical-align-middle\x20w-2\x20\x22>','1078FaVDbK','toLowerCase','reject','doc','destroy','Please\x20select\x20document\x20library\x20to\x20search.','ready!','results','Type\x20to\x20find....','Shared%20Documents','Cells','html','onError','/_api/web/currentuser/?$expand=groups','</thead>','*\x20\x27&rowlimit=\x275000\x27\x20&sortlist=\x27rank:descending,modifiedby:ascending\x27\x20&selectproperties=\x27Path,FileExtension,Author,Size,Name,Title,DocumentNo,Regarding,Details,Shared,Department,DepartmentName,Shared\x20With,DocumentType,LastModifiedTime,ID\x27\x20&refinementfilters=\x27and(ListId:(','ready','txt','xlsx','\x20\x20\x20\x20EndLoop','download','userId','url','/_api/Web/Lists/getByTitle(','substring','toString','\x27,\x20\x27','order','log','Invalid\x20data','FolderPath','style','application/json;odata=verbose','innerHTML','bmp','=desc','removeChild','</span>','error','\x27)?$select=Author/Title,ID,EncodedAbsUrl,File_x0020_Type,DocumentWrittenBy&$expand=Author,Folders,Folders/ListItemAllFields/HasUniqueRoleAssignments,Files/ModifiedBy/Title,Files/ListItemAllFields/HasUniqueRoleAssignments,Folders/ListItemAllFields,Files,Files/ListItemAllFields,Files/ListItemAllFields/FileSizeDisplay&$orderby=Modified\x20desc','\x27,FileLeafRef)\x20or\x20substringof(\x27','flv','pow','or\x20SharedUsers/Id\x20eq\x20\x27','Deferred','length','parse','1680dsZPCY','-Select-','ListItemAllFields','floor','query','object','Files','DocumentManagementSystem/','txt.png','round','and\x20substringof(\x27','Owners','xlsx.png','File','?$orderby=Id\x20desc\x20&$top=4999\x20&$select=*,Author/Title\x20&$expand=File,File/Author/Title,\x20Author,File/ListItemAllFields','substringof(\x27','#txtReference','gif','folder','<td\x20class=\x22w-25\x22>','\x22\x20class=\x22table-title\x22\x20target=\x22\x22>','\x22\x20onclick=\x22DisplayFileProperty(this,\x20\x27','Length','origin','<label\x20for=\x22myCheckbox','arz','My\x20Documents','lastIndexOf','3WlHDsk','userLoginName','location','\x27)/id','<div\x20class=\x22ellipsis-1\x22>','wmv','\x27)/items/','append','Path','Contributors','DocumentType\x20eq\x20\x27','#btnSearch','All\x20Document\x20Library','</option>','Serach\x20Result','<span\x20data-localize=\x22Size\x22>Size</span><span>:</span>\x20<span>','search','each','<th></th>','43079eDifIP','SharedDocument','ALL','avi','\x20and\x20PermissionStatus\x20ne\x20\x27Revoked\x27','cab','</label>','val','and\x20DocumentType\x20eq\x20\x27','done','getElementById','ddlDocumentType','Failed','Groups','webAbsoluteUrl','DocumentType','click','</div>','1.0','trim','Value','<span\x20data-localize=\x22Modify\x22>Modify</span><span>:</span>\x20<span>','/DocumentManagementSystem/Forms/AllItems.aspx','attr','The\x20crawling\x20services\x20is\x20failed,\x20try\x20with\x20proper\x20searching\x20text','*))\x27','tiff','fadeIn','#overlaysearch','My_','FileVersion','GET','includes','DOC_ID','10CFzyFx','SharedByMe','Table',')/getItems?','promise','DocumentID','file','#txtContentsearchBox','?$orderby=Id\x20desc\x20&$top=4999\x20&$select=*,Author/Title,OData__UIVersionString\x20&$expand=\x20File,File/Author/Title,\x20Author,File/ListItemAllFields','SubCategory','mp4','\x27);\x22\x20name=\x22','asc','Size','</tr>','ZIP.png','TFW_Employees','slice','Title','LibraryName','<td\x20class=\x22text-left\x20w-40\x22>','portalUrl','responseJSON','draw','SiteURL','pptx.png','Archive','/Forms','audio.png','UIVersionLabel','resolve','Documents','concat','split','/_api/contextinfo','name','#searchResults','message','387932nmgZVV','\x27,Title)\x20','wim','createElement','cells','Rows','Serach\x20result\x20null','=asc','ajax','\x27\x20and\x20IsArchive\x20ne\x201)\x20','mpeg','mov','\x22\x20/>','replace','fadeOut','null','image-icon.png','filter','id=\x22','$select=*,FileDirRef','?$orderby=Id\x20desc\x20&$select=*,Author/Title\x20&$expand=File,File/Author/Title,\x20Author,File/ListItemAllFields\x20&$filter=FileLeafRef\x20eq\x20\x27','pdf.png','125960VWFRfg','closest','</a>','\x20and\x20(PermissionType\x20eq\x20\x27Read\x27\x20or\x20PermissionType\x20eq\x20\x27Contribute\x27\x20or\x20PermissionType\x20eq\x20\x27Restricted\x20View\x27)\x20and\x20(PermissionStatus\x20ne\x20\x27Deleted\x27)\x20and\x20(IsArchive\x20eq\x201)','file.png','substr','CSV.png','929820AfRgrf','LastModifiedTime','appendChild','#tblDocLibraries\x20input[type=checkbox]:checked','<span\x20data-localize=\x22Category\x22>Category</span><span>:</span>\x20<span>','DocumentManagementSystem','&$filter=\x20','/Root/','hide','PrimaryQueryResult','load','#txtTitlesearchBox','<h3>An\x20error\x20occured</h3><br\x20/>','FileExtension','RelevantResults','application/json;odata=nometadata','Shared\x20Documents','--select--','jpeg','/documentmanagementsystem/','<thead\x20style=\x22display:none\x22>','0\x20Byte','&$filter=Id\x20eq\x20\x27','#chkShareWithme','TimeLastModified','#SearchResultsGrid','DocumentNo','.csv','<div\x20class=\x22chexbox_mg\x22>','Library','/_api/Web/GetFolderByServerRelativeUrl(\x27','*\x20\x27&rowlimit=\x275000\x27\x20&sortlist=\x27rank:descending,modifiedby:ascending\x27\x20&selectproperties=\x27Path,FileExtension,Author,Size,Name,Title,DocumentNo,Regarding,Details,Shared,Department,DepartmentName,Shared\x20With,DocumentType,LastModifiedTime,ID\x27\x20&refinementfilters=\x27and(IsDocument:(true),Title:(','#__REQUESTDIGEST','Folders','<span\x20data-localize=\x22Reference\x22>Reference</span><span>:</span>\x20<span>','body','Author','\x27,DocumentNo)','System\x20Account','CatogeryName','Details','</td>','\x27)?$select=*,Author/Title&$expand=Folders,Folders/ListItemAllFields,File,File/Author/Title,\x20Author,File/ListItemAllFields&$orderby=Modified\x20desc','ogv','psd','DocumentWrittenBy','OwnerTitle'];a329_0x3996=function(){return _0x101cfe;};return a329_0x3996();}function GetListItemById(_0x3d4209){var _0x1a9899=a329_0x223a7a,_0x7fc100=0x1;return $[_0x1a9899(0x241)]({'url':_0x3d4209,'method':_0x1a9899(0x210),'async':![],'headers':{'Accept':'application/json;odata=verbose'},'success':function(_0x16b2a7,_0x9988d9,_0x2a651a){var _0x268748=_0x16b2a7['d'];_0x7fc100=_0x16b2a7['d']['Id'];},'error':function(_0x5907d5,_0x47f0dc,_0x4358b3){var _0x2b31cf=_0x1a9899;console[_0x2b31cf(0x1af)](_0x2b31cf(0x1fd));}}),_0x7fc100;}function getDocItemsWithQueryItem(_0x4432e9,_0x120efe,_0x367bf5){var _0xe10a48=a329_0x223a7a;return DeferredObj=$[_0xe10a48(0x1bf)](),$[_0xe10a48(0x241)]({'url':_0x367bf5+'/_api/web/lists/getbytitle(\x27'+_0x4432e9+_0xe10a48(0x1e4)+_0x120efe,'type':_0xe10a48(0x210),'async':![],'headers':{'ACCEPT':'application/json;odata=verbose','X-RequestDigest':RequestDigest},'success':function(_0x3f5f7a){var _0x4f3863=_0xe10a48;DeferredObj[_0x4f3863(0x231)](_0x3f5f7a['d']);},'error':function(_0x3dadc6){var _0x335453=_0xe10a48;DeferredObj[_0x335453(0x29c)](_0x3dadc6);}}),DeferredObj[_0xe10a48(0x217)]();}function Tablesorting(_0x2f80f9,_0x4e3231){var _0x350f5e=a329_0x223a7a,_0x7a39b5=$('#'+_0x2f80f9['id']+'')[_0x350f5e(0x208)](_0x350f5e(0x236))[_0x350f5e(0x234)]('=');_0x7a39b5[0x1]==_0x350f5e(0x21f)?$('#'+_0x2f80f9['id']+'')[_0x350f5e(0x208)]('name',_0x350f5e(0x1b6)):$('#'+_0x2f80f9['id']+'')[_0x350f5e(0x208)](_0x350f5e(0x236),_0x350f5e(0x240)),table[_0x350f5e(0x1ae)]([_0x4e3231,_0x7a39b5[0x1]])[_0x350f5e(0x22a)]();}function downloadfiles(){$('#SearchResultsGrid\x20input[type=checkbox]:checked')['each'](function(){var _0x3c2998=a329_0x2d2e,_0x2fb37d=$(this)[_0x3c2998(0x250)]('tr')[0x0],_0x69148f=$('#'+_0x2fb37d['cells'][0x1][_0x3c2998(0x1b4)][_0x3c2998(0x234)](_0x3c2998(0x24b))[0x1]['split']('\x20')[0x0][_0x3c2998(0x234)]('\x22')[0x0]+'')[_0x3c2998(0x208)](_0x3c2998(0x236)),_0x1549f2=_spPageContextInfo[_0x3c2998(0x228)]['slice'](0x0,-0x1)+_0x69148f;window[_0x3c2998(0x1e0)][_0x3c2998(0x286)]=_spPageContextInfo[_0x3c2998(0x1ff)]+'/_layouts/download.aspx?SourceUrl='+_0x1549f2;});}function exelExopt(){var _0x4c059f=a329_0x223a7a;if(getFileDetails[_0x4c059f(0x1c0)]>0x0){let _0x5286c0=getFileDetails['map'](function(_0x430277){var _0x3d96a5=_0x4c059f;return{'Name':_0x430277[_0x3d96a5(0x293)],'Title':_0x430277[_0x3d96a5(0x225)],'DocumentNo':_0x430277[_0x3d96a5(0x270)],'Details':_0x430277['Details'],'DocumentType':_0x430277['DocumentType'],'SubCategory':_0x430277['SubCategory'],'Author':_0x430277['Author'],'FileExtension':_0x430277[_0x3d96a5(0x263)],'FileVersion':_0x430277[_0x3d96a5(0x20f)],'Size':_0x430277[_0x3d96a5(0x220)],'Library':_0x430277[_0x3d96a5(0x273)],'FolderPath':_0x430277['FolderPath'],'LastModifiedTime':_0x430277[_0x3d96a5(0x257)]};});JSONToCSVConvertor(_0x5286c0,_0x4c059f(0x1ec),!![]);}else alert(_0x4c059f(0x23f));}function GetDocumentsSharedWithMeSearch(_0x340c6e){var _0x2d8acc=a329_0x223a7a;LoggedUserSPGp=GetSPGroupSearch();var _0x5e3462='';for(var _0x2c4aa1=0x0;_0x2c4aa1<LoggedUserSPGp[_0x2d8acc(0x1c0)];_0x2c4aa1++){_0x5e3462+=_0x2d8acc(0x1be)+LoggedUserSPGp[_0x2c4aa1]['Id']+'\x27\x20';}var _0x5b0359=getTargetGroupIdSearch();for(var _0x2c4aa1=0x0;_0x2c4aa1<_0x5b0359['length'];_0x2c4aa1++){_0x5e3462+=_0x2d8acc(0x1be)+_0x5b0359[_0x2c4aa1]+'\x27\x20';}_0x5e3462=_0x5e3462[_0x2d8acc(0x1ab)](0x0,_0x5e3462['length']-0x1)+')';if(_0x340c6e==_0x2d8acc(0x214))var _0x3f82b8='?$select=*,ID,SharedFrom,SharedType,DocumentNo,IsBlock,Details,ServerRedirectedEmbedURL,Title,DocumentURL,DocumentID,DocumentType,SharedGroup,PermissionStatus,PermissionType,SharedUsers/Title,SharedUsers/ID,Author/Title,Author/ID,Author/EMail,DOC_ID/ID,DOC_ID/Title,DOC_ID/DocumentNo,DOC_ID/DocumentType&$orderby=Modified\x20desc&$expand=DOC_ID,SharedUsers,Author&$filter=(Author/EMail\x20eq\x20\x27'+_spPageContextInfo['userEmail']+_0x2d8acc(0x242);else{if(_0x340c6e==_0x2d8acc(0x22d))var _0x3f82b8=_0x2d8acc(0x296)+_spPageContextInfo[_0x2d8acc(0x1a8)]+'\x27\x20'+_0x5e3462+_0x2d8acc(0x252);else var _0x3f82b8='?$select=*,ID,SharedFrom,SharedType,DocumentNo,IsBlock,Details,ServerRedirectedEmbedURL,Title,DocumentURL,DocumentID,DocumentType,SharedGroup,PermissionStatus,PermissionType,SharedUsers/Title,SharedUsers/ID,Author/Title,Author/ID,Author/EMail,DOC_ID/ID,DOC_ID/Title,DOC_ID/DocumentNo,DOC_ID/DocumentType&$orderby=Modified\x20desc&$expand=DOC_ID,SharedUsers,Author&$filter=(SharedUsers/Id\x20eq\x20\x27'+_spPageContextInfo[_0x2d8acc(0x1a8)]+'\x27\x20'+_0x5e3462+_0x2d8acc(0x1f5);}return $['when'](getItemsWithQuery(_0x2d8acc(0x1f2),_0x3f82b8,_spPageContextInfo['webAbsoluteUrl']))[_0x2d8acc(0x1fa)](function(_0x4e2f4d){var _0x565b74=_0x2d8acc;_0x340c6e=='SharedByMe'?arrSharedBy=_0x4e2f4d['filter'](function(_0x316f0c){return _0x316f0c;}):arrSharedTo=_0x4e2f4d[_0x565b74(0x24a)](function(_0x25ec46){return _0x25ec46;});}),arrSharedTo;}function getTargetGroupIdSearch(){var _0x34e93f=a329_0x223a7a,_0x129cd8=[],_0x11619f=_spPageContextInfo[_0x34e93f(0x1ff)]+'/_api/web/sitegroups/getbyname(\x27ALL_EMPLOYEE\x27)?$select=id';return $['ajax']({'url':_0x11619f,'type':'GET','headers':{'accept':_0x34e93f(0x1b3)},'async':![],'success':function(_0x147d58,_0x3cac1f,_0x44e4c4){var _0x362b08=_0x34e93f;_0x129cd8[_0x362b08(0x28a)](_0x147d58['d']['Id']);},'error':function(_0x1f9397,_0xf1cc55,_0x425c8d){var _0x34175a=_0x34e93f;console[_0x34175a(0x1af)](_0x1f9397[_0x34175a(0x229)]['error']);}}),_0x129cd8;}function GetSPGroupSearch(){var _0x8c0e4d=a329_0x223a7a,_0x5513b4=[],_0x1d86d3=_spPageContextInfo['webServerRelativeUrl']+_0x8c0e4d(0x2a7);return $[_0x8c0e4d(0x241)]({'url':_0x1d86d3,'method':_0x8c0e4d(0x210),'async':![],'contentType':_0x8c0e4d(0x1b3),'headers':{'Accept':_0x8c0e4d(0x1b3)},'success':function(_0x4eba1b){var _0x3433dd=_0x8c0e4d,_0x49b5cd=[];_0x49b5cd=_0x4eba1b['d'][_0x3433dd(0x1fe)][_0x3433dd(0x2a1)],_0x49b5cd[_0x3433dd(0x1c0)]>0x0&&(_0x5513b4=_0x49b5cd[_0x3433dd(0x24a)](function(_0x810302){var _0x19e274=_0x3433dd;return _0x810302[_0x19e274(0x284)]!==_0x19e274(0x27c)&&_0x810302[_0x19e274(0x225)]!==_0x19e274(0x1e7)&&_0x810302[_0x19e274(0x225)]!==_0x19e274(0x1cd)&&_0x810302['Title']!=='SPMember'&&_0x810302['Title']!==_0x19e274(0x223);}));},'eror':function(_0x49080b){var _0x48caa9=_0x8c0e4d;alert(JSON['stringify'](_0x49080b)),waitingDialog[_0x48caa9(0x25e)]();}}),_0x5513b4;}function GetFormDigestValue(_0x4e4d5c){var _0x57caab=a329_0x223a7a,_0x3aa52e=$[_0x57caab(0x1bf)]();return $['ajax']({'url':_0x4e4d5c+_0x57caab(0x235),'type':'POST','async':![],'headers':{'accept':_0x57caab(0x1b3)},'success':function(_0x4bbbe1){var _0x230d7e=_0x57caab,_0x133e15=_0x4bbbe1['d']['GetContextWebInformation']['FormDigestValue'];_0x3aa52e[_0x230d7e(0x231)](_0x133e15);},'error':function(_0x2aa43b,_0x1983b5,_0x55fa0a){var _0x41419f=_0x57caab;console[_0x41419f(0x1af)](_0x41419f(0x1fd));}}),_0x3aa52e[_0x57caab(0x217)]();}function removeDuplicates(_0x58a161){var _0x1bd822=a329_0x223a7a;let _0x5059ba={};return _0x58a161['filter'](_0x50c22b=>!_0x5059ba[_0x50c22b[_0x1bd822(0x218)]]&&(_0x5059ba[_0x50c22b[_0x1bd822(0x218)]]=!![]));}function getItemsWithQueryUsersDocuments(_0x3f2b53,_0x530659){var _0x2343bc=a329_0x223a7a,_0x251d0b=$[_0x2343bc(0x1bf)](),_0x1b82b2=_0x530659+_0x2343bc(0x274)+_0x3f2b53+_0x2343bc(0x1ba);return $[_0x2343bc(0x241)]({'url':_0x1b82b2,'type':'GET','async':![],'headers':{'accept':_0x2343bc(0x1b3)},'success':function(_0x1dd3a8){var _0x342291=_0x2343bc;_0x251d0b[_0x342291(0x231)](_0x1dd3a8['d']);},'error':function(_0x5a6848){var _0x1892d5=_0x2343bc;_0x251d0b[_0x1892d5(0x29c)](_0x5a6848),alert(_0x5a6848['responseJSON'][_0x1892d5(0x1b9)][_0x1892d5(0x238)]['value']);}}),_0x251d0b['promise']();}function getItemsInFolder(_0x10410e,_0xb18875,_0x6f81ba){var _0x3417c1=a329_0x223a7a,_0x302478=_0xb18875+_0x3417c1(0x1aa)+_0x10410e+_0x3417c1(0x216)+_0x3417c1(0x24c),_0x483740=jQuery[_0x3417c1(0x241)]({'url':_0x302478,'type':'POST','data':JSON[_0x3417c1(0x28d)]({'query':{'ViewXml':'','FolderServerRelativeUrl':_0x6f81ba}}),'headers':{'Accept':_0x3417c1(0x265),'Content-Type':_0x3417c1(0x265),'X-RequestDigest':jQuery(_0x3417c1(0x276))[_0x3417c1(0x1f8)]()}});_0x483740[_0x3417c1(0x1fa)](function(_0x5458fe,_0x3c4ce4,_0x78d17b){var _0x115450=_0x3417c1;debugger;jQuery[_0x115450(0x1ef)](_0x5458fe['value'],function(_0x2d470f,_0x18858c){});}),_0x483740['fail'](failHandler);}function JSONToCSVConvertor(_0x215266,_0x4ca740,_0x46e748){var _0x129feb=a329_0x223a7a,_0x12a93f=typeof _0x215266!=_0x129feb(0x1c7)?JSON[_0x129feb(0x1c1)](_0x215266):_0x215266,_0x505e8b='';_0x505e8b+=_0x4ca740+'\x0d\x0a\x0a';if(_0x46e748){var _0x5d5913='';for(var _0x1ba300 in _0x12a93f[0x0]){_0x5d5913+=_0x1ba300+',';}_0x5d5913=_0x5d5913['slice'](0x0,-0x1),_0x505e8b+=_0x5d5913+'\x0d\x0a';}for(var _0xaf5147=0x0;_0xaf5147<_0x12a93f[_0x129feb(0x1c0)];_0xaf5147++){var _0x5d5913='';for(var _0x1ba300 in _0x12a93f[_0xaf5147]){_0x5d5913+='\x22'+_0x12a93f[_0xaf5147][_0x1ba300]+'\x22,';}_0x5d5913[_0x129feb(0x224)](0x0,_0x5d5913[_0x129feb(0x1c0)]-0x1),_0x505e8b+=_0x5d5913+'\x0d\x0a';}if(_0x505e8b==''){alert(_0x129feb(0x1b0));return;}var _0x424e23=_0x129feb(0x20e);_0x424e23+=_0x4ca740[_0x129feb(0x246)](/ /g,'_');var _0xd6d565='data:text/csv;charset=utf-8,'+escape(_0x505e8b),_0x37c3df=document[_0x129feb(0x23c)]('a');_0x37c3df[_0x129feb(0x286)]=_0xd6d565,_0x37c3df[_0x129feb(0x1b2)]='visibility:hidden',_0x37c3df[_0x129feb(0x1a7)]=_0x424e23+_0x129feb(0x271),document[_0x129feb(0x279)][_0x129feb(0x258)](_0x37c3df),_0x37c3df[_0x129feb(0x201)](),document[_0x129feb(0x279)][_0x129feb(0x1b7)](_0x37c3df);}