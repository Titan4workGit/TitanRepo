var a507_0x2cffb1=a507_0x30a4;(function(_0x1066b7,_0x1f0ff0){var _0x56b8ed=a507_0x30a4,_0x42cefb=_0x1066b7();while(!![]){try{var _0x46a754=-parseInt(_0x56b8ed(0x229))/0x1*(parseInt(_0x56b8ed(0x2ac))/0x2)+-parseInt(_0x56b8ed(0x2e4))/0x3+parseInt(_0x56b8ed(0x30b))/0x4*(-parseInt(_0x56b8ed(0x265))/0x5)+-parseInt(_0x56b8ed(0x33f))/0x6*(parseInt(_0x56b8ed(0x2dd))/0x7)+-parseInt(_0x56b8ed(0x2a4))/0x8+parseInt(_0x56b8ed(0x35e))/0x9*(parseInt(_0x56b8ed(0x29f))/0xa)+parseInt(_0x56b8ed(0x252))/0xb;if(_0x46a754===_0x1f0ff0)break;else _0x42cefb['push'](_0x42cefb['shift']());}catch(_0x9fbd93){_0x42cefb['push'](_0x42cefb['shift']());}}}(a507_0x1f7e,0x59215));var IsFirstTime=!![],token='',AvilableLicense='';$(document)['ready'](function(){var _0x463b57=a507_0x30a4;$('[data-toggle=\x22tooltip\x22]')[_0x463b57(0x261)](),AvilableLicense=GetAvailbleLicence(),$('#hAvilableLicenses')['text'](AvilableLicense),IsAdmin(),LoadProject(),getTemplate();});function IsAdmin(){var _0x2d91f3=a507_0x30a4;$[_0x2d91f3(0x2fa)](CommonFunction['AdministratorUsers']())[_0x2d91f3(0x1e0)](function(_0x32a1eb){var _0x41e9f0=_0x2d91f3;if(_0x32a1eb)IsTechadmin=![];else return $(_0x41e9f0(0x275))[_0x41e9f0(0x21c)](''),htmlNotAuthorized+=_0x41e9f0(0x350),htmlNotAuthorized+='<span><h3\x20class=\x22red-color\x20text-center\x20mt-25\x22>Only\x20Tech-Admin\x20with\x20site-collection\x20admin\x20permission\x20can\x20access\x20this\x20page.\x20</h3></span><br>',htmlNotAuthorized+=_0x41e9f0(0x274),htmlNotAuthorized+=_0x41e9f0(0x2ae),$(_0x41e9f0(0x275))['append'](htmlNotAuthorized),![];});}function initializePeoplePicker(_0x1e8242,_0x3d3ce8){var _0x3c68dc=a507_0x30a4,_0x2eaba4={};_0x2eaba4[_0x3c68dc(0x34c)]=_0x3c68dc(0x1ca),_0x2eaba4[_0x3c68dc(0x29e)]=0xf,_0x2eaba4[_0x3c68dc(0x2d3)]=0xf,_0x2eaba4[_0x3c68dc(0x2f7)]=_0x3d3ce8,_0x2eaba4[_0x3c68dc(0x2ee)]=0x32,_0x2eaba4[_0x3c68dc(0x21e)]=_0x3c68dc(0x34e),this[_0x3c68dc(0x296)](_0x1e8242,null,_0x2eaba4),$(_0x3c68dc(0x32a))[_0x3c68dc(0x2af)](0x12c);}function setPeoplePickerUsersInfoCurrent(_0x3d9a92,_0x22c0cb){var _0x4ede7a=a507_0x30a4,_0x5ae5a2=$('[id$=\x27'+_0x3d9a92+'\x27]'),_0x5b6fd6=SPClientPeoplePicker[_0x4ede7a(0x2a8)][_0x5ae5a2[0x0]['id']];_0x5b6fd6[_0x4ede7a(0x21d)](_0x22c0cb,![]),_0x5b6fd6['SetEnabledState'](![]);}var peoplePickerDiv='',peoplePickerDivsuper='',email='',htmlGridarray=[],IsSetvalue=![],GroupId='',GuestUserEmail='',ExtrnaluserId='',chkInitiated='',chkInvited='',chkActive='',chkInactive='',Isfillter=![],userListItemId='',GuestUserEmail='',UserListId=[],Client_Id;$(function(){var _0x5a55f3=a507_0x30a4;$(_0x5a55f3(0x2b8))[_0x5a55f3(0x359)]({'changeMonth':!![],'changeYear':!![],'minDate':0x0});}),$(function(){var _0x3d582a=a507_0x30a4;$(_0x3d582a(0x32c))[_0x3d582a(0x359)]({'changeMonth':!![],'changeYear':!![],'minDate':0x0});});var Initiated='',Invited='',Active='',Inactive='',Accepted='',NotAccepted='';$('#Initiated')['on'](a507_0x2cffb1(0x2f5),function(){var _0x48537e=a507_0x2cffb1;this[_0x48537e(0x1a0)]?Initiated=_0x48537e(0x2a5):Initiated='';}),$(a507_0x2cffb1(0x226))['on'](a507_0x2cffb1(0x2f5),function(){var _0x3e307a=a507_0x2cffb1;this['checked']?Invited=_0x3e307a(0x26e):Invited='';}),$('#Accepted')['on'](a507_0x2cffb1(0x2f5),function(){var _0x106290=a507_0x2cffb1;this[_0x106290(0x1a0)]?Accepted=_0x106290(0x2e7):Accepted='';}),$(a507_0x2cffb1(0x1cf))['on'](a507_0x2cffb1(0x2f5),function(){var _0x308504=a507_0x2cffb1;this[_0x308504(0x1a0)]?Active=_0x308504(0x1d5):Active='';}),$(a507_0x2cffb1(0x24c))['on'](a507_0x2cffb1(0x2f5),function(){var _0x5d66df=a507_0x2cffb1;this[_0x5d66df(0x1a0)]?Inactive=_0x5d66df(0x219):Inactive='';}),$(a507_0x2cffb1(0x1e1))['on']('change',function(){var _0x2abf30=a507_0x2cffb1;this[_0x2abf30(0x1a0)]?NotAccepted='(Status\x20eq\x20\x27Invited\x27)':NotAccepted='';}),$(a507_0x2cffb1(0x2da))[a507_0x2cffb1(0x2f5)](function(){readURL(this);}),$(a507_0x2cffb1(0x314))[a507_0x2cffb1(0x1c7)](function(){AvilableLicense>0x0?UpdateGeustuser(ExtrnaluserId):alert('Your\x20license\x20limit\x20has\x20overed.');}),$('#txtExtEmail')[a507_0x2cffb1(0x35c)](function(){var _0x314296=a507_0x2cffb1;$[_0x314296(0x2fa)](GetGueastUsers($(_0x314296(0x1e9))['val']()))[_0x314296(0x1e0)](function(_0x44e22e){var _0x27fc80=_0x314296;_0x44e22e[_0x27fc80(0x1b4)]>0x0&&(creationType=_0x44e22e[0x0]['creationType'],externalUserState=_0x44e22e[0x0][_0x27fc80(0x31c)]);});if(externalUserState=='Accepted')Pertimtblock($(_0x314296(0x1e9))['val']());else{for(var _0x3c8ea2 in htmlGridarray){if(htmlGridarray[_0x3c8ea2][_0x314296(0x1f4)]==$(_0x314296(0x1e9))[_0x314296(0x1ee)]()){htmlGridarray[_0x3c8ea2]['externalUserState']=_0x314296(0x361);break;}}GenerateGridHtml(htmlGridarray),$(_0x314296(0x208))[_0x314296(0x320)](_0x314296(0x245)),$('.check-status-user-detail')[_0x314296(0x260)]('');var _0x2cc12b=_0x314296(0x2f8);$(_0x314296(0x2cf))['text'](_0x2cc12b),$(_0x314296(0x251))[_0x314296(0x1d3)](),$('.check-icon')['hide'](),$('#check-status')['modal'](_0x314296(0x1d3)),$(_0x314296(0x1cb))[_0x314296(0x1d3)]();}});var IscheckInvite=!![];$(a507_0x2cffb1(0x2f0))[a507_0x2cffb1(0x35c)](function(){var _0x285694=a507_0x2cffb1;$[_0x285694(0x2fa)](GetItemToList($(_0x285694(0x2f0))[_0x285694(0x1ee)]()))[_0x285694(0x1e0)](function(_0xb590c4){var _0x100aad=_0x285694;_0xb590c4[_0x100aad(0x1b4)]>0x0?(SetTextBox(_0xb590c4[0x0]['Id'],_0x100aad(0x331)),$(_0x100aad(0x2f0))[_0x100aad(0x1ec)]('disabled')):(IscheckInvite=![],Getinvitebox(),IscheckInvite=!![]);});}),$(a507_0x2cffb1(0x1cb))['click'](function(){InviteuserSendReminder();}),$(a507_0x2cffb1(0x27f))[a507_0x2cffb1(0x1c7)](function(){var _0x33fff0=a507_0x2cffb1;GetClientMasterfilter();var _0x1d20d3=$(_0x33fff0(0x35f));_0x1d20d3[_0x33fff0(0x1b7)](_0x33fff0(0x278),_0x33fff0(0x23d))[_0x33fff0(0x260)](_0x33fff0(0x23d)),$(_0x33fff0(0x2c8))[_0x33fff0(0x2b5)](_0x1d20d3);for(var _0x2366d4=0x0;_0x2366d4<ClientInternalMembers[_0x33fff0(0x1b4)];_0x2366d4++){_0x1d20d3=$(_0x33fff0(0x35f)),_0x1d20d3[_0x33fff0(0x1b7)](_0x33fff0(0x278),ClientInternalMembers[_0x2366d4][_0x33fff0(0x1e8)])[_0x33fff0(0x260)](ClientInternalMembers[_0x2366d4]['Title']),$('#orgselectpicker')[_0x33fff0(0x2b5)](_0x1d20d3);}create_custom_dropdowns();});function create_custom_dropdowns(){var _0x47b03d=a507_0x2cffb1;$(_0x47b03d(0x2c8))[_0x47b03d(0x1a3)](function(_0xea0078,_0x5352c9){var _0x17b78d=_0x47b03d;if(!$(this)[_0x17b78d(0x288)]()[_0x17b78d(0x21b)](_0x17b78d(0x2c1))){$(this)[_0x17b78d(0x223)](_0x17b78d(0x26a)+($(this)['attr'](_0x17b78d(0x1b1))||'')+_0x17b78d(0x297));var _0x436d8c=$(this)[_0x17b78d(0x288)](),_0xb77618=$(_0x5352c9)[_0x17b78d(0x214)](_0x17b78d(0x329)),_0x2128d2=$(this)[_0x17b78d(0x214)](_0x17b78d(0x1a9));_0x436d8c[_0x17b78d(0x214)]('.current')[_0x17b78d(0x21c)](_0x2128d2[_0x17b78d(0x23f)](_0x17b78d(0x27d))||_0x2128d2[_0x17b78d(0x260)]()),_0xb77618[_0x17b78d(0x1a3)](function(_0x21690a,_0x4dad88){var _0x256b14=_0x17b78d,_0x551fe8=$(_0x4dad88)['data'](_0x256b14(0x27d))||'';_0x436d8c[_0x256b14(0x214)]('ul')[_0x256b14(0x2b5)](_0x256b14(0x338)+($(_0x4dad88)['is'](':selected')?_0x256b14(0x2fd):'')+_0x256b14(0x282)+$(_0x4dad88)[_0x256b14(0x1ee)]()+_0x256b14(0x298)+_0x551fe8+'\x22>'+$(_0x4dad88)[_0x256b14(0x260)]()+_0x256b14(0x2b2));});}});var _0xdb639b=$(_0x47b03d(0x230))[_0x47b03d(0x214)](_0x47b03d(0x240));_0xdb639b[_0x47b03d(0x1b4)]==0x0&&$(_0x47b03d(0x25b))[_0x47b03d(0x2ba)](_0x47b03d(0x21a));}$(document)['on']('click','.dropdown-select',function(_0x219147){var _0x391461=a507_0x2cffb1;if($(_0x219147[_0x391461(0x1b3)])[_0x391461(0x21b)]('dd-searchbox'))return;$(_0x391461(0x355))[_0x391461(0x32b)]($(this))['removeClass'](_0x391461(0x215)),$(this)[_0x391461(0x20b)](_0x391461(0x215)),$(this)[_0x391461(0x21b)](_0x391461(0x215))?($(this)['find']('.option')[_0x391461(0x1b7)]('tabindex',0x0),$(this)[_0x391461(0x214)](_0x391461(0x345))[_0x391461(0x213)]()):($(this)[_0x391461(0x214)](_0x391461(0x2ef))['removeAttr']('tabindex'),$(this)[_0x391461(0x213)]());}),$(document)['on']('click',function(_0xee9e9e){var _0x35c02e=a507_0x2cffb1;$(_0xee9e9e[_0x35c02e(0x1b3)])[_0x35c02e(0x1a1)]('.dropdown-select')[_0x35c02e(0x1b4)]===0x0&&($(_0x35c02e(0x355))[_0x35c02e(0x1a2)](_0x35c02e(0x215)),$(_0x35c02e(0x23c))['removeAttr'](_0x35c02e(0x287))),_0xee9e9e[_0x35c02e(0x1c6)]();});function filters(){var _0x1aa9dd=a507_0x2cffb1;debugger;var _0x2ebce7=$('#txtSearchValue')[_0x1aa9dd(0x1ee)]();$(_0x1aa9dd(0x221))[_0x1aa9dd(0x1a3)](function(){var _0x28fde4=_0x1aa9dd,_0x181f9f=$(this)[_0x28fde4(0x260)]();_0x181f9f[_0x28fde4(0x220)]()[_0x28fde4(0x1dd)](_0x2ebce7[_0x28fde4(0x220)]())>-0x1?$(this)['show']():$(this)[_0x28fde4(0x245)]();});};function a507_0x30a4(_0x90374,_0x571258){var _0x1f7e3e=a507_0x1f7e();return a507_0x30a4=function(_0x30a4e0,_0x3d232c){_0x30a4e0=_0x30a4e0-0x19d;var _0x58223c=_0x1f7e3e[_0x30a4e0];return _0x58223c;},a507_0x30a4(_0x90374,_0x571258);}$(document)['on'](a507_0x2cffb1(0x1c7),a507_0x2cffb1(0x23c),function(_0x3aafee){var _0x547ebf=a507_0x2cffb1;$(this)['closest']('.list')[_0x547ebf(0x214)](_0x547ebf(0x2c8))['removeClass'](_0x547ebf(0x2fd)),$(this)[_0x547ebf(0x1c2)]('');var _0x1e2e8d=$(this)['data'](_0x547ebf(0x27d))||$(this)[_0x547ebf(0x260)]();$(this)[_0x547ebf(0x1a1)](_0x547ebf(0x355))[_0x547ebf(0x214)]('.current')['text'](_0x1e2e8d),$(this)[_0x547ebf(0x1a1)](_0x547ebf(0x355))[_0x547ebf(0x1bf)](_0x547ebf(0x2c8))[_0x547ebf(0x1ee)]($(this)['data'](_0x547ebf(0x278)))[_0x547ebf(0x2a0)]('change'),$(_0x547ebf(0x240))['val'](''),filters();}),$(document)['on'](a507_0x2cffb1(0x1c4),a507_0x2cffb1(0x355),function(_0x177f08){var _0x2ec432=a507_0x2cffb1,_0x5b23c4=$($(this)[_0x2ec432(0x214)](_0x2ec432(0x2a6))[0x0]||$(this)[_0x2ec432(0x214)]('.list\x20.option.selected')[0x0]);if(_0x177f08[_0x2ec432(0x217)]==0xd)return $(this)['hasClass'](_0x2ec432(0x215))?_0x5b23c4[_0x2ec432(0x2a0)](_0x2ec432(0x1c7)):$(this)[_0x2ec432(0x2a0)](_0x2ec432(0x1c7)),![];else{if(_0x177f08['keyCode']==0x28)return!$(this)['hasClass'](_0x2ec432(0x215))?$(this)[_0x2ec432(0x2a0)](_0x2ec432(0x1c7)):_0x5b23c4[_0x2ec432(0x288)]()[_0x2ec432(0x213)](),![];else{if(_0x177f08[_0x2ec432(0x217)]==0x26){if(!$(this)['hasClass'](_0x2ec432(0x215)))$(this)[_0x2ec432(0x2a0)](_0x2ec432(0x1c7));else{var _0x5b23c4=$($(this)[_0x2ec432(0x214)](_0x2ec432(0x2a6))[0x0]||$(this)[_0x2ec432(0x214)]('.list\x20.option.selected')[0x0]);_0x5b23c4['prev']()[_0x2ec432(0x213)]();}return![];}else{if(_0x177f08[_0x2ec432(0x217)]==0x1b)return $(this)[_0x2ec432(0x21b)]('open')&&$(this)['trigger']('click'),![];}}}});function Getfilterdata(){Isfillter=!![],LoadProject();}function Clearfilter(){var _0x3a35cc=a507_0x2cffb1;$(_0x3a35cc(0x2cd))[_0x3a35cc(0x330)]('checked',![]),Isfillter=![],LoadProject();}var GI=0x0,GLength=0x0;function LoadProject(){var _0x2f29ac=a507_0x2cffb1;addSpinner($('body')),$[_0x2f29ac(0x2fa)](GetExternalUsers())['done'](function(_0xbd11de){var _0x36e0b1=_0x2f29ac;try{token=localStorage[_0x36e0b1(0x1fe)](_0x36e0b1(0x2c7));if(token==null||token=='')authContext[_0x36e0b1(0x1af)](_0x36e0b1(0x26f),function(_0x320cd8,_0x2f73b3){var _0x2a7ecf=_0x36e0b1;console[_0x2a7ecf(0x2c6)](_0x2f73b3),console[_0x2a7ecf(0x2c6)](_0x320cd8);if(_0x320cd8||!_0x2f73b3)return;localStorage[_0x2a7ecf(0x30e)](_0x2a7ecf(0x2c7),_0x2f73b3),_0x2f73b3=localStorage['getItem'](_0x2a7ecf(0x2c7)),token1=localStorage['getItem']('logintoken');}),LoadProject();else{htmlGridarray=[];var _0x5c2244=0x0;GLength=_0xbd11de[_0x36e0b1(0x1b4)];for(GI=0x0;GI<_0xbd11de[_0x36e0b1(0x1b4)];GI++){_0x5c2244=GI;var _0x4d5a54=new Date(_0xbd11de[_0x5c2244][_0x36e0b1(0x1ff)]),_0x375517='',_0xc83644='';_0xbd11de[_0x5c2244][_0x36e0b1(0x268)]==_0x36e0b1(0x1f7)?$['when'](GetGueastUsers(_0xbd11de[_0x5c2244]['email']))[_0x36e0b1(0x1e0)](function(_0x24f186){var _0x3cb40a=_0x36e0b1;_0x24f186[_0x3cb40a(0x1b4)]>0x0&&(_0x375517=_0x24f186[0x0][_0x3cb40a(0x26c)],_0xc83644=_0x24f186[0x0]['externalUserState'],htmlGridarray[_0x3cb40a(0x325)]({'creationType':_0x375517,'externalUserState':_0xc83644,'Title':_0xbd11de[_0x5c2244][_0x3cb40a(0x303)][_0x3cb40a(0x1e8)]?_0xbd11de[_0x5c2244][_0x3cb40a(0x303)][_0x3cb40a(0x1e8)]:_0xbd11de[_0x5c2244]['Guest_name'],'email':_0xbd11de[_0x5c2244][_0x3cb40a(0x1f4)],'Designation':_0xbd11de[_0x5c2244]['Designation']?_0xbd11de[_0x5c2244][_0x3cb40a(0x2c2)]:'','CollaborationType':_0xbd11de[_0x5c2244][_0x3cb40a(0x243)]?_0xbd11de[_0x5c2244][_0x3cb40a(0x243)]:'','ClientName':_0xbd11de[_0x5c2244][_0x3cb40a(0x34a)]['Title'],'Status':_0xbd11de[_0x5c2244]['Status'],'ID':_0xbd11de[_0x5c2244]['Id'],'ValidUpto':_0xbd11de[_0x5c2244][_0x3cb40a(0x22a)],'ReferenceCode':_0xbd11de[_0x5c2244]['ReferenceCode'],'Modified':$[_0x3cb40a(0x359)]['formatDate']('d\x20M,\x20yy\x20',_0x4d5a54)}));}):htmlGridarray['push']({'creationType':_0x375517,'externalUserState':_0xc83644,'Title':_0xbd11de[_0x5c2244][_0x36e0b1(0x303)][_0x36e0b1(0x1e8)]?_0xbd11de[_0x5c2244][_0x36e0b1(0x303)][_0x36e0b1(0x1e8)]:_0xbd11de[_0x5c2244][_0x36e0b1(0x1c5)],'email':_0xbd11de[_0x5c2244][_0x36e0b1(0x1f4)],'Designation':_0xbd11de[_0x5c2244][_0x36e0b1(0x2c2)],'CollaborationType':_0xbd11de[_0x5c2244][_0x36e0b1(0x243)]?_0xbd11de[_0x5c2244]['CollaborationType']:'','ClientName':_0xbd11de[_0x5c2244]['Client_Name']['Title'],'Status':_0xbd11de[_0x5c2244][_0x36e0b1(0x268)],'ID':_0xbd11de[_0x5c2244]['Id'],'ValidUpto':_0xbd11de[_0x5c2244][_0x36e0b1(0x22a)],'ReferenceCode':_0xbd11de[_0x5c2244][_0x36e0b1(0x363)],'Modified':$['datepicker'][_0x36e0b1(0x1ae)](_0x36e0b1(0x200),_0x4d5a54)});}GenerateGridHtml(htmlGridarray),removeSpinner($(_0x36e0b1(0x30f)));}}catch(_0x40cfbe){return alert(_0x5c2244+_0x36e0b1(0x286)+_0x40cfbe),![];}});}function GenerateGridHtml(_0x4bb8b6){var _0x241276=a507_0x2cffb1,_0x23fb68='';$(_0x241276(0x317))[_0x241276(0x21c)](''),_0x23fb68+='<thead>'+'<tr>'+'\x20<th\x20class=\x22text-left\x20border-bottom-0\x22><b>User\x20Name</b></th>'+'\x20<th\x20class=\x22text-left\x20border-bottom-0\x22\x20><b>Email</b></th>'+_0x241276(0x2eb)+'\x20<th\x20class=\x22text-left\x20border-bottom-0\x22><b>Type</b></th>'+_0x241276(0x1de)+'\x20<th\x20class=\x22text-left\x20border-bottom-0\x22><b>Status</b></th>'+_0x241276(0x238)+'\x20</tr>'+'</thead>'+_0x241276(0x336);if(htmlGridarray['length']>0x0){for(var _0x3de35a=0x0;_0x3de35a<htmlGridarray['length'];_0x3de35a++){if(htmlGridarray[_0x3de35a][_0x241276(0x31c)]==_0x241276(0x361))_0x23fb68+='<tr\x20class=\x22text-left\x22>'+'<td>'+htmlGridarray[_0x3de35a][_0x241276(0x1e8)]+_0x241276(0x1b6)+'<td>'+htmlGridarray[_0x3de35a]['email']+'</td>'+_0x241276(0x1bb)+htmlGridarray[_0x3de35a][_0x241276(0x1ff)]+'</td>'+_0x241276(0x1bb)+htmlGridarray[_0x3de35a]['CollaborationType']+'</td>'+_0x241276(0x1bb)+_0x241276(0x19e)+htmlGridarray[_0x3de35a][_0x241276(0x34b)]+'</div>'+_0x241276(0x24f)+_0x241276(0x340)+_0x241276(0x2e5)+'<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20Invited\x22><a\x20href=\x22#\x22>Invited</a></li>'+_0x241276(0x2ec)+_0x241276(0x241)+_0x241276(0x2c4)+'</div>'+_0x241276(0x1b6)+_0x241276(0x2ab)+'<td>'+_0x241276(0x27c)+_0x241276(0x2f1)+htmlGridarray[_0x3de35a]['ID']+')\x22\x20\x20data-original-title=\x22Check\x22>'+'<i\x20class=\x22fa\x20fa-question-circle-o\x22></i>'+_0x241276(0x2a1)+_0x241276(0x232)+htmlGridarray[_0x3de35a]['ID']+',\x27'+htmlGridarray[_0x3de35a][_0x241276(0x1f4)]+_0x241276(0x349)+'<i\x20class=\x22fa\x20fa-trash-o\x22></i>'+_0x241276(0x2a1)+_0x241276(0x31f)+_0x241276(0x1b6)+_0x241276(0x29d);else{if(htmlGridarray[_0x3de35a]['externalUserState']==_0x241276(0x2d4)||htmlGridarray[_0x3de35a][_0x241276(0x268)]==_0x241276(0x2d4)){var _0x57d3f8=_0x241276(0x307);_0x23fb68+='<tr\x20class=\x22text-left\x22>'+_0x241276(0x1bb)+htmlGridarray[_0x3de35a][_0x241276(0x1e8)]+_0x241276(0x1b6)+_0x241276(0x1bb)+htmlGridarray[_0x3de35a][_0x241276(0x1f4)]+_0x241276(0x1b6)+'<td>'+htmlGridarray[_0x3de35a][_0x241276(0x1ff)]+_0x241276(0x1b6)+_0x241276(0x1bb)+htmlGridarray[_0x3de35a][_0x241276(0x243)]+_0x241276(0x1b6)+_0x241276(0x1bb)+_0x241276(0x19e)+htmlGridarray[_0x3de35a][_0x241276(0x34b)]+'</div>'+_0x241276(0x24f)+_0x241276(0x340)+_0x241276(0x2e5)+_0x241276(0x33e)+_0x241276(0x327)+_0x241276(0x241)+'</ul>'+'</div>'+_0x241276(0x1b6)+'<td>Invitation\x20Accepted</td>'+'<td>'+_0x241276(0x27c)+'<a\x20type=\x22button\x22\x20type=\x22button\x22\x20class=\x22custom-edit-btn\x22\x20\x20\x20data-toggle=\x22modal\x22\x20onclick=\x22SetTextBox('+htmlGridarray[_0x3de35a]['ID']+',\x27'+_0x57d3f8+_0x241276(0x258)+_0x241276(0x2d9)+_0x241276(0x2a1)+_0x241276(0x2a3)+htmlGridarray[_0x3de35a]['ID']+',\x27'+htmlGridarray[_0x3de35a][_0x241276(0x1f4)]+'\x27)\x22\x20data-placement=\x22top\x22\x20title=\x22Delete\x22>'+_0x241276(0x2e8)+_0x241276(0x2a1)+_0x241276(0x31f)+_0x241276(0x1b6)+_0x241276(0x29d),htmlGridarray[_0x3de35a][_0x241276(0x268)]==_0x241276(0x1f7)&&UpdateGeustuserInvite(htmlGridarray[_0x3de35a]['ID'],_0x241276(0x2d4));}else{if(htmlGridarray[_0x3de35a][_0x241276(0x268)]==_0x241276(0x1f7))_0x23fb68+='<tr\x20class=\x22text-left\x22>'+_0x241276(0x1bb)+htmlGridarray[_0x3de35a][_0x241276(0x1e8)]+_0x241276(0x1b6)+_0x241276(0x1bb)+htmlGridarray[_0x3de35a][_0x241276(0x1f4)]+_0x241276(0x1b6)+_0x241276(0x1bb)+htmlGridarray[_0x3de35a][_0x241276(0x1ff)]+_0x241276(0x1b6)+_0x241276(0x1bb)+htmlGridarray[_0x3de35a][_0x241276(0x243)]+_0x241276(0x1b6)+_0x241276(0x1bb)+_0x241276(0x205)+htmlGridarray[_0x3de35a][_0x241276(0x34b)]+'</div>'+'<div\x20class=\x22form-wizard\x20centered-pills\x22\x20>'+_0x241276(0x340)+'<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20Initiated\x22><a\x20href=\x22#\x22>Initiated</a></li>'+_0x241276(0x33e)+_0x241276(0x315)+'\x20<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20\x22><a\x20href=\x22#\x22>Active</a></li>'+_0x241276(0x2c4)+_0x241276(0x31f)+_0x241276(0x1b6)+_0x241276(0x2ab)+_0x241276(0x1bb)+_0x241276(0x27c)+_0x241276(0x2f1)+htmlGridarray[_0x3de35a]['ID']+')\x22\x20data-original-title=\x22Check\x22>'+_0x241276(0x2f9)+_0x241276(0x2a1)+'<a\x20type=\x22button\x22\x20type=\x22button\x22\x20class=\x22custom-edit-btn\x22\x20data-toggle=\x22tooltip\x22\x20onclick=\x22DeleteHtmlRow('+htmlGridarray[_0x3de35a]['ID']+',\x27'+htmlGridarray[_0x3de35a][_0x241276(0x1f4)]+'\x27)\x22\x20data-placement=\x22top\x22\x20title=\x22Delete\x22>'+_0x241276(0x2e8)+_0x241276(0x2a1)+_0x241276(0x31f)+'</td>'+_0x241276(0x29d);else{if(htmlGridarray[_0x3de35a][_0x241276(0x268)]==_0x241276(0x2f2)){var _0x57d3f8=_0x241276(0x307);_0x23fb68+=_0x241276(0x30c)+_0x241276(0x1bb)+htmlGridarray[_0x3de35a]['Title']+_0x241276(0x1b6)+_0x241276(0x1bb)+htmlGridarray[_0x3de35a][_0x241276(0x1f4)]+'</td>'+'<td>'+htmlGridarray[_0x3de35a]['Modified']+_0x241276(0x1b6)+_0x241276(0x1bb)+htmlGridarray[_0x3de35a][_0x241276(0x243)]+_0x241276(0x1b6)+_0x241276(0x1bb)+_0x241276(0x19e)+htmlGridarray[_0x3de35a][_0x241276(0x34b)]+_0x241276(0x31f)+'<div\x20class=\x22form-wizard\x20centered-pills\x22\x20>'+'<ul\x20class=\x22nav\x20nav-pills\x22>'+_0x241276(0x2e5)+_0x241276(0x33e)+_0x241276(0x327)+_0x241276(0x2c5)+'</ul>'+_0x241276(0x31f)+_0x241276(0x1b6)+'<td>Active</td>'+_0x241276(0x1bb)+_0x241276(0x27c)+_0x241276(0x2dc)+htmlGridarray[_0x3de35a]['ID']+',\x27'+_0x57d3f8+'\x27)\x22\x20data-target=\x22#Permitting-into-Portal\x22\x20title=\x22Edit\x22>'+'<i\x20class=\x22fa\x20fa-pencil\x22></i>'+'</a>'+_0x241276(0x2a3)+htmlGridarray[_0x3de35a]['ID']+',\x27'+htmlGridarray[_0x3de35a]['email']+'\x27)\x22\x20data-placement=\x22top\x22\x20title=\x22Delete\x22>'+_0x241276(0x2e8)+_0x241276(0x2a1)+'</div>'+_0x241276(0x1b6)+_0x241276(0x29d);}else{if(htmlGridarray[_0x3de35a][_0x241276(0x268)]==_0x241276(0x210)){var _0x57d3f8=_0x241276(0x307);_0x23fb68+=_0x241276(0x30c)+_0x241276(0x1bb)+htmlGridarray[_0x3de35a][_0x241276(0x1e8)]+_0x241276(0x1b6)+'<td>'+htmlGridarray[_0x3de35a][_0x241276(0x1f4)]+_0x241276(0x1b6)+_0x241276(0x1bb)+htmlGridarray[_0x3de35a]['Modified']+_0x241276(0x1b6)+_0x241276(0x1bb)+htmlGridarray[_0x3de35a][_0x241276(0x243)]+_0x241276(0x1b6)+'<td>'+'<div\x20\x20>'+htmlGridarray[_0x3de35a][_0x241276(0x34b)]+_0x241276(0x31f)+_0x241276(0x24f)+_0x241276(0x340)+_0x241276(0x2e5)+_0x241276(0x33e)+'<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20Accepted\x22><a\x20href=\x22#\x22>Accepted</a></li>'+_0x241276(0x1a7)+_0x241276(0x2c4)+_0x241276(0x31f)+'</td>'+_0x241276(0x267)+_0x241276(0x1bb)+_0x241276(0x27c)+_0x241276(0x2dc)+htmlGridarray[_0x3de35a]['ID']+',\x27'+_0x57d3f8+_0x241276(0x2fc)+'<i\x20class=\x22fa\x20fa-pencil\x22></i>'+_0x241276(0x2a1)+_0x241276(0x2a3)+htmlGridarray[_0x3de35a]['ID']+',\x27'+htmlGridarray[_0x3de35a]['email']+'\x27)\x22\x20data-placement=\x22top\x22\x20title=\x22Delete\x22>'+_0x241276(0x2e8)+_0x241276(0x2a1)+_0x241276(0x31f)+_0x241276(0x1b6)+_0x241276(0x29d);}else _0x23fb68+=_0x241276(0x30c)+_0x241276(0x1bb)+htmlGridarray[_0x3de35a]['Title']+_0x241276(0x1b6)+_0x241276(0x1bb)+htmlGridarray[_0x3de35a][_0x241276(0x1f4)]+_0x241276(0x1b6)+'<td>'+htmlGridarray[_0x3de35a][_0x241276(0x1ff)]+_0x241276(0x1b6)+'<td>'+htmlGridarray[_0x3de35a][_0x241276(0x243)]+_0x241276(0x1b6)+'<td>'+_0x241276(0x19e)+htmlGridarray[_0x3de35a][_0x241276(0x34b)]+_0x241276(0x31f)+_0x241276(0x24f)+'<ul\x20class=\x22nav\x20nav-pills\x22>'+_0x241276(0x2e5)+_0x241276(0x292)+_0x241276(0x315)+_0x241276(0x20e)+_0x241276(0x2b3)+_0x241276(0x31f)+'</td>'+'<td>Request\x20to\x20Invite</td>'+_0x241276(0x1bb)+'<div\x20class=\x22guesr-user-edit-lock-btn-box\x22>'+_0x241276(0x24d)+htmlGridarray[_0x3de35a]['ID']+_0x241276(0x24e)+_0x241276(0x249)+_0x241276(0x2a1)+_0x241276(0x232)+htmlGridarray[_0x3de35a]['ID']+',\x27'+htmlGridarray[_0x3de35a][_0x241276(0x1f4)]+'\x27)\x22\x20data-placement=\x22top\x22\x20title=\x22Delete\x22>'+_0x241276(0x2e8)+'</a>'+_0x241276(0x31f)+_0x241276(0x1b6)+'</tr>';}}}}}_0x23fb68+=_0x241276(0x318);}$(_0x241276(0x317))[_0x241276(0x21c)](_0x23fb68),$['fn'][_0x241276(0x29b)][_0x241276(0x295)](_0x241276(0x317))?(table[_0x241276(0x26b)](),table=$(_0x241276(0x317))['DataTable']({'bPaginate':!![],'bJQueryUI':!![],'bLengthChange':![],'bFilter':!![],'bSort':!![],'bInfo':!![],'bAutoWidth':!![],'bProcessing':!![],'iDisplayLength':0xa,'dom':_0x241276(0x31a),'colReorder':{'allowReorder':!![]},'language':{'searchPlaceholder':'Search'},'columnDefs':[{'width':0x96,'targets':0x1}]})):table=$('#TableGrid')['DataTable']({'bPaginate':!![],'bJQueryUI':!![],'bLengthChange':![],'bFilter':!![],'bSort':!![],'bInfo':!![],'bAutoWidth':!![],'bProcessing':!![],'iDisplayLength':0xa,'dom':_0x241276(0x31a),'colReorder':{'allowReorder':!![]},'language':{'searchPlaceholder':_0x241276(0x2c0)},'columnDefs':[{'width':0x96,'targets':0x1}]});}function CheckInvitedAction(_0x2b5191){var _0x4d4a6b=a507_0x2cffb1;ExtrnaluserId=_0x2b5191;var _0x2f4654=htmlGridarray[_0x4d4a6b(0x2ed)](function(_0x58e2db){return _0x58e2db['ID']==_0x2b5191;}),_0x3d6797='',_0x556bc1='';$('#checkUser')[_0x4d4a6b(0x260)](''),$(_0x4d4a6b(0x35b))['text'](_0x2f4654[0x0][_0x4d4a6b(0x1f4)]),SendReminderInvitename=_0x2f4654[0x0][_0x4d4a6b(0x1e8)],SendReminderInviteEmail=_0x2f4654[0x0][_0x4d4a6b(0x1f4)],$[_0x4d4a6b(0x2fa)](GetGueastUsers(_0x2f4654[0x0][_0x4d4a6b(0x1f4)]))[_0x4d4a6b(0x1e0)](function(_0x4c4ba0){var _0x52181b=_0x4d4a6b;_0x4c4ba0[_0x52181b(0x1b4)]>0x0&&(_0x3d6797=_0x4c4ba0[0x0]['creationType'],_0x556bc1=_0x4c4ba0[0x0][_0x52181b(0x31c)]);});if(_0x556bc1=='Accepted'){for(var _0x3c6c51 in htmlGridarray){if(htmlGridarray[_0x3c6c51]['ID']==ExtrnaluserId){htmlGridarray[_0x3c6c51][_0x4d4a6b(0x31c)]=_0x4d4a6b(0x2d4);break;}}GenerateGridHtml(htmlGridarray),$(_0x4d4a6b(0x2cf))['text']('');var _0x2ea92c='User\x20has\x20accept\x20the\x20invitation.\x0a\x20Please\x20proceed\x20for\x20activated\x20this\x20user.';$(_0x4d4a6b(0x2cf))['text'](_0x2ea92c),$(_0x4d4a6b(0x29a))[_0x4d4a6b(0x1d3)](),$(_0x4d4a6b(0x251))[_0x4d4a6b(0x245)](),$('#btnSendReminder')[_0x4d4a6b(0x245)](),$(_0x4d4a6b(0x28a))[_0x4d4a6b(0x320)](_0x4d4a6b(0x1d3));}else{for(var _0x3c6c51 in htmlGridarray){if(htmlGridarray[_0x3c6c51]['ID']==ExtrnaluserId){htmlGridarray[_0x3c6c51][_0x4d4a6b(0x31c)]=_0x4d4a6b(0x361);break;}}GenerateGridHtml(htmlGridarray),$(_0x4d4a6b(0x2cf))[_0x4d4a6b(0x260)]('');var _0x2ea92c=_0x4d4a6b(0x2f8);$('.check-status-user-detail')['text'](_0x2ea92c),$(_0x4d4a6b(0x251))['show'](),$(_0x4d4a6b(0x29a))['hide'](),$(_0x4d4a6b(0x28a))[_0x4d4a6b(0x320)](_0x4d4a6b(0x1d3)),$(_0x4d4a6b(0x1cb))[_0x4d4a6b(0x1d3)]();}}function SetTextBox(_0x4ef89a,_0x53c5f1){var _0x31662c=a507_0x2cffb1;ExtrnaluserId=_0x4ef89a;var _0x2b4af1=htmlGridarray[_0x31662c(0x2ed)](function(_0x2ae578){return _0x2ae578['ID']==_0x4ef89a;});if(_0x53c5f1==_0x31662c(0x307))IsSetvalue=!![],Pertimtblock(_0x2b4af1[0x0][_0x31662c(0x1f4)]);else{if(_0x53c5f1==_0x31662c(0x331)){IsSetvalue=![],$(_0x31662c(0x319))[_0x31662c(0x1ee)](_0x2b4af1[0x0]['Title']),$(_0x31662c(0x319))['attr'](_0x31662c(0x33d),_0x31662c(0x33d)),$(_0x31662c(0x2f0))[_0x31662c(0x1ee)](_0x2b4af1[0x0][_0x31662c(0x1f4)]),$(_0x31662c(0x2f0))[_0x31662c(0x1b7)](_0x31662c(0x33d),_0x31662c(0x33d)),$(_0x31662c(0x1c1))[_0x31662c(0x1ee)](_0x2b4af1[0x0][_0x31662c(0x2c2)]),$(_0x31662c(0x1c1))[_0x31662c(0x1b7)](_0x31662c(0x33d),_0x31662c(0x33d)),$(_0x31662c(0x206))['val'](_0x2b4af1[0x0][_0x31662c(0x363)]),$('#invitetxtReferenceCode')[_0x31662c(0x1b7)](_0x31662c(0x33d),_0x31662c(0x33d)),$(_0x31662c(0x1eb))['val'](_0x2b4af1[0x0][_0x31662c(0x34b)]),$(_0x31662c(0x1eb))[_0x31662c(0x1b7)](_0x31662c(0x33d),_0x31662c(0x33d));var _0x1d4025=new Date(_0x2b4af1[0x0][_0x31662c(0x22a)]);$(_0x31662c(0x2b8))['val']($[_0x31662c(0x359)][_0x31662c(0x1ae)](_0x31662c(0x200),_0x1d4025)),$(_0x31662c(0x2b8))[_0x31662c(0x1b7)]('disabled',_0x31662c(0x33d)),$(_0x31662c(0x233))['hide']();}}}function Getinvitebox(){var _0x4783b3=a507_0x2cffb1;$('#txtinvitename')[_0x4783b3(0x1ee)](''),$(_0x4783b3(0x34d))[_0x4783b3(0x1ee)](''),$(_0x4783b3(0x319))[_0x4783b3(0x1ec)](_0x4783b3(0x33d)),IscheckInvite&&($('#txtinviteemail')[_0x4783b3(0x1ee)](''),$(_0x4783b3(0x2f0))[_0x4783b3(0x1ec)](_0x4783b3(0x33d))),$(_0x4783b3(0x1c1))[_0x4783b3(0x1ee)](''),$(_0x4783b3(0x1c1))[_0x4783b3(0x1ec)]('disabled'),$(_0x4783b3(0x206))['val'](''),$(_0x4783b3(0x206))[_0x4783b3(0x1ec)](_0x4783b3(0x33d)),$(_0x4783b3(0x1eb))[_0x4783b3(0x1ee)](''),$('#invitetxtOrganizationName')['removeAttr'](_0x4783b3(0x33d)),$(_0x4783b3(0x2b8))[_0x4783b3(0x1ee)](''),$('#invitetxtValidityUpto')['removeAttr'](_0x4783b3(0x33d)),$(_0x4783b3(0x233))[_0x4783b3(0x1d3)](),IsSetvalue=!![],SetCalendar();}function UpdateGeustuserInvite(_0x3e5185,_0x2fb98c){var _0xdd1fd3=a507_0x2cffb1,_0x3ce931=_0xdd1fd3(0x2b7),_0x3caff7,_0x168e69=GetItemTypeForListName(_0x3ce931);_0x3caff7={'__metadata':{'type':_0x168e69},'Status':_0x2fb98c};var _0x3ef2b6=$[_0xdd1fd3(0x28e)]();return $['ajax']({'url':_spPageContextInfo[_0xdd1fd3(0x351)]+'/_api/web/lists/GetByTitle(\x27'+_0x3ce931+_0xdd1fd3(0x1d1)+_0x3e5185+')','type':_0xdd1fd3(0x33c),'async':![],'headers':{'accept':_0xdd1fd3(0x1d7),'X-RequestDigest':$(_0xdd1fd3(0x2d5))[_0xdd1fd3(0x1ee)](),'content-Type':_0xdd1fd3(0x1d7),'IF-MATCH':'*','X-HTTP-Method':'MERGE'},'data':JSON[_0xdd1fd3(0x247)](_0x3caff7),'success':function(_0x4980b3){},'error':function(_0x51c382){var _0x53b7c8=_0xdd1fd3;console[_0x53b7c8(0x2c6)](JSON[_0x53b7c8(0x247)](_0x51c382)),_0x3ef2b6[_0x53b7c8(0x248)](_0x51c382);}}),_0x3ef2b6[_0xdd1fd3(0x1c0)]();}function UpdateClientMaster(_0x598aae,_0x9217a6){var _0x47275d=a507_0x2cffb1,_0x136c0e=_0x47275d(0x343),_0xf509d4,_0x1888a4=GetItemTypeForListName(_0x136c0e);_0xf509d4={'__metadata':{'type':_0x1888a4},'SupervisorId':_0x9217a6};var _0x298c12=$[_0x47275d(0x28e)]();return $[_0x47275d(0x1a5)]({'url':_spPageContextInfo[_0x47275d(0x351)]+_0x47275d(0x211)+_0x136c0e+_0x47275d(0x1d1)+_0x598aae+')','type':_0x47275d(0x33c),'async':![],'headers':{'accept':_0x47275d(0x1d7),'X-RequestDigest':$('#__REQUESTDIGEST')['val'](),'content-Type':_0x47275d(0x1d7),'IF-MATCH':'*','X-HTTP-Method':_0x47275d(0x2c9)},'data':JSON[_0x47275d(0x247)](_0xf509d4),'success':function(_0x282092){},'error':function(_0x255d25){var _0x57c939=_0x47275d;console[_0x57c939(0x2c6)](JSON['stringify'](_0x255d25)),_0x298c12[_0x57c939(0x248)](_0x255d25);}}),_0x298c12['promise']();}function UpdateClientMasterDocLib(_0x5e3be8,_0x4988a6,_0x46302b,_0x580c0a){var _0x1b9a59=a507_0x2cffb1,_0x1bd885=_0x1b9a59(0x343),_0x3473d5,_0x25843c=GetItemTypeForListName(_0x1bd885);_0x3473d5={'__metadata':{'type':_0x25843c},'InternalMembersId':{'results':_0x580c0a},'InternalSupervisorId':_0x46302b,'DocumentLibrary':_0x4988a6};var _0x461a8f=$[_0x1b9a59(0x28e)]();return $[_0x1b9a59(0x1a5)]({'url':_spPageContextInfo[_0x1b9a59(0x351)]+_0x1b9a59(0x211)+_0x1bd885+_0x1b9a59(0x1d1)+_0x5e3be8+')','type':_0x1b9a59(0x33c),'async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x1b9a59(0x2d5))['val'](),'content-Type':_0x1b9a59(0x1d7),'IF-MATCH':'*','X-HTTP-Method':_0x1b9a59(0x2c9)},'data':JSON['stringify'](_0x3473d5),'success':function(_0x2c514f){},'error':function(_0x3137d6){var _0x53cda5=_0x1b9a59;console[_0x53cda5(0x2c6)](JSON[_0x53cda5(0x247)](_0x3137d6)),_0x461a8f[_0x53cda5(0x248)](_0x3137d6);}}),_0x461a8f[_0x1b9a59(0x1c0)]();}function DeleteHtmlRow(_0x5113b9,_0x5b258e){var _0x32c8c4=a507_0x2cffb1,_0x320259=confirm(_0x32c8c4(0x256)+_0x5b258e+_0x32c8c4(0x239));_0x320259&&$[_0x32c8c4(0x1a5)]({'url':_spPageContextInfo[_0x32c8c4(0x351)]+_0x32c8c4(0x2bc)+_0x5113b9+')','type':'POST','headers':{'Accept':_0x32c8c4(0x1d7),'Content-Type':'application/json;odata=verbose','IF-MATCH':'*','X-HTTP-Method':_0x32c8c4(0x1f8),'X-RequestDigest':$(_0x32c8c4(0x2d5))[_0x32c8c4(0x1ee)]()},'success':function(_0x4578fb,_0x59333b,_0x3bd1cd){var _0x1f3e16=_0x32c8c4;console[_0x1f3e16(0x2c6)](_0x1f3e16(0x22e)),LoadProject();},'error':function(_0x2b0602,_0x5b0327,_0x3229e9){var _0x3b086f=_0x32c8c4;console[_0x3b086f(0x2c6)]('Failed');}});}function a507_0x1f7e(){var _0x3db1cb=['TemplateType','statusText','<div\x20>','#invitetxtReferenceCode','https://cdn.jsdelivr.net/gh/Titan4workGit/TitanRepo@main/SiteAssets/Titan-External-Employee-Portal/images/user_pic.jpg','#Permitting-into-Portal','true','/_api/web/Lists/getbytitle(\x27TemplateMaster\x27)/Items?$select=*,AttachmentFiles&$filter=Title\x20eq\x20\x27','toggleClass','Rejected','onload','\x20<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x22><a\x20href=\x22#\x22>Active</a></li>','/_api/web/lists/getbytitle(\x27','Inactive','/_api/web/lists/GetByTitle(\x27','?$select=*,Id,Supervisor/Title,Supervisor/EMail,Supervisor/Id\x20,InternalMembers/EMail,InternalMembers/Id,InternalMembers/Title,InternalSupervisor/EMail,InternalSupervisor/Id,InternalSupervisor/Title\x20&$expand=Supervisor,InternalMembers,InternalSupervisor\x20','focus','find','open','https://cdn.jsdelivr.net/gh/Titan4workGit/TitanRepo@main/SiteAssets/AdminPortal/ManageEmployee/assets/images/user_pic.jpg','keyCode','#hActive','(Status\x20eq\x20\x27Inactive\x27)','<div\x20class=\x22dd-search\x22><input\x20id=\x22txtSearchValue\x22\x20autocomplete=\x22off\x22\x20\x20onkeyup=\x22filters()\x22\x20class=\x22dd-searchbox\x22\x20placeholder=\x22Search\x20client\x20name\x22\x20type=\x22text\x22></div>','hasClass','html','AddUserKeys','Width','SecurityLevel','toLowerCase','.dropdown-select\x20ul\x20>\x20li','Unauthorized','after','Choices','Email','#Invited','fail','spinner-','427084xqzoqx','ValidUpto','Delete\x20Success\x20','(Client_Name/Title\x20eq\x20\x27','\x20\x20<tr\x20class=\x22text-center\x22>','Success\x20Delete','trim','.list','name','<a\x20type=\x22button\x22\x20type=\x22button\x22\x20class=\x22custom-edit-btn\x22\x20data-toggle=\x22tooltip\x22\x20\x20onclick=\x22DeleteHtmlRow(','#invitesrchbtn','/_api/web/sitegroups/GetById(','PermissionLevelId','DocumentWrittenBy','\x27)/items','\x20<th\x20class=\x22text-center\x20border-bottom-0\x22><b>Action</b></th>','\x0a\x20Are\x20you\x20sure\x20to\x20delete\x20this\x20user\x20?','https://graph.microsoft.com/v1.0/invitations','\x27)/items?$filter=CategoryType\x20eq\x20\x27Guest\x20Type\x27\x20and\x20Status\x20eq\x20\x20\x27Yes\x27\x20','.dropdown-select\x20.option','All','#selectByUser\x20>\x20[value=','data','#txtSearchValue','\x20<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20\x22><a\x20href=\x22#\x22>Active</a></li>','Success','CollaborationType','IsActive','hide','replace','stringify','reject','<i\x20class=\x22fa\x20fa-envelope-o\x22></i>','<option/>','N/A','#Inactive','<a\x20type=\x22button\x22\x20type=\x22button\x22\x20class=\x22custom-edit-btn\x22\x20\x20data-toggle=\x22modal\x22\x20onclick=\x22SetTextBox(',',\x27Invite\x27)\x22\x20data-target=\x22#Invite-Guest-User\x22\x20title=\x22Invite\x22>','<div\x20class=\x22form-wizard\x20centered-pills\x22\x20>','#txtExtStatus','.uncheck-icon','25118731ktuXui','empty','internalsupervisor_TopSpan','ListItem','User:\x20\x20','AccessLevel','\x27)\x22\x20data-target=\x22#Permitting-into-Portal\x22\x20title=\x22Permit\x22>','Wait\x20Plaease','<th\x20class=\x22w-25\x22><b>Ref\x20Code</b></th>','.dropdown-select\x20ul','/_api/web/lists/getbytitle(\x27Employees\x27)/items/','SubCategory','[id$=\x27InternalStakeholders_TopSpan\x27]','Not\x20Required','text','tooltip','SP.Field','#txtExtDesignation','input:checkbox','5izKNAE','/GuestUserDocuments/_api/web/lists/getbytitle(\x27','<td>Inactive</td>','Status','(Status\x20eq\x20\x27Active\x27)\x20or\x20','<div\x20class=\x22dropdown-select\x20wide\x20','destroy','creationType','Supervisor','(Status\x20eq\x20\x27Invited\x27)','https://graph.microsoft.com','\x27&$expand=AttachmentFiles','toUpperCase','/_api/web/Lists/getbytitle(\x27TemplateMaster\x27)/Items?$filter=Active\x20eq\x20\x271\x27','#TemplateType\x20>\x20[value=','<span><h3\x20class=\x22red-color\x20text-center\x20mt-25\x22>Please\x20contact\x20your\x20administrator!\x20</h3></span><br>','.row','<h3\x20class=\x27m-0\x27>','GET','value','Invitation\x20mail\x20has\x20been\x20sent\x20to\x20the\x20user.','Base64EncodedByteArray','PermissionLevel','<div\x20class=\x22guesr-user-edit-lock-btn-box\x22>','display-text','Please\x20accept\x20this\x20invitations\x20mail','#GetMasterclientfilter','responseText','Invitation\x20mail\x20has\x20been\x20sent\x20Reminder\x20to\x20the\x20user.','\x22\x20data-value=\x22','CustType','Acknowledgement','i:0#.f|membership|','\x20\x20\x20\x20\x20\x20\x20\x20Token\x20','tabindex','next','EntityData','#check-status','InternalStakeholders','DataTable','application/json;\x20odata=verbose','Deferred','Required','#txtExternalSupervisor','Description','<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x22><a\x20href=\x22#\x22>Invited</a></li>','<th></th>','readAsDataURL','isDataTable','SPClientPeoplePicker_InitStandaloneControlWrapper','\x22\x20tabindex=\x220\x22><span\x20class=\x22current\x22></span><div\x20class=\x22list\x22><ul></ul></div></div>','\x22\x20data-display-text=\x22','\x22></label>','.check-icon','dataTable','CategoryMaster','</tr>','SearchPrincipalSource','10xTKYUU','trigger','</a>','GueastextinputFile','<a\x20type=\x22button\x22\x20type=\x22button\x22\x20class=\x22custom-edit-btn\x22\x20data-toggle=\x22tooltip\x22\x20onclick=\x22DeleteHtmlRow(','2857496MknDOp','(Status\x20eq\x20\x27Initiated\x27)','.list\x20.option:focus','InternalSupervisor','SPClientPeoplePickerDict','results','InternalMembers','<td>Invitation\x20Sent</td>','2jSjnQW','#TemplateType','</div></div></div></div>','width','Please\x20enter\x20validity\x20date.','<span>','</li>','\x20</ul>','Attn_Name','append','d\x20M,\x20yy','ExternalUsers','#invitetxtValidityUpto','Failed','before','Email\x20id\x20is\x20not\x20valid.\x20','/_api/web/lists/getByTitle(\x27ExternalUsers\x27)/items(','div[id^=\x27InternalStakeholders\x27]','#txtAddOrganization','files','Search','dropdown-select','Designation','Organization','</ul>','\x20<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20Active\x20\x22><a\x20href=\x22#\x22>Active</a></li>','log','logintoken','#orgselectpicker','MERGE','(Status\x20eq\x20\x27Inactive\x27)\x20or\x20','add','Initiated','.checkboxss','split','.check-status-user-detail','FieldTypeKind','SP.FieldDateTime','Shared','ResolvePrincipalSource','Accepted','#__REQUESTDIGEST','#masterClientgrid','createElement','responseJSON','<i\x20class=\x22fa\x20fa-user-plus\x22></i>','#GueastextinputFile','<label><input\x20type=\x22checkbox\x22\x20id=\x22Check_','<a\x20type=\x22button\x22\x20href=\x22#\x22\x20class=\x22custom-edit-btn\x22\x20data-toggle=\x22modal\x22\x20onclick=\x22SetTextBox(','371PvIsWg','ApprovedByOutsider','EMail','\x27)/items?$select=*,InternalStakeholders/Title,Supervisor_Guest/Title,Client_Name/Title,LoginName/Title\x20&$expand=\x20LoginName,Client_Name,Supervisor_Guest,InternalStakeholders\x20&$filter=(','resolve','animating','CatogeryName','1819053IPLjNy','<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20Initiated\x22><a\x20href=\x22#\x22>Initiated</a></li>','none','(Status\x20eq\x20\x27Accepted\x27)','<i\x20class=\x22fa\x20fa-trash-o\x22></i>','getDate','\x20<tr>','<th\x20class=\x22text-left\x20border-bottom-0\x22\x20\x20><b>Action\x20Date</b></th>','<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20not-Accepted\x22><a\x20href=\x22#\x22>Not\x20Accepted</a></li>','filter','MaximumEntitySuggestions','.option','#txtinviteemail','<a\x20type=\x22button\x22\x20href=\x22#\x22\x20class=\x22custom-edit-btn\x22\x20data-toggle=\x22tooltip\x22\x20data-placement=\x22top\x22\x20title=\x22\x22\x20onclick=\x22CheckInvitedAction(','Active','siteAbsoluteUrl','</span>','change','error','AllowMultipleValues','The\x20user\x20does\x20not\x20accept\x20the\x20invitation\x20yet.','<i\x20class=\x22fa\x20fa-question-circle-o\x22></i>','when','<div\x20class=\x22checkbox\x20m-0\x22>','\x27)\x22\x20data-target=\x22#Permitting-into-Portal\x22\x20title=\x22Edit\x22>','selected','#internalsupervisor','#TemplateType\x20option:selected','Supervisor_Guest','<th\x20class=\x22text-left\x20w-10\x22><b>Type</b></th>','DocumentLibrary','LoginName','#Invite-Guest-User','#pDescription','getMonth','Permit','application/json','SP.Data.','Key','1437672XaPzgp','<tr\x20class=\x22text-left\x22>','/_api/web/sitegroups/getbyname(\x27Contributors\x27)?$select=id','setItem','body','internalsupervisor','/_api/web/lists/getByTitle(\x27','</thead>\x20','display','#btnPermitting','<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20\x22><a\x20href=\x22#\x22>Accepted</a></li>','This\x20user:-','#TableGrid','\x20</tbody>','#txtinvitename','Rlfrtip','shift','externalUserState','css','\x20and\x20(Client_Name/Title\x20eq\x20\x27','</div>','modal','FileValidity','getItemsWithQueryItem','#btnInviteuser','Client_Code','push','#hAccepted','<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20Accepted\x22><a\x20href=\x22#\x22>Accepted</a></li>','style','option','.sp-peoplepicker-editorInput','not','#datepickerAD5','.sp-peoplepicker-delImage','SP.FieldUser','slice','prop','Invite','#extrenalImage','#TempalteName',')/AttachmentFiles/add(FileName=\x27','spinner-remove','<tbody\x20>','#hInitiated','<li\x20class=\x22option\x20','Details','SupervisorId','/Forms/AllItems.aspx','POST','disabled','<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20Invited\x22><a\x20href=\x22#\x22>Invited</a></li>','69066vBkhAz','<ul\x20class=\x22nav\x20nav-pills\x22>','Please\x20enter\x20a\x20valid\x20email\x20address\x20of\x20the\x20guest\x20user,\x20who\x20is\x20outsider\x20of\x20this\x20organization.','innerHTML','ClientMaster','#InternalStakeholders','.selected','<td\x20class=\x22text-left\x22>','appendTo','charAt','\x27)\x22\x20data-placement=\x22top\x22\x20title=\x22Delete\x22>','Client_Name','ClientName','PrincipalAccountType','#txtinvitemessage','358px','application/json;odata=nometadata','<span><h3\x20class=\x22red-color\x20text-center\x20mt-25\x22>You\x20are\x20not\x20authorized\x20to\x20access\x20!\x20</h3></span>','webAbsoluteUrl','DocumentNo','join','<thead>','.dropdown-select','src','Approval','\x27)/fields/getbytitle(\x27','datepicker','children','#checkUser','focusout','invitedUserEmailAddress','3975111MIPQzO','<option>','[id$=\x27internalsupervisor_TopSpan\x27]','PendingAcceptance','GetAllUserInfo','ReferenceCode','TemplateMaster','<div\x20\x20>','SelfCompany','checked','closest','removeClass','each','Please\x20enter\x20Invite\x20Name\x20','ajax','contentEditable','\x20<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20Inactive\x20\x22><a\x20href=\x22#\x22>Inactive</a></li>','.spinner','option:selected','get','/GuestUserDocuments/_api/Web/Lists/','Update\x20successfully!','#txtReferenceCodeExt','formatDate','acquireToken','CustomName','class','Please\x20enter\x20Organization\x20Name\x20','target','length','CommentCount','</td>','attr','\x27)/fields?&$select=*&$filter=EntityPropertyName\x20eq\x20\x27TemplateType\x27','getElementById','animationTimeout','<td>','remove','#hInactive','/_api/web/lists/getbytitle(\x27ExternalUsers\x27)/items?$select=*,InternalStakeholders/Title,Supervisor_Guest/Title,Client_Name/Title,LoginName/Title\x20&$expand=\x20LoginName,Client_Name,Supervisor_Guest,InternalStakeholders\x20&$filter=((Status\x20eq\x20\x27Initiated\x27)\x20or\x20(Status\x20eq\x20\x27Invited\x27\x20)or\x20(Status\x20eq\x20\x27Pending\x27)or\x20(Status\x20eq\x20\x27Accepted\x27))','prev','promise','#invitetxtDesignation','addClass','#CustomName','keydown','Guest_name','stopPropagation','click','ApprovedDate','#hInvited','User,DL,SecGroup,SPGroup','#btnSendReminder','/SitePages/Thankyou.aspx','InternalStakeholders_TopSpan','#txtExtLoginName','#Active','Bearer\x20','\x27)/items(','\x27)/items?$select=*,AttachmentFiles,Supervisor/Title,Supervisor/EMail,InternalStakeholders/Title,InternalStakeholders/EMail,LoginName/Title,Client_Name/Title,Client_Name/Id,Supervisor_Guest/Title\x20&$expand=Supervisor,InternalStakeholders,AttachmentFiles,LoginName,Client_Name,Supervisor_Guest\x20&$filter=\x20email\x20eq\x20\x27','show','appendChild','(Status\x20eq\x20\x27Active\x27)','https://graph.microsoft.com/v1.0/users?$select=id,displayName,userPrincipalName,otherMails,userType,identities,creationType,externalUserState\x20&$filter=mail\x20eq\x20\x27','application/json;odata=verbose','(Status\x20eq\x20\x27Invited\x27)\x20or\x20','</h3>','Shared\x20With','Approved','#txtExtOrganizationName','indexOf','\x20<th\x20class=\x22text-left\x20border-bottom-0\x22\x20><b>Organization</b></th>','email_date','done','#NotAccepted','.current','#selectByUser','User\x20Added','\x27)/items?$select=*,InternalStakeholders/Title,Supervisor_Guest/Title,Client_Name/Title,LoginName/Title\x20&$expand=\x20LoginName,Client_Name,Supervisor_Guest,InternalStakeholders\x20&$filter=((Status\x20eq\x20\x27Initiated\x27)\x20or\x20(Status\x20eq\x20\x27Invited\x27\x20)or\x20(Status\x20eq\x20\x27Pending\x27)or\x20(Status\x20eq\x20\x27Accepted\x27))','ServerRelativeUrl','d\x20M,\x20y','Title','#txtExtEmail','SP.FieldChoice','#invitetxtOrganizationName','removeAttr','\x27)/items?$select=*,InternalStakeholders/Title,Supervisor_Guest/Title,Client_Name/Title,LoginName/Title\x20&$expand=\x20LoginName,Client_Name,Supervisor_Guest,InternalStakeholders\x20&$filter=((Status\x20eq\x20\x27Initiated\x27)\x20or\x20(Status\x20eq\x20\x27Invited\x27\x20)or\x20(Status\x20eq\x20\x27Pending\x27)or\x20(Status\x20eq\x20\x27Accepted\x27)or\x20(Status\x20eq\x20\x27Inactive\x27)\x20or\x20(Status\x20eq\x20\x27Active\x27))','val','SP.List','Invitation\x20mail\x20sending\x20failed.\x0aPlease\x20try\x20again\x20later.\x0aAlso\x20please\x20check\x20the\x20External\x20Sharing\x20setup\x20of\x20this\x20site.','ApprovedBy','/_api/lists/GetByTitle(\x27','Invitation\x20mail\x20sending\x20failed.\x0aPlease\x20try\x20again\x20later.\x0a\x20Also\x20please\x20check\x20the\x20External\x20Sharing\x20setup\x20of\x20this\x20site.','email','substring','message','Invited','DELETE','Pending','getFullYear','\x27)/fields','(Status\x20eq\x20\x27Initiated\x27)\x20or\x20','Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.\x0a\x20Enter\x20valid\x20email\x20address\x20or\x20check\x20the\x20external\x20sharing\x20features\x20is\x20enabled.','getItem','Modified','d\x20M,\x20yy\x20','__next','AttachmentFiles'];a507_0x1f7e=function(){return _0x3db1cb;};return a507_0x1f7e();}function GetGueastUsers(_0x4481f1){var _0x1d9e3f=a507_0x2cffb1,_0x5bdb50=_0x1d9e3f(0x1d6)+_0x4481f1+'\x27';return DeferredObj=$[_0x1d9e3f(0x28e)](),$[_0x1d9e3f(0x1a5)]({'method':_0x1d9e3f(0x277),'url':_0x5bdb50,'headers':{'Authorization':_0x1d9e3f(0x1d0)+token,'Content-Type':_0x1d9e3f(0x308)},'async':![],'success':function(_0x16b5a5){var _0x27848a=_0x1d9e3f;DeferredObj[_0x27848a(0x2e1)](_0x16b5a5['value']);},'error':function(_0x1d23b2){var _0x4e08cd=_0x1d9e3f;localStorage['removeItem'](_0x4e08cd(0x2c7)),removeSpinner($(_0x4e08cd(0x30f))),GI=GLength,LoadProject();}}),DeferredObj[_0x1d9e3f(0x1c0)]();}var filter='';function GetExternalUsers(){var _0x5ae5d0=a507_0x2cffb1,_0x285471='',_0x4e589c=![];filter='';var _0x43cdfb=_0x5ae5d0(0x2b7);if(Isfillter){Initiated!=''&&(filter+=_0x5ae5d0(0x1fc),_0x4e589c=!![]);Invited!=''&&(filter+=_0x5ae5d0(0x1d8),_0x4e589c=!![]);NotAccepted!=''&&(filter+=_0x5ae5d0(0x1d8),_0x4e589c=!![]);Active!=''&&(filter+=_0x5ae5d0(0x269),_0x4e589c=!![]);Inactive!=''&&(filter+=_0x5ae5d0(0x2ca),_0x4e589c=!![]);Accepted!=''&&(filter+='(Status\x20eq\x20\x27Accepted\x27)\x20or\x20',_0x4e589c=!![]);var _0x54ea51=$('.dropdown-select')['find'](_0x5ae5d0(0x1e2))[_0x5ae5d0(0x260)]();_0x54ea51==_0x5ae5d0(0x23d)&&!_0x4e589c?_0x285471=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/getbytitle(\x27'+_0x43cdfb+_0x5ae5d0(0x1e5):(_0x4e589c?(filter=filter[_0x5ae5d0(0x1f5)](0x0,filter[_0x5ae5d0(0x1b4)]-0x3),_0x54ea51!=_0x5ae5d0(0x23d)&&(filter+=_0x5ae5d0(0x31e)+_0x54ea51+'\x27)')):filter+=_0x5ae5d0(0x22c)+_0x54ea51+'\x27)',_0x285471=_spPageContextInfo['webAbsoluteUrl']+_0x5ae5d0(0x20f)+_0x43cdfb+_0x5ae5d0(0x2e0)+filter+')');}else _0x285471=_spPageContextInfo[_0x5ae5d0(0x351)]+_0x5ae5d0(0x20f)+_0x43cdfb+_0x5ae5d0(0x1ed);var _0x8bc7ed=$[_0x5ae5d0(0x28e)]();return $[_0x5ae5d0(0x1a5)]({'url':_0x285471,'type':_0x5ae5d0(0x1aa),'headers':{'Accept':_0x5ae5d0(0x1d7)},'success':function(_0x11de05){var _0x3b302f=_0x5ae5d0,_0x2909eb=_0x11de05['d'][_0x3b302f(0x2a9)]['filter'](function(_0x4f7099){var _0x3f23d3=_0x3b302f;return _0x4f7099[_0x3f23d3(0x268)]==_0x3f23d3(0x1f7);}),_0xd5efd4=_0x11de05['d'][_0x3b302f(0x2a9)][_0x3b302f(0x2ed)](function(_0xc90845){var _0x42d211=_0x3b302f;return _0xc90845[_0x42d211(0x268)]==_0x42d211(0x2cc);}),_0x504549=_0x11de05['d'][_0x3b302f(0x2a9)][_0x3b302f(0x2ed)](function(_0x598c5e){var _0x131418=_0x3b302f;return _0x598c5e['Status']==_0x131418(0x2f2);}),_0x495b63=_0x11de05['d'][_0x3b302f(0x2a9)][_0x3b302f(0x2ed)](function(_0x4b94f3){var _0x89bd32=_0x3b302f;return _0x4b94f3[_0x89bd32(0x268)]==_0x89bd32(0x210);}),_0x42d23a=_0x11de05['d']['results'][_0x3b302f(0x2ed)](function(_0x8c5fd1){var _0x3a730d=_0x3b302f;return _0x8c5fd1[_0x3a730d(0x268)]==_0x3a730d(0x2d4);});_0x2909eb['length']>0x0&&($(_0x3b302f(0x1c9))[_0x3b302f(0x253)](),$(_0x3b302f(0x1c9))[_0x3b302f(0x2b5)]('<h3\x20class=\x27m-0\x27>'+_0x2909eb[_0x3b302f(0x1b4)]+_0x3b302f(0x1d9))),_0xd5efd4[_0x3b302f(0x1b4)]>0x0&&($(_0x3b302f(0x337))['empty'](),$('#hInitiated')['append'](_0x3b302f(0x276)+_0xd5efd4[_0x3b302f(0x1b4)]+_0x3b302f(0x1d9))),_0x504549[_0x3b302f(0x1b4)]>0x0&&($('#hActive')[_0x3b302f(0x253)](),$(_0x3b302f(0x218))[_0x3b302f(0x2b5)](_0x3b302f(0x276)+_0x504549[_0x3b302f(0x1b4)]+_0x3b302f(0x1d9))),_0x495b63[_0x3b302f(0x1b4)]>0x0&&($(_0x3b302f(0x1bd))[_0x3b302f(0x253)](),$(_0x3b302f(0x1bd))['append'](_0x3b302f(0x276)+_0x495b63[_0x3b302f(0x1b4)]+_0x3b302f(0x1d9))),_0x42d23a['length']>0x0&&($(_0x3b302f(0x326))['empty'](),$(_0x3b302f(0x326))['append'](_0x3b302f(0x276)+_0x42d23a[_0x3b302f(0x1b4)]+_0x3b302f(0x1d9))),Isfillter==![]&&(_0x11de05['d'][_0x3b302f(0x2a9)]=_0x11de05['d']['results'][_0x3b302f(0x2ed)](function(_0x298848){var _0x15dda8=_0x3b302f;return _0x298848['Status']!==_0x15dda8(0x2f2);}),_0x11de05['d'][_0x3b302f(0x2a9)]=_0x11de05['d'][_0x3b302f(0x2a9)][_0x3b302f(0x2ed)](function(_0x443021){var _0x38eb48=_0x3b302f;return _0x443021[_0x38eb48(0x268)]!==_0x38eb48(0x210);})),Isfillter=![],_0x8bc7ed['resolve'](_0x11de05['d'][_0x3b302f(0x2a9)]);},'error':function(_0x384b4b){var _0x507b96=_0x5ae5d0;console['log'](_0x384b4b[_0x507b96(0x2d8)][_0x507b96(0x2f6)]),_0x8bc7ed[_0x507b96(0x248)](_0x384b4b[_0x507b96(0x2d8)][_0x507b96(0x2f6)]);}}),_0x8bc7ed[_0x5ae5d0(0x1c0)]();}var Errorcount=0x1,Ischeckerror=![];function Inviteuser(){var _0x2bf511=a507_0x2cffb1,_0x3283f3=$(_0x2bf511(0x2f0))[_0x2bf511(0x1ee)](),_0x4ee5c8=$(_0x2bf511(0x319))['val'](),_0x459908=$(_0x2bf511(0x34d))[_0x2bf511(0x1ee)](),_0x4cdfba=$(_0x2bf511(0x1eb))[_0x2bf511(0x1ee)](),_0x4e421d=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/igm,_0x13578a=_0x4e421d['test'](_0x3283f3);if(_0x3283f3=='')return alert('Please\x20enter\x20email'),![];else{if(!_0x13578a)return alert(_0x2bf511(0x2bb)),![];else{if(_0x4ee5c8=='')return alert(_0x2bf511(0x1a4)),![];else{if(_0x4cdfba=='')return alert(_0x2bf511(0x1b2)),![];else{if($(_0x2bf511(0x2b8))[_0x2bf511(0x1ee)]()=='')return alert(_0x2bf511(0x2b0)),![];}}}}Errorcount=0x1,$(_0x2bf511(0x323))[_0x2bf511(0x1ee)](_0x2bf511(0x259)),$[_0x2bf511(0x1a5)]({'url':_0x2bf511(0x23a),'type':_0x2bf511(0x33c),'headers':{'Authorization':_0x2bf511(0x1d0)+token,'content-type':_0x2bf511(0x308)},'data':JSON['stringify']({'invitedUserDisplayName':_0x4ee5c8,'invitedUserEmailAddress':_0x3283f3,'inviteRedirectUrl':_spPageContextInfo[_0x2bf511(0x351)]+_0x2bf511(0x1cc),'sendInvitationMessage':!![],'invitedUserMessageInfo':{'customizedMessageBody':_0x459908}}),'async':![],'success':function(_0x337cc9){var _0x447d5e=_0x2bf511;console['log'](_0x337cc9);GroupId==''&&GetGroupIDByGroupName();GuestUserEmail=_0x337cc9[_0x447d5e(0x35d)];try{$[_0x447d5e(0x2fa)](AddUserinSharePointGroup(_0x337cc9[_0x447d5e(0x35d)],GroupId))[_0x447d5e(0x1e0)](function(_0x2eb15e){var _0x547c72=_0x447d5e;Ischeckerror=![];if(_0x2eb15e==_0x547c72(0x1e4)){if(!IsSetvalue){UpdateGeustuserInvite(ExtrnaluserId,_0x547c72(0x1f7));for(var _0x518b5a in htmlGridarray){if(htmlGridarray[_0x518b5a]['ID']==ExtrnaluserId){htmlGridarray[_0x518b5a]['Status']=_0x547c72(0x1f7);break;}}}else AddNewGuest();GenerateGridHtml(htmlGridarray),alert(_0x547c72(0x279)),Ischeckerror=![],$(_0x547c72(0x304))[_0x547c72(0x320)]('hide');}else alert(_0x547c72(0x1f0));});}catch(_0x1af5e0){alert('Invitation\x20mail\x20sending\x20failed.\x0aPlease\x20try\x20again\x20later.\x0aAlso\x20please\x20check\x20the\x20External\x20Sharing\x20setup\x20of\x20this\x20site.'+_0x1af5e0);}},'error':function(_0x1c0ab2){var _0x448d07=_0x2bf511;_0x1c0ab2[_0x448d07(0x204)]==_0x448d07(0x222)?alert(_0x1c0ab2[_0x448d07(0x204)]+':\x20\x20Compact\x20Token\x20parsing\x20failed'):(alert(_0x448d07(0x341)),console[_0x448d07(0x2c6)](JSON['stringify'](_0x1c0ab2)));}}),Ischeckerror&&alert(_0x2bf511(0x1f3)),$(_0x2bf511(0x323))[_0x2bf511(0x1ee)]('Invite');}var SendReminderInvitename='',SendReminderInviteEmail='';function InviteuserSendReminder(){var _0x5daddc=a507_0x2cffb1;$[_0x5daddc(0x1a5)]({'url':_0x5daddc(0x23a),'type':_0x5daddc(0x33c),'headers':{'Authorization':_0x5daddc(0x1d0)+token,'content-type':_0x5daddc(0x308)},'data':JSON[_0x5daddc(0x247)]({'invitedUserDisplayName':SendReminderInvitename,'invitedUserEmailAddress':SendReminderInviteEmail,'inviteRedirectUrl':_spPageContextInfo[_0x5daddc(0x351)]+_0x5daddc(0x1cc),'sendInvitationMessage':!![],'invitedUserMessageInfo':{'customizedMessageBody':_0x5daddc(0x27e)}}),'async':![],'success':function(_0x40d5a1){var _0x2c406e=_0x5daddc;console[_0x2c406e(0x2c6)](_0x40d5a1),alert(_0x2c406e(0x281));},'error':function(_0x53632a){}});}function AddUserinSharePointGroup(_0x4c8d41,_0x449974){var _0x31c24e=a507_0x2cffb1,_0x4da5af=$[_0x31c24e(0x28e)](),_0xd851cd=_0x31c24e(0x285),_0x445ad7=_0xd851cd+_0x4c8d41,_0x273a8a=_spPageContextInfo[_0x31c24e(0x351)]+_0x31c24e(0x234)+_0x449974+')/users';$[_0x31c24e(0x1a5)]({'url':_0x273a8a,'type':'POST','async':![],'data':JSON['stringify']({'__metadata':{'type':'SP.User'},'LoginName':_0x445ad7}),'headers':{'accept':_0x31c24e(0x1d7),'content-type':_0x31c24e(0x1d7),'X-RequestDigest':$(_0x31c24e(0x2d5))[_0x31c24e(0x1ee)]()},'success':_0x573387,'error':_0x3abcf9});function _0x573387(_0xa910c8){var _0x3ed95a=_0x31c24e;Ischeckerror=!![],_0x4da5af['resolve']('User\x20Added'),Errorcount=0x1,console['log'](_0x3ed95a(0x1e4));}function _0x3abcf9(_0x43ea85){var _0x14c667=_0x31c24e;console['log'](JSON[_0x14c667(0x247)](_0x43ea85)),console[_0x14c667(0x2c6)](JSON[_0x14c667(0x247)](_0x4c8d41)),(_0x43ea85[_0x14c667(0x204)]=='Not\x20Found'||_0x43ea85[_0x14c667(0x204)]==_0x14c667(0x2f6))&&Errorcount==0x1e?_0x43ea85[_0x14c667(0x204)]=='error'?(Errorcount++,AddUserinSharePointGroup(_0x4c8d41,_0x449974)):alert(_0x14c667(0x1fd)):(Errorcount++,AddUserinSharePointGroup(_0x4c8d41,_0x449974));}return _0x4da5af['promise']();}function AddNewGuest(){var _0x555e99=a507_0x2cffb1;try{var _0x225d68=_0x555e99(0x2b7);GroupId==''&&GetGroupIDByGroupName();AddUserinSharePointGroup($('#txtinviteemail')[_0x555e99(0x1ee)](),GroupId);var _0x314ed4=GetUserEmail($(_0x555e99(0x2f0))['val']()),_0x8e5f73,_0x18c37b=GetItemTypeForListName(_0x225d68);_0x8e5f73={'__metadata':{'type':_0x18c37b},'LoginNameId':_0x314ed4,'Title':$(_0x555e99(0x319))['val'](),'email':$(_0x555e99(0x2f0))[_0x555e99(0x1ee)](),'Designation':$(_0x555e99(0x1c1))[_0x555e99(0x1ee)](),'Organization':$(_0x555e99(0x1eb))[_0x555e99(0x1ee)](),'ReferenceCode':$(_0x555e99(0x206))[_0x555e99(0x1ee)](),'InternalStakeholdersId':{'results':InternalStakeholder},'SupervisorId':Supervisormember,'Client_NameId':Client_Id,'Supervisor_GuestId':ExtnaralSupervisor,'ValidUpto':$('#invitetxtValidityUpto')[_0x555e99(0x1ee)](),'Status':_0x555e99(0x1f7)},AddItemToList(_0x225d68,_0x8e5f73);}catch(_0x360fbf){console[_0x555e99(0x2c6)](_0x360fbf[_0x555e99(0x1f6)]);}}function AddItemToList(_0x469b98,_0x36518d){var _0x3fe6b2=a507_0x2cffb1,_0x311ed2=$[_0x3fe6b2(0x28e)]();return $[_0x3fe6b2(0x1a5)]({'url':_spPageContextInfo[_0x3fe6b2(0x351)]+_0x3fe6b2(0x20f)+_0x469b98+_0x3fe6b2(0x237),'type':'POST','async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x3fe6b2(0x2d5))[_0x3fe6b2(0x1ee)](),'content-Type':_0x3fe6b2(0x1d7)},'data':JSON[_0x3fe6b2(0x247)](_0x36518d),'success':function(_0x36879a){var _0x4dabbf=_0x3fe6b2;htmlGridarray[_0x4dabbf(0x325)]({'creationType':'','externalUserState':'','Title':$('#txtinvitename')[_0x4dabbf(0x1ee)](),'email':$(_0x4dabbf(0x2f0))['val'](),'Designation':$(_0x4dabbf(0x1c1))[_0x4dabbf(0x1ee)](),'CollaborationType':_0x36879a['d']['CollaborationType'],'ClientName':$('#invitetxtOrganizationName')[_0x4dabbf(0x1ee)](),'Status':_0x4dabbf(0x1f7),'ID':_0x36879a['d']['ID'],'ValidUpto':$(_0x4dabbf(0x2b8))[_0x4dabbf(0x1ee)](),'ReferenceCode':$(_0x4dabbf(0x206))[_0x4dabbf(0x1ee)]()});},'error':function(_0x1a6703){var _0x564e98=_0x3fe6b2;console['log'](JSON[_0x564e98(0x247)](_0x1a6703)),_0x311ed2['reject'](_0x1a6703);}}),_0x311ed2[_0x3fe6b2(0x1c0)]();}var InternalStakeholder=[],Supervisormember,ExtnaralSupervisor;function Selectedcclinte(){var _0x4a26b8=a507_0x2cffb1;if(IsSetvalue){InternalStakeholder=[],$(_0x4a26b8(0x1eb))[_0x4a26b8(0x1ee)](ClientInternalMembers[SelectClientId]['Title']),$(_0x4a26b8(0x1eb))[_0x4a26b8(0x1b7)]('disabled',_0x4a26b8(0x33d)),Client_Id=ClientInternalMembers[SelectClientId]['ID'];for(var _0x5891b3=0x0;_0x5891b3<ClientInternalMembers[SelectClientId]['InternalMembers'][_0x4a26b8(0x2a9)]['length'];_0x5891b3++){InternalStakeholder[_0x4a26b8(0x325)](ClientInternalMembers[SelectClientId][_0x4a26b8(0x2aa)][_0x4a26b8(0x2a9)][_0x5891b3]['Id']);}Supervisormember=ClientInternalMembers[SelectClientId][_0x4a26b8(0x2a7)]['Id'],ExtnaralSupervisor=ClientInternalMembers[SelectClientId][_0x4a26b8(0x33a)];}else{$('#txtAddOrganization')[_0x4a26b8(0x1ee)](ClientInternalMembers[SelectClientId][_0x4a26b8(0x1e8)]),Client_Id=ClientInternalMembers[SelectClientId]['ID'];ClientInternalMembers[SelectClientId][_0x4a26b8(0x26d)]!=undefined?$('#txtExternalSupervisor')[_0x4a26b8(0x1ee)](ClientInternalMembers[SelectClientId][_0x4a26b8(0x26d)]):$(_0x4a26b8(0x290))[_0x4a26b8(0x1ee)]($(_0x4a26b8(0x1e9))[_0x4a26b8(0x1ee)]());$(_0x4a26b8(0x23e)+ClientInternalMembers[SelectClientId]['CustType']+']')[_0x4a26b8(0x1b7)](_0x4a26b8(0x2fd),_0x4a26b8(0x209)),$(_0x4a26b8(0x273)+ClientInternalMembers[SelectClientId][_0x4a26b8(0x203)]+']')['attr'](_0x4a26b8(0x2fd),'true'),initializePeoplePicker(_0x4a26b8(0x28b),!![]),peoplePickerDiv=$('[id$=\x27InternalStakeholders_TopSpan\x27]'),initializePeoplePicker(_0x4a26b8(0x310),![]),peoplePickerDivsuper=$(_0x4a26b8(0x360));for(var _0x5891b3=0x0;_0x5891b3<ClientInternalMembers[SelectClientId][_0x4a26b8(0x2aa)][_0x4a26b8(0x2a9)][_0x4a26b8(0x1b4)];_0x5891b3++){setPeoplePickerUsersInfoCurrent(_0x4a26b8(0x1cd),ClientInternalMembers[SelectClientId][_0x4a26b8(0x2aa)][_0x4a26b8(0x2a9)][_0x5891b3][_0x4a26b8(0x2df)]);}setPeoplePickerUsersInfoCurrent('internalsupervisor_TopSpan',ClientInternalMembers[SelectClientId][_0x4a26b8(0x2a7)][_0x4a26b8(0x2df)]),$(_0x4a26b8(0x2bd))['attr'](_0x4a26b8(0x1a6),'false'),$('#InternalStakeholders')['attr'](_0x4a26b8(0x33d),_0x4a26b8(0x33d)),$('#internalsupervisor')[_0x4a26b8(0x1b7)](_0x4a26b8(0x33d),_0x4a26b8(0x33d)),$(peoplePickerDiv)['find']('.sp-peoplepicker-delImage')[_0x4a26b8(0x31d)]('display',_0x4a26b8(0x2e6)),$(peoplePickerDivsuper)['find'](_0x4a26b8(0x32d))[_0x4a26b8(0x31d)]('display',_0x4a26b8(0x2e6));}}var ClientInternalMembers=[];function GetClientMasterTeamDeails(){var _0x1548d8=a507_0x2cffb1;Taskusers=[],ClientInternalMembers=[],RestQuery=_0x1548d8(0x212),$[_0x1548d8(0x2fa)](CommonFunction[_0x1548d8(0x322)](_0x1548d8(0x343),RestQuery))[_0x1548d8(0x1e0)](function(_0x328c4a){var _0x45468f=_0x1548d8,_0x56421d;IsNotTeamMember='';var _0x4971c2='';_0x4971c2+=_0x45468f(0x354)+_0x45468f(0x2ea)+_0x45468f(0x293)+'<th\x20class=\x22text-left\x20w-20\x22><b>Client\x20Name</b></th>'+'<th\x20class=\x22text-left\x20w-10\x22><b>Attn\x20Name</b></th>'+_0x45468f(0x301)+_0x45468f(0x25a)+_0x45468f(0x29d)+_0x45468f(0x312);for(var _0x15a172=0x0;_0x15a172<_0x328c4a[_0x45468f(0x2a9)][_0x45468f(0x1b4)];_0x15a172++){_0x56421d=[],_0x56421d=_0x328c4a[_0x45468f(0x2a9)][_0x15a172];var _0x41cf83=_0x56421d[_0x45468f(0x244)]=_0x45468f(0x209)?_0x56421d[_0x45468f(0x244)]:_0x45468f(0x2f2);_0x4971c2+=_0x45468f(0x22d)+_0x45468f(0x346)+_0x45468f(0x2fb)+_0x45468f(0x2db)+_0x15a172+'\x22\x20class=\x22getclientmaster\x22\x20onclick=\x22selectOnlyThis(this.id)\x22\x20\x20value=\x22'+_0x15a172+_0x45468f(0x299)+_0x45468f(0x31f)+_0x45468f(0x1b6)+_0x45468f(0x346)+_0x45468f(0x2b1)+_0x56421d[_0x45468f(0x1e8)]+_0x45468f(0x2f4)+_0x45468f(0x1b6)+_0x45468f(0x346)+'\x09<span>'+_0x56421d[_0x45468f(0x2b4)]+'</span>'+_0x45468f(0x1b6)+_0x45468f(0x346)+_0x45468f(0x2b1)+_0x56421d[_0x45468f(0x283)]+'</span>'+'</td>'+_0x45468f(0x346)+_0x45468f(0x2b1)+_0x56421d[_0x45468f(0x324)]+'</span>'+_0x45468f(0x1b6)+_0x45468f(0x29d),ClientInternalMembers[_0x45468f(0x325)]({'Title':_0x56421d[_0x45468f(0x1e8)],'Client_Code':_0x56421d[_0x45468f(0x324)],'Attn_Name':_0x56421d['Attn_Name'],'Supervisor':_0x56421d['Supervisor'][_0x45468f(0x2df)],'SupervisorId':_0x56421d[_0x45468f(0x26d)]['Id'],'SelfCompany':_0x56421d[_0x45468f(0x19f)],'IsActive':_0x56421d[_0x45468f(0x244)],'CustType':_0x56421d[_0x45468f(0x283)],'TemplateType':_0x56421d[_0x45468f(0x203)],'InternalMembers':_0x56421d['InternalMembers'],'InternalSupervisor':_0x56421d['InternalSupervisor'],'ID':_0x56421d['Id'],'DocumentLibrary':_0x56421d[_0x45468f(0x302)]});}GenarateclientGrid(_0x4971c2);});}function GetClientMasterfilter(){var _0x2a1b9e=a507_0x2cffb1;Taskusers=[],ClientInternalMembers[_0x2a1b9e(0x1b4)]==0x0&&(RestQuery=_0x2a1b9e(0x212),$[_0x2a1b9e(0x2fa)](CommonFunction[_0x2a1b9e(0x322)](_0x2a1b9e(0x343),RestQuery))[_0x2a1b9e(0x1e0)](function(_0x13de41){var _0x3a0c23=_0x2a1b9e;for(var _0x244200=0x0;_0x244200<_0x13de41[_0x3a0c23(0x2a9)][_0x3a0c23(0x1b4)];_0x244200++){InternalMembers=[],InternalMembers=_0x13de41[_0x3a0c23(0x2a9)][_0x244200],ClientInternalMembers['push']({'Title':InternalMembers[_0x3a0c23(0x1e8)],'Client_Code':InternalMembers[_0x3a0c23(0x324)],'Attn_Name':InternalMembers[_0x3a0c23(0x2b4)],'Supervisor':InternalMembers[_0x3a0c23(0x26d)][_0x3a0c23(0x2df)],'SupervisorId':InternalMembers[_0x3a0c23(0x26d)]['Id'],'SelfCompany':InternalMembers['SelfCompany'],'IsActive':InternalMembers[_0x3a0c23(0x244)],'CustType':InternalMembers[_0x3a0c23(0x283)],'TemplateType':InternalMembers['TemplateType'],'InternalMembers':InternalMembers['InternalMembers'],'InternalSupervisor':InternalMembers[_0x3a0c23(0x2a7)],'ID':InternalMembers['Id'],'DocumentLibrary':InternalMembers[_0x3a0c23(0x302)]});}}));}function GetClientMasterTeamDeailsByTitle(_0x4f0adf){var _0x20c6d0=a507_0x2cffb1;RestQuery='?$select=*,Id,Supervisor/Title,Supervisor/EMail,Supervisor/Id,\x20InternalMembers/EMail,InternalMembers/Title,InternalSupervisor/EMail,InternalSupervisor/Title\x20&$expand=Supervisor,InternalMembers,InternalSupervisor\x20&$filter=\x20Title\x20eq\x20\x27'+_0x4f0adf+'\x27',$['when'](CommonFunction[_0x20c6d0(0x322)](_0x20c6d0(0x343),RestQuery))['done'](function(_0x1b1063){var _0x2a8855=_0x20c6d0,_0x48a933;IsNotTeamMember='';if(_0x1b1063[_0x2a8855(0x2a9)][_0x2a8855(0x1b4)]>0x0){_0x48a933=[],_0x48a933=_0x1b1063[_0x2a8855(0x2a9)][0x0];var _0x3dee43=_0x48a933['IsActive']=_0x2a8855(0x209)?_0x48a933[_0x2a8855(0x244)]:_0x2a8855(0x2f2);ClientInternalMembers[_0x2a8855(0x325)]({'Title':_0x48a933['Title'],'Client_Code':_0x48a933[_0x2a8855(0x324)],'Attn_Name':_0x48a933[_0x2a8855(0x2b4)],'Supervisor':_0x48a933[_0x2a8855(0x26d)][_0x2a8855(0x2df)],'SelfCompany':_0x48a933['SelfCompany'],'CustType':_0x48a933[_0x2a8855(0x283)],'TemplateType':_0x48a933[_0x2a8855(0x203)],'InternalMembers':_0x48a933[_0x2a8855(0x2aa)],'InternalSupervisor':_0x48a933[_0x2a8855(0x2a7)],'ID':_0x48a933['Id']});}});}var SelectClientId='';function GenarateclientGrid(_0x551fb2){var _0x5a80e1=a507_0x2cffb1;$(_0x5a80e1(0x2d6))[_0x5a80e1(0x253)](),$(_0x5a80e1(0x2d6))['append'](_0x551fb2),$['fn'][_0x5a80e1(0x29b)][_0x5a80e1(0x295)](_0x5a80e1(0x2d6))?(tableC['destroy'](),tableC=$('#masterClientgrid')[_0x5a80e1(0x28c)]({'bPaginate':!![],'bJQueryUI':!![],'bLengthChange':![],'bFilter':!![],'bSort':!![],'bInfo':!![],'bAutoWidth':!![],'bProcessing':!![],'iDisplayLength':0x5,'dom':_0x5a80e1(0x31a),'colReorder':{'allowReorder':!![]},'language':{'searchPlaceholder':_0x5a80e1(0x2c0)},'columnDefs':[{'width':0x96,'targets':0x1}]})):tableC=$(_0x5a80e1(0x2d6))[_0x5a80e1(0x28c)]({'bPaginate':!![],'bJQueryUI':!![],'bLengthChange':![],'bFilter':!![],'bSort':!![],'bInfo':!![],'bAutoWidth':!![],'bProcessing':!![],'iDisplayLength':0x5,'dom':_0x5a80e1(0x31a),'colReorder':{'allowReorder':!![]},'language':{'searchPlaceholder':'Search'},'columnDefs':[{'width':0x96,'targets':0x1}]}),$(_0x5a80e1(0x2d6))[_0x5a80e1(0x1ec)](_0x5a80e1(0x328));}function selectOnlyThis(_0xc24c94){var _0x576de9=a507_0x2cffb1;SelectClientId='',SelectClientId=_0xc24c94[_0x576de9(0x2ce)]('_')[0x1],$(_0x576de9(0x264))[_0x576de9(0x32b)](this)[_0x576de9(0x330)](_0x576de9(0x1a0),![]),document['getElementById'](_0xc24c94)[_0x576de9(0x1a0)]=!![];}function cleartextBox(){var _0x188b51=a507_0x2cffb1;IsSetvalue=![],$('#txtExtLoginName')[_0x188b51(0x1ee)](''),$(_0x188b51(0x1e9))['val'](''),$(_0x188b51(0x1e9))['removeAttr']('disabled'),$(_0x188b51(0x263))[_0x188b51(0x1ee)](''),$(_0x188b51(0x1ad))[_0x188b51(0x1ee)](''),$('#txtAddOrganization')[_0x188b51(0x1ee)](''),$(_0x188b51(0x290))[_0x188b51(0x1ee)](''),$(_0x188b51(0x332))['attr'](_0x188b51(0x356),_0x188b51(0x216)),initializePeoplePicker(_0x188b51(0x28b),!![]),peoplePickerDiv=$(_0x188b51(0x25e)),initializePeoplePicker(_0x188b51(0x310),![]),peoplePickerDivsuper=$(_0x188b51(0x360));}function GetGroupIDByGroupName(){var _0x255a5c=a507_0x2cffb1,_0x34410b=_spPageContextInfo[_0x255a5c(0x351)]+_0x255a5c(0x30d);$['ajax']({'url':_0x34410b,'method':_0x255a5c(0x277),'async':![],'headers':{'Accept':'application/json;\x20odata=verbose'},'success':function(_0x1cd562){GroupId=_0x1cd562['d']['Id'];},'error':function(_0x410b1a){console['log'](_0x410b1a);}});}function SetCalendar(){var _0x441808=a507_0x2cffb1,_0x53f842=new Date();today=_0x53f842[_0x441808(0x306)]()+0x1+'\x20'+_0x53f842[_0x441808(0x2e9)]()+'\x20'+_0x53f842[_0x441808(0x1fa)](),Validdate=_0x53f842[_0x441808(0x306)]()+0x1+'/'+_0x53f842[_0x441808(0x2e9)]()+'/'+(_0x53f842['getFullYear']()+0x1),Dates=new Date(Validdate),$(_0x441808(0x2b8))[_0x441808(0x1ee)]($[_0x441808(0x359)][_0x441808(0x1ae)]('d\x20M,\x20yy',Dates));}function GetItemTypeForListName(_0x3351a2){var _0x7acc85=a507_0x2cffb1;return _0x7acc85(0x309)+_0x3351a2[_0x7acc85(0x348)](0x0)[_0x7acc85(0x271)]()+_0x3351a2['split']('\x20')[_0x7acc85(0x353)]('')[_0x7acc85(0x32f)](0x1)+_0x7acc85(0x255);}function Pertimtblock(_0x1c4bf7){var _0x4746dd=a507_0x2cffb1;GetCategoryMaster(),$[_0x4746dd(0x2fa)](GetItemToListchoice(),GetItemToList(_0x1c4bf7))[_0x4746dd(0x1e0)](function(_0x5c7359,_0xbb6ebb){var _0x31899f=_0x4746dd;if(_0xbb6ebb[_0x31899f(0x1b4)]>0x0){if(_0xbb6ebb[0x0][_0x31899f(0x202)][_0x31899f(0x2a9)][_0x31899f(0x1b4)]>0x0){var _0x5332ca=_0xbb6ebb[0x0][_0x31899f(0x202)][_0x31899f(0x2a9)][0x0][_0x31899f(0x1e6)];$('#extrenalImage')[_0x31899f(0x1b7)](_0x31899f(0x356),_0x5332ca);}else $(_0x31899f(0x332))[_0x31899f(0x1b7)](_0x31899f(0x356),'https://cdn.jsdelivr.net/gh/Titan4workGit/TitanRepo@main/SiteAssets/AdminPortal/ManageEmployee/assets/images/user_pic.jpg');IsUpdate=!![],userListItemId=_0xbb6ebb[0x0]['Id'],initializePeoplePicker(_0x31899f(0x28b),!![]),peoplePickerDiv=$(_0x31899f(0x25e)),initializePeoplePicker(_0x31899f(0x310),![]),peoplePickerDivsuper=$(_0x31899f(0x360));for(var _0x7cf409=0x0;_0x7cf409<_0xbb6ebb[0x0][_0x31899f(0x28b)][_0x31899f(0x2a9)][_0x31899f(0x1b4)];_0x7cf409++){setPeoplePickerUsersInfoCurrent(_0x31899f(0x1cd),_0xbb6ebb[0x0][_0x31899f(0x28b)]['results'][_0x7cf409][_0x31899f(0x2df)]);}setPeoplePickerUsersInfoCurrent(_0x31899f(0x254),_0xbb6ebb[0x0]['Supervisor']['EMail']);debugger;$(_0x31899f(0x344))['attr']('disabled',_0x31899f(0x33d)),$(_0x31899f(0x2fe))[_0x31899f(0x1b7)](_0x31899f(0x33d),_0x31899f(0x33d)),$(peoplePickerDiv)[_0x31899f(0x214)](_0x31899f(0x32d))[_0x31899f(0x31d)](_0x31899f(0x313),'none'),$(peoplePickerDivsuper)[_0x31899f(0x214)](_0x31899f(0x32d))[_0x31899f(0x31d)](_0x31899f(0x313),_0x31899f(0x2e6));for(var _0x7cf409=0x0;_0x7cf409<_0x5c7359[_0x31899f(0x1b4)];_0x7cf409++){var _0x423181=$(_0x31899f(0x35f));_0x423181['attr']('value',_0x5c7359[_0x7cf409])[_0x31899f(0x260)](_0x5c7359[_0x7cf409]);}$('#txtExtEmail')[_0x31899f(0x1ee)](_0xbb6ebb[0x0]['email']);IsSetvalue&&$(_0x31899f(0x1e9))[_0x31899f(0x1b7)]('disabled',_0x31899f(0x33d));$('#txtExtLoginName')[_0x31899f(0x1ee)](_0xbb6ebb[0x0][_0x31899f(0x303)][_0x31899f(0x1e8)]?_0xbb6ebb[0x0]['LoginName']['Title']:_0xbb6ebb[0x0][_0x31899f(0x1c5)]),$(_0x31899f(0x263))[_0x31899f(0x1ee)](_0xbb6ebb[0x0]['Designation']),$('#txtExternalSupervisor')['val'](_0xbb6ebb[0x0][_0x31899f(0x300)]['Title']),$('#ddlAssociation')[_0x31899f(0x1ee)](_0xbb6ebb[0x0]['Association']),$(_0x31899f(0x1dc))[_0x31899f(0x1ee)](_0xbb6ebb[0x0][_0x31899f(0x2c3)]),$(_0x31899f(0x2be))[_0x31899f(0x1ee)](_0xbb6ebb[0x0]['Client_Name'][_0x31899f(0x1e8)]),Client_Id=_0xbb6ebb[0x0][_0x31899f(0x34a)]['Id'];var _0x2c1abb=new Date(_0xbb6ebb[0x0]['ValidUpto']);$('#datepickerAD5')[_0x31899f(0x1ee)]($['datepicker'][_0x31899f(0x1ae)](_0x31899f(0x2b6),_0x2c1abb)),$(_0x31899f(0x1ad))[_0x31899f(0x1ee)](_0xbb6ebb[0x0][_0x31899f(0x363)]),$(_0x31899f(0x273)+_0xbb6ebb[0x0][_0x31899f(0x203)]+']')[_0x31899f(0x1b7)]('selected',_0x31899f(0x209)),$('#selectByUser\x20>\x20[value='+_0xbb6ebb[0x0][_0x31899f(0x243)]+']')['attr'](_0x31899f(0x2fd),_0x31899f(0x209)),$('#btnotherOrganizationSearch')[_0x31899f(0x245)](),GetClientMasterTeamDeailsByTitle(_0xbb6ebb[0x0][_0x31899f(0x34a)][_0x31899f(0x1e8)]);}else $(_0x31899f(0x1ce))[_0x31899f(0x1ee)](''),$(_0x31899f(0x263))[_0x31899f(0x1ee)](''),$(_0x31899f(0x1dc))[_0x31899f(0x1ee)](''),$('#txtReferenceCodeExt')[_0x31899f(0x1ee)](''),$('option:selected',$('#TemplateType'))[_0x31899f(0x1ee)](''),$('#datepickerAD5')[_0x31899f(0x1ee)]($[_0x31899f(0x359)][_0x31899f(0x1ae)](_0x31899f(0x1e7),new Date())),$(_0x31899f(0x1a9),$(_0x31899f(0x1e3)))[_0x31899f(0x1ee)](),$('option:selected',$(_0x31899f(0x250)))[_0x31899f(0x1ee)](),$(_0x31899f(0x332))[_0x31899f(0x1b7)](_0x31899f(0x356),_0x31899f(0x207)),$('#GueastextinputFile')[_0x31899f(0x1b7)](_0x31899f(0x356),_0x31899f(0x207)),initializePeoplePicker(_0x31899f(0x28b),!![]),peoplePickerDiv=$(_0x31899f(0x25e)),initializePeoplePicker(_0x31899f(0x310),![]),peoplePickerDivsuper=$('[id$=\x27internalsupervisor_TopSpan\x27]');});}function GetItemToListchoice(){var _0x244dd8=a507_0x2cffb1,_0x34bdda=_0x244dd8(0x2b7),_0x3cfa56=$[_0x244dd8(0x28e)]();return $[_0x244dd8(0x1a5)]({'url':_spPageContextInfo[_0x244dd8(0x351)]+_0x244dd8(0x20f)+_0x34bdda+_0x244dd8(0x1b8),'type':'get','async':![],'headers':{'accept':_0x244dd8(0x1d7),'X-RequestDigest':$(_0x244dd8(0x2d5))[_0x244dd8(0x1ee)](),'content-Type':_0x244dd8(0x1d7)},'success':function(_0x332aac){var _0x1eeb47=_0x244dd8;_0x3cfa56[_0x1eeb47(0x2e1)](_0x332aac['d'][_0x1eeb47(0x2a9)][0x0][_0x1eeb47(0x224)][_0x1eeb47(0x2a9)]),console[_0x1eeb47(0x2c6)](_0x332aac);},'error':function(_0x2e92b5){var _0x4e90fc=_0x244dd8;console['log'](JSON[_0x4e90fc(0x247)](_0x2e92b5)),_0x3cfa56['reject'](_0x2e92b5);}}),_0x3cfa56[_0x244dd8(0x1c0)]();}function GetItemToList(_0x212f84){var _0x2abae4=a507_0x2cffb1,_0x5aca44=_0x2abae4(0x2b7),_0x5d8b68=$['Deferred']();return $[_0x2abae4(0x1a5)]({'url':_spPageContextInfo[_0x2abae4(0x351)]+'/_api/web/lists/getbytitle(\x27'+_0x5aca44+_0x2abae4(0x1d2)+_0x212f84+'\x27','type':_0x2abae4(0x1aa),'async':![],'headers':{'accept':_0x2abae4(0x1d7),'X-RequestDigest':$(_0x2abae4(0x2d5))[_0x2abae4(0x1ee)](),'content-Type':_0x2abae4(0x1d7)},'success':function(_0x4bcf03){var _0x4a70d5=_0x2abae4;_0x5d8b68['resolve'](_0x4bcf03['d'][_0x4a70d5(0x2a9)]),console[_0x4a70d5(0x2c6)](_0x4bcf03);},'error':function(_0x110c9f){var _0x42671d=_0x2abae4;console[_0x42671d(0x2c6)](JSON[_0x42671d(0x247)](_0x110c9f)),_0x5d8b68['reject'](_0x110c9f);}}),_0x5d8b68['promise']();}function GetCategoryMaster(){var _0x5c685b=a507_0x2cffb1,_0x9ee9ca=_0x5c685b(0x29c),_0x1e51e7=_spPageContextInfo[_0x5c685b(0x351)]+_0x5c685b(0x211)+_0x9ee9ca+_0x5c685b(0x23b);$['ajax']({'url':_0x1e51e7,'headers':{'Accept':_0x5c685b(0x1d7)},'async':![],'success':function(_0x4d490a){var _0x400fc4=_0x5c685b,_0x204c3d=document[_0x400fc4(0x1b9)]('selectByUser');_0x204c3d[_0x400fc4(0x342)]='';for(var _0x359351=0x0;_0x359351<_0x4d490a['d'][_0x400fc4(0x2a9)]['length'];_0x359351++){var _0x4dde6d=_0x4d490a['d']['results'][_0x359351][_0x400fc4(0x2e3)],_0x29bc6d=_0x4d490a['d'][_0x400fc4(0x2a9)][_0x359351][_0x400fc4(0x2e3)];opt=document[_0x400fc4(0x2d7)](_0x400fc4(0x329)),opt[_0x400fc4(0x278)]=_0x29bc6d,opt[_0x400fc4(0x260)]=_0x4dde6d,_0x204c3d[_0x400fc4(0x1d4)](opt);}},'error':function(_0x339a3a){console['log'](_0x339a3a);}});}function readURL(_0x3f3b79){var _0x5da35b=a507_0x2cffb1;if(_0x3f3b79['files']&&_0x3f3b79[_0x5da35b(0x2bf)][0x0]){var _0x2b3c9c=new FileReader();_0x2b3c9c[_0x5da35b(0x20d)]=function(_0x7ec73b){var _0x4695b2=_0x5da35b;$(_0x4695b2(0x332))[_0x4695b2(0x1b7)](_0x4695b2(0x356),_0x7ec73b[_0x4695b2(0x1b3)]['result']);},_0x2b3c9c[_0x5da35b(0x294)](_0x3f3b79['files'][0x0]);}}var DocumentLibraryUrl='';function UpdateGeustuser(_0x57d7a1){var _0x3a64a4=a507_0x2cffb1,_0x1ec693='ExternalUsers',_0x43fe7f='',_0x5dbf11=SPClientPeoplePicker[_0x3a64a4(0x2a8)][peoplePickerDiv[0x0]['id']],_0x10f325=_0x5dbf11[_0x3a64a4(0x362)](),_0x289c2d=[];UserListId=[];for(var _0x49ed24=0x0;_0x49ed24<_0x10f325[_0x3a64a4(0x1b4)];_0x49ed24++){var _0x23e6f8=GetUserId(_0x10f325[_0x49ed24][_0x3a64a4(0x289)][_0x3a64a4(0x225)]);_0x23e6f8==''&&(_0x23e6f8=GetUserId(_0x10f325[_0x49ed24]['Key'][_0x3a64a4(0x2ce)]('|')[0x2])),_0x289c2d[_0x3a64a4(0x325)](_0x23e6f8),UserListId[_0x3a64a4(0x325)](_0x23e6f8);}var _0x1fb632=ClientInternalMembers[_0x3a64a4(0x2ed)](function(_0x3512e0){var _0x1cfbb7=_0x3a64a4;return _0x3512e0[_0x1cfbb7(0x1e8)]==$('#txtAddOrganization')['val']();});_0x5dbf11=SPClientPeoplePicker[_0x3a64a4(0x2a8)][peoplePickerDivsuper[0x0]['id']],_0x10f325=_0x5dbf11['GetAllUserInfo']();var _0x2952da=GetUserId(_0x10f325[0x0][_0x3a64a4(0x289)]['Email']);_0x2952da==''&&(_0x2952da=GetUserId(_0x10f325[0x0][_0x3a64a4(0x30a)][_0x3a64a4(0x2ce)]('|')[0x2]));UserListId[_0x3a64a4(0x325)](_0x2952da),_0x43fe7f=GetUserEmail($(_0x3a64a4(0x1e9))['val']()),UserListId[_0x3a64a4(0x325)](_0x43fe7f),GuestUserEmail=$('#txtExtEmail')[_0x3a64a4(0x1ee)](),DocumentLibraryUrl=_spPageContextInfo[_0x3a64a4(0x351)]+'/GuestUserDocuments/'+$(_0x3a64a4(0x2be))[_0x3a64a4(0x1ee)]()[_0x3a64a4(0x22f)]()[_0x3a64a4(0x246)](/[^0-9A-Z]+/gi,'')+_0x3a64a4(0x33b);_0x43fe7f==''&&(GetGroupIDByGroupName(),AddUserinSharePointGroup($(_0x3a64a4(0x1e9))[_0x3a64a4(0x1ee)](),GroupId));var _0x4d1c8b,_0x50be84=GetItemTypeForListName(_0x1ec693);_0x4d1c8b={'__metadata':{'type':_0x50be84},'Designation':$(_0x3a64a4(0x263))['val'](),'LoginNameId':_0x43fe7f,'Supervisor_GuestId':_0x43fe7f,'Organization':$(_0x3a64a4(0x2be))[_0x3a64a4(0x1ee)](),'ReferenceCode':$(_0x3a64a4(0x1ad))[_0x3a64a4(0x1ee)](),'TemplateType':$('option:selected',$(_0x3a64a4(0x2ad)))[_0x3a64a4(0x1ee)](),'InternalStakeholdersId':{'results':_0x289c2d},'SupervisorId':_0x2952da,'ValidUpto':$('#datepickerAD5')[_0x3a64a4(0x1ee)](),'CollaborationType':$('option:selected',$(_0x3a64a4(0x1e3)))[_0x3a64a4(0x1ee)](),'Status':$(_0x3a64a4(0x1a9),$(_0x3a64a4(0x250)))[_0x3a64a4(0x1ee)](),'DocumentLibrary':DocumentLibraryUrl};var _0x179c06=$[_0x3a64a4(0x28e)]();return $[_0x3a64a4(0x1a5)]({'url':_spPageContextInfo[_0x3a64a4(0x351)]+_0x3a64a4(0x211)+_0x1ec693+_0x3a64a4(0x1d1)+_0x57d7a1+')','type':_0x3a64a4(0x33c),'async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$('#__REQUESTDIGEST')[_0x3a64a4(0x1ee)](),'content-Type':_0x3a64a4(0x1d7),'IF-MATCH':'*','X-HTTP-Method':_0x3a64a4(0x2c9)},'data':JSON[_0x3a64a4(0x247)](_0x4d1c8b),'success':function(_0x2b0fd6){var _0x13b4a7=_0x3a64a4;if(document['getElementById'](_0x13b4a7(0x2a2))[_0x13b4a7(0x2bf)][_0x13b4a7(0x1b4)]===0x0){}else UploadAttachement(ExtrnaluserId);IsExistOrNotLibrary($(_0x13b4a7(0x2be))[_0x13b4a7(0x1ee)]()[_0x13b4a7(0x22f)]()['replace'](/[^0-9A-Z]+/gi,''))?AssignTheEditRole($(_0x13b4a7(0x2be))['val']()[_0x13b4a7(0x22f)]()[_0x13b4a7(0x246)](/[^0-9A-Z]+/gi,''),UserListId):(createNewLibraryByRest($('#txtAddOrganization')[_0x13b4a7(0x1ee)]()[_0x13b4a7(0x22f)]()['replace'](/[^0-9A-Z]+/gi,'')),AssignTheEditRole($('#txtAddOrganization')[_0x13b4a7(0x1ee)]()[_0x13b4a7(0x22f)]()[_0x13b4a7(0x246)](/[^0-9A-Z]+/gi,''),UserListId));$('#txtExternalSupervisor')['val']()==''&&UpdateClientMaster(_0x1fb632[0x0]['ID'],_0x43fe7f);_0x1fb632[0x0][_0x13b4a7(0x302)]==null&&UpdateClientMasterDocLib(_0x1fb632[0x0]['ID'],DocumentLibraryUrl,_0x2952da,_0x289c2d);createNewCustomColumn(),alert(_0x13b4a7(0x1ac));for(var _0x2f4e2d in htmlGridarray){if(htmlGridarray[_0x2f4e2d]['ID']==ExtrnaluserId){htmlGridarray[_0x2f4e2d]['Status']=_0x13b4a7(0x2f2),htmlGridarray[_0x2f4e2d][_0x13b4a7(0x31c)]='';break;}}GenerateGridHtml(htmlGridarray);},'error':function(_0x576b11){var _0x123119=_0x3a64a4;console[_0x123119(0x2c6)](JSON[_0x123119(0x247)](_0x576b11)),_0x179c06[_0x123119(0x248)](_0x576b11);}}),_0x179c06[_0x3a64a4(0x1c0)]();}function UploadAttachement(_0x17495f){var _0x396bd2=a507_0x2cffb1;try{if(document['getElementById'](_0x396bd2(0x2a2))['files'][_0x396bd2(0x1b4)]===0x0){}else{var _0x4ba3bc=_0x17495f,_0x15f899=$('#GueastextinputFile'),_0x52b037=_0x15f899[0x0]['files'][_0x396bd2(0x1b4)],_0x3acd64=[],_0x1c68ab=_0x15f899[0x0][_0x396bd2(0x2bf)][0x0][_0x396bd2(0x231)];_0x1c68ab=_0x15f899[0x0]['files'][0x0]['name'][_0x396bd2(0x246)](/[^a-zA-Z0-9-. ]/g,''),_0x1c68ab=_0x1c68ab[_0x396bd2(0x246)](/\s/g,'');for(var _0x5c49f3=0x0;_0x5c49f3<_0x52b037;_0x5c49f3++){_0x3acd64[_0x396bd2(0x325)](_0x15f899[0x0]['files'][_0x5c49f3]);}uploadFileSP('ExternalUsers',_0x4ba3bc,_0x3acd64,_0x52b037,_0x1c68ab);}}catch(_0x497183){alert('Your\x20item\x20has\x20not\x20been\x20submitted\x20successfully!');}}function uploadFileSP(_0x303cc4,_0x1b40cd,_0x43bd4d,_0x4a200c,_0x348957){var _0x4ee133=a507_0x2cffb1,_0x37b2f8=0x0,_0xa24a03=$[_0x4ee133(0x28e)](),_0x8090ea='',_0x903c2f=_0x43bd4d[0x0],_0xd9e365=getFileBuffer(_0x903c2f);return _0xd9e365[_0x4ee133(0x1e0)](function(_0x2d4214,_0x3d562a,_0x3281db){var _0x41192a=_0x4ee133,_0x1cf4a0=new Uint8Array(_0x2d4214),_0x470ae3=new SP[(_0x41192a(0x27a))](),_0x4e5834=_spPageContextInfo[_0x41192a(0x351)]+_0x41192a(0x1f2)+_0x303cc4+_0x41192a(0x1d1)+_0x1b40cd+_0x41192a(0x334)+_0x348957+'\x27)',_0x4f3614=0x0;$[_0x41192a(0x1a5)]({'url':_0x4e5834,'type':_0x41192a(0x33c),'processData':![],'contentType':_0x41192a(0x1d7),'data':_0x2d4214,'headers':{'accept':_0x41192a(0x1d7),'X-RequestDigest':$(_0x41192a(0x2d5))['val'](),'content-length':_0x2d4214['byteLength']},'success':function(_0x44ae76){var _0x38ac66=_0x41192a;_0x37b2f8++,_0x8090ea=_0x37b2f8,_0x43bd4d[_0x38ac66(0x31b)]();if(_0x43bd4d['length']>0x0)uploadFileSP(_0x38ac66(0x2b7),_0x1b40cd,_0x43bd4d,_0x43bd4d['length']);else{}},'error':function(_0x47dce6){alert('Idea\x20has\x20been\x20submitted\x20but\x20some\x20files\x20failed\x20to\x20upload.');}}),_0xa24a03['resolve'](_0x8090ea);}),_0xd9e365[_0x4ee133(0x227)](function(_0xb0a356){var _0x27d64b=_0x4ee133;_0xa24a03[_0x27d64b(0x248)](_0xb0a356);}),_0xa24a03[_0x4ee133(0x1c0)]();}function GetUserId(_0x355fc4){var _0x1c2dfd=a507_0x2cffb1,_0x4f53be='',_0x310b16=_0x1c2dfd(0x285),_0x495fab=_spPageContextInfo[_0x1c2dfd(0x2f3)],_0x8a0f6a=_0x310b16+_0x355fc4;return $['ajax']({'url':_0x495fab+'/_api/web/siteusers(@v)?@v=\x27'+encodeURIComponent(_0x8a0f6a)+'\x27','method':'GET','headers':{'Accept':_0x1c2dfd(0x28d)},'async':![],'success':function(_0x296c2d){_0x4f53be=_0x296c2d['d']['Id'];},'error':function(_0xe8c7a2){var _0x87064c=_0x1c2dfd;console[_0x87064c(0x2c6)](JSON[_0x87064c(0x247)](_0xe8c7a2)),console[_0x87064c(0x2c6)](JSON[_0x87064c(0x247)](_0x87064c(0x316)+_0x355fc4));}}),_0x4f53be;}function GetUserEmail(_0x29e32e){var _0x11ff84=a507_0x2cffb1,_0x63b39e='',_0x46a703=_spPageContextInfo[_0x11ff84(0x2f3)];return $[_0x11ff84(0x1a5)]({'url':_0x46a703+'/_api/web/siteusers/getbyemail(\x27'+_0x29e32e+'\x27)','method':_0x11ff84(0x277),'headers':{'Accept':_0x11ff84(0x28d)},'async':![],'success':function(_0x4ba2e0){_0x63b39e=_0x4ba2e0['d']['Id'];},'error':function(_0x69997c){var _0x568e0e=_0x11ff84;console[_0x568e0e(0x2c6)](JSON[_0x568e0e(0x247)](_0x69997c)),console[_0x568e0e(0x2c6)](JSON['stringify'](_0x568e0e(0x316)+_0x29e32e));}}),_0x63b39e;}function createNewLibraryByRest(_0x3aba9c){var _0x342719=a507_0x2cffb1,_0x61dc47=_0x3aba9c,_0x3641f2=_spPageContextInfo[_0x342719(0x351)]+_0x342719(0x1ab);$['ajax']({'url':_0x3641f2,'method':_0x342719(0x33c),'async':![],'data':JSON[_0x342719(0x247)]({'__metadata':{'type':_0x342719(0x1ef)},'AllowContentTypes':!![],'BaseTemplate':0x65,'ContentTypesEnabled':!![],'Description':_0x342719(0x291),'OnQuickLaunch':!![],'Title':_0x3aba9c}),'headers':{'content-type':_0x342719(0x1d7),'X-RequestDigest':$(_0x342719(0x2d5))[_0x342719(0x1ee)]()},'success':function(_0x5ce8b3){BreakRoleInheritance(_0x61dc47);},'error':function(_0x5ec211){var _0x525025=_0x342719;alert(_0x5ec211[_0x525025(0x280)]);}});}function BreakRoleInheritance(_0x26ade2){var _0x3d46e3=a507_0x2cffb1;url=_spPageContextInfo[_0x3d46e3(0x351)]+_0x3d46e3(0x266)+_0x26ade2+'\x27)/breakroleinheritance(false)',$[_0x3d46e3(0x1a5)]({'url':url,'type':'POST','async':![],'headers':{'accept':_0x3d46e3(0x34f),'X-RequestDigest':$(_0x3d46e3(0x2d5))[_0x3d46e3(0x1ee)]()},'success':function(_0x4fcb7a){var _0x44a84f=_0x3d46e3;console[_0x44a84f(0x2c6)](_0x4fcb7a);},'error':function(_0x5d7e73){console['log'](_0x5d7e73);}});}function AssignTheEditRole(_0x281347,_0x48d6a6){var _0x42c555=a507_0x2cffb1;for(var _0x3c1b0e=0x0;_0x3c1b0e<_0x48d6a6[_0x42c555(0x1b4)];_0x3c1b0e++){url=_spPageContextInfo['webAbsoluteUrl']+_0x42c555(0x266)+_0x281347+'\x27)/roleassignments/addroleassignment(principalid=\x27'+_0x48d6a6[_0x3c1b0e]+'\x27,roledefid=\x271073741830\x27)',$[_0x42c555(0x1a5)]({'url':url,'type':_0x42c555(0x33c),'async':![],'headers':{'accept':_0x42c555(0x34f),'X-RequestDigest':$(_0x42c555(0x2d5))[_0x42c555(0x1ee)]()},'success':function(_0x21e32e){var _0x37435d=_0x42c555;console[_0x37435d(0x2c6)](_0x21e32e);},'error':function(_0x2913d2){var _0x4e63db=_0x42c555;console[_0x4e63db(0x2c6)](_0x2913d2);}});}}function IsExistOrNotLibrary(_0x3e408b){var _0x18bd97=a507_0x2cffb1,_0xb9f30e='';return url=_spPageContextInfo[_0x18bd97(0x351)]+'/GuestUserDocuments/_api/web/lists/?$filter=Title\x20eq\x20\x27'+_0x3e408b+'\x27',$['ajax']({'url':url,'type':_0x18bd97(0x1aa),'async':![],'headers':{'accept':_0x18bd97(0x34f),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x18bd97(0x1ee)]()},'success':function(_0x31fb1b){var _0x504a35=_0x18bd97;_0x31fb1b[_0x504a35(0x278)][_0x504a35(0x1b4)]>0x0?_0xb9f30e=!![]:_0xb9f30e=![],console['log'](_0x31fb1b);},'error':function(_0x323831){var _0x3887ec=_0x18bd97;console[_0x3887ec(0x2c6)](_0x323831);}}),_0xb9f30e;}function addSpinner(_0x57e002,_0x533504){var _0x54b04b=a507_0x2cffb1,_0x5336c4=_0x57e002[_0x54b04b(0x35a)](_0x54b04b(0x1a8));if(_0x5336c4[_0x54b04b(0x1b4)]&&!_0x5336c4[_0x54b04b(0x21b)](_0x54b04b(0x335)))return null;!_0x5336c4[_0x54b04b(0x1b4)]&&(_0x5336c4=$('<div\x20class=\x22spinner'+(_0x533504?'':'\x20spinner-absolute')+'\x22/>')[_0x54b04b(0x347)](_0x57e002)),animateSpinner(_0x5336c4,_0x54b04b(0x2cb));}function removeSpinner(_0x54e9c2,_0x38f225){var _0x24b877=a507_0x2cffb1,_0x49fda2=_0x54e9c2['children'](_0x24b877(0x1a8));_0x49fda2['length']&&animateSpinner(_0x49fda2,_0x24b877(0x1bc),_0x38f225);}function animateSpinner(_0x404ae9,_0x82ba3a,_0xded71e){var _0xb2c235=a507_0x2cffb1;_0x404ae9['data'](_0xb2c235(0x2e2))&&(_0x404ae9['removeClass'](_0x404ae9['data'](_0xb2c235(0x2e2)))[_0xb2c235(0x23f)]('animating',null),_0x404ae9['data'](_0xb2c235(0x1ba))&&clearTimeout(_0x404ae9['data'](_0xb2c235(0x1ba)))),_0x404ae9[_0xb2c235(0x1c2)](_0xb2c235(0x228)+_0x82ba3a)[_0xb2c235(0x23f)](_0xb2c235(0x2e2),_0xb2c235(0x228)+_0x82ba3a),_0x404ae9['data'](_0xb2c235(0x1ba),setTimeout(function(){var _0x52d178=_0xb2c235;_0x82ba3a==_0x52d178(0x1bc)&&_0x404ae9['remove'](),_0xded71e&&_0xded71e();},parseFloat(_0x404ae9[_0xb2c235(0x31d)]('animation-duration'))*0x3e8));}function getTemplate(){var _0x4d8608=a507_0x2cffb1,_0x28443c,_0x3093f5=_0x4d8608(0x19d),_0x5201ae,_0x46344b=$(_0x4d8608(0x2ff))[_0x4d8608(0x260)]();_0x5201ae=$('#TemplateType\x20option:selected')[_0x4d8608(0x1ee)](),$(_0x4d8608(0x333))['empty'](),$(_0x4d8608(0x1c3))[_0x4d8608(0x253)](),$(_0x4d8608(0x305))[_0x4d8608(0x253)](),_0x46344b!=''?_0x28443c=_spPageContextInfo[_0x4d8608(0x351)]+_0x4d8608(0x20a)+_0x5201ae+_0x4d8608(0x270):_0x28443c=_spPageContextInfo[_0x4d8608(0x351)]+_0x4d8608(0x272),$[_0x4d8608(0x1a5)]({'url':_0x28443c,'headers':{'Accept':_0x4d8608(0x1d7)},'async':![],'success':function(_0x3d7f73){var _0x4da31b=_0x4d8608,_0x83a9e3=_0x3d7f73['d']['results'];for(var _0x473778=0x0;_0x473778<_0x83a9e3[_0x4da31b(0x1b4)];_0x473778++){$(_0x4da31b(0x333))[_0x4da31b(0x2b5)](_0x83a9e3[_0x473778][_0x4da31b(0x1e8)]),$(_0x4da31b(0x1c3))[_0x4da31b(0x2b5)](_0x83a9e3[_0x473778]['CustomName']),$(_0x4da31b(0x305))[_0x4da31b(0x2b5)](_0x83a9e3[_0x473778][_0x4da31b(0x291)]);var _0x45b92f=$('#templateImg');_0x46344b!=''&&_0x45b92f[_0x4da31b(0x1b7)]('src',_0x83a9e3[0x0][_0x4da31b(0x202)]['results'][0x0][_0x4da31b(0x1e6)]),_0x46344b==''&&$('#TemplateType')[_0x4da31b(0x2b5)]($(_0x4da31b(0x24a))[_0x4da31b(0x1ee)](_0x83a9e3[_0x473778][_0x4da31b(0x1e8)])[_0x4da31b(0x260)](_0x83a9e3[_0x473778][_0x4da31b(0x1b0)]));}},'error':function(_0x4c0975){console['log'](_0x4c0975);}});}function createNewCustomColumn(){var _0x1ab6f9=a507_0x2cffb1,_0x34d0c8=$('#txtAddOrganization')[_0x1ab6f9(0x1ee)]()['trim']()[_0x1ab6f9(0x246)](/[^0-9A-Z]+/gi,''),_0x148a5f=_spPageContextInfo[_0x1ab6f9(0x351)]+'/GuestUserDocuments';for(var _0x340b20=0x0;_0x340b20<arrMeta[_0x1ab6f9(0x1b4)];_0x340b20++){var _0x1fdb74,_0x3eb79f='';GetAllFieldsFromList(_0x148a5f,_0x34d0c8,arrMeta[_0x340b20][_0x1ab6f9(0x1e8)]),_0x3eb79f=_0x148a5f+_0x1ab6f9(0x311)+_0x34d0c8+_0x1ab6f9(0x1fb),arrMeta[_0x340b20]['FieldTypeKind']==0x6?arrMeta[_0x340b20]['Title']==_0x1ab6f9(0x284)?_0x1fdb74={'__metadata':{'type':_0x1ab6f9(0x1ea),'addToDefaultView':_0x1ab6f9(0x209)},'FieldTypeKind':arrMeta[_0x340b20][_0x1ab6f9(0x2d0)],'Title':arrMeta[_0x340b20]['Title'],'Choices':{'results':[_0x1ab6f9(0x28f),_0x1ab6f9(0x25f),_0x1ab6f9(0x24b)]}}:_0x1fdb74={'__metadata':{'type':_0x1ab6f9(0x1ea),'addToDefaultView':_0x1ab6f9(0x209)},'FieldTypeKind':arrMeta[_0x340b20]['FieldTypeKind'],'Title':arrMeta[_0x340b20][_0x1ab6f9(0x1e8)],'Choices':{'results':['Draft',_0x1ab6f9(0x1db),_0x1ab6f9(0x1f9),_0x1ab6f9(0x20c)]}}:arrMeta[_0x340b20]['FieldTypeKind']!=0x7&&(_0x1fdb74={'__metadata':{'type':_0x1ab6f9(0x262),'addToDefaultView':_0x1ab6f9(0x209)},'FieldTypeKind':arrMeta[_0x340b20][_0x1ab6f9(0x2d0)],'Title':arrMeta[_0x340b20][_0x1ab6f9(0x1e8)]}),arrMeta[_0x340b20][_0x1ab6f9(0x1e8)]==_0x1ab6f9(0x2d2)&&(_0x3eb79f=_0x148a5f+_0x1ab6f9(0x311)+_0x34d0c8+'\x27)/fields',_0x1fdb74={'__metadata':{'type':_0x1ab6f9(0x32e),'addToDefaultView':'true'},'FieldTypeKind':arrMeta[_0x340b20][_0x1ab6f9(0x2d0)],'Title':arrMeta[_0x340b20][_0x1ab6f9(0x1e8)],'AllowMultipleValues':!![]}),arrMeta[_0x340b20][_0x1ab6f9(0x1e8)]==_0x1ab6f9(0x1da)&&(_0x3eb79f=_0x148a5f+_0x1ab6f9(0x311)+_0x34d0c8+_0x1ab6f9(0x1fb),_0x1fdb74={'__metadata':{'type':'SP.FieldUser','addToDefaultView':_0x1ab6f9(0x209)},'FieldTypeKind':arrMeta[_0x340b20]['FieldTypeKind'],'Title':arrMeta[_0x340b20][_0x1ab6f9(0x1e8)]}),arrMeta[_0x340b20][_0x1ab6f9(0x1e8)]==_0x1ab6f9(0x1c8)&&(_0x3eb79f=_0x148a5f+_0x1ab6f9(0x311)+_0x34d0c8+_0x1ab6f9(0x1fb),_0x1fdb74={'__metadata':{'type':_0x1ab6f9(0x2d1)},'FieldTypeKind':arrMeta[_0x340b20][_0x1ab6f9(0x2d0)],'Title':arrMeta[_0x340b20]['Title'],'DisplayFormat':0x0}),arrMeta[_0x340b20][_0x1ab6f9(0x1e8)]==_0x1ab6f9(0x1df)&&(_0x3eb79f=_0x148a5f+_0x1ab6f9(0x311)+_0x34d0c8+_0x1ab6f9(0x1fb),_0x1fdb74={'__metadata':{'type':'SP.FieldDateTime'},'FieldTypeKind':arrMeta[_0x340b20][_0x1ab6f9(0x2d0)],'Title':arrMeta[_0x340b20][_0x1ab6f9(0x1e8)],'DisplayFormat':0x0}),arrMeta[_0x340b20][_0x1ab6f9(0x1e8)]==_0x1ab6f9(0x321)&&(_0x3eb79f=_0x148a5f+_0x1ab6f9(0x311)+_0x34d0c8+'\x27)/fields',_0x1fdb74={'__metadata':{'type':_0x1ab6f9(0x2d1)},'FieldTypeKind':arrMeta[_0x340b20][_0x1ab6f9(0x2d0)],'Title':arrMeta[_0x340b20][_0x1ab6f9(0x1e8)],'DisplayFormat':0x0}),arrMeta[_0x340b20][_0x1ab6f9(0x1e8)]==_0x1ab6f9(0x1f1)&&(_0x3eb79f=_0x148a5f+_0x1ab6f9(0x311)+_0x34d0c8+_0x1ab6f9(0x1fb),_0x1fdb74={'__metadata':{'type':_0x1ab6f9(0x32e),'addToDefaultView':_0x1ab6f9(0x209)},'FieldTypeKind':arrMeta[_0x340b20][_0x1ab6f9(0x2d0)],'Title':arrMeta[_0x340b20][_0x1ab6f9(0x1e8)],'SelectionMode':0x0}),$[_0x1ab6f9(0x1a5)]({'url':_0x3eb79f,'type':_0x1ab6f9(0x33c),'async':![],'data':JSON[_0x1ab6f9(0x247)](_0x1fdb74),'headers':{'Accept':_0x1ab6f9(0x1d7),'Content-Type':_0x1ab6f9(0x1d7),'X-RequestDigest':$(_0x1ab6f9(0x2d5))['val']()},'success':function(_0x291d51,_0x47ed80,_0x2d4eb){var _0x313547=_0x1ab6f9;console[_0x313547(0x2c6)](_0x313547(0x242));},'error':function(_0x13793d,_0x3d6f09,_0xd1202c){var _0x5485a8=_0x1ab6f9;console[_0x5485a8(0x2c6)]('Failed');}});}}function GetAllFieldsFromList(_0x113364,_0x2b0a29,_0x176aca){var _0x2c1b41=a507_0x2cffb1;arrColumn='',$[_0x2c1b41(0x1a5)]({'url':_0x113364+_0x2c1b41(0x311)+_0x2b0a29+'\x27)/fields?$filter=Title\x20eq\x20\x27'+_0x176aca+'\x27','method':_0x2c1b41(0x277),'async':![],'headers':{'Accept':_0x2c1b41(0x1d7)},'success':function(_0x318484,_0x50868c,_0x2d72e4){var _0x231e0a=_0x2c1b41,_0x56bdb1=_0x318484['d'][_0x231e0a(0x2a9)];if(_0x56bdb1[_0x231e0a(0x1b4)]>0x0)for(var _0xc73b7f=0x0;_0xc73b7f<_0x56bdb1[_0x231e0a(0x1b4)];_0xc73b7f++){ColumnTitle=_0x56bdb1[_0xc73b7f][_0x231e0a(0x1e8)],DeleteListColumn(_0x113364,ColumnTitle,_0x2b0a29);}},'error':function(_0x5f46c8,_0x5328a9,_0x8d199e){alert(_0x5f46c8);}});}function DeleteListColumn(_0x42d17b,_0x5ab7b0,_0x3aff7c){var _0x19c6ce=a507_0x2cffb1;$[_0x19c6ce(0x1a5)]({'url':_0x42d17b+'/_api/web/lists/getByTitle(\x27'+_0x3aff7c+_0x19c6ce(0x358)+_0x5ab7b0+'\x27)','type':_0x19c6ce(0x33c),'async':![],'headers':{'Accept':_0x19c6ce(0x1d7),'Content-Type':_0x19c6ce(0x1d7),'IF-MATCH':'*','X-HTTP-Method':'DELETE','X-RequestDigest':$(_0x19c6ce(0x2d5))['val']()},'success':function(_0x171a15,_0x12aaac,_0x5ce880){var _0x6cc5b1=_0x19c6ce;console['log'](_0x6cc5b1(0x22b)+_0x5ab7b0);},'error':function(_0x2f9052,_0x3f95fa,_0x4f2917){var _0xe58ee0=_0x19c6ce;console[_0xe58ee0(0x2c6)](_0xe58ee0(0x2b9));}});}var arrMeta=[{'FieldTypeKind':0x2,'Title':a507_0x2cffb1(0x352)},{'FieldTypeKind':0x2,'Title':'DocumentType'},{'FieldTypeKind':0x2,'Title':a507_0x2cffb1(0x236)},{'FieldTypeKind':0x3,'Title':a507_0x2cffb1(0x339)},{'FieldTypeKind':0x3,'Title':'Titan_Permission'},{'FieldTypeKind':0x14,'Title':a507_0x2cffb1(0x2d2)},{'FieldTypeKind':0x2,'Title':a507_0x2cffb1(0x25d)},{'FieldTypeKind':0x9,'Title':a507_0x2cffb1(0x1b5)},{'FieldTypeKind':0x14,'Title':a507_0x2cffb1(0x1da)},{'FieldTypeKind':0x2,'Title':a507_0x2cffb1(0x257)},{'FieldTypeKind':0x2,'Title':a507_0x2cffb1(0x21f)},{'FieldTypeKind':0x2,'Title':a507_0x2cffb1(0x27b)},{'FieldTypeKind':0x2,'Title':a507_0x2cffb1(0x235)},{'FieldTypeKind':0x6,'Title':a507_0x2cffb1(0x284)},{'FieldTypeKind':0x2,'Title':a507_0x2cffb1(0x357)},{'FieldTypeKind':0x14,'Title':'ApprovedBy'},{'FieldTypeKind':0x4,'Title':a507_0x2cffb1(0x1c8)},{'FieldTypeKind':0x4,'Title':a507_0x2cffb1(0x321)},{'FieldTypeKind':0x4,'Title':'email_date'},{'FieldTypeKind':0x2,'Title':'ApprovedVersion'},{'FieldTypeKind':0x2,'Title':a507_0x2cffb1(0x2de)}];function GetAvailbleLicence(){var _0x4a6000=a507_0x2cffb1,_0x5a1738='',_0x4c2ee9='?$top=5000&$select=PrimaryCompany,Status&$filter=PrimaryCompany\x20eq\x20\x27Primary\x27\x20and\x20Status\x20eq\x20\x27Active\x27\x20';dfds=$[_0x4a6000(0x28e)](),extdfds=$[_0x4a6000(0x28e)]();var _0x264c06='',_0xf9614b,_0x33a004;return url=_spPageContextInfo[_0x4a6000(0x351)]+_0x4a6000(0x25c)+_0x4c2ee9,$[_0x4a6000(0x2fa)](getItems(url,dfds))[_0x4a6000(0x1e0)](function(_0x408857){var _0x2f2272=_0x4a6000;response=[],_0xf9614b=_0x408857['length'];var _0x370e61=_spPageContextInfo[_0x2f2272(0x351)]+_0x2f2272(0x1be);$[_0x2f2272(0x2fa)](getItems(_0x370e61,extdfds))['done'](function(_0x1a2b93){var _0xb3576f=_0x2f2272;response=[],_0x33a004=_0x1a2b93[_0xb3576f(0x1b4)];}),_0x264c06=parseInt(_0xf9614b)+parseInt(_0x33a004),_0x5a1738=parseInt(UsersLicenceRequired)-parseInt(_0x264c06);}),_0x5a1738;}var response=response||[];function getItems(_0x5e2cd1,_0x302e99){var _0x290ffd=a507_0x2cffb1;return $[_0x290ffd(0x1a5)]({'url':_0x5e2cd1,'type':_0x290ffd(0x277),'async':![],'headers':{'accept':_0x290ffd(0x1d7)},'success':function(_0x7810f9){var _0x4a168c=_0x290ffd;response=response['concat'](_0x7810f9['d']['results']),_0x7810f9['d'][_0x4a168c(0x201)]?(_0x5e2cd1=_0x7810f9['d']['__next'],getItems(_0x5e2cd1,_0x302e99)):_0x302e99['resolve'](response);},'error':function(_0x5be7cd){var _0x59d51d=_0x290ffd;_0x302e99[_0x59d51d(0x248)](_0x5be7cd),console['log'](_0x5be7cd);}}),_0x302e99[_0x290ffd(0x1c0)]();}