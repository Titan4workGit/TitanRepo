(function(_0x3d8e54,_0x333255){var _0x5c004d=a24_0x2d6e,_0x1fc5c9=_0x3d8e54();while(!![]){try{var _0x3998b1=-parseInt(_0x5c004d(0x108))/0x1+parseInt(_0x5c004d(0x12b))/0x2*(-parseInt(_0x5c004d(0x165))/0x3)+-parseInt(_0x5c004d(0x18b))/0x4+-parseInt(_0x5c004d(0x154))/0x5*(parseInt(_0x5c004d(0x139))/0x6)+-parseInt(_0x5c004d(0xe5))/0x7*(parseInt(_0x5c004d(0x18f))/0x8)+-parseInt(_0x5c004d(0x17b))/0x9*(-parseInt(_0x5c004d(0x14c))/0xa)+-parseInt(_0x5c004d(0x10c))/0xb*(-parseInt(_0x5c004d(0x17d))/0xc);if(_0x3998b1===_0x333255)break;else _0x1fc5c9['push'](_0x1fc5c9['shift']());}catch(_0x557af1){_0x1fc5c9['push'](_0x1fc5c9['shift']());}}}(a24_0x66ae,0x53b14));var token,peoplePickerDiv='',peoplePickerDivsuper='',GroupId='',email='',IsUpdate=![],userListItemId='',GuestUserEmail='',UserListId=[],Client_Id;function initializePeoplePicker(_0x3241e0,_0x5aec0a){var _0x206aed=a24_0x2d6e,_0x1e27a9={};_0x1e27a9[_0x206aed(0x1ac)]='User,DL,SecGroup,SPGroup',_0x1e27a9[_0x206aed(0xd5)]=0xf,_0x1e27a9[_0x206aed(0x12c)]=0xf,_0x1e27a9[_0x206aed(0x18d)]=_0x5aec0a,_0x1e27a9[_0x206aed(0x13f)]=0x32,_0x1e27a9[_0x206aed(0x167)]=_0x206aed(0x137),this[_0x206aed(0xcb)](_0x3241e0,null,_0x1e27a9),$('.sp-peoplepicker-editorInput')[_0x206aed(0xed)](0xfa);}$(function(){var _0x539d7d=a24_0x2d6e;$('#datepickerAD5')[_0x539d7d(0x161)]({'changeMonth':!![],'changeYear':!![]});});function GetGueastEmployee(_0x3c58b2){var _0x1e657e=a24_0x2d6e,_0x583fc5=_0x1e657e(0xd7)+_0x3c58b2+'\x27';return DeferredObj=$[_0x1e657e(0x11e)](),$[_0x1e657e(0x1b6)]({'method':_0x1e657e(0x103),'url':_0x583fc5,'headers':{'Authorization':_0x1e657e(0x131)+token,'Content-Type':_0x1e657e(0x18e)},'async':![],'success':function(_0x45cab3){var _0x26511e=_0x1e657e;DeferredObj[_0x26511e(0xc0)](_0x45cab3[_0x26511e(0xd1)]);},'error':function(_0x2147ef){var _0x7d8d9c=_0x1e657e;DeferredObj[_0x7d8d9c(0x166)](_0x2147ef),alert(_0x7d8d9c(0xef)+JSON[_0x7d8d9c(0xc3)](_0x2147ef));}}),DeferredObj[_0x1e657e(0xdb)]();}function GetGueastUsers(_0x153896){var _0x593b23=a24_0x2d6e,_0x55811f='https://graph.microsoft.com/v1.0/users?$select=id,displayName,userPrincipalName,otherMails,userType,identities,creationType,externalUserState\x20&$filter=mail\x20eq\x20\x27'+_0x153896+'\x27';return DeferredObj=$['Deferred'](),$[_0x593b23(0x1b6)]({'method':'GET','url':_0x55811f,'headers':{'Authorization':_0x593b23(0x131)+token,'Content-Type':'application/json'},'async':![],'success':function(_0x42400e){var _0x101c43=_0x593b23;DeferredObj[_0x101c43(0xc0)](_0x42400e[_0x101c43(0xd1)]);},'error':function(_0x4c247c){var _0x7b315=_0x593b23;DeferredObj[_0x7b315(0x166)](_0x4c247c),alert(_0x7b315(0xef)+JSON[_0x7b315(0xc3)](_0x4c247c));}}),DeferredObj[_0x593b23(0xdb)]();}function GetCategoryMaster(){var _0x13bfd4=a24_0x2d6e,_0x1603a6='CategoryMaster',_0x482f67=_spPageContextInfo[_0x13bfd4(0x14b)]+_0x13bfd4(0xc4)+_0x1603a6+_0x13bfd4(0x120);$[_0x13bfd4(0x1b6)]({'url':_0x482f67,'headers':{'Accept':_0x13bfd4(0x1b9)},'async':![],'success':function(_0x95a2e4){var _0x29220e=_0x13bfd4,_0x27bf15=document[_0x29220e(0x104)](_0x29220e(0xfa));_0x27bf15[_0x29220e(0x178)]='';for(var _0x18bed5=0x0;_0x18bed5<_0x95a2e4['d'][_0x29220e(0x1b7)][_0x29220e(0xac)];_0x18bed5++){var _0x1c8124=_0x95a2e4['d'][_0x29220e(0x1b7)][_0x18bed5][_0x29220e(0x187)],_0x20d598=_0x95a2e4['d'][_0x29220e(0x1b7)][_0x18bed5][_0x29220e(0x187)];opt=document[_0x29220e(0x182)](_0x29220e(0x100)),opt[_0x29220e(0xd1)]=_0x20d598,opt['text']=_0x1c8124,_0x27bf15[_0x29220e(0xb3)](opt);}},'error':function(_0x436b5a){var _0x523d2f=_0x13bfd4;console[_0x523d2f(0x19d)](_0x436b5a);}});}function GetUserId(_0x2b2c6f){var _0x2d83fb=a24_0x2d6e,_0x2790cc='',_0x251cca='i:0#.f|membership|',_0x2989e2=_spPageContextInfo['siteAbsoluteUrl'],_0x4a46df=_0x251cca+_0x2b2c6f;return $[_0x2d83fb(0x1b6)]({'url':_0x2989e2+_0x2d83fb(0x118)+encodeURIComponent(_0x4a46df)+'\x27','method':_0x2d83fb(0x103),'headers':{'Accept':_0x2d83fb(0x12a)},'async':![],'success':function(_0x4e7676){_0x2790cc=_0x4e7676['d']['Id'];},'error':function(_0x38b193){var _0x6a5377=_0x2d83fb;console['log'](JSON[_0x6a5377(0xc3)](_0x38b193));}}),_0x2790cc;}function GetUserName(_0x1a4904){var _0x114484=a24_0x2d6e,_0x3b2d96='',_0x35af5f=_0x114484(0x183),_0x298533=_spPageContextInfo[_0x114484(0xbe)],_0x524a0d=_0x35af5f+_0x1a4904;return $[_0x114484(0x1b6)]({'url':_0x298533+'/_api/web/siteusers(@v)?@v=\x27'+encodeURIComponent(_0x524a0d)+'\x27','method':_0x114484(0x103),'headers':{'Accept':_0x114484(0x12a)},'async':![],'success':function(_0xcd804c){var _0x238f09=_0x114484;_0x3b2d96=_0xcd804c['d'][_0x238f09(0x153)];},'error':function(_0x2cfa78){var _0x5c54c8=_0x114484;console[_0x5c54c8(0x19d)](JSON[_0x5c54c8(0xc3)](_0x2cfa78));}}),_0x3b2d96;}function AddNewGuest(){var _0x2c35ca=a24_0x2d6e;try{var _0x3e5992=_0x2c35ca(0x143),_0xe3691=SPClientPeoplePicker[_0x2c35ca(0x102)][peoplePickerDiv[0x0]['id']],_0x187f7=_0xe3691[_0x2c35ca(0x117)](),_0x295cc9=[];for(var _0x1f7eac=0x0;_0x1f7eac<_0x187f7['length'];_0x1f7eac++){var _0x591855=GetUserId(_0x187f7[_0x1f7eac]['EntityData'][_0x2c35ca(0xdf)]);_0x295cc9[_0x2c35ca(0x11b)](_0x591855),UserListId[_0x2c35ca(0x11b)](_0x591855);}_0xe3691=SPClientPeoplePicker[_0x2c35ca(0x102)][peoplePickerDivsuper[0x0]['id']],_0x187f7=_0xe3691[_0x2c35ca(0x117)]();var _0x23fed8=GetUserId(_0x187f7[0x0][_0x2c35ca(0xab)][_0x2c35ca(0xdf)]);UserListId['push'](_0x23fed8);GroupId==''&&GetGroupIDByGroupName();AddUserinSharePointGroup($(_0x2c35ca(0x10d))[_0x2c35ca(0x146)]());var _0x3faee3=GetUserId($(_0x2c35ca(0x10d))[_0x2c35ca(0x146)]());UserListId[_0x2c35ca(0x11b)](_0x3faee3);var _0x5a2c45=_spPageContextInfo[_0x2c35ca(0x14b)]+_0x2c35ca(0xe0)+$(_0x2c35ca(0xf2))['val']()['trim']()['replace'](/ /g,'')+_0x2c35ca(0x160),_0x53af95,_0x56aec5=GetItemTypeForListName(_0x3e5992);_0x53af95={'__metadata':{'type':_0x56aec5},'LoginNameId':_0x3faee3,'Title':$('#txtExtEmail')[_0x2c35ca(0x146)](),'email':$(_0x2c35ca(0x10d))[_0x2c35ca(0x146)](),'Designation':$(_0x2c35ca(0x110))[_0x2c35ca(0x146)](),'Organization':$(_0x2c35ca(0xf2))[_0x2c35ca(0x146)](),'ReferenceCode':$(_0x2c35ca(0xae))['val'](),'TemplateType':$(_0x2c35ca(0xe9),$(_0x2c35ca(0x14f)))[_0x2c35ca(0x146)](),'InternalStakeholdersId':{'results':_0x295cc9},'SupervisorId':_0x23fed8,'Client_NameId':Client_Id,'External_Supervisor':$(_0x2c35ca(0x112))['val'](),'ValidUpto':$('#datepickerAD5')[_0x2c35ca(0x146)](),'CollaborationType':$('option:selected',$(_0x2c35ca(0x19f)))[_0x2c35ca(0x146)](),'Status':$(_0x2c35ca(0xe9),$(_0x2c35ca(0x1a0)))['val'](),'DocumentLibrary':_0x5a2c45},AddItemToList(_0x3e5992,_0x53af95,UserListId);}catch(_0xd1d13d){console['log'](_0xd1d13d['message']);}}function cleartextBox(){var _0x483d2b=a24_0x2d6e;$(_0x483d2b(0x19b))[_0x483d2b(0x146)](''),$(_0x483d2b(0x10d))[_0x483d2b(0x146)](''),$(_0x483d2b(0x110))[_0x483d2b(0x146)](''),$('#txtReferenceCodeExt')[_0x483d2b(0x146)](''),$('#txtExtOrganizationName')[_0x483d2b(0x146)](''),$(_0x483d2b(0xb2))[_0x483d2b(0x150)](_0x483d2b(0x129),'https://cdn.jsdelivr.net/gh/Titan4workGit/TitanRepo@main/SiteAssets/AdminPortal/ManageEmployee/assets/images/user_pic.jpg'),initializePeoplePicker(_0x483d2b(0xee),!![]),peoplePickerDiv=$('[id$=\x27InternalStakeholders_TopSpan\x27]'),initializePeoplePicker(_0x483d2b(0xd4),![]),peoplePickerDivsuper=$(_0x483d2b(0x1b4));}function AddItemToList(_0x176c05,_0x3d8c3f,_0x4bbe8b){var _0x1eac70=a24_0x2d6e,_0x4030c7=$[_0x1eac70(0x11e)]();return $['ajax']({'url':_spPageContextInfo[_0x1eac70(0x14b)]+'/_api/web/lists/getbytitle(\x27'+_0x176c05+_0x1eac70(0xb6),'type':'POST','async':![],'headers':{'accept':_0x1eac70(0x1b9),'X-RequestDigest':$(_0x1eac70(0xbc))[_0x1eac70(0x146)](),'content-Type':_0x1eac70(0x1b9)},'data':JSON[_0x1eac70(0xc3)](_0x3d8c3f),'success':function(_0x23aa9b){var _0x3418b0=_0x1eac70;if(document[_0x3418b0(0x104)](_0x3418b0(0x17c))[_0x3418b0(0x158)]['length']===0x0){}else UploadAttachement(_0x23aa9b['d']['ID']);console[_0x3418b0(0x19d)](_0x23aa9b),IsExistOrNotLibrary($(_0x3418b0(0xf2))[_0x3418b0(0x146)]()[_0x3418b0(0x19a)]()['replace'](/ /g,''))?AssignTheEditRole($(_0x3418b0(0xf2))[_0x3418b0(0x146)]()[_0x3418b0(0x19a)]()[_0x3418b0(0xd8)](/ /g,''),_0x4bbe8b):(createNewLibraryByRest($('#txtAddOrganization')[_0x3418b0(0x146)]()[_0x3418b0(0x19a)]()[_0x3418b0(0xd8)](/ /g,'')),AssignTheEditRole($(_0x3418b0(0xf2))[_0x3418b0(0x146)]()['trim']()[_0x3418b0(0xd8)](/ /g,''),_0x4bbe8b)),alert(_0x3418b0(0x1a7)),cleartextBox();},'error':function(_0x113a14){var _0x20480a=_0x1eac70;console[_0x20480a(0x19d)](JSON[_0x20480a(0xc3)](_0x113a14)),_0x4030c7['reject'](_0x113a14);}}),_0x4030c7[_0x1eac70(0xdb)]();}function UpdateGeustuser(_0x45d4b2){var _0x5d97e2=a24_0x2d6e,_0xdb77a6=_0x5d97e2(0x143),_0x26b199=SPClientPeoplePicker['SPClientPeoplePickerDict'][peoplePickerDiv[0x0]['id']],_0x4bd81c=_0x26b199[_0x5d97e2(0x117)](),_0x557b95=[];for(var _0x30591b=0x0;_0x30591b<_0x4bd81c['length'];_0x30591b++){var _0x575b56=GetUserId(_0x4bd81c[_0x30591b][_0x5d97e2(0xab)][_0x5d97e2(0xdf)]);_0x557b95[_0x5d97e2(0x11b)](_0x575b56),UserListId[_0x5d97e2(0x11b)](_0x575b56);}_0x26b199=SPClientPeoplePicker[_0x5d97e2(0x102)][peoplePickerDivsuper[0x0]['id']],_0x4bd81c=_0x26b199[_0x5d97e2(0x117)]();var _0x322930=GetUserId(_0x4bd81c[0x0][_0x5d97e2(0xab)]['Email']);UserListId[_0x5d97e2(0x11b)](_0x322930);var _0x2becd7=GetUserId($(_0x5d97e2(0x10d))[_0x5d97e2(0x146)]());UserListId['push'](_0x2becd7),GuestUserEmail=$(_0x5d97e2(0x10d))[_0x5d97e2(0x146)]();var _0x2f458d=_spPageContextInfo[_0x5d97e2(0x14b)]+'/GuestUserDocuments/'+$(_0x5d97e2(0xf2))[_0x5d97e2(0x146)]()[_0x5d97e2(0x19a)]()[_0x5d97e2(0xd8)](/ /g,'')+_0x5d97e2(0x160);_0x2becd7==''&&(GetGroupIDByGroupName(),AddUserinSharePointGroup($('#txtExtEmail')[_0x5d97e2(0x146)]()));var _0x40a5e8,_0x15f72e=GetItemTypeForListName(_0xdb77a6);_0x40a5e8={'__metadata':{'type':_0x15f72e},'Designation':$(_0x5d97e2(0x110))[_0x5d97e2(0x146)](),'LoginNameId':_0x2becd7,'Organization':$(_0x5d97e2(0xf2))[_0x5d97e2(0x146)](),'ReferenceCode':$(_0x5d97e2(0xae))[_0x5d97e2(0x146)](),'TemplateType':$('option:selected',$('#TemplateType'))[_0x5d97e2(0x146)](),'InternalStakeholdersId':{'results':_0x557b95},'SupervisorId':_0x322930,'Client_NameId':Client_Id,'ValidUpto':$('#datepickerAD5')[_0x5d97e2(0x146)](),'CollaborationType':$(_0x5d97e2(0xe9),$(_0x5d97e2(0x19f)))[_0x5d97e2(0x146)](),'Status':$(_0x5d97e2(0xe9),$(_0x5d97e2(0x1a0)))['val'](),'DocumentLibrary':_0x2f458d};var _0x1dac58=$[_0x5d97e2(0x11e)]();return $['ajax']({'url':_spPageContextInfo[_0x5d97e2(0x14b)]+_0x5d97e2(0xc4)+_0xdb77a6+_0x5d97e2(0x164)+_0x45d4b2+')','type':_0x5d97e2(0x13e),'async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$('#__REQUESTDIGEST')[_0x5d97e2(0x146)](),'content-Type':_0x5d97e2(0x1b9),'IF-MATCH':'*','X-HTTP-Method':'MERGE'},'data':JSON[_0x5d97e2(0xc3)](_0x40a5e8),'success':function(_0x1302fa){var _0x5876a2=_0x5d97e2;if(document[_0x5876a2(0x104)](_0x5876a2(0x17c))[_0x5876a2(0x158)]['length']===0x0){}else UploadAttachement(_0x45d4b2);console[_0x5876a2(0x19d)](_0x1302fa),IsExistOrNotLibrary($(_0x5876a2(0xf2))['val']()[_0x5876a2(0x19a)]()[_0x5876a2(0xd8)](/ /g,''))?AssignTheEditRole($('#txtAddOrganization')['val']()[_0x5876a2(0x19a)]()[_0x5876a2(0xd8)](/ /g,''),UserListId):(createNewLibraryByRest($(_0x5876a2(0xf2))['val']()[_0x5876a2(0x19a)]()[_0x5876a2(0xd8)](/ /g,'')),AssignTheEditRole($(_0x5876a2(0xf2))[_0x5876a2(0x146)]()[_0x5876a2(0x19a)]()[_0x5876a2(0xd8)](/ /g,''),UserListId)),alert(_0x5876a2(0x136));},'error':function(_0x59f740){var _0x28d9fd=_0x5d97e2;console[_0x28d9fd(0x19d)](JSON[_0x28d9fd(0xc3)](_0x59f740)),_0x1dac58['reject'](_0x59f740);}}),_0x1dac58['promise']();}function GetItemToList(_0x416229){var _0x1a17b7=a24_0x2d6e,_0x56fbb0=_0x1a17b7(0x143),_0x9ca951=$[_0x1a17b7(0x11e)]();return $[_0x1a17b7(0x1b6)]({'url':_spPageContextInfo[_0x1a17b7(0x14b)]+_0x1a17b7(0x13b)+_0x56fbb0+_0x1a17b7(0x157)+_0x416229+'\x27','type':_0x1a17b7(0xe3),'async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x1a17b7(0xbc))[_0x1a17b7(0x146)](),'content-Type':_0x1a17b7(0x1b9)},'success':function(_0x1bbd88){var _0x3cfcb8=_0x1a17b7;_0x9ca951['resolve'](_0x1bbd88['d'][_0x3cfcb8(0x1b7)]),console[_0x3cfcb8(0x19d)](_0x1bbd88);},'error':function(_0x4621db){var _0x39ec55=_0x1a17b7;console[_0x39ec55(0x19d)](JSON[_0x39ec55(0xc3)](_0x4621db)),_0x9ca951[_0x39ec55(0x166)](_0x4621db);}}),_0x9ca951[_0x1a17b7(0xdb)]();}function GetItemToListchoice(){var _0x5110c2=a24_0x2d6e,_0x1ebb38=_0x5110c2(0x143),_0x24cd36=$[_0x5110c2(0x11e)]();return $[_0x5110c2(0x1b6)]({'url':_spPageContextInfo[_0x5110c2(0x14b)]+_0x5110c2(0x13b)+_0x1ebb38+'\x27)/fields?&$select=*&$filter=EntityPropertyName\x20eq\x20\x27TemplateType\x27','type':_0x5110c2(0xe3),'async':![],'headers':{'accept':_0x5110c2(0x1b9),'X-RequestDigest':$(_0x5110c2(0xbc))[_0x5110c2(0x146)](),'content-Type':_0x5110c2(0x1b9)},'success':function(_0x143a06){var _0x6594e2=_0x5110c2;_0x24cd36[_0x6594e2(0xc0)](_0x143a06['d']['results'][0x0][_0x6594e2(0x191)][_0x6594e2(0x1b7)]),console[_0x6594e2(0x19d)](_0x143a06);},'error':function(_0xa1da0a){var _0x167523=_0x5110c2;console[_0x167523(0x19d)](JSON[_0x167523(0xc3)](_0xa1da0a)),_0x24cd36[_0x167523(0x166)](_0xa1da0a);}}),_0x24cd36[_0x5110c2(0xdb)]();}function GetItemToClientMaster(){var _0x49dc26=a24_0x2d6e,_0x4b27ef=_0x49dc26(0xbb),_0x3ca416=$['Deferred']();return $[_0x49dc26(0x1b6)]({'url':_spPageContextInfo[_0x49dc26(0x14b)]+_0x49dc26(0x13b)+_0x4b27ef+_0x49dc26(0x16f),'type':'get','async':![],'headers':{'accept':_0x49dc26(0x1b9),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x49dc26(0x146)](),'content-Type':_0x49dc26(0x1b9)},'success':function(_0x5be9f9){var _0x3d601c=_0x49dc26;_0x3ca416[_0x3d601c(0xc0)](_0x5be9f9['d'][_0x3d601c(0x1b7)]),console['log'](_0x5be9f9);},'error':function(_0x7883cf){var _0x430fd7=_0x49dc26;console[_0x430fd7(0x19d)](JSON[_0x430fd7(0xc3)](_0x7883cf)),_0x3ca416[_0x430fd7(0x166)](_0x7883cf);}}),_0x3ca416[_0x49dc26(0xdb)]();}function requestToken(){var _0x17317d=a24_0x2d6e;$[_0x17317d(0x1b6)]({'async':!![],'crossDomain':!![],'url':ClientUrl,'method':_0x17317d(0x13e),'headers':{'content-type':'application/x-www-form-urlencoded'},'data':{'grant_type':_0x17317d(0xd9),'client_id\x20':ClientId,'client_secret':ClentSecret,'scope\x20':_0x17317d(0xce)},'success':function(_0x3d8bf3){var _0x4622eb=_0x17317d;console[_0x4622eb(0x19d)](_0x3d8bf3),token=_0x3d8bf3[_0x4622eb(0x113)];},'error':function(_0x54cfcd){var _0x41fe53=_0x17317d;console[_0x41fe53(0x19d)](JSON[_0x41fe53(0xc3)](_0x54cfcd));}});}function ClientCredentialss(){var _0x95197a=a24_0x2d6e,_0x5e99d2='EnvironmentalSettings',_0x17188f=_spPageContextInfo[_0x95197a(0x14b)]+'/_api/web/lists/GetByTitle(\x27'+_0x5e99d2+_0x95197a(0xf4);$[_0x95197a(0x1b6)]({'url':_0x17188f,'headers':{'Accept':_0x95197a(0x1b9)},'async':![],'success':function(_0x3bb790){var _0x445b32=_0x95197a,_0x2ec430=_0x3bb790['d']['results'];ClientId=_0x2ec430[0x0][_0x445b32(0x11c)],ClentSecret=_0x2ec430[0x0][_0x445b32(0x127)],ClientUrl=_0x2ec430[0x0][_0x445b32(0x147)],requestToken();},'error':function(_0x5ed297){var _0x43d3d4=_0x95197a;console[_0x43d3d4(0x19d)](_0x5ed297);}});}function GraphAccessTokenTogetUserDetails(){var _0x26c098=a24_0x2d6e,_0x521f16=new jQuery[(_0x26c098(0x11e))](),_0x4e87ae={'X-RequestDigest':$(_0x26c098(0xbc))[_0x26c098(0x146)](),'accept':_0x26c098(0xaf),'content-type':'application/json;odata=nometadata'},_0x256777={'resource':_0x26c098(0xca)};return $[_0x26c098(0x1b6)]({'url':_spPageContextInfo[_0x26c098(0x14b)]+_0x26c098(0x140),'headers':_0x4e87ae,'type':_0x26c098(0x13e),'data':JSON['stringify'](_0x256777),'success':function(_0x1d06d9){var _0x746d39=_0x26c098;token=_0x1d06d9['access_token'],token_=token,_0x521f16[_0x746d39(0xc0)](token);},'error':function(_0x244810,_0x36a0a5,_0x2a7797){var _0x5612aa=_0x26c098;console[_0x5612aa(0x19d)](_0x244810[_0x5612aa(0xf0)]),_0x521f16[_0x5612aa(0x166)](_0x244810[_0x5612aa(0xf0)]);}}),_0x521f16[_0x26c098(0xdb)]();}var Errorcount=0x1,Ischeckerror=![];function Inviteuser(){var _0xf5d0de=a24_0x2d6e,_0x41d4a0=$(_0xf5d0de(0x152))[_0xf5d0de(0x146)](),_0x2d23eb=$('#txtinvitename')[_0xf5d0de(0x146)](),_0x1c0ac2=$(_0xf5d0de(0x12f))[_0xf5d0de(0x146)]();Errorcount=0x1,$['ajax']({'url':_0xf5d0de(0x15f),'type':_0xf5d0de(0x13e),'headers':{'Authorization':_0xf5d0de(0x131)+token,'content-type':_0xf5d0de(0x18e)},'data':JSON[_0xf5d0de(0xc3)]({'invitedUserDisplayName':_0x2d23eb,'invitedUserEmailAddress':_0x41d4a0,'inviteRedirectUrl':_spPageContextInfo[_0xf5d0de(0x14b)]+_0xf5d0de(0xb5),'sendInvitationMessage':!![],'invitedUserMessageInfo':{'customizedMessageBody':_0x1c0ac2}}),'async':![],'success':function(_0x4d5589){var _0x391ff8=_0xf5d0de;console[_0x391ff8(0x19d)](_0x4d5589),$(_0x391ff8(0x152))[_0x391ff8(0x146)](''),$(_0x391ff8(0x144))['val'](''),$(_0x391ff8(0x12f))['val']('');GroupId==''&&GetGroupIDByGroupName();GuestUserEmail=_0x4d5589[_0x391ff8(0x1b8)];try{$[_0x391ff8(0x132)](AddUserinSharePointGroup(_0x4d5589[_0x391ff8(0x1b8)]))[_0x391ff8(0x10e)](function(_0x3afa8e){var _0x13716d=_0x391ff8;Ischeckerror=![],_0x3afa8e==_0x13716d(0x1a1)?alert(_0x13716d(0x1a8)):alert(_0x13716d(0xff));});}catch(_0x382383){alert(_0x391ff8(0xff));}},'error':function(_0xffc090){var _0x1a33eb=_0xf5d0de;_0xffc090[_0x1a33eb(0x111)]==_0x1a33eb(0xc2)?alert(_0xffc090['statusText']+_0x1a33eb(0x15a)):(alert('Please\x20enter\x20a\x20valid\x20email\x20address\x20of\x20the\x20guest\x20user,\x20who\x20is\x20outsider\x20of\x20this\x20organization.'),console['log'](JSON[_0x1a33eb(0xc3)](_0xffc090)));}}),Ischeckerror&&alert('Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.');}function setPeoplePickerUsersInfoCurrent(_0x4dc39e,_0x588f0d){var _0x29a666=a24_0x2d6e,_0x1543ac=$(_0x29a666(0xe7)+_0x4dc39e+'\x27]'),_0x51b934=SPClientPeoplePicker[_0x29a666(0x102)][_0x1543ac[0x0]['id']];_0x51b934[_0x29a666(0x176)](_0x588f0d,![]),_0x51b934[_0x29a666(0xdd)](![]);}function readURL(_0x25c2bc){var _0x476d30=a24_0x2d6e;if(_0x25c2bc[_0x476d30(0x158)]&&_0x25c2bc[_0x476d30(0x158)][0x0]){var _0x482507=new FileReader();_0x482507['onload']=function(_0x2628c1){var _0x5a0db6=_0x476d30;$(_0x5a0db6(0xb2))['attr']('src',_0x2628c1[_0x5a0db6(0x159)][_0x5a0db6(0x169)]);},_0x482507['readAsDataURL'](_0x25c2bc[_0x476d30(0x158)][0x0]);}}function UploadAttachement(_0x34b959){var _0x4afcbd=a24_0x2d6e;try{if(document[_0x4afcbd(0x104)](_0x4afcbd(0x17c))[_0x4afcbd(0x158)][_0x4afcbd(0xac)]===0x0){}else{var _0x4be1df=_0x34b959,_0x2df163=$(_0x4afcbd(0x168)),_0x1e6d28=_0x2df163[0x0][_0x4afcbd(0x158)][_0x4afcbd(0xac)],_0x3e6eb3=[],_0x292ae0=_0x2df163[0x0][_0x4afcbd(0x158)][0x0]['name'];_0x292ae0=_0x2df163[0x0][_0x4afcbd(0x158)][0x0][_0x4afcbd(0x156)][_0x4afcbd(0xd8)](/[^a-zA-Z0-9-. ]/g,''),_0x292ae0=_0x292ae0[_0x4afcbd(0xd8)](/\s/g,'');for(var _0x2f8c3e=0x0;_0x2f8c3e<_0x1e6d28;_0x2f8c3e++){_0x3e6eb3[_0x4afcbd(0x11b)](_0x2df163[0x0][_0x4afcbd(0x158)][_0x2f8c3e]);}uploadFileSP('ExternalUsers',_0x4be1df,_0x3e6eb3,_0x1e6d28,_0x292ae0);}}catch(_0xed7912){alert(_0x4afcbd(0x1aa));}}function getFileBuffer(_0x5e17fe){var _0x336fc0=a24_0x2d6e,_0x110c43=$['Deferred'](),_0x26e702=new FileReader();return _0x26e702[_0x336fc0(0x121)]=function(_0x151905){var _0x54b3d5=_0x336fc0;_0x110c43[_0x54b3d5(0xc0)](_0x151905[_0x54b3d5(0x159)][_0x54b3d5(0x169)]);},_0x26e702[_0x336fc0(0x16c)]=function(_0x1445e0){var _0xbef7dd=_0x336fc0;_0x110c43[_0xbef7dd(0x166)](_0x1445e0['target'][_0xbef7dd(0xda)]);},_0x26e702[_0x336fc0(0x128)](_0x5e17fe),_0x110c43['promise']();}function uploadFileSP(_0x520501,_0xe85779,_0xf5b9b7,_0x3918ca,_0x581ac0){var _0x2fbd3c=a24_0x2d6e,_0x1dd9a3=0x0,_0x16c97e=$['Deferred'](),_0xdb243a='',_0x311434=_0xf5b9b7[0x0],_0x526be2=getFileBuffer(_0x311434);return _0x526be2[_0x2fbd3c(0x10e)](function(_0x44f7b0,_0x15f1c2,_0x309253){var _0x508953=_0x2fbd3c,_0x3eed88=new Uint8Array(_0x44f7b0),_0x245424=new SP[(_0x508953(0x1ab))](),_0x5464c2=_spPageContextInfo['webAbsoluteUrl']+_0x508953(0xc5)+_0x520501+'\x27)/items('+_0xe85779+')/AttachmentFiles/add(FileName=\x27'+_0x581ac0+'\x27)',_0x2764cc=0x0;$[_0x508953(0x1b6)]({'url':_0x5464c2,'type':_0x508953(0x13e),'processData':![],'contentType':_0x508953(0x1b9),'data':_0x44f7b0,'headers':{'accept':_0x508953(0x1b9),'X-RequestDigest':$(_0x508953(0xbc))['val'](),'content-length':_0x44f7b0[_0x508953(0x14e)]},'success':function(_0x305ba1){var _0x3b3eb3=_0x508953;_0x1dd9a3++,_0xdb243a=_0x1dd9a3,_0xf5b9b7[_0x3b3eb3(0x192)]();if(_0xf5b9b7[_0x3b3eb3(0xac)]>0x0)uploadFileSP(_0x3b3eb3(0x143),_0xe85779,_0xf5b9b7,_0xf5b9b7['length']);else{}},'error':function(_0xfb4533){var _0x3423f5=_0x508953;alert(_0x3423f5(0xcd));}}),_0x16c97e[_0x508953(0xc0)](_0xdb243a);}),_0x526be2[_0x2fbd3c(0xc9)](function(_0x11025e){var _0x42cfd9=_0x2fbd3c;_0x16c97e[_0x42cfd9(0x166)](_0x11025e);}),_0x16c97e[_0x2fbd3c(0xdb)]();}function GetGroupIDByGroupName(){var _0xdc1506=a24_0x2d6e,_0x5428e8=_spPageContextInfo[_0xdc1506(0x14b)]+_0xdc1506(0xea);$[_0xdc1506(0x1b6)]({'url':_0x5428e8,'method':_0xdc1506(0x103),'async':![],'headers':{'Accept':_0xdc1506(0x12a)},'success':function(_0x1f98dd){GroupId=_0x1f98dd['d']['Id'];},'error':function(_0x220f3b){var _0x1bb91d=_0xdc1506;console[_0x1bb91d(0x19d)](_0x220f3b);}});}function AddUserToSiteGroup(_0x6ad549){var _0x1fbdb6=a24_0x2d6e;clientContext=new SP[(_0x1fbdb6(0x193))]();var _0x18875b=clientContext[_0x1fbdb6(0xe1)]()[_0x1fbdb6(0x1ba)]()[_0x1fbdb6(0x133)](_0x1fbdb6(0x189)),_0x587d68=_0x18875b['get_users']();_0x587d68[_0x1fbdb6(0x197)](_0x6ad549),clientContext[_0x1fbdb6(0x14d)](onsuccess,onfailed);}function onsuccess(){var _0x18f50f=a24_0x2d6e;console[_0x18f50f(0x19d)]('Success');}function a24_0x2d6e(_0x2588b3,_0x56bb2b){var _0x66aea6=a24_0x66ae();return a24_0x2d6e=function(_0x2d6e47,_0x2b1449){_0x2d6e47=_0x2d6e47-0xa7;var _0x6a9894=_0x66aea6[_0x2d6e47];return _0x6a9894;},a24_0x2d6e(_0x2588b3,_0x56bb2b);}function a24_0x66ae(){var _0x298dfe=['SPClientPeoplePickerDict','GET','getElementById','webServerRelativeUrl','#msgExtEmail','Message\x20has\x20been\x20sent.','364243XIbnTM','show','InternalSupervisor','Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.\x0a\x20Enter\x20valid\x20email\x20address\x20or\x20check\x20the\x20external\x20sharing\x20features\x20is\x20enabled.','11sIRCnl','#txtExtEmail','done','</tr>','#txtExtDesignation','statusText','#txtExternalSupervisor','access_token','</span></h3>','https://graph.microsoft.com/v1.0/me/sendMail','Attn_Name','GetAllUserInfo','/_api/web/siteusers(@v)?@v=\x27','InternalMembers','InternalStakeholders_TopSpan','push','ClientName','EMail','Deferred','<h3>Dear\x20<span\x20class=\x22user_name\x22>','\x27)/items?$filter=CategoryType\x20eq\x20\x27Guest\x20Type\x27\x20and\x20Status\x20eq\x20\x20\x27Yes\x27\x20','onload','/GuestUserDocuments/_api/web/lists/getbytitle(\x27','SP.Utilities.EmailProperties','removeClass','#Employee-box','#UpdateEmp-box-2','ChangeFileName','readAsArrayBuffer','src','application/json;\x20odata=verbose','24532fyZXCN','ResolvePrincipalSource','SP.User','Client_Code','#txtinvitemessage','\x20<p>','Bearer\x20','when','getByName','externalUserState','#datepickerAD5','Guest\x20user\x20has\x20Update\x20successfully!','251px','[name=UpdateEmp]','26472mjZvqv','</td>','/_api/web/lists/getbytitle(\x27','Not\x20Found','#InternalStakeholders','POST','MaximumEntitySuggestions','/_api/SP.OAuth.Token/Acquire','selected','#btnotherOrganizationSearch','ExternalUsers','#txtinvitename','The\x20new\x20cafeteria\x20is\x20open.','val','Description','empty','ReferenceCode','Customerdd','webAbsoluteUrl','771790eedcBE','executeQueryAsync','byteLength','#TemplateType','attr','AttachmentFiles','#txtinviteemail','Title','115hayOGl','This\x20user\x20is\x20not\x20invited\x20at.\x0a\x20Send\x20invitation\x20to\x20this\x20guest\x20user\x20first.','name','\x27)/items?$select=*,AttachmentFiles,Supervisor/Title,Supervisor/EMail,InternalStakeholders/Title,InternalStakeholders/EMail,LoginName/Title,Client_Name/Title,Client_Name/Id\x20&$expand=Supervisor,InternalStakeholders,AttachmentFiles,LoginName,Client_Name\x20&$filter=\x20email\x20eq\x20\x27','files','target',':\x20\x20Compact\x20Token\x20parsing\x20failed','split','Browsers\x20supported\x20by\x20this\x20portal\x20are\x20Chrome,\x20Microsoft\x20Edge,\x20Safari…..\x20(incase\x20you\x20want\x20to\x20specify\x20their\x20versions\x20as\x20well)','ValidUpto','/GuestUserDocuments/_api/Web/Lists/','https://graph.microsoft.com/v1.0/invitations','/Forms/AllItems.aspx','datepicker','.</p>','[id$=\x27InternalStakeholders_TopSpan\x27]','\x27)/items(','84EGkOnS','reject','Width','#GueastextinputFile','result','\x27)/breakroleinheritance(false)','?$select=*,Id,Supervisor/Title,Supervisor/EMail\x20,InternalMembers/EMail,InternalMembers/Title,InternalSupervisor/EMail,InternalSupervisor/Title\x20&$expand=Supervisor,InternalMembers,InternalSupervisor\x20','onerror','\x22\x20class=\x22getclientmaster\x22\x20onclick=\x22selectOnlyThis(this.id)\x22\x20\x20value=\x22','Client_Name','\x27)/items?$select=*','false','Designation','userEmail','formatDate','slow','/_api/SP.Utilities.Utility.SendEmail','AddUserKeys','d\x20M,\x20y','innerHTML','<option>','Error\x20in\x20sending\x20Email:\x20','63UgrUeR','GueastextinputFile','9699084VbvYrr','addClass','append','<span>','d-block','createElement','i:0#.f|membership|','SelfCompany','CollaborationType','Meet\x20for\x20lun\x20Indramani\x20Indra?','CatogeryName','indramani047@gmail.com','Contributors','From:\x20no-reply@sharepointonline.com','90052KOvtjK','<p>','AllowMultipleValues','application/json','1392208bsRyEa','#selectByUser\x20>\x20[value=','Choices','shift','ClientContext','<p>Click\x20on\x20<a\x20href=\x22https://adaptindia.sharepoint.com/sites/Titan_2_2_1_DEV/SitePages/GuestPortal.aspx\x22\x20target=\x22_blank\x22>\x20this-link\x20</a></p>','displayName','Organization','addUser','click','IsActive','trim','#txtExtLoginName','\x20This\x20is\x20auto\x20generated\x20e-mail,\x20please\x20do\x20not\x20respond\x20on\x20this\x20sender\x20e-mail.','log','Active','#selectByUser','#txtExtStatus','User\x20Added','text','true','</p>','#UpdateEmp-box-','</p>\x20\x20','Guest\x20user\x20has\x20registered\x20successfully!','Invitation\x20mail\x20has\x20been\x20sent\x20to\x20the\x20user.','d-none','Your\x20item\x20has\x20not\x20been\x20submitted\x20successfully!','Base64EncodedByteArray','PrincipalAccountType','#btnExtUpdate','/GuestUserDocuments/_api/web/lists/?$filter=Title\x20eq\x20\x27','.toHide','<p>Please\x20click\x20on\x20the\x20following\x20link\x20to\x20access\x20this\x20portal.\x20</p>','Failed','<td\x20class=\x22text-left\x22>',')/users','[id$=\x27internalsupervisor_TopSpan\x27]','<div\x20class=\x22checkbox\x20m-0\x22>','ajax','results','invitedUserEmailAddress','application/json;odata=verbose','get_siteGroups','#Customer-box','css','CustType','\x20\x20<tr\x20class=\x22text-center\x22>','EntityData','length','External_Supervisor','#txtReferenceCodeExt','application/json;odata=nometadata','PendingAcceptance','checked','#extrenalImage','appendChild','<img\x20src=\x22img/customer.png\x22\x20id=\x22logo\x22>','/SitePages/Thankyou.aspx','\x27)/items','change','display','.error','internalsupervisor_TopSpan','ClientMaster','#__REQUESTDIGEST','\x20portal\x20of\x20','siteAbsoluteUrl','#btnExtSubmit','resolve','Supervisor','Unauthorized','stringify','/_api/web/lists/GetByTitle(\x27','/_api/lists/GetByTitle(\x27','find','none','hide','fail','https://graph.microsoft.com','SPClientPeoplePicker_InitStandaloneControlWrapper','</span>','Idea\x20has\x20been\x20submitted\x20but\x20some\x20files\x20failed\x20to\x20upload.','https://graph.microsoft.com/.default','#internalsupervisor','div[id^=\x27InternalStakeholders\x27]','value','Invite\x20to\x20guest\x20Portal','send','internalsupervisor','SearchPrincipalSource','#masterClientgrid','https://graph.microsoft.com/v1.0/users?$filter=mail\x20eq\x20\x27','replace','client_credentials','error','promise','#ddlAssociation','SetEnabledState','getItemsWithQueryItem','Email','/GuestUserDocuments/','get_web','\x09<span>','get','Recognition\x20has\x20been\x20submitted\x20\x20!!','7IabwTe','.sp-peoplepicker-delImage','[id$=\x27','#txtExtOrganizationName','option:selected','/_api/web/sitegroups/getbyname(\x27Contributors\x27)?$select=id','ServerRelativeUrl','disabled','width','InternalStakeholders','error1','responseText','SP.List','#txtAddOrganization','#TemplateType\x20>\x20[value=','\x27)/items?$filter=Title\x20eq\x20\x27Client_Credentials\x27\x20','then','Sending\x20mail\x20with\x20attach','mail\x20sent\x20successfully','\x20Your\x20e-mail\x20configured\x20for\x20this\x20portal\x20is\x20<span\x20id=\x22user_id\x22>@info.gmail.com</span>\x20and\x20you’ll\x20be\x20able\x20to\x20login\x20using\x20your\x20existing\x20passport\x20for\x20this\x20e-mail\x20service.','.msg','selectByUser','Already\x20send\x20invitation\x20but\x20this\x20user\x20is\x20not\x20Accepted..','Guest','TemplateType','/_api/web/sitegroups(','Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.','option','https://cdn.jsdelivr.net/gh/Titan4workGit/TitanRepo@main/SiteAssets/Titan-External-Employee-Portal/images/user_pic.jpg'];a24_0x66ae=function(){return _0x298dfe;};return a24_0x66ae();}function onfailed(_0x3264ce,_0x48d2f9){var _0x71d423=a24_0x2d6e;console['log'](_0x71d423(0x1b1)+_0x48d2f9['get_message']()+'\x0a'+_0x48d2f9['get_stackTrace']());}function AddUserinSharePointGroup(_0x3082a9){var _0x12111c=a24_0x2d6e,_0x31ad2e=$[_0x12111c(0x11e)](),_0x81b4fc=_0x12111c(0x183),_0xca4ad0=_0x81b4fc+_0x3082a9,_0x276a54=_spPageContextInfo[_0x12111c(0x14b)]+'/_api/web/sitegroups/getbyname(\x27Contributors\x27)/users';$[_0x12111c(0x1b6)]({'url':_0x276a54,'type':_0x12111c(0x13e),'async':![],'data':JSON[_0x12111c(0xc3)]({'__metadata':{'type':_0x12111c(0x12d)},'LoginName':_0xca4ad0}),'headers':{'accept':_0x12111c(0x1b9),'content-type':_0x12111c(0x1b9),'X-RequestDigest':$(_0x12111c(0xbc))[_0x12111c(0x146)]()},'success':_0x967e19,'error':_0xd00786});function _0x967e19(_0x5b2487){var _0x56cbdc=_0x12111c;Ischeckerror=!![],_0x31ad2e[_0x56cbdc(0xc0)](_0x56cbdc(0x1a1)),Errorcount=0x1,console['log'](_0x56cbdc(0x1a1));}function _0xd00786(_0x3cefb8){var _0x588479=_0x12111c;console['log'](JSON[_0x588479(0xc3)](_0x3cefb8)),(_0x3cefb8[_0x588479(0x111)]==_0x588479(0x13c)||_0x3cefb8[_0x588479(0x111)]=='error')&&Errorcount==0xa?_0x3cefb8['statusText']=='error'?alert(_0x588479(0xff)):alert(_0x588479(0x10b)):(Errorcount++,AddUserinSharePointGroup(GuestUserEmail));}return _0x31ad2e[_0x12111c(0xdb)]();}function AddUserinSharePointGroupforEdit(_0x5dd789){var _0x1c4df8=a24_0x2d6e,_0x416fb4='',_0x1d0574=_0x1c4df8(0x183),_0x134732=_0x1d0574+_0x5dd789,_0x1fa874=_spPageContextInfo[_0x1c4df8(0x14b)]+_0x1c4df8(0xfe)+GroupId+_0x1c4df8(0x1b3);$['ajax']({'url':_0x1fa874,'type':'POST','async':![],'data':JSON['stringify']({'__metadata':{'type':_0x1c4df8(0x12d)},'LoginName':_0x134732}),'headers':{'accept':_0x1c4df8(0x1b9),'content-type':_0x1c4df8(0x1b9),'X-RequestDigest':$(_0x1c4df8(0xbc))[_0x1c4df8(0x146)]()},'success':_0x3d06fd,'error':_0x4603e0});function _0x3d06fd(_0xaf62be){var _0x5c6609=_0x1c4df8;_0x416fb4=_0xaf62be['d'],console['log'](_0x5c6609(0x1a1));}function _0x4603e0(_0x1a4821){var _0x5c257c=_0x1c4df8;console['log'](JSON[_0x5c257c(0xc3)](_0x1a4821));}return _0x416fb4;}function processSendEmails(_0x528758,_0x429b16,_0x122e01){var _0x4977ae=a24_0x2d6e,_0x1b5180=[],_0x7d82=_0x4977ae(0xb4)+_0x4977ae(0x11f)+_0x528758+_0x4977ae(0x114)+'<p>Welcome\x20to\x20the\x20'+_0x429b16+_0x4977ae(0xbd)+_0x122e01+_0x4977ae(0x162)+_0x4977ae(0x1b0)+_0x4977ae(0x194)+_0x4977ae(0x18c)+_0x4977ae(0xf8)+_0x4977ae(0x15c)+_0x4977ae(0x1a6)+_0x4977ae(0x130)+'Incase\x20of\x20any\x20help\x20needed\x20or\x20if\x20you\x20are\x20facing\x20any\x20problem\x20in\x20accessing\x20this\x20portal,\x20please\x20send\x20an\x20e-mail\x20to\x20<\x20e-mail\x20ID\x20of\x20\x20admin\x20(s)\x20>'+_0x4977ae(0x19c)+_0x4977ae(0x1a4),_0x16cbb5=_0x4977ae(0xd2);_0x1b5180[_0x4977ae(0x11b)](email);var _0x3450e5=_spPageContextInfo[_0x4977ae(0x172)],_0x3a1835;_0x3a1835={'properties':{'__metadata':{'type':_0x4977ae(0x123)},'From':_0x3450e5,'To':{'results':_0x1b5180},'Body':_0x7d82,'Subject':_0x16cbb5}};var _0x4b943b={'properties':{'__metadata':{'type':_0x4977ae(0x123)},'From':_0x4977ae(0x18a),'To':{'results':_0x1b5180},'Body':_0x7d82,'Subject':_0x16cbb5}},_0x890633=_spPageContextInfo[_0x4977ae(0x105)]==='/'?'/':_spPageContextInfo['webServerRelativeUrl'],_0x4eedbc=_0x890633,_0x399ecd=_0x4eedbc+_0x4977ae(0x175),_0x1adf48=_spPageContextInfo[_0x4977ae(0x14b)]+_0x4977ae(0x175);$[_0x4977ae(0x1b6)]({'contentType':_0x4977ae(0x18e),'url':_0x1adf48,'type':_0x4977ae(0x13e),'data':JSON[_0x4977ae(0xc3)](_0x4b943b),'async':![],'headers':{'Accept':_0x4977ae(0x1b9),'content-type':'application/json;odata=verbose','X-RequestDigest':$('#__REQUESTDIGEST')[_0x4977ae(0x146)]()},'success':function(_0x881732){var _0x24fef4=_0x4977ae;console[_0x24fef4(0x19d)](_0x24fef4(0x107));},'error':function(_0x4ee3a3){var _0xbcc441=_0x4977ae;console[_0xbcc441(0x19d)]('SendEmailSharedNotification\x20\x20'+JSON[_0xbcc441(0xc3)](_0x4ee3a3));}});}function sendEmail(_0xa51d55,_0x27b3f5,_0x2a5581,_0x321c23){var _0x1c6cc4=a24_0x2d6e;Email[_0x1c6cc4(0xd3)]({'SecureToken':token,'To':_0x27b3f5[0x0],'From':_0xa51d55,'Subject':_0x321c23,'Body':_0x2a5581})[_0x1c6cc4(0xf5)](_0xeb7745=>alert(_0x1c6cc4(0xf7)));var _0x4fa275=_spPageContextInfo[_0x1c6cc4(0x105)],_0x404d34=_0x4fa275+_0x1c6cc4(0x175);$[_0x1c6cc4(0x1b6)]({'contentType':_0x1c6cc4(0x18e),'url':_0x404d34,'type':_0x1c6cc4(0x13e),'data':JSON['stringify']({'properties':{'__metadata':{'type':_0x1c6cc4(0x123)},'From':_0xa51d55,'To':{'results':_0x27b3f5},'Body':_0x2a5581,'Subject':_0x321c23}}),'headers':{'Accept':_0x1c6cc4(0x1b9),'content-type':_0x1c6cc4(0x1b9),'X-RequestDigest':jQuery(_0x1c6cc4(0xbc))[_0x1c6cc4(0x146)]()},'success':function(_0x5cbe0a){alert('Email\x20Sent\x20Successfully');},'error':function(_0x5126c7){var _0x477f7b=_0x1c6cc4;alert(_0x477f7b(0x17a)+JSON[_0x477f7b(0xc3)](_0x5126c7));}});}$(function(){var _0x309930=a24_0x2d6e;$(_0x309930(0x138))['click'](function(){var _0x507621=_0x309930;$(_0x507621(0x1af))[_0x507621(0xc8)](),cleartextBox(),$(_0x507621(0x1a5)+$(this)[_0x507621(0x146)]())['show'](_0x507621(0x174)),$(this)[_0x507621(0x146)]()=='3'&&(GetCategoryMaster(),$[_0x507621(0x132)](GetItemToListchoice())[_0x507621(0x10e)](function(_0x5c3969){var _0x50e466=_0x507621;$(_0x50e466(0x14f))[_0x50e466(0x148)]();for(var _0x9597c5=0x0;_0x9597c5<_0x5c3969['length'];_0x9597c5++){var _0x3fbc0b=$(_0x50e466(0x179));_0x3fbc0b[_0x50e466(0x150)](_0x50e466(0xd1),_0x5c3969[_0x9597c5])[_0x50e466(0x1a2)](_0x5c3969[_0x9597c5]),$(_0x50e466(0x14f))[_0x50e466(0x17f)](_0x3fbc0b);}})),$(_0x507621(0x106))[_0x507621(0xc8)]();});});function sendEmailg(){var _0x2472fb=a24_0x2d6e;$[_0x2472fb(0x1b6)]({'async':![],'crossDomain':!![],'url':_0x2472fb(0x115),'method':_0x2472fb(0x13e),'headers':{'authorization':'Bearer\x20'+token_,'content-type':_0x2472fb(0x18e)},'data':JSON[_0x2472fb(0xc3)]({'message':{'subject':_0x2472fb(0x186),'body':{'contentType':'Text','content':_0x2472fb(0x145)},'toRecipients':[{'emailAddress':{'address':_0x2472fb(0x188)}}]}}),'success':function(_0x29d378){var _0x3b0cc7=_0x2472fb;alert(_0x3b0cc7(0xe4));},'error':function(_0x351165){var _0x186c89=_0x2472fb;console[_0x186c89(0x19d)](_0x186c89(0xf6)+JSON[_0x186c89(0xc3)](_0x351165));}});}function createNewLibraryByRest(_0x2fc7a1){var _0x1dfa16=a24_0x2d6e,_0xb18151=_0x2fc7a1,_0x28bdf2=_spPageContextInfo['webAbsoluteUrl']+_0x1dfa16(0x15e);$[_0x1dfa16(0x1b6)]({'url':_0x28bdf2,'method':'POST','async':![],'data':JSON['stringify']({'__metadata':{'type':_0x1dfa16(0xf1)},'AllowContentTypes':!![],'BaseTemplate':0x65,'ContentTypesEnabled':!![],'Description':_0x1dfa16(0x147),'OnQuickLaunch':!![],'Title':_0x2fc7a1}),'headers':{'content-type':_0x1dfa16(0x1b9),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x1dfa16(0x146)]()},'success':function(_0x10801c){BreakRoleInheritance(_0xb18151);},'error':function(_0x570632){var _0x26a8cd=_0x1dfa16;alert(_0x570632[_0x26a8cd(0xf0)]);}});}function BreakRoleInheritance(_0x5c7c34){var _0x4104e6=a24_0x2d6e;url=_spPageContextInfo[_0x4104e6(0x14b)]+_0x4104e6(0x122)+_0x5c7c34+_0x4104e6(0x16a),$[_0x4104e6(0x1b6)]({'url':url,'type':_0x4104e6(0x13e),'async':![],'headers':{'accept':_0x4104e6(0xaf),'X-RequestDigest':$('#__REQUESTDIGEST')['val']()},'success':function(_0x2c9d6f){var _0x268182=_0x4104e6;console[_0x268182(0x19d)](_0x2c9d6f);},'error':function(_0xc6350a){console['log'](_0xc6350a);}});}function AssignTheEditRole(_0xcc3114,_0x597e64){var _0x5ddfd5=a24_0x2d6e;for(var _0x57f0c8=0x0;_0x57f0c8<_0x597e64[_0x5ddfd5(0xac)];_0x57f0c8++){url=_spPageContextInfo[_0x5ddfd5(0x14b)]+_0x5ddfd5(0x122)+_0xcc3114+'\x27)/roleassignments/addroleassignment(principalid=\x27'+_0x597e64[_0x57f0c8]+'\x27,roledefid=\x271073741830\x27)',$[_0x5ddfd5(0x1b6)]({'url':url,'type':_0x5ddfd5(0x13e),'async':![],'headers':{'accept':_0x5ddfd5(0xaf),'X-RequestDigest':$(_0x5ddfd5(0xbc))[_0x5ddfd5(0x146)]()},'success':function(_0x3b3910){console['log'](_0x3b3910);},'error':function(_0x377cac){var _0x500c49=_0x5ddfd5;console[_0x500c49(0x19d)](_0x377cac);}});}}function IsExistOrNotLibrary(_0x4d0b4b){var _0x316648=a24_0x2d6e,_0x185477='';return url=_spPageContextInfo['webAbsoluteUrl']+_0x316648(0x1ae)+_0x4d0b4b+'\x27',$[_0x316648(0x1b6)]({'url':url,'type':'get','async':![],'headers':{'accept':_0x316648(0xaf),'X-RequestDigest':$(_0x316648(0xbc))[_0x316648(0x146)]()},'success':function(_0x4d2687){var _0x47d153=_0x316648;_0x4d2687[_0x47d153(0xd1)][_0x47d153(0xac)]>0x0?_0x185477=!![]:_0x185477=![],console[_0x47d153(0x19d)](_0x4d2687);},'error':function(_0x1d43ec){console['log'](_0x1d43ec);}}),_0x185477;}var SelectClientId='';function GenarateclientGrid(_0x24f482){var _0x47663b=a24_0x2d6e;$(_0x47663b(0xd6))['empty'](),$(_0x47663b(0xd6))[_0x47663b(0x17f)](_0x24f482);}function Selectedcclinte(){var _0x5cef93=a24_0x2d6e;$('#txtAddOrganization')[_0x5cef93(0x146)](ClientInternalMembers[SelectClientId][_0x5cef93(0x153)]),Client_Id=ClientInternalMembers[SelectClientId]['ID'];ClientInternalMembers[SelectClientId][_0x5cef93(0xc1)]!=undefined?$(_0x5cef93(0x112))['val'](ClientInternalMembers[SelectClientId][_0x5cef93(0xc1)]):$(_0x5cef93(0x112))['val']($(_0x5cef93(0x10d))['val']());$(_0x5cef93(0x190)+ClientInternalMembers[SelectClientId][_0x5cef93(0xa9)]+']')[_0x5cef93(0x150)]('selected',_0x5cef93(0x1a3)),$('#TemplateType\x20>\x20[value='+ClientInternalMembers[SelectClientId]['TemplateType']+']')['attr'](_0x5cef93(0x141),_0x5cef93(0x1a3)),initializePeoplePicker('InternalStakeholders',!![]),peoplePickerDiv=$(_0x5cef93(0x163)),initializePeoplePicker(_0x5cef93(0xd4),![]),peoplePickerDivsuper=$(_0x5cef93(0x1b4));for(var _0x5803c1=0x0;_0x5803c1<ClientInternalMembers[SelectClientId][_0x5cef93(0x119)][_0x5cef93(0x1b7)][_0x5cef93(0xac)];_0x5803c1++){setPeoplePickerUsersInfoCurrent('InternalStakeholders_TopSpan',ClientInternalMembers[SelectClientId]['InternalMembers']['results'][_0x5803c1][_0x5cef93(0x11d)]);}setPeoplePickerUsersInfoCurrent(_0x5cef93(0xba),ClientInternalMembers[SelectClientId]['InternalSupervisor'][_0x5cef93(0x11d)]),$(_0x5cef93(0xd0))['attr']('contentEditable',_0x5cef93(0x170)),$(_0x5cef93(0x13d))[_0x5cef93(0x150)](_0x5cef93(0xec),'disabled'),$(_0x5cef93(0xcf))[_0x5cef93(0x150)](_0x5cef93(0xec),_0x5cef93(0xec)),$(peoplePickerDiv)['find']('.sp-peoplepicker-delImage')['css']('display',_0x5cef93(0xc7)),$(peoplePickerDivsuper)[_0x5cef93(0xc6)]('.sp-peoplepicker-delImage')['css'](_0x5cef93(0xb8),_0x5cef93(0xc7));}var ClientInternalMembers=[];function GetClientMasterTeamDeails(){var _0x58959c=a24_0x2d6e;Taskusers=[],RestQuery=_0x58959c(0x16b),$[_0x58959c(0x132)](CommonFunction[_0x58959c(0xde)]('ClientMaster',RestQuery))[_0x58959c(0x10e)](function(_0x4cd070){var _0x2d7408=_0x58959c,_0x4b684e;IsNotTeamMember='';debugger;var _0xea4e44='';for(var _0x5cfcb9=0x0;_0x5cfcb9<_0x4cd070['results'][_0x2d7408(0xac)];_0x5cfcb9++){_0x4b684e=[],_0x4b684e=_0x4cd070[_0x2d7408(0x1b7)][_0x5cfcb9];var _0x14ebaf=_0x4b684e[_0x2d7408(0x199)]='true'?_0x4b684e[_0x2d7408(0x199)]:_0x2d7408(0x19e);_0xea4e44+=_0x2d7408(0xaa)+_0x2d7408(0x1b2)+_0x2d7408(0x1b5)+'<label><input\x20type=\x22checkbox\x22\x20id=\x22Check_'+_0x5cfcb9+_0x2d7408(0x16d)+_0x5cfcb9+'\x22></label>'+'</div>'+'</td>'+_0x2d7408(0x1b2)+'<span>'+_0x4b684e[_0x2d7408(0x12e)]+'</span>'+_0x2d7408(0x13a)+'<td\x20class=\x22text-left\x22>'+_0x2d7408(0x180)+_0x4b684e[_0x2d7408(0x153)]+_0x2d7408(0xcc)+_0x2d7408(0x13a)+_0x2d7408(0x1b2)+_0x2d7408(0xe2)+_0x4b684e[_0x2d7408(0x116)]+_0x2d7408(0xcc)+_0x2d7408(0x13a)+_0x2d7408(0x1b2)+_0x2d7408(0x180)+_0x14ebaf+_0x2d7408(0xcc)+'</td>'+_0x2d7408(0x10f),ClientInternalMembers[_0x2d7408(0x11b)]({'Title':_0x4b684e[_0x2d7408(0x153)],'Client_Code':_0x4b684e[_0x2d7408(0x12e)],'Attn_Name':_0x4b684e[_0x2d7408(0x116)],'Supervisor':_0x4b684e[_0x2d7408(0xc1)][_0x2d7408(0x11d)],'SelfCompany':_0x4b684e[_0x2d7408(0x184)],'IsActive':_0x4b684e[_0x2d7408(0x199)],'CustType':_0x4b684e['CustType'],'TemplateType':_0x4b684e[_0x2d7408(0xfd)],'InternalMembers':_0x4b684e[_0x2d7408(0x119)],'InternalSupervisor':_0x4b684e[_0x2d7408(0x10a)],'ID':_0x4b684e['Id']});}GenarateclientGrid(_0xea4e44);});}function selectOnlyThis(_0x3139f2){var _0x2f262d=a24_0x2d6e;SelectClientId='',SelectClientId=_0x3139f2[_0x2f262d(0x15b)]('_')[0x1],$('input:checkbox')['not'](this)['prop'](_0x2f262d(0xb1),![]),document['getElementById'](_0x3139f2)[_0x2f262d(0xb1)]=!![];}$(document)['ready'](function(){var _0x4be236=a24_0x2d6e;$(_0x4be236(0x19f))['on'](_0x4be236(0xb7),function(){var _0x220173=_0x4be236,_0x4e7638=$(this)['find'](_0x220173(0xe9))[_0x220173(0x146)]();if(_0x4e7638==_0x220173(0x14a))$('#Customer-box')['removeClass'](_0x220173(0x181)),$(_0x220173(0xa7))[_0x220173(0x17e)](_0x220173(0x1a9)),$('#Employee-box')['removeClass'](_0x220173(0x1a9)),$('#Employee-box')[_0x220173(0x17e)](_0x220173(0x181));else _0x4e7638==_0x220173(0xfc)&&($('#Customer-box')['removeClass'](_0x220173(0x1a9)),$(_0x220173(0xa7))[_0x220173(0x17e)](_0x220173(0x181)),$(_0x220173(0x125))[_0x220173(0x124)](_0x220173(0x181)),$(_0x220173(0x125))[_0x220173(0x17e)](_0x220173(0x1a9)));}),$(_0x4be236(0x10d))['focusout'](function(){var _0x1e3892=_0x4be236;email=$('#txtExtEmail')['val']();var _0x161a37=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/igm;if(_0x161a37['test'](email)){$(_0x1e3892(0xf9))[_0x1e3892(0xc8)](),$(_0x1e3892(0x106))[_0x1e3892(0xc8)](),$['when'](GetItemToListchoice(),GetItemToList(email))['done'](function(_0x2a463c,_0x5a0641){var _0x275546=_0x1e3892;if(_0x5a0641[_0x275546(0xac)]>0x0){var _0x2a20df=GetUserName($(_0x275546(0x10d))[_0x275546(0x146)]());_0x2a20df==''&&(GroupId==''&&GetGroupIDByGroupName(),$[_0x275546(0x132)](AddUserinSharePointGroupforEdit($(_0x275546(0x10d))[_0x275546(0x146)]()))[_0x275546(0x10e)](function(_0x3e8244){var _0x34f375=_0x275546;if(_0x3e8244==''){cleartextBox(),$('.toHide')[_0x34f375(0xc8)](),$(_0x34f375(0x126))['show'](_0x34f375(0x174));var _0x5a2d17=0x2;return $('input[name=UpdateEmp][value='+_0x5a2d17+']')['prop'](_0x34f375(0xb1),!![]),alert(_0x34f375(0x155)),![];}else _0x2a20df=_0x3e8244[_0x34f375(0x153)];}));if(_0x5a0641[0x0][_0x275546(0x151)][_0x275546(0x1b7)][_0x275546(0xac)]>0x0){var _0x46d553=_0x5a0641[0x0]['AttachmentFiles'][_0x275546(0x1b7)][0x0][_0x275546(0xeb)];$(_0x275546(0xb2))['attr'](_0x275546(0x129),_0x46d553);}else $(_0x275546(0xb2))[_0x275546(0x150)]('src',_0x275546(0x101));IsUpdate=!![],userListItemId=_0x5a0641[0x0]['Id'],initializePeoplePicker(_0x275546(0xee),!![]),peoplePickerDiv=$(_0x275546(0x163)),initializePeoplePicker(_0x275546(0xd4),![]),peoplePickerDivsuper=$(_0x275546(0x1b4));for(var _0x158221=0x0;_0x158221<_0x5a0641[0x0]['InternalStakeholders'][_0x275546(0x1b7)][_0x275546(0xac)];_0x158221++){setPeoplePickerUsersInfoCurrent(_0x275546(0x11a),_0x5a0641[0x0][_0x275546(0xee)][_0x275546(0x1b7)][_0x158221][_0x275546(0x11d)]);}setPeoplePickerUsersInfoCurrent(_0x275546(0xba),_0x5a0641[0x0][_0x275546(0xc1)][_0x275546(0x11d)]),$(_0x275546(0x13d))[_0x275546(0x150)](_0x275546(0xec),_0x275546(0xec)),$(_0x275546(0xcf))[_0x275546(0x150)]('disabled','disabled'),$(peoplePickerDiv)['find'](_0x275546(0xe6))[_0x275546(0xa8)](_0x275546(0xb8),_0x275546(0xc7)),$(peoplePickerDivsuper)[_0x275546(0xc6)](_0x275546(0xe6))[_0x275546(0xa8)](_0x275546(0xb8),'none'),$('#btnExtUpdate')[_0x275546(0x109)](),$(_0x275546(0x14f))[_0x275546(0x148)]();for(var _0x158221=0x0;_0x158221<_0x2a463c['length'];_0x158221++){var _0x68b130=$(_0x275546(0x179));_0x68b130['attr'](_0x275546(0xd1),_0x2a463c[_0x158221])[_0x275546(0x1a2)](_0x2a463c[_0x158221]),$(_0x275546(0x14f))[_0x275546(0x17f)](_0x68b130);}$('#txtExtLoginName')[_0x275546(0x146)](_0x2a20df),$(_0x275546(0x110))[_0x275546(0x146)](_0x5a0641[0x0][_0x275546(0x171)]),$(_0x275546(0x112))[_0x275546(0x146)](_0x5a0641[0x0][_0x275546(0xad)]),$(_0x275546(0xdc))[_0x275546(0x146)](_0x5a0641[0x0]['Association']),$(_0x275546(0xe8))['val'](_0x5a0641[0x0][_0x275546(0x196)]),$(_0x275546(0xf2))['val'](_0x5a0641[0x0][_0x275546(0x16e)][_0x275546(0x153)]),Client_Id=_0x5a0641[0x0][_0x275546(0x16e)]['Id'],$(_0x275546(0xae))['val'](_0x5a0641[0x0][_0x275546(0x149)]),$(_0x275546(0xf3)+_0x5a0641[0x0]['TemplateType']+']')[_0x275546(0x150)](_0x275546(0x141),_0x275546(0x1a3)),$('#datepickerAD5')[_0x275546(0x146)]($['datepicker']['formatDate'](_0x275546(0x177),new Date(_0x5a0641[0x0][_0x275546(0x15d)]))),$('#selectByUser\x20>\x20[value='+_0x5a0641[0x0][_0x275546(0x185)]+']')[_0x275546(0x150)](_0x275546(0x141),'true'),$(_0x275546(0xbf))[_0x275546(0xc8)]();}else IsUpdate=![],$(_0x275546(0x19b))[_0x275546(0x146)](''),$(_0x275546(0x110))[_0x275546(0x146)](''),$(_0x275546(0xe8))[_0x275546(0x146)](''),$('#txtReferenceCodeExt')[_0x275546(0x146)](''),$(_0x275546(0xe9),$(_0x275546(0x14f)))['val'](''),$(_0x275546(0x135))['val']($['datepicker'][_0x275546(0x173)](_0x275546(0x177),new Date())),$(_0x275546(0xe9),$('#selectByUser'))[_0x275546(0x146)](),$(_0x275546(0xe9),$(_0x275546(0x1a0)))[_0x275546(0x146)](),$(_0x275546(0x1ad))[_0x275546(0xc8)](),$(_0x275546(0xb2))[_0x275546(0x150)](_0x275546(0x129),_0x275546(0x101)),$(_0x275546(0x168))[_0x275546(0x150)](_0x275546(0x129),'https://cdn.jsdelivr.net/gh/Titan4workGit/TitanRepo@main/SiteAssets/Titan-External-Employee-Portal/images/user_pic.jpg'),initializePeoplePicker(_0x275546(0xee),!![]),peoplePickerDiv=$(_0x275546(0x163)),initializePeoplePicker(_0x275546(0xd4),![]),peoplePickerDivsuper=$(_0x275546(0x1b4));});if(!IsUpdate)$[_0x1e3892(0x132)](GetGueastUsers(email))['done'](function(_0x3a9402){var _0x2b1288=_0x1e3892;_0x3a9402[_0x2b1288(0xac)]>0x0?(_0x3a9402[0x0][_0x2b1288(0x134)]=='Accepted'&&($(_0x2b1288(0xbf))[_0x2b1288(0x109)](),$(_0x2b1288(0x106))[_0x2b1288(0xc8)](),$(_0x2b1288(0x19b))[_0x2b1288(0x146)](_0x3a9402[0x0][_0x2b1288(0x195)])),_0x3a9402[0x0][_0x2b1288(0x134)]==_0x2b1288(0xb0)&&($(_0x2b1288(0x106))[_0x2b1288(0x1a2)](_0x2b1288(0xfb)),$('#msgExtEmail')[_0x2b1288(0x109)](),$('#btnExtSubmit')[_0x2b1288(0xc8)]())):($(_0x2b1288(0x106))['text']('Send\x20invitation\x20to\x20this\x20guest\x20user\x20first.'),$(_0x2b1288(0x106))['show'](),$('#btnExtSubmit')[_0x2b1288(0xc8)]());});else{}}else $(_0x1e3892(0xf9))['hide'](),$(_0x1e3892(0xb9))[_0x1e3892(0x109)](),$(_0x1e3892(0x106))[_0x1e3892(0xc8)](),$(_0x1e3892(0xbf))[_0x1e3892(0xc8)]();}),$(_0x4be236(0xbf))['click'](function(){AddNewGuest();}),$(_0x4be236(0x1ad))[_0x4be236(0x198)](function(){UpdateGeustuser(userListItemId);}),$(_0x4be236(0x168))['change'](function(){readURL(this);}),$(_0x4be236(0x142))['click'](function(){try{}catch(_0x3475d6){alert(_0x3475d6);}});});