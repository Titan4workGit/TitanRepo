(function(_0x4071d7,_0x1bdf68){var _0x3b4829=a24_0x489d,_0x2c1ee3=_0x4071d7();while(!![]){try{var _0x4950e5=parseInt(_0x3b4829(0x254))/0x1*(parseInt(_0x3b4829(0x204))/0x2)+parseInt(_0x3b4829(0x26f))/0x3*(-parseInt(_0x3b4829(0x1c3))/0x4)+parseInt(_0x3b4829(0x28e))/0x5+parseInt(_0x3b4829(0x26d))/0x6+-parseInt(_0x3b4829(0x25c))/0x7*(-parseInt(_0x3b4829(0x19b))/0x8)+-parseInt(_0x3b4829(0x213))/0x9*(-parseInt(_0x3b4829(0x252))/0xa)+-parseInt(_0x3b4829(0x1ab))/0xb*(parseInt(_0x3b4829(0x24d))/0xc);if(_0x4950e5===_0x1bdf68)break;else _0x2c1ee3['push'](_0x2c1ee3['shift']());}catch(_0x3db095){_0x2c1ee3['push'](_0x2c1ee3['shift']());}}}(a24_0x19d6,0x66a38));var token,peoplePickerDiv='',peoplePickerDivsuper='',GroupId='',email='',IsUpdate=![],userListItemId='',GuestUserEmail='',UserListId=[],Client_Id;function initializePeoplePicker(_0x5a6e90,_0x2f1419){var _0x2168f2=a24_0x489d,_0x41ae33={};_0x41ae33['PrincipalAccountType']=_0x2168f2(0x221),_0x41ae33[_0x2168f2(0x268)]=0xf,_0x41ae33['ResolvePrincipalSource']=0xf,_0x41ae33[_0x2168f2(0x1dc)]=_0x2f1419,_0x41ae33[_0x2168f2(0x249)]=0x32,_0x41ae33[_0x2168f2(0x209)]='251px',this['SPClientPeoplePicker_InitStandaloneControlWrapper'](_0x5a6e90,null,_0x41ae33),$('.sp-peoplepicker-editorInput')[_0x2168f2(0x19c)](0xfa);}function a24_0x489d(_0x521b16,_0x346dd2){var _0x19d619=a24_0x19d6();return a24_0x489d=function(_0x489d53,_0x27894b){_0x489d53=_0x489d53-0x19b;var _0x3ee1e4=_0x19d619[_0x489d53];return _0x3ee1e4;},a24_0x489d(_0x521b16,_0x346dd2);}$(function(){var _0x476b9b=a24_0x489d;$(_0x476b9b(0x1c8))[_0x476b9b(0x1fc)]({'changeMonth':!![],'changeYear':!![]});});function GetGueastEmployee(_0x4b8994){var _0x1f6dc7=a24_0x489d,_0x385109='https://graph.microsoft.com/v1.0/users?$filter=mail\x20eq\x20\x27'+_0x4b8994+'\x27';return DeferredObj=$[_0x1f6dc7(0x1cc)](),$[_0x1f6dc7(0x1b8)]({'method':'GET','url':_0x385109,'headers':{'Authorization':_0x1f6dc7(0x266)+token,'Content-Type':_0x1f6dc7(0x1a0)},'async':![],'success':function(_0xa4d1a2){var _0x3511a5=_0x1f6dc7;DeferredObj[_0x3511a5(0x27b)](_0xa4d1a2['value']);},'error':function(_0x77b9ae){var _0x3bbf15=_0x1f6dc7;DeferredObj[_0x3bbf15(0x22d)](_0x77b9ae),alert(_0x3bbf15(0x1df)+JSON[_0x3bbf15(0x1a5)](_0x77b9ae));}}),DeferredObj[_0x1f6dc7(0x1ea)]();}function GetGueastUsers(_0x77fa8c){var _0x50f51e=a24_0x489d,_0x2f9811=_0x50f51e(0x220)+_0x77fa8c+'\x27';return DeferredObj=$[_0x50f51e(0x1cc)](),$[_0x50f51e(0x1b8)]({'method':_0x50f51e(0x23d),'url':_0x2f9811,'headers':{'Authorization':_0x50f51e(0x266)+token,'Content-Type':_0x50f51e(0x1a0)},'async':![],'success':function(_0x5a7b86){var _0x12c8e9=_0x50f51e;DeferredObj[_0x12c8e9(0x27b)](_0x5a7b86[_0x12c8e9(0x1d1)]);},'error':function(_0x43ce33){var _0x371cc3=_0x50f51e;DeferredObj[_0x371cc3(0x22d)](_0x43ce33),alert(_0x371cc3(0x1df)+JSON[_0x371cc3(0x1a5)](_0x43ce33));}}),DeferredObj[_0x50f51e(0x1ea)]();}function GetCategoryMaster(){var _0x2f5bca=a24_0x489d,_0x565e42=_0x2f5bca(0x212),_0x1458af=_spPageContextInfo[_0x2f5bca(0x292)]+_0x2f5bca(0x241)+_0x565e42+'\x27)/items?$filter=CategoryType\x20eq\x20\x27Guest\x20Type\x27\x20and\x20Status\x20eq\x20\x20\x27Yes\x27\x20';$['ajax']({'url':_0x1458af,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x16be5d){var _0x5814f7=_0x2f5bca,_0x5a904e=document[_0x5814f7(0x216)](_0x5814f7(0x1a1));_0x5a904e['innerHTML']='';for(var _0x33e82c=0x0;_0x33e82c<_0x16be5d['d']['results'][_0x5814f7(0x289)];_0x33e82c++){var _0x16c4b5=_0x16be5d['d'][_0x5814f7(0x20f)][_0x33e82c][_0x5814f7(0x279)],_0x441a5f=_0x16be5d['d'][_0x5814f7(0x20f)][_0x33e82c][_0x5814f7(0x279)];opt=document[_0x5814f7(0x228)](_0x5814f7(0x25b)),opt['value']=_0x441a5f,opt[_0x5814f7(0x225)]=_0x16c4b5,_0x5a904e[_0x5814f7(0x1b5)](opt);}},'error':function(_0x75673b){var _0x4a3957=_0x2f5bca;console[_0x4a3957(0x1f6)](_0x75673b);}});}function GetUserId(_0x3a6fb7){var _0x9779ef=a24_0x489d,_0xcc9497='',_0xe8f6ec=_0x9779ef(0x20a),_0x49ca9c=_spPageContextInfo[_0x9779ef(0x259)],_0x3f6caa=_0xe8f6ec+_0x3a6fb7;return $[_0x9779ef(0x1b8)]({'url':_0x49ca9c+_0x9779ef(0x1b0)+encodeURIComponent(_0x3f6caa)+'\x27','method':'GET','headers':{'Accept':_0x9779ef(0x1fe)},'async':![],'success':function(_0x43f089){_0xcc9497=_0x43f089['d']['Id'];},'error':function(_0x3156e8){var _0x3a29a7=_0x9779ef;console[_0x3a29a7(0x1f6)](JSON[_0x3a29a7(0x1a5)](_0x3156e8));}}),_0xcc9497;}function GetUserName(_0x2b63a4){var _0x44ebf3=a24_0x489d,_0x24d56c='',_0x2d1bea=_0x44ebf3(0x20a),_0x29f473=_spPageContextInfo[_0x44ebf3(0x259)],_0x5abe83=_0x2d1bea+_0x2b63a4;return $[_0x44ebf3(0x1b8)]({'url':_0x29f473+_0x44ebf3(0x1b0)+encodeURIComponent(_0x5abe83)+'\x27','method':_0x44ebf3(0x23d),'headers':{'Accept':_0x44ebf3(0x1fe)},'async':![],'success':function(_0x22d789){var _0x5c1ad3=_0x44ebf3;_0x24d56c=_0x22d789['d'][_0x5c1ad3(0x28b)];},'error':function(_0x39cc09){var _0x1861dd=_0x44ebf3;console[_0x1861dd(0x1f6)](JSON['stringify'](_0x39cc09));}}),_0x24d56c;}function a24_0x19d6(){var _0x436060=['Email\x20Sent\x20Successfully',')/AttachmentFiles/add(FileName=\x27','CustType','files','EMail','readAsDataURL','get','Already\x20send\x20invitation\x20but\x20this\x20user\x20is\x20not\x20Accepted..','removeClass','log','trim','client_credentials','InternalStakeholders','formatDate','Invite\x20to\x20guest\x20Portal','datepicker','#masterClientgrid','application/json;\x20odata=verbose','Text','Failed','show','AttachmentFiles','#txtReferenceCodeExt','4bmhKeT','\x20<p>','#txtinvitename','get_message','shift','Width','i:0#.f|membership|','/_api/web/lists/getbytitle(\x27',':\x20\x20Compact\x20Token\x20parsing\x20failed','Customerdd','#selectByUser\x20>\x20[value=','results','externalUserState','get_users','CategoryMaster','351slbuWg','d-block','#txtAddOrganization','getElementById','[id$=\x27internalsupervisor_TopSpan\x27]','displayName','Guest\x20user\x20has\x20Update\x20successfully!','<span>','.</p>','EntityData','#__REQUESTDIGEST','Sending\x20mail\x20with\x20attach','InternalStakeholders_TopSpan','https://graph.microsoft.com/v1.0/users?$select=id,displayName,userPrincipalName,otherMails,userType,identities,creationType,externalUserState\x20&$filter=mail\x20eq\x20\x27','User,DL,SecGroup,SPGroup','#txtExtOrganizationName','replace','\x09<span>','text','Description','.toHide','createElement','<div\x20class=\x22checkbox\x20m-0\x22>','#txtExtDesignation','This\x20user\x20is\x20not\x20invited\x20at.\x0a\x20Send\x20invitation\x20to\x20this\x20guest\x20user\x20first.','access_token','reject','addClass','hide','#extrenalImage','Email','#txtExtEmail','#TemplateType','#ddlAssociation','#internalsupervisor','Organization','css','\x27,roledefid=\x271073741830\x27)','https://cdn.jsdelivr.net/gh/Titan4workGit/TitanRepo@latest/SiteAssets/AdminPortal/ManageEmployee/assets/images/user_pic.jpg','get_web','none','get_siteGroups','GET','application/json;odata=nometadata','#txtExtStatus','message','/_api/web/lists/GetByTitle(\x27','<p>Click\x20on\x20<a\x20href=\x22https://adaptindia.sharepoint.com/sites/Titan_2_2_1_DEV/SitePages/GuestPortal.aspx\x22\x20target=\x22_blank\x22>\x20this-link\x20</a></p>','From:\x20no-reply@sharepointonline.com','PendingAcceptance','EnvironmentalSettings','Contributors','push','\x20Your\x20e-mail\x20configured\x20for\x20this\x20portal\x20is\x20<span\x20id=\x22user_id\x22>@info.gmail.com</span>\x20and\x20youâ€™ll\x20be\x20able\x20to\x20login\x20using\x20your\x20existing\x20passport\x20for\x20this\x20e-mail\x20service.','MaximumEntitySuggestions','SP.List','ClientMaster','.msg','48OSFdro','click','responseText','AddUserKeys','\x27)/items?$filter=Title\x20eq\x20\x27Client_Credentials\x27\x20','161850XVmyqk','TemplateType','269772NDhNnp','\x20\x20<tr\x20class=\x22text-center\x22>','<label><input\x20type=\x22checkbox\x22\x20id=\x22Check_','indramani047@gmail.com','?$select=*,Id,Supervisor/Title,Supervisor/EMail\x20,InternalMembers/EMail,InternalMembers/Title,InternalSupervisor/EMail,InternalSupervisor/Title\x20&$expand=Supervisor,InternalMembers,InternalSupervisor\x20','siteAbsoluteUrl','display','option','322301GpwVZM','selected','val','internalsupervisor_TopSpan','when','SendEmailSharedNotification\x20\x20','SPClientPeoplePickerDict','https://cdn.jsdelivr.net/gh/Titan4workGit/TitanRepo@latest/SiteAssets/Titan-External-Employee-Portal/images/user_pic.jpg','<img\x20src=\x22img/customer.png\x22\x20id=\x22logo\x22>','contentEditable','Bearer\x20','internalsupervisor','SearchPrincipalSource','application/json;odata=verbose','split','</div>','https://graph.microsoft.com/v1.0/me/sendMail','2027676IOBsPy','ValidUpto','12tssDiy','target','div[id^=\x27InternalStakeholders\x27]','invitedUserEmailAddress','\x27)/items?$select=*','</p>','Message\x20has\x20been\x20sent.','[id$=\x27InternalStakeholders_TopSpan\x27]','attr','true','CatogeryName','/_api/SP.Utilities.Utility.SendEmail','resolve','#selectByUser','then','disabled','<h3>Dear\x20<span\x20class=\x22user_name\x22>','checked','https://graph.microsoft.com/v1.0/invitations','ExternalUsers','error','\x27)/roleassignments/addroleassignment(principalid=\x27','#txtinvitemessage','Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.\x0a\x20Enter\x20valid\x20email\x20address\x20or\x20check\x20the\x20external\x20sharing\x20features\x20is\x20enabled.','IsActive','/GuestUserDocuments/','length','Not\x20Found','Title','#InternalStakeholders','Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.','2459000bPJpHT','result','#GueastextinputFile','Client_Name','webAbsoluteUrl','GetAllUserInfo','\x22\x20class=\x22getclientmaster\x22\x20onclick=\x22selectOnlyThis(this.id)\x22\x20\x20value=\x22','<option>','</td>','Incase\x20of\x20any\x20help\x20needed\x20or\x20if\x20you\x20are\x20facing\x20any\x20problem\x20in\x20accessing\x20this\x20portal,\x20please\x20send\x20an\x20e-mail\x20to\x20<\x20e-mail\x20ID\x20of\x20\x20admin\x20(s)\x20>','Invitation\x20mail\x20has\x20been\x20sent\x20to\x20the\x20user.','/_api/web/sitegroups/getbyname(\x27Contributors\x27)/users','Idea\x20has\x20been\x20submitted\x20but\x20some\x20files\x20failed\x20to\x20upload.','MERGE','mail\x20sent\x20successfully','\x27)/items?$select=*,AttachmentFiles,Supervisor/Title,Supervisor/EMail,InternalStakeholders/Title,InternalStakeholders/EMail,LoginName/Title,Client_Name/Title,Client_Name/Id\x20&$expand=Supervisor,InternalStakeholders,AttachmentFiles,LoginName,Client_Name\x20&$filter=\x20email\x20eq\x20\x27','</span>','Guest\x20user\x20has\x20registered\x20successfully!','72LHSpnd','width','done','src','Recognition\x20has\x20been\x20submitted\x20\x20!!','application/json','selectByUser','send','empty','\x20This\x20is\x20auto\x20generated\x20e-mail,\x20please\x20do\x20not\x20respond\x20on\x20this\x20sender\x20e-mail.','stringify','SP.User','#txtExternalSupervisor','webServerRelativeUrl','InternalSupervisor','POST','3571051xLsKAU','Supervisor','\x27)/items(','Unauthorized','#Employee-box','/_api/web/siteusers(@v)?@v=\x27','InternalMembers','getItemsWithQueryItem','\x27)/breakroleinheritance(false)','#btnExtUpdate','appendChild','#txtExtLoginName','/GuestUserDocuments/_api/web/lists/getbytitle(\x27','ajax','slow','https://graph.microsoft.com/.default','onload','/_api/SP.OAuth.Token/Acquire','ReferenceCode','Client_Code','.error','userEmail','Guest','append','695920IzwxpY','#Customer-box','test','GueastextinputFile','Association','#datepickerAD5','</tr>','#TemplateType\x20>\x20[value=','</p>\x20\x20','Deferred','Accepted','User\x20Added','/GuestUserDocuments/_api/Web/Lists/','onerror','value','option:selected','prop','#txtinviteemail','byteLength','d-none','<td\x20class=\x22text-left\x22>','input[name=UpdateEmp][value=','getByName','.sp-peoplepicker-delImage','SP.Utilities.EmailProperties','AllowMultipleValues','#btnExtSubmit','statusText','error1','#msgExtEmail','/Forms/AllItems.aspx','CollaborationType','/SitePages/Thankyou.aspx','SelfCompany','fail','Attn_Name','Browsers\x20supported\x20by\x20this\x20portal\x20are\x20Chrome,\x20Microsoft\x20Edge,\x20Safariâ€¦..\x20(incase\x20you\x20want\x20to\x20specify\x20their\x20versions\x20as\x20well)','[id$=\x27','find','promise','<p>Welcome\x20to\x20the\x20','Success'];a24_0x19d6=function(){return _0x436060;};return a24_0x19d6();}function AddNewGuest(){var _0x49a3f7=a24_0x489d;try{var _0x1db487=_0x49a3f7(0x282),_0x59ff33=SPClientPeoplePicker[_0x49a3f7(0x262)][peoplePickerDiv[0x0]['id']],_0x1a3d6c=_0x59ff33['GetAllUserInfo'](),_0x43f617=[];for(var _0x3cde34=0x0;_0x3cde34<_0x1a3d6c[_0x49a3f7(0x289)];_0x3cde34++){var _0x4fd34f=GetUserId(_0x1a3d6c[_0x3cde34][_0x49a3f7(0x21c)][_0x49a3f7(0x231)]);_0x43f617[_0x49a3f7(0x247)](_0x4fd34f),UserListId[_0x49a3f7(0x247)](_0x4fd34f);}_0x59ff33=SPClientPeoplePicker['SPClientPeoplePickerDict'][peoplePickerDivsuper[0x0]['id']],_0x1a3d6c=_0x59ff33[_0x49a3f7(0x293)]();var _0x309719=GetUserId(_0x1a3d6c[0x0][_0x49a3f7(0x21c)][_0x49a3f7(0x231)]);UserListId[_0x49a3f7(0x247)](_0x309719);GroupId==''&&GetGroupIDByGroupName();AddUserinSharePointGroup($(_0x49a3f7(0x232))[_0x49a3f7(0x25e)]());var _0x586668=GetUserId($(_0x49a3f7(0x232))[_0x49a3f7(0x25e)]());UserListId[_0x49a3f7(0x247)](_0x586668);var _0x23aa95=_spPageContextInfo[_0x49a3f7(0x292)]+_0x49a3f7(0x288)+$(_0x49a3f7(0x215))[_0x49a3f7(0x25e)]()['trim']()[_0x49a3f7(0x223)](/ /g,'')+_0x49a3f7(0x1e1),_0xe8e3c,_0x13a9aa=GetItemTypeForListName(_0x1db487);_0xe8e3c={'__metadata':{'type':_0x13a9aa},'LoginNameId':_0x586668,'Title':$(_0x49a3f7(0x232))[_0x49a3f7(0x25e)](),'email':$(_0x49a3f7(0x232))[_0x49a3f7(0x25e)](),'Designation':$(_0x49a3f7(0x22a))[_0x49a3f7(0x25e)](),'Organization':$(_0x49a3f7(0x215))['val'](),'ReferenceCode':$(_0x49a3f7(0x203))[_0x49a3f7(0x25e)](),'TemplateType':$(_0x49a3f7(0x1d2),$(_0x49a3f7(0x233)))[_0x49a3f7(0x25e)](),'InternalStakeholdersId':{'results':_0x43f617},'SupervisorId':_0x309719,'Client_NameId':Client_Id,'External_Supervisor':$(_0x49a3f7(0x1a7))[_0x49a3f7(0x25e)](),'ValidUpto':$(_0x49a3f7(0x1c8))[_0x49a3f7(0x25e)](),'CollaborationType':$(_0x49a3f7(0x1d2),$(_0x49a3f7(0x27c)))[_0x49a3f7(0x25e)](),'Status':$(_0x49a3f7(0x1d2),$('#txtExtStatus'))[_0x49a3f7(0x25e)](),'DocumentLibrary':_0x23aa95},AddItemToList(_0x1db487,_0xe8e3c,UserListId);}catch(_0x27ca85){console[_0x49a3f7(0x1f6)](_0x27ca85[_0x49a3f7(0x240)]);}}function cleartextBox(){var _0x5dfae7=a24_0x489d;$(_0x5dfae7(0x1b6))[_0x5dfae7(0x25e)](''),$(_0x5dfae7(0x232))[_0x5dfae7(0x25e)](''),$(_0x5dfae7(0x22a))[_0x5dfae7(0x25e)](''),$(_0x5dfae7(0x203))['val'](''),$(_0x5dfae7(0x222))[_0x5dfae7(0x25e)](''),$(_0x5dfae7(0x230))['attr'](_0x5dfae7(0x19e),_0x5dfae7(0x239)),initializePeoplePicker('InternalStakeholders',!![]),peoplePickerDiv=$(_0x5dfae7(0x276)),initializePeoplePicker(_0x5dfae7(0x267),![]),peoplePickerDivsuper=$('[id$=\x27internalsupervisor_TopSpan\x27]');}function AddItemToList(_0x33c9c7,_0x4f8642,_0x4b13c4){var _0x2642c3=a24_0x489d,_0x6a9eb0=$[_0x2642c3(0x1cc)]();return $[_0x2642c3(0x1b8)]({'url':_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/getbytitle(\x27'+_0x33c9c7+'\x27)/items','type':_0x2642c3(0x1aa),'async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$('#__REQUESTDIGEST')['val'](),'content-Type':'application/json;odata=verbose'},'data':JSON['stringify'](_0x4f8642),'success':function(_0x280796){var _0x338593=_0x2642c3;if(document[_0x338593(0x216)]('GueastextinputFile')[_0x338593(0x1f0)][_0x338593(0x289)]===0x0){}else UploadAttachement(_0x280796['d']['ID']);console[_0x338593(0x1f6)](_0x280796),IsExistOrNotLibrary($(_0x338593(0x215))[_0x338593(0x25e)]()[_0x338593(0x1f7)]()[_0x338593(0x223)](/ /g,''))?AssignTheEditRole($(_0x338593(0x215))[_0x338593(0x25e)]()[_0x338593(0x1f7)]()['replace'](/ /g,''),_0x4b13c4):(createNewLibraryByRest($(_0x338593(0x215))[_0x338593(0x25e)]()[_0x338593(0x1f7)]()['replace'](/ /g,'')),AssignTheEditRole($('#txtAddOrganization')[_0x338593(0x25e)]()[_0x338593(0x1f7)]()[_0x338593(0x223)](/ /g,''),_0x4b13c4)),alert(_0x338593(0x29f)),cleartextBox();},'error':function(_0x199794){var _0x537c99=_0x2642c3;console[_0x537c99(0x1f6)](JSON['stringify'](_0x199794)),_0x6a9eb0[_0x537c99(0x22d)](_0x199794);}}),_0x6a9eb0['promise']();}function UpdateGeustuser(_0x234a85){var _0x25343a=a24_0x489d,_0x4456c2='ExternalUsers',_0x44ed74=SPClientPeoplePicker[_0x25343a(0x262)][peoplePickerDiv[0x0]['id']],_0x26b6d5=_0x44ed74['GetAllUserInfo'](),_0x51f65c=[];for(var _0xd60953=0x0;_0xd60953<_0x26b6d5[_0x25343a(0x289)];_0xd60953++){var _0x2b4970=GetUserId(_0x26b6d5[_0xd60953]['EntityData'][_0x25343a(0x231)]);_0x51f65c['push'](_0x2b4970),UserListId['push'](_0x2b4970);}_0x44ed74=SPClientPeoplePicker[_0x25343a(0x262)][peoplePickerDivsuper[0x0]['id']],_0x26b6d5=_0x44ed74[_0x25343a(0x293)]();var _0x4bbb79=GetUserId(_0x26b6d5[0x0][_0x25343a(0x21c)][_0x25343a(0x231)]);UserListId['push'](_0x4bbb79);var _0x6f7ca3=GetUserId($(_0x25343a(0x232))[_0x25343a(0x25e)]());UserListId[_0x25343a(0x247)](_0x6f7ca3),GuestUserEmail=$('#txtExtEmail')['val']();var _0x18cfc8=_spPageContextInfo['webAbsoluteUrl']+'/GuestUserDocuments/'+$(_0x25343a(0x215))['val']()[_0x25343a(0x1f7)]()[_0x25343a(0x223)](/ /g,'')+_0x25343a(0x1e1);_0x6f7ca3==''&&(GetGroupIDByGroupName(),AddUserinSharePointGroup($('#txtExtEmail')[_0x25343a(0x25e)]()));var _0x17be06,_0x548fd4=GetItemTypeForListName(_0x4456c2);_0x17be06={'__metadata':{'type':_0x548fd4},'Designation':$('#txtExtDesignation')[_0x25343a(0x25e)](),'LoginNameId':_0x6f7ca3,'Organization':$(_0x25343a(0x215))['val'](),'ReferenceCode':$(_0x25343a(0x203))[_0x25343a(0x25e)](),'TemplateType':$(_0x25343a(0x1d2),$(_0x25343a(0x233)))[_0x25343a(0x25e)](),'InternalStakeholdersId':{'results':_0x51f65c},'SupervisorId':_0x4bbb79,'Client_NameId':Client_Id,'ValidUpto':$('#datepickerAD5')[_0x25343a(0x25e)](),'CollaborationType':$(_0x25343a(0x1d2),$(_0x25343a(0x27c)))['val'](),'Status':$(_0x25343a(0x1d2),$(_0x25343a(0x23f)))[_0x25343a(0x25e)](),'DocumentLibrary':_0x18cfc8};var _0x493902=$[_0x25343a(0x1cc)]();return $['ajax']({'url':_spPageContextInfo['webAbsoluteUrl']+_0x25343a(0x241)+_0x4456c2+'\x27)/items('+_0x234a85+')','type':_0x25343a(0x1aa),'async':![],'headers':{'accept':_0x25343a(0x269),'X-RequestDigest':$(_0x25343a(0x21d))['val'](),'content-Type':_0x25343a(0x269),'IF-MATCH':'*','X-HTTP-Method':_0x25343a(0x29b)},'data':JSON[_0x25343a(0x1a5)](_0x17be06),'success':function(_0x4d6ba6){var _0x53b056=_0x25343a;if(document['getElementById'](_0x53b056(0x1c6))[_0x53b056(0x1f0)][_0x53b056(0x289)]===0x0){}else UploadAttachement(_0x234a85);console[_0x53b056(0x1f6)](_0x4d6ba6),IsExistOrNotLibrary($('#txtAddOrganization')[_0x53b056(0x25e)]()[_0x53b056(0x1f7)]()[_0x53b056(0x223)](/ /g,''))?AssignTheEditRole($(_0x53b056(0x215))[_0x53b056(0x25e)]()[_0x53b056(0x1f7)]()[_0x53b056(0x223)](/ /g,''),UserListId):(createNewLibraryByRest($(_0x53b056(0x215))['val']()[_0x53b056(0x1f7)]()['replace'](/ /g,'')),AssignTheEditRole($(_0x53b056(0x215))[_0x53b056(0x25e)]()[_0x53b056(0x1f7)]()[_0x53b056(0x223)](/ /g,''),UserListId)),alert(_0x53b056(0x219));},'error':function(_0x685add){var _0x2efec2=_0x25343a;console[_0x2efec2(0x1f6)](JSON[_0x2efec2(0x1a5)](_0x685add)),_0x493902['reject'](_0x685add);}}),_0x493902[_0x25343a(0x1ea)]();}function GetItemToList(_0x134a03){var _0xd2dd7b=a24_0x489d,_0x3ba88b='ExternalUsers',_0x4c9173=$['Deferred']();return $[_0xd2dd7b(0x1b8)]({'url':_spPageContextInfo[_0xd2dd7b(0x292)]+_0xd2dd7b(0x20b)+_0x3ba88b+_0xd2dd7b(0x29d)+_0x134a03+'\x27','type':_0xd2dd7b(0x1f3),'async':![],'headers':{'accept':_0xd2dd7b(0x269),'X-RequestDigest':$('#__REQUESTDIGEST')[_0xd2dd7b(0x25e)](),'content-Type':_0xd2dd7b(0x269)},'success':function(_0x2e41fc){var _0x27b496=_0xd2dd7b;_0x4c9173[_0x27b496(0x27b)](_0x2e41fc['d'][_0x27b496(0x20f)]),console[_0x27b496(0x1f6)](_0x2e41fc);},'error':function(_0x16dd4c){var _0x4bf232=_0xd2dd7b;console[_0x4bf232(0x1f6)](JSON[_0x4bf232(0x1a5)](_0x16dd4c)),_0x4c9173[_0x4bf232(0x22d)](_0x16dd4c);}}),_0x4c9173[_0xd2dd7b(0x1ea)]();}function GetItemToListchoice(){var _0x3a15cd=a24_0x489d,_0x297e68=_0x3a15cd(0x282),_0x999f85=$[_0x3a15cd(0x1cc)]();return $[_0x3a15cd(0x1b8)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x3a15cd(0x20b)+_0x297e68+'\x27)/fields?&$select=*&$filter=EntityPropertyName\x20eq\x20\x27TemplateType\x27','type':_0x3a15cd(0x1f3),'async':![],'headers':{'accept':_0x3a15cd(0x269),'X-RequestDigest':$(_0x3a15cd(0x21d))[_0x3a15cd(0x25e)](),'content-Type':_0x3a15cd(0x269)},'success':function(_0x1d9cf7){var _0x44121b=_0x3a15cd;_0x999f85[_0x44121b(0x27b)](_0x1d9cf7['d'][_0x44121b(0x20f)][0x0]['Choices'][_0x44121b(0x20f)]),console[_0x44121b(0x1f6)](_0x1d9cf7);},'error':function(_0x524f0d){var _0x185b13=_0x3a15cd;console[_0x185b13(0x1f6)](JSON['stringify'](_0x524f0d)),_0x999f85[_0x185b13(0x22d)](_0x524f0d);}}),_0x999f85[_0x3a15cd(0x1ea)]();}function GetItemToClientMaster(){var _0x28209a=a24_0x489d,_0x37c343=_0x28209a(0x24b),_0x2f18bf=$['Deferred']();return $[_0x28209a(0x1b8)]({'url':_spPageContextInfo[_0x28209a(0x292)]+'/_api/web/lists/getbytitle(\x27'+_0x37c343+_0x28209a(0x273),'type':_0x28209a(0x1f3),'async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x28209a(0x21d))['val'](),'content-Type':_0x28209a(0x269)},'success':function(_0x2998ea){var _0x85d062=_0x28209a;_0x2f18bf[_0x85d062(0x27b)](_0x2998ea['d']['results']),console['log'](_0x2998ea);},'error':function(_0x1f0615){var _0x212e8a=_0x28209a;console[_0x212e8a(0x1f6)](JSON[_0x212e8a(0x1a5)](_0x1f0615)),_0x2f18bf[_0x212e8a(0x22d)](_0x1f0615);}}),_0x2f18bf[_0x28209a(0x1ea)]();}function requestToken(){var _0x4172c2=a24_0x489d;$[_0x4172c2(0x1b8)]({'async':!![],'crossDomain':!![],'url':ClientUrl,'method':'POST','headers':{'content-type':'application/x-www-form-urlencoded'},'data':{'grant_type':_0x4172c2(0x1f8),'client_id\x20':ClientId,'client_secret':ClentSecret,'scope\x20':_0x4172c2(0x1ba)},'success':function(_0x3d2be7){var _0x2335a3=_0x4172c2;console[_0x2335a3(0x1f6)](_0x3d2be7),token=_0x3d2be7[_0x2335a3(0x22c)];},'error':function(_0x5d85f8){var _0xb997c0=_0x4172c2;console[_0xb997c0(0x1f6)](JSON[_0xb997c0(0x1a5)](_0x5d85f8));}});}function ClientCredentialss(){var _0x1813e2=a24_0x489d,_0x134871=_0x1813e2(0x245),_0xe9b4a5=_spPageContextInfo[_0x1813e2(0x292)]+_0x1813e2(0x241)+_0x134871+_0x1813e2(0x251);$[_0x1813e2(0x1b8)]({'url':_0xe9b4a5,'headers':{'Accept':_0x1813e2(0x269)},'async':![],'success':function(_0x471595){var _0x21d097=_0x1813e2,_0x412e33=_0x471595['d'][_0x21d097(0x20f)];ClientId=_0x412e33[0x0]['ClientName'],ClentSecret=_0x412e33[0x0]['ChangeFileName'],ClientUrl=_0x412e33[0x0][_0x21d097(0x226)],requestToken();},'error':function(_0x265860){var _0x1960c4=_0x1813e2;console[_0x1960c4(0x1f6)](_0x265860);}});}function GraphAccessTokenTogetUserDetails(){var _0x46417e=a24_0x489d,_0x4e4507=new jQuery[(_0x46417e(0x1cc))](),_0x4ee4db={'X-RequestDigest':$('#__REQUESTDIGEST')[_0x46417e(0x25e)](),'accept':_0x46417e(0x23e),'content-type':_0x46417e(0x23e)},_0x58cc48={'resource':'https://graph.microsoft.com'};return $[_0x46417e(0x1b8)]({'url':_spPageContextInfo[_0x46417e(0x292)]+_0x46417e(0x1bc),'headers':_0x4ee4db,'type':'POST','data':JSON['stringify'](_0x58cc48),'success':function(_0x7b0d10){var _0x84e145=_0x46417e;token=_0x7b0d10[_0x84e145(0x22c)],token_=token,_0x4e4507[_0x84e145(0x27b)](token);},'error':function(_0x1833c4,_0x4f0b46,_0x4d96fb){var _0x497922=_0x46417e;console[_0x497922(0x1f6)](_0x1833c4[_0x497922(0x24f)]),_0x4e4507[_0x497922(0x22d)](_0x1833c4['responseText']);}}),_0x4e4507['promise']();}var Errorcount=0x1,Ischeckerror=![];function Inviteuser(){var _0x51ee4f=a24_0x489d,_0x17367e=$(_0x51ee4f(0x1d4))[_0x51ee4f(0x25e)](),_0x1262ad=$(_0x51ee4f(0x206))[_0x51ee4f(0x25e)](),_0x417979=$(_0x51ee4f(0x285))['val']();Errorcount=0x1,$[_0x51ee4f(0x1b8)]({'url':_0x51ee4f(0x281),'type':_0x51ee4f(0x1aa),'headers':{'Authorization':_0x51ee4f(0x266)+token,'content-type':_0x51ee4f(0x1a0)},'data':JSON['stringify']({'invitedUserDisplayName':_0x1262ad,'invitedUserEmailAddress':_0x17367e,'inviteRedirectUrl':_spPageContextInfo[_0x51ee4f(0x292)]+_0x51ee4f(0x1e3),'sendInvitationMessage':!![],'invitedUserMessageInfo':{'customizedMessageBody':_0x417979}}),'async':![],'success':function(_0xa01ef){var _0x26a06b=_0x51ee4f;console[_0x26a06b(0x1f6)](_0xa01ef),$(_0x26a06b(0x1d4))[_0x26a06b(0x25e)](''),$(_0x26a06b(0x206))[_0x26a06b(0x25e)](''),$('#txtinvitemessage')['val']('');GroupId==''&&GetGroupIDByGroupName();GuestUserEmail=_0xa01ef[_0x26a06b(0x272)];try{$[_0x26a06b(0x260)](AddUserinSharePointGroup(_0xa01ef[_0x26a06b(0x272)]))[_0x26a06b(0x19d)](function(_0x534c66){var _0xf195a8=_0x26a06b;Ischeckerror=![],_0x534c66==_0xf195a8(0x1ce)?alert(_0xf195a8(0x298)):alert(_0xf195a8(0x28d));});}catch(_0x283e2a){alert('Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.');}},'error':function(_0x5671b0){var _0x2ba03f=_0x51ee4f;_0x5671b0['statusText']==_0x2ba03f(0x1ae)?alert(_0x5671b0[_0x2ba03f(0x1de)]+_0x2ba03f(0x20c)):(alert('Please\x20enter\x20a\x20valid\x20email\x20address\x20of\x20the\x20guest\x20user,\x20who\x20is\x20outsider\x20of\x20this\x20organization.'),console[_0x2ba03f(0x1f6)](JSON[_0x2ba03f(0x1a5)](_0x5671b0)));}}),Ischeckerror&&alert(_0x51ee4f(0x28d));}function setPeoplePickerUsersInfoCurrent(_0x50e79c,_0x11567a){var _0x3f8f51=a24_0x489d,_0x135648=$(_0x3f8f51(0x1e8)+_0x50e79c+'\x27]'),_0xe6481e=SPClientPeoplePicker['SPClientPeoplePickerDict'][_0x135648[0x0]['id']];_0xe6481e[_0x3f8f51(0x250)](_0x11567a,![]),_0xe6481e['SetEnabledState'](![]);}function readURL(_0x2c0124){var _0x2b2360=a24_0x489d;if(_0x2c0124[_0x2b2360(0x1f0)]&&_0x2c0124[_0x2b2360(0x1f0)][0x0]){var _0x3238cc=new FileReader();_0x3238cc['onload']=function(_0x4e10ad){var _0x100d2e=_0x2b2360;$(_0x100d2e(0x230))[_0x100d2e(0x277)](_0x100d2e(0x19e),_0x4e10ad[_0x100d2e(0x270)]['result']);},_0x3238cc[_0x2b2360(0x1f2)](_0x2c0124[_0x2b2360(0x1f0)][0x0]);}}function UploadAttachement(_0x14b1dc){var _0x3d51b6=a24_0x489d;try{if(document[_0x3d51b6(0x216)]('GueastextinputFile')[_0x3d51b6(0x1f0)][_0x3d51b6(0x289)]===0x0){}else{var _0x2ea422=_0x14b1dc,_0x10b5d0=$(_0x3d51b6(0x290)),_0x539f8e=_0x10b5d0[0x0][_0x3d51b6(0x1f0)][_0x3d51b6(0x289)],_0x30a614=[],_0x643076=_0x10b5d0[0x0][_0x3d51b6(0x1f0)][0x0]['name'];_0x643076=_0x10b5d0[0x0][_0x3d51b6(0x1f0)][0x0]['name']['replace'](/[^a-zA-Z0-9-. ]/g,''),_0x643076=_0x643076['replace'](/\s/g,'');for(var _0x18767d=0x0;_0x18767d<_0x539f8e;_0x18767d++){_0x30a614[_0x3d51b6(0x247)](_0x10b5d0[0x0][_0x3d51b6(0x1f0)][_0x18767d]);}uploadFileSP(_0x3d51b6(0x282),_0x2ea422,_0x30a614,_0x539f8e,_0x643076);}}catch(_0x1bf574){alert('Your\x20item\x20has\x20not\x20been\x20submitted\x20successfully!');}}function getFileBuffer(_0x14f386){var _0x1a8ddb=a24_0x489d,_0x404834=$[_0x1a8ddb(0x1cc)](),_0x2052c0=new FileReader();return _0x2052c0[_0x1a8ddb(0x1bb)]=function(_0x444caa){var _0x4401b3=_0x1a8ddb;_0x404834['resolve'](_0x444caa[_0x4401b3(0x270)][_0x4401b3(0x28f)]);},_0x2052c0[_0x1a8ddb(0x1d0)]=function(_0x105033){var _0x4e9c29=_0x1a8ddb;_0x404834['reject'](_0x105033['target'][_0x4e9c29(0x283)]);},_0x2052c0['readAsArrayBuffer'](_0x14f386),_0x404834[_0x1a8ddb(0x1ea)]();}function uploadFileSP(_0x581068,_0x204df3,_0x5a5454,_0x1776ee,_0x2c146c){var _0x350255=a24_0x489d,_0x4382c3=0x0,_0x17f612=$[_0x350255(0x1cc)](),_0x3c8ea1='',_0x159a01=_0x5a5454[0x0],_0x4b9d00=getFileBuffer(_0x159a01);return _0x4b9d00[_0x350255(0x19d)](function(_0xdca2a1,_0x54eed3,_0x505577){var _0x31ba88=_0x350255,_0x301f4a=new Uint8Array(_0xdca2a1),_0x322412=new SP['Base64EncodedByteArray'](),_0x4522d2=_spPageContextInfo['webAbsoluteUrl']+'/_api/lists/GetByTitle(\x27'+_0x581068+_0x31ba88(0x1ad)+_0x204df3+_0x31ba88(0x1ee)+_0x2c146c+'\x27)',_0x1418f6=0x0;$[_0x31ba88(0x1b8)]({'url':_0x4522d2,'type':_0x31ba88(0x1aa),'processData':![],'contentType':_0x31ba88(0x269),'data':_0xdca2a1,'headers':{'accept':_0x31ba88(0x269),'X-RequestDigest':$(_0x31ba88(0x21d))[_0x31ba88(0x25e)](),'content-length':_0xdca2a1[_0x31ba88(0x1d5)]},'success':function(_0xecd3c7){var _0x3dd049=_0x31ba88;_0x4382c3++,_0x3c8ea1=_0x4382c3,_0x5a5454[_0x3dd049(0x208)]();if(_0x5a5454[_0x3dd049(0x289)]>0x0)uploadFileSP(_0x3dd049(0x282),_0x204df3,_0x5a5454,_0x5a5454[_0x3dd049(0x289)]);else{}},'error':function(_0x519f68){var _0x4d8933=_0x31ba88;alert(_0x4d8933(0x29a));}}),_0x17f612['resolve'](_0x3c8ea1);}),_0x4b9d00[_0x350255(0x1e5)](function(_0x215e01){_0x17f612['reject'](_0x215e01);}),_0x17f612[_0x350255(0x1ea)]();}function GetGroupIDByGroupName(){var _0x287daa=a24_0x489d,_0xe944a5=_spPageContextInfo[_0x287daa(0x292)]+'/_api/web/sitegroups/getbyname(\x27Contributors\x27)?$select=id';$[_0x287daa(0x1b8)]({'url':_0xe944a5,'method':_0x287daa(0x23d),'async':![],'headers':{'Accept':_0x287daa(0x1fe)},'success':function(_0x54d1ee){GroupId=_0x54d1ee['d']['Id'];},'error':function(_0x374168){var _0x26bffd=_0x287daa;console[_0x26bffd(0x1f6)](_0x374168);}});}function AddUserToSiteGroup(_0x4b1108){var _0x4a06cd=a24_0x489d;clientContext=new SP['ClientContext']();var _0x48b599=clientContext[_0x4a06cd(0x23a)]()[_0x4a06cd(0x23c)]()[_0x4a06cd(0x1d9)](_0x4a06cd(0x246)),_0x244f75=_0x48b599[_0x4a06cd(0x211)]();_0x244f75['addUser'](_0x4b1108),clientContext['executeQueryAsync'](onsuccess,onfailed);}function onsuccess(){var _0x4f7649=a24_0x489d;console[_0x4f7649(0x1f6)](_0x4f7649(0x1ec));}function onfailed(_0x52d575,_0x4d6a8c){var _0x2b9ae3=a24_0x489d;console[_0x2b9ae3(0x1f6)](_0x2b9ae3(0x200)+_0x4d6a8c[_0x2b9ae3(0x207)]()+'\x0a'+_0x4d6a8c['get_stackTrace']());}function AddUserinSharePointGroup(_0x14a39f){var _0xe630cb=a24_0x489d,_0x2da98d=$['Deferred'](),_0x3865dc=_0xe630cb(0x20a),_0x1a362a=_0x3865dc+_0x14a39f,_0x37ff15=_spPageContextInfo['webAbsoluteUrl']+_0xe630cb(0x299);$[_0xe630cb(0x1b8)]({'url':_0x37ff15,'type':_0xe630cb(0x1aa),'async':![],'data':JSON['stringify']({'__metadata':{'type':_0xe630cb(0x1a6)},'LoginName':_0x1a362a}),'headers':{'accept':_0xe630cb(0x269),'content-type':_0xe630cb(0x269),'X-RequestDigest':$(_0xe630cb(0x21d))['val']()},'success':_0x274247,'error':_0x28a629});function _0x274247(_0x5cbe1c){var _0x3b46d4=_0xe630cb;Ischeckerror=!![],_0x2da98d['resolve']('User\x20Added'),Errorcount=0x1,console[_0x3b46d4(0x1f6)](_0x3b46d4(0x1ce));}function _0x28a629(_0x51aaac){var _0x5770d6=_0xe630cb;console[_0x5770d6(0x1f6)](JSON[_0x5770d6(0x1a5)](_0x51aaac)),(_0x51aaac[_0x5770d6(0x1de)]==_0x5770d6(0x28a)||_0x51aaac[_0x5770d6(0x1de)]==_0x5770d6(0x283))&&Errorcount==0xa?_0x51aaac[_0x5770d6(0x1de)]=='error'?alert('Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.'):alert(_0x5770d6(0x286)):(Errorcount++,AddUserinSharePointGroup(GuestUserEmail));}return _0x2da98d['promise']();}function AddUserinSharePointGroupforEdit(_0x14723a){var _0x3c3b00=a24_0x489d,_0x5c16a8='',_0x4403ca=_0x3c3b00(0x20a),_0x9f39e8=_0x4403ca+_0x14723a,_0x216a3e=_spPageContextInfo[_0x3c3b00(0x292)]+'/_api/web/sitegroups('+GroupId+')/users';$[_0x3c3b00(0x1b8)]({'url':_0x216a3e,'type':_0x3c3b00(0x1aa),'async':![],'data':JSON[_0x3c3b00(0x1a5)]({'__metadata':{'type':_0x3c3b00(0x1a6)},'LoginName':_0x9f39e8}),'headers':{'accept':_0x3c3b00(0x269),'content-type':_0x3c3b00(0x269),'X-RequestDigest':$(_0x3c3b00(0x21d))[_0x3c3b00(0x25e)]()},'success':_0x233f53,'error':_0x504396});function _0x233f53(_0x1731ab){var _0x3cc544=_0x3c3b00;_0x5c16a8=_0x1731ab['d'],console[_0x3cc544(0x1f6)]('User\x20Added');}function _0x504396(_0x55015){var _0x13bbf2=_0x3c3b00;console[_0x13bbf2(0x1f6)](JSON[_0x13bbf2(0x1a5)](_0x55015));}return _0x5c16a8;}function processSendEmails(_0x1b85f2,_0x5932ab,_0xa395f3){var _0x3c152b=a24_0x489d,_0x3aceb0=[],_0x543d91=_0x3c152b(0x264)+_0x3c152b(0x27f)+_0x1b85f2+'</span></h3>'+_0x3c152b(0x1eb)+_0x5932ab+'\x20portal\x20of\x20'+_0xa395f3+_0x3c152b(0x21b)+'<p>Please\x20click\x20on\x20the\x20following\x20link\x20to\x20access\x20this\x20portal.\x20</p>'+_0x3c152b(0x242)+'<p>'+_0x3c152b(0x248)+_0x3c152b(0x1e7)+_0x3c152b(0x1cb)+_0x3c152b(0x205)+_0x3c152b(0x297)+_0x3c152b(0x1a4)+_0x3c152b(0x274),_0x2bfd67=_0x3c152b(0x1fb);_0x3aceb0[_0x3c152b(0x247)](email);var _0xf1cdfd=_spPageContextInfo[_0x3c152b(0x1c0)],_0x360728;_0x360728={'properties':{'__metadata':{'type':'SP.Utilities.EmailProperties'},'From':_0xf1cdfd,'To':{'results':_0x3aceb0},'Body':_0x543d91,'Subject':_0x2bfd67}};var _0xb44778={'properties':{'__metadata':{'type':_0x3c152b(0x1db)},'From':_0x3c152b(0x243),'To':{'results':_0x3aceb0},'Body':_0x543d91,'Subject':_0x2bfd67}},_0x46b15e=_spPageContextInfo[_0x3c152b(0x1a8)]==='/'?'/':_spPageContextInfo[_0x3c152b(0x1a8)],_0x281f7f=_0x46b15e,_0x4af7f2=_0x281f7f+_0x3c152b(0x27a),_0x153761=_spPageContextInfo[_0x3c152b(0x292)]+_0x3c152b(0x27a);$[_0x3c152b(0x1b8)]({'contentType':'application/json','url':_0x153761,'type':_0x3c152b(0x1aa),'data':JSON[_0x3c152b(0x1a5)](_0xb44778),'async':![],'headers':{'Accept':_0x3c152b(0x269),'content-type':_0x3c152b(0x269),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x3c152b(0x25e)]()},'success':function(_0x547b36){var _0x595fcf=_0x3c152b;console['log'](_0x595fcf(0x275));},'error':function(_0x5e220e){var _0x52ba7b=_0x3c152b;console[_0x52ba7b(0x1f6)](_0x52ba7b(0x261)+JSON[_0x52ba7b(0x1a5)](_0x5e220e));}});}function sendEmail(_0x333a62,_0x3ac6c0,_0x8a35ef,_0x38a5a9){var _0x44025e=a24_0x489d;Email[_0x44025e(0x1a2)]({'SecureToken':token,'To':_0x3ac6c0[0x0],'From':_0x333a62,'Subject':_0x38a5a9,'Body':_0x8a35ef})[_0x44025e(0x27d)](_0x24be8d=>alert(_0x44025e(0x29c)));var _0x5c2693=_spPageContextInfo[_0x44025e(0x1a8)],_0x413283=_0x5c2693+'/_api/SP.Utilities.Utility.SendEmail';$[_0x44025e(0x1b8)]({'contentType':'application/json','url':_0x413283,'type':_0x44025e(0x1aa),'data':JSON[_0x44025e(0x1a5)]({'properties':{'__metadata':{'type':_0x44025e(0x1db)},'From':_0x333a62,'To':{'results':_0x3ac6c0},'Body':_0x8a35ef,'Subject':_0x38a5a9}}),'headers':{'Accept':'application/json;odata=verbose','content-type':_0x44025e(0x269),'X-RequestDigest':jQuery(_0x44025e(0x21d))[_0x44025e(0x25e)]()},'success':function(_0x4f8538){var _0x56118e=_0x44025e;alert(_0x56118e(0x1ed));},'error':function(_0x114218){alert('Error\x20in\x20sending\x20Email:\x20'+JSON['stringify'](_0x114218));}});}$(function(){var _0x335601=a24_0x489d;$('[name=UpdateEmp]')[_0x335601(0x24e)](function(){var _0x5d8638=_0x335601;$(_0x5d8638(0x227))['hide'](),cleartextBox(),$('#UpdateEmp-box-'+$(this)[_0x5d8638(0x25e)]())['show'](_0x5d8638(0x1b9)),$(this)['val']()=='3'&&(GetCategoryMaster(),$[_0x5d8638(0x260)](GetItemToListchoice())[_0x5d8638(0x19d)](function(_0x147d82){var _0x1a1232=_0x5d8638;$(_0x1a1232(0x233))[_0x1a1232(0x1a3)]();for(var _0x414ad0=0x0;_0x414ad0<_0x147d82[_0x1a1232(0x289)];_0x414ad0++){var _0x41ced3=$(_0x1a1232(0x295));_0x41ced3[_0x1a1232(0x277)](_0x1a1232(0x1d1),_0x147d82[_0x414ad0])[_0x1a1232(0x225)](_0x147d82[_0x414ad0]),$(_0x1a1232(0x233))[_0x1a1232(0x1c2)](_0x41ced3);}})),$(_0x5d8638(0x1e0))[_0x5d8638(0x22f)]();});});function sendEmailg(){var _0x5aaf84=a24_0x489d;$[_0x5aaf84(0x1b8)]({'async':![],'crossDomain':!![],'url':_0x5aaf84(0x26c),'method':_0x5aaf84(0x1aa),'headers':{'authorization':_0x5aaf84(0x266)+token_,'content-type':'application/json'},'data':JSON['stringify']({'message':{'subject':'Meet\x20for\x20lun\x20Indramani\x20Indra?','body':{'contentType':_0x5aaf84(0x1ff),'content':'The\x20new\x20cafeteria\x20is\x20open.'},'toRecipients':[{'emailAddress':{'address':_0x5aaf84(0x257)}}]}}),'success':function(_0x4f5385){var _0x1a0fe7=_0x5aaf84;alert(_0x1a0fe7(0x19f));},'error':function(_0x51334b){var _0x416a5e=_0x5aaf84;console[_0x416a5e(0x1f6)](_0x416a5e(0x21e)+JSON[_0x416a5e(0x1a5)](_0x51334b));}});}function createNewLibraryByRest(_0x314dd2){var _0x41a5ce=a24_0x489d,_0x18d0a5=_0x314dd2,_0x32d11e=_spPageContextInfo[_0x41a5ce(0x292)]+_0x41a5ce(0x1cf);$[_0x41a5ce(0x1b8)]({'url':_0x32d11e,'method':'POST','async':![],'data':JSON[_0x41a5ce(0x1a5)]({'__metadata':{'type':_0x41a5ce(0x24a)},'AllowContentTypes':!![],'BaseTemplate':0x65,'ContentTypesEnabled':!![],'Description':'Description','OnQuickLaunch':!![],'Title':_0x314dd2}),'headers':{'content-type':_0x41a5ce(0x269),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x41a5ce(0x25e)]()},'success':function(_0x39a5c1){BreakRoleInheritance(_0x18d0a5);},'error':function(_0x59e2ec){var _0x18b972=_0x41a5ce;alert(_0x59e2ec[_0x18b972(0x24f)]);}});}function BreakRoleInheritance(_0x5dec8c){var _0x1fdd4b=a24_0x489d;url=_spPageContextInfo['webAbsoluteUrl']+_0x1fdd4b(0x1b7)+_0x5dec8c+_0x1fdd4b(0x1b3),$[_0x1fdd4b(0x1b8)]({'url':url,'type':_0x1fdd4b(0x1aa),'async':![],'headers':{'accept':_0x1fdd4b(0x23e),'X-RequestDigest':$(_0x1fdd4b(0x21d))['val']()},'success':function(_0x36329a){var _0x3c594f=_0x1fdd4b;console[_0x3c594f(0x1f6)](_0x36329a);},'error':function(_0x3ef646){var _0x2c1241=_0x1fdd4b;console[_0x2c1241(0x1f6)](_0x3ef646);}});}function AssignTheEditRole(_0x4b88ec,_0x49c907){var _0x1affb9=a24_0x489d;for(var _0x479647=0x0;_0x479647<_0x49c907[_0x1affb9(0x289)];_0x479647++){url=_spPageContextInfo['webAbsoluteUrl']+_0x1affb9(0x1b7)+_0x4b88ec+_0x1affb9(0x284)+_0x49c907[_0x479647]+_0x1affb9(0x238),$['ajax']({'url':url,'type':_0x1affb9(0x1aa),'async':![],'headers':{'accept':'application/json;odata=nometadata','X-RequestDigest':$(_0x1affb9(0x21d))[_0x1affb9(0x25e)]()},'success':function(_0x33a56e){var _0x45602d=_0x1affb9;console[_0x45602d(0x1f6)](_0x33a56e);},'error':function(_0x114677){var _0x337203=_0x1affb9;console[_0x337203(0x1f6)](_0x114677);}});}}function IsExistOrNotLibrary(_0x358ac8){var _0x24d26a=a24_0x489d,_0x325ab8='';return url=_spPageContextInfo[_0x24d26a(0x292)]+'/GuestUserDocuments/_api/web/lists/?$filter=Title\x20eq\x20\x27'+_0x358ac8+'\x27',$['ajax']({'url':url,'type':'get','async':![],'headers':{'accept':_0x24d26a(0x23e),'X-RequestDigest':$(_0x24d26a(0x21d))[_0x24d26a(0x25e)]()},'success':function(_0x27aef3){var _0x579abe=_0x24d26a;_0x27aef3[_0x579abe(0x1d1)][_0x579abe(0x289)]>0x0?_0x325ab8=!![]:_0x325ab8=![],console['log'](_0x27aef3);},'error':function(_0x330df2){var _0x4a0edf=_0x24d26a;console[_0x4a0edf(0x1f6)](_0x330df2);}}),_0x325ab8;}var SelectClientId='';function GenarateclientGrid(_0x5affd1){var _0x2c5f64=a24_0x489d;$(_0x2c5f64(0x1fd))[_0x2c5f64(0x1a3)](),$(_0x2c5f64(0x1fd))[_0x2c5f64(0x1c2)](_0x5affd1);}function Selectedcclinte(){var _0x2fa37c=a24_0x489d;$(_0x2fa37c(0x215))[_0x2fa37c(0x25e)](ClientInternalMembers[SelectClientId][_0x2fa37c(0x28b)]),Client_Id=ClientInternalMembers[SelectClientId]['ID'];ClientInternalMembers[SelectClientId]['Supervisor']!=undefined?$(_0x2fa37c(0x1a7))['val'](ClientInternalMembers[SelectClientId][_0x2fa37c(0x1ac)]):$(_0x2fa37c(0x1a7))['val']($(_0x2fa37c(0x232))[_0x2fa37c(0x25e)]());$(_0x2fa37c(0x20e)+ClientInternalMembers[SelectClientId][_0x2fa37c(0x1ef)]+']')[_0x2fa37c(0x277)](_0x2fa37c(0x25d),_0x2fa37c(0x278)),$(_0x2fa37c(0x1ca)+ClientInternalMembers[SelectClientId][_0x2fa37c(0x253)]+']')[_0x2fa37c(0x277)](_0x2fa37c(0x25d),'true'),initializePeoplePicker(_0x2fa37c(0x1f9),!![]),peoplePickerDiv=$(_0x2fa37c(0x276)),initializePeoplePicker(_0x2fa37c(0x267),![]),peoplePickerDivsuper=$(_0x2fa37c(0x217));for(var _0x2ae1d2=0x0;_0x2ae1d2<ClientInternalMembers[SelectClientId][_0x2fa37c(0x1b1)]['results'][_0x2fa37c(0x289)];_0x2ae1d2++){setPeoplePickerUsersInfoCurrent(_0x2fa37c(0x21f),ClientInternalMembers[SelectClientId][_0x2fa37c(0x1b1)]['results'][_0x2ae1d2]['EMail']);}setPeoplePickerUsersInfoCurrent(_0x2fa37c(0x25f),ClientInternalMembers[SelectClientId][_0x2fa37c(0x1a9)][_0x2fa37c(0x1f1)]),$(_0x2fa37c(0x271))[_0x2fa37c(0x277)](_0x2fa37c(0x265),'false'),$(_0x2fa37c(0x28c))[_0x2fa37c(0x277)](_0x2fa37c(0x27e),_0x2fa37c(0x27e)),$(_0x2fa37c(0x235))[_0x2fa37c(0x277)](_0x2fa37c(0x27e),_0x2fa37c(0x27e)),$(peoplePickerDiv)[_0x2fa37c(0x1e9)](_0x2fa37c(0x1da))[_0x2fa37c(0x237)]('display',_0x2fa37c(0x23b)),$(peoplePickerDivsuper)[_0x2fa37c(0x1e9)](_0x2fa37c(0x1da))['css'](_0x2fa37c(0x25a),_0x2fa37c(0x23b));}var ClientInternalMembers=[];function GetClientMasterTeamDeails(){var _0x3e27c2=a24_0x489d;Taskusers=[],RestQuery=_0x3e27c2(0x258),$[_0x3e27c2(0x260)](CommonFunction[_0x3e27c2(0x1b2)](_0x3e27c2(0x24b),RestQuery))['done'](function(_0x18766a){var _0x23b4cc=_0x3e27c2,_0x52ffda;IsNotTeamMember='';debugger;var _0x2b5f66='';for(var _0x59e8b9=0x0;_0x59e8b9<_0x18766a['results']['length'];_0x59e8b9++){_0x52ffda=[],_0x52ffda=_0x18766a[_0x23b4cc(0x20f)][_0x59e8b9];var _0x39977f=_0x52ffda[_0x23b4cc(0x287)]='true'?_0x52ffda[_0x23b4cc(0x287)]:'Active';_0x2b5f66+=_0x23b4cc(0x255)+_0x23b4cc(0x1d7)+_0x23b4cc(0x229)+_0x23b4cc(0x256)+_0x59e8b9+_0x23b4cc(0x294)+_0x59e8b9+'\x22></label>'+_0x23b4cc(0x26b)+_0x23b4cc(0x296)+'<td\x20class=\x22text-left\x22>'+_0x23b4cc(0x21a)+_0x52ffda[_0x23b4cc(0x1be)]+'</span>'+_0x23b4cc(0x296)+_0x23b4cc(0x1d7)+_0x23b4cc(0x21a)+_0x52ffda[_0x23b4cc(0x28b)]+_0x23b4cc(0x29e)+'</td>'+_0x23b4cc(0x1d7)+_0x23b4cc(0x224)+_0x52ffda['Attn_Name']+_0x23b4cc(0x29e)+'</td>'+_0x23b4cc(0x1d7)+_0x23b4cc(0x21a)+_0x39977f+'</span>'+_0x23b4cc(0x296)+_0x23b4cc(0x1c9),ClientInternalMembers[_0x23b4cc(0x247)]({'Title':_0x52ffda[_0x23b4cc(0x28b)],'Client_Code':_0x52ffda[_0x23b4cc(0x1be)],'Attn_Name':_0x52ffda[_0x23b4cc(0x1e6)],'Supervisor':_0x52ffda['Supervisor']['EMail'],'SelfCompany':_0x52ffda[_0x23b4cc(0x1e4)],'IsActive':_0x52ffda[_0x23b4cc(0x287)],'CustType':_0x52ffda[_0x23b4cc(0x1ef)],'TemplateType':_0x52ffda[_0x23b4cc(0x253)],'InternalMembers':_0x52ffda[_0x23b4cc(0x1b1)],'InternalSupervisor':_0x52ffda[_0x23b4cc(0x1a9)],'ID':_0x52ffda['Id']});}GenarateclientGrid(_0x2b5f66);});}function selectOnlyThis(_0x267b70){var _0x4895bb=a24_0x489d;SelectClientId='',SelectClientId=_0x267b70[_0x4895bb(0x26a)]('_')[0x1],$('input:checkbox')['not'](this)[_0x4895bb(0x1d3)](_0x4895bb(0x280),![]),document['getElementById'](_0x267b70)[_0x4895bb(0x280)]=!![];}$(document)['ready'](function(){var _0x34b91c=a24_0x489d;$('#selectByUser')['on']('change',function(){var _0x491dfb=a24_0x489d,_0x49756b=$(this)['find'](_0x491dfb(0x1d2))['val']();if(_0x49756b==_0x491dfb(0x20d))$(_0x491dfb(0x1c4))['removeClass'](_0x491dfb(0x214)),$(_0x491dfb(0x1c4))[_0x491dfb(0x22e)](_0x491dfb(0x1d6)),$(_0x491dfb(0x1af))[_0x491dfb(0x1f5)]('d-none'),$(_0x491dfb(0x1af))[_0x491dfb(0x22e)](_0x491dfb(0x214));else _0x49756b==_0x491dfb(0x1c1)&&($('#Customer-box')[_0x491dfb(0x1f5)](_0x491dfb(0x1d6)),$('#Customer-box')[_0x491dfb(0x22e)]('d-block'),$(_0x491dfb(0x1af))[_0x491dfb(0x1f5)](_0x491dfb(0x214)),$(_0x491dfb(0x1af))[_0x491dfb(0x22e)]('d-none'));}),$(_0x34b91c(0x232))['focusout'](function(){var _0xa1f0eb=_0x34b91c;email=$(_0xa1f0eb(0x232))[_0xa1f0eb(0x25e)]();var _0x309f10=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/igm;if(_0x309f10[_0xa1f0eb(0x1c5)](email)){$(_0xa1f0eb(0x24c))[_0xa1f0eb(0x22f)](),$(_0xa1f0eb(0x1e0))[_0xa1f0eb(0x22f)](),$[_0xa1f0eb(0x260)](GetItemToListchoice(),GetItemToList(email))[_0xa1f0eb(0x19d)](function(_0x4acced,_0xf030b){var _0x3a4a56=_0xa1f0eb;if(_0xf030b['length']>0x0){var _0x27a2a3=GetUserName($(_0x3a4a56(0x232))[_0x3a4a56(0x25e)]());_0x27a2a3==''&&(GroupId==''&&GetGroupIDByGroupName(),$['when'](AddUserinSharePointGroupforEdit($(_0x3a4a56(0x232))[_0x3a4a56(0x25e)]()))[_0x3a4a56(0x19d)](function(_0x16de9d){var _0x5492f3=_0x3a4a56;if(_0x16de9d==''){cleartextBox(),$(_0x5492f3(0x227))[_0x5492f3(0x22f)](),$('#UpdateEmp-box-2')[_0x5492f3(0x201)](_0x5492f3(0x1b9));var _0x3a5999=0x2;return $(_0x5492f3(0x1d8)+_0x3a5999+']')['prop'](_0x5492f3(0x280),!![]),alert(_0x5492f3(0x22b)),![];}else _0x27a2a3=_0x16de9d[_0x5492f3(0x28b)];}));if(_0xf030b[0x0][_0x3a4a56(0x202)][_0x3a4a56(0x20f)][_0x3a4a56(0x289)]>0x0){var _0x4b9ae6=_0xf030b[0x0]['AttachmentFiles'][_0x3a4a56(0x20f)][0x0]['ServerRelativeUrl'];$(_0x3a4a56(0x230))[_0x3a4a56(0x277)](_0x3a4a56(0x19e),_0x4b9ae6);}else $(_0x3a4a56(0x230))[_0x3a4a56(0x277)](_0x3a4a56(0x19e),'https://cdn.jsdelivr.net/gh/Titan4workGit/TitanRepo@latest/SiteAssets/Titan-External-Employee-Portal/images/user_pic.jpg');IsUpdate=!![],userListItemId=_0xf030b[0x0]['Id'],initializePeoplePicker('InternalStakeholders',!![]),peoplePickerDiv=$('[id$=\x27InternalStakeholders_TopSpan\x27]'),initializePeoplePicker(_0x3a4a56(0x267),![]),peoplePickerDivsuper=$(_0x3a4a56(0x217));for(var _0x356aa4=0x0;_0x356aa4<_0xf030b[0x0][_0x3a4a56(0x1f9)][_0x3a4a56(0x20f)][_0x3a4a56(0x289)];_0x356aa4++){setPeoplePickerUsersInfoCurrent(_0x3a4a56(0x21f),_0xf030b[0x0]['InternalStakeholders'][_0x3a4a56(0x20f)][_0x356aa4][_0x3a4a56(0x1f1)]);}setPeoplePickerUsersInfoCurrent(_0x3a4a56(0x25f),_0xf030b[0x0][_0x3a4a56(0x1ac)]['EMail']),$(_0x3a4a56(0x28c))[_0x3a4a56(0x277)](_0x3a4a56(0x27e),_0x3a4a56(0x27e)),$(_0x3a4a56(0x235))[_0x3a4a56(0x277)](_0x3a4a56(0x27e),'disabled'),$(peoplePickerDiv)['find']('.sp-peoplepicker-delImage')[_0x3a4a56(0x237)](_0x3a4a56(0x25a),_0x3a4a56(0x23b)),$(peoplePickerDivsuper)['find'](_0x3a4a56(0x1da))[_0x3a4a56(0x237)](_0x3a4a56(0x25a),_0x3a4a56(0x23b)),$('#btnExtUpdate')[_0x3a4a56(0x201)](),$(_0x3a4a56(0x233))['empty']();for(var _0x356aa4=0x0;_0x356aa4<_0x4acced[_0x3a4a56(0x289)];_0x356aa4++){var _0x59c1cf=$(_0x3a4a56(0x295));_0x59c1cf[_0x3a4a56(0x277)](_0x3a4a56(0x1d1),_0x4acced[_0x356aa4])['text'](_0x4acced[_0x356aa4]),$(_0x3a4a56(0x233))[_0x3a4a56(0x1c2)](_0x59c1cf);}$('#txtExtLoginName')[_0x3a4a56(0x25e)](_0x27a2a3),$('#txtExtDesignation')['val'](_0xf030b[0x0]['Designation']),$(_0x3a4a56(0x1a7))[_0x3a4a56(0x25e)](_0xf030b[0x0]['External_Supervisor']),$(_0x3a4a56(0x234))[_0x3a4a56(0x25e)](_0xf030b[0x0][_0x3a4a56(0x1c7)]),$(_0x3a4a56(0x222))[_0x3a4a56(0x25e)](_0xf030b[0x0][_0x3a4a56(0x236)]),$(_0x3a4a56(0x215))[_0x3a4a56(0x25e)](_0xf030b[0x0][_0x3a4a56(0x291)]['Title']),Client_Id=_0xf030b[0x0][_0x3a4a56(0x291)]['Id'],$('#txtReferenceCodeExt')['val'](_0xf030b[0x0][_0x3a4a56(0x1bd)]),$(_0x3a4a56(0x1ca)+_0xf030b[0x0][_0x3a4a56(0x253)]+']')[_0x3a4a56(0x277)]('selected',_0x3a4a56(0x278)),$(_0x3a4a56(0x1c8))['val']($[_0x3a4a56(0x1fc)][_0x3a4a56(0x1fa)]('d\x20M,\x20y',new Date(_0xf030b[0x0][_0x3a4a56(0x26e)]))),$('#selectByUser\x20>\x20[value='+_0xf030b[0x0][_0x3a4a56(0x1e2)]+']')[_0x3a4a56(0x277)]('selected',_0x3a4a56(0x278)),$(_0x3a4a56(0x1dd))[_0x3a4a56(0x22f)]();}else IsUpdate=![],$(_0x3a4a56(0x1b6))[_0x3a4a56(0x25e)](''),$('#txtExtDesignation')[_0x3a4a56(0x25e)](''),$('#txtExtOrganizationName')[_0x3a4a56(0x25e)](''),$('#txtReferenceCodeExt')['val'](''),$(_0x3a4a56(0x1d2),$('#TemplateType'))[_0x3a4a56(0x25e)](''),$(_0x3a4a56(0x1c8))[_0x3a4a56(0x25e)]($[_0x3a4a56(0x1fc)][_0x3a4a56(0x1fa)]('d\x20M,\x20y',new Date())),$(_0x3a4a56(0x1d2),$('#selectByUser'))[_0x3a4a56(0x25e)](),$(_0x3a4a56(0x1d2),$(_0x3a4a56(0x23f)))['val'](),$(_0x3a4a56(0x1b4))[_0x3a4a56(0x22f)](),$(_0x3a4a56(0x230))['attr']('src',_0x3a4a56(0x263)),$(_0x3a4a56(0x290))[_0x3a4a56(0x277)](_0x3a4a56(0x19e),_0x3a4a56(0x263)),initializePeoplePicker(_0x3a4a56(0x1f9),!![]),peoplePickerDiv=$('[id$=\x27InternalStakeholders_TopSpan\x27]'),initializePeoplePicker('internalsupervisor',![]),peoplePickerDivsuper=$('[id$=\x27internalsupervisor_TopSpan\x27]');});if(!IsUpdate)$[_0xa1f0eb(0x260)](GetGueastUsers(email))['done'](function(_0x22c4f5){var _0x5e6093=_0xa1f0eb;_0x22c4f5[_0x5e6093(0x289)]>0x0?(_0x22c4f5[0x0][_0x5e6093(0x210)]==_0x5e6093(0x1cd)&&($(_0x5e6093(0x1dd))[_0x5e6093(0x201)](),$(_0x5e6093(0x1e0))[_0x5e6093(0x22f)](),$(_0x5e6093(0x1b6))[_0x5e6093(0x25e)](_0x22c4f5[0x0][_0x5e6093(0x218)])),_0x22c4f5[0x0][_0x5e6093(0x210)]==_0x5e6093(0x244)&&($(_0x5e6093(0x1e0))[_0x5e6093(0x225)](_0x5e6093(0x1f4)),$('#msgExtEmail')[_0x5e6093(0x201)](),$(_0x5e6093(0x1dd))[_0x5e6093(0x22f)]())):($(_0x5e6093(0x1e0))[_0x5e6093(0x225)]('Send\x20invitation\x20to\x20this\x20guest\x20user\x20first.'),$(_0x5e6093(0x1e0))[_0x5e6093(0x201)](),$(_0x5e6093(0x1dd))[_0x5e6093(0x22f)]());});else{}}else $('.msg')[_0xa1f0eb(0x22f)](),$(_0xa1f0eb(0x1bf))[_0xa1f0eb(0x201)](),$(_0xa1f0eb(0x1e0))[_0xa1f0eb(0x22f)](),$(_0xa1f0eb(0x1dd))[_0xa1f0eb(0x22f)]();}),$(_0x34b91c(0x1dd))[_0x34b91c(0x24e)](function(){AddNewGuest();}),$(_0x34b91c(0x1b4))[_0x34b91c(0x24e)](function(){UpdateGeustuser(userListItemId);}),$(_0x34b91c(0x290))['change'](function(){readURL(this);}),$('#btnotherOrganizationSearch')['click'](function(){try{}catch(_0x3f8d6c){alert(_0x3f8d6c);}});});