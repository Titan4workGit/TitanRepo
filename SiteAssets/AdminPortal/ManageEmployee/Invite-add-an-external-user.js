var _0x4af0b5=_0xc6a6;(function(_0x52542b,_0x173bf0){var _0x45ea9f=_0xc6a6,_0x8b1225=_0x52542b();while(!![]){try{var _0x5a1e82=parseInt(_0x45ea9f(0x1ad))/0x1*(parseInt(_0x45ea9f(0x22e))/0x2)+parseInt(_0x45ea9f(0x273))/0x3+parseInt(_0x45ea9f(0x234))/0x4*(parseInt(_0x45ea9f(0x1ca))/0x5)+-parseInt(_0x45ea9f(0x1f7))/0x6+-parseInt(_0x45ea9f(0x1c3))/0x7*(parseInt(_0x45ea9f(0x237))/0x8)+parseInt(_0x45ea9f(0x188))/0x9*(-parseInt(_0x45ea9f(0x262))/0xa)+-parseInt(_0x45ea9f(0x231))/0xb*(-parseInt(_0x45ea9f(0x1b3))/0xc);if(_0x5a1e82===_0x173bf0)break;else _0x8b1225['push'](_0x8b1225['shift']());}catch(_0x406fac){_0x8b1225['push'](_0x8b1225['shift']());}}}(_0x4aab,0xed198));var token,peoplePickerDiv='',peoplePickerDivsuper='',GroupId='',email='',IsUpdate=![],userListItemId='',GuestUserEmail='',UserListId=[],Client_Id;function initializePeoplePicker(_0x36c6e8,_0xee9f88){var _0x2ea92b=_0xc6a6,_0xc31eff={};_0xc31eff['PrincipalAccountType']=_0x2ea92b(0x1bc),_0xc31eff['SearchPrincipalSource']=0xf,_0xc31eff[_0x2ea92b(0x1d8)]=0xf,_0xc31eff[_0x2ea92b(0x1f3)]=_0xee9f88,_0xc31eff[_0x2ea92b(0x232)]=0x32,_0xc31eff['Width']='251px',this['SPClientPeoplePicker_InitStandaloneControlWrapper'](_0x36c6e8,null,_0xc31eff),$(_0x2ea92b(0x204))[_0x2ea92b(0x1d5)](0xfa);}$(function(){var _0x337e12=_0xc6a6;$('#datepickerAD5')[_0x337e12(0x1b5)]({'changeMonth':!![],'changeYear':!![]});});function GetGueastEmployee(_0x1cf677){var _0x2b26c9=_0xc6a6,_0xec3991=_0x2b26c9(0x194)+_0x1cf677+'\x27';return DeferredObj=$[_0x2b26c9(0x1e8)](),$[_0x2b26c9(0x243)]({'method':_0x2b26c9(0x24e),'url':_0xec3991,'headers':{'Authorization':_0x2b26c9(0x25b)+token,'Content-Type':_0x2b26c9(0x17b)},'async':![],'success':function(_0x5cb6e6){var _0x2abdf0=_0x2b26c9;DeferredObj[_0x2abdf0(0x18a)](_0x5cb6e6[_0x2abdf0(0x1ea)]);},'error':function(_0x20dd31){var _0x558115=_0x2b26c9;DeferredObj[_0x558115(0x1e9)](_0x20dd31),alert(_0x558115(0x260)+JSON['stringify'](_0x20dd31));}}),DeferredObj['promise']();}function GetGueastUsers(_0x40fbf6){var _0x443686=_0xc6a6,_0x55aba8=_0x443686(0x1f5)+_0x40fbf6+'\x27';return DeferredObj=$['Deferred'](),$[_0x443686(0x243)]({'method':'GET','url':_0x55aba8,'headers':{'Authorization':_0x443686(0x25b)+token,'Content-Type':'application/json'},'async':![],'success':function(_0xc42705){var _0x5badce=_0x443686;DeferredObj[_0x5badce(0x18a)](_0xc42705[_0x5badce(0x1ea)]);},'error':function(_0x38e8d8){var _0xcc77d9=_0x443686;DeferredObj[_0xcc77d9(0x1e9)](_0x38e8d8),alert(_0xcc77d9(0x260)+JSON['stringify'](_0x38e8d8));}}),DeferredObj['promise']();}function GetCategoryMaster(){var _0xc84ceb=_0xc6a6,_0x1db94f=_0xc84ceb(0x239),_0x58a860=_spPageContextInfo['webAbsoluteUrl']+_0xc84ceb(0x183)+_0x1db94f+_0xc84ceb(0x1e7);$[_0xc84ceb(0x243)]({'url':_0x58a860,'headers':{'Accept':_0xc84ceb(0x1df)},'async':![],'success':function(_0x316623){var _0x5b4677=_0xc84ceb,_0x220289=document[_0x5b4677(0x176)]('selectByUser');_0x220289[_0x5b4677(0x23a)]='';for(var _0x32bd9a=0x0;_0x32bd9a<_0x316623['d'][_0x5b4677(0x195)][_0x5b4677(0x192)];_0x32bd9a++){var _0x162c09=_0x316623['d'][_0x5b4677(0x195)][_0x32bd9a]['CatogeryName'],_0x12d40f=_0x316623['d'][_0x5b4677(0x195)][_0x32bd9a][_0x5b4677(0x1f2)];opt=document['createElement'](_0x5b4677(0x1ae)),opt[_0x5b4677(0x1ea)]=_0x12d40f,opt[_0x5b4677(0x181)]=_0x162c09,_0x220289[_0x5b4677(0x1b8)](opt);}},'error':function(_0x430590){var _0x30f62f=_0xc84ceb;console[_0x30f62f(0x19d)](_0x430590);}});}function GetUserId(_0x5e2ba7){var _0x29ef00=_0xc6a6,_0x4b96ae='',_0x331498=_0x29ef00(0x271),_0x4c46e9=_spPageContextInfo[_0x29ef00(0x209)],_0x2f6513=_0x331498+_0x5e2ba7;return $[_0x29ef00(0x243)]({'url':_0x4c46e9+_0x29ef00(0x225)+encodeURIComponent(_0x2f6513)+'\x27','method':_0x29ef00(0x24e),'headers':{'Accept':_0x29ef00(0x17f)},'async':![],'success':function(_0x2a669b){_0x4b96ae=_0x2a669b['d']['Id'];},'error':function(_0x38962a){var _0x2e0a99=_0x29ef00;console[_0x2e0a99(0x19d)](JSON[_0x2e0a99(0x1a0)](_0x38962a));}}),_0x4b96ae;}function GetUserName(_0x5df8ee){var _0x2e0004=_0xc6a6,_0x18d1a7='',_0x401608=_0x2e0004(0x271),_0x2f3eba=_spPageContextInfo['siteAbsoluteUrl'],_0x5e3e26=_0x401608+_0x5df8ee;return $[_0x2e0004(0x243)]({'url':_0x2f3eba+'/_api/web/siteusers(@v)?@v=\x27'+encodeURIComponent(_0x5e3e26)+'\x27','method':_0x2e0004(0x24e),'headers':{'Accept':'application/json;\x20odata=verbose'},'async':![],'success':function(_0x284da2){var _0x46e166=_0x2e0004;_0x18d1a7=_0x284da2['d'][_0x46e166(0x21a)];},'error':function(_0x4220c0){var _0x41d055=_0x2e0004;console['log'](JSON[_0x41d055(0x1a0)](_0x4220c0));}}),_0x18d1a7;}function AddNewGuest(){var _0x30a592=_0xc6a6;try{var _0x1fa60c=_0x30a592(0x20c),_0x4ce1ae=SPClientPeoplePicker[_0x30a592(0x248)][peoplePickerDiv[0x0]['id']],_0x286b8a=_0x4ce1ae[_0x30a592(0x222)](),_0x3e8f4c=[];for(var _0x2f742d=0x0;_0x2f742d<_0x286b8a[_0x30a592(0x192)];_0x2f742d++){var _0x2020bc=GetUserId(_0x286b8a[_0x2f742d][_0x30a592(0x1e3)][_0x30a592(0x263)]);_0x3e8f4c[_0x30a592(0x191)](_0x2020bc),UserListId[_0x30a592(0x191)](_0x2020bc);}_0x4ce1ae=SPClientPeoplePicker[_0x30a592(0x248)][peoplePickerDivsuper[0x0]['id']],_0x286b8a=_0x4ce1ae[_0x30a592(0x222)]();var _0x4f0cae=GetUserId(_0x286b8a[0x0]['EntityData'][_0x30a592(0x263)]);UserListId['push'](_0x4f0cae);GroupId==''&&GetGroupIDByGroupName();AddUserinSharePointGroup($(_0x30a592(0x257))['val']());var _0x209165=GetUserId($('#txtExtEmail')[_0x30a592(0x25d)]());UserListId[_0x30a592(0x191)](_0x209165);var _0x289e70=_spPageContextInfo[_0x30a592(0x178)]+_0x30a592(0x221)+$(_0x30a592(0x26a))[_0x30a592(0x25d)]()[_0x30a592(0x21b)]()[_0x30a592(0x22c)](/ /g,'')+_0x30a592(0x20d),_0x27bb43,_0x4b8f71=GetItemTypeForListName(_0x1fa60c);_0x27bb43={'__metadata':{'type':_0x4b8f71},'LoginNameId':_0x209165,'Title':$(_0x30a592(0x257))[_0x30a592(0x25d)](),'email':$(_0x30a592(0x257))['val'](),'Designation':$(_0x30a592(0x19a))[_0x30a592(0x25d)](),'Organization':$(_0x30a592(0x26a))['val'](),'ReferenceCode':$(_0x30a592(0x197))['val'](),'TemplateType':$('option:selected',$(_0x30a592(0x177)))['val'](),'InternalStakeholdersId':{'results':_0x3e8f4c},'SupervisorId':_0x4f0cae,'Client_NameId':Client_Id,'External_Supervisor':$('#txtExternalSupervisor')[_0x30a592(0x25d)](),'ValidUpto':$('#datepickerAD5')[_0x30a592(0x25d)](),'CollaborationType':$('option:selected',$(_0x30a592(0x18f)))['val'](),'Status':$(_0x30a592(0x1a3),$('#txtExtStatus'))['val'](),'DocumentLibrary':_0x289e70},AddItemToList(_0x1fa60c,_0x27bb43,UserListId);}catch(_0x247314){console[_0x30a592(0x19d)](_0x247314[_0x30a592(0x1a2)]);}}function cleartextBox(){var _0x479aa1=_0xc6a6;$(_0x479aa1(0x1e4))[_0x479aa1(0x25d)](''),$(_0x479aa1(0x257))['val'](''),$(_0x479aa1(0x19a))['val'](''),$(_0x479aa1(0x197))[_0x479aa1(0x25d)](''),$(_0x479aa1(0x24b))[_0x479aa1(0x25d)](''),$(_0x479aa1(0x175))[_0x479aa1(0x185)](_0x479aa1(0x1d3),'https://raw.githubusercontent.com/Titan4workGit/TitanRepo/main/SiteAssets/AdminPortal/ManageEmployee/assets/images/user_pic.jpg'),initializePeoplePicker('InternalStakeholders',!![]),peoplePickerDiv=$(_0x479aa1(0x1b9)),initializePeoplePicker(_0x479aa1(0x25e),![]),peoplePickerDivsuper=$(_0x479aa1(0x216));}function AddItemToList(_0x208f6d,_0x556e22,_0x5c4b13){var _0x787bf5=_0xc6a6,_0xaa17ab=$[_0x787bf5(0x1e8)]();return $[_0x787bf5(0x243)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x787bf5(0x1d1)+_0x208f6d+'\x27)/items','type':'POST','async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$('#__REQUESTDIGEST')['val'](),'content-Type':'application/json;odata=verbose'},'data':JSON[_0x787bf5(0x1a0)](_0x556e22),'success':function(_0x3415e8){var _0x41b7c3=_0x787bf5;if(document[_0x41b7c3(0x176)](_0x41b7c3(0x1c9))[_0x41b7c3(0x270)]['length']===0x0){}else UploadAttachement(_0x3415e8['d']['ID']);console[_0x41b7c3(0x19d)](_0x3415e8),IsExistOrNotLibrary($(_0x41b7c3(0x26a))[_0x41b7c3(0x25d)]()['trim']()[_0x41b7c3(0x22c)](/ /g,''))?AssignTheEditRole($(_0x41b7c3(0x26a))[_0x41b7c3(0x25d)]()[_0x41b7c3(0x21b)]()[_0x41b7c3(0x22c)](/ /g,''),_0x5c4b13):(createNewLibraryByRest($(_0x41b7c3(0x26a))['val']()[_0x41b7c3(0x21b)]()['replace'](/ /g,'')),AssignTheEditRole($(_0x41b7c3(0x26a))[_0x41b7c3(0x25d)]()[_0x41b7c3(0x21b)]()[_0x41b7c3(0x22c)](/ /g,''),_0x5c4b13)),alert(_0x41b7c3(0x1e5)),cleartextBox();},'error':function(_0x4f7661){var _0x55a026=_0x787bf5;console[_0x55a026(0x19d)](JSON[_0x55a026(0x1a0)](_0x4f7661)),_0xaa17ab[_0x55a026(0x1e9)](_0x4f7661);}}),_0xaa17ab[_0x787bf5(0x18d)]();}function _0xc6a6(_0x393aa1,_0xc6341b){var _0x4aab7d=_0x4aab();return _0xc6a6=function(_0xc6a6d,_0xac01ff){_0xc6a6d=_0xc6a6d-0x173;var _0x126adb=_0x4aab7d[_0xc6a6d];return _0x126adb;},_0xc6a6(_0x393aa1,_0xc6341b);}function UpdateGeustuser(_0x4976bf){var _0x36c313=_0xc6a6,_0x469bd1=_0x36c313(0x20c),_0x1c606b=SPClientPeoplePicker['SPClientPeoplePickerDict'][peoplePickerDiv[0x0]['id']],_0x5d2aa6=_0x1c606b[_0x36c313(0x222)](),_0x15ebb5=[];for(var _0x5634a3=0x0;_0x5634a3<_0x5d2aa6['length'];_0x5634a3++){var _0xeadf43=GetUserId(_0x5d2aa6[_0x5634a3][_0x36c313(0x1e3)][_0x36c313(0x263)]);_0x15ebb5[_0x36c313(0x191)](_0xeadf43),UserListId[_0x36c313(0x191)](_0xeadf43);}_0x1c606b=SPClientPeoplePicker['SPClientPeoplePickerDict'][peoplePickerDivsuper[0x0]['id']],_0x5d2aa6=_0x1c606b['GetAllUserInfo']();var _0x56eeba=GetUserId(_0x5d2aa6[0x0][_0x36c313(0x1e3)][_0x36c313(0x263)]);UserListId['push'](_0x56eeba);var _0x125d82=GetUserId($(_0x36c313(0x257))[_0x36c313(0x25d)]());UserListId[_0x36c313(0x191)](_0x125d82),GuestUserEmail=$(_0x36c313(0x257))[_0x36c313(0x25d)]();var _0x50ca37=_spPageContextInfo[_0x36c313(0x178)]+'/GuestUserDocuments/'+$(_0x36c313(0x26a))[_0x36c313(0x25d)]()[_0x36c313(0x21b)]()[_0x36c313(0x22c)](/ /g,'')+_0x36c313(0x20d);_0x125d82==''&&(GetGroupIDByGroupName(),AddUserinSharePointGroup($(_0x36c313(0x257))[_0x36c313(0x25d)]()));var _0x1a0a8d,_0x4fbfe9=GetItemTypeForListName(_0x469bd1);_0x1a0a8d={'__metadata':{'type':_0x4fbfe9},'Designation':$(_0x36c313(0x19a))[_0x36c313(0x25d)](),'LoginNameId':_0x125d82,'Organization':$(_0x36c313(0x26a))[_0x36c313(0x25d)](),'ReferenceCode':$(_0x36c313(0x197))['val'](),'TemplateType':$(_0x36c313(0x1a3),$(_0x36c313(0x177)))[_0x36c313(0x25d)](),'InternalStakeholdersId':{'results':_0x15ebb5},'SupervisorId':_0x56eeba,'Client_NameId':Client_Id,'ValidUpto':$('#datepickerAD5')[_0x36c313(0x25d)](),'CollaborationType':$(_0x36c313(0x1a3),$('#selectByUser'))[_0x36c313(0x25d)](),'Status':$(_0x36c313(0x1a3),$(_0x36c313(0x24f)))[_0x36c313(0x25d)](),'DocumentLibrary':_0x50ca37};var _0x33cc6a=$[_0x36c313(0x1e8)]();return $['ajax']({'url':_spPageContextInfo[_0x36c313(0x178)]+_0x36c313(0x183)+_0x469bd1+_0x36c313(0x22b)+_0x4976bf+')','type':_0x36c313(0x1ef),'async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x36c313(0x1b2))['val'](),'content-Type':_0x36c313(0x1df),'IF-MATCH':'*','X-HTTP-Method':_0x36c313(0x25f)},'data':JSON[_0x36c313(0x1a0)](_0x1a0a8d),'success':function(_0x5bff9f){var _0x210883=_0x36c313;if(document[_0x210883(0x176)]('GueastextinputFile')['files'][_0x210883(0x192)]===0x0){}else UploadAttachement(_0x4976bf);console[_0x210883(0x19d)](_0x5bff9f),IsExistOrNotLibrary($(_0x210883(0x26a))[_0x210883(0x25d)]()['trim']()['replace'](/ /g,''))?AssignTheEditRole($('#txtAddOrganization')[_0x210883(0x25d)]()[_0x210883(0x21b)]()[_0x210883(0x22c)](/ /g,''),UserListId):(createNewLibraryByRest($(_0x210883(0x26a))[_0x210883(0x25d)]()[_0x210883(0x21b)]()['replace'](/ /g,'')),AssignTheEditRole($(_0x210883(0x26a))['val']()[_0x210883(0x21b)]()['replace'](/ /g,''),UserListId)),alert(_0x210883(0x218));},'error':function(_0x456ba7){var _0x47f860=_0x36c313;console['log'](JSON['stringify'](_0x456ba7)),_0x33cc6a[_0x47f860(0x1e9)](_0x456ba7);}}),_0x33cc6a['promise']();}function GetItemToList(_0x4608e7){var _0x251877=_0xc6a6,_0x19f374='ExternalUsers',_0x16bc9d=$[_0x251877(0x1e8)]();return $[_0x251877(0x243)]({'url':_spPageContextInfo[_0x251877(0x178)]+_0x251877(0x1d1)+_0x19f374+_0x251877(0x249)+_0x4608e7+'\x27','type':_0x251877(0x1fb),'async':![],'headers':{'accept':_0x251877(0x1df),'X-RequestDigest':$(_0x251877(0x1b2))[_0x251877(0x25d)](),'content-Type':'application/json;odata=verbose'},'success':function(_0x928c5a){var _0x4812d9=_0x251877;_0x16bc9d['resolve'](_0x928c5a['d'][_0x4812d9(0x195)]),console[_0x4812d9(0x19d)](_0x928c5a);},'error':function(_0x2935c7){var _0x56606f=_0x251877;console[_0x56606f(0x19d)](JSON[_0x56606f(0x1a0)](_0x2935c7)),_0x16bc9d[_0x56606f(0x1e9)](_0x2935c7);}}),_0x16bc9d[_0x251877(0x18d)]();}function GetItemToListchoice(){var _0x3d3e9f=_0xc6a6,_0x1fc988=_0x3d3e9f(0x20c),_0xe301d5=$[_0x3d3e9f(0x1e8)]();return $['ajax']({'url':_spPageContextInfo[_0x3d3e9f(0x178)]+_0x3d3e9f(0x1d1)+_0x1fc988+_0x3d3e9f(0x174),'type':_0x3d3e9f(0x1fb),'async':![],'headers':{'accept':_0x3d3e9f(0x1df),'X-RequestDigest':$(_0x3d3e9f(0x1b2))['val'](),'content-Type':_0x3d3e9f(0x1df)},'success':function(_0x49f34d){var _0x5a2839=_0x3d3e9f;_0xe301d5['resolve'](_0x49f34d['d']['results'][0x0][_0x5a2839(0x23d)][_0x5a2839(0x195)]),console[_0x5a2839(0x19d)](_0x49f34d);},'error':function(_0x101290){var _0x1e07e5=_0x3d3e9f;console[_0x1e07e5(0x19d)](JSON[_0x1e07e5(0x1a0)](_0x101290)),_0xe301d5[_0x1e07e5(0x1e9)](_0x101290);}}),_0xe301d5[_0x3d3e9f(0x18d)]();}function GetItemToClientMaster(){var _0x4f9a45=_0xc6a6,_0x29605d='ClientMaster',_0x143234=$[_0x4f9a45(0x1e8)]();return $[_0x4f9a45(0x243)]({'url':_spPageContextInfo[_0x4f9a45(0x178)]+_0x4f9a45(0x1d1)+_0x29605d+'\x27)/items?$select=*','type':_0x4f9a45(0x1fb),'async':![],'headers':{'accept':_0x4f9a45(0x1df),'X-RequestDigest':$(_0x4f9a45(0x1b2))[_0x4f9a45(0x25d)](),'content-Type':_0x4f9a45(0x1df)},'success':function(_0x596ab3){var _0x17a9ca=_0x4f9a45;_0x143234['resolve'](_0x596ab3['d'][_0x17a9ca(0x195)]),console['log'](_0x596ab3);},'error':function(_0x299051){var _0x1b04d0=_0x4f9a45;console['log'](JSON[_0x1b04d0(0x1a0)](_0x299051)),_0x143234[_0x1b04d0(0x1e9)](_0x299051);}}),_0x143234['promise']();}function requestToken(){var _0x5bf9bb=_0xc6a6;$[_0x5bf9bb(0x243)]({'async':!![],'crossDomain':!![],'url':ClientUrl,'method':_0x5bf9bb(0x1ef),'headers':{'content-type':_0x5bf9bb(0x20b)},'data':{'grant_type':'client_credentials','client_id\x20':ClientId,'client_secret':ClentSecret,'scope\x20':'https://graph.microsoft.com/.default'},'success':function(_0x1d7781){var _0x5526be=_0x5bf9bb;console[_0x5526be(0x19d)](_0x1d7781),token=_0x1d7781[_0x5526be(0x1ff)];},'error':function(_0x17f99e){var _0x275cca=_0x5bf9bb;console[_0x275cca(0x19d)](JSON[_0x275cca(0x1a0)](_0x17f99e));}});}function ClientCredentialss(){var _0x3c967f=_0xc6a6,_0x10531c=_0x3c967f(0x1d9),_0xaa11d7=_spPageContextInfo['webAbsoluteUrl']+_0x3c967f(0x183)+_0x10531c+_0x3c967f(0x24c);$['ajax']({'url':_0xaa11d7,'headers':{'Accept':_0x3c967f(0x1df)},'async':![],'success':function(_0x349f97){var _0x5436ca=_0x3c967f,_0x5a4e2e=_0x349f97['d'][_0x5436ca(0x195)];ClientId=_0x5a4e2e[0x0]['ClientName'],ClentSecret=_0x5a4e2e[0x0][_0x5436ca(0x265)],ClientUrl=_0x5a4e2e[0x0][_0x5436ca(0x203)],requestToken();},'error':function(_0x27afda){var _0x1cd256=_0x3c967f;console[_0x1cd256(0x19d)](_0x27afda);}});}function GraphAccessTokenTogetUserDetails(){var _0x269b83=_0xc6a6,_0x42ae90=new jQuery[(_0x269b83(0x1e8))](),_0x49f854={'X-RequestDigest':$('#__REQUESTDIGEST')[_0x269b83(0x25d)](),'accept':_0x269b83(0x233),'content-type':'application/json;odata=nometadata'},_0x288186={'resource':_0x269b83(0x268)};return $[_0x269b83(0x243)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x269b83(0x1a5),'headers':_0x49f854,'type':'POST','data':JSON['stringify'](_0x288186),'success':function(_0x4b2e7c){var _0x261b6d=_0x269b83;token=_0x4b2e7c[_0x261b6d(0x1ff)],token_=token,_0x42ae90[_0x261b6d(0x18a)](token);},'error':function(_0x317f4a,_0x4e7af0,_0x6c94dd){var _0x3f4b7c=_0x269b83;console[_0x3f4b7c(0x19d)](_0x317f4a[_0x3f4b7c(0x1b1)]),_0x42ae90[_0x3f4b7c(0x1e9)](_0x317f4a['responseText']);}}),_0x42ae90['promise']();}var Errorcount=0x1,Ischeckerror=![];function Inviteuser(){var _0x7476c8=_0xc6a6,_0x5b6ea3=$(_0x7476c8(0x205))['val'](),_0x37de90=$('#txtinvitename')[_0x7476c8(0x25d)](),_0x492f66=$(_0x7476c8(0x1c5))[_0x7476c8(0x25d)]();Errorcount=0x1,$['ajax']({'url':_0x7476c8(0x266),'type':_0x7476c8(0x1ef),'headers':{'Authorization':_0x7476c8(0x25b)+token,'content-type':_0x7476c8(0x17b)},'data':JSON[_0x7476c8(0x1a0)]({'invitedUserDisplayName':_0x37de90,'invitedUserEmailAddress':_0x5b6ea3,'inviteRedirectUrl':_spPageContextInfo['webAbsoluteUrl']+_0x7476c8(0x25c),'sendInvitationMessage':!![],'invitedUserMessageInfo':{'customizedMessageBody':_0x492f66}}),'async':![],'success':function(_0x1a5f3c){var _0x1755e2=_0x7476c8;console['log'](_0x1a5f3c),$(_0x1755e2(0x205))[_0x1755e2(0x25d)](''),$(_0x1755e2(0x250))[_0x1755e2(0x25d)](''),$(_0x1755e2(0x1c5))[_0x1755e2(0x25d)]('');GroupId==''&&GetGroupIDByGroupName();GuestUserEmail=_0x1a5f3c[_0x1755e2(0x23b)];try{$[_0x1755e2(0x1bd)](AddUserinSharePointGroup(_0x1a5f3c[_0x1755e2(0x23b)]))[_0x1755e2(0x23c)](function(_0x5d8d4a){var _0x37f955=_0x1755e2;Ischeckerror=![],_0x5d8d4a=='User\x20Added'?alert(_0x37f955(0x1a1)):alert(_0x37f955(0x17e));});}catch(_0x48b730){alert(_0x1755e2(0x17e));}},'error':function(_0x1d6b4c){var _0x2018f5=_0x7476c8;_0x1d6b4c[_0x2018f5(0x223)]==_0x2018f5(0x261)?alert(_0x1d6b4c[_0x2018f5(0x223)]+_0x2018f5(0x217)):(alert(_0x2018f5(0x26b)),console[_0x2018f5(0x19d)](JSON[_0x2018f5(0x1a0)](_0x1d6b4c)));}}),Ischeckerror&&alert(_0x7476c8(0x17e));}function setPeoplePickerUsersInfoCurrent(_0x293557,_0xdf935c){var _0x5581ea=_0xc6a6,_0x2fcfb8=$(_0x5581ea(0x18b)+_0x293557+'\x27]'),_0x5b0873=SPClientPeoplePicker[_0x5581ea(0x248)][_0x2fcfb8[0x0]['id']];_0x5b0873[_0x5581ea(0x21e)](_0xdf935c,![]),_0x5b0873[_0x5581ea(0x1ce)](![]);}function readURL(_0x20cfe7){var _0x4a9c38=_0xc6a6;if(_0x20cfe7[_0x4a9c38(0x270)]&&_0x20cfe7[_0x4a9c38(0x270)][0x0]){var _0x38ce0a=new FileReader();_0x38ce0a[_0x4a9c38(0x259)]=function(_0x733f8f){var _0x454b04=_0x4a9c38;$('#extrenalImage')[_0x454b04(0x185)]('src',_0x733f8f[_0x454b04(0x254)][_0x454b04(0x1a6)]);},_0x38ce0a['readAsDataURL'](_0x20cfe7['files'][0x0]);}}function UploadAttachement(_0x1a611a){var _0x5486e0=_0xc6a6;try{if(document[_0x5486e0(0x176)](_0x5486e0(0x1c9))[_0x5486e0(0x270)]['length']===0x0){}else{var _0x2a0324=_0x1a611a,_0x4c5896=$('#GueastextinputFile'),_0x5cdf41=_0x4c5896[0x0]['files'][_0x5486e0(0x192)],_0x4edee6=[],_0xe6bd30=_0x4c5896[0x0]['files'][0x0][_0x5486e0(0x208)];_0xe6bd30=_0x4c5896[0x0][_0x5486e0(0x270)][0x0]['name'][_0x5486e0(0x22c)](/[^a-zA-Z0-9-. ]/g,''),_0xe6bd30=_0xe6bd30[_0x5486e0(0x22c)](/\s/g,'');for(var _0x163e4d=0x0;_0x163e4d<_0x5cdf41;_0x163e4d++){_0x4edee6['push'](_0x4c5896[0x0][_0x5486e0(0x270)][_0x163e4d]);}uploadFileSP(_0x5486e0(0x20c),_0x2a0324,_0x4edee6,_0x5cdf41,_0xe6bd30);}}catch(_0xb46725){alert('Your\x20item\x20has\x20not\x20been\x20submitted\x20successfully!');}}function getFileBuffer(_0x493ebe){var _0x5f502a=_0xc6a6,_0xf705e=$[_0x5f502a(0x1e8)](),_0x462ddf=new FileReader();return _0x462ddf['onload']=function(_0x468bf2){var _0x53b6a9=_0x5f502a;_0xf705e[_0x53b6a9(0x18a)](_0x468bf2[_0x53b6a9(0x254)][_0x53b6a9(0x1a6)]);},_0x462ddf[_0x5f502a(0x1c7)]=function(_0x4aefe3){var _0x306363=_0x5f502a;_0xf705e[_0x306363(0x1e9)](_0x4aefe3['target'][_0x306363(0x1b6)]);},_0x462ddf[_0x5f502a(0x241)](_0x493ebe),_0xf705e[_0x5f502a(0x18d)]();}function uploadFileSP(_0x17e16e,_0x49dba2,_0x3803df,_0x4f1537,_0x1c198e){var _0x3cfef9=_0xc6a6,_0x97eca1=0x0,_0x4355a9=$[_0x3cfef9(0x1e8)](),_0x3707d1='',_0x38bb5b=_0x3803df[0x0],_0x515c2f=getFileBuffer(_0x38bb5b);return _0x515c2f[_0x3cfef9(0x23c)](function(_0x20134e,_0x3e07d9,_0x34e617){var _0x100caa=_0x3cfef9,_0x159df3=new Uint8Array(_0x20134e),_0x56a209=new SP[(_0x100caa(0x20a))](),_0x18768c=_spPageContextInfo[_0x100caa(0x178)]+_0x100caa(0x1f6)+_0x17e16e+_0x100caa(0x22b)+_0x49dba2+')/AttachmentFiles/add(FileName=\x27'+_0x1c198e+'\x27)',_0x206a33=0x0;$[_0x100caa(0x243)]({'url':_0x18768c,'type':'POST','processData':![],'contentType':'application/json;odata=verbose','data':_0x20134e,'headers':{'accept':_0x100caa(0x1df),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x100caa(0x25d)](),'content-length':_0x20134e[_0x100caa(0x277)]},'success':function(_0x1f281a){var _0x543d2d=_0x100caa;_0x97eca1++,_0x3707d1=_0x97eca1,_0x3803df[_0x543d2d(0x1a9)]();if(_0x3803df[_0x543d2d(0x192)]>0x0)uploadFileSP(_0x543d2d(0x20c),_0x49dba2,_0x3803df,_0x3803df['length']);else{}},'error':function(_0x527b8d){var _0x18fe0f=_0x100caa;alert(_0x18fe0f(0x1f0));}}),_0x4355a9[_0x100caa(0x18a)](_0x3707d1);}),_0x515c2f['fail'](function(_0x581976){var _0x6d59c4=_0x3cfef9;_0x4355a9[_0x6d59c4(0x1e9)](_0x581976);}),_0x4355a9[_0x3cfef9(0x18d)]();}function GetGroupIDByGroupName(){var _0x2611b7=_0xc6a6,_0x4b0279=_spPageContextInfo[_0x2611b7(0x178)]+'/_api/web/sitegroups/getbyname(\x27Contributors\x27)?$select=id';$[_0x2611b7(0x243)]({'url':_0x4b0279,'method':'GET','async':![],'headers':{'Accept':'application/json;\x20odata=verbose'},'success':function(_0x313c7e){GroupId=_0x313c7e['d']['Id'];},'error':function(_0x5aeed8){var _0x2a8cca=_0x2611b7;console[_0x2a8cca(0x19d)](_0x5aeed8);}});}function AddUserToSiteGroup(_0x2f65de){var _0x3c6ff5=_0xc6a6;clientContext=new SP[(_0x3c6ff5(0x1cb))]();var _0x2e332b=clientContext['get_web']()['get_siteGroups']()['getByName']('Contributors'),_0xf79ef1=_0x2e332b[_0x3c6ff5(0x1ba)]();_0xf79ef1['addUser'](_0x2f65de),clientContext[_0x3c6ff5(0x211)](onsuccess,onfailed);}function onsuccess(){var _0x5da370=_0xc6a6;console[_0x5da370(0x19d)](_0x5da370(0x1cd));}function onfailed(_0x29c795,_0x4575dc){var _0x3ecfdb=_0xc6a6;console[_0x3ecfdb(0x19d)]('Failed'+_0x4575dc[_0x3ecfdb(0x1ec)]()+'\x0a'+_0x4575dc['get_stackTrace']());}function AddUserinSharePointGroup(_0x526d0a){var _0x5d1c3d=_0xc6a6,_0x30fcaf=$[_0x5d1c3d(0x1e8)](),_0x2acb5b=_0x5d1c3d(0x271),_0x5a9539=_0x2acb5b+_0x526d0a,_0x203319=_spPageContextInfo['webAbsoluteUrl']+_0x5d1c3d(0x200);$['ajax']({'url':_0x203319,'type':_0x5d1c3d(0x1ef),'async':![],'data':JSON[_0x5d1c3d(0x1a0)]({'__metadata':{'type':'SP.User'},'LoginName':_0x5a9539}),'headers':{'accept':_0x5d1c3d(0x1df),'content-type':_0x5d1c3d(0x1df),'X-RequestDigest':$(_0x5d1c3d(0x1b2))[_0x5d1c3d(0x25d)]()},'success':_0x22240c,'error':_0x2fbdd8});function _0x22240c(_0x30a735){var _0x47f09a=_0x5d1c3d;Ischeckerror=!![],_0x30fcaf[_0x47f09a(0x18a)](_0x47f09a(0x22f)),Errorcount=0x1,console[_0x47f09a(0x19d)](_0x47f09a(0x22f));}function _0x2fbdd8(_0x4e7bff){var _0x1ce197=_0x5d1c3d;console[_0x1ce197(0x19d)](JSON[_0x1ce197(0x1a0)](_0x4e7bff)),(_0x4e7bff[_0x1ce197(0x223)]==_0x1ce197(0x1cf)||_0x4e7bff['statusText']==_0x1ce197(0x1b6))&&Errorcount==0xa?_0x4e7bff[_0x1ce197(0x223)]==_0x1ce197(0x1b6)?alert(_0x1ce197(0x17e)):alert(_0x1ce197(0x26c)):(Errorcount++,AddUserinSharePointGroup(GuestUserEmail));}return _0x30fcaf['promise']();}function AddUserinSharePointGroupforEdit(_0x242a22){var _0xe97bf6=_0xc6a6,_0x2c07b5='',_0x14732d=_0xe97bf6(0x271),_0x12102f=_0x14732d+_0x242a22,_0x22b234=_spPageContextInfo[_0xe97bf6(0x178)]+'/_api/web/sitegroups('+GroupId+_0xe97bf6(0x240);$[_0xe97bf6(0x243)]({'url':_0x22b234,'type':_0xe97bf6(0x1ef),'async':![],'data':JSON['stringify']({'__metadata':{'type':'SP.User'},'LoginName':_0x12102f}),'headers':{'accept':_0xe97bf6(0x1df),'content-type':'application/json;odata=verbose','X-RequestDigest':$(_0xe97bf6(0x1b2))[_0xe97bf6(0x25d)]()},'success':_0x5d563,'error':_0x533d82});function _0x5d563(_0x19b7d3){var _0x18e2cb=_0xe97bf6;_0x2c07b5=_0x19b7d3['d'],console[_0x18e2cb(0x19d)]('User\x20Added');}function _0x533d82(_0x2649d7){var _0x363059=_0xe97bf6;console['log'](JSON[_0x363059(0x1a0)](_0x2649d7));}return _0x2c07b5;}function processSendEmails(_0x21f602,_0x42d5ad,_0x1cddbf){var _0x397cdf=_0xc6a6,_0x1327b3=[],_0x47e6e5=_0x397cdf(0x1eb)+_0x397cdf(0x1da)+_0x21f602+_0x397cdf(0x1d4)+'<p>Welcome\x20to\x20the\x20'+_0x42d5ad+_0x397cdf(0x19e)+_0x1cddbf+_0x397cdf(0x246)+_0x397cdf(0x210)+_0x397cdf(0x256)+_0x397cdf(0x1dd)+_0x397cdf(0x228)+_0x397cdf(0x219)+_0x397cdf(0x23f)+_0x397cdf(0x1b7)+_0x397cdf(0x22d)+_0x397cdf(0x1ed)+_0x397cdf(0x22a),_0x399627=_0x397cdf(0x1d6);_0x1327b3[_0x397cdf(0x191)](email);var _0x16d865=_spPageContextInfo[_0x397cdf(0x226)],_0x5851b0;_0x5851b0={'properties':{'__metadata':{'type':_0x397cdf(0x236)},'From':_0x16d865,'To':{'results':_0x1327b3},'Body':_0x47e6e5,'Subject':_0x399627}};var _0x3210c3={'properties':{'__metadata':{'type':_0x397cdf(0x236)},'From':'From:\x20no-reply@sharepointonline.com','To':{'results':_0x1327b3},'Body':_0x47e6e5,'Subject':_0x399627}},_0xc3b24c=_spPageContextInfo[_0x397cdf(0x1bb)]==='/'?'/':_spPageContextInfo[_0x397cdf(0x1bb)],_0x10b248=_0xc3b24c,_0x333097=_0x10b248+'/_api/SP.Utilities.Utility.SendEmail',_0x1d4fcd=_spPageContextInfo['webAbsoluteUrl']+'/_api/SP.Utilities.Utility.SendEmail';$[_0x397cdf(0x243)]({'contentType':'application/json','url':_0x1d4fcd,'type':_0x397cdf(0x1ef),'data':JSON[_0x397cdf(0x1a0)](_0x3210c3),'async':![],'headers':{'Accept':'application/json;odata=verbose','content-type':_0x397cdf(0x1df),'X-RequestDigest':$(_0x397cdf(0x1b2))[_0x397cdf(0x25d)]()},'success':function(_0x15dcbf){var _0x21f07e=_0x397cdf;console[_0x21f07e(0x19d)]('Message\x20has\x20been\x20sent.');},'error':function(_0x540677){var _0x33308d=_0x397cdf;console[_0x33308d(0x19d)]('SendEmailSharedNotification\x20\x20'+JSON['stringify'](_0x540677));}});}function sendEmail(_0x50268b,_0x255984,_0xee249e,_0x15432a){var _0x2703e6=_0xc6a6;Email['send']({'SecureToken':token,'To':_0x255984[0x0],'From':_0x50268b,'Subject':_0x15432a,'Body':_0xee249e})[_0x2703e6(0x199)](_0x20f178=>alert(_0x2703e6(0x275)));var _0x37229b=_spPageContextInfo['webServerRelativeUrl'],_0x4f1e85=_0x37229b+_0x2703e6(0x229);$[_0x2703e6(0x243)]({'contentType':'application/json','url':_0x4f1e85,'type':_0x2703e6(0x1ef),'data':JSON[_0x2703e6(0x1a0)]({'properties':{'__metadata':{'type':'SP.Utilities.EmailProperties'},'From':_0x50268b,'To':{'results':_0x255984},'Body':_0xee249e,'Subject':_0x15432a}}),'headers':{'Accept':_0x2703e6(0x1df),'content-type':_0x2703e6(0x1df),'X-RequestDigest':jQuery(_0x2703e6(0x1b2))[_0x2703e6(0x25d)]()},'success':function(_0x46c12e){var _0x58ddd5=_0x2703e6;alert(_0x58ddd5(0x193));},'error':function(_0x384396){var _0x5f46f2=_0x2703e6;alert('Error\x20in\x20sending\x20Email:\x20'+JSON[_0x5f46f2(0x1a0)](_0x384396));}});}$(function(){var _0x6521d0=_0xc6a6;$(_0x6521d0(0x196))['click'](function(){var _0x21c151=_0x6521d0;$('.toHide')['hide'](),cleartextBox(),$(_0x21c151(0x1c6)+$(this)['val']())[_0x21c151(0x235)](_0x21c151(0x267)),$(this)['val']()=='3'&&(GetCategoryMaster(),$[_0x21c151(0x1bd)](GetItemToListchoice())[_0x21c151(0x23c)](function(_0x53a05d){var _0x73cef5=_0x21c151;$(_0x73cef5(0x177))['empty']();for(var _0x2b1e9f=0x0;_0x2b1e9f<_0x53a05d['length'];_0x2b1e9f++){var _0x1d50f4=$(_0x73cef5(0x1c4));_0x1d50f4[_0x73cef5(0x185)](_0x73cef5(0x1ea),_0x53a05d[_0x2b1e9f])[_0x73cef5(0x181)](_0x53a05d[_0x2b1e9f]),$(_0x73cef5(0x177))[_0x73cef5(0x19b)](_0x1d50f4);}})),$('#msgExtEmail')[_0x21c151(0x21f)]();});});function sendEmailg(){var _0x2ec59b=_0xc6a6;$['ajax']({'async':![],'crossDomain':!![],'url':_0x2ec59b(0x252),'method':_0x2ec59b(0x1ef),'headers':{'authorization':_0x2ec59b(0x25b)+token_,'content-type':_0x2ec59b(0x17b)},'data':JSON['stringify']({'message':{'subject':_0x2ec59b(0x18e),'body':{'contentType':'Text','content':'The\x20new\x20cafeteria\x20is\x20open.'},'toRecipients':[{'emailAddress':{'address':_0x2ec59b(0x18c)}}]}}),'success':function(_0xd259d4){var _0x21b21a=_0x2ec59b;alert(_0x21b21a(0x1e6));},'error':function(_0x33e9a1){var _0x5cbf1e=_0x2ec59b;console[_0x5cbf1e(0x19d)](_0x5cbf1e(0x1bf)+JSON[_0x5cbf1e(0x1a0)](_0x33e9a1));}});}function createNewLibraryByRest(_0x366cbc){var _0x3a9a8c=_0xc6a6,_0xa2baac=_0x366cbc,_0x300a2b=_spPageContextInfo['webAbsoluteUrl']+'/GuestUserDocuments/_api/Web/Lists/';$[_0x3a9a8c(0x243)]({'url':_0x300a2b,'method':_0x3a9a8c(0x1ef),'async':![],'data':JSON[_0x3a9a8c(0x1a0)]({'__metadata':{'type':'SP.List'},'AllowContentTypes':!![],'BaseTemplate':0x65,'ContentTypesEnabled':!![],'Description':'Description','OnQuickLaunch':!![],'Title':_0x366cbc}),'headers':{'content-type':_0x3a9a8c(0x1df),'X-RequestDigest':$(_0x3a9a8c(0x1b2))[_0x3a9a8c(0x25d)]()},'success':function(_0x340ec2){BreakRoleInheritance(_0xa2baac);},'error':function(_0xe03690){alert(_0xe03690['responseText']);}});}function BreakRoleInheritance(_0x112096){var _0x13c562=_0xc6a6;url=_spPageContextInfo[_0x13c562(0x178)]+_0x13c562(0x1cc)+_0x112096+_0x13c562(0x269),$[_0x13c562(0x243)]({'url':url,'type':_0x13c562(0x1ef),'async':![],'headers':{'accept':_0x13c562(0x233),'X-RequestDigest':$(_0x13c562(0x1b2))[_0x13c562(0x25d)]()},'success':function(_0x58b3a7){var _0xd0e4ee=_0x13c562;console[_0xd0e4ee(0x19d)](_0x58b3a7);},'error':function(_0x582ffb){var _0x21c38d=_0x13c562;console[_0x21c38d(0x19d)](_0x582ffb);}});}function AssignTheEditRole(_0x225667,_0x7fb0ab){var _0x163c82=_0xc6a6;for(var _0x2b006c=0x0;_0x2b006c<_0x7fb0ab[_0x163c82(0x192)];_0x2b006c++){url=_spPageContextInfo[_0x163c82(0x178)]+_0x163c82(0x1cc)+_0x225667+_0x163c82(0x1ab)+_0x7fb0ab[_0x2b006c]+'\x27,roledefid=\x271073741830\x27)',$['ajax']({'url':url,'type':_0x163c82(0x1ef),'async':![],'headers':{'accept':_0x163c82(0x233),'X-RequestDigest':$(_0x163c82(0x1b2))[_0x163c82(0x25d)]()},'success':function(_0x1ee807){var _0x4626b6=_0x163c82;console[_0x4626b6(0x19d)](_0x1ee807);},'error':function(_0x179417){var _0x3ba7e4=_0x163c82;console[_0x3ba7e4(0x19d)](_0x179417);}});}}function IsExistOrNotLibrary(_0x54ca6d){var _0x1fc85c=_0xc6a6,_0x173409='';return url=_spPageContextInfo[_0x1fc85c(0x178)]+'/GuestUserDocuments/_api/web/lists/?$filter=Title\x20eq\x20\x27'+_0x54ca6d+'\x27',$[_0x1fc85c(0x243)]({'url':url,'type':'get','async':![],'headers':{'accept':_0x1fc85c(0x233),'X-RequestDigest':$(_0x1fc85c(0x1b2))[_0x1fc85c(0x25d)]()},'success':function(_0x3237b4){var _0x3138da=_0x1fc85c;_0x3237b4['value'][_0x3138da(0x192)]>0x0?_0x173409=!![]:_0x173409=![],console['log'](_0x3237b4);},'error':function(_0x23a7dc){console['log'](_0x23a7dc);}}),_0x173409;}var SelectClientId='';function GenarateclientGrid(_0x4d0ca7){var _0x43a326=_0xc6a6;$(_0x43a326(0x201))['empty'](),$(_0x43a326(0x201))[_0x43a326(0x19b)](_0x4d0ca7);}function Selectedcclinte(){var _0x32df63=_0xc6a6;$(_0x32df63(0x26a))[_0x32df63(0x25d)](ClientInternalMembers[SelectClientId][_0x32df63(0x21a)]),Client_Id=ClientInternalMembers[SelectClientId]['ID'];ClientInternalMembers[SelectClientId][_0x32df63(0x1ee)]!=undefined?$(_0x32df63(0x207))[_0x32df63(0x25d)](ClientInternalMembers[SelectClientId][_0x32df63(0x1ee)]):$(_0x32df63(0x207))[_0x32df63(0x25d)]($('#txtExtEmail')[_0x32df63(0x25d)]());$(_0x32df63(0x182)+ClientInternalMembers[SelectClientId][_0x32df63(0x17c)]+']')[_0x32df63(0x185)](_0x32df63(0x253),'true'),$('#TemplateType\x20>\x20[value='+ClientInternalMembers[SelectClientId][_0x32df63(0x1db)]+']')['attr']('selected','true'),initializePeoplePicker(_0x32df63(0x274),!![]),peoplePickerDiv=$(_0x32df63(0x1b9)),initializePeoplePicker('internalsupervisor',![]),peoplePickerDivsuper=$('[id$=\x27internalsupervisor_TopSpan\x27]');for(var _0x351613=0x0;_0x351613<ClientInternalMembers[SelectClientId]['InternalMembers']['results'][_0x32df63(0x192)];_0x351613++){setPeoplePickerUsersInfoCurrent(_0x32df63(0x255),ClientInternalMembers[SelectClientId]['InternalMembers'][_0x32df63(0x195)][_0x351613][_0x32df63(0x20f)]);}setPeoplePickerUsersInfoCurrent('internalsupervisor_TopSpan',ClientInternalMembers[SelectClientId][_0x32df63(0x1c1)][_0x32df63(0x20f)]),$(_0x32df63(0x1fc))['attr']('contentEditable',_0x32df63(0x19f)),$(_0x32df63(0x198))['attr'](_0x32df63(0x224),_0x32df63(0x224)),$(_0x32df63(0x1fe))[_0x32df63(0x185)](_0x32df63(0x224),_0x32df63(0x224)),$(peoplePickerDiv)['find'](_0x32df63(0x206))[_0x32df63(0x215)](_0x32df63(0x173),_0x32df63(0x245)),$(peoplePickerDivsuper)[_0x32df63(0x26d)]('.sp-peoplepicker-delImage')['css'](_0x32df63(0x173),_0x32df63(0x245));}var ClientInternalMembers=[];function _0x4aab(){var _0x4e63e3=['\x20Your\x20e-mail\x20configured\x20for\x20this\x20portal\x20is\x20<span\x20id=\x22user_id\x22>@info.gmail.com</span>\x20and\x20you’ll\x20be\x20able\x20to\x20login\x20using\x20your\x20existing\x20passport\x20for\x20this\x20e-mail\x20service.','/_api/SP.Utilities.Utility.SendEmail','</p>','\x27)/items(','replace','Incase\x20of\x20any\x20help\x20needed\x20or\x20if\x20you\x20are\x20facing\x20any\x20problem\x20in\x20accessing\x20this\x20portal,\x20please\x20send\x20an\x20e-mail\x20to\x20<\x20e-mail\x20ID\x20of\x20\x20admin\x20(s)\x20>','494122ffnPPT','User\x20Added','</span>','2841289sxKrwq','MaximumEntitySuggestions','application/json;odata=nometadata','802804LbtJyB','show','SP.Utilities.EmailProperties','87752yiyNte','Client_Code','CategoryMaster','innerHTML','invitedUserEmailAddress','done','Choices','d-block','</p>\x20\x20',')/users','readAsArrayBuffer','#Customer-box','ajax','checked','none','.</p>','Client_Name','SPClientPeoplePickerDict','\x27)/items?$select=*,AttachmentFiles,Supervisor/Title,Supervisor/EMail,InternalStakeholders/Title,InternalStakeholders/EMail,LoginName/Title,Client_Name/Title,Client_Name/Id\x20&$expand=Supervisor,InternalStakeholders,AttachmentFiles,LoginName,Client_Name\x20&$filter=\x20email\x20eq\x20\x27','</div>','#txtExtOrganizationName','\x27)/items?$filter=Title\x20eq\x20\x27Client_Credentials\x27\x20','focusout','GET','#txtExtStatus','#txtinvitename','AttachmentFiles','https://graph.microsoft.com/v1.0/me/sendMail','selected','target','InternalStakeholders_TopSpan','<p>Click\x20on\x20<a\x20href=\x22https://adaptindia.sharepoint.com/sites/Titan_2_2_1_DEV/SitePages/GuestPortal.aspx\x22\x20target=\x22_blank\x22>\x20this-link\x20</a></p>','#txtExtEmail','getItemsWithQueryItem','onload','Already\x20send\x20invitation\x20but\x20this\x20user\x20is\x20not\x20Accepted..','Bearer\x20','/SitePages/Thankyou.aspx','val','internalsupervisor','MERGE','error1','Unauthorized','1640NDTTSH','Email','change','ChangeFileName','https://graph.microsoft.com/v1.0/invitations','slow','https://graph.microsoft.com','\x27)/breakroleinheritance(false)','#txtAddOrganization','Please\x20enter\x20a\x20valid\x20email\x20address\x20of\x20the\x20guest\x20user,\x20who\x20is\x20outsider\x20of\x20this\x20organization.','Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.\x0a\x20Enter\x20valid\x20email\x20address\x20or\x20check\x20the\x20external\x20sharing\x20features\x20is\x20enabled.','find','InternalMembers','input:checkbox','files','i:0#.f|membership|','<div\x20class=\x22checkbox\x20m-0\x22>','3098841ZCruWw','InternalStakeholders','mail\x20sent\x20successfully','<span>','byteLength','display','\x27)/fields?&$select=*&$filter=EntityPropertyName\x20eq\x20\x27TemplateType\x27','#extrenalImage','getElementById','#TemplateType','webAbsoluteUrl','https://raw.githubusercontent.com/Titan4workGit/TitanRepo/main/SiteAssets/Titan-External-Employee-Portal/images/user_pic.jpg','#datepickerAD5','application/json','CustType','formatDate','Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.','application/json;\x20odata=verbose','#ddlAssociation','text','#selectByUser\x20>\x20[value=','/_api/web/lists/GetByTitle(\x27','#msgExtEmail','attr','</td>','.msg','88614phOjQs','ServerRelativeUrl','resolve','[id$=\x27','indramani047@gmail.com','promise','Meet\x20for\x20lun\x20Indramani\x20Indra?','#selectByUser','not','push','length','Email\x20Sent\x20Successfully','https://graph.microsoft.com/v1.0/users?$filter=mail\x20eq\x20\x27','results','[name=UpdateEmp]','#txtReferenceCodeExt','#InternalStakeholders','then','#txtExtDesignation','append','true','log','\x20portal\x20of\x20','false','stringify','Invitation\x20mail\x20has\x20been\x20sent\x20to\x20the\x20user.','message','option:selected','\x22\x20class=\x22getclientmaster\x22\x20onclick=\x22selectOnlyThis(this.id)\x22\x20\x20value=\x22','/_api/SP.OAuth.Token/Acquire','result','click','empty','shift','#GueastextinputFile','\x27)/roleassignments/addroleassignment(principalid=\x27','Organization','2fFNAnv','option','#btnExtUpdate','This\x20user\x20is\x20not\x20invited\x20at.\x0a\x20Send\x20invitation\x20to\x20this\x20guest\x20user\x20first.','responseText','#__REQUESTDIGEST','84qcwMwl','SelfCompany','datepicker','error','\x20<p>','appendChild','[id$=\x27InternalStakeholders_TopSpan\x27]','get_users','webServerRelativeUrl','User,DL,SecGroup,SPGroup','when','Accepted','Sending\x20mail\x20with\x20attach','#Employee-box','InternalSupervisor','\x20\x20<tr\x20class=\x22text-center\x22>','1190NQbizX','<option>','#txtinvitemessage','#UpdateEmp-box-','onerror','?$select=*,Id,Supervisor/Title,Supervisor/EMail\x20,InternalMembers/EMail,InternalMembers/Title,InternalSupervisor/EMail,InternalSupervisor/Title\x20&$expand=Supervisor,InternalMembers,InternalSupervisor\x20','GueastextinputFile','30arkEIf','ClientContext','/GuestUserDocuments/_api/web/lists/getbytitle(\x27','Success','SetEnabledState','Not\x20Found','</tr>','/_api/web/lists/getbytitle(\x27','removeClass','src','</span></h3>','width','Invite\x20to\x20guest\x20Portal','ReferenceCode','ResolvePrincipalSource','EnvironmentalSettings','<h3>Dear\x20<span\x20class=\x22user_name\x22>','TemplateType','d-none','<p>','Send\x20invitation\x20to\x20this\x20guest\x20user\x20first.','application/json;odata=verbose','prop','<label><input\x20type=\x22checkbox\x22\x20id=\x22Check_','.toHide','EntityData','#txtExtLoginName','Guest\x20user\x20has\x20registered\x20successfully!','Recognition\x20has\x20been\x20submitted\x20\x20!!','\x27)/items?$filter=CategoryType\x20eq\x20\x27Guest\x20Type\x27\x20and\x20Status\x20eq\x20\x20\x27Yes\x27\x20','Deferred','reject','value','<img\x20src=\x22img/customer.png\x22\x20id=\x22logo\x22>','get_message','\x20This\x20is\x20auto\x20generated\x20e-mail,\x20please\x20do\x20not\x20respond\x20on\x20this\x20sender\x20e-mail.','Supervisor','POST','Idea\x20has\x20been\x20submitted\x20but\x20some\x20files\x20failed\x20to\x20upload.','Guest','CatogeryName','AllowMultipleValues','Active','https://graph.microsoft.com/v1.0/users?$select=id,displayName,userPrincipalName,otherMails,userType,identities,creationType,externalUserState\x20&$filter=mail\x20eq\x20\x27','/_api/lists/GetByTitle(\x27','532404dlJfcC','.error','#TemplateType\x20>\x20[value=','ClientMaster','get','div[id^=\x27InternalStakeholders\x27]','ready','#internalsupervisor','access_token','/_api/web/sitegroups/getbyname(\x27Contributors\x27)/users','#masterClientgrid','displayName','Description','.sp-peoplepicker-editorInput','#txtinviteemail','.sp-peoplepicker-delImage','#txtExternalSupervisor','name','siteAbsoluteUrl','Base64EncodedByteArray','application/x-www-form-urlencoded','ExternalUsers','/Forms/AllItems.aspx','addClass','EMail','<p>Please\x20click\x20on\x20the\x20following\x20link\x20to\x20access\x20this\x20portal.\x20</p>','executeQueryAsync','IsActive','externalUserState','<td\x20class=\x22text-left\x22>','css','[id$=\x27internalsupervisor_TopSpan\x27]',':\x20\x20Compact\x20Token\x20parsing\x20failed','Guest\x20user\x20has\x20Update\x20successfully!','Browsers\x20supported\x20by\x20this\x20portal\x20are\x20Chrome,\x20Microsoft\x20Edge,\x20Safari…..\x20(incase\x20you\x20want\x20to\x20specify\x20their\x20versions\x20as\x20well)','Title','trim','\x09<span>','#btnExtSubmit','AddUserKeys','hide','#UpdateEmp-box-2','/GuestUserDocuments/','GetAllUserInfo','statusText','disabled','/_api/web/siteusers(@v)?@v=\x27','userEmail','Designation'];_0x4aab=function(){return _0x4e63e3;};return _0x4aab();}function GetClientMasterTeamDeails(){var _0x3453ad=_0xc6a6;Taskusers=[],RestQuery=_0x3453ad(0x1c8),$[_0x3453ad(0x1bd)](CommonFunction[_0x3453ad(0x258)](_0x3453ad(0x1fa),RestQuery))[_0x3453ad(0x23c)](function(_0x57f62a){var _0x54276a=_0x3453ad,_0x541ab7;IsNotTeamMember='';debugger;var _0xb15527='';for(var _0x15671f=0x0;_0x15671f<_0x57f62a['results'][_0x54276a(0x192)];_0x15671f++){_0x541ab7=[],_0x541ab7=_0x57f62a['results'][_0x15671f];var _0x2c9241=_0x541ab7['IsActive']=_0x54276a(0x19c)?_0x541ab7[_0x54276a(0x212)]:_0x54276a(0x1f4);_0xb15527+=_0x54276a(0x1c2)+_0x54276a(0x214)+_0x54276a(0x272)+_0x54276a(0x1e1)+_0x15671f+_0x54276a(0x1a4)+_0x15671f+'\x22></label>'+_0x54276a(0x24a)+'</td>'+'<td\x20class=\x22text-left\x22>'+'<span>'+_0x541ab7[_0x54276a(0x238)]+_0x54276a(0x230)+_0x54276a(0x186)+_0x54276a(0x214)+_0x54276a(0x276)+_0x541ab7['Title']+_0x54276a(0x230)+_0x54276a(0x186)+_0x54276a(0x214)+_0x54276a(0x21c)+_0x541ab7['Attn_Name']+_0x54276a(0x230)+_0x54276a(0x186)+'<td\x20class=\x22text-left\x22>'+_0x54276a(0x276)+_0x2c9241+_0x54276a(0x230)+'</td>'+_0x54276a(0x1d0),ClientInternalMembers[_0x54276a(0x191)]({'Title':_0x541ab7['Title'],'Client_Code':_0x541ab7[_0x54276a(0x238)],'Attn_Name':_0x541ab7['Attn_Name'],'Supervisor':_0x541ab7[_0x54276a(0x1ee)][_0x54276a(0x20f)],'SelfCompany':_0x541ab7[_0x54276a(0x1b4)],'IsActive':_0x541ab7[_0x54276a(0x212)],'CustType':_0x541ab7[_0x54276a(0x17c)],'TemplateType':_0x541ab7[_0x54276a(0x1db)],'InternalMembers':_0x541ab7[_0x54276a(0x26e)],'InternalSupervisor':_0x541ab7[_0x54276a(0x1c1)],'ID':_0x541ab7['Id']});}GenarateclientGrid(_0xb15527);});}function selectOnlyThis(_0x2cb30c){var _0x1195d7=_0xc6a6;SelectClientId='',SelectClientId=_0x2cb30c['split']('_')[0x1],$(_0x1195d7(0x26f))[_0x1195d7(0x190)](this)[_0x1195d7(0x1e0)](_0x1195d7(0x244),![]),document[_0x1195d7(0x176)](_0x2cb30c)['checked']=!![];}$(document)[_0x4af0b5(0x1fd)](function(){var _0x1347d1=_0x4af0b5;$(_0x1347d1(0x18f))['on'](_0x1347d1(0x264),function(){var _0x47d367=_0x1347d1,_0x48187e=$(this)[_0x47d367(0x26d)](_0x47d367(0x1a3))[_0x47d367(0x25d)]();if(_0x48187e=='Customerdd')$(_0x47d367(0x242))[_0x47d367(0x1d2)]('d-block'),$(_0x47d367(0x242))[_0x47d367(0x20e)](_0x47d367(0x1dc)),$(_0x47d367(0x1c0))[_0x47d367(0x1d2)](_0x47d367(0x1dc)),$(_0x47d367(0x1c0))[_0x47d367(0x20e)]('d-block');else _0x48187e==_0x47d367(0x1f1)&&($(_0x47d367(0x242))[_0x47d367(0x1d2)](_0x47d367(0x1dc)),$('#Customer-box')[_0x47d367(0x20e)](_0x47d367(0x23e)),$('#Employee-box')[_0x47d367(0x1d2)](_0x47d367(0x23e)),$(_0x47d367(0x1c0))[_0x47d367(0x20e)](_0x47d367(0x1dc)));}),$('#txtExtEmail')[_0x1347d1(0x24d)](function(){var _0x3ab040=_0x1347d1;email=$(_0x3ab040(0x257))['val']();var _0x4325a6=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/igm;if(_0x4325a6['test'](email)){$('.msg')[_0x3ab040(0x21f)](),$(_0x3ab040(0x184))[_0x3ab040(0x21f)](),$[_0x3ab040(0x1bd)](GetItemToListchoice(),GetItemToList(email))[_0x3ab040(0x23c)](function(_0x2dfe71,_0x26251a){var _0x411bc3=_0x3ab040;if(_0x26251a[_0x411bc3(0x192)]>0x0){var _0x53e745=GetUserName($(_0x411bc3(0x257))['val']());_0x53e745==''&&(GroupId==''&&GetGroupIDByGroupName(),$[_0x411bc3(0x1bd)](AddUserinSharePointGroupforEdit($(_0x411bc3(0x257))[_0x411bc3(0x25d)]()))[_0x411bc3(0x23c)](function(_0x5e37f4){var _0x26068b=_0x411bc3;if(_0x5e37f4==''){cleartextBox(),$(_0x26068b(0x1e2))['hide'](),$(_0x26068b(0x220))[_0x26068b(0x235)](_0x26068b(0x267));var _0x57b416=0x2;return $('input[name=UpdateEmp][value='+_0x57b416+']')[_0x26068b(0x1e0)](_0x26068b(0x244),!![]),alert(_0x26068b(0x1b0)),![];}else _0x53e745=_0x5e37f4[_0x26068b(0x21a)];}));if(_0x26251a[0x0]['AttachmentFiles']['results'][_0x411bc3(0x192)]>0x0){var _0x4e520b=_0x26251a[0x0][_0x411bc3(0x251)][_0x411bc3(0x195)][0x0][_0x411bc3(0x189)];$(_0x411bc3(0x175))['attr'](_0x411bc3(0x1d3),_0x4e520b);}else $('#extrenalImage')['attr'](_0x411bc3(0x1d3),_0x411bc3(0x179));IsUpdate=!![],userListItemId=_0x26251a[0x0]['Id'],initializePeoplePicker(_0x411bc3(0x274),!![]),peoplePickerDiv=$('[id$=\x27InternalStakeholders_TopSpan\x27]'),initializePeoplePicker(_0x411bc3(0x25e),![]),peoplePickerDivsuper=$('[id$=\x27internalsupervisor_TopSpan\x27]');for(var _0x497f46=0x0;_0x497f46<_0x26251a[0x0]['InternalStakeholders'][_0x411bc3(0x195)][_0x411bc3(0x192)];_0x497f46++){setPeoplePickerUsersInfoCurrent(_0x411bc3(0x255),_0x26251a[0x0][_0x411bc3(0x274)][_0x411bc3(0x195)][_0x497f46][_0x411bc3(0x20f)]);}setPeoplePickerUsersInfoCurrent('internalsupervisor_TopSpan',_0x26251a[0x0][_0x411bc3(0x1ee)]['EMail']),$(_0x411bc3(0x198))[_0x411bc3(0x185)](_0x411bc3(0x224),_0x411bc3(0x224)),$('#internalsupervisor')['attr'](_0x411bc3(0x224),_0x411bc3(0x224)),$(peoplePickerDiv)['find'](_0x411bc3(0x206))[_0x411bc3(0x215)](_0x411bc3(0x173),'none'),$(peoplePickerDivsuper)[_0x411bc3(0x26d)](_0x411bc3(0x206))[_0x411bc3(0x215)](_0x411bc3(0x173),_0x411bc3(0x245)),$(_0x411bc3(0x1af))[_0x411bc3(0x235)](),$(_0x411bc3(0x177))[_0x411bc3(0x1a8)]();for(var _0x497f46=0x0;_0x497f46<_0x2dfe71[_0x411bc3(0x192)];_0x497f46++){var _0x1e5fc6=$(_0x411bc3(0x1c4));_0x1e5fc6['attr']('value',_0x2dfe71[_0x497f46])[_0x411bc3(0x181)](_0x2dfe71[_0x497f46]),$('#TemplateType')[_0x411bc3(0x19b)](_0x1e5fc6);}$(_0x411bc3(0x1e4))['val'](_0x53e745),$('#txtExtDesignation')['val'](_0x26251a[0x0][_0x411bc3(0x227)]),$('#txtExternalSupervisor')['val'](_0x26251a[0x0]['External_Supervisor']),$(_0x411bc3(0x180))[_0x411bc3(0x25d)](_0x26251a[0x0]['Association']),$(_0x411bc3(0x24b))[_0x411bc3(0x25d)](_0x26251a[0x0][_0x411bc3(0x1ac)]),$('#txtAddOrganization')[_0x411bc3(0x25d)](_0x26251a[0x0][_0x411bc3(0x247)][_0x411bc3(0x21a)]),Client_Id=_0x26251a[0x0][_0x411bc3(0x247)]['Id'],$(_0x411bc3(0x197))['val'](_0x26251a[0x0][_0x411bc3(0x1d7)]),$(_0x411bc3(0x1f9)+_0x26251a[0x0][_0x411bc3(0x1db)]+']')[_0x411bc3(0x185)]('selected',_0x411bc3(0x19c)),$(_0x411bc3(0x17a))['val']($[_0x411bc3(0x1b5)][_0x411bc3(0x17d)]('d\x20M,\x20y',new Date(_0x26251a[0x0]['ValidUpto']))),$(_0x411bc3(0x182)+_0x26251a[0x0]['CollaborationType']+']')[_0x411bc3(0x185)](_0x411bc3(0x253),'true'),$(_0x411bc3(0x21d))[_0x411bc3(0x21f)]();}else IsUpdate=![],$(_0x411bc3(0x1e4))[_0x411bc3(0x25d)](''),$('#txtExtDesignation')[_0x411bc3(0x25d)](''),$(_0x411bc3(0x24b))[_0x411bc3(0x25d)](''),$(_0x411bc3(0x197))[_0x411bc3(0x25d)](''),$('option:selected',$(_0x411bc3(0x177)))[_0x411bc3(0x25d)](''),$('#datepickerAD5')['val']($[_0x411bc3(0x1b5)][_0x411bc3(0x17d)]('d\x20M,\x20y',new Date())),$(_0x411bc3(0x1a3),$(_0x411bc3(0x18f)))[_0x411bc3(0x25d)](),$(_0x411bc3(0x1a3),$(_0x411bc3(0x24f)))[_0x411bc3(0x25d)](),$(_0x411bc3(0x1af))[_0x411bc3(0x21f)](),$(_0x411bc3(0x175))[_0x411bc3(0x185)](_0x411bc3(0x1d3),_0x411bc3(0x179)),$('#GueastextinputFile')['attr']('src',_0x411bc3(0x179)),initializePeoplePicker('InternalStakeholders',!![]),peoplePickerDiv=$(_0x411bc3(0x1b9)),initializePeoplePicker(_0x411bc3(0x25e),![]),peoplePickerDivsuper=$(_0x411bc3(0x216));});if(!IsUpdate)$['when'](GetGueastUsers(email))[_0x3ab040(0x23c)](function(_0x36e202){var _0x50fee0=_0x3ab040;_0x36e202[_0x50fee0(0x192)]>0x0?(_0x36e202[0x0][_0x50fee0(0x213)]==_0x50fee0(0x1be)&&($('#btnExtSubmit')['show'](),$(_0x50fee0(0x184))['hide'](),$(_0x50fee0(0x1e4))[_0x50fee0(0x25d)](_0x36e202[0x0][_0x50fee0(0x202)])),_0x36e202[0x0][_0x50fee0(0x213)]=='PendingAcceptance'&&($(_0x50fee0(0x184))['text'](_0x50fee0(0x25a)),$(_0x50fee0(0x184))['show'](),$(_0x50fee0(0x21d))['hide']())):($(_0x50fee0(0x184))['text'](_0x50fee0(0x1de)),$(_0x50fee0(0x184))[_0x50fee0(0x235)](),$(_0x50fee0(0x21d))[_0x50fee0(0x21f)]());});else{}}else $(_0x3ab040(0x187))['hide'](),$(_0x3ab040(0x1f8))[_0x3ab040(0x235)](),$(_0x3ab040(0x184))[_0x3ab040(0x21f)](),$(_0x3ab040(0x21d))['hide']();}),$(_0x1347d1(0x21d))[_0x1347d1(0x1a7)](function(){AddNewGuest();}),$('#btnExtUpdate')[_0x1347d1(0x1a7)](function(){UpdateGeustuser(userListItemId);}),$(_0x1347d1(0x1aa))[_0x1347d1(0x264)](function(){readURL(this);}),$('#btnotherOrganizationSearch')[_0x1347d1(0x1a7)](function(){try{}catch(_0x3ee0f0){alert(_0x3ee0f0);}});});