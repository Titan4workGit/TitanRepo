var a19_0x2d3010=a19_0x57b9;(function(_0x5c43e7,_0x3b5e32){var _0x559f5c=a19_0x57b9,_0x2b385e=_0x5c43e7();while(!![]){try{var _0x315a02=-parseInt(_0x559f5c(0xff))/0x1+-parseInt(_0x559f5c(0xb7))/0x2+parseInt(_0x559f5c(0x16e))/0x3*(-parseInt(_0x559f5c(0x149))/0x4)+parseInt(_0x559f5c(0x13d))/0x5*(parseInt(_0x559f5c(0x114))/0x6)+-parseInt(_0x559f5c(0x116))/0x7+-parseInt(_0x559f5c(0x184))/0x8*(parseInt(_0x559f5c(0x19d))/0x9)+-parseInt(_0x559f5c(0xe6))/0xa*(-parseInt(_0x559f5c(0x1a3))/0xb);if(_0x315a02===_0x3b5e32)break;else _0x2b385e['push'](_0x2b385e['shift']());}catch(_0x3ff52b){_0x2b385e['push'](_0x2b385e['shift']());}}}(a19_0x1712,0x93e34));var token,peoplePickerDiv='',peoplePickerDivsuper='',GroupId='',email='',IsUpdate=![],userListItemId='',GuestUserEmail='',UserListId=[],Client_Id;function initializePeoplePicker(_0x1310d8,_0x5f3b19){var _0x21156c=a19_0x57b9,_0x4afa3a={};_0x4afa3a['PrincipalAccountType']=_0x21156c(0x18f),_0x4afa3a[_0x21156c(0xe3)]=0xf,_0x4afa3a[_0x21156c(0xfc)]=0xf,_0x4afa3a[_0x21156c(0x133)]=_0x5f3b19,_0x4afa3a[_0x21156c(0xc2)]=0x32,_0x4afa3a['Width']='251px',this[_0x21156c(0x14e)](_0x1310d8,null,_0x4afa3a),$(_0x21156c(0xb5))['width'](0xfa);}$(function(){var _0x28c105=a19_0x57b9;$('#datepickerAD5')[_0x28c105(0x19e)]({'changeMonth':!![],'changeYear':!![]});});function GetGueastEmployee(_0x2b1a59){var _0x236a6f=a19_0x57b9,_0x56fd0f='https://graph.microsoft.com/v1.0/users?$filter=mail\x20eq\x20\x27'+_0x2b1a59+'\x27';return DeferredObj=$[_0x236a6f(0xda)](),$[_0x236a6f(0x173)]({'method':_0x236a6f(0x192),'url':_0x56fd0f,'headers':{'Authorization':_0x236a6f(0x132)+token,'Content-Type':_0x236a6f(0x160)},'async':![],'success':function(_0x5108af){var _0x362e3d=_0x236a6f;DeferredObj['resolve'](_0x5108af[_0x362e3d(0xa8)]);},'error':function(_0x2c3f38){var _0x2ab896=_0x236a6f;DeferredObj[_0x2ab896(0x178)](_0x2c3f38),alert(_0x2ab896(0x1a9)+JSON[_0x2ab896(0x199)](_0x2c3f38));}}),DeferredObj['promise']();}function GetGueastUsers(_0x332067){var _0x2f7e40=a19_0x57b9,_0x2488a8=_0x2f7e40(0x136)+_0x332067+'\x27';return DeferredObj=$['Deferred'](),$[_0x2f7e40(0x173)]({'method':_0x2f7e40(0x192),'url':_0x2488a8,'headers':{'Authorization':_0x2f7e40(0x132)+token,'Content-Type':_0x2f7e40(0x160)},'async':![],'success':function(_0x3683b7){var _0x2c1b1d=_0x2f7e40;DeferredObj[_0x2c1b1d(0x13a)](_0x3683b7[_0x2c1b1d(0xa8)]);},'error':function(_0x3194d1){var _0xcfd997=_0x2f7e40;DeferredObj[_0xcfd997(0x178)](_0x3194d1),alert(_0xcfd997(0x1a9)+JSON[_0xcfd997(0x199)](_0x3194d1));}}),DeferredObj['promise']();}function GetCategoryMaster(){var _0x34ef05=a19_0x57b9,_0x2a7173=_0x34ef05(0x17e),_0x2f85ad=_spPageContextInfo['webAbsoluteUrl']+_0x34ef05(0xd6)+_0x2a7173+_0x34ef05(0xcb);$[_0x34ef05(0x173)]({'url':_0x2f85ad,'headers':{'Accept':_0x34ef05(0x14a)},'async':![],'success':function(_0x211466){var _0x4ca52b=_0x34ef05,_0x406221=document[_0x4ca52b(0x14b)]('selectByUser');_0x406221['innerHTML']='';for(var _0x1155d9=0x0;_0x1155d9<_0x211466['d']['results'][_0x4ca52b(0x19f)];_0x1155d9++){var _0xfd1202=_0x211466['d'][_0x4ca52b(0x164)][_0x1155d9]['CatogeryName'],_0x3371b7=_0x211466['d'][_0x4ca52b(0x164)][_0x1155d9][_0x4ca52b(0x102)];opt=document[_0x4ca52b(0x17f)]('option'),opt[_0x4ca52b(0xa8)]=_0x3371b7,opt[_0x4ca52b(0xfa)]=_0xfd1202,_0x406221[_0x4ca52b(0x194)](opt);}},'error':function(_0x20a7a0){var _0xd9e36f=_0x34ef05;console[_0xd9e36f(0xd4)](_0x20a7a0);}});}function GetUserId(_0xced9d0){var _0x346070=a19_0x57b9,_0x48eb68='',_0x30cde2='i:0#.f|membership|',_0x3c4a9d=_spPageContextInfo[_0x346070(0x124)],_0x115c04=_0x30cde2+_0xced9d0;return $[_0x346070(0x173)]({'url':_0x3c4a9d+_0x346070(0x189)+encodeURIComponent(_0x115c04)+'\x27','method':'GET','headers':{'Accept':_0x346070(0x145)},'async':![],'success':function(_0x4fb5ae){_0x48eb68=_0x4fb5ae['d']['Id'];},'error':function(_0x344866){var _0xc450a6=_0x346070;console['log'](JSON[_0xc450a6(0x199)](_0x344866));}}),_0x48eb68;}function GetUserName(_0x398557){var _0x1c8e67=a19_0x57b9,_0xc41cfc='',_0x26eabf=_0x1c8e67(0xb4),_0x23e136=_spPageContextInfo[_0x1c8e67(0x124)],_0x9f2e30=_0x26eabf+_0x398557;return $['ajax']({'url':_0x23e136+_0x1c8e67(0x189)+encodeURIComponent(_0x9f2e30)+'\x27','method':'GET','headers':{'Accept':_0x1c8e67(0x145)},'async':![],'success':function(_0x41e63e){_0xc41cfc=_0x41e63e['d']['Title'];},'error':function(_0x53b536){var _0x54a015=_0x1c8e67;console['log'](JSON[_0x54a015(0x199)](_0x53b536));}}),_0xc41cfc;}function AddNewGuest(){var _0x195ee6=a19_0x57b9;try{var _0x285ad8=_0x195ee6(0x19c),_0x10ce63=SPClientPeoplePicker[_0x195ee6(0xd1)][peoplePickerDiv[0x0]['id']],_0x258c52=_0x10ce63[_0x195ee6(0x11a)](),_0xe94094=[];for(var _0x5ed88a=0x0;_0x5ed88a<_0x258c52['length'];_0x5ed88a++){var _0x17fe47=GetUserId(_0x258c52[_0x5ed88a][_0x195ee6(0xea)][_0x195ee6(0x147)]);_0xe94094[_0x195ee6(0xe1)](_0x17fe47),UserListId[_0x195ee6(0xe1)](_0x17fe47);}_0x10ce63=SPClientPeoplePicker[_0x195ee6(0xd1)][peoplePickerDivsuper[0x0]['id']],_0x258c52=_0x10ce63[_0x195ee6(0x11a)]();var _0xdf16bb=GetUserId(_0x258c52[0x0]['EntityData'][_0x195ee6(0x147)]);UserListId[_0x195ee6(0xe1)](_0xdf16bb);GroupId==''&&GetGroupIDByGroupName();AddUserinSharePointGroup($('#txtExtEmail')[_0x195ee6(0xf4)]());var _0x2d2e6f=GetUserId($(_0x195ee6(0xa3))[_0x195ee6(0xf4)]());UserListId[_0x195ee6(0xe1)](_0x2d2e6f);var _0x3b5753=_spPageContextInfo[_0x195ee6(0x11b)]+_0x195ee6(0x18c)+$(_0x195ee6(0x179))['val']()[_0x195ee6(0x146)]()[_0x195ee6(0xaa)](/ /g,'')+_0x195ee6(0x103),_0x11445e,_0x4d13c8=GetItemTypeForListName(_0x285ad8);_0x11445e={'__metadata':{'type':_0x4d13c8},'LoginNameId':_0x2d2e6f,'Title':$(_0x195ee6(0xa3))[_0x195ee6(0xf4)](),'email':$(_0x195ee6(0xa3))['val'](),'Designation':$(_0x195ee6(0xe8))[_0x195ee6(0xf4)](),'Organization':$(_0x195ee6(0x179))[_0x195ee6(0xf4)](),'ReferenceCode':$('#txtReferenceCodeExt')[_0x195ee6(0xf4)](),'TemplateType':$(_0x195ee6(0x130),$(_0x195ee6(0x172)))[_0x195ee6(0xf4)](),'InternalStakeholdersId':{'results':_0xe94094},'SupervisorId':_0xdf16bb,'Client_NameId':Client_Id,'External_Supervisor':$(_0x195ee6(0x112))[_0x195ee6(0xf4)](),'ValidUpto':$(_0x195ee6(0x167))[_0x195ee6(0xf4)](),'CollaborationType':$(_0x195ee6(0x130),$(_0x195ee6(0x10b)))[_0x195ee6(0xf4)](),'Status':$(_0x195ee6(0x130),$('#txtExtStatus'))[_0x195ee6(0xf4)](),'DocumentLibrary':_0x3b5753},AddItemToList(_0x285ad8,_0x11445e,UserListId);}catch(_0xa489e){console['log'](_0xa489e['message']);}}function cleartextBox(){var _0x563e6a=a19_0x57b9;$('#txtExtLoginName')['val'](''),$(_0x563e6a(0xa3))[_0x563e6a(0xf4)](''),$(_0x563e6a(0xe8))[_0x563e6a(0xf4)](''),$(_0x563e6a(0x131))[_0x563e6a(0xf4)](''),$('#txtExtOrganizationName')['val'](''),$('#extrenalImage')[_0x563e6a(0x121)](_0x563e6a(0xb9),'https://raw.githubusercontent.com/Titan4workGit/TitanRepo/main/SiteAssets/AdminPortal/ManageEmployee/assets/images/user_pic.jpg'),initializePeoplePicker(_0x563e6a(0xa2),!![]),peoplePickerDiv=$('[id$=\x27InternalStakeholders_TopSpan\x27]'),initializePeoplePicker(_0x563e6a(0x119),![]),peoplePickerDivsuper=$(_0x563e6a(0xb6));}function AddItemToList(_0x14787a,_0x3eed68,_0x54f1c5){var _0x5ded7d=a19_0x57b9,_0x184e8e=$[_0x5ded7d(0xda)]();return $[_0x5ded7d(0x173)]({'url':_spPageContextInfo[_0x5ded7d(0x11b)]+_0x5ded7d(0x190)+_0x14787a+_0x5ded7d(0x10d),'type':'POST','async':![],'headers':{'accept':_0x5ded7d(0x14a),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x5ded7d(0xf4)](),'content-Type':_0x5ded7d(0x14a)},'data':JSON[_0x5ded7d(0x199)](_0x3eed68),'success':function(_0x2c39b7){var _0xf85d6=_0x5ded7d;if(document[_0xf85d6(0x14b)](_0xf85d6(0xf5))[_0xf85d6(0xaf)][_0xf85d6(0x19f)]===0x0){}else UploadAttachement(_0x2c39b7['d']['ID']);console[_0xf85d6(0xd4)](_0x2c39b7),IsExistOrNotLibrary($('#txtAddOrganization')[_0xf85d6(0xf4)]()[_0xf85d6(0x146)]()[_0xf85d6(0xaa)](/ /g,''))?AssignTheEditRole($(_0xf85d6(0x179))['val']()['trim']()[_0xf85d6(0xaa)](/ /g,''),_0x54f1c5):(createNewLibraryByRest($('#txtAddOrganization')[_0xf85d6(0xf4)]()[_0xf85d6(0x146)]()[_0xf85d6(0xaa)](/ /g,'')),AssignTheEditRole($(_0xf85d6(0x179))['val']()[_0xf85d6(0x146)]()[_0xf85d6(0xaa)](/ /g,''),_0x54f1c5)),alert('Guest\x20user\x20has\x20registered\x20successfully!'),cleartextBox();},'error':function(_0x46c0e1){var _0x16645a=_0x5ded7d;console[_0x16645a(0xd4)](JSON[_0x16645a(0x199)](_0x46c0e1)),_0x184e8e[_0x16645a(0x178)](_0x46c0e1);}}),_0x184e8e[_0x5ded7d(0x1ab)]();}function UpdateGeustuser(_0x5ed492){var _0x9b5d68=a19_0x57b9,_0x27c82d=_0x9b5d68(0x19c),_0xc4731a=SPClientPeoplePicker[_0x9b5d68(0xd1)][peoplePickerDiv[0x0]['id']],_0x888dc6=_0xc4731a[_0x9b5d68(0x11a)](),_0x11a99e=[];for(var _0x28cdee=0x0;_0x28cdee<_0x888dc6[_0x9b5d68(0x19f)];_0x28cdee++){var _0x1c66c8=GetUserId(_0x888dc6[_0x28cdee][_0x9b5d68(0xea)]['Email']);_0x11a99e[_0x9b5d68(0xe1)](_0x1c66c8),UserListId['push'](_0x1c66c8);}_0xc4731a=SPClientPeoplePicker['SPClientPeoplePickerDict'][peoplePickerDivsuper[0x0]['id']],_0x888dc6=_0xc4731a[_0x9b5d68(0x11a)]();var _0x213c21=GetUserId(_0x888dc6[0x0]['EntityData'][_0x9b5d68(0x147)]);UserListId[_0x9b5d68(0xe1)](_0x213c21);var _0xf0f99d=GetUserId($(_0x9b5d68(0xa3))[_0x9b5d68(0xf4)]());UserListId[_0x9b5d68(0xe1)](_0xf0f99d),GuestUserEmail=$(_0x9b5d68(0xa3))['val']();var _0x50fe5c=_spPageContextInfo[_0x9b5d68(0x11b)]+'/GuestUserDocuments/'+$(_0x9b5d68(0x179))[_0x9b5d68(0xf4)]()[_0x9b5d68(0x146)]()[_0x9b5d68(0xaa)](/ /g,'')+'/Forms/AllItems.aspx';_0xf0f99d==''&&(GetGroupIDByGroupName(),AddUserinSharePointGroup($('#txtExtEmail')[_0x9b5d68(0xf4)]()));var _0x579aa8,_0x16eff8=GetItemTypeForListName(_0x27c82d);_0x579aa8={'__metadata':{'type':_0x16eff8},'Designation':$(_0x9b5d68(0xe8))[_0x9b5d68(0xf4)](),'LoginNameId':_0xf0f99d,'Organization':$(_0x9b5d68(0x179))['val'](),'ReferenceCode':$(_0x9b5d68(0x131))['val'](),'TemplateType':$(_0x9b5d68(0x130),$('#TemplateType'))[_0x9b5d68(0xf4)](),'InternalStakeholdersId':{'results':_0x11a99e},'SupervisorId':_0x213c21,'Client_NameId':Client_Id,'ValidUpto':$('#datepickerAD5')[_0x9b5d68(0xf4)](),'CollaborationType':$(_0x9b5d68(0x130),$(_0x9b5d68(0x10b)))['val'](),'Status':$(_0x9b5d68(0x130),$(_0x9b5d68(0x14c)))[_0x9b5d68(0xf4)](),'DocumentLibrary':_0x50fe5c};var _0x561a7a=$[_0x9b5d68(0xda)]();return $[_0x9b5d68(0x173)]({'url':_spPageContextInfo[_0x9b5d68(0x11b)]+'/_api/web/lists/GetByTitle(\x27'+_0x27c82d+_0x9b5d68(0x170)+_0x5ed492+')','type':_0x9b5d68(0x1a8),'async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$('#__REQUESTDIGEST')[_0x9b5d68(0xf4)](),'content-Type':_0x9b5d68(0x14a),'IF-MATCH':'*','X-HTTP-Method':_0x9b5d68(0x195)},'data':JSON[_0x9b5d68(0x199)](_0x579aa8),'success':function(_0x1136d4){var _0x196874=_0x9b5d68;if(document[_0x196874(0x14b)](_0x196874(0xf5))[_0x196874(0xaf)]['length']===0x0){}else UploadAttachement(_0x5ed492);console[_0x196874(0xd4)](_0x1136d4),IsExistOrNotLibrary($('#txtAddOrganization')[_0x196874(0xf4)]()['trim']()[_0x196874(0xaa)](/ /g,''))?AssignTheEditRole($(_0x196874(0x179))[_0x196874(0xf4)]()['trim']()['replace'](/ /g,''),UserListId):(createNewLibraryByRest($(_0x196874(0x179))[_0x196874(0xf4)]()[_0x196874(0x146)]()[_0x196874(0xaa)](/ /g,'')),AssignTheEditRole($(_0x196874(0x179))[_0x196874(0xf4)]()[_0x196874(0x146)]()[_0x196874(0xaa)](/ /g,''),UserListId)),alert(_0x196874(0x1a7));},'error':function(_0x1abb2c){var _0x4be90b=_0x9b5d68;console[_0x4be90b(0xd4)](JSON['stringify'](_0x1abb2c)),_0x561a7a[_0x4be90b(0x178)](_0x1abb2c);}}),_0x561a7a['promise']();}function GetItemToList(_0x32f02d){var _0x310f61=a19_0x57b9,_0xab3447=_0x310f61(0x19c),_0x16851c=$[_0x310f61(0xda)]();return $[_0x310f61(0x173)]({'url':_spPageContextInfo[_0x310f61(0x11b)]+'/_api/web/lists/getbytitle(\x27'+_0xab3447+_0x310f61(0xd2)+_0x32f02d+'\x27','type':'get','async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x310f61(0x10c))[_0x310f61(0xf4)](),'content-Type':'application/json;odata=verbose'},'success':function(_0x2d4c7a){var _0x9ef935=_0x310f61;_0x16851c['resolve'](_0x2d4c7a['d'][_0x9ef935(0x164)]),console[_0x9ef935(0xd4)](_0x2d4c7a);},'error':function(_0x26c2aa){var _0x4e86d8=_0x310f61;console[_0x4e86d8(0xd4)](JSON[_0x4e86d8(0x199)](_0x26c2aa)),_0x16851c[_0x4e86d8(0x178)](_0x26c2aa);}}),_0x16851c[_0x310f61(0x1ab)]();}function GetItemToListchoice(){var _0x112a06=a19_0x57b9,_0x33c304='ExternalUsers',_0x127a12=$[_0x112a06(0xda)]();return $[_0x112a06(0x173)]({'url':_spPageContextInfo[_0x112a06(0x11b)]+_0x112a06(0x190)+_0x33c304+_0x112a06(0xab),'type':_0x112a06(0xd5),'async':![],'headers':{'accept':_0x112a06(0x14a),'X-RequestDigest':$(_0x112a06(0x10c))[_0x112a06(0xf4)](),'content-Type':_0x112a06(0x14a)},'success':function(_0x47ae3e){var _0x416509=_0x112a06;_0x127a12[_0x416509(0x13a)](_0x47ae3e['d']['results'][0x0][_0x416509(0x16c)][_0x416509(0x164)]),console[_0x416509(0xd4)](_0x47ae3e);},'error':function(_0x2b8db7){var _0x537b42=_0x112a06;console[_0x537b42(0xd4)](JSON['stringify'](_0x2b8db7)),_0x127a12[_0x537b42(0x178)](_0x2b8db7);}}),_0x127a12[_0x112a06(0x1ab)]();}function GetItemToClientMaster(){var _0x57319f=a19_0x57b9,_0xab0407=_0x57319f(0xfb),_0x37d067=$[_0x57319f(0xda)]();return $[_0x57319f(0x173)]({'url':_spPageContextInfo[_0x57319f(0x11b)]+_0x57319f(0x190)+_0xab0407+_0x57319f(0xdc),'type':_0x57319f(0xd5),'async':![],'headers':{'accept':_0x57319f(0x14a),'X-RequestDigest':$(_0x57319f(0x10c))[_0x57319f(0xf4)](),'content-Type':_0x57319f(0x14a)},'success':function(_0x39e359){var _0x178717=_0x57319f;_0x37d067[_0x178717(0x13a)](_0x39e359['d']['results']),console[_0x178717(0xd4)](_0x39e359);},'error':function(_0x301bf5){var _0xc3ad54=_0x57319f;console[_0xc3ad54(0xd4)](JSON[_0xc3ad54(0x199)](_0x301bf5)),_0x37d067[_0xc3ad54(0x178)](_0x301bf5);}}),_0x37d067['promise']();}function requestToken(){var _0x516477=a19_0x57b9;$[_0x516477(0x173)]({'async':!![],'crossDomain':!![],'url':ClientUrl,'method':'POST','headers':{'content-type':_0x516477(0x197)},'data':{'grant_type':_0x516477(0x166),'client_id\x20':ClientId,'client_secret':ClentSecret,'scope\x20':'https://graph.microsoft.com/.default'},'success':function(_0x66a7bb){var _0x28d47c=_0x516477;console['log'](_0x66a7bb),token=_0x66a7bb[_0x28d47c(0xd0)];},'error':function(_0x46106c){var _0x4ad143=_0x516477;console[_0x4ad143(0xd4)](JSON[_0x4ad143(0x199)](_0x46106c));}});}function ClientCredentialss(){var _0x326f8f=a19_0x57b9,_0x1188a1='EnvironmentalSettings',_0x206efc=_spPageContextInfo[_0x326f8f(0x11b)]+_0x326f8f(0xd6)+_0x1188a1+_0x326f8f(0x15f);$[_0x326f8f(0x173)]({'url':_0x206efc,'headers':{'Accept':_0x326f8f(0x14a)},'async':![],'success':function(_0xec72e2){var _0x2020d5=_0x326f8f,_0x56d4f7=_0xec72e2['d'][_0x2020d5(0x164)];ClientId=_0x56d4f7[0x0][_0x2020d5(0x17d)],ClentSecret=_0x56d4f7[0x0][_0x2020d5(0x108)],ClientUrl=_0x56d4f7[0x0]['Description'],requestToken();},'error':function(_0x56fc13){var _0x2ee7e3=_0x326f8f;console[_0x2ee7e3(0xd4)](_0x56fc13);}});}function GraphAccessTokenTogetUserDetails(){var _0x1a1fd0=a19_0x57b9,_0x5a4ce2=new jQuery[(_0x1a1fd0(0xda))](),_0x1e1139={'X-RequestDigest':$('#__REQUESTDIGEST')['val'](),'accept':_0x1a1fd0(0x141),'content-type':_0x1a1fd0(0x141)},_0x19580e={'resource':_0x1a1fd0(0x169)};return $['ajax']({'url':_spPageContextInfo[_0x1a1fd0(0x11b)]+_0x1a1fd0(0x18e),'headers':_0x1e1139,'type':'POST','data':JSON[_0x1a1fd0(0x199)](_0x19580e),'success':function(_0x5315d5){var _0x5889f4=_0x1a1fd0;token=_0x5315d5[_0x5889f4(0xd0)],token_=token,_0x5a4ce2[_0x5889f4(0x13a)](token);},'error':function(_0x426339,_0x1a9426,_0x2657b0){var _0x4a7a64=_0x1a1fd0;console[_0x4a7a64(0xd4)](_0x426339[_0x4a7a64(0x104)]),_0x5a4ce2[_0x4a7a64(0x178)](_0x426339[_0x4a7a64(0x104)]);}}),_0x5a4ce2['promise']();}var Errorcount=0x1,Ischeckerror=![];function Inviteuser(){var _0x17a23d=a19_0x57b9,_0x1d33e3=$(_0x17a23d(0xb8))[_0x17a23d(0xf4)](),_0x3497f7=$(_0x17a23d(0xc5))[_0x17a23d(0xf4)](),_0xb0a7c6=$('#txtinvitemessage')[_0x17a23d(0xf4)]();Errorcount=0x1,$[_0x17a23d(0x173)]({'url':_0x17a23d(0xae),'type':_0x17a23d(0x1a8),'headers':{'Authorization':'Bearer\x20'+token,'content-type':'application/json'},'data':JSON[_0x17a23d(0x199)]({'invitedUserDisplayName':_0x3497f7,'invitedUserEmailAddress':_0x1d33e3,'inviteRedirectUrl':_spPageContextInfo[_0x17a23d(0x11b)]+_0x17a23d(0x12d),'sendInvitationMessage':!![],'invitedUserMessageInfo':{'customizedMessageBody':_0xb0a7c6}}),'async':![],'success':function(_0x535403){var _0x59af08=_0x17a23d;console[_0x59af08(0xd4)](_0x535403),$(_0x59af08(0xb8))[_0x59af08(0xf4)](''),$('#txtinvitename')['val'](''),$(_0x59af08(0x14f))[_0x59af08(0xf4)]('');GroupId==''&&GetGroupIDByGroupName();GuestUserEmail=_0x535403[_0x59af08(0x17c)];try{$[_0x59af08(0x137)](AddUserinSharePointGroup(_0x535403[_0x59af08(0x17c)]))['done'](function(_0x31b48e){var _0x4bfca3=_0x59af08;Ischeckerror=![],_0x31b48e==_0x4bfca3(0xba)?alert(_0x4bfca3(0x175)):alert(_0x4bfca3(0xf0));});}catch(_0x2717a0){alert(_0x59af08(0xf0));}},'error':function(_0x110ac2){var _0x475248=_0x17a23d;_0x110ac2['statusText']=='Unauthorized'?alert(_0x110ac2[_0x475248(0xf8)]+_0x475248(0x140)):(alert(_0x475248(0xef)),console[_0x475248(0xd4)](JSON[_0x475248(0x199)](_0x110ac2)));}}),Ischeckerror&&alert('Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.');}function setPeoplePickerUsersInfoCurrent(_0x569989,_0x185695){var _0x264174=a19_0x57b9,_0x3295c0=$(_0x264174(0xb2)+_0x569989+'\x27]'),_0x348a20=SPClientPeoplePicker['SPClientPeoplePickerDict'][_0x3295c0[0x0]['id']];_0x348a20['AddUserKeys'](_0x185695,![]),_0x348a20[_0x264174(0x15b)](![]);}function readURL(_0x48a314){var _0x548323=a19_0x57b9;if(_0x48a314['files']&&_0x48a314['files'][0x0]){var _0x5c27d9=new FileReader();_0x5c27d9[_0x548323(0xc8)]=function(_0x1cee25){var _0x1425d1=_0x548323;$('#extrenalImage')[_0x1425d1(0x121)](_0x1425d1(0xb9),_0x1cee25[_0x1425d1(0xdf)][_0x1425d1(0x181)]);},_0x5c27d9[_0x548323(0xe9)](_0x48a314[_0x548323(0xaf)][0x0]);}}function UploadAttachement(_0x12f5c6){var _0x3a9f69=a19_0x57b9;try{if(document['getElementById'](_0x3a9f69(0xf5))['files'][_0x3a9f69(0x19f)]===0x0){}else{var _0x3706ad=_0x12f5c6,_0x3bb108=$(_0x3a9f69(0x115)),_0x230ec9=_0x3bb108[0x0][_0x3a9f69(0xaf)][_0x3a9f69(0x19f)],_0x1d17f3=[],_0xbc8c2f=_0x3bb108[0x0]['files'][0x0][_0x3a9f69(0xe4)];_0xbc8c2f=_0x3bb108[0x0][_0x3a9f69(0xaf)][0x0][_0x3a9f69(0xe4)][_0x3a9f69(0xaa)](/[^a-zA-Z0-9-. ]/g,''),_0xbc8c2f=_0xbc8c2f[_0x3a9f69(0xaa)](/\s/g,'');for(var _0x1fab13=0x0;_0x1fab13<_0x230ec9;_0x1fab13++){_0x1d17f3['push'](_0x3bb108[0x0][_0x3a9f69(0xaf)][_0x1fab13]);}uploadFileSP(_0x3a9f69(0x19c),_0x3706ad,_0x1d17f3,_0x230ec9,_0xbc8c2f);}}catch(_0x337d8c){alert(_0x3a9f69(0x144));}}function getFileBuffer(_0x2b4a80){var _0x57e919=a19_0x57b9,_0x45a389=$[_0x57e919(0xda)](),_0x31e0b8=new FileReader();return _0x31e0b8[_0x57e919(0xc8)]=function(_0x175b80){var _0x4fb501=_0x57e919;_0x45a389[_0x4fb501(0x13a)](_0x175b80[_0x4fb501(0xdf)][_0x4fb501(0x181)]);},_0x31e0b8[_0x57e919(0x150)]=function(_0x3ed9d4){var _0x350950=_0x57e919;_0x45a389[_0x350950(0x178)](_0x3ed9d4[_0x350950(0xdf)]['error']);},_0x31e0b8[_0x57e919(0x18d)](_0x2b4a80),_0x45a389[_0x57e919(0x1ab)]();}function uploadFileSP(_0x4ca2df,_0x350391,_0x249486,_0x55daeb,_0x11a263){var _0x1a88c2=a19_0x57b9,_0x3ec5a2=0x0,_0x146d74=$[_0x1a88c2(0xda)](),_0x1c57c7='',_0x4880a7=_0x249486[0x0],_0x3b064f=getFileBuffer(_0x4880a7);return _0x3b064f[_0x1a88c2(0x16d)](function(_0xc4ab86,_0x109ac6,_0x22bcd9){var _0x505ea0=_0x1a88c2,_0x2b8edd=new Uint8Array(_0xc4ab86),_0x1de9b0=new SP['Base64EncodedByteArray'](),_0x4bd956=_spPageContextInfo[_0x505ea0(0x11b)]+_0x505ea0(0x15d)+_0x4ca2df+_0x505ea0(0x170)+_0x350391+_0x505ea0(0x174)+_0x11a263+'\x27)',_0x2f9880=0x0;$[_0x505ea0(0x173)]({'url':_0x4bd956,'type':'POST','processData':![],'contentType':_0x505ea0(0x14a),'data':_0xc4ab86,'headers':{'accept':_0x505ea0(0x14a),'X-RequestDigest':$('#__REQUESTDIGEST')['val'](),'content-length':_0xc4ab86[_0x505ea0(0xa4)]},'success':function(_0x110379){var _0x22c7a9=_0x505ea0;_0x3ec5a2++,_0x1c57c7=_0x3ec5a2,_0x249486['shift']();if(_0x249486[_0x22c7a9(0x19f)]>0x0)uploadFileSP(_0x22c7a9(0x19c),_0x350391,_0x249486,_0x249486[_0x22c7a9(0x19f)]);else{}},'error':function(_0x585733){var _0x5b1daf=_0x505ea0;alert(_0x5b1daf(0x11e));}}),_0x146d74['resolve'](_0x1c57c7);}),_0x3b064f[_0x1a88c2(0x105)](function(_0x54756a){var _0xba5086=_0x1a88c2;_0x146d74[_0xba5086(0x178)](_0x54756a);}),_0x146d74[_0x1a88c2(0x1ab)]();}function GetGroupIDByGroupName(){var _0x595e86=a19_0x57b9,_0x33bc6f=_spPageContextInfo[_0x595e86(0x11b)]+_0x595e86(0x1a5);$[_0x595e86(0x173)]({'url':_0x33bc6f,'method':'GET','async':![],'headers':{'Accept':_0x595e86(0x145)},'success':function(_0x32da1d){GroupId=_0x32da1d['d']['Id'];},'error':function(_0x4b8649){var _0x487472=_0x595e86;console[_0x487472(0xd4)](_0x4b8649);}});}function AddUserToSiteGroup(_0x394e0c){var _0x433c43=a19_0x57b9;clientContext=new SP[(_0x433c43(0x118))]();var _0x3c003d=clientContext['get_web']()['get_siteGroups']()[_0x433c43(0xec)](_0x433c43(0x165)),_0x5ec2d2=_0x3c003d[_0x433c43(0x176)]();_0x5ec2d2[_0x433c43(0xee)](_0x394e0c),clientContext[_0x433c43(0xc0)](onsuccess,onfailed);}function onsuccess(){var _0x44d0ef=a19_0x57b9;console['log'](_0x44d0ef(0xd7));}function onfailed(_0x47fc30,_0x4e7466){var _0x330898=a19_0x57b9;console[_0x330898(0xd4)](_0x330898(0xc4)+_0x4e7466[_0x330898(0x185)]()+'\x0a'+_0x4e7466[_0x330898(0x134)]());}function AddUserinSharePointGroup(_0x5c197a){var _0x2a117b=a19_0x57b9,_0xeeb8ff=$[_0x2a117b(0xda)](),_0x306e78=_0x2a117b(0xb4),_0x4b937f=_0x306e78+_0x5c197a,_0x6b483a=_spPageContextInfo[_0x2a117b(0x11b)]+'/_api/web/sitegroups/getbyname(\x27Contributors\x27)/users';$[_0x2a117b(0x173)]({'url':_0x6b483a,'type':_0x2a117b(0x1a8),'async':![],'data':JSON[_0x2a117b(0x199)]({'__metadata':{'type':_0x2a117b(0x171)},'LoginName':_0x4b937f}),'headers':{'accept':_0x2a117b(0x14a),'content-type':_0x2a117b(0x14a),'X-RequestDigest':$(_0x2a117b(0x10c))['val']()},'success':_0x3e88f8,'error':_0x5c3992});function _0x3e88f8(_0x229a77){var _0x226b2c=_0x2a117b;Ischeckerror=!![],_0xeeb8ff[_0x226b2c(0x13a)](_0x226b2c(0xba)),Errorcount=0x1,console[_0x226b2c(0xd4)](_0x226b2c(0xba));}function _0x5c3992(_0xb37a6e){var _0x503da8=_0x2a117b;console[_0x503da8(0xd4)](JSON['stringify'](_0xb37a6e)),(_0xb37a6e[_0x503da8(0xf8)]==_0x503da8(0x154)||_0xb37a6e[_0x503da8(0xf8)]==_0x503da8(0x1a6))&&Errorcount==0xa?_0xb37a6e[_0x503da8(0xf8)]==_0x503da8(0x1a6)?alert('Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.'):alert('Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.\x0a\x20Enter\x20valid\x20email\x20address\x20or\x20check\x20the\x20external\x20sharing\x20features\x20is\x20enabled.'):(Errorcount++,AddUserinSharePointGroup(GuestUserEmail));}return _0xeeb8ff[_0x2a117b(0x1ab)]();}function AddUserinSharePointGroupforEdit(_0x3f9460){var _0x47e94b=a19_0x57b9,_0x31eff1='',_0x2b4783=_0x47e94b(0xb4),_0x4f71d4=_0x2b4783+_0x3f9460,_0x2e0869=_spPageContextInfo[_0x47e94b(0x11b)]+'/_api/web/sitegroups('+GroupId+')/users';$[_0x47e94b(0x173)]({'url':_0x2e0869,'type':_0x47e94b(0x1a8),'async':![],'data':JSON['stringify']({'__metadata':{'type':'SP.User'},'LoginName':_0x4f71d4}),'headers':{'accept':'application/json;odata=verbose','content-type':'application/json;odata=verbose','X-RequestDigest':$('#__REQUESTDIGEST')[_0x47e94b(0xf4)]()},'success':_0x5ee06b,'error':_0x30a66d});function _0x5ee06b(_0x5bfa07){var _0x53e902=_0x47e94b;_0x31eff1=_0x5bfa07['d'],console[_0x53e902(0xd4)](_0x53e902(0xba));}function _0x30a66d(_0x20c5ad){var _0x22c491=_0x47e94b;console[_0x22c491(0xd4)](JSON[_0x22c491(0x199)](_0x20c5ad));}return _0x31eff1;}function processSendEmails(_0x3b026d,_0x129f56,_0x2b2b8e){var _0x15b3a7=a19_0x57b9,_0x7688ec=[],_0x2349e9='<img\x20src=\x22img/customer.png\x22\x20id=\x22logo\x22>'+_0x15b3a7(0xc3)+_0x3b026d+_0x15b3a7(0xbe)+'<p>Welcome\x20to\x20the\x20'+_0x129f56+_0x15b3a7(0xb3)+_0x2b2b8e+'.</p>'+_0x15b3a7(0xcc)+_0x15b3a7(0x161)+_0x15b3a7(0x13e)+_0x15b3a7(0x158)+'Browsers\x20supported\x20by\x20this\x20portal\x20are\x20Chrome,\x20Microsoft\x20Edge,\x20Safari…..\x20(incase\x20you\x20want\x20to\x20specify\x20their\x20versions\x20as\x20well)'+_0x15b3a7(0xfd)+_0x15b3a7(0x1a0)+_0x15b3a7(0x14d)+_0x15b3a7(0x117)+'</p>',_0x1ca392=_0x15b3a7(0x11f);_0x7688ec[_0x15b3a7(0xe1)](email);var _0x1127d7=_spPageContextInfo['userEmail'],_0x158ee0;_0x158ee0={'properties':{'__metadata':{'type':_0x15b3a7(0x163)},'From':_0x1127d7,'To':{'results':_0x7688ec},'Body':_0x2349e9,'Subject':_0x1ca392}};var _0x123108={'properties':{'__metadata':{'type':_0x15b3a7(0x163)},'From':'From:\x20no-reply@sharepointonline.com','To':{'results':_0x7688ec},'Body':_0x2349e9,'Subject':_0x1ca392}},_0x5d5ddc=_spPageContextInfo[_0x15b3a7(0x139)]==='/'?'/':_spPageContextInfo[_0x15b3a7(0x139)],_0xb5bf13=_0x5d5ddc,_0x4ae003=_0xb5bf13+_0x15b3a7(0x17a),_0x42fe7f=_spPageContextInfo[_0x15b3a7(0x11b)]+_0x15b3a7(0x17a);$[_0x15b3a7(0x173)]({'contentType':_0x15b3a7(0x160),'url':_0x42fe7f,'type':_0x15b3a7(0x1a8),'data':JSON['stringify'](_0x123108),'async':![],'headers':{'Accept':_0x15b3a7(0x14a),'content-type':'application/json;odata=verbose','X-RequestDigest':$(_0x15b3a7(0x10c))[_0x15b3a7(0xf4)]()},'success':function(_0x142433){var _0x2e8ddb=_0x15b3a7;console[_0x2e8ddb(0xd4)](_0x2e8ddb(0x1a4));},'error':function(_0x3b48e9){var _0x46c55a=_0x15b3a7;console[_0x46c55a(0xd4)](_0x46c55a(0x196)+JSON['stringify'](_0x3b48e9));}});}function sendEmail(_0x373311,_0xe4273,_0x2201cc,_0xaacfd1){var _0x28440b=a19_0x57b9;Email[_0x28440b(0xca)]({'SecureToken':token,'To':_0xe4273[0x0],'From':_0x373311,'Subject':_0xaacfd1,'Body':_0x2201cc})[_0x28440b(0x1a1)](_0x16e0f8=>alert(_0x28440b(0x159)));var _0x1fe10c=_spPageContextInfo[_0x28440b(0x139)],_0x5e211e=_0x1fe10c+_0x28440b(0x17a);$[_0x28440b(0x173)]({'contentType':_0x28440b(0x160),'url':_0x5e211e,'type':'POST','data':JSON[_0x28440b(0x199)]({'properties':{'__metadata':{'type':_0x28440b(0x163)},'From':_0x373311,'To':{'results':_0xe4273},'Body':_0x2201cc,'Subject':_0xaacfd1}}),'headers':{'Accept':'application/json;odata=verbose','content-type':'application/json;odata=verbose','X-RequestDigest':jQuery(_0x28440b(0x10c))['val']()},'success':function(_0x192aca){var _0x563fe6=_0x28440b;alert(_0x563fe6(0xbf));},'error':function(_0x569367){var _0x26960c=_0x28440b;alert(_0x26960c(0xa5)+JSON['stringify'](_0x569367));}});}$(function(){var _0x165ed5=a19_0x57b9;$(_0x165ed5(0x157))[_0x165ed5(0xf3)](function(){var _0x2d686e=_0x165ed5;$(_0x2d686e(0x127))[_0x2d686e(0xbc)](),cleartextBox(),$('#UpdateEmp-box-'+$(this)[_0x2d686e(0xf4)]())[_0x2d686e(0x16a)](_0x2d686e(0x16f)),$(this)[_0x2d686e(0xf4)]()=='3'&&(GetCategoryMaster(),$[_0x2d686e(0x137)](GetItemToListchoice())[_0x2d686e(0x16d)](function(_0x197426){var _0x1bf47a=_0x2d686e;$(_0x1bf47a(0x172))[_0x1bf47a(0x162)]();for(var _0x860fe9=0x0;_0x860fe9<_0x197426[_0x1bf47a(0x19f)];_0x860fe9++){var _0x40ffc9=$('<option>');_0x40ffc9[_0x1bf47a(0x121)](_0x1bf47a(0xa8),_0x197426[_0x860fe9])[_0x1bf47a(0xfa)](_0x197426[_0x860fe9]),$(_0x1bf47a(0x172))[_0x1bf47a(0xcf)](_0x40ffc9);}})),$(_0x2d686e(0x122))[_0x2d686e(0xbc)]();});});function sendEmailg(){var _0x3efddb=a19_0x57b9;$[_0x3efddb(0x173)]({'async':![],'crossDomain':!![],'url':_0x3efddb(0x143),'method':_0x3efddb(0x1a8),'headers':{'authorization':_0x3efddb(0x132)+token_,'content-type':_0x3efddb(0x160)},'data':JSON[_0x3efddb(0x199)]({'message':{'subject':_0x3efddb(0x183),'body':{'contentType':'Text','content':'The\x20new\x20cafeteria\x20is\x20open.'},'toRecipients':[{'emailAddress':{'address':_0x3efddb(0x18b)}}]}}),'success':function(_0x517dcd){var _0x1f9593=_0x3efddb;alert(_0x1f9593(0xc1));},'error':function(_0xe3c9f1){var _0xea11e5=_0x3efddb;console[_0xea11e5(0xd4)](_0xea11e5(0x151)+JSON[_0xea11e5(0x199)](_0xe3c9f1));}});}function createNewLibraryByRest(_0x8f0422){var _0x5ae4e6=a19_0x57b9,_0x1243cd=_0x8f0422,_0x2dab3f=_spPageContextInfo['webAbsoluteUrl']+_0x5ae4e6(0xd8);$[_0x5ae4e6(0x173)]({'url':_0x2dab3f,'method':_0x5ae4e6(0x1a8),'async':![],'data':JSON[_0x5ae4e6(0x199)]({'__metadata':{'type':_0x5ae4e6(0xf7)},'AllowContentTypes':!![],'BaseTemplate':0x65,'ContentTypesEnabled':!![],'Description':_0x5ae4e6(0x191),'OnQuickLaunch':!![],'Title':_0x8f0422}),'headers':{'content-type':_0x5ae4e6(0x14a),'X-RequestDigest':$(_0x5ae4e6(0x10c))['val']()},'success':function(_0x4ce7e3){BreakRoleInheritance(_0x1243cd);},'error':function(_0x567732){alert(_0x567732['responseText']);}});}function BreakRoleInheritance(_0x151e46){var _0xa15a06=a19_0x57b9;url=_spPageContextInfo['webAbsoluteUrl']+_0xa15a06(0xa6)+_0x151e46+'\x27)/breakroleinheritance(false)',$[_0xa15a06(0x173)]({'url':url,'type':'POST','async':![],'headers':{'accept':'application/json;odata=nometadata','X-RequestDigest':$(_0xa15a06(0x10c))[_0xa15a06(0xf4)]()},'success':function(_0x16a572){var _0x4cc730=_0xa15a06;console[_0x4cc730(0xd4)](_0x16a572);},'error':function(_0x38ff87){console['log'](_0x38ff87);}});}function AssignTheEditRole(_0x198d4f,_0x55fdfa){var _0x215828=a19_0x57b9;for(var _0x271414=0x0;_0x271414<_0x55fdfa['length'];_0x271414++){url=_spPageContextInfo[_0x215828(0x11b)]+_0x215828(0xa6)+_0x198d4f+'\x27)/roleassignments/addroleassignment(principalid=\x27'+_0x55fdfa[_0x271414]+_0x215828(0xfe),$[_0x215828(0x173)]({'url':url,'type':'POST','async':![],'headers':{'accept':_0x215828(0x141),'X-RequestDigest':$(_0x215828(0x10c))[_0x215828(0xf4)]()},'success':function(_0x3c4085){var _0xb4f01e=_0x215828;console[_0xb4f01e(0xd4)](_0x3c4085);},'error':function(_0x151d8b){var _0x31fe5d=_0x215828;console[_0x31fe5d(0xd4)](_0x151d8b);}});}}function IsExistOrNotLibrary(_0x257f6b){var _0x17bec5=a19_0x57b9,_0x4ca837='';return url=_spPageContextInfo['webAbsoluteUrl']+_0x17bec5(0x177)+_0x257f6b+'\x27',$[_0x17bec5(0x173)]({'url':url,'type':_0x17bec5(0xd5),'async':![],'headers':{'accept':'application/json;odata=nometadata','X-RequestDigest':$(_0x17bec5(0x10c))[_0x17bec5(0xf4)]()},'success':function(_0xb81d62){var _0x3ce6c0=_0x17bec5;_0xb81d62[_0x3ce6c0(0xa8)][_0x3ce6c0(0x19f)]>0x0?_0x4ca837=!![]:_0x4ca837=![],console[_0x3ce6c0(0xd4)](_0xb81d62);},'error':function(_0x30757c){var _0x45e881=_0x17bec5;console[_0x45e881(0xd4)](_0x30757c);}}),_0x4ca837;}var SelectClientId='';function GenarateclientGrid(_0x242ec3){var _0x30df2c=a19_0x57b9;$(_0x30df2c(0x16b))[_0x30df2c(0x162)](),$('#masterClientgrid')[_0x30df2c(0xcf)](_0x242ec3);}function Selectedcclinte(){var _0x2afc0e=a19_0x57b9;$(_0x2afc0e(0x179))[_0x2afc0e(0xf4)](ClientInternalMembers[SelectClientId][_0x2afc0e(0xeb)]),Client_Id=ClientInternalMembers[SelectClientId]['ID'];ClientInternalMembers[SelectClientId][_0x2afc0e(0x187)]!=undefined?$(_0x2afc0e(0x112))[_0x2afc0e(0xf4)](ClientInternalMembers[SelectClientId][_0x2afc0e(0x187)]):$(_0x2afc0e(0x112))['val']($(_0x2afc0e(0xa3))[_0x2afc0e(0xf4)]());$(_0x2afc0e(0x110)+ClientInternalMembers[SelectClientId][_0x2afc0e(0x18a)]+']')[_0x2afc0e(0x121)](_0x2afc0e(0xd3),'true'),$(_0x2afc0e(0x12a)+ClientInternalMembers[SelectClientId][_0x2afc0e(0x12b)]+']')['attr'](_0x2afc0e(0xd3),_0x2afc0e(0xf6)),initializePeoplePicker('InternalStakeholders',!![]),peoplePickerDiv=$(_0x2afc0e(0x182)),initializePeoplePicker('internalsupervisor',![]),peoplePickerDivsuper=$(_0x2afc0e(0xb6));for(var _0x57f9e3=0x0;_0x57f9e3<ClientInternalMembers[SelectClientId][_0x2afc0e(0xbd)]['results'][_0x2afc0e(0x19f)];_0x57f9e3++){setPeoplePickerUsersInfoCurrent(_0x2afc0e(0xf9),ClientInternalMembers[SelectClientId][_0x2afc0e(0xbd)]['results'][_0x57f9e3][_0x2afc0e(0x17b)]);}setPeoplePickerUsersInfoCurrent(_0x2afc0e(0x109),ClientInternalMembers[SelectClientId][_0x2afc0e(0x13f)]['EMail']),$(_0x2afc0e(0xe5))['attr']('contentEditable',_0x2afc0e(0x10e)),$(_0x2afc0e(0x19b))['attr'](_0x2afc0e(0x188),_0x2afc0e(0x188)),$(_0x2afc0e(0xc9))[_0x2afc0e(0x121)](_0x2afc0e(0x188),'disabled'),$(peoplePickerDiv)[_0x2afc0e(0x153)](_0x2afc0e(0x113))[_0x2afc0e(0x193)](_0x2afc0e(0xbb),'none'),$(peoplePickerDivsuper)[_0x2afc0e(0x153)]('.sp-peoplepicker-delImage')[_0x2afc0e(0x193)](_0x2afc0e(0xbb),'none');}var ClientInternalMembers=[];function a19_0x57b9(_0x353d16,_0x4c5a64){var _0x171220=a19_0x1712();return a19_0x57b9=function(_0x57b9e9,_0x354516){_0x57b9e9=_0x57b9e9-0xa2;var _0x1fe51d=_0x171220[_0x57b9e9];return _0x1fe51d;},a19_0x57b9(_0x353d16,_0x4c5a64);}function GetClientMasterTeamDeails(){var _0x6fc075=a19_0x57b9;Taskusers=[],RestQuery='?$select=*,Id,Supervisor/Title,Supervisor/EMail\x20,InternalMembers/EMail,InternalMembers/Title,InternalSupervisor/EMail,InternalSupervisor/Title\x20&$expand=Supervisor,InternalMembers,InternalSupervisor\x20',$[_0x6fc075(0x137)](CommonFunction[_0x6fc075(0xac)](_0x6fc075(0xfb),RestQuery))[_0x6fc075(0x16d)](function(_0x18b6a2){var _0xce2d43=_0x6fc075,_0xd3617c;IsNotTeamMember='';debugger;var _0x111432='';for(var _0x334034=0x0;_0x334034<_0x18b6a2[_0xce2d43(0x164)]['length'];_0x334034++){_0xd3617c=[],_0xd3617c=_0x18b6a2[_0xce2d43(0x164)][_0x334034];var _0x91d60d=_0xd3617c['IsActive']=_0xce2d43(0xf6)?_0xd3617c[_0xce2d43(0x13c)]:_0xce2d43(0xc6);_0x111432+='\x20\x20<tr\x20class=\x22text-center\x22>'+'<td\x20class=\x22text-left\x22>'+_0xce2d43(0x100)+'<label><input\x20type=\x22checkbox\x22\x20id=\x22Check_'+_0x334034+'\x22\x20class=\x22getclientmaster\x22\x20onclick=\x22selectOnlyThis(this.id)\x22\x20\x20value=\x22'+_0x334034+_0xce2d43(0x111)+_0xce2d43(0x12c)+_0xce2d43(0x11d)+_0xce2d43(0x148)+_0xce2d43(0xb0)+_0xd3617c[_0xce2d43(0x155)]+_0xce2d43(0xcd)+_0xce2d43(0x11d)+'<td\x20class=\x22text-left\x22>'+_0xce2d43(0xb0)+_0xd3617c[_0xce2d43(0xeb)]+_0xce2d43(0xcd)+'</td>'+_0xce2d43(0x148)+_0xce2d43(0xce)+_0xd3617c[_0xce2d43(0x126)]+_0xce2d43(0xcd)+_0xce2d43(0x11d)+_0xce2d43(0x148)+_0xce2d43(0xb0)+_0x91d60d+'</span>'+'</td>'+'</tr>',ClientInternalMembers['push']({'Title':_0xd3617c[_0xce2d43(0xeb)],'Client_Code':_0xd3617c[_0xce2d43(0x155)],'Attn_Name':_0xd3617c[_0xce2d43(0x126)],'Supervisor':_0xd3617c[_0xce2d43(0x187)][_0xce2d43(0x17b)],'SelfCompany':_0xd3617c[_0xce2d43(0xa9)],'IsActive':_0xd3617c['IsActive'],'CustType':_0xd3617c[_0xce2d43(0x18a)],'TemplateType':_0xd3617c['TemplateType'],'InternalMembers':_0xd3617c[_0xce2d43(0xbd)],'InternalSupervisor':_0xd3617c['InternalSupervisor'],'ID':_0xd3617c['Id']});}GenarateclientGrid(_0x111432);});}function selectOnlyThis(_0x3abcdd){var _0x3ba5fb=a19_0x57b9;SelectClientId='',SelectClientId=_0x3abcdd['split']('_')[0x1],$(_0x3ba5fb(0xc7))[_0x3ba5fb(0x135)](this)[_0x3ba5fb(0x128)](_0x3ba5fb(0x142),![]),document[_0x3ba5fb(0x14b)](_0x3abcdd)[_0x3ba5fb(0x142)]=!![];}$(document)[a19_0x2d3010(0x168)](function(){var _0x461fec=a19_0x2d3010;$('#selectByUser')['on'](_0x461fec(0x15c),function(){var _0x49c5d5=_0x461fec,_0x4b5008=$(this)[_0x49c5d5(0x153)](_0x49c5d5(0x130))[_0x49c5d5(0xf4)]();if(_0x4b5008=='Customerdd')$(_0x49c5d5(0x15e))['removeClass'](_0x49c5d5(0x198)),$(_0x49c5d5(0x15e))['addClass'](_0x49c5d5(0x13b)),$(_0x49c5d5(0x138))[_0x49c5d5(0x129)](_0x49c5d5(0x13b)),$('#Employee-box')['addClass']('d-block');else _0x4b5008==_0x49c5d5(0x12e)&&($(_0x49c5d5(0x15e))['removeClass'](_0x49c5d5(0x13b)),$(_0x49c5d5(0x15e))['addClass'](_0x49c5d5(0x198)),$('#Employee-box')[_0x49c5d5(0x129)]('d-block'),$(_0x49c5d5(0x138))[_0x49c5d5(0x152)](_0x49c5d5(0x13b)));}),$('#txtExtEmail')['focusout'](function(){var _0x126057=_0x461fec;email=$(_0x126057(0xa3))[_0x126057(0xf4)]();var _0x2f9ce6=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/igm;if(_0x2f9ce6[_0x126057(0x15a)](email)){$(_0x126057(0x156))[_0x126057(0xbc)](),$('#msgExtEmail')[_0x126057(0xbc)](),$['when'](GetItemToListchoice(),GetItemToList(email))[_0x126057(0x16d)](function(_0x275283,_0x26acea){var _0x28b4dc=_0x126057;if(_0x26acea[_0x28b4dc(0x19f)]>0x0){var _0x254785=GetUserName($('#txtExtEmail')['val']());_0x254785==''&&(GroupId==''&&GetGroupIDByGroupName(),$[_0x28b4dc(0x137)](AddUserinSharePointGroupforEdit($(_0x28b4dc(0xa3))[_0x28b4dc(0xf4)]()))[_0x28b4dc(0x16d)](function(_0x3fadb2){var _0xd41cb3=_0x28b4dc;if(_0x3fadb2==''){cleartextBox(),$('.toHide')[_0xd41cb3(0xbc)](),$('#UpdateEmp-box-2')['show']('slow');var _0xe92ae0=0x2;return $(_0xd41cb3(0xe7)+_0xe92ae0+']')[_0xd41cb3(0x128)](_0xd41cb3(0x142),!![]),alert(_0xd41cb3(0x101)),![];}else _0x254785=_0x3fadb2[_0xd41cb3(0xeb)];}));if(_0x26acea[0x0][_0x28b4dc(0x1aa)]['results'][_0x28b4dc(0x19f)]>0x0){var _0x34f5be=_0x26acea[0x0][_0x28b4dc(0x1aa)][_0x28b4dc(0x164)][0x0][_0x28b4dc(0xf2)];$(_0x28b4dc(0xdd))[_0x28b4dc(0x121)]('src',_0x34f5be);}else $(_0x28b4dc(0xdd))[_0x28b4dc(0x121)](_0x28b4dc(0xb9),'https://raw.githubusercontent.com/Titan4workGit/TitanRepo/main/SiteAssets/Titan-External-Employee-Portal/images/user_pic.jpg');IsUpdate=!![],userListItemId=_0x26acea[0x0]['Id'],initializePeoplePicker('InternalStakeholders',!![]),peoplePickerDiv=$(_0x28b4dc(0x182)),initializePeoplePicker(_0x28b4dc(0x119),![]),peoplePickerDivsuper=$('[id$=\x27internalsupervisor_TopSpan\x27]');for(var _0xb92ee5=0x0;_0xb92ee5<_0x26acea[0x0][_0x28b4dc(0xa2)][_0x28b4dc(0x164)]['length'];_0xb92ee5++){setPeoplePickerUsersInfoCurrent(_0x28b4dc(0xf9),_0x26acea[0x0][_0x28b4dc(0xa2)][_0x28b4dc(0x164)][_0xb92ee5][_0x28b4dc(0x17b)]);}setPeoplePickerUsersInfoCurrent(_0x28b4dc(0x109),_0x26acea[0x0][_0x28b4dc(0x187)]['EMail']),$(_0x28b4dc(0x19b))[_0x28b4dc(0x121)](_0x28b4dc(0x188),_0x28b4dc(0x188)),$(_0x28b4dc(0xc9))[_0x28b4dc(0x121)]('disabled',_0x28b4dc(0x188)),$(peoplePickerDiv)['find'](_0x28b4dc(0x113))[_0x28b4dc(0x193)](_0x28b4dc(0xbb),_0x28b4dc(0x106)),$(peoplePickerDivsuper)[_0x28b4dc(0x153)]('.sp-peoplepicker-delImage')['css'](_0x28b4dc(0xbb),'none'),$(_0x28b4dc(0xb1))[_0x28b4dc(0x16a)](),$(_0x28b4dc(0x172))['empty']();for(var _0xb92ee5=0x0;_0xb92ee5<_0x275283[_0x28b4dc(0x19f)];_0xb92ee5++){var _0x123bfc=$(_0x28b4dc(0x186));_0x123bfc[_0x28b4dc(0x121)](_0x28b4dc(0xa8),_0x275283[_0xb92ee5])[_0x28b4dc(0xfa)](_0x275283[_0xb92ee5]),$(_0x28b4dc(0x172))[_0x28b4dc(0xcf)](_0x123bfc);}$(_0x28b4dc(0x10a))['val'](_0x254785),$(_0x28b4dc(0xe8))['val'](_0x26acea[0x0][_0x28b4dc(0x10f)]),$(_0x28b4dc(0x112))[_0x28b4dc(0xf4)](_0x26acea[0x0][_0x28b4dc(0x107)]),$(_0x28b4dc(0xe0))[_0x28b4dc(0xf4)](_0x26acea[0x0][_0x28b4dc(0x180)]),$('#txtExtOrganizationName')[_0x28b4dc(0xf4)](_0x26acea[0x0][_0x28b4dc(0xd9)]),$(_0x28b4dc(0x179))['val'](_0x26acea[0x0][_0x28b4dc(0x19a)][_0x28b4dc(0xeb)]),Client_Id=_0x26acea[0x0][_0x28b4dc(0x19a)]['Id'],$('#txtReferenceCodeExt')[_0x28b4dc(0xf4)](_0x26acea[0x0][_0x28b4dc(0xa7)]),$(_0x28b4dc(0x12a)+_0x26acea[0x0]['TemplateType']+']')[_0x28b4dc(0x121)]('selected',_0x28b4dc(0xf6)),$(_0x28b4dc(0x167))[_0x28b4dc(0xf4)]($[_0x28b4dc(0x19e)]['formatDate']('d\x20M,\x20y',new Date(_0x26acea[0x0]['ValidUpto']))),$(_0x28b4dc(0x110)+_0x26acea[0x0][_0x28b4dc(0x1ac)]+']')[_0x28b4dc(0x121)](_0x28b4dc(0xd3),_0x28b4dc(0xf6)),$(_0x28b4dc(0xad))[_0x28b4dc(0xbc)]();}else IsUpdate=![],$(_0x28b4dc(0x10a))[_0x28b4dc(0xf4)](''),$('#txtExtDesignation')['val'](''),$(_0x28b4dc(0x11c))['val'](''),$(_0x28b4dc(0x131))[_0x28b4dc(0xf4)](''),$(_0x28b4dc(0x130),$(_0x28b4dc(0x172)))[_0x28b4dc(0xf4)](''),$(_0x28b4dc(0x167))['val']($[_0x28b4dc(0x19e)][_0x28b4dc(0x125)](_0x28b4dc(0xed),new Date())),$('option:selected',$(_0x28b4dc(0x10b)))[_0x28b4dc(0xf4)](),$(_0x28b4dc(0x130),$(_0x28b4dc(0x14c)))[_0x28b4dc(0xf4)](),$(_0x28b4dc(0xb1))['hide'](),$(_0x28b4dc(0xdd))[_0x28b4dc(0x121)](_0x28b4dc(0xb9),_0x28b4dc(0x1a2)),$(_0x28b4dc(0x115))['attr'](_0x28b4dc(0xb9),'https://raw.githubusercontent.com/Titan4workGit/TitanRepo/main/SiteAssets/Titan-External-Employee-Portal/images/user_pic.jpg'),initializePeoplePicker('InternalStakeholders',!![]),peoplePickerDiv=$(_0x28b4dc(0x182)),initializePeoplePicker('internalsupervisor',![]),peoplePickerDivsuper=$(_0x28b4dc(0xb6));});if(!IsUpdate)$['when'](GetGueastUsers(email))['done'](function(_0x19ab0f){var _0x12f238=_0x126057;_0x19ab0f['length']>0x0?(_0x19ab0f[0x0][_0x12f238(0x120)]==_0x12f238(0xf1)&&($(_0x12f238(0xad))[_0x12f238(0x16a)](),$(_0x12f238(0x122))['hide'](),$(_0x12f238(0x10a))[_0x12f238(0xf4)](_0x19ab0f[0x0][_0x12f238(0xde)])),_0x19ab0f[0x0][_0x12f238(0x120)]=='PendingAcceptance'&&($('#msgExtEmail')[_0x12f238(0xfa)](_0x12f238(0xe2)),$(_0x12f238(0x122))['show'](),$(_0x12f238(0xad))[_0x12f238(0xbc)]())):($('#msgExtEmail')['text'](_0x12f238(0x123)),$(_0x12f238(0x122))[_0x12f238(0x16a)](),$(_0x12f238(0xad))[_0x12f238(0xbc)]());});else{}}else $(_0x126057(0x156))[_0x126057(0xbc)](),$(_0x126057(0x12f))[_0x126057(0x16a)](),$(_0x126057(0x122))[_0x126057(0xbc)](),$(_0x126057(0xad))[_0x126057(0xbc)]();}),$('#btnExtSubmit')[_0x461fec(0xf3)](function(){AddNewGuest();}),$(_0x461fec(0xb1))[_0x461fec(0xf3)](function(){UpdateGeustuser(userListItemId);}),$('#GueastextinputFile')['change'](function(){readURL(this);}),$(_0x461fec(0xdb))[_0x461fec(0xf3)](function(){try{}catch(_0x3c7b42){alert(_0x3c7b42);}});});function a19_0x1712(){var _0x259651=['</span></h3>','Email\x20Sent\x20Successfully','executeQueryAsync','Recognition\x20has\x20been\x20submitted\x20\x20!!','MaximumEntitySuggestions','<h3>Dear\x20<span\x20class=\x22user_name\x22>','Failed','#txtinvitename','Active','input:checkbox','onload','#internalsupervisor','send','\x27)/items?$filter=CategoryType\x20eq\x20\x27Guest\x20Type\x27\x20and\x20Status\x20eq\x20\x20\x27Yes\x27\x20','<p>Please\x20click\x20on\x20the\x20following\x20link\x20to\x20access\x20this\x20portal.\x20</p>','</span>','\x09<span>','append','access_token','SPClientPeoplePickerDict','\x27)/items?$select=*,AttachmentFiles,Supervisor/Title,Supervisor/EMail,InternalStakeholders/Title,InternalStakeholders/EMail,LoginName/Title,Client_Name/Title,Client_Name/Id\x20&$expand=Supervisor,InternalStakeholders,AttachmentFiles,LoginName,Client_Name\x20&$filter=\x20email\x20eq\x20\x27','selected','log','get','/_api/web/lists/GetByTitle(\x27','Success','/GuestUserDocuments/_api/Web/Lists/','Organization','Deferred','#btnotherOrganizationSearch','\x27)/items?$select=*','#extrenalImage','displayName','target','#ddlAssociation','push','Already\x20send\x20invitation\x20but\x20this\x20user\x20is\x20not\x20Accepted..','SearchPrincipalSource','name','div[id^=\x27InternalStakeholders\x27]','7480ouswfl','input[name=UpdateEmp][value=','#txtExtDesignation','readAsDataURL','EntityData','Title','getByName','d\x20M,\x20y','addUser','Please\x20enter\x20a\x20valid\x20email\x20address\x20of\x20the\x20guest\x20user,\x20who\x20is\x20outsider\x20of\x20this\x20organization.','Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.','Accepted','ServerRelativeUrl','click','val','GueastextinputFile','true','SP.List','statusText','InternalStakeholders_TopSpan','text','ClientMaster','ResolvePrincipalSource','</p>\x20\x20','\x27,roledefid=\x271073741830\x27)','681804PhDfXr','<div\x20class=\x22checkbox\x20m-0\x22>','This\x20user\x20is\x20not\x20invited\x20at.\x0a\x20Send\x20invitation\x20to\x20this\x20guest\x20user\x20first.','CatogeryName','/Forms/AllItems.aspx','responseText','fail','none','External_Supervisor','ChangeFileName','internalsupervisor_TopSpan','#txtExtLoginName','#selectByUser','#__REQUESTDIGEST','\x27)/items','false','Designation','#selectByUser\x20>\x20[value=','\x22></label>','#txtExternalSupervisor','.sp-peoplepicker-delImage','6YeUgeL','#GueastextinputFile','5044949JDElkc','\x20This\x20is\x20auto\x20generated\x20e-mail,\x20please\x20do\x20not\x20respond\x20on\x20this\x20sender\x20e-mail.','ClientContext','internalsupervisor','GetAllUserInfo','webAbsoluteUrl','#txtExtOrganizationName','</td>','Idea\x20has\x20been\x20submitted\x20but\x20some\x20files\x20failed\x20to\x20upload.','Invite\x20to\x20guest\x20Portal','externalUserState','attr','#msgExtEmail','Send\x20invitation\x20to\x20this\x20guest\x20user\x20first.','siteAbsoluteUrl','formatDate','Attn_Name','.toHide','prop','removeClass','#TemplateType\x20>\x20[value=','TemplateType','</div>','/SitePages/Thankyou.aspx','Guest','.error','option:selected','#txtReferenceCodeExt','Bearer\x20','AllowMultipleValues','get_stackTrace','not','https://graph.microsoft.com/v1.0/users?$select=id,displayName,userPrincipalName,otherMails,userType,identities,creationType,externalUserState\x20&$filter=mail\x20eq\x20\x27','when','#Employee-box','webServerRelativeUrl','resolve','d-none','IsActive','3296875VeejrK','<p>','InternalSupervisor',':\x20\x20Compact\x20Token\x20parsing\x20failed','application/json;odata=nometadata','checked','https://graph.microsoft.com/v1.0/me/sendMail','Your\x20item\x20has\x20not\x20been\x20submitted\x20successfully!','application/json;\x20odata=verbose','trim','Email','<td\x20class=\x22text-left\x22>','64lRXaSC','application/json;odata=verbose','getElementById','#txtExtStatus','Incase\x20of\x20any\x20help\x20needed\x20or\x20if\x20you\x20are\x20facing\x20any\x20problem\x20in\x20accessing\x20this\x20portal,\x20please\x20send\x20an\x20e-mail\x20to\x20<\x20e-mail\x20ID\x20of\x20\x20admin\x20(s)\x20>','SPClientPeoplePicker_InitStandaloneControlWrapper','#txtinvitemessage','onerror','Sending\x20mail\x20with\x20attach','addClass','find','Not\x20Found','Client_Code','.msg','[name=UpdateEmp]','\x20Your\x20e-mail\x20configured\x20for\x20this\x20portal\x20is\x20<span\x20id=\x22user_id\x22>@info.gmail.com</span>\x20and\x20you’ll\x20be\x20able\x20to\x20login\x20using\x20your\x20existing\x20passport\x20for\x20this\x20e-mail\x20service.','mail\x20sent\x20successfully','test','SetEnabledState','change','/_api/lists/GetByTitle(\x27','#Customer-box','\x27)/items?$filter=Title\x20eq\x20\x27Client_Credentials\x27\x20','application/json','<p>Click\x20on\x20<a\x20href=\x22https://adaptindia.sharepoint.com/sites/Titan_2_2_1_DEV/SitePages/GuestPortal.aspx\x22\x20target=\x22_blank\x22>\x20this-link\x20</a></p>','empty','SP.Utilities.EmailProperties','results','Contributors','client_credentials','#datepickerAD5','ready','https://graph.microsoft.com','show','#masterClientgrid','Choices','done','68901LHoJaT','slow','\x27)/items(','SP.User','#TemplateType','ajax',')/AttachmentFiles/add(FileName=\x27','Invitation\x20mail\x20has\x20been\x20sent\x20to\x20the\x20user.','get_users','/GuestUserDocuments/_api/web/lists/?$filter=Title\x20eq\x20\x27','reject','#txtAddOrganization','/_api/SP.Utilities.Utility.SendEmail','EMail','invitedUserEmailAddress','ClientName','CategoryMaster','createElement','Association','result','[id$=\x27InternalStakeholders_TopSpan\x27]','Meet\x20for\x20lun\x20Indramani\x20Indra?','356552DjPvJE','get_message','<option>','Supervisor','disabled','/_api/web/siteusers(@v)?@v=\x27','CustType','indramani047@gmail.com','/GuestUserDocuments/','readAsArrayBuffer','/_api/SP.OAuth.Token/Acquire','User,DL,SecGroup,SPGroup','/_api/web/lists/getbytitle(\x27','Description','GET','css','appendChild','MERGE','SendEmailSharedNotification\x20\x20','application/x-www-form-urlencoded','d-block','stringify','Client_Name','#InternalStakeholders','ExternalUsers','81noYuoY','datepicker','length','\x20<p>','then','https://raw.githubusercontent.com/Titan4workGit/TitanRepo/main/SiteAssets/Titan-External-Employee-Portal/images/user_pic.jpg','47014bnWJgY','Message\x20has\x20been\x20sent.','/_api/web/sitegroups/getbyname(\x27Contributors\x27)?$select=id','error','Guest\x20user\x20has\x20Update\x20successfully!','POST','error1','AttachmentFiles','promise','CollaborationType','InternalStakeholders','#txtExtEmail','byteLength','Error\x20in\x20sending\x20Email:\x20','/GuestUserDocuments/_api/web/lists/getbytitle(\x27','ReferenceCode','value','SelfCompany','replace','\x27)/fields?&$select=*&$filter=EntityPropertyName\x20eq\x20\x27TemplateType\x27','getItemsWithQueryItem','#btnExtSubmit','https://graph.microsoft.com/v1.0/invitations','files','<span>','#btnExtUpdate','[id$=\x27','\x20portal\x20of\x20','i:0#.f|membership|','.sp-peoplepicker-editorInput','[id$=\x27internalsupervisor_TopSpan\x27]','2158950bAFUWx','#txtinviteemail','src','User\x20Added','display','hide','InternalMembers'];a19_0x1712=function(){return _0x259651;};return a19_0x1712();}