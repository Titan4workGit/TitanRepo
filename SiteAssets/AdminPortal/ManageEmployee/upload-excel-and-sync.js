var a26_0x3809c0=a26_0x34db;(function(_0xf4f2f,_0x3a1a65){var _0x1681e9=a26_0x34db,_0x4d55b3=_0xf4f2f();while(!![]){try{var _0x417340=-parseInt(_0x1681e9(0x21e))/0x1*(-parseInt(_0x1681e9(0x29c))/0x2)+-parseInt(_0x1681e9(0x1ea))/0x3+-parseInt(_0x1681e9(0x1be))/0x4*(parseInt(_0x1681e9(0x281))/0x5)+-parseInt(_0x1681e9(0x280))/0x6+-parseInt(_0x1681e9(0x1f5))/0x7+-parseInt(_0x1681e9(0x1ec))/0x8*(-parseInt(_0x1681e9(0x21c))/0x9)+-parseInt(_0x1681e9(0x1a5))/0xa*(-parseInt(_0x1681e9(0x29b))/0xb);if(_0x417340===_0x3a1a65)break;else _0x4d55b3['push'](_0x4d55b3['shift']());}catch(_0x1c8bb4){_0x4d55b3['push'](_0x4d55b3['shift']());}}}(a26_0x4c85,0xb169b));var token,ClientId='',ClentSecret='',ClientUrl='',DeferredObj=$[a26_0x3809c0(0x25a)](),color_red='',Error=0x0,Ready=0x0,Exits=0x0,lblUpdate=0x0,ErrorUser='',alluserdata,contributersGroupId='',counusers=0x0,excelRows,AllCompanies,AllDepartments,AllOfficeLocation,tabledata,pageIndex,UserEmailId,warningmessage='',userfullname='',AvilableLicenses,ReadySelected=[],MiisingSelected=[],AddedEmployeeList=[],IsMiisingSelect,isReadeySelect,peoplePickerDiv='',IsaddedNewEmployee=![],EmployeeId='',EmployeeDepartment='',EmployeeOfficeLocation='',checkedAudience='',IsNotification=![];$(document)[a26_0x3809c0(0x23e)](function(){var _0x2bf7bf=a26_0x3809c0;GraphAccessTokenTogetUserDetails(),GetCompanies(),GetOfficeLocation(),GetDepartments(),LoadShowUser([]),GetAllUserId(),GetEmployees(),$(_0x2bf7bf(0x218))['text'](AvilableLicenses);});function initializePeoplePicker(_0xbae392){var _0x25b37b=a26_0x3809c0,_0x5ad05e={};_0x5ad05e[_0x25b37b(0x189)]=_0x25b37b(0x16b),_0x5ad05e[_0x25b37b(0x1a1)]=0xf,_0x5ad05e[_0x25b37b(0x196)]=0xf,_0x5ad05e[_0x25b37b(0x278)]=![],_0x5ad05e['MaximumEntitySuggestions']=0x32,_0x5ad05e[_0x25b37b(0x1d6)]=_0x25b37b(0x16e),this[_0x25b37b(0x1d4)](_0xbae392,null,_0x5ad05e),$(_0x25b37b(0x249))[_0x25b37b(0x226)](0xfa);}function GetSelectItem(){var _0x248bb7=a26_0x3809c0;IsaddedNewEmployee=![];if(contributersGroupId!==''){var _0x1a0c73=tabledata[_0x248bb7(0x26d)]();counusers=0x0;for(var _0x3037a7=0x0;_0x3037a7<_0x1a0c73[_0x248bb7(0x1f6)];_0x3037a7++){var _0x2db4c0=alluserdata[_0x248bb7(0x22e)](function(_0x22bd6a){var _0x17fa5f=_0x248bb7;return _0x22bd6a[_0x17fa5f(0x1de)]==_0x1a0c73[_0x3037a7][_0x17fa5f(0x217)][_0x17fa5f(0x1c0)][_0x17fa5f(0x1de)];});AvilableLicenses>0x0?_0x2db4c0[0x0][_0x248bb7(0x20e)]==_0x248bb7(0x1ed)?(AddNewEmployeeAllocated(_0x2db4c0,_0x248bb7(0x240)),IsaddedNewEmployee=!![]):_0x2db4c0[0x0][_0x248bb7(0x20e)]=='Already\x20Exist'&&UpdateExistingEmployeeAllocated(_0x2db4c0,'Employees'):($(_0x248bb7(0x167))[_0x248bb7(0x1d2)](counusers),alert(_0x248bb7(0x18b)),_0x3037a7=_0x1a0c73['length']);}warningmessage!=''&&(warningmessage+=userfullname,alert(warningmessage)),$('#added')[_0x248bb7(0x1d2)](counusers),showmessage(),tabledata[_0x248bb7(0x274)](excelRows),tabledata['setPage'](pageIndex),IsaddedNewEmployee&&($(_0x248bb7(0x1aa))[_0x248bb7(0x2a0)]({'backdrop':_0x248bb7(0x1ba),'keyboard':![]},_0x248bb7(0x268)),AddedEmployeeList[_0x248bb7(0x1f6)]>0x0?$(_0x248bb7(0x258))[_0x248bb7(0x268)]():$(_0x248bb7(0x258))[_0x248bb7(0x1f4)]());}else GetGroupIDByGroupName(),GetSelectItem();}var Temparray=[];$(a26_0x3809c0(0x1f8))['click'](function(){var _0x286090=a26_0x3809c0;debugger;Temparray=alluserdata;let _0x10bfaa=[...new Set(Temparray[_0x286090(0x27a)](_0x15730b=>_0x15730b[_0x286090(0x1d9)]))];var _0x2bb7c8=document[_0x286090(0x1a8)](_0x286090(0x221));_0x2bb7c8[_0x286090(0x17f)]='',opt[_0x286090(0x1c9)]='0',opt['text']=_0x286090(0x182),_0x2bb7c8['appendChild'](opt);for(var _0x22e5c7=0x0;_0x22e5c7<_0x10bfaa[_0x286090(0x1f6)];_0x22e5c7++){opt=document[_0x286090(0x29f)](_0x286090(0x19a)),opt[_0x286090(0x1c9)]=_0x10bfaa[_0x22e5c7],opt[_0x286090(0x1d2)]=_0x10bfaa[_0x22e5c7],_0x2bb7c8[_0x286090(0x20b)](opt);}Temparray=alluserdata;var _0x5201a8=[...new Set(Temparray[_0x286090(0x27a)](_0xf7ef6e=>_0xf7ef6e[_0x286090(0x175)]))],_0x2bb7c8=document[_0x286090(0x1a8)](_0x286090(0x26f)),_0xa63630='<option\x20value=\x220\x22><strong>All</strong></option>';for(var _0x22e5c7=0x0;_0x22e5c7<_0x5201a8[_0x286090(0x1f6)];_0x22e5c7++){_0xa63630+=_0x286090(0x1b1)+_0x5201a8[_0x22e5c7]+'\x22>'+_0x5201a8[_0x22e5c7]+_0x286090(0x1e0);}$(_0x286090(0x1ae))['html'](_0xa63630),Temparray=alluserdata;let _0xfd0f67=[...new Set(Temparray[_0x286090(0x27a)](_0x7a1af0=>_0x7a1af0[_0x286090(0x2a7)]))];var _0x2bb7c8=document[_0x286090(0x1a8)](_0x286090(0x25b));_0x2bb7c8[_0x286090(0x17f)]='',opt[_0x286090(0x1c9)]='0',opt[_0x286090(0x1d2)]=_0x286090(0x183),_0x2bb7c8[_0x286090(0x20b)](opt);for(var _0x22e5c7=0x0;_0x22e5c7<_0xfd0f67['length'];_0x22e5c7++){opt=document[_0x286090(0x29f)](_0x286090(0x19a)),opt['value']=_0xfd0f67[_0x22e5c7],opt['text']=_0xfd0f67[_0x22e5c7],_0x2bb7c8[_0x286090(0x20b)](opt);}}),$('#btnfiltervalue')[a26_0x3809c0(0x277)](function(){var _0x51cf68=a26_0x3809c0;let _0x215be9;var _0x318e1d='',_0x3a1c86=!![];$(_0x51cf68(0x18a))[_0x51cf68(0x22c)]()!='0'&&(_0x3a1c86=![]);if($('#ddlfilterDepartments')[_0x51cf68(0x22c)]()!='0')_0x3a1c86=![];else return alert(_0x51cf68(0x1c6)),![];if($('#ddlfilterOfficeLocation')[_0x51cf68(0x22c)]()!='0')_0x3a1c86=![];else return alert(_0x51cf68(0x2a4)),![];_0x215be9=alluserdata[_0x51cf68(0x22e)](function(_0x57fd86){var _0x15599d=_0x51cf68;return _0x57fd86['Location\x20*']==$(_0x15599d(0x203),$('#ddlfilterOfficeLocation'))['val']()&&_0x57fd86[_0x15599d(0x2a7)]==$(_0x15599d(0x203),$(_0x15599d(0x1bd)))[_0x15599d(0x22c)]()&&_0x57fd86['Company\x20*']==$(_0x15599d(0x203),$(_0x15599d(0x18a)))[_0x15599d(0x22c)]();});var _0x2570ea=alluserdata['find'](_0x3d5146=>_0x3d5146[_0x51cf68(0x175)]===$(_0x51cf68(0x203),$(_0x51cf68(0x1ae)))['val']()&&_0x3d5146[_0x51cf68(0x2a7)]==$('option:selected',$(_0x51cf68(0x1bd)))['val']()&&_0x3d5146['Company\x20*']==$(_0x51cf68(0x203),$(_0x51cf68(0x18a)))[_0x51cf68(0x22c)]());_0x3a1c86?LoadShowUser(alluserdata):LoadShowUser(_0x215be9);}),$(a26_0x3809c0(0x22d))['keyup'](function(_0x594a87){var _0x55f0fa=a26_0x3809c0;LoadShowUser(search($(_0x55f0fa(0x22d))[_0x55f0fa(0x22c)]()));});function search(_0x4a3612){return alluserdata['filter'](function(_0x48b120){var _0x12c96d=a26_0x34db;return _0x48b120[_0x12c96d(0x1c2)][_0x12c96d(0x1b4)]()[_0x12c96d(0x28f)](_0x4a3612['toLowerCase']())>-0x1||_0x48b120['Email\x20*'][_0x12c96d(0x1b4)]()[_0x12c96d(0x28f)](_0x4a3612['toLowerCase']())>-0x1;});}$(a26_0x3809c0(0x213))[a26_0x3809c0(0x188)](function(){var _0x16d58a=a26_0x3809c0;checkedAudience=this[_0x16d58a(0x1c9)];}),$(a26_0x3809c0(0x1ca))['on'](a26_0x3809c0(0x277),function(){var _0x55e637=a26_0x3809c0;$[_0x55e637(0x17b)]({'cache':![],'beforeSend':function(){var _0x48c75b=_0x55e637;$('#overlaysearch')[_0x48c75b(0x289)]();},'success':function(_0x44f762){var _0xbf51a8=_0x55e637;AddedEmployeeList=[],SubmitReady(),$(_0xbf51a8(0x18e))[_0xbf51a8(0x16c)]();}});}),$(a26_0x3809c0(0x20c))['on'](a26_0x3809c0(0x277),function(){$['ajax']({'cache':![],'beforeSend':function(){var _0x4f60a7=a26_0x34db;$('#overlaysearch')[_0x4f60a7(0x289)]();},'success':function(_0x1b836a){var _0x48f8fc=a26_0x34db;if(AddedEmployeeList['length']>0x0&&checkedAudience!='NotSave')for(var _0xd55bc8=0x0;_0xd55bc8<AddedEmployeeList['length'];_0xd55bc8++){var _0xa0c222=new Date(AddedEmployeeList[_0xd55bc8][_0x48f8fc(0x219)]['JoiningDate']),_0x464dc1=new Date();_0x464dc1['setMonth'](_0xa0c222[_0x48f8fc(0x1a7)]()+0x3),_0xa0c222=$[_0x48f8fc(0x294)][_0x48f8fc(0x266)](_0x48f8fc(0x225),_0xa0c222),_0x464dc1=$['datepicker'][_0x48f8fc(0x266)](_0x48f8fc(0x225),_0x464dc1);var _0xecf808=new Date(AddedEmployeeList[_0xd55bc8][_0x48f8fc(0x219)][_0x48f8fc(0x243)]);_0xecf808=$[_0x48f8fc(0x294)][_0x48f8fc(0x266)](_0x48f8fc(0x187),_0xecf808);var _0x371349=[],_0x230e7e=[],_0x5bcc77=[];_0x5bcc77[_0x48f8fc(0x16f)](Logged_CompanyId);var _0x378640;_0x378640={'__metadata':{'type':_0x48f8fc(0x1ce)}},(_0x378640[_0x48f8fc(0x24e)]=_0x48f8fc(0x216),_0x378640[_0x48f8fc(0x1d0)]=AddedEmployeeList[_0xd55bc8][_0x48f8fc(0x1cd)][_0x48f8fc(0x21f)](),_0x378640[_0x48f8fc(0x1a6)]=_0x48f8fc(0x18d),_0x378640[_0x48f8fc(0x181)]=AddedEmployeeList[_0xd55bc8]['Metadata'][_0x48f8fc(0x237)],_0x378640['Designation']=AddedEmployeeList[_0xd55bc8][_0x48f8fc(0x219)][_0x48f8fc(0x265)],_0x378640[_0x48f8fc(0x168)]=AddedEmployeeList[_0xd55bc8]['EmployeeDepartment'],_0x378640['OfficeLocation']=AddedEmployeeList[_0xd55bc8][_0x48f8fc(0x291)],_0x378640[_0x48f8fc(0x200)]=_0x48f8fc(0x1b3),_0x378640[_0x48f8fc(0x29a)]=_0x48f8fc(0x216),_0x378640['Audience']=checkedAudience,_0x378640[_0x48f8fc(0x1b6)]=_0x48f8fc(0x2a1),_0x378640[_0x48f8fc(0x24d)]=_0xa0c222,_0x378640[_0x48f8fc(0x21a)]=_0x464dc1,_0x378640[_0x48f8fc(0x1cc)]=_0x48f8fc(0x24a)+_0xecf808);if(checkedAudience==_0x48f8fc(0x295))_0x5bcc77=[0x0],_0x371349=[0x0],_0x230e7e=[0x0],_0x378640['CompanyId']={'results':_0x5bcc77},_0x378640[_0x48f8fc(0x19b)]={'results':_0x230e7e},_0x378640[_0x48f8fc(0x29e)]={'results':_0x371349};else{if(checkedAudience==_0x48f8fc(0x19c))_0x5bcc77[_0x48f8fc(0x16f)](AddedEmployeeList[_0xd55bc8][_0x48f8fc(0x219)][_0x48f8fc(0x210)]),_0x371349=[0x0],_0x230e7e=[0x0],_0x378640[_0x48f8fc(0x210)]={'results':_0x5bcc77},_0x378640[_0x48f8fc(0x19b)]={'results':_0x230e7e},_0x378640[_0x48f8fc(0x29e)]={'results':_0x371349};else{if(checkedAudience=='Department')_0x5bcc77=[0x0],_0x371349=[0x0],_0x230e7e['push'](AddedEmployeeList[_0xd55bc8]['Metadata'][_0x48f8fc(0x171)]),_0x378640['CompanyId']={'results':_0x5bcc77},_0x378640['DepartmentsId']={'results':_0x230e7e},_0x378640[_0x48f8fc(0x29e)]={'results':_0x371349};else checkedAudience==_0x48f8fc(0x1fd)&&(_0x5bcc77=[0x0],_0x371349[_0x48f8fc(0x16f)](AddedEmployeeList[_0xd55bc8][_0x48f8fc(0x219)][_0x48f8fc(0x197)]),_0x230e7e=[0x0],_0x378640[_0x48f8fc(0x210)]={'results':_0x5bcc77},_0x378640['DepartmentsId']={'results':_0x230e7e},_0x378640[_0x48f8fc(0x29e)]={'results':_0x371349});}}InsertWelcomeInAnnouncementList(_0x378640);}$('#overlaysearch')[_0x48f8fc(0x16c)]();}});});function SubmitReady(){var _0x58d586=a26_0x3809c0;if(contributersGroupId!==''){var _0x2e6ad0=tabledata['getSelectedRows']();counusers=0x0,IsaddedNewEmployee=![];for(var _0x4728d6=0x0;_0x4728d6<_0x2e6ad0[_0x58d586(0x1f6)];_0x4728d6++){var _0x100489=alluserdata[_0x58d586(0x22e)](function(_0x2f4a69){var _0x1d17b8=_0x58d586;return _0x2f4a69[_0x1d17b8(0x1de)]==_0x2e6ad0[_0x4728d6][_0x1d17b8(0x217)]['data'][_0x1d17b8(0x1de)];});if(AvilableLicenses>0x0)_0x100489[0x0][_0x58d586(0x20e)]=='Ready'?(AddNewEmployeeAllocated(_0x100489,'Employees'),IsaddedNewEmployee=!![]):_0x100489[0x0]['Status']==_0x58d586(0x1ab)&&UpdateExistingEmployeeAllocated(_0x100489,_0x58d586(0x240));else return alert('Your\x20License\x20limit\x20has\x20been\x20ended'),![];}warningmessage!=''&&(warningmessage+=userfullname,alert(warningmessage)),$('#added')['text'](counusers),showmessage(),tabledata[_0x58d586(0x274)](excelRows),tabledata['setPage'](pageIndex),IsaddedNewEmployee&&($(_0x58d586(0x1aa))[_0x58d586(0x2a0)]({'backdrop':_0x58d586(0x1ba),'keyboard':![]},_0x58d586(0x268)),AddedEmployeeList['length']>0x0?$(_0x58d586(0x258))['show']():$(_0x58d586(0x258))[_0x58d586(0x1f4)]());}else GetGroupIDByGroupName(),GetSelectItem();}function isReadeySelecteds(){var _0x191964=a26_0x3809c0;isReadeySelect=document[_0x191964(0x1a8)](_0x191964(0x223));if(isReadeySelect[_0x191964(0x1d5)]){tabledata[_0x191964(0x283)](MiisingSelected),$(_0x191964(0x264))['prop'](_0x191964(0x1d5),![]),$(_0x191964(0x1b9))[_0x191964(0x199)]('checked',![]),ReadySelected=[];for(var _0x284867=0x0;_0x284867<excelRows[_0x191964(0x1f6)];_0x284867++){(excelRows[_0x284867][_0x191964(0x20e)]==_0x191964(0x1ed)||excelRows[_0x284867][_0x191964(0x20e)]==_0x191964(0x1ab))&&ReadySelected[_0x191964(0x16f)](_0x284867);}$(_0x191964(0x16a))[_0x191964(0x199)]('checked',!![]),tabledata['selectRow'](ReadySelected);}else tabledata[_0x191964(0x283)](ReadySelected),$('.select-row_isReadeySelected')['prop'](_0x191964(0x1d5),![]);}function IsMiisingSelecteds(){var _0x46960b=a26_0x3809c0;IsMiisingSelect=document['getElementById'](_0x46960b(0x2a9));if(IsMiisingSelect[_0x46960b(0x1d5)]){tabledata[_0x46960b(0x283)](ReadySelected),$(_0x46960b(0x22b))['prop'](_0x46960b(0x1d5),![]),$('.select-row_isReadeySelected')['prop'](_0x46960b(0x1d5),![]),MiisingSelected=[];for(var _0x23a075=0x0;_0x23a075<excelRows['length'];_0x23a075++){(excelRows[_0x23a075][_0x46960b(0x20e)]==_0x46960b(0x286)||excelRows[_0x23a075]['Status']==_0x46960b(0x1ab)||excelRows[_0x23a075][_0x46960b(0x20e)]==_0x46960b(0x1ed))&&(MiisingSelected['push'](_0x23a075),$(_0x46960b(0x264))[_0x46960b(0x199)](_0x46960b(0x1d5),!![]));}tabledata[_0x46960b(0x1c7)](MiisingSelected);}else tabledata[_0x46960b(0x283)](MiisingSelected),$(_0x46960b(0x264))[_0x46960b(0x199)]('checked',![]);}function AssignPermissiononDMSLibary(_0x19c8ef,_0xc23681,_0x2c2696){var _0x3aa351=a26_0x3809c0,_0x2305e7={'Accept':_0x3aa351(0x1c3),'content-Type':_0x3aa351(0x1c3),'X-RequestDigest':jQuery('#__REQUESTDIGEST')[_0x3aa351(0x22c)]()},_0xcc5dc2=_0x2c2696+_0x3aa351(0x1af)+_0x19c8ef+_0x3aa351(0x288)+_0xc23681+')';$[_0x3aa351(0x17b)]({'url':_0xcc5dc2,'type':_0x3aa351(0x27c),'headers':_0x2305e7,'dataType':_0x3aa351(0x245),'async':![],'success':function(_0x59b4){var _0x1114fe=_0x3aa351;console[_0x1114fe(0x198)](_0x1114fe(0x2a8));},'error':function(_0x24f984){var _0x1036e7=_0x3aa351;console[_0x1036e7(0x198)](JSON[_0x1036e7(0x194)](_0x24f984)),Permissionloder[_0x1036e7(0x253)]();}});}function GetGroupIDByGroupName(){var _0x502095=a26_0x3809c0,_0x85b16e=_spPageContextInfo[_0x502095(0x1e5)]+_0x502095(0x1b5);$[_0x502095(0x17b)]({'url':_0x85b16e,'method':'GET','async':![],'headers':{'Accept':_0x502095(0x180)},'success':function(_0xc648a6){contributersGroupId=_0xc648a6['d']['Id'];},'error':function(_0x317e42){var _0x5e9026=_0x502095;console[_0x5e9026(0x198)](_0x317e42);}});}function a26_0x34db(_0x549f00,_0x55ca28){var _0x4c85b1=a26_0x4c85();return a26_0x34db=function(_0x34db43,_0x4e5b02){_0x34db43=_0x34db43-0x167;var _0xbd24f4=_0x4c85b1[_0x34db43];return _0xbd24f4;},a26_0x34db(_0x549f00,_0x55ca28);}function GetListItems(_0x131926,_0x50ce68){var _0xbabf6=a26_0x3809c0,_0x8df02c,_0x16b1d0=_spPageContextInfo['webAbsoluteUrl']+_0xbabf6(0x1ef)+_0x131926+_0xbabf6(0x1d1)+_0x50ce68+_0xbabf6(0x195);return $['ajax']({'url':_0x16b1d0,'method':_0xbabf6(0x2ac),'async':![],'headers':{'Accept':_0xbabf6(0x180)},'success':function(_0x2902e6){var _0x6d601=_0xbabf6;_0x2902e6['d'][_0x6d601(0x296)]['length']>0x0?_0x8df02c=![]:_0x8df02c=!![];},'error':function(_0x46ca63){var _0x30224b=_0xbabf6;console[_0x30224b(0x198)](_0x46ca63);}}),_0x8df02c;}function GetCompanies(){var _0xfbb503=a26_0x3809c0,_0x26e14b=_spPageContextInfo['webAbsoluteUrl']+_0xfbb503(0x1bb);$[_0xfbb503(0x17b)]({'url':_0x26e14b,'method':_0xfbb503(0x2ac),'async':![],'headers':{'Accept':_0xfbb503(0x180)},'success':function(_0x85347){var _0x21c917=_0xfbb503;AllCompanies=_0x85347['d'][_0x21c917(0x296)];},'error':function(_0x123bf1){var _0x494c85=_0xfbb503;console[_0x494c85(0x198)](_0x123bf1);}});}function GetDepartments(){var _0x2386d0=a26_0x3809c0,_0x445af6=_spPageContextInfo[_0x2386d0(0x1e5)]+'/_api/web/lists/getByTitle(\x27Departments\x27)/items?$select=*&$top=4900';$[_0x2386d0(0x17b)]({'url':_0x445af6,'method':_0x2386d0(0x2ac),'async':![],'headers':{'Accept':_0x2386d0(0x180)},'success':function(_0x2f8cce){var _0x15ac89=_0x2386d0;AllDepartments=_0x2f8cce['d'][_0x15ac89(0x296)];},'error':function(_0x491b6f){var _0x209735=_0x2386d0;console[_0x209735(0x198)](_0x491b6f);}});}function GetOfficeLocation(){var _0x1aa48f=a26_0x3809c0,_0x1e5b18=_spPageContextInfo[_0x1aa48f(0x1e5)]+_0x1aa48f(0x208);$[_0x1aa48f(0x17b)]({'url':_0x1e5b18,'method':_0x1aa48f(0x2ac),'async':![],'headers':{'Accept':_0x1aa48f(0x180)},'success':function(_0x4d7a29){var _0x299882=_0x1aa48f;AllOfficeLocation=_0x4d7a29['d'][_0x299882(0x296)];},'error':function(_0x7d51b2){var _0x329e95=_0x1aa48f;console[_0x329e95(0x198)](_0x7d51b2);}});}function GetSubSiteUrl(_0x2a1532,_0x1b03f5){var _0x54aa8d=a26_0x3809c0,_0x1743e7,_0x9578bd=_spPageContextInfo[_0x54aa8d(0x1e5)]+_0x54aa8d(0x1ef)+_0x2a1532+'\x27)/items?$select=ID,SiteURL&$filter=ID\x20eq\x20'+_0x1b03f5+_0x54aa8d(0x195);return $['ajax']({'url':_0x9578bd,'method':'GET','async':![],'headers':{'Accept':'application/json;\x20odata=verbose'},'success':function(_0x1fea84){var _0x35ccdb=_0x54aa8d;_0x1743e7=_0x1fea84['d'][_0x35ccdb(0x296)][0x0][_0x35ccdb(0x26b)];},'error':function(_0x39037b){var _0x16c89e=_0x54aa8d;console[_0x16c89e(0x198)](_0x39037b);}}),_0x1743e7;}function AddUserinSharePointGroup(_0x2c455f){var _0x4fe3d3=a26_0x3809c0,_0x3640d4=$[_0x4fe3d3(0x25a)](),_0x1a92c8=_0x4fe3d3(0x1eb),_0x274b42=_0x1a92c8+_0x2c455f,_0x1fc3d7=_spPageContextInfo[_0x4fe3d3(0x1e5)]+'/_api/web/sitegroups('+contributersGroupId+_0x4fe3d3(0x22f);$[_0x4fe3d3(0x17b)]({'url':_0x1fc3d7,'type':_0x4fe3d3(0x27c),'async':![],'data':JSON[_0x4fe3d3(0x194)]({'__metadata':{'type':_0x4fe3d3(0x20a)},'LoginName':_0x274b42}),'headers':{'accept':'application/json;odata=verbose','content-type':_0x4fe3d3(0x1c3),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x4fe3d3(0x22c)]()},'success':_0x1c130e,'error':_0x5d88ff});function _0x1c130e(_0xd8418f){var _0x53b614=_0x4fe3d3;_0x3640d4[_0x53b614(0x23b)](_0xd8418f['d']['Id']),console['log']('User\x20Added');}function _0x5d88ff(_0x4f7451){var _0x394ee8=_0x4fe3d3;console['log'](JSON[_0x394ee8(0x194)](_0x4f7451));}return _0x3640d4[_0x4fe3d3(0x232)]();}function GetUserId(_0xe25979){var _0xcc6c63=a26_0x3809c0,_0x57e533='',_0x5f49d5=_0xcc6c63(0x1eb),_0xba2af0=_spPageContextInfo[_0xcc6c63(0x28a)],_0x30d9df=_0x5f49d5+_0xe25979;return $[_0xcc6c63(0x17b)]({'url':_0xba2af0+_0xcc6c63(0x211)+encodeURIComponent(_0x30d9df)+'\x27','method':_0xcc6c63(0x2ac),'headers':{'Accept':_0xcc6c63(0x180)},'async':![],'success':function(_0x1b499c){_0x57e533=_0x1b499c['d']['Id'];},'error':function(_0x23c744){var _0x1d4276=_0xcc6c63;console[_0x1d4276(0x198)](JSON['stringify'](_0x23c744));}}),_0x57e533;}var GetAllGroupsUser=[],GroupUrl=_spPageContextInfo[a26_0x3809c0(0x28a)]+a26_0x3809c0(0x242);function GetAllUserId(){var _0xdd8680=a26_0x3809c0;$[_0xdd8680(0x17b)]({'url':GroupUrl,'method':_0xdd8680(0x2ac),'headers':{'Accept':'application/json;\x20odata=verbose'},'async':![],'success':function(_0x9a0f11){var _0x51193e=_0xdd8680;GetAllGroupsUser=GetAllGroupsUser[_0x51193e(0x1a9)](_0x9a0f11['d']['results']),_0x9a0f11['d'][_0x51193e(0x2a2)]!=null&&(GroupUrl=_0x9a0f11['d'][_0x51193e(0x2a2)],GetAllUserId());},'error':function(_0x1a40fc){var _0x5c6ae2=_0xdd8680;console[_0x5c6ae2(0x198)](JSON['stringify'](_0x1a40fc));}});}var LoginName;function UpdateExistingEmployeeAllocated(_0x4c6444,_0x4a5e44){var _0x311776=a26_0x3809c0;try{UserEmailId=_0x4c6444[0x0][_0x311776(0x1de)],LoginName=_0x311776(0x1eb)+_0x4c6444[0x0][_0x311776(0x1de)];var _0x2aecfe,_0x5e26d1,_0x43e11d=GetAllGroupsUser['filter'](function(_0x2204a3){var _0x17adaf=_0x311776;return _0x2204a3[_0x17adaf(0x254)][_0x17adaf(0x1b4)]()==_0x4c6444[0x0][_0x17adaf(0x1de)][_0x17adaf(0x1b4)]();});if(_0x43e11d[_0x311776(0x1f6)]>0x0)var _0xcaf748=_0x43e11d[0x0]['Id'];else{}if(TopExecutive==_0x311776(0x248)||_0x4c6444[0x0][_0x311776(0x1c5)]==undefined)_0x4c6444[0x0]['Manager\x20*']=_0x311776(0x248),_0x2aecfe=-0x1;else{var _0x9efac5=EmployeeListUsers[_0x311776(0x22e)](function(_0x503228){var _0x4b59b6=_0x311776,_0x5728ed;if(_0x503228['Manager']!=null)return _0x5728ed=_0x503228[_0x4b59b6(0x254)]['toLowerCase'](),_0x5728ed==_0x4c6444[0x0][_0x4b59b6(0x1c5)][_0x4b59b6(0x1b4)]();});if(_0x9efac5[_0x311776(0x1f6)]>0x0){_0x5e26d1=_0x9efac5[0x0][_0x311776(0x237)];var _0x43e11d=GetAllGroupsUser[_0x311776(0x22e)](function(_0x1ffa69){var _0x1d552c=_0x311776;return _0x1ffa69[_0x1d552c(0x254)][_0x1d552c(0x1b4)]()==_0x4c6444[0x0]['Manager\x20*']['toLowerCase']();});if(_0x43e11d[_0x311776(0x1f6)]>0x0)_0x2aecfe=_0x43e11d[0x0]['Id'];else{}}else{IsManager=![],_0x2aecfe='';var _0x347f98=excelRows[_0x311776(0x239)](_0x119323=>_0x119323['Email\x20*'][_0x311776(0x1b4)]()==_0x4c6444[0x0][_0x311776(0x1de)]['toLowerCase']());excelRows[_0x347f98][_0x311776(0x20e)]='Worng\x20Manager';}}var _0x451a97,_0x5a88a2=GetItemTypeForListName(_0x4a5e44);_0x451a97={'__metadata':{'type':_0x5a88a2},'Designation':_0x4c6444[0x0][_0x311776(0x173)],'GroupName':_0x4c6444[0x0][_0x311776(0x1b2)],'Manager':_0x5e26d1,'ManagerLoginNameId':_0x2aecfe},$[_0x311776(0x1a0)](updateItemExitUser(_0x4a5e44,_0x451a97,_0x4c6444[0x0]['EmpUserId']))[_0x311776(0x25f)](function(_0x1854b5){var _0x55a2c9=_0x311776,_0x6f4314=_0x1854b5;if(_0x6f4314){lblUpdate=lblUpdate+0x1,Exits=Exits-0x1;var _0x12cca9=excelRows['findIndex'](_0x4d5f35=>_0x4d5f35['Email\x20*']==UserEmailId);excelRows[_0x12cca9][_0x55a2c9(0x20e)]='Updated',showmessage();}});}catch(_0x4489d1){console[_0x311776(0x198)](_0x4489d1[_0x311776(0x2ab)]);}}var IsManager=!![];function AddNewEmployeeAllocated(_0x1f2938,_0x1932e1){var _0x428647=a26_0x3809c0;try{if(GetListItems(_0x428647(0x1ad),parseInt(_0x1f2938[0x0][_0x428647(0x2a7)])))return alert('Department\x20Id\x20is\x20not\x20Correct'),![];if(GetListItems(_0x428647(0x236),parseInt(_0x1f2938[0x0][_0x428647(0x1d9)])))return alert(_0x428647(0x1f3)),![];else{if(GetListItems(_0x428647(0x273),parseInt(_0x1f2938[0x0]['Location\x20*'])))return alert(_0x428647(0x185)),![];else{LoginName=_0x1f2938[0x0][_0x428647(0x1de)][_0x428647(0x1b4)]();var _0x1f2991,_0x4f1847,_0x1f9a9a=GetAllGroupsUser[_0x428647(0x22e)](function(_0x11bd54){var _0x17d7de=_0x428647;return _0x11bd54[_0x17d7de(0x254)][_0x17d7de(0x1b4)]()==_0x1f2938[0x0][_0x17d7de(0x1de)][_0x17d7de(0x1b4)]();}),_0x5001a5;if(_0x1f9a9a[_0x428647(0x1f6)]>0x0)var _0x5001a5=_0x1f9a9a[0x0]['Id'];else $[_0x428647(0x1a0)](AddUserinSharePointGroup(LoginName))[_0x428647(0x25f)](function(_0x3499a3){_0x5001a5=_0x3499a3;});if(TopExecutive==_0x428647(0x248)||_0x1f2938[0x0][_0x428647(0x1c5)]==undefined)_0x1f2938[0x0][_0x428647(0x1c5)]=_0x428647(0x248),_0x1f2991=-0x1;else{var _0x2fb2f7=EmployeeListUsers[_0x428647(0x22e)](function(_0x244763){var _0x49b414=_0x428647,_0x491645;if(_0x244763[_0x49b414(0x254)]!=null)return _0x491645=_0x244763[_0x49b414(0x254)][_0x49b414(0x1b4)](),_0x491645==_0x1f2938[0x0][_0x49b414(0x1c5)][_0x49b414(0x1b4)]();});if(_0x2fb2f7[_0x428647(0x1f6)]>0x0){_0x4f1847=_0x2fb2f7[0x0][_0x428647(0x237)];var _0x1f9a9a=GetAllGroupsUser[_0x428647(0x22e)](function(_0x517aa6){var _0x5e790e=_0x428647;return _0x517aa6[_0x5e790e(0x254)][_0x5e790e(0x1b4)]()==_0x1f2938[0x0][_0x5e790e(0x1c5)]['toLowerCase']();});_0x1f9a9a['length']>0x0?_0x1f2991=_0x1f9a9a[0x0]['Id']:_0x1f2991=AddUserinSharePointGroup(_0x1f2938[0x0][_0x428647(0x1c5)]['toLowerCase']());}else{IsManager=![],_0x1f2991='';var _0x300ef1=excelRows[_0x428647(0x239)](_0x501171=>_0x501171[_0x428647(0x1de)][_0x428647(0x1b4)]()==LoginName);excelRows[_0x300ef1][_0x428647(0x20e)]='Wrong\x20Manager';}}var _0x34f198,_0x37dbb9=GetItemTypeForListName(_0x1932e1);_0x34f198={'__metadata':{'type':_0x37dbb9},'CompanyId':parseInt(_0x1f2938[0x0][_0x428647(0x1d9)]),'DepartmentId':parseInt(_0x1f2938[0x0]['Department\x20*']),'FullName':_0x1f2938[0x0][_0x428647(0x1c2)],'Title':_0x1f2938[0x0][_0x428647(0x1c2)],'ParentId':'-1','Email':_0x1f2938[0x0][_0x428647(0x1de)],'LogonNameId':_0x5001a5,'Manager':_0x1f2938[0x0][_0x428647(0x1c5)],'ManagerLoginNameId':_0x1f2991,'OfficeLocationId':parseInt(_0x1f2938[0x0]['Location\x20*']),'MobileNumber':_0x1f2938[0x0]['Mobile'],'DateOfBirth':_0x1f2938[0x0][_0x428647(0x298)],'Gender':_0x1f2938[0x0][_0x428647(0x229)],'DateOfAnniversary':_0x1f2938[0x0][_0x428647(0x276)],'JoiningDate':_0x1f2938[0x0][_0x428647(0x20f)],'Designation':_0x1f2938[0x0]['Designation\x20*'],'PrimaryCompany':'Primary','EmployeeID':_0x1f2938[0x0][_0x428647(0x17c)],'GroupName':_0x1f2938[0x0][_0x428647(0x1b2)],'Status':'Active','PostalAddresses':_0x1f2938[0x0][_0x428647(0x26a)],'City':_0x1f2938[0x0][_0x428647(0x1a2)],'StateProvince':_0x1f2938[0x0]['Sate'],'ZIPPostalCode':_0x1f2938[0x0][_0x428647(0x1d3)],'Country':_0x1f2938[0x0][_0x428647(0x23a)],'HomePhone':_0x1f2938[0x0][_0x428647(0x297)],'OtherEMailAddress':_0x1f2938[0x0][_0x428647(0x177)],'HomeAddress':_0x1f2938[0x0]['Home\x20Address']},AddItemToList(_0x1932e1,_0x34f198);var _0x448654=new Date(),_0x31724f=new Date(_0x1f2938[0x0][_0x428647(0x20f)]),_0x297033=daysDifference(_0x31724f,_0x448654);if(_0x297033<=0xf)AddedEmployeeList['push']({'Metadata':_0x34f198,'EmployeeId':EmployeeId,'EmployeeOfficeLocation':_0x1f2938[0x0]['OfficeNameDetail'],'EmployeeDepartment':_0x1f2938[0x0]['DepartmentNameDetail']});else{}}}}catch(_0x55fd18){console[_0x428647(0x198)](_0x55fd18[_0x428647(0x2ab)]);}}function daysDifference(_0x254ed6,_0x5e8c8e){var _0x34ed41=a26_0x3809c0,_0x225327=new Date(+_0x5e8c8e)['setHours'](0xc)-new Date(+_0x254ed6)['setHours'](0xc);return Math[_0x34ed41(0x2aa)](_0x225327/0x5265c00);}function updateItemExitUser(_0xfcb3d3,_0x594cfe,_0x49ac4e){var _0xba1301=a26_0x3809c0,_0x71482b=$[_0xba1301(0x25a)]();return $['ajax']({'url':_spPageContextInfo[_0xba1301(0x1e5)]+'/_api/web/lists/getbytitle(\x27'+_0xfcb3d3+_0xba1301(0x17a)+_0x49ac4e+'\x27)','type':'POST','headers':{'accept':_0xba1301(0x1c3),'X-RequestDigest':$(_0xba1301(0x28c))[_0xba1301(0x22c)](),'content-Type':'application/json;odata=verbose','X-Http-Method':'PATCH','If-Match':'*'},'data':JSON[_0xba1301(0x194)](_0x594cfe),'async':![],'success':function(_0x169b91){var _0x537ee2=_0xba1301;_0x71482b[_0x537ee2(0x23b)](!![]);},'error':function(_0x2049ff){_0x71482b['reject'](_0x2049ff);}}),_0x71482b[_0xba1301(0x232)]();}function AddItemToList(_0x46ccc0,_0x1d315c){var _0x445a09=a26_0x3809c0;UserEmailId=_0x1d315c[_0x445a09(0x254)];var _0x5349f6=_0x1d315c[_0x445a09(0x237)];EmployeeId='';var _0x50ac03=$[_0x445a09(0x25a)]();return $[_0x445a09(0x17b)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x445a09(0x209)+_0x46ccc0+_0x445a09(0x212),'type':'POST','async':![],'headers':{'accept':_0x445a09(0x1c3),'X-RequestDigest':$(_0x445a09(0x28c))[_0x445a09(0x22c)](),'content-Type':_0x445a09(0x1c3)},'data':JSON['stringify'](_0x1d315c),'success':function(_0x8a4163){var _0x211c4e=_0x445a09;EmployeeId=_0x8a4163['d']['Id'],counusers=counusers+0x1,AvilableLicenses=AvilableLicenses-0x1,Ready=Ready-0x1;var _0x216d18=excelRows['findIndex'](_0xa8f45e=>_0xa8f45e['Email\x20*']==UserEmailId);excelRows[_0x216d18]['Status']=_0x211c4e(0x233),showmessage();var _0x451ba3=GetSubSiteUrl(_0x211c4e(0x1ad),_0x8a4163['d'][_0x211c4e(0x171)]);AssignPermissiononDMSLibary(_0x8a4163['d'][_0x211c4e(0x1c1)],_0x211c4e(0x184),_0x451ba3),_0x50ac03[_0x211c4e(0x23b)](_0x8a4163);},'error':function(_0x5ce8bb){var _0x559699=_0x445a09;if(IsManager){var _0x27a909=excelRows['findIndex'](_0x3ffbbf=>_0x3ffbbf['Email\x20*']==UserEmailId);excelRows[_0x27a909][_0x559699(0x20e)]=_0x559699(0x1b7);}userfullname==''?(userfullname+=_0x5349f6,warningmessage=_0x559699(0x292)):userfullname+=_0x559699(0x1da)+_0x5349f6,Ready=Ready-0x1,Error=Error+0x1,console[_0x559699(0x198)](JSON['stringify'](_0x5ce8bb)),_0x50ac03[_0x559699(0x17d)](JSON[_0x559699(0x194)](_0x5ce8bb));}}),_0x50ac03[_0x445a09(0x232)]();}function LoadShowUser(_0x407010){var _0x184201=a26_0x3809c0;tabledata=new Tabulator(_0x184201(0x244),{'height':'','pagination':_0x184201(0x25d),'paginationSize':0xa,'layout':_0x184201(0x1cb),'paginationSizeSelector':[0xa,0x19,0x32,0x64],'placeholder':_0x184201(0x1d8),'data':_0x407010,'pageLoaded':function(_0xbaa152){var _0x1a688d=_0x184201;_0xbaa152>=0x1?pageIndex=_0xbaa152:pageIndex=_0xbaa152,IsMiisingSelect=document['getElementById']('IsMiisingSelected'),IsMiisingSelect['checked']&&$(_0x1a688d(0x264))[_0x1a688d(0x199)](_0x1a688d(0x1d5),!![]),isReadeySelect=document['getElementById']('isReadeySelected'),isReadeySelect[_0x1a688d(0x1d5)]&&$(_0x1a688d(0x16a))['prop']('checked',!![]);},'columns':[{'formatter':function(_0x1eb630,_0x5c05f8){var _0x1bc44d=_0x184201,_0x571c7c=_0x1eb630[_0x1bc44d(0x275)][_0x1bc44d(0x19f)][_0x1bc44d(0x1c0)][_0x1bc44d(0x20e)];return _0x571c7c==_0x1bc44d(0x1ee)||_0x571c7c==_0x1bc44d(0x286)||_0x571c7c==_0x1bc44d(0x233)||_0x571c7c==_0x1bc44d(0x1e9)?_0x1bc44d(0x1ac):'<input\x20type=\x22checkbox\x22\x20class=\x22select-row_isReadeySelected\x22\x20aria-label=\x22select\x20this\x20row\x22\x20/>';},'title':'<input\x20type=\x22checkbox\x22\x20id=\x22isReadeySelected\x22\x20onclick=\x22isReadeySelecteds()\x22\x20/>','field':'ID','width':'1%','headerSort':![],'cellClick':function(_0x5a0dd6,_0x52f8b3){var _0x12a00d=_0x184201,_0x454abb=$(_0x52f8b3['getElement']()),_0x484ebc=_0x454abb[_0x12a00d(0x24f)](_0x12a00d(0x16a));_0x484ebc[0x0][_0x12a00d(0x1d5)]==![]&&$(_0x52f8b3['getRow']()[_0x12a00d(0x28d)]())[_0x12a00d(0x24f)](_0x12a00d(0x264))[0x0][_0x12a00d(0x1d5)]==![]?_0x52f8b3['getRow']()['deselect']():_0x52f8b3[_0x12a00d(0x262)]()[_0x12a00d(0x206)]();}},{'formatter':function(_0x51a8ef,_0x3d971d){var _0x46d2f0=_0x184201,_0x419efd=_0x51a8ef[_0x46d2f0(0x275)][_0x46d2f0(0x19f)][_0x46d2f0(0x1c0)][_0x46d2f0(0x20e)];return _0x419efd==_0x46d2f0(0x286)||_0x419efd==_0x46d2f0(0x1ab)||_0x419efd==_0x46d2f0(0x1ed)?'<input\x20type=\x22checkbox\x22\x20class=\x22select-row_IsMiisingSelected\x22\x20aria-label=\x22select\x20this\x20row\x22\x20/>':_0x46d2f0(0x1ac);},'title':_0x184201(0x169),'hozAlign':_0x184201(0x1d7),'field':'ID','headerSort':![],'width':'1%','cellClick':function(_0x229c7f,_0x3d0f1a){var _0x1e1092=_0x184201,_0x5924b7=$(_0x3d0f1a[_0x1e1092(0x28d)]()),_0x433e51=_0x5924b7['find'](_0x1e1092(0x264));_0x433e51[0x0]['checked']==![]&&$(_0x3d0f1a[_0x1e1092(0x262)]()['getElement']())['find']('.select-row_isReadeySelected')[0x0]['checked']==![]?_0x3d0f1a[_0x1e1092(0x262)]()['deselect']():_0x3d0f1a[_0x1e1092(0x262)]()['select']();}},{'title':_0x184201(0x20e),'field':'Status','width':'8%','formatter':function(_0x5b24aa,_0x2860ed){var _0x15cdb1=_0x184201,_0x3ed882=_0x5b24aa[_0x15cdb1(0x260)]();if(_0x3ed882==_0x15cdb1(0x1ee)||_0x3ed882=='Required\x20Value\x20Missing'||_0x3ed882=='Not\x20SP\x20Permission'||_0x3ed882==_0x15cdb1(0x178))return _0x15cdb1(0x250)+_0x3ed882+_0x15cdb1(0x174);else return _0x3ed882=='Already\x20Exist'?_0x15cdb1(0x1fa)+_0x3ed882+_0x15cdb1(0x174):_0x15cdb1(0x1fe)+_0x3ed882+_0x15cdb1(0x174);}},{'title':'Type','field':_0x184201(0x1c8),'width':'10%'},{'title':_0x184201(0x1c2),'field':_0x184201(0x1c2),'width':'10%'},{'title':_0x184201(0x254),'field':_0x184201(0x1de),'align':_0x184201(0x279),'width':_0x184201(0x1cf)},{'title':_0x184201(0x19c),'field':'Company\x20*','width':'10%','align':_0x184201(0x1d7)},{'title':_0x184201(0x168),'field':_0x184201(0x2a7),'width':_0x184201(0x201),'align':_0x184201(0x1d7)},{'title':_0x184201(0x1fd),'field':_0x184201(0x175),'width':'8%','align':_0x184201(0x1d7)},{'title':'Designation','field':_0x184201(0x173),'width':_0x184201(0x201)},{'title':'Manager','field':_0x184201(0x1c5),'width':'10%'},{'title':_0x184201(0x20f),'field':'Date\x20Of\x20Joining','width':'10%'},{'title':'Group\x20Name','field':'Group\x20Name','width':_0x184201(0x201)}]}),showmessage(),$(_0x184201(0x27b))['html']('Total\x20Row\x20Count:\x20'),$(_0x184201(0x18c))[_0x184201(0x267)](),$(_0x184201(0x222))[_0x184201(0x18f)](_0x184201(0x220));}function showmessage(){var _0x5d66b7=a26_0x3809c0;$(_0x5d66b7(0x257))['text'](Ready),$(_0x5d66b7(0x202))['text'](Error),$(_0x5d66b7(0x255))[_0x5d66b7(0x1d2)](Exits),$(_0x5d66b7(0x1e6))[_0x5d66b7(0x1d2)](lblUpdate),$('#AvilableLicenses')['text'](AvilableLicenses);}function requestToken(){var _0x1d62ca=a26_0x3809c0;$[_0x1d62ca(0x17b)]({'async':!![],'crossDomain':!![],'url':ClientUrl,'method':_0x1d62ca(0x27c),'headers':{'content-type':'application/x-www-form-urlencoded'},'data':{'grant_type':_0x1d62ca(0x256),'client_id\x20':ClientId,'client_secret':ClentSecret,'scope\x20':'https://graph.microsoft.com/.default'},'success':function(_0x9c5b05){var _0x11938e=_0x1d62ca;console[_0x11938e(0x198)](_0x9c5b05),token=_0x9c5b05[_0x11938e(0x28b)];},'error':function(_0xcc5e00){var _0x37546e=_0x1d62ca;console[_0x37546e(0x198)](JSON[_0x37546e(0x194)](_0xcc5e00));}});}function GraphAccessTokenTogetUserDetails(){var _0x218098=a26_0x3809c0,_0x266b71=new jQuery[(_0x218098(0x25a))](),_0x4b4540={'X-RequestDigest':$('#__REQUESTDIGEST')[_0x218098(0x22c)](),'accept':_0x218098(0x1fb),'content-type':_0x218098(0x1fb)},_0xe667de={'resource':_0x218098(0x21d)};return $[_0x218098(0x17b)]({'url':_spPageContextInfo[_0x218098(0x1e5)]+_0x218098(0x1db),'headers':_0x4b4540,'type':_0x218098(0x27c),'async':![],'data':JSON[_0x218098(0x194)](_0xe667de),'success':function(_0x390b52){var _0xba1ee=_0x218098;token=_0x390b52[_0xba1ee(0x28b)],_0x266b71[_0xba1ee(0x23b)](token);},'error':function(_0x9b5999,_0x4dae8c,_0x39f545){var _0x2e908c=_0x218098;console[_0x2e908c(0x198)](_0x9b5999[_0x2e908c(0x207)]),_0x266b71[_0x2e908c(0x17d)](_0x9b5999[_0x2e908c(0x207)]);}}),_0x266b71[_0x218098(0x232)]();}var employeehtml='',userName='',AzureUsrlist=[],AdusersUrl=a26_0x3809c0(0x16d);function GetAzureUsrlist(_0x476200,_0x4c41a3){var _0x9a915b=a26_0x3809c0;return DeferredObj=$[_0x9a915b(0x25a)](),$[_0x9a915b(0x17b)]({'method':'GET','url':_0x476200,'headers':{'Authorization':_0x9a915b(0x234)+_0x4c41a3,'Content-Type':_0x9a915b(0x214)},'async':![],'success':function(_0x3183c5){var _0x31bc2c=_0x9a915b;AzureUsrlist=AzureUsrlist[_0x31bc2c(0x1a9)](_0x3183c5[_0x31bc2c(0x1c9)]),_0x3183c5[_0x31bc2c(0x191)]!=null&&(AdusersUrl=_0x3183c5[_0x31bc2c(0x191)],GetAzureUsrlist(AdusersUrl,_0x4c41a3));},'error':function(_0x926919){var _0x1dd59a=_0x9a915b;DeferredObj['reject'](_0x926919),alert(_0x1dd59a(0x24b)+JSON[_0x1dd59a(0x194)](_0x926919));}}),DeferredObj[_0x9a915b(0x232)]();}function a26_0x4c85(){var _0x330330=['#btnAudience','#btnmissingrequedvalue','Status','Date\x20Of\x20Joining','CompanyId','/_api/web/siteusers(@v)?@v=\x27','\x27)/items','input[type=radio][name=datasend]','application/json','mail','Welcome','_row','#AvilableLicenses','Metadata','Expires','Please\x20select\x20required\x20value\x20missing\x20row','9009891ijcUUD','https://graph.microsoft.com','658528GzKRiu','toString','<span\x20class=\x27breakpoint\x27></span>','ddlfilterAllCompanies','.tabulator-page-size','isReadeySelected','onchange','mm/dd/yy','width','please\x20check\x20at\x20list\x20one\x20checkbox\x20','onload','Gender','chkDesignation','#isReadeySelected','val','.searching','filter',')/users','undefined','select#dropDownId\x20option:selected','promise','Added','Bearer\x20','/_api/web/lists/GetByTitle(\x27Announcements\x27)/items','Companies','FullName','byteLength','findIndex','Country','resolve','SP.Data.','Data\x20Send\x20to\x20Announcements\x20Failed','ready','download','Employees','ddlOfficeLocation','/_api/web/siteusers?$top=1000&$select=*,Id','JoiningDate','#example-table','json','/_api/web/lists/getbytitle(\x27ExternalUsers\x27)/items?$select=*,InternalStakeholders/Title,Supervisor_Guest/Title,Client_Name/Title,LoginName/Title\x20&$expand=\x20LoginName,Client_Name,Supervisor_Guest,InternalStakeholders\x20&$filter=((Status\x20eq\x20\x27Initiated\x27)\x20or\x20(Status\x20eq\x20\x27Invited\x27\x20)or\x20(Status\x20eq\x20\x27Pending\x27)or\x20(Status\x20eq\x20\x27Accepted\x27))','chkTopExecutive','Chief\x20Executive','.sp-peoplepicker-editorInput','DOJ:\x20','error1','\x27)/items?$filter=Title\x20eq\x20\x27Client_Credentials\x27\x20','Publish_Date','Announcement_Type','find','\x20<span\x20style=\x27color:red;\x20font-weight:bold;\x27>','.form-check-input','#UploadExcel','close','Email','#Exits','client_credentials','#Ready','#divAudience','#btnDownLoadReport','Deferred','ddlfilterDepartments','Please\x20upload\x20a\x20valid\x20Excel\x20file.','local','ChangeFileName','done','getValue','target','getRow','/_api/web/lists/GetByTitle(\x27','.select-row_IsMiisingSelected','Designation','formatDate','remove','show','setPage','Postal\x20Address','SiteURL','OfficeName','getSelectedRows','removeProp','ddlfilterOfficeLocation','https://graph.microsoft.com/v1.0/users?$filter=mail\x20eq\x20\x27','Wrong\x20Manager','ddlAllCompanies','OfficeLocation','setData','_cell','Date\x20Of\x20Marriage','click','AllowMultipleValues','left','map','#Rowcount','POST','append','<h3\x20class=\x27m-0\x27>','/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=999&$select=ID,AttachmentFiles,FullName,Designation,Manager,MobileNumber,ExtensionName,Email,LogonName/UserName,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department,AttachmentFiles\x20&$filter=\x20PrimaryCompany\x20eq\x20\x27Primary\x27\x20and\x20Status\x20eq\x20\x27Active\x27\x20','413622mjACJm','837645gnRuRW','readonly','deselectRow','EmployeeSyncreport','EmployeeSyncReport.xlsx','Required\x20Value\x20Missing','chkOfficeLocation',',roleDefId=','fadeIn','siteAbsoluteUrl','access_token','#__REQUESTDIGEST','getElement','ddlDepartment','indexOf','AssaginTomanager','EmployeeOfficeLocation','The\x20following\x20users\x20failed\x20to\x20sync\x20due\x20to\x20wrong\x20manager\x20defined!.\x0a','CompanyIDId','datepicker','Corporate','results','Home\x20Phone','Date\x20Of\x20Birth','test','WebPartName','45463nlTUWb','2vatsLJ','fromCharCode','OfficeLocationsId','createElement','modal','Approved','__next','Sheets','Please\x20select\x20Location','sheet_to_row_object_array','chkDepartment','Department\x20*','User\x20has\x20been\x20assigned\x20permission\x20.','IsMiisingSelected','round','message','GET','#added','Department','<input\x20type=\x22checkbox\x22\x20id=\x22IsMiisingSelected\x22\x20onclick=\x22IsMiisingSelecteds()\x22\x20/>','.select-row_isReadeySelected','User,DL,SecGroup,SPGroup','fadeOut','https://graph.microsoft.com/beta/users?$top=100&$select=mail,displayName,userPrincipalName','251px','push','read','DepartmentId','This\x20browser\x20does\x20not\x20support\x20HTML5.','Designation\x20*','</span>','Location\x20*','readAsBinaryString','Email(Other)','Worng\x20Manager','SPClientPeoplePickerDict','\x27)/GetItemById(\x27','ajax','Employee\x20Code','reject','displayName','innerHTML','application/json;\x20odata=verbose','EmployeeName','Select\x20Company','All','1073741826','Office\x20Location\x20Id\x20is\x20not\x20Correct','charAt','dd\x20M\x20yy','change','PrincipalAccountType','#ddlfilterAllCompanies','Your\x20License\x20limit\x20has\x20been\x20ended','.breakpoint','New\x20Joinee','#overlaysearch','after','#UploadedItems','@odata.nextLink','#upload','files','stringify','&$top=1','ResolvePrincipalSource','OfficeLocationId','log','prop','option','DepartmentsId','Company','color-red','getQueryStringParameter','row','when','SearchPrincipalSource','City','chkGroup','Data\x20Send\x20to\x20Announcements','5090nASKXa','Title','getMonth','getElementById','concat','#successfully_notifications','Already\x20Exist','<input\x20type=\x22checkbox\x22\x20class=\x22\x22\x20disabled\x20/>','Departments','#ddlfilterOfficeLocation','/_api/web/lists/getByTitle(\x27DepartmentalDMS\x27)/roleassignments/addroleassignment(principalid=','fileUpload','<option\x20value=\x22','Group\x20Name','Internal\x20Users','toLowerCase','/_api/web/sitegroups/getbyname(\x27Contributors\x27)?$select=id','ApprovalStatus','Not\x20SP\x20Permission','ClientName','#IsMiisingSelected','static','/_api/web/lists/getByTitle(\x27Companies\x27)/items?$select=*&$top=4900','#txtmanager','#ddlfilterDepartments','12QQkvFT','chkManager','data','LogonNameId','Name','application/json;odata=verbose','exceltble','Manager\x20*','Please\x20select\x20Department','selectRow','Type','value','#btnsubmitready','fitColumns','Description','EmployeeId','SP.Data.AnnouncementsListItem','15%','EmployeeID','\x27)/items?$select=ID&$filter=ID\x20eq\x20','text','PIN/ZIP','SPClientPeoplePicker_InitStandaloneControlWrapper','checked','Width','center','Please\x20upload\x20xlsx\x20file','Company\x20*','\x20,\x20','/_api/SP.OAuth.Token/Acquire','result','CompanyName','Email\x20*','EntityData','</option>','#txtDesignation','#txtGroup','binary','html','webAbsoluteUrl','#lblUpdate','split','#ddlDepartment','Updated','4068639uUmIPI','i:0#.f|membership|','8MyUCPn','Ready','Invalid\x20Profile','/_api/web/lists/getByTitle(\x27','EmpUserId','#chkManager','DepartmentName','Company\x20Id\x20is\x20not\x20Correct','hide','7762328olsymH','length','toUpperCase','#btnFilter','#chkTopExecutive','\x20<span\x20style=\x27color:blue;\x20font-weight:bold;\x27>','application/json;odata=nometadata','ListItem','Location','\x20<span\x20style=\x27color:green;\x20font-weight:bold;\x27>','readAsArrayBuffer','UserType','10%','#Error','option:selected','focus','#ddlOfficeLocation','select','responseText','/_api/web/lists/getByTitle(\x27OfficeLocation\x27)/items?$select=*&$top=4900','/_api/web/lists/getbytitle(\x27','SP.User','appendChild'];a26_0x4c85=function(){return _0x330330;};return a26_0x4c85();}function getEmployee(_0xc6f10b){var _0x3d7641=a26_0x3809c0,_0x1a45f6=_0x3d7641(0x270)+_0xc6f10b+'\x27';return DeferredObj=$[_0x3d7641(0x25a)](),$[_0x3d7641(0x17b)]({'method':_0x3d7641(0x2ac),'url':_0x1a45f6,'headers':{'Authorization':'Bearer\x20'+token,'Content-Type':_0x3d7641(0x214)},'async':![],'success':function(_0x23b7da){var _0x2a4920=_0x3d7641;_0x23b7da['value'][_0x2a4920(0x1f6)]>0x0?DeferredObj['resolve'](_0x23b7da[_0x2a4920(0x1c9)][0x0][_0x2a4920(0x17e)]):DeferredObj[_0x2a4920(0x23b)]('Invalid\x20Profile');},'error':function(_0x1235a1){var _0x47e477=_0x3d7641;DeferredObj[_0x47e477(0x17d)](_0x1235a1),alert('error1'+JSON[_0x47e477(0x194)](_0x1235a1));}}),DeferredObj[_0x3d7641(0x232)]();}function ClientCredentials(){var _0x589a37=a26_0x3809c0,_0x208b5a='EnvironmentalSettings',_0x42bccf=titanForWork[_0x589a37(0x19e)](_0x589a37(0x210)),_0x44fdfe=_spPageContextInfo[_0x589a37(0x1e5)]+_0x589a37(0x263)+_0x208b5a+_0x589a37(0x24c);$['ajax']({'url':_0x44fdfe,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x2f1652){var _0x29b64f=_0x589a37,_0xac26ce=_0x2f1652['d'][_0x29b64f(0x296)];ClientId=_0xac26ce[0x0][_0x29b64f(0x1b8)],ClentSecret=_0xac26ce[0x0][_0x29b64f(0x25e)],ClientUrl=_0xac26ce[0x0][_0x29b64f(0x1cc)];},'error':function(_0x1697b6){var _0x23baef=_0x589a37;console[_0x23baef(0x198)](_0x1697b6);}});}var EmployeeListUsers=[],GetQueryURL=_spPageContextInfo[a26_0x3809c0(0x1e5)]+a26_0x3809c0(0x27f);function GetEmployees(){var _0x530cf8=a26_0x3809c0;$[_0x530cf8(0x17b)]({'url':GetQueryURL,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'beforeSend':function(){},'success':function(_0x593789){var _0x14dd95=_0x530cf8;EmployeeListUsers=EmployeeListUsers[_0x14dd95(0x1a9)](_0x593789['d'][_0x14dd95(0x296)]);if(_0x593789['d'][_0x14dd95(0x2a2)]!=null)GetQueryURL=_0x593789['d'][_0x14dd95(0x2a2)],GetEmployees();else{GetQueryURL=_spPageContextInfo[_0x14dd95(0x1e5)]+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=999&$select=ID,AttachmentFiles,FullName,Designation,Manager,MobileNumber,ExtensionName,Email,LogonName/UserName,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department,AttachmentFiles\x20&$filter=\x20PrimaryCompany\x20eq\x20\x27Primary\x27\x20and\x20Status\x20eq\x20\x27Active\x27\x20';var _0x2d691b='',_0x40a05a=_spPageContextInfo[_0x14dd95(0x1e5)]+_0x14dd95(0x246);extdfds=$[_0x14dd95(0x25a)](),$[_0x14dd95(0x1a0)](getItems(_0x40a05a,extdfds))[_0x14dd95(0x25f)](function(_0x2d2b40){response=[],_0x2d691b=_0x2d2b40['length'];});}AvilableLicenses=parseInt(UsersLicenceRequired)-(parseInt(EmployeeListUsers[_0x14dd95(0x1f6)])+parseInt(_0x2d691b));},'error':function(_0x52c477){console['log'](_0x52c477);}});}var fileUploadevent=document[a26_0x3809c0(0x1a8)](a26_0x3809c0(0x1b0));fileUploadevent['onclick']=function(){var _0x5232ab=a26_0x3809c0;EmployeeListUsers=[],AvilableLicenses=0x0,this[_0x5232ab(0x1c9)]=null;},fileUploadevent[a26_0x3809c0(0x224)]=function(){$['ajax']({'cache':![],'beforeSend':function(){var _0x4a1e62=a26_0x34db;$(_0x4a1e62(0x18e))[_0x4a1e62(0x289)]();},'success':function(_0xf51ed7){var _0x1b4488=a26_0x34db,_0x24bddf=document[_0x1b4488(0x1a8)](_0x1b4488(0x1b0));AzureUsrlist[_0x1b4488(0x1f6)]==0x0&&GetAzureUsrlist(AdusersUrl,token);AvilableLicenses=0x0,GetEmployees(),LoadShowUser([]),Ready=0x0,Error=0x0,lblUpdate=0x0,counusers=0x0,Exits=0x0,$(_0x1b4488(0x257))['text'](0x0),$(_0x1b4488(0x202))['text'](0x0),$('#added')['text'](0x0),$(_0x1b4488(0x1e6))[_0x1b4488(0x1d2)](0x0),$(_0x1b4488(0x255))[_0x1b4488(0x1d2)](0x0);var _0x47f593=/^([a-zA-Z0-9\s_\\.\-:])+(.xls|.xlsx)$/;if(_0x47f593[_0x1b4488(0x299)](_0x24bddf['value'][_0x1b4488(0x1b4)]())){if(typeof FileReader!=_0x1b4488(0x230)){var _0x158e6=new FileReader();_0x158e6['readAsBinaryString']?(_0x158e6[_0x1b4488(0x228)]=function(_0x22d486){var _0x5e70d8=_0x1b4488;ProcessExcel(_0x22d486['target'][_0x5e70d8(0x1dc)]);},_0x158e6['readAsBinaryString'](_0x24bddf[_0x1b4488(0x193)][0x0])):(_0x158e6[_0x1b4488(0x228)]=function(_0x21b3b6){var _0xc5b6f1=_0x1b4488,_0x20be75='',_0x92100a=new Uint8Array(_0x21b3b6[_0xc5b6f1(0x261)][_0xc5b6f1(0x1dc)]);for(var _0x3c7859=0x0;_0x3c7859<_0x92100a['byteLength'];_0x3c7859++){_0x20be75+=String[_0xc5b6f1(0x29d)](_0x92100a[_0x3c7859]);}ProcessExcel(_0x20be75);},_0x158e6['readAsArrayBuffer'](_0x24bddf[_0x1b4488(0x193)][0x0]));}else alert(_0x1b4488(0x172));}else alert(_0x1b4488(0x25c));$(_0x1b4488(0x18e))[_0x1b4488(0x16c)]();}});},$(function(){var _0x1e3339=a26_0x3809c0;$(_0x1e3339(0x192))[_0x1e3339(0x277)](function(){var _0x1693ce=_0x1e3339,_0x56262a=document[_0x1693ce(0x1a8)](_0x1693ce(0x1b0));GetEmployees(),LoadShowUser([]),Ready=0x0,Error=0x0,counusers=0x0;var _0x3baa86=/^([a-zA-Z0-9\s_\\.\-:])+(.xls|.xlsx)$/;if(_0x3baa86[_0x1693ce(0x299)](_0x56262a[_0x1693ce(0x1c9)]['toLowerCase']())){if(typeof FileReader!='undefined'){var _0x75b815=new FileReader();_0x75b815[_0x1693ce(0x176)]?(_0x75b815[_0x1693ce(0x228)]=function(_0x2f7935){var _0x2e24b3=_0x1693ce;ProcessExcel(_0x2f7935[_0x2e24b3(0x261)]['result']);},_0x75b815[_0x1693ce(0x176)](_0x56262a[_0x1693ce(0x193)][0x0])):(_0x75b815[_0x1693ce(0x228)]=function(_0x4195d1){var _0x4d6692=_0x1693ce,_0x18980c='',_0x16a5b2=new Uint8Array(_0x4195d1[_0x4d6692(0x261)]['result']);for(var _0x14ae90=0x0;_0x14ae90<_0x16a5b2[_0x4d6692(0x238)];_0x14ae90++){_0x18980c+=String[_0x4d6692(0x29d)](_0x16a5b2[_0x14ae90]);}ProcessExcel(_0x18980c);},_0x75b815[_0x1693ce(0x1ff)](_0x56262a[_0x1693ce(0x193)][0x0]));}else alert(_0x1693ce(0x172));}else alert(_0x1693ce(0x25c));});});function ProcessExcel(_0x37c0db){var _0x1ee137=a26_0x3809c0,_0x20df67=XLSX[_0x1ee137(0x170)](_0x37c0db,{'type':_0x1ee137(0x1e3)}),_0x585594=_0x20df67['SheetNames'][0x0];excelRows=XLSX['utils'][_0x1ee137(0x2a5)](_0x20df67[_0x1ee137(0x2a3)][_0x585594]),$(_0x1ee137(0x190))['empty'](),$(_0x1ee137(0x190))[_0x1ee137(0x27d)](_0x1ee137(0x27e)+excelRows[_0x1ee137(0x1f6)]+'</h3>\x20<p\x20class\x20=\x20\x22m-0\x22\x20>\x20Uploaded\x20</p>'),$('#dvExcel')[_0x1ee137(0x1e4)]('');for(var _0xaf8e52=0x0;_0xaf8e52<excelRows[_0x1ee137(0x1f6)];_0xaf8e52++){var _0x382716='';ErrorUser='';var _0x26a600=EmployeeListUsers[_0x1ee137(0x22e)](function(_0x3f5ac5){var _0x113dca=_0x1ee137,_0x1bc548=_0x3f5ac5[_0x113dca(0x254)][_0x113dca(0x1b4)]();return _0x1bc548==excelRows[_0xaf8e52]['Email\x20*']['toLowerCase']();});if(_0x26a600[_0x1ee137(0x1f6)]>0x0){_0x382716=_0x26a600[0x0]['FullName'],color_red=_0x1ee137(0x19d),ErrorUser=_0x1ee137(0x1ab),Exits=Exits+0x1;var _0x3d08de=_0x26a600[0x0]['ID'];excelRows[_0xaf8e52][_0x1ee137(0x1d9)]='-',excelRows[_0xaf8e52]['Department\x20*']='-',excelRows[_0xaf8e52][_0x1ee137(0x175)]='-';}else{var _0x4446ad=AzureUsrlist[_0x1ee137(0x22e)](function(_0x24bd95){var _0x4bfbc9=_0x1ee137;if(_0x24bd95['mail']!=null){var _0x47c2e1=_0x24bd95[_0x4bfbc9(0x215)][_0x4bfbc9(0x1b4)]();return _0x47c2e1==excelRows[_0xaf8e52][_0x4bfbc9(0x1de)][_0x4bfbc9(0x1b4)]();}});if(_0x4446ad[_0x1ee137(0x1f6)]>0x0){_0x382716=_0x4446ad[0x0][_0x1ee137(0x17e)];var _0x2118bd=AllCompanies[_0x1ee137(0x22e)](function(_0x389cbe){var _0x1bf20c=_0x1ee137;return _0x389cbe['ID']==excelRows[_0xaf8e52][_0x1bf20c(0x1d9)];}),_0xb54e28=AllDepartments[_0x1ee137(0x22e)](function(_0x571b48){var _0x24d05f=_0x1ee137;return _0x571b48['ID']==excelRows[_0xaf8e52][_0x24d05f(0x2a7)];}),_0x17e9d4=AllOfficeLocation['filter'](function(_0x7ad236){var _0x4cd47d=_0x1ee137;return _0x7ad236['ID']==excelRows[_0xaf8e52][_0x4cd47d(0x175)];});_0x2118bd[_0x1ee137(0x1f6)]>0x0&&_0xb54e28[_0x1ee137(0x1f6)]>0x0&&_0x17e9d4[_0x1ee137(0x1f6)]>0x0?(Ready=Ready+0x1,ErrorUser='Ready',excelRows[_0xaf8e52]['DepartmentNameDetail']=_0xb54e28[0x0][_0x1ee137(0x1f2)],excelRows[_0xaf8e52]['OfficeNameDetail']=_0x17e9d4[0x0][_0x1ee137(0x26c)]):(ErrorUser=_0x1ee137(0x286),Error=Error+0x1);}else ErrorUser=_0x1ee137(0x1ee),color_red='color-red',Error=Error+0x1;}excelRows[_0xaf8e52][_0x1ee137(0x1c2)]=_0x382716,excelRows[_0xaf8e52]['id']=_0xaf8e52,excelRows[_0xaf8e52][_0x1ee137(0x20e)]=ErrorUser,excelRows[_0xaf8e52][_0x1ee137(0x1f0)]=_0x3d08de;}alluserdata=excelRows,LoadShowUser(excelRows);}function CompaniesDetails(){var _0x58cd16=a26_0x3809c0,_0x5d2412=document['getElementById'](_0x58cd16(0x272));_0x5d2412['innerHTML']='',opt[_0x58cd16(0x1c9)]='0',opt[_0x58cd16(0x1d2)]=_0x58cd16(0x182),_0x5d2412[_0x58cd16(0x20b)](opt);for(var _0x99115d=0x0;_0x99115d<AllCompanies[_0x58cd16(0x1f6)];_0x99115d++){var _0x4386ad=AllCompanies[_0x99115d][_0x58cd16(0x1dd)],_0x1618bc=AllCompanies[_0x99115d]['ID'];opt=document[_0x58cd16(0x29f)](_0x58cd16(0x19a)),opt[_0x58cd16(0x1c9)]=_0x1618bc,opt[_0x58cd16(0x1d2)]=_0x4386ad,_0x5d2412[_0x58cd16(0x20b)](opt);}$(_0x58cd16(0x251))[_0x58cd16(0x199)](_0x58cd16(0x1d5),![]),$(_0x58cd16(0x1bc))[_0x58cd16(0x22c)](''),$(_0x58cd16(0x1e2))[_0x58cd16(0x22c)](''),$(_0x58cd16(0x1e1))[_0x58cd16(0x22c)]('');}$('#btnUploadExcel')[a26_0x3809c0(0x277)](function(){var _0x240236=a26_0x3809c0,_0x6d8897=tabledata[_0x240236(0x26d)]();debugger;_0x6d8897[_0x240236(0x1f6)]>0x0?(CompaniesDetails(),$(_0x240236(0x252))[_0x240236(0x2a0)](_0x240236(0x268)),initializePeoplePicker(_0x240236(0x290)),peoplePickerDiv=$('[id$=\x27AssaginTomanager_TopSpan\x27]')):alert(_0x240236(0x21b));});var GetDepartments,Getofficelocation,GetDesignation,GetGroup,CompaniesId;$(a26_0x3809c0(0x20d))[a26_0x3809c0(0x277)](function(){var _0x49977a=a26_0x3809c0;if(document[_0x49977a(0x1a8)](_0x49977a(0x2a6))[_0x49977a(0x1d5)]==!![]||document[_0x49977a(0x1a8)](_0x49977a(0x287))['checked']==!![]||document[_0x49977a(0x1a8)](_0x49977a(0x22a))['checked']==!![]||document[_0x49977a(0x1a8)](_0x49977a(0x1bf))[_0x49977a(0x1d5)]==!![]||document[_0x49977a(0x1a8)](_0x49977a(0x247))[_0x49977a(0x1d5)]==!![]||document[_0x49977a(0x1a8)](_0x49977a(0x1a3))['checked']==!![]){var _0x3a8874=tabledata['getSelectedRows'](),_0x2a0a8d=SPClientPeoplePicker[_0x49977a(0x179)][peoplePickerDiv[0x0]['id']],_0x2a84a5=_0x2a0a8d['GetAllUserInfo']();for(var _0x13f301=0x0;_0x13f301<_0x3a8874['length'];_0x13f301++){var _0x331b38=excelRows[_0x49977a(0x239)](_0x13d426=>_0x13d426[_0x49977a(0x1de)]==_0x3a8874[_0x13f301]['_row']['data'][_0x49977a(0x1de)]);if(excelRows[_0x331b38][_0x49977a(0x20e)]=='Already\x20Exist')excelRows[_0x331b38][_0x49977a(0x1d9)]='-',excelRows[_0x331b38][_0x49977a(0x2a7)]='-',excelRows[_0x331b38][_0x49977a(0x175)]='-',document[_0x49977a(0x1a8)](_0x49977a(0x22a))[_0x49977a(0x1d5)]&&(excelRows[_0x331b38][_0x49977a(0x173)]=$('#txtDesignation')[_0x49977a(0x22c)]()),document[_0x49977a(0x1a8)](_0x49977a(0x1bf))[_0x49977a(0x1d5)]&&(excelRows[_0x331b38]['Manager\x20*']=_0x2a84a5[0x0][_0x49977a(0x1df)]['Email']),document[_0x49977a(0x1a8)](_0x49977a(0x247))['checked']&&(excelRows[_0x331b38][_0x49977a(0x1c5)]='Chief\x20Executive'),document['getElementById'](_0x49977a(0x1a3))['checked']&&(excelRows[_0x331b38][_0x49977a(0x1b2)]=$(_0x49977a(0x1e2))['val']());else{if(excelRows[_0x331b38][_0x49977a(0x20e)]=='Required\x20Value\x20Missing'||excelRows[_0x331b38][_0x49977a(0x20e)]=='Ready'){document[_0x49977a(0x1a8)]('chkDepartment')[_0x49977a(0x1d5)]&&(excelRows[_0x331b38][_0x49977a(0x1d9)]=CompaniesId,excelRows[_0x331b38]['Department\x20*']=GetDepartments);document[_0x49977a(0x1a8)](_0x49977a(0x287))[_0x49977a(0x1d5)]&&(excelRows[_0x331b38][_0x49977a(0x1d9)]=CompaniesId,excelRows[_0x331b38][_0x49977a(0x175)]=Getofficelocation);document['getElementById'](_0x49977a(0x22a))[_0x49977a(0x1d5)]&&(excelRows[_0x331b38][_0x49977a(0x173)]=$(_0x49977a(0x1e1))[_0x49977a(0x22c)]());document[_0x49977a(0x1a8)]('chkManager')[_0x49977a(0x1d5)]&&(excelRows[_0x331b38][_0x49977a(0x1c5)]=_0x2a84a5[0x0][_0x49977a(0x1df)][_0x49977a(0x254)]);document['getElementById'](_0x49977a(0x247))[_0x49977a(0x1d5)]&&(excelRows[_0x331b38][_0x49977a(0x1c5)]=_0x49977a(0x248));document[_0x49977a(0x1a8)]('chkGroup')[_0x49977a(0x1d5)]&&(excelRows[_0x331b38][_0x49977a(0x1b2)]=$('#txtGroup')['val']());var _0x59a656=AllCompanies[_0x49977a(0x22e)](function(_0x17ef8d){return _0x17ef8d['ID']==excelRows[_0x331b38]['Company\x20*'];}),_0x2ac5e4=AllDepartments[_0x49977a(0x22e)](function(_0x3cbc86){var _0x1c3ed0=_0x49977a;return _0x3cbc86['ID']==excelRows[_0x331b38][_0x1c3ed0(0x2a7)];}),_0x4e009c=AllOfficeLocation[_0x49977a(0x22e)](function(_0x525d75){var _0x2bb925=_0x49977a;return _0x525d75['ID']==excelRows[_0x331b38][_0x2bb925(0x175)];});_0x59a656[_0x49977a(0x1f6)]>0x0&&_0x2ac5e4[_0x49977a(0x1f6)]>0x0&&_0x4e009c[_0x49977a(0x1f6)]>0x0?(Ready=Ready+0x1,Error=Error-0x1,excelRows[_0x331b38][_0x49977a(0x20e)]='Ready'):(excelRows[_0x331b38][_0x49977a(0x20e)]='Required\x20Value\x20Missing',Error=Error+0x1);}else excelRows[_0x331b38]['Status']==_0x49977a(0x271)&&(document['getElementById'](_0x49977a(0x22a))[_0x49977a(0x1d5)]&&(excelRows[_0x331b38][_0x49977a(0x173)]=$(_0x49977a(0x1e1))['val']()),document[_0x49977a(0x1a8)](_0x49977a(0x1bf))[_0x49977a(0x1d5)]&&(excelRows[_0x331b38][_0x49977a(0x1c5)]=_0x2a84a5[0x0]['EntityData'][_0x49977a(0x254)]),document[_0x49977a(0x1a8)](_0x49977a(0x247))[_0x49977a(0x1d5)]&&(excelRows[_0x331b38]['Manager\x20*']=_0x49977a(0x248)),document[_0x49977a(0x1a8)](_0x49977a(0x1a3))[_0x49977a(0x1d5)]&&(excelRows[_0x331b38][_0x49977a(0x1b2)]=$('#txtGroup')[_0x49977a(0x22c)]()),Ready=Ready+0x1,Error=Error-0x1,excelRows[_0x331b38][_0x49977a(0x20e)]=_0x49977a(0x1ed));}}tabledata[_0x49977a(0x274)](excelRows),tabledata[_0x49977a(0x269)](pageIndex),$(_0x49977a(0x252))['modal'](_0x49977a(0x1f4)),showmessage();}else alert(_0x49977a(0x227)),$(_0x49977a(0x231))[_0x49977a(0x22c)]();}),$('#ddlAllCompanies')['change'](function(){var _0x43d50f=a26_0x3809c0;CompaniesId=parseInt($('option:selected',$(this))[_0x43d50f(0x22c)]());var _0x6516=AllOfficeLocation[_0x43d50f(0x22e)](function(_0x39032b){var _0x5d6c5a=_0x43d50f;return _0x39032b[_0x5d6c5a(0x293)]===CompaniesId;}),_0x273524=document[_0x43d50f(0x1a8)](_0x43d50f(0x241));_0x273524[_0x43d50f(0x17f)]='';for(var _0x5e0a8b=0x0;_0x5e0a8b<_0x6516['length'];_0x5e0a8b++){var _0x5c2a48=_0x6516[_0x5e0a8b]['OfficeName'],_0x22cd73=_0x6516[_0x5e0a8b]['ID'];opt=document[_0x43d50f(0x29f)]('option'),opt[_0x43d50f(0x1c9)]=_0x22cd73,opt[_0x43d50f(0x1d2)]=_0x5c2a48,_0x273524[_0x43d50f(0x20b)](opt);}Getofficelocation=parseInt($(_0x43d50f(0x203),$('#ddlOfficeLocation'))['val']());var _0x29ba0f=AllDepartments['filter'](function(_0x49bd78){return _0x49bd78['CompanyIDId']===CompaniesId;}),_0x273524=document[_0x43d50f(0x1a8)](_0x43d50f(0x28e));_0x273524[_0x43d50f(0x17f)]='';for(var _0x5e0a8b=0x0;_0x5e0a8b<_0x29ba0f[_0x43d50f(0x1f6)];_0x5e0a8b++){var _0x5c2a48=_0x29ba0f[_0x5e0a8b][_0x43d50f(0x1f2)],_0x22cd73=_0x29ba0f[_0x5e0a8b]['ID'];opt=document[_0x43d50f(0x29f)](_0x43d50f(0x19a)),opt[_0x43d50f(0x1c9)]=_0x22cd73,opt[_0x43d50f(0x1d2)]=_0x5c2a48,_0x273524[_0x43d50f(0x20b)](opt);}GetDepartments=parseInt($('option:selected',$(_0x43d50f(0x1e8)))[_0x43d50f(0x22c)]());}),$('#ddlDepartment')[a26_0x3809c0(0x188)](function(){var _0x2ee124=a26_0x3809c0;GetDepartments=parseInt($('option:selected',$(this))[_0x2ee124(0x22c)]());}),$(a26_0x3809c0(0x205))[a26_0x3809c0(0x188)](function(){var _0x37492d=a26_0x3809c0;Getofficelocation=parseInt($(_0x37492d(0x203),$(this))['val']());});function chkManagerevent(_0xbf5172){var _0x2b55d1=a26_0x3809c0;if(_0xbf5172[_0x2b55d1(0x1d5)])$(_0x2b55d1(0x1f9))[_0x2b55d1(0x199)]('checked',![]),$(_0x2b55d1(0x1bc))[_0x2b55d1(0x26e)](_0x2b55d1(0x282)),$(_0x2b55d1(0x1bc))[_0x2b55d1(0x204)]();else{}}var TopExecutive='';function chkTopExecutiveevent(_0x2bee6e){var _0x1b7276=a26_0x3809c0;if(_0x2bee6e[_0x1b7276(0x1d5)])$(_0x1b7276(0x1f1))[_0x1b7276(0x199)](_0x1b7276(0x1d5),![]),$('#txtmanager')[_0x1b7276(0x199)](_0x1b7276(0x282),!![]),$(_0x1b7276(0x1bc))['val'](''),TopExecutive=_0x1b7276(0x248);else{}}$(a26_0x3809c0(0x259))[a26_0x3809c0(0x277)](function(){var _0x30f1a9=a26_0x3809c0;tabledata[_0x30f1a9(0x23f)]('xlsx',_0x30f1a9(0x285),{'sheetName':_0x30f1a9(0x284)});});var dvExcel=document[a26_0x3809c0(0x1a8)](a26_0x3809c0(0x1c4));dvExcel[a26_0x3809c0(0x17f)]='';var outputArray=[];function removewithfilter(_0x2e731d){let _0x432858=_0x2e731d['filter'](function(_0x1b9450,_0x315ab6,_0x1d1d7d){var _0x142784=a26_0x34db;return _0x315ab6==_0x1d1d7d[_0x142784(0x28f)](_0x1b9450);});return _0x432858;}function GetItemTypeForListName(_0x246d01){var _0x52eba2=a26_0x3809c0;return _0x52eba2(0x23c)+_0x246d01[_0x52eba2(0x186)](0x0)[_0x52eba2(0x1f7)]()+_0x246d01[_0x52eba2(0x1e7)]('\x20')['join']('')['slice'](0x1)+_0x52eba2(0x1fc);}var response=response||[];function getItems(_0x50ac9f,_0x115200){var _0x261018=a26_0x3809c0;return $['ajax']({'url':_0x50ac9f,'type':_0x261018(0x2ac),'async':![],'headers':{'accept':_0x261018(0x1c3)},'success':function(_0x217155){var _0x1664ea=_0x261018;response=response[_0x1664ea(0x1a9)](_0x217155['d'][_0x1664ea(0x296)]),_0x217155['d'][_0x1664ea(0x2a2)]?(_0x50ac9f=_0x217155['d'][_0x1664ea(0x2a2)],getItems(_0x50ac9f,_0x115200)):_0x115200[_0x1664ea(0x23b)](response);},'error':function(_0x272f8c){var _0x12ac9d=_0x261018;_0x115200[_0x12ac9d(0x17d)](_0x272f8c),console[_0x12ac9d(0x198)](_0x272f8c);}}),_0x115200[_0x261018(0x232)]();}function ConvertddmmyyTommddyy(_0x28b3de){var _0x4d5047=a26_0x3809c0;return _0x28b3de[_0x4d5047(0x1e7)]('/')[0x1]+'/'+_0x28b3de[_0x4d5047(0x1e7)]('/')[0x0]+'/'+_0x28b3de[_0x4d5047(0x1e7)]('/')[0x2];}function InsertWelcomeInAnnouncementList(_0x20967f){var _0x414629=a26_0x3809c0;$[_0x414629(0x17b)]({'url':_spPageContextInfo[_0x414629(0x1e5)]+_0x414629(0x235),'type':_0x414629(0x27c),'async':![],'data':JSON['stringify'](_0x20967f),'headers':{'Accept':'application/json;odata=verbose','Content-Type':_0x414629(0x1c3),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x414629(0x22c)](),'X-HTTP-Method':_0x414629(0x27c)},'success':function(_0x521139,_0x5ed81a,_0x1db4a9){var _0x1ac3d3=_0x414629;console[_0x1ac3d3(0x198)](_0x1ac3d3(0x1a4));},'error':function(_0x204b54){var _0x5cd495=_0x414629;console[_0x5cd495(0x198)](_0x204b54),console[_0x5cd495(0x198)](_0x5cd495(0x23d)),currentDlg[_0x5cd495(0x253)]();}});}