var a26_0x32bc6b=a26_0x5e8c;(function(_0x302cab,_0x67edfa){var _0x58c705=a26_0x5e8c,_0x5124ab=_0x302cab();while(!![]){try{var _0x1d35d1=-parseInt(_0x58c705(0xe1))/0x1+parseInt(_0x58c705(0x1d5))/0x2*(-parseInt(_0x58c705(0x18e))/0x3)+parseInt(_0x58c705(0x1b2))/0x4*(parseInt(_0x58c705(0x1bc))/0x5)+-parseInt(_0x58c705(0x122))/0x6+-parseInt(_0x58c705(0xd5))/0x7+-parseInt(_0x58c705(0xc8))/0x8+parseInt(_0x58c705(0x15a))/0x9;if(_0x1d35d1===_0x67edfa)break;else _0x5124ab['push'](_0x5124ab['shift']());}catch(_0x1a4a63){_0x5124ab['push'](_0x5124ab['shift']());}}}(a26_0x25be,0xe9290));function a26_0x5e8c(_0x583273,_0x5511cd){var _0x25be08=a26_0x25be();return a26_0x5e8c=function(_0x5e8cb7,_0x5791dd){_0x5e8cb7=_0x5e8cb7-0xaa;var _0x35399e=_0x25be08[_0x5e8cb7];return _0x35399e;},a26_0x5e8c(_0x583273,_0x5511cd);}var token,ClientId='',ClentSecret='',ClientUrl='',DeferredObj=$['Deferred'](),color_red='',Error=0x0,Ready=0x0,Exits=0x0,lblUpdate=0x0,ErrorUser='',alluserdata,contributersGroupId='',counusers=0x0,excelRows,AllCompanies,AllDepartments,AllOfficeLocation,tabledata,pageIndex,UserEmailId,warningmessage='',userfullname='',AvilableLicenses,ReadySelected=[],MiisingSelected=[],AddedEmployeeList=[],IsMiisingSelect,isReadeySelect,peoplePickerDiv='',IsaddedNewEmployee=![],EmployeeId='',EmployeeDepartment='',EmployeeOfficeLocation='',checkedAudience='',IsNotification=![];$(document)[a26_0x32bc6b(0x10c)](function(){var _0x3cfd90=a26_0x32bc6b;GraphAccessTokenTogetUserDetails(),GetCompanies(),GetOfficeLocation(),GetDepartments(),LoadShowUser([]),GetAllUserId(),GetEmployees(),$('#AvilableLicenses')[_0x3cfd90(0x135)](AvilableLicenses);});function initializePeoplePicker(_0x24243a){var _0x5576e8=a26_0x32bc6b,_0x230078={};_0x230078[_0x5576e8(0xb4)]=_0x5576e8(0x1c0),_0x230078[_0x5576e8(0x119)]=0xf,_0x230078['ResolvePrincipalSource']=0xf,_0x230078['AllowMultipleValues']=![],_0x230078[_0x5576e8(0x1d7)]=0x32,_0x230078['Width']=_0x5576e8(0x101),this[_0x5576e8(0x15c)](_0x24243a,null,_0x230078),$(_0x5576e8(0xaf))[_0x5576e8(0x169)](0xfa);}function GetSelectItem(){var _0x1a5ddf=a26_0x32bc6b;IsaddedNewEmployee=![];if(contributersGroupId!==''){var _0x11b9c8=tabledata[_0x1a5ddf(0x132)]();counusers=0x0;for(var _0x567adb=0x0;_0x567adb<_0x11b9c8[_0x1a5ddf(0x12e)];_0x567adb++){var _0x111e0d=alluserdata[_0x1a5ddf(0x159)](function(_0x429356){var _0x871e6a=_0x1a5ddf;return _0x429356[_0x871e6a(0xab)]==_0x11b9c8[_0x567adb][_0x871e6a(0x182)][_0x871e6a(0xc4)][_0x871e6a(0xab)];});AvilableLicenses>0x0?_0x111e0d[0x0][_0x1a5ddf(0x11c)]==_0x1a5ddf(0x121)?(AddNewEmployeeAllocated(_0x111e0d,_0x1a5ddf(0x164)),IsaddedNewEmployee=!![]):_0x111e0d[0x0][_0x1a5ddf(0x11c)]==_0x1a5ddf(0x1dd)&&UpdateExistingEmployeeAllocated(_0x111e0d,_0x1a5ddf(0x164)):($(_0x1a5ddf(0x127))[_0x1a5ddf(0x135)](counusers),alert(_0x1a5ddf(0x1b7)),_0x567adb=_0x11b9c8[_0x1a5ddf(0x12e)]);}warningmessage!=''&&(warningmessage+=userfullname,alert(warningmessage)),$('#added')[_0x1a5ddf(0x135)](counusers),showmessage(),tabledata[_0x1a5ddf(0xe3)](excelRows),tabledata[_0x1a5ddf(0x1ad)](pageIndex),IsaddedNewEmployee&&($(_0x1a5ddf(0x12a))['modal']({'backdrop':_0x1a5ddf(0x118),'keyboard':![]},_0x1a5ddf(0x1c4)),AddedEmployeeList['length']>0x0?$(_0x1a5ddf(0x14c))[_0x1a5ddf(0x1c4)]():$(_0x1a5ddf(0x14c))[_0x1a5ddf(0xf5)]());}else GetGroupIDByGroupName(),GetSelectItem();}var Temparray=[];$('#btnFilter')[a26_0x32bc6b(0x106)](function(){var _0xc5449d=a26_0x32bc6b;debugger;Temparray=alluserdata;let _0x2f7a63=[...new Set(Temparray['map'](_0x472af4=>_0x472af4['Company\x20*']))];var _0x173592=document[_0xc5449d(0x1c6)]('ddlfilterAllCompanies');_0x173592[_0xc5449d(0x128)]='',opt[_0xc5449d(0xb8)]='0',opt[_0xc5449d(0x135)]=_0xc5449d(0x10b),_0x173592['appendChild'](opt);for(var _0x4c6d70=0x0;_0x4c6d70<_0x2f7a63[_0xc5449d(0x12e)];_0x4c6d70++){opt=document[_0xc5449d(0x108)](_0xc5449d(0x16b)),opt[_0xc5449d(0xb8)]=_0x2f7a63[_0x4c6d70],opt[_0xc5449d(0x135)]=_0x2f7a63[_0x4c6d70],_0x173592[_0xc5449d(0xf0)](opt);}Temparray=alluserdata;var _0x4f54ee=[...new Set(Temparray[_0xc5449d(0x1d9)](_0x607e7f=>_0x607e7f[_0xc5449d(0x13d)]))],_0x173592=document[_0xc5449d(0x1c6)](_0xc5449d(0x111)),_0x3bcd3e='<option\x20value=\x220\x22><strong>All</strong></option>';for(var _0x4c6d70=0x0;_0x4c6d70<_0x4f54ee[_0xc5449d(0x12e)];_0x4c6d70++){_0x3bcd3e+=_0xc5449d(0xeb)+_0x4f54ee[_0x4c6d70]+'\x22>'+_0x4f54ee[_0x4c6d70]+'</option>';}$('#ddlfilterOfficeLocation')[_0xc5449d(0x199)](_0x3bcd3e),Temparray=alluserdata;let _0x587c3d=[...new Set(Temparray[_0xc5449d(0x1d9)](_0x5f3dd2=>_0x5f3dd2[_0xc5449d(0x15d)]))];var _0x173592=document['getElementById'](_0xc5449d(0xb0));_0x173592[_0xc5449d(0x128)]='',opt[_0xc5449d(0xb8)]='0',opt[_0xc5449d(0x135)]='All',_0x173592[_0xc5449d(0xf0)](opt);for(var _0x4c6d70=0x0;_0x4c6d70<_0x587c3d[_0xc5449d(0x12e)];_0x4c6d70++){opt=document['createElement'](_0xc5449d(0x16b)),opt[_0xc5449d(0xb8)]=_0x587c3d[_0x4c6d70],opt[_0xc5449d(0x135)]=_0x587c3d[_0x4c6d70],_0x173592['appendChild'](opt);}}),$('#btnfiltervalue')[a26_0x32bc6b(0x106)](function(){var _0x532cf3=a26_0x32bc6b;let _0x57800b;var _0x3d2e68='',_0x5bface=!![];$(_0x532cf3(0x12d))['val']()!='0'&&(_0x5bface=![]);if($(_0x532cf3(0xc7))[_0x532cf3(0x14b)]()!='0')_0x5bface=![];else return alert(_0x532cf3(0x125)),![];if($(_0x532cf3(0x1c3))[_0x532cf3(0x14b)]()!='0')_0x5bface=![];else return alert(_0x532cf3(0xb7)),![];_0x57800b=alluserdata[_0x532cf3(0x159)](function(_0x53fd61){var _0x3aa1e6=_0x532cf3;return _0x53fd61['Location\x20*']==$('option:selected',$(_0x3aa1e6(0x1c3)))[_0x3aa1e6(0x14b)]()&&_0x53fd61[_0x3aa1e6(0x15d)]==$(_0x3aa1e6(0xde),$(_0x3aa1e6(0xc7)))[_0x3aa1e6(0x14b)]()&&_0x53fd61[_0x3aa1e6(0xd8)]==$('option:selected',$(_0x3aa1e6(0x12d)))[_0x3aa1e6(0x14b)]();});var _0x3d2335=alluserdata[_0x532cf3(0x1c9)](_0x36315d=>_0x36315d[_0x532cf3(0x13d)]===$(_0x532cf3(0xde),$(_0x532cf3(0x1c3)))[_0x532cf3(0x14b)]()&&_0x36315d[_0x532cf3(0x15d)]==$(_0x532cf3(0xde),$('#ddlfilterDepartments'))[_0x532cf3(0x14b)]()&&_0x36315d[_0x532cf3(0xd8)]==$(_0x532cf3(0xde),$(_0x532cf3(0x12d)))[_0x532cf3(0x14b)]());_0x5bface?LoadShowUser(alluserdata):LoadShowUser(_0x57800b);}),$('.searching')[a26_0x32bc6b(0x1c8)](function(_0x2609f1){LoadShowUser(search($('.searching')['val']()));});function search(_0x14517d){return alluserdata['filter'](function(_0x192fe8){var _0x906c93=a26_0x5e8c;return _0x192fe8[_0x906c93(0x138)]['toLowerCase']()[_0x906c93(0x17e)](_0x14517d[_0x906c93(0x1ca)]())>-0x1||_0x192fe8[_0x906c93(0xab)][_0x906c93(0x1ca)]()['indexOf'](_0x14517d['toLowerCase']())>-0x1;});}$('input[type=radio][name=datasend]')[a26_0x32bc6b(0x145)](function(){var _0x38f23a=a26_0x32bc6b;checkedAudience=this[_0x38f23a(0xb8)];}),$(a26_0x32bc6b(0xd3))['on'](a26_0x32bc6b(0x106),function(){$['ajax']({'cache':![],'beforeSend':function(){var _0x2e637e=a26_0x5e8c;$(_0x2e637e(0x130))['fadeIn']();},'success':function(_0x5e409a){var _0xc087ac=a26_0x5e8c;AddedEmployeeList=[],SubmitReady(),$('#overlaysearch')[_0xc087ac(0x1b8)]();}});}),$(a26_0x32bc6b(0xc2))['on'](a26_0x32bc6b(0x106),function(){$['ajax']({'cache':![],'beforeSend':function(){var _0x29814c=a26_0x5e8c;$(_0x29814c(0x130))['fadeIn']();},'success':function(_0x2e6ac8){var _0x41e897=a26_0x5e8c;if(AddedEmployeeList['length']>0x0&&checkedAudience!=_0x41e897(0x115))for(var _0x587e8a=0x0;_0x587e8a<AddedEmployeeList[_0x41e897(0x12e)];_0x587e8a++){var _0x453f76=new Date(AddedEmployeeList[_0x587e8a][_0x41e897(0xd0)][_0x41e897(0x149)]),_0xc1e44c=new Date();_0xc1e44c[_0x41e897(0x139)](_0x453f76[_0x41e897(0x1dc)]()+0x3),_0x453f76=$[_0x41e897(0x17b)]['formatDate'](_0x41e897(0xb2),_0x453f76),_0xc1e44c=$[_0x41e897(0x17b)]['formatDate']('mm/dd/yy',_0xc1e44c);var _0x3ceefc=new Date(AddedEmployeeList[_0x587e8a][_0x41e897(0xd0)][_0x41e897(0x149)]);_0x3ceefc=$[_0x41e897(0x17b)][_0x41e897(0x1a7)](_0x41e897(0x154),_0x3ceefc);var _0x1e250c=[],_0x4a23e9=[],_0x141a6a=[];_0x141a6a[_0x41e897(0x11f)](Logged_CompanyId);var _0x3597c6;_0x3597c6={'__metadata':{'type':_0x41e897(0x1c2)}},(_0x3597c6[_0x41e897(0x109)]=_0x41e897(0x167),_0x3597c6['EmployeeID']=AddedEmployeeList[_0x587e8a][_0x41e897(0x131)][_0x41e897(0xd7)](),_0x3597c6[_0x41e897(0x148)]='New\x20Joinee',_0x3597c6['EmployeeName']=AddedEmployeeList[_0x587e8a][_0x41e897(0xd0)][_0x41e897(0xc1)],_0x3597c6['Designation']=AddedEmployeeList[_0x587e8a]['Metadata'][_0x41e897(0x1d6)],_0x3597c6[_0x41e897(0xe6)]=AddedEmployeeList[_0x587e8a][_0x41e897(0xc3)],_0x3597c6[_0x41e897(0x107)]=AddedEmployeeList[_0x587e8a]['EmployeeOfficeLocation'],_0x3597c6[_0x41e897(0x1d8)]=_0x41e897(0x150),_0x3597c6[_0x41e897(0x1d1)]=_0x41e897(0x167),_0x3597c6['Audience']=checkedAudience,_0x3597c6[_0x41e897(0x16f)]=_0x41e897(0xd6),_0x3597c6['Publish_Date']=_0x453f76,_0x3597c6[_0x41e897(0x156)]=_0xc1e44c,_0x3597c6['Description']=_0x41e897(0x170)+_0x3ceefc);if(checkedAudience=='Corporate')_0x141a6a=[0x0],_0x1e250c=[0x0],_0x4a23e9=[0x0],_0x3597c6['CompanyId']={'results':_0x141a6a},_0x3597c6['DepartmentsId']={'results':_0x4a23e9},_0x3597c6[_0x41e897(0xcf)]={'results':_0x1e250c};else{if(checkedAudience==_0x41e897(0x1df))_0x141a6a[_0x41e897(0x11f)](AddedEmployeeList[_0x587e8a]['Metadata'][_0x41e897(0xe2)]),_0x1e250c=[0x0],_0x4a23e9=[0x0],_0x3597c6[_0x41e897(0xe2)]={'results':_0x141a6a},_0x3597c6['DepartmentsId']={'results':_0x4a23e9},_0x3597c6[_0x41e897(0xcf)]={'results':_0x1e250c};else{if(checkedAudience==_0x41e897(0xe6))_0x141a6a=[0x0],_0x1e250c=[0x0],_0x4a23e9[_0x41e897(0x11f)](AddedEmployeeList[_0x587e8a][_0x41e897(0xd0)][_0x41e897(0x1a6)]),_0x3597c6['CompanyId']={'results':_0x141a6a},_0x3597c6[_0x41e897(0xd4)]={'results':_0x4a23e9},_0x3597c6[_0x41e897(0xcf)]={'results':_0x1e250c};else checkedAudience==_0x41e897(0xda)&&(_0x141a6a=[0x0],_0x1e250c[_0x41e897(0x11f)](AddedEmployeeList[_0x587e8a][_0x41e897(0xd0)][_0x41e897(0xee)]),_0x4a23e9=[0x0],_0x3597c6['CompanyId']={'results':_0x141a6a},_0x3597c6[_0x41e897(0xd4)]={'results':_0x4a23e9},_0x3597c6['OfficeLocationsId']={'results':_0x1e250c});}}InsertWelcomeInAnnouncementList(_0x3597c6);}$(_0x41e897(0x130))[_0x41e897(0x1b8)]();}});});function SubmitReady(){var _0x2b4462=a26_0x32bc6b;if(contributersGroupId!==''){var _0x3b2791=tabledata[_0x2b4462(0x132)]();counusers=0x0,IsaddedNewEmployee=![];for(var _0xf8e6c3=0x0;_0xf8e6c3<_0x3b2791['length'];_0xf8e6c3++){var _0x24003c=alluserdata[_0x2b4462(0x159)](function(_0x3a71df){var _0x5f45dc=_0x2b4462;return _0x3a71df['Email\x20*']==_0x3b2791[_0xf8e6c3][_0x5f45dc(0x182)][_0x5f45dc(0xc4)]['Email\x20*'];});if(AvilableLicenses>0x0)_0x24003c[0x0]['Status']==_0x2b4462(0x121)?(AddNewEmployeeAllocated(_0x24003c,'Employees'),IsaddedNewEmployee=!![]):_0x24003c[0x0][_0x2b4462(0x11c)]==_0x2b4462(0x1dd)&&UpdateExistingEmployeeAllocated(_0x24003c,_0x2b4462(0x164));else return alert(_0x2b4462(0x1b7)),![];}warningmessage!=''&&(warningmessage+=userfullname,alert(warningmessage)),$(_0x2b4462(0x127))[_0x2b4462(0x135)](counusers),showmessage(),tabledata[_0x2b4462(0xe3)](excelRows),tabledata['setPage'](pageIndex),IsaddedNewEmployee&&($('#successfully_notifications')[_0x2b4462(0x1a0)]({'backdrop':_0x2b4462(0x118),'keyboard':![]},'show'),AddedEmployeeList[_0x2b4462(0x12e)]>0x0?$(_0x2b4462(0x14c))[_0x2b4462(0x1c4)]():$(_0x2b4462(0x14c))[_0x2b4462(0xf5)]());}else GetGroupIDByGroupName(),GetSelectItem();}function isReadeySelecteds(){var _0x4148ca=a26_0x32bc6b;isReadeySelect=document[_0x4148ca(0x1c6)](_0x4148ca(0x1e2));if(isReadeySelect[_0x4148ca(0x1d3)]){tabledata[_0x4148ca(0xbd)](MiisingSelected),$('.select-row_IsMiisingSelected')[_0x4148ca(0xdc)](_0x4148ca(0x1d3),![]),$('#IsMiisingSelected')[_0x4148ca(0xdc)](_0x4148ca(0x1d3),![]),ReadySelected=[];for(var _0x349b1c=0x0;_0x349b1c<excelRows[_0x4148ca(0x12e)];_0x349b1c++){(excelRows[_0x349b1c]['Status']==_0x4148ca(0x121)||excelRows[_0x349b1c][_0x4148ca(0x11c)]==_0x4148ca(0x1dd))&&ReadySelected['push'](_0x349b1c);}$(_0x4148ca(0x152))[_0x4148ca(0xdc)](_0x4148ca(0x1d3),!![]),tabledata[_0x4148ca(0xff)](ReadySelected);}else tabledata[_0x4148ca(0xbd)](ReadySelected),$(_0x4148ca(0x152))[_0x4148ca(0xdc)]('checked',![]);}function IsMiisingSelecteds(){var _0x5d79e9=a26_0x32bc6b;IsMiisingSelect=document['getElementById'](_0x5d79e9(0x1a5));if(IsMiisingSelect[_0x5d79e9(0x1d3)]){tabledata['deselectRow'](ReadySelected),$(_0x5d79e9(0xe7))[_0x5d79e9(0xdc)](_0x5d79e9(0x1d3),![]),$('.select-row_isReadeySelected')[_0x5d79e9(0xdc)](_0x5d79e9(0x1d3),![]),MiisingSelected=[];for(var _0x47bc8c=0x0;_0x47bc8c<excelRows[_0x5d79e9(0x12e)];_0x47bc8c++){(excelRows[_0x47bc8c][_0x5d79e9(0x11c)]=='Required\x20Value\x20Missing'||excelRows[_0x47bc8c][_0x5d79e9(0x11c)]=='Already\x20Exist'||excelRows[_0x47bc8c][_0x5d79e9(0x11c)]==_0x5d79e9(0x121))&&(MiisingSelected[_0x5d79e9(0x11f)](_0x47bc8c),$(_0x5d79e9(0x126))[_0x5d79e9(0xdc)](_0x5d79e9(0x1d3),!![]));}tabledata['selectRow'](MiisingSelected);}else tabledata[_0x5d79e9(0xbd)](MiisingSelected),$('.select-row_IsMiisingSelected')[_0x5d79e9(0xdc)]('checked',![]);}function AssignPermissiononDMSLibary(_0x56dbd7,_0x376b10,_0x42951c){var _0x2b8ec7=a26_0x32bc6b,_0x27b4cd={'Accept':'application/json;odata=verbose','content-Type':_0x2b8ec7(0x1be),'X-RequestDigest':jQuery(_0x2b8ec7(0x174))[_0x2b8ec7(0x14b)]()},_0x479266=_0x42951c+_0x2b8ec7(0x192)+_0x56dbd7+_0x2b8ec7(0x157)+_0x376b10+')';$[_0x2b8ec7(0xf4)]({'url':_0x479266,'type':_0x2b8ec7(0x134),'headers':_0x27b4cd,'dataType':_0x2b8ec7(0x190),'async':![],'success':function(_0x5edcfb){var _0x15dcab=_0x2b8ec7;console[_0x15dcab(0xad)]('User\x20has\x20been\x20assigned\x20permission\x20.');},'error':function(_0x559827){var _0x6375e9=_0x2b8ec7;console[_0x6375e9(0xad)](JSON[_0x6375e9(0x189)](_0x559827)),Permissionloder['close']();}});}function GetGroupIDByGroupName(){var _0x5da933=a26_0x32bc6b,_0x45f849=_spPageContextInfo[_0x5da933(0xca)]+_0x5da933(0x1cf);$[_0x5da933(0xf4)]({'url':_0x45f849,'method':'GET','async':![],'headers':{'Accept':_0x5da933(0x1bf)},'success':function(_0x36843b){contributersGroupId=_0x36843b['d']['Id'];},'error':function(_0x20dea2){var _0x1adf50=_0x5da933;console[_0x1adf50(0xad)](_0x20dea2);}});}function GetListItems(_0x31e029,_0x127da0){var _0x21029b=a26_0x32bc6b,_0x3dbebd,_0x5d34ce=_spPageContextInfo['webAbsoluteUrl']+_0x21029b(0xc6)+_0x31e029+_0x21029b(0x18c)+_0x127da0+_0x21029b(0x16a);return $[_0x21029b(0xf4)]({'url':_0x5d34ce,'method':_0x21029b(0x13e),'async':![],'headers':{'Accept':_0x21029b(0x1bf)},'success':function(_0x530d87){var _0x3eac47=_0x21029b;_0x530d87['d'][_0x3eac47(0x184)][_0x3eac47(0x12e)]>0x0?_0x3dbebd=![]:_0x3dbebd=!![];},'error':function(_0x11d09f){var _0x49d8c1=_0x21029b;console[_0x49d8c1(0xad)](_0x11d09f);}}),_0x3dbebd;}function GetCompanies(){var _0x2f9a79=a26_0x32bc6b,_0x40bd54=_spPageContextInfo[_0x2f9a79(0xca)]+_0x2f9a79(0xed);$['ajax']({'url':_0x40bd54,'method':_0x2f9a79(0x13e),'async':![],'headers':{'Accept':_0x2f9a79(0x1bf)},'success':function(_0x116907){var _0x3629d2=_0x2f9a79;AllCompanies=_0x116907['d'][_0x3629d2(0x184)];},'error':function(_0xc737f){console['log'](_0xc737f);}});}function GetDepartments(){var _0x35404f=a26_0x32bc6b,_0x2355f2=_spPageContextInfo[_0x35404f(0xca)]+'/_api/web/lists/getByTitle(\x27Departments\x27)/items?$select=*&$top=4900';$['ajax']({'url':_0x2355f2,'method':_0x35404f(0x13e),'async':![],'headers':{'Accept':_0x35404f(0x1bf)},'success':function(_0x2bd875){var _0x41d06c=_0x35404f;AllDepartments=_0x2bd875['d'][_0x41d06c(0x184)];},'error':function(_0x3cf077){console['log'](_0x3cf077);}});}function GetOfficeLocation(){var _0x2382e8=a26_0x32bc6b,_0x588a0f=_spPageContextInfo[_0x2382e8(0xca)]+_0x2382e8(0x1e1);$[_0x2382e8(0xf4)]({'url':_0x588a0f,'method':'GET','async':![],'headers':{'Accept':_0x2382e8(0x1bf)},'success':function(_0x433910){var _0x35c260=_0x2382e8;AllOfficeLocation=_0x433910['d'][_0x35c260(0x184)];},'error':function(_0x36de3e){console['log'](_0x36de3e);}});}function GetSubSiteUrl(_0x19a435,_0x5328d2){var _0x55d136=a26_0x32bc6b,_0xb30b96,_0x25ddc7=_spPageContextInfo[_0x55d136(0xca)]+_0x55d136(0xc6)+_0x19a435+_0x55d136(0x196)+_0x5328d2+_0x55d136(0x16a);return $[_0x55d136(0xf4)]({'url':_0x25ddc7,'method':'GET','async':![],'headers':{'Accept':_0x55d136(0x1bf)},'success':function(_0xffef78){var _0x3a230e=_0x55d136;_0xb30b96=_0xffef78['d'][_0x3a230e(0x184)][0x0][_0x3a230e(0x18d)];},'error':function(_0x5725fd){var _0x322738=_0x55d136;console[_0x322738(0xad)](_0x5725fd);}}),_0xb30b96;}function AddUserinSharePointGroup(_0x3ecbca){var _0x540ffc=a26_0x32bc6b,_0x44f887=$[_0x540ffc(0x116)](),_0x338167=_0x540ffc(0x194),_0x1ef483=_0x338167+_0x3ecbca,_0x3aca2b=_spPageContextInfo[_0x540ffc(0xca)]+_0x540ffc(0xbb)+contributersGroupId+_0x540ffc(0xaa);$[_0x540ffc(0xf4)]({'url':_0x3aca2b,'type':_0x540ffc(0x134),'async':![],'data':JSON[_0x540ffc(0x189)]({'__metadata':{'type':'SP.User'},'LoginName':_0x1ef483}),'headers':{'accept':_0x540ffc(0x1be),'content-type':'application/json;odata=verbose','X-RequestDigest':$('#__REQUESTDIGEST')[_0x540ffc(0x14b)]()},'success':_0x46228f,'error':_0x2f2dc5});function _0x46228f(_0x56acc4){var _0x565745=_0x540ffc;_0x44f887[_0x565745(0xcc)](_0x56acc4['d']['Id']),console['log'](_0x565745(0x17d));}function _0x2f2dc5(_0xa0502){var _0x23c86c=_0x540ffc;console[_0x23c86c(0xad)](JSON[_0x23c86c(0x189)](_0xa0502));}return _0x44f887[_0x540ffc(0x1aa)]();}function GetUserId(_0x457a8c){var _0x171034=a26_0x32bc6b,_0x41187a='',_0x5374d0=_0x171034(0x194),_0x58acd1=_spPageContextInfo[_0x171034(0x1c1)],_0x48ddd1=_0x5374d0+_0x457a8c;return $[_0x171034(0xf4)]({'url':_0x58acd1+_0x171034(0x178)+encodeURIComponent(_0x48ddd1)+'\x27','method':_0x171034(0x13e),'headers':{'Accept':_0x171034(0x1bf)},'async':![],'success':function(_0x186a5e){_0x41187a=_0x186a5e['d']['Id'];},'error':function(_0x344e1b){var _0x2db31d=_0x171034;console[_0x2db31d(0xad)](JSON[_0x2db31d(0x189)](_0x344e1b));}}),_0x41187a;}var GetAllGroupsUser=[],GroupUrl=_spPageContextInfo[a26_0x32bc6b(0x1c1)]+'/_api/web/siteusers?$top=1000&$select=*,Id';function GetAllUserId(){var _0x427dca=a26_0x32bc6b;$['ajax']({'url':GroupUrl,'method':_0x427dca(0x13e),'headers':{'Accept':'application/json;\x20odata=verbose'},'async':![],'success':function(_0x8eb087){var _0x399fef=_0x427dca;GetAllGroupsUser=GetAllGroupsUser['concat'](_0x8eb087['d']['results']),_0x8eb087['d'][_0x399fef(0x17f)]!=null&&(GroupUrl=_0x8eb087['d'][_0x399fef(0x17f)],GetAllUserId());},'error':function(_0x3decc7){var _0x3e4c4d=_0x427dca;console[_0x3e4c4d(0xad)](JSON[_0x3e4c4d(0x189)](_0x3decc7));}});}var LoginName;function UpdateExistingEmployeeAllocated(_0x3b5204,_0x41bfbb){var _0x5c2996=a26_0x32bc6b;try{UserEmailId=_0x3b5204[0x0][_0x5c2996(0xab)],LoginName='i:0#.f|membership|'+_0x3b5204[0x0]['Email\x20*'];var _0x3cb40e,_0x2b8911,_0x2d0d9f=GetAllGroupsUser[_0x5c2996(0x159)](function(_0x17e89e){var _0x443fb4=_0x5c2996;return _0x17e89e['Email'][_0x443fb4(0x1ca)]()==_0x3b5204[0x0][_0x443fb4(0xab)][_0x443fb4(0x1ca)]();});if(_0x2d0d9f[_0x5c2996(0x12e)]>0x0)var _0xc4242=_0x2d0d9f[0x0]['Id'];else{}if(TopExecutive=='Chief\x20Executive'||_0x3b5204[0x0][_0x5c2996(0x17a)]==undefined)_0x3b5204[0x0][_0x5c2996(0x17a)]=_0x5c2996(0x155),_0x3cb40e=-0x1;else{var _0xf3a3c6=EmployeeListUsers['filter'](function(_0x8d477b){var _0x18f98a=_0x5c2996,_0x545b40;if(_0x8d477b[_0x18f98a(0x17c)]!=null)return _0x545b40=_0x8d477b[_0x18f98a(0x13a)][_0x18f98a(0x1ca)](),_0x545b40==_0x3b5204[0x0][_0x18f98a(0x17a)][_0x18f98a(0x1ca)]();});if(_0xf3a3c6[_0x5c2996(0x12e)]>0x0){_0x2b8911=_0xf3a3c6[0x0][_0x5c2996(0xc1)];var _0x2d0d9f=GetAllGroupsUser[_0x5c2996(0x159)](function(_0x2be132){var _0x67e167=_0x5c2996;return _0x2be132[_0x67e167(0x13a)][_0x67e167(0x1ca)]()==_0x3b5204[0x0][_0x67e167(0x17a)][_0x67e167(0x1ca)]();});if(_0x2d0d9f[_0x5c2996(0x12e)]>0x0)_0x3cb40e=_0x2d0d9f[0x0]['Id'];else{}}else{IsManager=![],_0x3cb40e='';var _0x3a60d8=excelRows[_0x5c2996(0xd2)](_0x2430e4=>_0x2430e4[_0x5c2996(0xab)]['toLowerCase']()==_0x3b5204[0x0][_0x5c2996(0xab)]['toLowerCase']());excelRows[_0x3a60d8][_0x5c2996(0x11c)]='Worng\x20Manager';}}var _0x58e8f3,_0x445082=GetItemTypeForListName(_0x41bfbb);_0x58e8f3={'__metadata':{'type':_0x445082},'Designation':_0x3b5204[0x0][_0x5c2996(0x166)],'GroupName':_0x3b5204[0x0]['Group\x20Name'],'Manager':_0x2b8911,'ManagerLoginNameId':_0x3cb40e},$['when'](updateItemExitUser(_0x41bfbb,_0x58e8f3,_0x3b5204[0x0][_0x5c2996(0x19e)]))[_0x5c2996(0x1a1)](function(_0x132a92){var _0x1ef097=_0x5c2996,_0x38c6e6=_0x132a92;if(_0x38c6e6){lblUpdate=lblUpdate+0x1,Exits=Exits-0x1;var _0x2794b4=excelRows['findIndex'](_0x13bcff=>_0x13bcff[_0x1ef097(0xab)]==UserEmailId);excelRows[_0x2794b4][_0x1ef097(0x11c)]=_0x1ef097(0x1a4),showmessage();}});}catch(_0x5293ae){console[_0x5c2996(0xad)](_0x5293ae['message']);}}var IsManager=!![];function AddNewEmployeeAllocated(_0x187872,_0xa93006){var _0x52d211=a26_0x32bc6b;try{if(GetListItems(_0x52d211(0xb6),parseInt(_0x187872[0x0]['Department\x20*'])))return alert(_0x52d211(0x175)),![];if(GetListItems(_0x52d211(0x187),parseInt(_0x187872[0x0]['Company\x20*'])))return alert(_0x52d211(0x11a)),![];else{if(GetListItems(_0x52d211(0x107),parseInt(_0x187872[0x0][_0x52d211(0x13d)])))return alert(_0x52d211(0x1ac)),![];else{LoginName=_0x187872[0x0][_0x52d211(0xab)][_0x52d211(0x1ca)]();var _0x524ef1,_0xe90a1b,_0x3b5ece=GetAllGroupsUser[_0x52d211(0x159)](function(_0x1027fb){var _0x4e58e3=_0x52d211;return _0x1027fb[_0x4e58e3(0x13a)][_0x4e58e3(0x1ca)]()==_0x187872[0x0]['Email\x20*'][_0x4e58e3(0x1ca)]();}),_0x304630;if(_0x3b5ece['length']>0x0)var _0x304630=_0x3b5ece[0x0]['Id'];else $['when'](AddUserinSharePointGroup(LoginName))[_0x52d211(0x1a1)](function(_0x4fa2db){_0x304630=_0x4fa2db;});if(TopExecutive==_0x52d211(0x155)||_0x187872[0x0]['Manager\x20*']==undefined)_0x187872[0x0][_0x52d211(0x17a)]='Chief\x20Executive',_0x524ef1=-0x1;else{var _0x220973=EmployeeListUsers['filter'](function(_0x52349f){var _0x128a8f=_0x52d211,_0x3ee217;if(_0x52349f[_0x128a8f(0x13a)]!=null)return _0x3ee217=_0x52349f[_0x128a8f(0x13a)][_0x128a8f(0x1ca)](),_0x3ee217==_0x187872[0x0]['Manager\x20*'][_0x128a8f(0x1ca)]();});if(_0x220973[_0x52d211(0x12e)]>0x0){_0xe90a1b=_0x220973[0x0][_0x52d211(0xc1)];var _0x3b5ece=GetAllGroupsUser[_0x52d211(0x159)](function(_0x473042){var _0x538819=_0x52d211;return _0x473042[_0x538819(0x13a)][_0x538819(0x1ca)]()==_0x187872[0x0][_0x538819(0x17a)][_0x538819(0x1ca)]();});_0x3b5ece[_0x52d211(0x12e)]>0x0?_0x524ef1=_0x3b5ece[0x0]['Id']:_0x524ef1=AddUserinSharePointGroup(_0x187872[0x0][_0x52d211(0x17a)][_0x52d211(0x1ca)]());}else{IsManager=![],_0x524ef1='';var _0x34cddc=excelRows['findIndex'](_0xec6889=>_0xec6889['Email\x20*'][_0x52d211(0x1ca)]()==LoginName);excelRows[_0x34cddc]['Status']='Wrong\x20Manager';}}var _0x16459f,_0x30fab4=GetItemTypeForListName(_0xa93006);_0x16459f={'__metadata':{'type':_0x30fab4},'CompanyId':parseInt(_0x187872[0x0][_0x52d211(0xd8)]),'DepartmentId':parseInt(_0x187872[0x0]['Department\x20*']),'FullName':_0x187872[0x0]['Name'],'Title':_0x187872[0x0][_0x52d211(0x138)],'ParentId':'-1','Email':_0x187872[0x0][_0x52d211(0xab)],'LogonNameId':_0x304630,'Manager':_0x187872[0x0][_0x52d211(0x17a)],'ManagerLoginNameId':_0x524ef1,'OfficeLocationId':parseInt(_0x187872[0x0][_0x52d211(0x13d)]),'MobileNumber':_0x187872[0x0][_0x52d211(0x151)],'DateOfBirth':_0x187872[0x0][_0x52d211(0x19a)],'Gender':_0x187872[0x0][_0x52d211(0x14e)],'DateOfAnniversary':_0x187872[0x0][_0x52d211(0x117)],'JoiningDate':_0x187872[0x0][_0x52d211(0x185)],'Designation':_0x187872[0x0]['Designation\x20*'],'PrimaryCompany':_0x52d211(0x162),'EmployeeID':_0x187872[0x0][_0x52d211(0x19c)],'GroupName':_0x187872[0x0][_0x52d211(0x176)],'Status':_0x52d211(0xf7),'PostalAddresses':_0x187872[0x0]['Postal\x20Address'],'City':_0x187872[0x0][_0x52d211(0x19b)],'StateProvince':_0x187872[0x0][_0x52d211(0x1bd)],'ZIPPostalCode':_0x187872[0x0][_0x52d211(0xfc)],'Country':_0x187872[0x0][_0x52d211(0xf2)],'HomePhone':_0x187872[0x0]['Home\x20Phone'],'OtherEMailAddress':_0x187872[0x0][_0x52d211(0xbf)],'HomeAddress':_0x187872[0x0][_0x52d211(0x198)]},AddItemToList(_0xa93006,_0x16459f);var _0x2971b1=new Date(),_0x589de9=new Date(_0x187872[0x0][_0x52d211(0x185)]),_0x282446=daysDifference(_0x589de9,_0x2971b1);if(_0x282446<=0xf)AddedEmployeeList[_0x52d211(0x11f)]({'Metadata':_0x16459f,'EmployeeId':EmployeeId,'EmployeeOfficeLocation':_0x187872[0x0]['OfficeNameDetail'],'EmployeeDepartment':_0x187872[0x0][_0x52d211(0xdf)]});else{}}}}catch(_0x4d1606){console['log'](_0x4d1606[_0x52d211(0x16c)]);}}function daysDifference(_0x431f72,_0x10d1be){var _0x13a47c=a26_0x32bc6b,_0x32618d=new Date(+_0x10d1be)['setHours'](0xc)-new Date(+_0x431f72)[_0x13a47c(0xae)](0xc);return Math['round'](_0x32618d/0x5265c00);}function updateItemExitUser(_0x4a47d9,_0x32b926,_0x277abf){var _0x435569=a26_0x32bc6b,_0x4d1dc6=$[_0x435569(0x116)]();return $[_0x435569(0xf4)]({'url':_spPageContextInfo[_0x435569(0xca)]+_0x435569(0x179)+_0x4a47d9+_0x435569(0x193)+_0x277abf+'\x27)','type':_0x435569(0x134),'headers':{'accept':_0x435569(0x1be),'X-RequestDigest':$(_0x435569(0x174))[_0x435569(0x14b)](),'content-Type':_0x435569(0x1be),'X-Http-Method':_0x435569(0x1cd),'If-Match':'*'},'data':JSON[_0x435569(0x189)](_0x32b926),'async':![],'success':function(_0x543f42){var _0x52a6cc=_0x435569;_0x4d1dc6[_0x52a6cc(0xcc)](!![]);},'error':function(_0x3f7137){var _0x4b042c=_0x435569;_0x4d1dc6[_0x4b042c(0x11d)](_0x3f7137);}}),_0x4d1dc6[_0x435569(0x1aa)]();}function AddItemToList(_0x351145,_0x51d5b9){var _0x399c27=a26_0x32bc6b;UserEmailId=_0x51d5b9['Email'];var _0x1bb9d5=_0x51d5b9[_0x399c27(0xc1)];EmployeeId='';var _0x5538ee=$[_0x399c27(0x116)]();return $[_0x399c27(0xf4)]({'url':_spPageContextInfo[_0x399c27(0xca)]+_0x399c27(0x179)+_0x351145+_0x399c27(0x112),'type':_0x399c27(0x134),'async':![],'headers':{'accept':_0x399c27(0x1be),'X-RequestDigest':$(_0x399c27(0x174))[_0x399c27(0x14b)](),'content-Type':_0x399c27(0x1be)},'data':JSON[_0x399c27(0x189)](_0x51d5b9),'success':function(_0x462958){var _0x1fc750=_0x399c27;EmployeeId=_0x462958['d']['Id'],counusers=counusers+0x1,AvilableLicenses=AvilableLicenses-0x1,Ready=Ready-0x1;var _0x270517=excelRows[_0x1fc750(0xd2)](_0x1bdbe4=>_0x1bdbe4[_0x1fc750(0xab)]==UserEmailId);excelRows[_0x270517]['Status']=_0x1fc750(0xe0),showmessage();var _0x32b554=GetSubSiteUrl(_0x1fc750(0xb6),_0x462958['d'][_0x1fc750(0x1a6)]);AssignPermissiononDMSLibary(_0x462958['d'][_0x1fc750(0x120)],'1073741826',_0x32b554),_0x5538ee[_0x1fc750(0xcc)](_0x462958);},'error':function(_0x327177){var _0x1aab96=_0x399c27;if(IsManager){var _0x40af81=excelRows[_0x1aab96(0xd2)](_0xc29bd=>_0xc29bd[_0x1aab96(0xab)]==UserEmailId);excelRows[_0x40af81][_0x1aab96(0x11c)]=_0x1aab96(0xf3);}userfullname==''?(userfullname+=_0x1bb9d5,warningmessage=_0x1aab96(0x1d4)):userfullname+=_0x1aab96(0x173)+_0x1bb9d5,Ready=Ready-0x1,Error=Error+0x1,console[_0x1aab96(0xad)](JSON[_0x1aab96(0x189)](_0x327177)),_0x5538ee[_0x1aab96(0x11d)](JSON[_0x1aab96(0x189)](_0x327177));}}),_0x5538ee[_0x399c27(0x1aa)]();}function LoadShowUser(_0x41fb5e){var _0x489b0c=a26_0x32bc6b;tabledata=new Tabulator(_0x489b0c(0x13c),{'height':'','pagination':_0x489b0c(0x142),'paginationSize':0xa,'layout':_0x489b0c(0x11b),'paginationSizeSelector':[0xa,0x19,0x32,0x64],'placeholder':_0x489b0c(0x15b),'data':_0x41fb5e,'pageLoaded':function(_0x15ba25){var _0x5cd546=_0x489b0c;_0x15ba25>=0x1?pageIndex=_0x15ba25:pageIndex=_0x15ba25,IsMiisingSelect=document['getElementById'](_0x5cd546(0x1a5)),IsMiisingSelect[_0x5cd546(0x1d3)]&&$(_0x5cd546(0x126))[_0x5cd546(0xdc)]('checked',!![]),isReadeySelect=document[_0x5cd546(0x1c6)](_0x5cd546(0x1e2)),isReadeySelect['checked']&&$(_0x5cd546(0x152))['prop'](_0x5cd546(0x1d3),!![]);},'columns':[{'formatter':function(_0x5b8c3c,_0x202ae8){var _0x329d93=_0x489b0c,_0x257ba3=_0x5b8c3c[_0x329d93(0x129)][_0x329d93(0x1e3)]['data'][_0x329d93(0x11c)];return _0x257ba3==_0x329d93(0x153)||_0x257ba3==_0x329d93(0x110)||_0x257ba3==_0x329d93(0xe0)||_0x257ba3==_0x329d93(0x1a4)?'<input\x20type=\x22checkbox\x22\x20class=\x22\x22\x20disabled\x20/>':'<input\x20type=\x22checkbox\x22\x20class=\x22select-row_isReadeySelected\x22\x20aria-label=\x22select\x20this\x20row\x22\x20/>';},'title':_0x489b0c(0x186),'field':'ID','width':'1%','headerSort':![],'cellClick':function(_0x81b743,_0x468979){var _0x4827d0=_0x489b0c,_0x5ecb95=$(_0x468979[_0x4827d0(0x123)]()),_0x4ceaa2=_0x5ecb95[_0x4827d0(0x1c9)](_0x4827d0(0x152));_0x4ceaa2[0x0]['checked']==![]&&$(_0x468979['getRow']()[_0x4827d0(0x123)]())[_0x4827d0(0x1c9)](_0x4827d0(0x126))[0x0][_0x4827d0(0x1d3)]==![]?_0x468979[_0x4827d0(0x15e)]()[_0x4827d0(0xea)]():_0x468979[_0x4827d0(0x15e)]()[_0x4827d0(0x1ab)]();}},{'formatter':function(_0x19bf2a,_0x44374a){var _0x3163ce=_0x489b0c,_0x266601=_0x19bf2a[_0x3163ce(0x129)][_0x3163ce(0x1e3)][_0x3163ce(0xc4)]['Status'];return _0x266601=='Required\x20Value\x20Missing'||_0x266601==_0x3163ce(0x1dd)||_0x266601==_0x3163ce(0x121)?'<input\x20type=\x22checkbox\x22\x20class=\x22select-row_IsMiisingSelected\x22\x20aria-label=\x22select\x20this\x20row\x22\x20/>':_0x3163ce(0xe9);},'title':_0x489b0c(0x1cc),'hozAlign':_0x489b0c(0x1d2),'field':'ID','headerSort':![],'width':'1%','cellClick':function(_0x93a5b8,_0x1985b3){var _0x3a3f4d=_0x489b0c,_0x2e73ea=$(_0x1985b3[_0x3a3f4d(0x123)]()),_0x566c05=_0x2e73ea['find']('.select-row_IsMiisingSelected');_0x566c05[0x0]['checked']==![]&&$(_0x1985b3[_0x3a3f4d(0x15e)]()[_0x3a3f4d(0x123)]())['find']('.select-row_isReadeySelected')[0x0][_0x3a3f4d(0x1d3)]==![]?_0x1985b3[_0x3a3f4d(0x15e)]()[_0x3a3f4d(0xea)]():_0x1985b3[_0x3a3f4d(0x15e)]()[_0x3a3f4d(0x1ab)]();}},{'title':_0x489b0c(0x11c),'field':_0x489b0c(0x11c),'width':'8%','formatter':function(_0x50d8fd,_0x3e3644){var _0x25b8aa=_0x489b0c,_0x945f99=_0x50d8fd[_0x25b8aa(0x136)]();if(_0x945f99==_0x25b8aa(0x153)||_0x945f99=='Required\x20Value\x20Missing'||_0x945f99=='Not\x20SP\x20Permission'||_0x945f99=='Worng\x20Manager')return'\x20<span\x20style=\x27color:red;\x20font-weight:bold;\x27>'+_0x945f99+_0x25b8aa(0x1cb);else return _0x945f99==_0x25b8aa(0x1dd)?'\x20<span\x20style=\x27color:blue;\x20font-weight:bold;\x27>'+_0x945f99+_0x25b8aa(0x1cb):_0x25b8aa(0xc0)+_0x945f99+_0x25b8aa(0x1cb);}},{'title':_0x489b0c(0x10f),'field':'Type','width':_0x489b0c(0xfd)},{'title':_0x489b0c(0x138),'field':_0x489b0c(0x138),'width':_0x489b0c(0xfd)},{'title':_0x489b0c(0x13a),'field':'Email\x20*','align':_0x489b0c(0xc5),'width':_0x489b0c(0x1bb)},{'title':_0x489b0c(0x1df),'field':_0x489b0c(0xd8),'width':_0x489b0c(0xfd),'align':_0x489b0c(0x1d2)},{'title':'Department','field':_0x489b0c(0x15d),'width':'10%','align':'center'},{'title':_0x489b0c(0xda),'field':'Location\x20*','width':'8%','align':_0x489b0c(0x1d2)},{'title':'Designation','field':_0x489b0c(0x166),'width':_0x489b0c(0xfd)},{'title':_0x489b0c(0x17c),'field':_0x489b0c(0x17a),'width':_0x489b0c(0xfd)},{'title':_0x489b0c(0x185),'field':_0x489b0c(0x185),'width':_0x489b0c(0xfd)},{'title':_0x489b0c(0x176),'field':'Group\x20Name','width':'10%'}]}),showmessage(),$(_0x489b0c(0x18b))[_0x489b0c(0x199)](_0x489b0c(0x114)),$(_0x489b0c(0xf8))['remove'](),$('.tabulator-page-size')['after'](_0x489b0c(0x133));}function showmessage(){var _0x1ad6bb=a26_0x32bc6b;$(_0x1ad6bb(0x15f))[_0x1ad6bb(0x135)](Ready),$('#Error')['text'](Error),$(_0x1ad6bb(0x137))[_0x1ad6bb(0x135)](Exits),$(_0x1ad6bb(0x19f))[_0x1ad6bb(0x135)](lblUpdate),$(_0x1ad6bb(0xdb))['text'](AvilableLicenses);}function requestToken(){var _0x1ab26e=a26_0x32bc6b;$['ajax']({'async':!![],'crossDomain':!![],'url':ClientUrl,'method':'POST','headers':{'content-type':_0x1ab26e(0x13f)},'data':{'grant_type':_0x1ab26e(0x1d0),'client_id\x20':ClientId,'client_secret':ClentSecret,'scope\x20':'https://graph.microsoft.com/.default'},'success':function(_0x33434b){var _0x36a103=_0x1ab26e;console[_0x36a103(0xad)](_0x33434b),token=_0x33434b[_0x36a103(0x168)];},'error':function(_0x5a7006){var _0x5620a0=_0x1ab26e;console['log'](JSON[_0x5620a0(0x189)](_0x5a7006));}});}function GraphAccessTokenTogetUserDetails(){var _0x45cf4c=a26_0x32bc6b,_0x1712dd=new jQuery['Deferred'](),_0x3fccef={'X-RequestDigest':$(_0x45cf4c(0x174))[_0x45cf4c(0x14b)](),'accept':_0x45cf4c(0x1c5),'content-type':_0x45cf4c(0x1c5)},_0xc18c95={'resource':_0x45cf4c(0x16d)};return $[_0x45cf4c(0xf4)]({'url':_spPageContextInfo[_0x45cf4c(0xca)]+'/_api/SP.OAuth.Token/Acquire','headers':_0x3fccef,'type':_0x45cf4c(0x134),'async':![],'data':JSON['stringify'](_0xc18c95),'success':function(_0x3307b0){var _0x3c52d4=_0x45cf4c;token=_0x3307b0[_0x3c52d4(0x168)],_0x1712dd['resolve'](token);},'error':function(_0x293ace,_0x2eadbb,_0x381f64){var _0x5c4a2a=_0x45cf4c;console[_0x5c4a2a(0xad)](_0x293ace[_0x5c4a2a(0x181)]),_0x1712dd['reject'](_0x293ace[_0x5c4a2a(0x181)]);}}),_0x1712dd[_0x45cf4c(0x1aa)]();}var employeehtml='',userName='',AzureUsrlist=[],AdusersUrl=a26_0x32bc6b(0x102);function GetAzureUsrlist(_0x2c365e,_0x9b13ea){var _0x4c61c8=a26_0x32bc6b;return DeferredObj=$[_0x4c61c8(0x116)](),$[_0x4c61c8(0xf4)]({'method':_0x4c61c8(0x13e),'url':_0x2c365e,'headers':{'Authorization':'Bearer\x20'+_0x9b13ea,'Content-Type':_0x4c61c8(0x191)},'async':![],'success':function(_0x341365){var _0x185938=_0x4c61c8;AzureUsrlist=AzureUsrlist[_0x185938(0x10a)](_0x341365[_0x185938(0xb8)]),_0x341365['@odata.nextLink']!=null&&(AdusersUrl=_0x341365[_0x185938(0xcb)],GetAzureUsrlist(AdusersUrl,_0x9b13ea));},'error':function(_0x51cb0f){var _0x30a416=_0x4c61c8;DeferredObj[_0x30a416(0x11d)](_0x51cb0f),alert(_0x30a416(0x197)+JSON['stringify'](_0x51cb0f));}}),DeferredObj[_0x4c61c8(0x1aa)]();}function getEmployee(_0x420055){var _0x1158c4=a26_0x32bc6b,_0x4a3262=_0x1158c4(0xb5)+_0x420055+'\x27';return DeferredObj=$[_0x1158c4(0x116)](),$[_0x1158c4(0xf4)]({'method':'GET','url':_0x4a3262,'headers':{'Authorization':'Bearer\x20'+token,'Content-Type':_0x1158c4(0x191)},'async':![],'success':function(_0x5c81eb){var _0xe0ae53=_0x1158c4;_0x5c81eb[_0xe0ae53(0xb8)][_0xe0ae53(0x12e)]>0x0?DeferredObj[_0xe0ae53(0xcc)](_0x5c81eb[_0xe0ae53(0xb8)][0x0]['displayName']):DeferredObj[_0xe0ae53(0xcc)](_0xe0ae53(0x153));},'error':function(_0x3cfd85){var _0x1b7b58=_0x1158c4;DeferredObj[_0x1b7b58(0x11d)](_0x3cfd85),alert(_0x1b7b58(0x197)+JSON[_0x1b7b58(0x189)](_0x3cfd85));}}),DeferredObj[_0x1158c4(0x1aa)]();}function a26_0x25be(){var _0x4342b6=['option','message','https://graph.microsoft.com','fromCharCode','ApprovalStatus','DOJ:\x20','.form-check-input','fadeIn','\x20,\x20','#__REQUESTDIGEST','Department\x20Id\x20is\x20not\x20Correct','Group\x20Name','close','/_api/web/siteusers(@v)?@v=\x27','/_api/web/lists/getbytitle(\x27','Manager\x20*','datepicker','Manager','User\x20Added','indexOf','__next','/_api/web/lists/GetByTitle(\x27Announcements\x27)/items','responseText','_row','charAt','results','Date\x20Of\x20Joining','<input\x20type=\x22checkbox\x22\x20id=\x22isReadeySelected\x22\x20onclick=\x22isReadeySelecteds()\x22\x20/>','Companies','target','stringify','files','#Rowcount','\x27)/items?$select=ID&$filter=ID\x20eq\x20','SiteURL','332256uBfPal','exceltble','json','application/json','/_api/web/lists/getByTitle(\x27DepartmentalDMS\x27)/roleassignments/addroleassignment(principalid=','\x27)/GetItemById(\x27','i:0#.f|membership|','append','\x27)/items?$select=ID,SiteURL&$filter=ID\x20eq\x20','error1','Home\x20Address','html','Date\x20Of\x20Birth','City','Employee\x20Code','ClientName','EmpUserId','#lblUpdate','modal','done','chkOfficeLocation','Wrong\x20Manager','Updated','IsMiisingSelected','DepartmentId','formatDate','slice','Please\x20upload\x20a\x20valid\x20Excel\x20file.','promise','select','Office\x20Location\x20Id\x20is\x20not\x20Correct','setPage','ListItem','\x27)/items?$filter=Title\x20eq\x20\x27Client_Credentials\x27\x20','Description','readonly','5450532HVfXGN','</h3>\x20<p\x20class\x20=\x20\x22m-0\x22\x20>\x20Uploaded\x20</p>','/_api/web/lists/GetByTitle(\x27','#txtGroup','CompanyIDId','Your\x20License\x20limit\x20has\x20been\x20ended','fadeOut','removeProp','chkDepartment','15%','5zwGEZu','Sate','application/json;odata=verbose','application/json;\x20odata=verbose','User,DL,SecGroup,SPGroup','siteAbsoluteUrl','SP.Data.AnnouncementsListItem','#ddlfilterOfficeLocation','show','application/json;odata=nometadata','getElementById','EmployeeSyncreport','keyup','find','toLowerCase','</span>','<input\x20type=\x22checkbox\x22\x20id=\x22IsMiisingSelected\x22\x20onclick=\x22IsMiisingSelecteds()\x22\x20/>','PATCH','GetAllUserInfo','/_api/web/sitegroups/getbyname(\x27Contributors\x27)?$select=id','client_credentials','WebPartName','center','checked','The\x20following\x20users\x20failed\x20to\x20sync\x20due\x20to\x20wrong\x20manager\x20defined!.\x0a','28gqGiQT','Designation','MaximumEntitySuggestions','UserType','map','please\x20check\x20at\x20list\x20one\x20checkbox\x20','ChangeFileName','getMonth','Already\x20Exist','#upload','Company','DepartmentName','/_api/web/lists/getByTitle(\x27OfficeLocation\x27)/items?$select=*&$top=4900','isReadeySelected','row','OfficeName',')/users','Email\x20*','onclick','log','setHours','.sp-peoplepicker-editorInput','ddlfilterDepartments','EnvironmentalSettings','mm/dd/yy','chkTopExecutive','PrincipalAccountType','https://graph.microsoft.com/v1.0/users?$filter=mail\x20eq\x20\x27','Departments','Please\x20select\x20Location','value','AssaginTomanager','mail','/_api/web/sitegroups(','#dvExcel','deselectRow','chkManager','Email(Other)','\x20<span\x20style=\x27color:green;\x20font-weight:bold;\x27>','FullName','#btnAudience','EmployeeDepartment','data','left','/_api/web/lists/getByTitle(\x27','#ddlfilterDepartments','850568UMrFGg','toUpperCase','webAbsoluteUrl','@odata.nextLink','resolve','/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=999&$select=ID,AttachmentFiles,FullName,Designation,Manager,MobileNumber,ExtensionName,Email,LogonName/UserName,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department,AttachmentFiles\x20&$filter=\x20PrimaryCompany\x20eq\x20\x27Primary\x27\x20and\x20Status\x20eq\x20\x27Active\x27\x20','readAsBinaryString','OfficeLocationsId','Metadata','Data\x20Send\x20to\x20Announcements\x20Failed','findIndex','#btnsubmitready','DepartmentsId','2458939tsKFDy','Approved','toString','Company\x20*','join','Location','#AvilableLicenses','prop','utils','option:selected','DepartmentNameDetail','Added','1201255ayUwuT','CompanyId','setData','chkDesignation','#btnDownLoadReport','Department','#isReadeySelected','split','<input\x20type=\x22checkbox\x22\x20class=\x22\x22\x20disabled\x20/>','deselect','<option\x20value=\x22','<h3\x20class=\x27m-0\x27>','/_api/web/lists/getByTitle(\x27Companies\x27)/items?$select=*&$top=4900','OfficeLocationId','SheetNames','appendChild','onload','Country','Not\x20SP\x20Permission','ajax','hide','displayName','Active','.breakpoint','#chkTopExecutive','CompanyName','#ddlAllCompanies','PIN/ZIP','10%','This\x20browser\x20does\x20not\x20support\x20HTML5.','selectRow','xlsx','251px','https://graph.microsoft.com/beta/users?$top=100&$select=mail,displayName,userPrincipalName','#btnUploadExcel','onchange','ddlOfficeLocation','click','OfficeLocation','createElement','Announcement_Type','concat','Select\x20Company','ready','readAsArrayBuffer','#chkManager','Type','Required\x20Value\x20Missing','ddlfilterOfficeLocation','\x27)/items','/_api/web/lists/getbytitle(\x27ExternalUsers\x27)/items?$select=*,InternalStakeholders/Title,Supervisor_Guest/Title,Client_Name/Title,LoginName/Title\x20&$expand=\x20LoginName,Client_Name,Supervisor_Guest,InternalStakeholders\x20&$filter=((Status\x20eq\x20\x27Initiated\x27)\x20or\x20(Status\x20eq\x20\x27Invited\x27\x20)or\x20(Status\x20eq\x20\x27Pending\x27)or\x20(Status\x20eq\x20\x27Accepted\x27))','Total\x20Row\x20Count:\x20','NotSave','Deferred','Date\x20Of\x20Marriage','static','SearchPrincipalSource','Company\x20Id\x20is\x20not\x20Correct','fitColumns','Status','reject','OfficeNameDetail','push','LogonNameId','Ready','10466190rYWTzW','getElement','#ddlOfficeLocation','Please\x20select\x20Department','.select-row_IsMiisingSelected','#added','innerHTML','_cell','#successfully_notifications','undefined','#Error','#ddlfilterAllCompanies','length','chkGroup','#overlaysearch','EmployeeId','getSelectedRows','<span\x20class=\x27breakpoint\x27></span>','POST','text','getValue','#Exits','Name','setMonth','Email','result','#example-table','Location\x20*','GET','application/x-www-form-urlencoded','EntityData','#UploadExcel','local','EmployeeSyncReport.xlsx','ddlDepartment','change','fileUpload','byteLength','Title','JoiningDate','[id$=\x27AssaginTomanager_TopSpan\x27]','val','#divAudience','#txtDesignation','Gender','binary','Internal\x20Users','Mobile','.select-row_isReadeySelected','Invalid\x20Profile','dd\x20M\x20yy','Chief\x20Executive','Expires',',roleDefId=','test','filter','40915233gjkpsc','Please\x20upload\x20xlsx\x20file','SPClientPeoplePicker_InitStandaloneControlWrapper','Department\x20*','getRow','#Ready','when','focus','Primary','#ddlDepartment','Employees','#txtmanager','Designation\x20*','Welcome','access_token','width','&$top=1'];a26_0x25be=function(){return _0x4342b6;};return a26_0x25be();}function ClientCredentials(){var _0x3ff8c2=a26_0x32bc6b,_0x3c6eb1=_0x3ff8c2(0xb1),_0x283ec2=titanForWork['getQueryStringParameter'](_0x3ff8c2(0xe2)),_0x26cf47=_spPageContextInfo['webAbsoluteUrl']+_0x3ff8c2(0x1b4)+_0x3c6eb1+_0x3ff8c2(0x1af);$[_0x3ff8c2(0xf4)]({'url':_0x26cf47,'headers':{'Accept':_0x3ff8c2(0x1be)},'async':![],'success':function(_0x44c32c){var _0x24a77d=_0x3ff8c2,_0x4607b6=_0x44c32c['d'][_0x24a77d(0x184)];ClientId=_0x4607b6[0x0][_0x24a77d(0x19d)],ClentSecret=_0x4607b6[0x0][_0x24a77d(0x1db)],ClientUrl=_0x4607b6[0x0][_0x24a77d(0x1b0)];},'error':function(_0x3192c5){var _0x4a45c0=_0x3ff8c2;console[_0x4a45c0(0xad)](_0x3192c5);}});}var EmployeeListUsers=[],GetQueryURL=_spPageContextInfo['webAbsoluteUrl']+a26_0x32bc6b(0xcd);function GetEmployees(){var _0x550894=a26_0x32bc6b;$[_0x550894(0xf4)]({'url':GetQueryURL,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'beforeSend':function(){},'success':function(_0x4847c0){var _0x51b6e1=_0x550894;EmployeeListUsers=EmployeeListUsers[_0x51b6e1(0x10a)](_0x4847c0['d'][_0x51b6e1(0x184)]);if(_0x4847c0['d'][_0x51b6e1(0x17f)]!=null)GetQueryURL=_0x4847c0['d'][_0x51b6e1(0x17f)],GetEmployees();else{GetQueryURL=_spPageContextInfo[_0x51b6e1(0xca)]+_0x51b6e1(0xcd);var _0x24d492='',_0x321866=_spPageContextInfo[_0x51b6e1(0xca)]+_0x51b6e1(0x113);extdfds=$[_0x51b6e1(0x116)](),$[_0x51b6e1(0x160)](getItems(_0x321866,extdfds))[_0x51b6e1(0x1a1)](function(_0x13297d){response=[],_0x24d492=_0x13297d['length'];});}AvilableLicenses=parseInt(UsersLicenceRequired)-(parseInt(EmployeeListUsers['length'])+parseInt(_0x24d492));},'error':function(_0x4e3c68){var _0x27f1bc=_0x550894;console[_0x27f1bc(0xad)](_0x4e3c68);}});}var fileUploadevent=document[a26_0x32bc6b(0x1c6)](a26_0x32bc6b(0x146));fileUploadevent[a26_0x32bc6b(0xac)]=function(){var _0x4a1a66=a26_0x32bc6b;EmployeeListUsers=[],AvilableLicenses=0x0,this[_0x4a1a66(0xb8)]=null;},fileUploadevent[a26_0x32bc6b(0x104)]=function(){$['ajax']({'cache':![],'beforeSend':function(){var _0xec98cd=a26_0x5e8c;$(_0xec98cd(0x130))[_0xec98cd(0x172)]();},'success':function(_0x46ead3){var _0x496521=a26_0x5e8c,_0x45ad39=document[_0x496521(0x1c6)](_0x496521(0x146));AzureUsrlist[_0x496521(0x12e)]==0x0&&GetAzureUsrlist(AdusersUrl,token);AvilableLicenses=0x0,GetEmployees(),LoadShowUser([]),Ready=0x0,Error=0x0,lblUpdate=0x0,counusers=0x0,Exits=0x0,$('#Ready')['text'](0x0),$(_0x496521(0x12c))[_0x496521(0x135)](0x0),$(_0x496521(0x127))[_0x496521(0x135)](0x0),$(_0x496521(0x19f))[_0x496521(0x135)](0x0),$(_0x496521(0x137))['text'](0x0);var _0x461c44=/^([a-zA-Z0-9\s_\\.\-:])+(.xls|.xlsx)$/;if(_0x461c44[_0x496521(0x158)](_0x45ad39['value'][_0x496521(0x1ca)]())){if(typeof FileReader!=_0x496521(0x12b)){var _0x39318f=new FileReader();_0x39318f[_0x496521(0xce)]?(_0x39318f[_0x496521(0xf1)]=function(_0x2d76d7){var _0x424068=_0x496521;ProcessExcel(_0x2d76d7[_0x424068(0x188)]['result']);},_0x39318f[_0x496521(0xce)](_0x45ad39[_0x496521(0x18a)][0x0])):(_0x39318f[_0x496521(0xf1)]=function(_0x3a097d){var _0xb77115=_0x496521,_0x56811d='',_0x1482f2=new Uint8Array(_0x3a097d[_0xb77115(0x188)][_0xb77115(0x13b)]);for(var _0x14347f=0x0;_0x14347f<_0x1482f2['byteLength'];_0x14347f++){_0x56811d+=String['fromCharCode'](_0x1482f2[_0x14347f]);}ProcessExcel(_0x56811d);},_0x39318f[_0x496521(0x10d)](_0x45ad39[_0x496521(0x18a)][0x0]));}else alert('This\x20browser\x20does\x20not\x20support\x20HTML5.');}else alert(_0x496521(0x1a9));$(_0x496521(0x130))['fadeOut']();}});},$(function(){var _0x190cb3=a26_0x32bc6b;$(_0x190cb3(0x1de))['click'](function(){var _0x11981b=_0x190cb3,_0x1f8d8c=document[_0x11981b(0x1c6)](_0x11981b(0x146));GetEmployees(),LoadShowUser([]),Ready=0x0,Error=0x0,counusers=0x0;var _0x3f5284=/^([a-zA-Z0-9\s_\\.\-:])+(.xls|.xlsx)$/;if(_0x3f5284['test'](_0x1f8d8c[_0x11981b(0xb8)]['toLowerCase']())){if(typeof FileReader!='undefined'){var _0x724a3e=new FileReader();_0x724a3e['readAsBinaryString']?(_0x724a3e[_0x11981b(0xf1)]=function(_0x1fc616){var _0x4076ab=_0x11981b;ProcessExcel(_0x1fc616['target'][_0x4076ab(0x13b)]);},_0x724a3e[_0x11981b(0xce)](_0x1f8d8c[_0x11981b(0x18a)][0x0])):(_0x724a3e['onload']=function(_0xe6210a){var _0xa0c16c=_0x11981b,_0x118691='',_0x33287b=new Uint8Array(_0xe6210a[_0xa0c16c(0x188)][_0xa0c16c(0x13b)]);for(var _0x43d708=0x0;_0x43d708<_0x33287b[_0xa0c16c(0x147)];_0x43d708++){_0x118691+=String[_0xa0c16c(0x16e)](_0x33287b[_0x43d708]);}ProcessExcel(_0x118691);},_0x724a3e[_0x11981b(0x10d)](_0x1f8d8c[_0x11981b(0x18a)][0x0]));}else alert(_0x11981b(0xfe));}else alert(_0x11981b(0x1a9));});});function ProcessExcel(_0x3523ad){var _0x24cd60=a26_0x32bc6b,_0x39358e=XLSX['read'](_0x3523ad,{'type':_0x24cd60(0x14f)}),_0xd35e28=_0x39358e[_0x24cd60(0xef)][0x0];excelRows=XLSX[_0x24cd60(0xdd)]['sheet_to_row_object_array'](_0x39358e['Sheets'][_0xd35e28]),$('#UploadedItems')['empty'](),$('#UploadedItems')[_0x24cd60(0x195)](_0x24cd60(0xec)+excelRows[_0x24cd60(0x12e)]+_0x24cd60(0x1b3)),$(_0x24cd60(0xbc))['html']('');for(var _0x485e5d=0x0;_0x485e5d<excelRows[_0x24cd60(0x12e)];_0x485e5d++){var _0x57ef61='';ErrorUser='';var _0x3e83e4=EmployeeListUsers[_0x24cd60(0x159)](function(_0x38c12b){var _0x1daa9a=_0x24cd60,_0x191c80=_0x38c12b[_0x1daa9a(0x13a)]['toLowerCase']();return _0x191c80==excelRows[_0x485e5d][_0x1daa9a(0xab)][_0x1daa9a(0x1ca)]();});if(_0x3e83e4[_0x24cd60(0x12e)]>0x0){_0x57ef61=_0x3e83e4[0x0][_0x24cd60(0xc1)],color_red='color-red',ErrorUser=_0x24cd60(0x1dd),Exits=Exits+0x1;var _0x5a5097=_0x3e83e4[0x0]['ID'];excelRows[_0x485e5d][_0x24cd60(0xd8)]='-',excelRows[_0x485e5d]['Department\x20*']='-',excelRows[_0x485e5d][_0x24cd60(0x13d)]='-';}else{var _0x28a317=AzureUsrlist[_0x24cd60(0x159)](function(_0x289a2a){var _0x3997b1=_0x24cd60;if(_0x289a2a['mail']!=null){var _0x156006=_0x289a2a[_0x3997b1(0xba)][_0x3997b1(0x1ca)]();return _0x156006==excelRows[_0x485e5d][_0x3997b1(0xab)][_0x3997b1(0x1ca)]();}});if(_0x28a317[_0x24cd60(0x12e)]>0x0){_0x57ef61=_0x28a317[0x0][_0x24cd60(0xf6)];var _0x337873=AllCompanies[_0x24cd60(0x159)](function(_0x2a08c2){var _0x323786=_0x24cd60;return _0x2a08c2['ID']==excelRows[_0x485e5d][_0x323786(0xd8)];}),_0x131ece=AllDepartments[_0x24cd60(0x159)](function(_0x54a9d1){var _0x1622f6=_0x24cd60;return _0x54a9d1['ID']==excelRows[_0x485e5d][_0x1622f6(0x15d)];}),_0x443eec=AllOfficeLocation[_0x24cd60(0x159)](function(_0x16c90e){var _0x258839=_0x24cd60;return _0x16c90e['ID']==excelRows[_0x485e5d][_0x258839(0x13d)];});_0x337873['length']>0x0&&_0x131ece[_0x24cd60(0x12e)]>0x0&&_0x443eec[_0x24cd60(0x12e)]>0x0?(Ready=Ready+0x1,ErrorUser=_0x24cd60(0x121),excelRows[_0x485e5d][_0x24cd60(0xdf)]=_0x131ece[0x0][_0x24cd60(0x1e0)],excelRows[_0x485e5d][_0x24cd60(0x11e)]=_0x443eec[0x0][_0x24cd60(0x1e4)]):(ErrorUser=_0x24cd60(0x110),Error=Error+0x1);}else ErrorUser=_0x24cd60(0x153),color_red='color-red',Error=Error+0x1;}excelRows[_0x485e5d][_0x24cd60(0x138)]=_0x57ef61,excelRows[_0x485e5d]['id']=_0x485e5d,excelRows[_0x485e5d]['Status']=ErrorUser,excelRows[_0x485e5d][_0x24cd60(0x19e)]=_0x5a5097;}alluserdata=excelRows,LoadShowUser(excelRows);}function CompaniesDetails(){var _0x1a2273=a26_0x32bc6b,_0x2854bc=document[_0x1a2273(0x1c6)]('ddlAllCompanies');_0x2854bc[_0x1a2273(0x128)]='',opt['value']='0',opt[_0x1a2273(0x135)]=_0x1a2273(0x10b),_0x2854bc[_0x1a2273(0xf0)](opt);for(var _0x3056fe=0x0;_0x3056fe<AllCompanies[_0x1a2273(0x12e)];_0x3056fe++){var _0x1c2197=AllCompanies[_0x3056fe][_0x1a2273(0xfa)],_0x2f23db=AllCompanies[_0x3056fe]['ID'];opt=document[_0x1a2273(0x108)]('option'),opt[_0x1a2273(0xb8)]=_0x2f23db,opt[_0x1a2273(0x135)]=_0x1c2197,_0x2854bc[_0x1a2273(0xf0)](opt);}$(_0x1a2273(0x171))[_0x1a2273(0xdc)]('checked',![]),$(_0x1a2273(0x165))[_0x1a2273(0x14b)](''),$('#txtGroup')[_0x1a2273(0x14b)](''),$(_0x1a2273(0x14d))[_0x1a2273(0x14b)]('');}$(a26_0x32bc6b(0x103))[a26_0x32bc6b(0x106)](function(){var _0x316209=a26_0x32bc6b,_0x338a6d=tabledata[_0x316209(0x132)]();debugger;_0x338a6d[_0x316209(0x12e)]>0x0?(CompaniesDetails(),$(_0x316209(0x141))[_0x316209(0x1a0)](_0x316209(0x1c4)),initializePeoplePicker(_0x316209(0xb9)),peoplePickerDiv=$(_0x316209(0x14a))):alert('Please\x20select\x20required\x20value\x20missing\x20row');});var GetDepartments,Getofficelocation,GetDesignation,GetGroup,CompaniesId;$('#btnmissingrequedvalue')[a26_0x32bc6b(0x106)](function(){var _0x190e44=a26_0x32bc6b;if(document['getElementById'](_0x190e44(0x1ba))[_0x190e44(0x1d3)]==!![]||document['getElementById'](_0x190e44(0x1a2))['checked']==!![]||document[_0x190e44(0x1c6)]('chkDesignation')[_0x190e44(0x1d3)]==!![]||document['getElementById'](_0x190e44(0xbe))[_0x190e44(0x1d3)]==!![]||document['getElementById'](_0x190e44(0xb3))[_0x190e44(0x1d3)]==!![]||document[_0x190e44(0x1c6)]('chkGroup')['checked']==!![]){var _0x4e39ea=tabledata['getSelectedRows'](),_0x19b7dc=SPClientPeoplePicker['SPClientPeoplePickerDict'][peoplePickerDiv[0x0]['id']],_0x2988c6=_0x19b7dc[_0x190e44(0x1ce)]();for(var _0x38dfb5=0x0;_0x38dfb5<_0x4e39ea[_0x190e44(0x12e)];_0x38dfb5++){var _0x41125f=excelRows[_0x190e44(0xd2)](_0x143427=>_0x143427[_0x190e44(0xab)]==_0x4e39ea[_0x38dfb5]['_row'][_0x190e44(0xc4)][_0x190e44(0xab)]);if(excelRows[_0x41125f][_0x190e44(0x11c)]=='Already\x20Exist')excelRows[_0x41125f][_0x190e44(0xd8)]='-',excelRows[_0x41125f][_0x190e44(0x15d)]='-',excelRows[_0x41125f]['Location\x20*']='-',document[_0x190e44(0x1c6)](_0x190e44(0xe4))[_0x190e44(0x1d3)]&&(excelRows[_0x41125f][_0x190e44(0x166)]=$(_0x190e44(0x14d))['val']()),document[_0x190e44(0x1c6)]('chkManager')[_0x190e44(0x1d3)]&&(excelRows[_0x41125f][_0x190e44(0x17a)]=_0x2988c6[0x0]['EntityData'][_0x190e44(0x13a)]),document[_0x190e44(0x1c6)](_0x190e44(0xb3))[_0x190e44(0x1d3)]&&(excelRows[_0x41125f][_0x190e44(0x17a)]='Chief\x20Executive'),document[_0x190e44(0x1c6)](_0x190e44(0x12f))[_0x190e44(0x1d3)]&&(excelRows[_0x41125f][_0x190e44(0x176)]=$('#txtGroup')[_0x190e44(0x14b)]());else{if(excelRows[_0x41125f][_0x190e44(0x11c)]==_0x190e44(0x110)||excelRows[_0x41125f]['Status']==_0x190e44(0x121)){document[_0x190e44(0x1c6)]('chkDepartment')['checked']&&(excelRows[_0x41125f][_0x190e44(0xd8)]=CompaniesId,excelRows[_0x41125f][_0x190e44(0x15d)]=GetDepartments);document['getElementById'](_0x190e44(0x1a2))['checked']&&(excelRows[_0x41125f][_0x190e44(0xd8)]=CompaniesId,excelRows[_0x41125f]['Location\x20*']=Getofficelocation);document[_0x190e44(0x1c6)]('chkDesignation')[_0x190e44(0x1d3)]&&(excelRows[_0x41125f][_0x190e44(0x166)]=$('#txtDesignation')[_0x190e44(0x14b)]());document[_0x190e44(0x1c6)](_0x190e44(0xbe))[_0x190e44(0x1d3)]&&(excelRows[_0x41125f][_0x190e44(0x17a)]=_0x2988c6[0x0][_0x190e44(0x140)][_0x190e44(0x13a)]);document[_0x190e44(0x1c6)]('chkTopExecutive')[_0x190e44(0x1d3)]&&(excelRows[_0x41125f][_0x190e44(0x17a)]=_0x190e44(0x155));document[_0x190e44(0x1c6)]('chkGroup')[_0x190e44(0x1d3)]&&(excelRows[_0x41125f][_0x190e44(0x176)]=$(_0x190e44(0x1b5))[_0x190e44(0x14b)]());var _0x8401e2=AllCompanies[_0x190e44(0x159)](function(_0x1d263a){var _0x59662c=_0x190e44;return _0x1d263a['ID']==excelRows[_0x41125f][_0x59662c(0xd8)];}),_0x403ef9=AllDepartments[_0x190e44(0x159)](function(_0x18617e){var _0x33f71a=_0x190e44;return _0x18617e['ID']==excelRows[_0x41125f][_0x33f71a(0x15d)];}),_0x55e34f=AllOfficeLocation[_0x190e44(0x159)](function(_0xce62b8){var _0x323ade=_0x190e44;return _0xce62b8['ID']==excelRows[_0x41125f][_0x323ade(0x13d)];});_0x8401e2[_0x190e44(0x12e)]>0x0&&_0x403ef9[_0x190e44(0x12e)]>0x0&&_0x55e34f['length']>0x0?(Ready=Ready+0x1,Error=Error-0x1,excelRows[_0x41125f][_0x190e44(0x11c)]=_0x190e44(0x121)):(excelRows[_0x41125f][_0x190e44(0x11c)]=_0x190e44(0x110),Error=Error+0x1);}else excelRows[_0x41125f][_0x190e44(0x11c)]==_0x190e44(0x1a3)&&(document[_0x190e44(0x1c6)]('chkDesignation')[_0x190e44(0x1d3)]&&(excelRows[_0x41125f][_0x190e44(0x166)]=$(_0x190e44(0x14d))['val']()),document[_0x190e44(0x1c6)](_0x190e44(0xbe))[_0x190e44(0x1d3)]&&(excelRows[_0x41125f][_0x190e44(0x17a)]=_0x2988c6[0x0][_0x190e44(0x140)][_0x190e44(0x13a)]),document[_0x190e44(0x1c6)](_0x190e44(0xb3))[_0x190e44(0x1d3)]&&(excelRows[_0x41125f][_0x190e44(0x17a)]=_0x190e44(0x155)),document[_0x190e44(0x1c6)](_0x190e44(0x12f))['checked']&&(excelRows[_0x41125f]['Group\x20Name']=$('#txtGroup')[_0x190e44(0x14b)]()),Ready=Ready+0x1,Error=Error-0x1,excelRows[_0x41125f]['Status']=_0x190e44(0x121));}}tabledata[_0x190e44(0xe3)](excelRows),tabledata[_0x190e44(0x1ad)](pageIndex),$(_0x190e44(0x141))[_0x190e44(0x1a0)](_0x190e44(0xf5)),showmessage();}else alert(_0x190e44(0x1da)),$('select#dropDownId\x20option:selected')[_0x190e44(0x14b)]();}),$(a26_0x32bc6b(0xfb))['change'](function(){var _0x568b0b=a26_0x32bc6b;CompaniesId=parseInt($(_0x568b0b(0xde),$(this))['val']());var _0x3132d3=AllOfficeLocation['filter'](function(_0x828e57){var _0x538a38=_0x568b0b;return _0x828e57[_0x538a38(0x1b6)]===CompaniesId;}),_0x4f37b8=document[_0x568b0b(0x1c6)](_0x568b0b(0x105));_0x4f37b8['innerHTML']='';for(var _0xc21eb9=0x0;_0xc21eb9<_0x3132d3[_0x568b0b(0x12e)];_0xc21eb9++){var _0x3593a=_0x3132d3[_0xc21eb9][_0x568b0b(0x1e4)],_0x5cdaff=_0x3132d3[_0xc21eb9]['ID'];opt=document['createElement'](_0x568b0b(0x16b)),opt[_0x568b0b(0xb8)]=_0x5cdaff,opt['text']=_0x3593a,_0x4f37b8['appendChild'](opt);}Getofficelocation=parseInt($('option:selected',$(_0x568b0b(0x124)))[_0x568b0b(0x14b)]());var _0x108a03=AllDepartments[_0x568b0b(0x159)](function(_0x230f27){var _0x15a530=_0x568b0b;return _0x230f27[_0x15a530(0x1b6)]===CompaniesId;}),_0x4f37b8=document[_0x568b0b(0x1c6)](_0x568b0b(0x144));_0x4f37b8[_0x568b0b(0x128)]='';for(var _0xc21eb9=0x0;_0xc21eb9<_0x108a03[_0x568b0b(0x12e)];_0xc21eb9++){var _0x3593a=_0x108a03[_0xc21eb9][_0x568b0b(0x1e0)],_0x5cdaff=_0x108a03[_0xc21eb9]['ID'];opt=document[_0x568b0b(0x108)](_0x568b0b(0x16b)),opt[_0x568b0b(0xb8)]=_0x5cdaff,opt['text']=_0x3593a,_0x4f37b8[_0x568b0b(0xf0)](opt);}GetDepartments=parseInt($(_0x568b0b(0xde),$(_0x568b0b(0x163)))[_0x568b0b(0x14b)]());}),$('#ddlDepartment')['change'](function(){var _0x29fce8=a26_0x32bc6b;GetDepartments=parseInt($('option:selected',$(this))[_0x29fce8(0x14b)]());}),$(a26_0x32bc6b(0x124))[a26_0x32bc6b(0x145)](function(){var _0x3b8045=a26_0x32bc6b;Getofficelocation=parseInt($(_0x3b8045(0xde),$(this))['val']());});function chkManagerevent(_0x2f0b4f){var _0x51c254=a26_0x32bc6b;if(_0x2f0b4f[_0x51c254(0x1d3)])$(_0x51c254(0xf9))[_0x51c254(0xdc)](_0x51c254(0x1d3),![]),$(_0x51c254(0x165))[_0x51c254(0x1b9)](_0x51c254(0x1b1)),$(_0x51c254(0x165))[_0x51c254(0x161)]();else{}}var TopExecutive='';function chkTopExecutiveevent(_0x479c75){var _0x226329=a26_0x32bc6b;if(_0x479c75[_0x226329(0x1d3)])$(_0x226329(0x10e))[_0x226329(0xdc)](_0x226329(0x1d3),![]),$('#txtmanager')['prop'](_0x226329(0x1b1),!![]),$(_0x226329(0x165))[_0x226329(0x14b)](''),TopExecutive=_0x226329(0x155);else{}}$(a26_0x32bc6b(0xe5))['click'](function(){var _0x35f349=a26_0x32bc6b;tabledata['download'](_0x35f349(0x100),_0x35f349(0x143),{'sheetName':_0x35f349(0x1c7)});});var dvExcel=document[a26_0x32bc6b(0x1c6)](a26_0x32bc6b(0x18f));dvExcel['innerHTML']='';var outputArray=[];function removewithfilter(_0x1d0c37){var _0x37dedb=a26_0x32bc6b;let _0x17acbd=_0x1d0c37[_0x37dedb(0x159)](function(_0x333c1d,_0x1d9380,_0xb3640a){var _0x479be9=_0x37dedb;return _0x1d9380==_0xb3640a[_0x479be9(0x17e)](_0x333c1d);});return _0x17acbd;}function GetItemTypeForListName(_0x5dc10f){var _0xbbabc6=a26_0x32bc6b;return'SP.Data.'+_0x5dc10f[_0xbbabc6(0x183)](0x0)[_0xbbabc6(0xc9)]()+_0x5dc10f['split']('\x20')[_0xbbabc6(0xd9)]('')[_0xbbabc6(0x1a8)](0x1)+_0xbbabc6(0x1ae);}var response=response||[];function getItems(_0x16f2b1,_0x238dcf){var _0x54d951=a26_0x32bc6b;return $['ajax']({'url':_0x16f2b1,'type':_0x54d951(0x13e),'async':![],'headers':{'accept':_0x54d951(0x1be)},'success':function(_0x1fac8e){var _0x52113b=_0x54d951;response=response['concat'](_0x1fac8e['d'][_0x52113b(0x184)]),_0x1fac8e['d'][_0x52113b(0x17f)]?(_0x16f2b1=_0x1fac8e['d']['__next'],getItems(_0x16f2b1,_0x238dcf)):_0x238dcf['resolve'](response);},'error':function(_0x4f4857){var _0x3ed87e=_0x54d951;_0x238dcf[_0x3ed87e(0x11d)](_0x4f4857),console[_0x3ed87e(0xad)](_0x4f4857);}}),_0x238dcf[_0x54d951(0x1aa)]();}function ConvertddmmyyTommddyy(_0x15ffcd){var _0x4dd71f=a26_0x32bc6b;return _0x15ffcd[_0x4dd71f(0xe8)]('/')[0x1]+'/'+_0x15ffcd[_0x4dd71f(0xe8)]('/')[0x0]+'/'+_0x15ffcd[_0x4dd71f(0xe8)]('/')[0x2];}function InsertWelcomeInAnnouncementList(_0x19c976){var _0x41a3f9=a26_0x32bc6b;$[_0x41a3f9(0xf4)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x41a3f9(0x180),'type':_0x41a3f9(0x134),'async':![],'data':JSON['stringify'](_0x19c976),'headers':{'Accept':_0x41a3f9(0x1be),'Content-Type':_0x41a3f9(0x1be),'X-RequestDigest':$(_0x41a3f9(0x174))[_0x41a3f9(0x14b)](),'X-HTTP-Method':_0x41a3f9(0x134)},'success':function(_0x211d82,_0x14b25b,_0x223c2b){var _0x46298d=_0x41a3f9;console[_0x46298d(0xad)]('Data\x20Send\x20to\x20Announcements');},'error':function(_0x522779){var _0x218624=_0x41a3f9;console['log'](_0x522779),console['log'](_0x218624(0xd1)),currentDlg[_0x218624(0x177)]();}});}