var a21_0x413b07=a21_0x54aa;(function(_0x1b51b2,_0xb5cf5d){var _0x3507ea=a21_0x54aa,_0x235fa6=_0x1b51b2();while(!![]){try{var _0x575219=-parseInt(_0x3507ea(0x1eb))/0x1*(parseInt(_0x3507ea(0x1d4))/0x2)+parseInt(_0x3507ea(0x1bf))/0x3+parseInt(_0x3507ea(0x1ac))/0x4*(parseInt(_0x3507ea(0x177))/0x5)+-parseInt(_0x3507ea(0x15c))/0x6+-parseInt(_0x3507ea(0x1e0))/0x7*(parseInt(_0x3507ea(0x274))/0x8)+-parseInt(_0x3507ea(0x27e))/0x9*(parseInt(_0x3507ea(0x269))/0xa)+parseInt(_0x3507ea(0x1a4))/0xb;if(_0x575219===_0xb5cf5d)break;else _0x235fa6['push'](_0x235fa6['shift']());}catch(_0x31fe7a){_0x235fa6['push'](_0x235fa6['shift']());}}}(a21_0x19a5,0x74953));var token,ClientId='',ClentSecret='',ClientUrl='',DeferredObj=$['Deferred'](),color_red='',Error=0x0,Ready=0x0,Exits=0x0,lblUpdate=0x0,ErrorUser='',alluserdata,contributersGroupId='',counusers=0x0,excelRows,AllCompanies,AllDepartments,AllOfficeLocation,tabledata,pageIndex,UserEmailId,warningmessage='',userfullname='',AvilableLicenses,ReadySelected=[],MiisingSelected=[],AddedEmployeeList=[],IsMiisingSelect,isReadeySelect,peoplePickerDiv='',IsaddedNewEmployee=![],EmployeeId='',EmployeeDepartment='',EmployeeOfficeLocation='',checkedAudience='',IsNotification=![];$(document)[a21_0x413b07(0x26c)](function(){var _0x1a9bb7=a21_0x413b07;GraphAccessTokenTogetUserDetails(),GetCompanies(),GetOfficeLocation(),GetDepartments(),LoadShowUser([]),GetAllUserId(),GetEmployees(),$(_0x1a9bb7(0x26f))['text'](AvilableLicenses);});function initializePeoplePicker(_0x3202e9){var _0x5ec2d6=a21_0x413b07,_0x3f3caf={};_0x3f3caf[_0x5ec2d6(0x1c8)]=_0x5ec2d6(0x27a),_0x3f3caf[_0x5ec2d6(0x166)]=0xf,_0x3f3caf[_0x5ec2d6(0x1fa)]=0xf,_0x3f3caf[_0x5ec2d6(0x1b3)]=![],_0x3f3caf[_0x5ec2d6(0x276)]=0x32,_0x3f3caf[_0x5ec2d6(0x14a)]='251px',this['SPClientPeoplePicker_InitStandaloneControlWrapper'](_0x3202e9,null,_0x3f3caf),$(_0x5ec2d6(0x161))[_0x5ec2d6(0x212)](0xfa);}function GetSelectItem(){var _0x48575d=a21_0x413b07;IsaddedNewEmployee=![];if(contributersGroupId!==''){var _0x18311d=tabledata['getSelectedRows']();counusers=0x0;for(var _0xbf24dd=0x0;_0xbf24dd<_0x18311d[_0x48575d(0x1c3)];_0xbf24dd++){var _0xfa1da1=alluserdata[_0x48575d(0x209)](function(_0x57404b){var _0x386111=_0x48575d;return _0x57404b['Email\x20*']==_0x18311d[_0xbf24dd][_0x386111(0x1af)][_0x386111(0x239)][_0x386111(0x189)];});AvilableLicenses>0x0?_0xfa1da1[0x0][_0x48575d(0x241)]=='Ready'?(AddNewEmployeeAllocated(_0xfa1da1,_0x48575d(0x24d)),IsaddedNewEmployee=!![]):_0xfa1da1[0x0][_0x48575d(0x241)]==_0x48575d(0x224)&&UpdateExistingEmployeeAllocated(_0xfa1da1,'Employees'):($(_0x48575d(0x22e))[_0x48575d(0x16a)](counusers),alert(_0x48575d(0x1a6)),_0xbf24dd=_0x18311d[_0x48575d(0x1c3)]);}warningmessage!=''&&(warningmessage+=userfullname,alert(warningmessage)),$(_0x48575d(0x22e))['text'](counusers),showmessage(),tabledata[_0x48575d(0x1f0)](excelRows),tabledata['setPage'](pageIndex),IsaddedNewEmployee&&($(_0x48575d(0x1f8))[_0x48575d(0x232)]({'backdrop':_0x48575d(0x1ec),'keyboard':![]},_0x48575d(0x26e)),AddedEmployeeList['length']>0x0?$('#divAudience')[_0x48575d(0x26e)]():$(_0x48575d(0x258))[_0x48575d(0x1d5)]());}else GetGroupIDByGroupName(),GetSelectItem();}var Temparray=[];$(a21_0x413b07(0x1c6))[a21_0x413b07(0x1a0)](function(){var _0x186c8f=a21_0x413b07;debugger;Temparray=alluserdata;let _0x4162c1=[...new Set(Temparray['map'](_0x47ac14=>_0x47ac14[_0x186c8f(0x25e)]))];var _0x45ec09=document['getElementById'](_0x186c8f(0x246));_0x45ec09[_0x186c8f(0x22b)]='',opt['value']='0',opt[_0x186c8f(0x16a)]=_0x186c8f(0x1b2),_0x45ec09['appendChild'](opt);for(var _0x5b80cd=0x0;_0x5b80cd<_0x4162c1[_0x186c8f(0x1c3)];_0x5b80cd++){opt=document['createElement'](_0x186c8f(0x165)),opt[_0x186c8f(0x16c)]=_0x4162c1[_0x5b80cd],opt[_0x186c8f(0x16a)]=_0x4162c1[_0x5b80cd],_0x45ec09['appendChild'](opt);}Temparray=alluserdata;var _0x5f1270=[...new Set(Temparray[_0x186c8f(0x218)](_0x1af76d=>_0x1af76d[_0x186c8f(0x25f)]))],_0x45ec09=document[_0x186c8f(0x157)](_0x186c8f(0x1ba)),_0x452478=_0x186c8f(0x179);for(var _0x5b80cd=0x0;_0x5b80cd<_0x5f1270[_0x186c8f(0x1c3)];_0x5b80cd++){_0x452478+=_0x186c8f(0x1d8)+_0x5f1270[_0x5b80cd]+'\x22>'+_0x5f1270[_0x5b80cd]+_0x186c8f(0x229);}$('#ddlfilterOfficeLocation')[_0x186c8f(0x279)](_0x452478),Temparray=alluserdata;let _0x454b07=[...new Set(Temparray[_0x186c8f(0x218)](_0x5c09d7=>_0x5c09d7[_0x186c8f(0x20f)]))];var _0x45ec09=document[_0x186c8f(0x157)](_0x186c8f(0x231));_0x45ec09[_0x186c8f(0x22b)]='',opt[_0x186c8f(0x16c)]='0',opt[_0x186c8f(0x16a)]=_0x186c8f(0x1b5),_0x45ec09[_0x186c8f(0x243)](opt);for(var _0x5b80cd=0x0;_0x5b80cd<_0x454b07[_0x186c8f(0x1c3)];_0x5b80cd++){opt=document[_0x186c8f(0x1c2)](_0x186c8f(0x165)),opt['value']=_0x454b07[_0x5b80cd],opt['text']=_0x454b07[_0x5b80cd],_0x45ec09['appendChild'](opt);}}),$(a21_0x413b07(0x18a))[a21_0x413b07(0x1a0)](function(){var _0x56767e=a21_0x413b07;let _0xfd5b98;var _0x12e48a='',_0x3fe959=!![];$(_0x56767e(0x185))['val']()!='0'&&(_0x3fe959=![]);if($(_0x56767e(0x194))[_0x56767e(0x145)]()!='0')_0x3fe959=![];else return alert('Please\x20select\x20Department'),![];if($('#ddlfilterOfficeLocation')[_0x56767e(0x145)]()!='0')_0x3fe959=![];else return alert(_0x56767e(0x14e)),![];_0xfd5b98=alluserdata['filter'](function(_0x12e220){var _0x253407=_0x56767e;return _0x12e220[_0x253407(0x25f)]==$(_0x253407(0x1c5),$(_0x253407(0x1ce)))[_0x253407(0x145)]()&&_0x12e220['Department\x20*']==$(_0x253407(0x1c5),$('#ddlfilterDepartments'))[_0x253407(0x145)]()&&_0x12e220[_0x253407(0x25e)]==$('option:selected',$(_0x253407(0x185)))[_0x253407(0x145)]();});var _0x584f16=alluserdata[_0x56767e(0x20e)](_0x426645=>_0x426645[_0x56767e(0x25f)]===$(_0x56767e(0x1c5),$('#ddlfilterOfficeLocation'))[_0x56767e(0x145)]()&&_0x426645['Department\x20*']==$('option:selected',$('#ddlfilterDepartments'))[_0x56767e(0x145)]()&&_0x426645['Company\x20*']==$(_0x56767e(0x1c5),$(_0x56767e(0x185)))['val']());_0x3fe959?LoadShowUser(alluserdata):LoadShowUser(_0xfd5b98);}),$('.searching')[a21_0x413b07(0x1ff)](function(_0x4d68ad){var _0x4dc47b=a21_0x413b07;LoadShowUser(search($(_0x4dc47b(0x1ad))[_0x4dc47b(0x145)]()));});function search(_0x61c570){var _0x4bf35f=a21_0x413b07;return alluserdata[_0x4bf35f(0x209)](function(_0xd95d86){var _0x531388=_0x4bf35f;return _0xd95d86[_0x531388(0x251)]['toLowerCase']()[_0x531388(0x1df)](_0x61c570['toLowerCase']())>-0x1||_0xd95d86[_0x531388(0x189)][_0x531388(0x259)]()[_0x531388(0x1df)](_0x61c570['toLowerCase']())>-0x1;});}function a21_0x54aa(_0x12f12f,_0x47ed99){var _0x19a5be=a21_0x19a5();return a21_0x54aa=function(_0x54aac3,_0x562811){_0x54aac3=_0x54aac3-0x13f;var _0xdc406=_0x19a5be[_0x54aac3];return _0xdc406;},a21_0x54aa(_0x12f12f,_0x47ed99);}$(a21_0x413b07(0x26b))[a21_0x413b07(0x225)](function(){var _0x59ce04=a21_0x413b07;checkedAudience=this[_0x59ce04(0x16c)];}),$(a21_0x413b07(0x1bc))['on'](a21_0x413b07(0x1a0),function(){$['ajax']({'cache':![],'beforeSend':function(){var _0x5a1733=a21_0x54aa;$('#overlaysearch')[_0x5a1733(0x238)]();},'success':function(_0x143e53){var _0x58d18c=a21_0x54aa;AddedEmployeeList=[],SubmitReady(),$(_0x58d18c(0x20d))[_0x58d18c(0x270)]();}});}),$('#btnAudience')['on'](a21_0x413b07(0x1a0),function(){var _0x16cfaf=a21_0x413b07;$[_0x16cfaf(0x1c1)]({'cache':![],'beforeSend':function(){var _0x1b060f=_0x16cfaf;$(_0x1b060f(0x20d))[_0x1b060f(0x238)]();},'success':function(_0x50ab9f){var _0x740025=_0x16cfaf;if(AddedEmployeeList[_0x740025(0x1c3)]>0x0&&checkedAudience!=_0x740025(0x1fe))for(var _0x1918e6=0x0;_0x1918e6<AddedEmployeeList[_0x740025(0x1c3)];_0x1918e6++){var _0x1fa82c=new Date(AddedEmployeeList[_0x1918e6][_0x740025(0x184)][_0x740025(0x24c)]),_0x42b121=new Date();_0x42b121[_0x740025(0x170)](_0x1fa82c[_0x740025(0x1f9)]()+0x3),_0x1fa82c=$[_0x740025(0x146)][_0x740025(0x18c)](_0x740025(0x1a2),_0x1fa82c),_0x42b121=$[_0x740025(0x146)]['formatDate'](_0x740025(0x1a2),_0x42b121);var _0x2ed6aa=new Date(AddedEmployeeList[_0x1918e6]['Metadata']['JoiningDate']);_0x2ed6aa=$['datepicker'][_0x740025(0x18c)]('dd\x20M\x20yy',_0x2ed6aa);var _0x4ecd55=[],_0x34d3dc=[],_0x4baafb=[];_0x4baafb['push'](Logged_CompanyId);var _0xa586f7;_0xa586f7={'__metadata':{'type':_0x740025(0x13f)}},(_0xa586f7['Announcement_Type']=_0x740025(0x1a8),_0xa586f7['EmployeeID']=AddedEmployeeList[_0x1918e6][_0x740025(0x1ef)]['toString'](),_0xa586f7[_0x740025(0x16f)]=_0x740025(0x213),_0xa586f7['EmployeeName']=AddedEmployeeList[_0x1918e6][_0x740025(0x184)]['FullName'],_0xa586f7[_0x740025(0x249)]=AddedEmployeeList[_0x1918e6][_0x740025(0x184)]['Designation'],_0xa586f7[_0x740025(0x1e9)]=AddedEmployeeList[_0x1918e6][_0x740025(0x180)],_0xa586f7[_0x740025(0x250)]=AddedEmployeeList[_0x1918e6][_0x740025(0x242)],_0xa586f7[_0x740025(0x280)]=_0x740025(0x204),_0xa586f7[_0x740025(0x1b4)]=_0x740025(0x1a8),_0xa586f7['Audience']=checkedAudience,_0xa586f7[_0x740025(0x20b)]=_0x740025(0x23b),_0xa586f7[_0x740025(0x175)]=_0x1fa82c,_0xa586f7['Expires']=_0x42b121,_0xa586f7[_0x740025(0x1f3)]=_0x740025(0x223)+_0x2ed6aa);if(checkedAudience=='Corporate')_0x4baafb=[0x0],_0x4ecd55=[0x0],_0x34d3dc=[0x0],_0xa586f7[_0x740025(0x19b)]={'results':_0x4baafb},_0xa586f7[_0x740025(0x196)]={'results':_0x34d3dc},_0xa586f7[_0x740025(0x148)]={'results':_0x4ecd55};else{if(checkedAudience==_0x740025(0x1db))_0x4baafb[_0x740025(0x26a)](AddedEmployeeList[_0x1918e6]['Metadata']['CompanyId']),_0x4ecd55=[0x0],_0x34d3dc=[0x0],_0xa586f7[_0x740025(0x19b)]={'results':_0x4baafb},_0xa586f7['DepartmentsId']={'results':_0x34d3dc},_0xa586f7[_0x740025(0x148)]={'results':_0x4ecd55};else{if(checkedAudience==_0x740025(0x1e9))_0x4baafb=[0x0],_0x4ecd55=[0x0],_0x34d3dc[_0x740025(0x26a)](AddedEmployeeList[_0x1918e6]['Metadata'][_0x740025(0x252)]),_0xa586f7[_0x740025(0x19b)]={'results':_0x4baafb},_0xa586f7[_0x740025(0x196)]={'results':_0x34d3dc},_0xa586f7[_0x740025(0x148)]={'results':_0x4ecd55};else checkedAudience==_0x740025(0x18e)&&(_0x4baafb=[0x0],_0x4ecd55[_0x740025(0x26a)](AddedEmployeeList[_0x1918e6]['Metadata'][_0x740025(0x1c4)]),_0x34d3dc=[0x0],_0xa586f7[_0x740025(0x19b)]={'results':_0x4baafb},_0xa586f7['DepartmentsId']={'results':_0x34d3dc},_0xa586f7[_0x740025(0x148)]={'results':_0x4ecd55});}}InsertWelcomeInAnnouncementList(_0xa586f7);}$(_0x740025(0x20d))['fadeOut']();}});});function SubmitReady(){var _0x31e3e8=a21_0x413b07;if(contributersGroupId!==''){var _0xa20849=tabledata[_0x31e3e8(0x14c)]();counusers=0x0,IsaddedNewEmployee=![];for(var _0x4556fd=0x0;_0x4556fd<_0xa20849[_0x31e3e8(0x1c3)];_0x4556fd++){var _0x10975e=alluserdata[_0x31e3e8(0x209)](function(_0x1f1b59){var _0x3d9e54=_0x31e3e8;return _0x1f1b59['Email\x20*']==_0xa20849[_0x4556fd]['_row'][_0x3d9e54(0x239)][_0x3d9e54(0x189)];});if(AvilableLicenses>0x0)_0x10975e[0x0]['Status']==_0x31e3e8(0x1d3)?(AddNewEmployeeAllocated(_0x10975e,_0x31e3e8(0x24d)),IsaddedNewEmployee=!![]):_0x10975e[0x0][_0x31e3e8(0x241)]==_0x31e3e8(0x224)&&UpdateExistingEmployeeAllocated(_0x10975e,_0x31e3e8(0x24d));else return alert(_0x31e3e8(0x1a6)),![];}warningmessage!=''&&(warningmessage+=userfullname,alert(warningmessage)),$(_0x31e3e8(0x22e))[_0x31e3e8(0x16a)](counusers),showmessage(),tabledata['setData'](excelRows),tabledata[_0x31e3e8(0x167)](pageIndex),IsaddedNewEmployee&&($(_0x31e3e8(0x1f8))[_0x31e3e8(0x232)]({'backdrop':'static','keyboard':![]},'show'),AddedEmployeeList[_0x31e3e8(0x1c3)]>0x0?$(_0x31e3e8(0x258))[_0x31e3e8(0x26e)]():$(_0x31e3e8(0x258))[_0x31e3e8(0x1d5)]());}else GetGroupIDByGroupName(),GetSelectItem();}function isReadeySelecteds(){var _0xe2a6e4=a21_0x413b07;isReadeySelect=document[_0xe2a6e4(0x157)](_0xe2a6e4(0x155));if(isReadeySelect['checked']){tabledata[_0xe2a6e4(0x1cb)](MiisingSelected),$(_0xe2a6e4(0x21e))['prop'](_0xe2a6e4(0x1be),![]),$(_0xe2a6e4(0x19f))[_0xe2a6e4(0x220)](_0xe2a6e4(0x1be),![]),ReadySelected=[];for(var _0x50cc2b=0x0;_0x50cc2b<excelRows[_0xe2a6e4(0x1c3)];_0x50cc2b++){(excelRows[_0x50cc2b]['Status']==_0xe2a6e4(0x1d3)||excelRows[_0x50cc2b][_0xe2a6e4(0x241)]==_0xe2a6e4(0x224))&&ReadySelected[_0xe2a6e4(0x26a)](_0x50cc2b);}$('.select-row_isReadeySelected')[_0xe2a6e4(0x220)](_0xe2a6e4(0x1be),!![]),tabledata['selectRow'](ReadySelected);}else tabledata[_0xe2a6e4(0x1cb)](ReadySelected),$('.select-row_isReadeySelected')['prop'](_0xe2a6e4(0x1be),![]);}function IsMiisingSelecteds(){var _0x40f820=a21_0x413b07;IsMiisingSelect=document[_0x40f820(0x157)](_0x40f820(0x21c));if(IsMiisingSelect[_0x40f820(0x1be)]){tabledata[_0x40f820(0x1cb)](ReadySelected),$('#isReadeySelected')[_0x40f820(0x220)](_0x40f820(0x1be),![]),$(_0x40f820(0x192))[_0x40f820(0x220)](_0x40f820(0x1be),![]),MiisingSelected=[];for(var _0x17cccb=0x0;_0x17cccb<excelRows[_0x40f820(0x1c3)];_0x17cccb++){(excelRows[_0x17cccb][_0x40f820(0x241)]==_0x40f820(0x1e5)||excelRows[_0x17cccb][_0x40f820(0x241)]=='Already\x20Exist'||excelRows[_0x17cccb][_0x40f820(0x241)]=='Ready')&&(MiisingSelected['push'](_0x17cccb),$(_0x40f820(0x21e))[_0x40f820(0x220)]('checked',!![]));}tabledata[_0x40f820(0x25a)](MiisingSelected);}else tabledata[_0x40f820(0x1cb)](MiisingSelected),$(_0x40f820(0x21e))['prop'](_0x40f820(0x1be),![]);}function AssignPermissiononDMSLibary(_0x1d1f1f,_0x2c4bed,_0x2264ad){var _0x544c5b=a21_0x413b07,_0x3a8f31={'Accept':_0x544c5b(0x1dd),'content-Type':'application/json;odata=verbose','X-RequestDigest':jQuery(_0x544c5b(0x1d7))[_0x544c5b(0x145)]()},_0x5d65ec=_0x2264ad+_0x544c5b(0x181)+_0x1d1f1f+',roleDefId='+_0x2c4bed+')';$[_0x544c5b(0x1c1)]({'url':_0x5d65ec,'type':_0x544c5b(0x163),'headers':_0x3a8f31,'dataType':'json','async':![],'success':function(_0xe5aa9d){var _0x303c63=_0x544c5b;console[_0x303c63(0x1e8)](_0x303c63(0x1d9));},'error':function(_0x392222){var _0x2174c4=_0x544c5b;console[_0x2174c4(0x1e8)](JSON[_0x2174c4(0x1fc)](_0x392222)),Permissionloder[_0x2174c4(0x262)]();}});}function GetGroupIDByGroupName(){var _0xcf523=a21_0x413b07,_0x6e0c91=_spPageContextInfo[_0xcf523(0x23c)]+_0xcf523(0x264);$[_0xcf523(0x1c1)]({'url':_0x6e0c91,'method':'GET','async':![],'headers':{'Accept':'application/json;\x20odata=verbose'},'success':function(_0x35ee7f){contributersGroupId=_0x35ee7f['d']['Id'];},'error':function(_0x28cc1d){var _0x4f4d57=_0xcf523;console[_0x4f4d57(0x1e8)](_0x28cc1d);}});}function GetListItems(_0x11f093,_0x14f48e){var _0x105f13=a21_0x413b07,_0x202d02,_0xdc2fe4=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/getByTitle(\x27'+_0x11f093+_0x105f13(0x147)+_0x14f48e+'&$top=1';return $[_0x105f13(0x1c1)]({'url':_0xdc2fe4,'method':_0x105f13(0x1cd),'async':![],'headers':{'Accept':_0x105f13(0x17b)},'success':function(_0xbf3a49){var _0x355d27=_0x105f13;_0xbf3a49['d'][_0x355d27(0x22d)][_0x355d27(0x1c3)]>0x0?_0x202d02=![]:_0x202d02=!![];},'error':function(_0x251217){var _0x1df264=_0x105f13;console[_0x1df264(0x1e8)](_0x251217);}}),_0x202d02;}function GetCompanies(){var _0x316fce=a21_0x413b07,_0x40785a=_spPageContextInfo['webAbsoluteUrl']+_0x316fce(0x256);$[_0x316fce(0x1c1)]({'url':_0x40785a,'method':'GET','async':![],'headers':{'Accept':_0x316fce(0x17b)},'success':function(_0xc0bf77){var _0x4b3f3e=_0x316fce;AllCompanies=_0xc0bf77['d'][_0x4b3f3e(0x22d)];},'error':function(_0x2512e5){var _0x4ed0f5=_0x316fce;console[_0x4ed0f5(0x1e8)](_0x2512e5);}});}function GetDepartments(){var _0x4b6bb5=a21_0x413b07,_0x3aa7cc=_spPageContextInfo[_0x4b6bb5(0x23c)]+_0x4b6bb5(0x14b);$[_0x4b6bb5(0x1c1)]({'url':_0x3aa7cc,'method':_0x4b6bb5(0x1cd),'async':![],'headers':{'Accept':_0x4b6bb5(0x17b)},'success':function(_0x3d081c){var _0x1249f7=_0x4b6bb5;AllDepartments=_0x3d081c['d'][_0x1249f7(0x22d)];},'error':function(_0xd946a3){var _0x4b9756=_0x4b6bb5;console[_0x4b9756(0x1e8)](_0xd946a3);}});}function GetOfficeLocation(){var _0x4e78d0=a21_0x413b07,_0x28952c=_spPageContextInfo['webAbsoluteUrl']+_0x4e78d0(0x1b7);$[_0x4e78d0(0x1c1)]({'url':_0x28952c,'method':'GET','async':![],'headers':{'Accept':_0x4e78d0(0x17b)},'success':function(_0x58071f){var _0xc4e913=_0x4e78d0;AllOfficeLocation=_0x58071f['d'][_0xc4e913(0x22d)];},'error':function(_0x3a0453){var _0x18a3d1=_0x4e78d0;console[_0x18a3d1(0x1e8)](_0x3a0453);}});}function GetSubSiteUrl(_0x58bdd1,_0x43c927){var _0x3c18f0=a21_0x413b07,_0x2dfc12,_0x5bfde9=_spPageContextInfo[_0x3c18f0(0x23c)]+_0x3c18f0(0x206)+_0x58bdd1+'\x27)/items?$select=ID,SiteURL&$filter=ID\x20eq\x20'+_0x43c927+'&$top=1';return $[_0x3c18f0(0x1c1)]({'url':_0x5bfde9,'method':_0x3c18f0(0x1cd),'async':![],'headers':{'Accept':_0x3c18f0(0x17b)},'success':function(_0x27ed2b){var _0x26f481=_0x3c18f0;_0x2dfc12=_0x27ed2b['d'][_0x26f481(0x22d)][0x0]['SiteURL'];},'error':function(_0x2f1091){var _0x54a458=_0x3c18f0;console[_0x54a458(0x1e8)](_0x2f1091);}}),_0x2dfc12;}function a21_0x19a5(){var _0x1d3a58=['#chkTopExecutive','OfficeNameDetail','EmployeeSyncReport.xlsx','/_api/web/lists/GetByTitle(\x27Announcements\x27)/items','Internal\x20Users','utils','/_api/web/lists/getByTitle(\x27','\x20<span\x20style=\x27color:red;\x20font-weight:bold;\x27>','https://graph.microsoft.com/.default','filter','findIndex','ApprovalStatus','color-red','#overlaysearch','find','Department\x20*','onchange','#btnUploadExcel','width','New\x20Joinee','Deferred','concat','Group\x20Name','@odata.nextLink','map','onclick','Manager\x20*','Total\x20Row\x20Count:\x20','IsMiisingSelected','#dvExcel','.select-row_IsMiisingSelected','#Error','prop','EmpUserId','Active','DOJ:\x20','Already\x20Exist','change','Home\x20Address','fitColumns','chkDepartment','</option>','Primary','innerHTML','empty','results','#added','byteLength','SheetNames','ddlfilterDepartments','modal','deselect','10%','toUpperCase','PATCH','#txtDesignation','fadeIn','data','CompanyIDId','Approved','webAbsoluteUrl','Manager','Departments','getValue','undefined','Status','EmployeeOfficeLocation','appendChild','/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=999&$select=ID,AttachmentFiles,FullName,Designation,Manager,MobileNumber,ExtensionName,Email,LogonName/UserName,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department,AttachmentFiles\x20&$filter=\x20PrimaryCompany\x20eq\x20\x27Primary\x27\x20and\x20Status\x20eq\x20\x27Active\x27\x20','append','ddlfilterAllCompanies','fromCharCode','#btnmissingrequedvalue','Designation','<input\x20type=\x22checkbox\x22\x20id=\x22isReadeySelected\x22\x20onclick=\x22isReadeySelecteds()\x22\x20/>','getQueryStringParameter','JoiningDate','Employees','center','#ddlAllCompanies','OfficeLocation','Name','DepartmentId','.form-check-input','application/json','select#dropDownId\x20option:selected','/_api/web/lists/getByTitle(\x27Companies\x27)/items?$select=*&$top=4900','removeProp','#divAudience','toLowerCase','selectRow','responseText','charAt','Type','Company\x20*','Location\x20*','.tabulator-page-size','ChangeFileName','close','Sate','/_api/web/sitegroups/getbyname(\x27Contributors\x27)?$select=id','_cell','download','#Exits','https://graph.microsoft.com/beta/users?$top=100&$select=mail,displayName,userPrincipalName','20IlFDgm','push','input[type=radio][name=datasend]','ready','#Ready','show','#AvilableLicenses','fadeOut','reject','ddlAllCompanies','files','1287224fByqjX','Gender','MaximumEntitySuggestions','<input\x20type=\x22checkbox\x22\x20id=\x22IsMiisingSelected\x22\x20onclick=\x22IsMiisingSelecteds()\x22\x20/>','__next','html','User,DL,SecGroup,SPGroup','remove','AssaginTomanager','</span>','120699dBMKTi','chkOfficeLocation','UserType','SP.Data.AnnouncementsListItem','Sheets','done','#Rowcount','#txtGroup','SPClientPeoplePickerDict','val','datepicker','\x27)/items?$select=ID&$filter=ID\x20eq\x20','OfficeLocationsId','Chief\x20Executive','Width','/_api/web/lists/getByTitle(\x27Departments\x27)/items?$select=*&$top=4900','getSelectedRows','\x20<span\x20style=\x27color:green;\x20font-weight:bold;\x27>','Please\x20select\x20Location','row','.breakpoint','Date\x20Of\x20Birth','User\x20Added','Added','Worng\x20Manager','isReadeySelected','slice','getElementById','<input\x20type=\x22checkbox\x22\x20class=\x22\x22\x20disabled\x20/>','focus','error1','chkTopExecutive','2316006vZvDgF','Designation\x20*','chkDesignation','OfficeName','join','.sp-peoplepicker-editorInput','Updated','POST','message','option','SearchPrincipalSource','setPage','#example-table','Bearer\x20','text','chkGroup','value','#UploadedItems','onload','Title','setMonth',')/users','Please\x20select\x20required\x20value\x20missing\x20row','LogonNameId','Email','Publish_Date','Invalid\x20Profile','470485oKhIpL','Please\x20upload\x20xlsx\x20file','<option\x20value=\x220\x22><strong>All</strong></option>','Wrong\x20Manager','application/json;\x20odata=verbose','FullName','local','#UploadExcel','ClientName','EmployeeDepartment','/_api/web/lists/getByTitle(\x27DepartmentalDMS\x27)/roleassignments/addroleassignment(principalid=','application/json;odata=nometadata','/_api/web/siteusers(@v)?@v=\x27','Metadata','#ddlfilterAllCompanies','Country','result','#ddlDepartment','Email\x20*','#btnfiltervalue','readonly','formatDate','Date\x20Of\x20Joining','Location','#txtmanager','EnvironmentalSettings','\x27)/items?$filter=Title\x20eq\x20\x27Client_Credentials\x27\x20','.select-row_isReadeySelected','Mobile','#ddlfilterDepartments','The\x20following\x20users\x20failed\x20to\x20sync\x20due\x20to\x20wrong\x20manager\x20defined!.\x0a','DepartmentsId','promise','This\x20browser\x20does\x20not\x20support\x20HTML5.','Please\x20upload\x20a\x20valid\x20Excel\x20file.','resolve','CompanyId','mail','#btnDownLoadReport','SP.User','#IsMiisingSelected','click','/_api/SP.OAuth.Token/Acquire','mm/dd/yy','displayName','10782706KDeiIe','split','Your\x20License\x20limit\x20has\x20been\x20ended','<input\x20type=\x22checkbox\x22\x20class=\x22select-row_isReadeySelected\x22\x20aria-label=\x22select\x20this\x20row\x22\x20/>','Welcome','readAsBinaryString','<span\x20class=\x27breakpoint\x27></span>','getRow','12hJevSc','.searching','readAsArrayBuffer','_row','xlsx','chkManager','Select\x20Company','AllowMultipleValues','WebPartName','All','</h3>\x20<p\x20class\x20=\x20\x22m-0\x22\x20>\x20Uploaded\x20</p>','/_api/web/lists/getByTitle(\x27OfficeLocation\x27)/items?$select=*&$top=4900','PIN/ZIP','ddlOfficeLocation','ddlfilterOfficeLocation','#lblUpdate','#btnsubmitready','when','checked','363858RBnzvg','fileUpload','ajax','createElement','length','OfficeLocationId','option:selected','#btnFilter','/_api/web/lists/GetByTitle(\x27','PrincipalAccountType','https://graph.microsoft.com','please\x20check\x20at\x20list\x20one\x20checkbox\x20','deselectRow','CompanyName','GET','#ddlfilterOfficeLocation','ListItem','i:0#.f|membership|','setHours','getElement','Ready','10768mhkHDz','hide','access_token','#__REQUESTDIGEST','<option\x20value=\x22','User\x20has\x20been\x20assigned\x20permission\x20.','Email(Other)','Company','Data\x20Send\x20to\x20Announcements\x20Failed','application/json;odata=verbose','[id$=\x27AssaginTomanager_TopSpan\x27]','indexOf','21aGwUhy','#upload','/_api/web/lists/getbytitle(\x27','#ddlOfficeLocation','DepartmentName','Required\x20Value\x20Missing','<h3\x20class=\x27m-0\x27>','SP.Data.','log','Department','target','2bjbtwQ','static','Home\x20Phone','after','EmployeeId','setData','DepartmentNameDetail','EntityData','Description','\x27)/items','Date\x20Of\x20Marriage','\x20,\x20','Not\x20SP\x20Permission','#successfully_notifications','getMonth','ResolvePrincipalSource','Department\x20Id\x20is\x20not\x20Correct','stringify','test','NotSave','keyup'];a21_0x19a5=function(){return _0x1d3a58;};return a21_0x19a5();}function AddUserinSharePointGroup(_0x2c6d8c){var _0x36dd68=a21_0x413b07,_0x5d6d47=$[_0x36dd68(0x214)](),_0x5957bf=_0x36dd68(0x1d0),_0x14f3b8=_0x5957bf+_0x2c6d8c,_0x2d1e96=_spPageContextInfo[_0x36dd68(0x23c)]+'/_api/web/sitegroups('+contributersGroupId+_0x36dd68(0x171);$[_0x36dd68(0x1c1)]({'url':_0x2d1e96,'type':_0x36dd68(0x163),'async':![],'data':JSON['stringify']({'__metadata':{'type':_0x36dd68(0x19e)},'LoginName':_0x14f3b8}),'headers':{'accept':'application/json;odata=verbose','content-type':_0x36dd68(0x1dd),'X-RequestDigest':$(_0x36dd68(0x1d7))['val']()},'success':_0xe48ea5,'error':_0x384c1c});function _0xe48ea5(_0x3ec1b0){var _0x35ae0c=_0x36dd68;_0x5d6d47[_0x35ae0c(0x19a)](_0x3ec1b0['d']['Id']),console[_0x35ae0c(0x1e8)](_0x35ae0c(0x152));}function _0x384c1c(_0x1d520d){var _0x499734=_0x36dd68;console['log'](JSON[_0x499734(0x1fc)](_0x1d520d));}return _0x5d6d47[_0x36dd68(0x197)]();}function GetUserId(_0x4d3053){var _0x2d38f7=a21_0x413b07,_0x5ca3d6='',_0x32066f=_0x2d38f7(0x1d0),_0x5a3d73=_spPageContextInfo['siteAbsoluteUrl'],_0x4e3f39=_0x32066f+_0x4d3053;return $[_0x2d38f7(0x1c1)]({'url':_0x5a3d73+_0x2d38f7(0x183)+encodeURIComponent(_0x4e3f39)+'\x27','method':_0x2d38f7(0x1cd),'headers':{'Accept':'application/json;\x20odata=verbose'},'async':![],'success':function(_0x48051c){_0x5ca3d6=_0x48051c['d']['Id'];},'error':function(_0x1e5594){var _0xa85b64=_0x2d38f7;console[_0xa85b64(0x1e8)](JSON['stringify'](_0x1e5594));}}),_0x5ca3d6;}var GetAllGroupsUser=[],GroupUrl=_spPageContextInfo['siteAbsoluteUrl']+'/_api/web/siteusers?$top=1000&$select=*,Id';function GetAllUserId(){var _0x471ca0=a21_0x413b07;$[_0x471ca0(0x1c1)]({'url':GroupUrl,'method':_0x471ca0(0x1cd),'headers':{'Accept':_0x471ca0(0x17b)},'async':![],'success':function(_0x1bda3a){var _0x3eda25=_0x471ca0;GetAllGroupsUser=GetAllGroupsUser['concat'](_0x1bda3a['d'][_0x3eda25(0x22d)]),_0x1bda3a['d'][_0x3eda25(0x278)]!=null&&(GroupUrl=_0x1bda3a['d'][_0x3eda25(0x278)],GetAllUserId());},'error':function(_0x2f66e8){var _0x19cb53=_0x471ca0;console['log'](JSON[_0x19cb53(0x1fc)](_0x2f66e8));}});}var LoginName;function UpdateExistingEmployeeAllocated(_0x256840,_0x2af4e5){var _0x4956a2=a21_0x413b07;try{UserEmailId=_0x256840[0x0][_0x4956a2(0x189)],LoginName=_0x4956a2(0x1d0)+_0x256840[0x0][_0x4956a2(0x189)];var _0x56da66,_0x1dd923,_0x3cad18=GetAllGroupsUser[_0x4956a2(0x209)](function(_0x2c0666){var _0x579745=_0x4956a2;return _0x2c0666[_0x579745(0x174)][_0x579745(0x259)]()==_0x256840[0x0][_0x579745(0x189)][_0x579745(0x259)]();});if(_0x3cad18[_0x4956a2(0x1c3)]>0x0)var _0x34669c=_0x3cad18[0x0]['Id'];else{}if(TopExecutive==_0x4956a2(0x149)||_0x256840[0x0][_0x4956a2(0x21a)]==undefined)_0x256840[0x0][_0x4956a2(0x21a)]='Chief\x20Executive',_0x56da66=-0x1;else{var _0x13d376=EmployeeListUsers['filter'](function(_0x2da689){var _0x38a282=_0x4956a2,_0x3a6f39;if(_0x2da689['Manager']!=null)return _0x3a6f39=_0x2da689['Email']['toLowerCase'](),_0x3a6f39==_0x256840[0x0]['Manager\x20*'][_0x38a282(0x259)]();});if(_0x13d376['length']>0x0){_0x1dd923=_0x13d376[0x0][_0x4956a2(0x17c)];var _0x3cad18=GetAllGroupsUser[_0x4956a2(0x209)](function(_0x562ffa){var _0x488ba0=_0x4956a2;return _0x562ffa[_0x488ba0(0x174)][_0x488ba0(0x259)]()==_0x256840[0x0][_0x488ba0(0x21a)][_0x488ba0(0x259)]();});if(_0x3cad18[_0x4956a2(0x1c3)]>0x0)_0x56da66=_0x3cad18[0x0]['Id'];else{}}else{IsManager=![],_0x56da66='';var _0x8d890f=excelRows[_0x4956a2(0x20a)](_0x3b47fb=>_0x3b47fb[_0x4956a2(0x189)][_0x4956a2(0x259)]()==_0x256840[0x0]['Email\x20*'][_0x4956a2(0x259)]());excelRows[_0x8d890f][_0x4956a2(0x241)]='Worng\x20Manager';}}var _0x1f8a74,_0x5236dd=GetItemTypeForListName(_0x2af4e5);_0x1f8a74={'__metadata':{'type':_0x5236dd},'Designation':_0x256840[0x0]['Designation\x20*'],'GroupName':_0x256840[0x0]['Group\x20Name'],'Manager':_0x1dd923,'ManagerLoginNameId':_0x56da66},$['when'](updateItemExitUser(_0x2af4e5,_0x1f8a74,_0x256840[0x0][_0x4956a2(0x221)]))['done'](function(_0x3dafbf){var _0x4ef45b=_0x4956a2,_0x23a33=_0x3dafbf;if(_0x23a33){lblUpdate=lblUpdate+0x1,Exits=Exits-0x1;var _0x2f8ebe=excelRows[_0x4ef45b(0x20a)](_0x2925b6=>_0x2925b6[_0x4ef45b(0x189)]==UserEmailId);excelRows[_0x2f8ebe]['Status']=_0x4ef45b(0x162),showmessage();}});}catch(_0x332740){console[_0x4956a2(0x1e8)](_0x332740[_0x4956a2(0x164)]);}}var IsManager=!![];function AddNewEmployeeAllocated(_0x305520,_0x1f85ee){var _0x56aeee=a21_0x413b07;try{if(GetListItems(_0x56aeee(0x23e),parseInt(_0x305520[0x0][_0x56aeee(0x20f)])))return alert(_0x56aeee(0x1fb)),![];if(GetListItems('Companies',parseInt(_0x305520[0x0][_0x56aeee(0x25e)])))return alert('Company\x20Id\x20is\x20not\x20Correct'),![];else{if(GetListItems(_0x56aeee(0x250),parseInt(_0x305520[0x0][_0x56aeee(0x25f)])))return alert('Office\x20Location\x20Id\x20is\x20not\x20Correct'),![];else{LoginName=_0x305520[0x0][_0x56aeee(0x189)]['toLowerCase']();var _0x5d5a82,_0x2e938a,_0x4c5328=GetAllGroupsUser[_0x56aeee(0x209)](function(_0x4d5bc0){var _0x205b9c=_0x56aeee;return _0x4d5bc0[_0x205b9c(0x174)][_0x205b9c(0x259)]()==_0x305520[0x0][_0x205b9c(0x189)][_0x205b9c(0x259)]();}),_0x522700;if(_0x4c5328[_0x56aeee(0x1c3)]>0x0)var _0x522700=_0x4c5328[0x0]['Id'];else $['when'](AddUserinSharePointGroup(LoginName))[_0x56aeee(0x141)](function(_0xb87e90){_0x522700=_0xb87e90;});if(TopExecutive==_0x56aeee(0x149)||_0x305520[0x0][_0x56aeee(0x21a)]==undefined)_0x305520[0x0][_0x56aeee(0x21a)]='Chief\x20Executive',_0x5d5a82=-0x1;else{var _0x12a0ea=EmployeeListUsers[_0x56aeee(0x209)](function(_0x1977b6){var _0x39071a=_0x56aeee,_0x59667c;if(_0x1977b6[_0x39071a(0x174)]!=null)return _0x59667c=_0x1977b6[_0x39071a(0x174)]['toLowerCase'](),_0x59667c==_0x305520[0x0]['Manager\x20*'][_0x39071a(0x259)]();});if(_0x12a0ea[_0x56aeee(0x1c3)]>0x0){_0x2e938a=_0x12a0ea[0x0][_0x56aeee(0x17c)];var _0x4c5328=GetAllGroupsUser[_0x56aeee(0x209)](function(_0x1871ab){var _0xa0d036=_0x56aeee;return _0x1871ab['Email']['toLowerCase']()==_0x305520[0x0][_0xa0d036(0x21a)][_0xa0d036(0x259)]();});_0x4c5328[_0x56aeee(0x1c3)]>0x0?_0x5d5a82=_0x4c5328[0x0]['Id']:_0x5d5a82=AddUserinSharePointGroup(_0x305520[0x0][_0x56aeee(0x21a)][_0x56aeee(0x259)]());}else{IsManager=![],_0x5d5a82='';var _0x42ddaf=excelRows['findIndex'](_0x3b8438=>_0x3b8438[_0x56aeee(0x189)][_0x56aeee(0x259)]()==LoginName);excelRows[_0x42ddaf]['Status']=_0x56aeee(0x17a);}}var _0x16399c,_0x41606b=GetItemTypeForListName(_0x1f85ee);_0x16399c={'__metadata':{'type':_0x41606b},'CompanyId':parseInt(_0x305520[0x0][_0x56aeee(0x25e)]),'DepartmentId':parseInt(_0x305520[0x0][_0x56aeee(0x20f)]),'FullName':_0x305520[0x0][_0x56aeee(0x251)],'Title':_0x305520[0x0]['Name'],'ParentId':'-1','Email':_0x305520[0x0]['Email\x20*'],'LogonNameId':_0x522700,'Manager':_0x305520[0x0][_0x56aeee(0x21a)],'ManagerLoginNameId':_0x5d5a82,'OfficeLocationId':parseInt(_0x305520[0x0]['Location\x20*']),'MobileNumber':_0x305520[0x0][_0x56aeee(0x193)],'DateOfBirth':_0x305520[0x0][_0x56aeee(0x151)],'Gender':_0x305520[0x0][_0x56aeee(0x275)],'DateOfAnniversary':_0x305520[0x0][_0x56aeee(0x1f5)],'JoiningDate':_0x305520[0x0][_0x56aeee(0x18d)],'Designation':_0x305520[0x0]['Designation\x20*'],'PrimaryCompany':_0x56aeee(0x22a),'EmployeeID':_0x305520[0x0]['Employee\x20Code'],'GroupName':_0x305520[0x0][_0x56aeee(0x216)],'Status':_0x56aeee(0x222),'PostalAddresses':_0x305520[0x0]['Postal\x20Address'],'City':_0x305520[0x0]['City'],'StateProvince':_0x305520[0x0][_0x56aeee(0x263)],'ZIPPostalCode':_0x305520[0x0][_0x56aeee(0x1b8)],'Country':_0x305520[0x0][_0x56aeee(0x186)],'HomePhone':_0x305520[0x0][_0x56aeee(0x1ed)],'OtherEMailAddress':_0x305520[0x0][_0x56aeee(0x1da)],'HomeAddress':_0x305520[0x0][_0x56aeee(0x226)]},AddItemToList(_0x1f85ee,_0x16399c);var _0x1587d3=new Date(),_0x53e131=new Date(_0x305520[0x0]['Date\x20Of\x20Joining']),_0x354249=daysDifference(_0x53e131,_0x1587d3);if(_0x354249<=0xf)AddedEmployeeList[_0x56aeee(0x26a)]({'Metadata':_0x16399c,'EmployeeId':EmployeeId,'EmployeeOfficeLocation':_0x305520[0x0][_0x56aeee(0x201)],'EmployeeDepartment':_0x305520[0x0][_0x56aeee(0x1f1)]});else{}}}}catch(_0x3a6db8){console[_0x56aeee(0x1e8)](_0x3a6db8['message']);}}function daysDifference(_0x23fae1,_0x33fa2d){var _0x39d711=a21_0x413b07,_0x344a01=new Date(+_0x33fa2d)['setHours'](0xc)-new Date(+_0x23fae1)[_0x39d711(0x1d1)](0xc);return Math['round'](_0x344a01/0x5265c00);}function updateItemExitUser(_0x939a06,_0x2a897,_0x211762){var _0x1b03ee=a21_0x413b07,_0x2636ab=$[_0x1b03ee(0x214)]();return $[_0x1b03ee(0x1c1)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x1b03ee(0x1e2)+_0x939a06+'\x27)/GetItemById(\x27'+_0x211762+'\x27)','type':'POST','headers':{'accept':_0x1b03ee(0x1dd),'X-RequestDigest':$(_0x1b03ee(0x1d7))[_0x1b03ee(0x145)](),'content-Type':_0x1b03ee(0x1dd),'X-Http-Method':_0x1b03ee(0x236),'If-Match':'*'},'data':JSON[_0x1b03ee(0x1fc)](_0x2a897),'async':![],'success':function(_0x428f89){var _0x100f43=_0x1b03ee;_0x2636ab[_0x100f43(0x19a)](!![]);},'error':function(_0xd59f29){var _0x26d73d=_0x1b03ee;_0x2636ab[_0x26d73d(0x271)](_0xd59f29);}}),_0x2636ab['promise']();}function AddItemToList(_0x35836f,_0x299c8a){var _0x54e051=a21_0x413b07;UserEmailId=_0x299c8a[_0x54e051(0x174)];var _0x55b547=_0x299c8a[_0x54e051(0x17c)];EmployeeId='';var _0x52e17a=$['Deferred']();return $['ajax']({'url':_spPageContextInfo[_0x54e051(0x23c)]+_0x54e051(0x1e2)+_0x35836f+_0x54e051(0x1f4),'type':_0x54e051(0x163),'async':![],'headers':{'accept':_0x54e051(0x1dd),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x54e051(0x145)](),'content-Type':_0x54e051(0x1dd)},'data':JSON[_0x54e051(0x1fc)](_0x299c8a),'success':function(_0x33dbf2){var _0x2b1061=_0x54e051;EmployeeId=_0x33dbf2['d']['Id'],counusers=counusers+0x1,AvilableLicenses=AvilableLicenses-0x1,Ready=Ready-0x1;var _0xdb9108=excelRows['findIndex'](_0x5356d9=>_0x5356d9[_0x2b1061(0x189)]==UserEmailId);excelRows[_0xdb9108][_0x2b1061(0x241)]=_0x2b1061(0x153),showmessage();var _0x348119=GetSubSiteUrl('Departments',_0x33dbf2['d'][_0x2b1061(0x252)]);AssignPermissiononDMSLibary(_0x33dbf2['d'][_0x2b1061(0x173)],'1073741826',_0x348119),_0x52e17a[_0x2b1061(0x19a)](_0x33dbf2);},'error':function(_0x4c3bfc){var _0x29f2dd=_0x54e051;if(IsManager){var _0x4f9c78=excelRows[_0x29f2dd(0x20a)](_0x432c51=>_0x432c51[_0x29f2dd(0x189)]==UserEmailId);excelRows[_0x4f9c78][_0x29f2dd(0x241)]=_0x29f2dd(0x1f7);}userfullname==''?(userfullname+=_0x55b547,warningmessage=_0x29f2dd(0x195)):userfullname+=_0x29f2dd(0x1f6)+_0x55b547,Ready=Ready-0x1,Error=Error+0x1,console[_0x29f2dd(0x1e8)](JSON['stringify'](_0x4c3bfc)),_0x52e17a['reject'](JSON['stringify'](_0x4c3bfc));}}),_0x52e17a[_0x54e051(0x197)]();}function LoadShowUser(_0x248174){var _0xdda52=a21_0x413b07;tabledata=new Tabulator(_0xdda52(0x168),{'height':'','pagination':_0xdda52(0x17d),'paginationSize':0xa,'layout':_0xdda52(0x227),'paginationSizeSelector':[0xa,0x19,0x32,0x64],'placeholder':_0xdda52(0x178),'data':_0x248174,'pageLoaded':function(_0x54ac5e){var _0x312f82=_0xdda52;_0x54ac5e>=0x1?pageIndex=_0x54ac5e:pageIndex=_0x54ac5e,IsMiisingSelect=document[_0x312f82(0x157)](_0x312f82(0x21c)),IsMiisingSelect[_0x312f82(0x1be)]&&$(_0x312f82(0x21e))[_0x312f82(0x220)](_0x312f82(0x1be),!![]),isReadeySelect=document[_0x312f82(0x157)]('isReadeySelected'),isReadeySelect[_0x312f82(0x1be)]&&$('.select-row_isReadeySelected')[_0x312f82(0x220)](_0x312f82(0x1be),!![]);},'columns':[{'formatter':function(_0x461d25,_0x459abb){var _0x4a8588=_0xdda52,_0xa7c94e=_0x461d25[_0x4a8588(0x265)][_0x4a8588(0x14f)]['data']['Status'];return _0xa7c94e==_0x4a8588(0x176)||_0xa7c94e=='Required\x20Value\x20Missing'||_0xa7c94e==_0x4a8588(0x153)||_0xa7c94e=='Updated'?_0x4a8588(0x158):_0x4a8588(0x1a7);},'title':_0xdda52(0x24a),'field':'ID','width':'1%','headerSort':![],'cellClick':function(_0x4df32a,_0xcd0719){var _0x5d77da=_0xdda52,_0x51c79a=$(_0xcd0719[_0x5d77da(0x1d2)]()),_0xeafc09=_0x51c79a[_0x5d77da(0x20e)](_0x5d77da(0x192));_0xeafc09[0x0][_0x5d77da(0x1be)]==![]&&$(_0xcd0719['getRow']()[_0x5d77da(0x1d2)]())[_0x5d77da(0x20e)]('.select-row_IsMiisingSelected')[0x0][_0x5d77da(0x1be)]==![]?_0xcd0719[_0x5d77da(0x1ab)]()['deselect']():_0xcd0719['getRow']()['select']();}},{'formatter':function(_0x320247,_0x5916d1){var _0xaf9180=_0xdda52,_0x2bf943=_0x320247[_0xaf9180(0x265)][_0xaf9180(0x14f)][_0xaf9180(0x239)][_0xaf9180(0x241)];return _0x2bf943==_0xaf9180(0x1e5)||_0x2bf943==_0xaf9180(0x224)||_0x2bf943==_0xaf9180(0x1d3)?'<input\x20type=\x22checkbox\x22\x20class=\x22select-row_IsMiisingSelected\x22\x20aria-label=\x22select\x20this\x20row\x22\x20/>':_0xaf9180(0x158);},'title':_0xdda52(0x277),'hozAlign':_0xdda52(0x24e),'field':'ID','headerSort':![],'width':'1%','cellClick':function(_0xd3b4e7,_0x111075){var _0x4e45eb=_0xdda52,_0x5c6c0a=$(_0x111075[_0x4e45eb(0x1d2)]()),_0x4ce231=_0x5c6c0a[_0x4e45eb(0x20e)](_0x4e45eb(0x21e));_0x4ce231[0x0][_0x4e45eb(0x1be)]==![]&&$(_0x111075[_0x4e45eb(0x1ab)]()[_0x4e45eb(0x1d2)]())['find'](_0x4e45eb(0x192))[0x0][_0x4e45eb(0x1be)]==![]?_0x111075['getRow']()[_0x4e45eb(0x233)]():_0x111075[_0x4e45eb(0x1ab)]()['select']();}},{'title':_0xdda52(0x241),'field':_0xdda52(0x241),'width':'8%','formatter':function(_0x2ffd70,_0x4f6f17){var _0x4010ca=_0xdda52,_0x231371=_0x2ffd70[_0x4010ca(0x23f)]();if(_0x231371==_0x4010ca(0x176)||_0x231371=='Required\x20Value\x20Missing'||_0x231371=='Not\x20SP\x20Permission'||_0x231371==_0x4010ca(0x154))return _0x4010ca(0x207)+_0x231371+_0x4010ca(0x27d);else return _0x231371==_0x4010ca(0x224)?'\x20<span\x20style=\x27color:blue;\x20font-weight:bold;\x27>'+_0x231371+_0x4010ca(0x27d):_0x4010ca(0x14d)+_0x231371+'</span>';}},{'title':_0xdda52(0x25d),'field':_0xdda52(0x25d),'width':_0xdda52(0x234)},{'title':_0xdda52(0x251),'field':_0xdda52(0x251),'width':_0xdda52(0x234)},{'title':_0xdda52(0x174),'field':_0xdda52(0x189),'align':'left','width':'15%'},{'title':'Company','field':_0xdda52(0x25e),'width':_0xdda52(0x234),'align':'center'},{'title':_0xdda52(0x1e9),'field':_0xdda52(0x20f),'width':_0xdda52(0x234),'align':_0xdda52(0x24e)},{'title':_0xdda52(0x18e),'field':_0xdda52(0x25f),'width':'8%','align':_0xdda52(0x24e)},{'title':'Designation','field':_0xdda52(0x15d),'width':_0xdda52(0x234)},{'title':_0xdda52(0x23d),'field':_0xdda52(0x21a),'width':_0xdda52(0x234)},{'title':_0xdda52(0x18d),'field':_0xdda52(0x18d),'width':_0xdda52(0x234)},{'title':_0xdda52(0x216),'field':_0xdda52(0x216),'width':'10%'}]}),showmessage(),$(_0xdda52(0x142))[_0xdda52(0x279)](_0xdda52(0x21b)),$(_0xdda52(0x150))[_0xdda52(0x27b)](),$(_0xdda52(0x260))[_0xdda52(0x1ee)](_0xdda52(0x1aa));}function showmessage(){var _0x471edf=a21_0x413b07;$(_0x471edf(0x26d))[_0x471edf(0x16a)](Ready),$(_0x471edf(0x21f))[_0x471edf(0x16a)](Error),$(_0x471edf(0x267))[_0x471edf(0x16a)](Exits),$('#lblUpdate')[_0x471edf(0x16a)](lblUpdate),$(_0x471edf(0x26f))[_0x471edf(0x16a)](AvilableLicenses);}function requestToken(){var _0x2f8429=a21_0x413b07;$['ajax']({'async':!![],'crossDomain':!![],'url':ClientUrl,'method':_0x2f8429(0x163),'headers':{'content-type':'application/x-www-form-urlencoded'},'data':{'grant_type':'client_credentials','client_id\x20':ClientId,'client_secret':ClentSecret,'scope\x20':_0x2f8429(0x208)},'success':function(_0x4e10e3){var _0x158226=_0x2f8429;console[_0x158226(0x1e8)](_0x4e10e3),token=_0x4e10e3[_0x158226(0x1d6)];},'error':function(_0x879f56){console['log'](JSON['stringify'](_0x879f56));}});}function GraphAccessTokenTogetUserDetails(){var _0x21496f=a21_0x413b07,_0x1d0bd2=new jQuery['Deferred'](),_0x3ba1a0={'X-RequestDigest':$('#__REQUESTDIGEST')['val'](),'accept':'application/json;odata=nometadata','content-type':_0x21496f(0x182)},_0x2a3c11={'resource':_0x21496f(0x1c9)};return $['ajax']({'url':_spPageContextInfo[_0x21496f(0x23c)]+_0x21496f(0x1a1),'headers':_0x3ba1a0,'type':_0x21496f(0x163),'async':![],'data':JSON['stringify'](_0x2a3c11),'success':function(_0x4db3c){var _0x247abf=_0x21496f;token=_0x4db3c[_0x247abf(0x1d6)],_0x1d0bd2['resolve'](token);},'error':function(_0x13347c,_0x41831d,_0x3c1c1f){var _0x96c025=_0x21496f;console['log'](_0x13347c[_0x96c025(0x25b)]),_0x1d0bd2[_0x96c025(0x271)](_0x13347c[_0x96c025(0x25b)]);}}),_0x1d0bd2[_0x21496f(0x197)]();}var employeehtml='',userName='',AzureUsrlist=[],AdusersUrl=a21_0x413b07(0x268);function GetAzureUsrlist(_0x2ad753,_0x3e7fa7){var _0x436292=a21_0x413b07;return DeferredObj=$[_0x436292(0x214)](),$[_0x436292(0x1c1)]({'method':'GET','url':_0x2ad753,'headers':{'Authorization':_0x436292(0x169)+_0x3e7fa7,'Content-Type':_0x436292(0x254)},'async':![],'success':function(_0x143469){var _0x3c92f4=_0x436292;AzureUsrlist=AzureUsrlist[_0x3c92f4(0x215)](_0x143469[_0x3c92f4(0x16c)]),_0x143469[_0x3c92f4(0x217)]!=null&&(AdusersUrl=_0x143469[_0x3c92f4(0x217)],GetAzureUsrlist(AdusersUrl,_0x3e7fa7));},'error':function(_0x34afc7){var _0x15a7ae=_0x436292;DeferredObj['reject'](_0x34afc7),alert(_0x15a7ae(0x15a)+JSON[_0x15a7ae(0x1fc)](_0x34afc7));}}),DeferredObj[_0x436292(0x197)]();}function getEmployee(_0x4cadcb){var _0xd18a23=a21_0x413b07,_0x298a75='https://graph.microsoft.com/v1.0/users?$filter=mail\x20eq\x20\x27'+_0x4cadcb+'\x27';return DeferredObj=$[_0xd18a23(0x214)](),$[_0xd18a23(0x1c1)]({'method':_0xd18a23(0x1cd),'url':_0x298a75,'headers':{'Authorization':_0xd18a23(0x169)+token,'Content-Type':_0xd18a23(0x254)},'async':![],'success':function(_0x369daf){var _0x1a270=_0xd18a23;_0x369daf['value'][_0x1a270(0x1c3)]>0x0?DeferredObj[_0x1a270(0x19a)](_0x369daf['value'][0x0][_0x1a270(0x1a3)]):DeferredObj['resolve'](_0x1a270(0x176));},'error':function(_0x31ee75){var _0x11efdb=_0xd18a23;DeferredObj[_0x11efdb(0x271)](_0x31ee75),alert('error1'+JSON[_0x11efdb(0x1fc)](_0x31ee75));}}),DeferredObj['promise']();}function ClientCredentials(){var _0x27d8c7=a21_0x413b07,_0x5140d3=_0x27d8c7(0x190),_0x49630e=titanForWork[_0x27d8c7(0x24b)](_0x27d8c7(0x19b)),_0x1c89a5=_spPageContextInfo['webAbsoluteUrl']+_0x27d8c7(0x1c7)+_0x5140d3+_0x27d8c7(0x191);$[_0x27d8c7(0x1c1)]({'url':_0x1c89a5,'headers':{'Accept':_0x27d8c7(0x1dd)},'async':![],'success':function(_0x39c905){var _0x55732f=_0x27d8c7,_0x19dfdd=_0x39c905['d'][_0x55732f(0x22d)];ClientId=_0x19dfdd[0x0][_0x55732f(0x17f)],ClentSecret=_0x19dfdd[0x0][_0x55732f(0x261)],ClientUrl=_0x19dfdd[0x0][_0x55732f(0x1f3)];},'error':function(_0x1a099a){var _0x56aef1=_0x27d8c7;console[_0x56aef1(0x1e8)](_0x1a099a);}});}var EmployeeListUsers=[],GetQueryURL=_spPageContextInfo[a21_0x413b07(0x23c)]+a21_0x413b07(0x244);function GetEmployees(){$['ajax']({'url':GetQueryURL,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'beforeSend':function(){},'success':function(_0x51de06){var _0x117192=a21_0x54aa;EmployeeListUsers=EmployeeListUsers[_0x117192(0x215)](_0x51de06['d'][_0x117192(0x22d)]);if(_0x51de06['d'][_0x117192(0x278)]!=null)GetQueryURL=_0x51de06['d'][_0x117192(0x278)],GetEmployees();else{GetQueryURL=_spPageContextInfo[_0x117192(0x23c)]+_0x117192(0x244);var _0x5983ed='',_0x273bdd=_spPageContextInfo[_0x117192(0x23c)]+'/_api/web/lists/getbytitle(\x27ExternalUsers\x27)/items?$select=*,InternalStakeholders/Title,Supervisor_Guest/Title,Client_Name/Title,LoginName/Title\x20&$expand=\x20LoginName,Client_Name,Supervisor_Guest,InternalStakeholders\x20&$filter=((Status\x20eq\x20\x27Initiated\x27)\x20or\x20(Status\x20eq\x20\x27Invited\x27\x20)or\x20(Status\x20eq\x20\x27Pending\x27)or\x20(Status\x20eq\x20\x27Accepted\x27))';extdfds=$['Deferred'](),$[_0x117192(0x1bd)](getItems(_0x273bdd,extdfds))[_0x117192(0x141)](function(_0x344e1c){var _0x500cae=_0x117192;response=[],_0x5983ed=_0x344e1c[_0x500cae(0x1c3)];});}AvilableLicenses=parseInt(UsersLicenceRequired)-(parseInt(EmployeeListUsers[_0x117192(0x1c3)])+parseInt(_0x5983ed));},'error':function(_0x900665){var _0x530fc6=a21_0x54aa;console[_0x530fc6(0x1e8)](_0x900665);}});}var fileUploadevent=document[a21_0x413b07(0x157)](a21_0x413b07(0x1c0));fileUploadevent[a21_0x413b07(0x219)]=function(){var _0x56b3cb=a21_0x413b07;EmployeeListUsers=[],AvilableLicenses=0x0,this[_0x56b3cb(0x16c)]=null;},fileUploadevent[a21_0x413b07(0x210)]=function(){$['ajax']({'cache':![],'beforeSend':function(){var _0x456573=a21_0x54aa;$(_0x456573(0x20d))[_0x456573(0x238)]();},'success':function(_0x5a5e35){var _0x471423=a21_0x54aa,_0x19164f=document[_0x471423(0x157)](_0x471423(0x1c0));AzureUsrlist[_0x471423(0x1c3)]==0x0&&GetAzureUsrlist(AdusersUrl,token);AvilableLicenses=0x0,GetEmployees(),LoadShowUser([]),Ready=0x0,Error=0x0,lblUpdate=0x0,counusers=0x0,Exits=0x0,$(_0x471423(0x26d))['text'](0x0),$(_0x471423(0x21f))[_0x471423(0x16a)](0x0),$(_0x471423(0x22e))[_0x471423(0x16a)](0x0),$(_0x471423(0x1bb))['text'](0x0),$(_0x471423(0x267))[_0x471423(0x16a)](0x0);var _0x59bd64=/^([a-zA-Z0-9\s_\\.\-:])+(.xls|.xlsx)$/;if(_0x59bd64[_0x471423(0x1fd)](_0x19164f[_0x471423(0x16c)][_0x471423(0x259)]())){if(typeof FileReader!=_0x471423(0x240)){var _0x6d6e8e=new FileReader();_0x6d6e8e[_0x471423(0x1a9)]?(_0x6d6e8e['onload']=function(_0x11a0a3){var _0x4b0d7c=_0x471423;ProcessExcel(_0x11a0a3[_0x4b0d7c(0x1ea)][_0x4b0d7c(0x187)]);},_0x6d6e8e['readAsBinaryString'](_0x19164f['files'][0x0])):(_0x6d6e8e['onload']=function(_0x381cba){var _0x222780=_0x471423,_0x4dbe88='',_0x268eee=new Uint8Array(_0x381cba[_0x222780(0x1ea)][_0x222780(0x187)]);for(var _0x2c7c44=0x0;_0x2c7c44<_0x268eee[_0x222780(0x22f)];_0x2c7c44++){_0x4dbe88+=String['fromCharCode'](_0x268eee[_0x2c7c44]);}ProcessExcel(_0x4dbe88);},_0x6d6e8e[_0x471423(0x1ae)](_0x19164f[_0x471423(0x273)][0x0]));}else alert('This\x20browser\x20does\x20not\x20support\x20HTML5.');}else alert('Please\x20upload\x20a\x20valid\x20Excel\x20file.');$(_0x471423(0x20d))[_0x471423(0x270)]();}});},$(function(){var _0x5a2570=a21_0x413b07;$(_0x5a2570(0x1e1))['click'](function(){var _0x22df2a=_0x5a2570,_0x1b0b5b=document[_0x22df2a(0x157)](_0x22df2a(0x1c0));GetEmployees(),LoadShowUser([]),Ready=0x0,Error=0x0,counusers=0x0;var _0x170960=/^([a-zA-Z0-9\s_\\.\-:])+(.xls|.xlsx)$/;if(_0x170960[_0x22df2a(0x1fd)](_0x1b0b5b['value']['toLowerCase']())){if(typeof FileReader!=_0x22df2a(0x240)){var _0x45a188=new FileReader();_0x45a188[_0x22df2a(0x1a9)]?(_0x45a188[_0x22df2a(0x16e)]=function(_0x2c6594){var _0x2ee498=_0x22df2a;ProcessExcel(_0x2c6594[_0x2ee498(0x1ea)][_0x2ee498(0x187)]);},_0x45a188[_0x22df2a(0x1a9)](_0x1b0b5b['files'][0x0])):(_0x45a188[_0x22df2a(0x16e)]=function(_0x219660){var _0x257433=_0x22df2a,_0x23de87='',_0x1a817c=new Uint8Array(_0x219660[_0x257433(0x1ea)][_0x257433(0x187)]);for(var _0x4ca455=0x0;_0x4ca455<_0x1a817c['byteLength'];_0x4ca455++){_0x23de87+=String[_0x257433(0x247)](_0x1a817c[_0x4ca455]);}ProcessExcel(_0x23de87);},_0x45a188[_0x22df2a(0x1ae)](_0x1b0b5b[_0x22df2a(0x273)][0x0]));}else alert(_0x22df2a(0x198));}else alert(_0x22df2a(0x199));});});function ProcessExcel(_0x4f4d18){var _0x543a74=a21_0x413b07,_0x2b2190=XLSX['read'](_0x4f4d18,{'type':'binary'}),_0x462470=_0x2b2190[_0x543a74(0x230)][0x0];excelRows=XLSX[_0x543a74(0x205)]['sheet_to_row_object_array'](_0x2b2190[_0x543a74(0x140)][_0x462470]),$(_0x543a74(0x16d))[_0x543a74(0x22c)](),$(_0x543a74(0x16d))[_0x543a74(0x245)](_0x543a74(0x1e6)+excelRows['length']+_0x543a74(0x1b6)),$(_0x543a74(0x21d))[_0x543a74(0x279)]('');for(var _0x4b0186=0x0;_0x4b0186<excelRows[_0x543a74(0x1c3)];_0x4b0186++){var _0x8015f9='';ErrorUser='';var _0x5c7691=EmployeeListUsers[_0x543a74(0x209)](function(_0x53ba06){var _0x23a39d=_0x543a74,_0x41e9f3=_0x53ba06[_0x23a39d(0x174)][_0x23a39d(0x259)]();return _0x41e9f3==excelRows[_0x4b0186]['Email\x20*'][_0x23a39d(0x259)]();});if(_0x5c7691['length']>0x0){_0x8015f9=_0x5c7691[0x0][_0x543a74(0x17c)],color_red=_0x543a74(0x20c),ErrorUser='Already\x20Exist',Exits=Exits+0x1;var _0x4d50b4=_0x5c7691[0x0]['ID'];excelRows[_0x4b0186][_0x543a74(0x25e)]='-',excelRows[_0x4b0186]['Department\x20*']='-',excelRows[_0x4b0186][_0x543a74(0x25f)]='-';}else{var _0x6e3bf8=AzureUsrlist[_0x543a74(0x209)](function(_0x3fede2){var _0x433b0a=_0x543a74;if(_0x3fede2[_0x433b0a(0x19c)]!=null){var _0x20c7f8=_0x3fede2[_0x433b0a(0x19c)][_0x433b0a(0x259)]();return _0x20c7f8==excelRows[_0x4b0186][_0x433b0a(0x189)][_0x433b0a(0x259)]();}});if(_0x6e3bf8[_0x543a74(0x1c3)]>0x0){_0x8015f9=_0x6e3bf8[0x0][_0x543a74(0x1a3)];var _0x37fbe7=AllCompanies['filter'](function(_0x3838c5){var _0x23a653=_0x543a74;return _0x3838c5['ID']==excelRows[_0x4b0186][_0x23a653(0x25e)];}),_0x3cc935=AllDepartments[_0x543a74(0x209)](function(_0xc8fbdc){var _0x5031a9=_0x543a74;return _0xc8fbdc['ID']==excelRows[_0x4b0186][_0x5031a9(0x20f)];}),_0x650688=AllOfficeLocation[_0x543a74(0x209)](function(_0x25aacc){var _0x26bb99=_0x543a74;return _0x25aacc['ID']==excelRows[_0x4b0186][_0x26bb99(0x25f)];});_0x37fbe7['length']>0x0&&_0x3cc935[_0x543a74(0x1c3)]>0x0&&_0x650688[_0x543a74(0x1c3)]>0x0?(Ready=Ready+0x1,ErrorUser=_0x543a74(0x1d3),excelRows[_0x4b0186][_0x543a74(0x1f1)]=_0x3cc935[0x0][_0x543a74(0x1e4)],excelRows[_0x4b0186][_0x543a74(0x201)]=_0x650688[0x0][_0x543a74(0x15f)]):(ErrorUser='Required\x20Value\x20Missing',Error=Error+0x1);}else ErrorUser=_0x543a74(0x176),color_red=_0x543a74(0x20c),Error=Error+0x1;}excelRows[_0x4b0186][_0x543a74(0x251)]=_0x8015f9,excelRows[_0x4b0186]['id']=_0x4b0186,excelRows[_0x4b0186]['Status']=ErrorUser,excelRows[_0x4b0186][_0x543a74(0x221)]=_0x4d50b4;}alluserdata=excelRows,LoadShowUser(excelRows);}function CompaniesDetails(){var _0x34b37b=a21_0x413b07,_0xfd6e5c=document['getElementById'](_0x34b37b(0x272));_0xfd6e5c['innerHTML']='',opt['value']='0',opt[_0x34b37b(0x16a)]=_0x34b37b(0x1b2),_0xfd6e5c[_0x34b37b(0x243)](opt);for(var _0x4f7a8f=0x0;_0x4f7a8f<AllCompanies['length'];_0x4f7a8f++){var _0x1b59ae=AllCompanies[_0x4f7a8f][_0x34b37b(0x1cc)],_0x571412=AllCompanies[_0x4f7a8f]['ID'];opt=document[_0x34b37b(0x1c2)](_0x34b37b(0x165)),opt[_0x34b37b(0x16c)]=_0x571412,opt['text']=_0x1b59ae,_0xfd6e5c['appendChild'](opt);}$(_0x34b37b(0x253))['prop'](_0x34b37b(0x1be),![]),$('#txtmanager')[_0x34b37b(0x145)](''),$(_0x34b37b(0x143))[_0x34b37b(0x145)](''),$(_0x34b37b(0x237))['val']('');}$(a21_0x413b07(0x211))[a21_0x413b07(0x1a0)](function(){var _0x1e2ac0=a21_0x413b07,_0x521065=tabledata[_0x1e2ac0(0x14c)]();debugger;_0x521065['length']>0x0?(CompaniesDetails(),$('#UploadExcel')[_0x1e2ac0(0x232)](_0x1e2ac0(0x26e)),initializePeoplePicker(_0x1e2ac0(0x27c)),peoplePickerDiv=$(_0x1e2ac0(0x1de))):alert(_0x1e2ac0(0x172));});var GetDepartments,Getofficelocation,GetDesignation,GetGroup,CompaniesId;$(a21_0x413b07(0x248))[a21_0x413b07(0x1a0)](function(){var _0x48e5ad=a21_0x413b07;if(document[_0x48e5ad(0x157)](_0x48e5ad(0x228))[_0x48e5ad(0x1be)]==!![]||document[_0x48e5ad(0x157)](_0x48e5ad(0x27f))[_0x48e5ad(0x1be)]==!![]||document['getElementById'](_0x48e5ad(0x15e))[_0x48e5ad(0x1be)]==!![]||document[_0x48e5ad(0x157)]('chkManager')[_0x48e5ad(0x1be)]==!![]||document[_0x48e5ad(0x157)](_0x48e5ad(0x15b))['checked']==!![]||document[_0x48e5ad(0x157)](_0x48e5ad(0x16b))[_0x48e5ad(0x1be)]==!![]){var _0x2f76b1=tabledata[_0x48e5ad(0x14c)](),_0x2ecf17=SPClientPeoplePicker[_0x48e5ad(0x144)][peoplePickerDiv[0x0]['id']],_0x27a3b8=_0x2ecf17['GetAllUserInfo']();for(var _0x416305=0x0;_0x416305<_0x2f76b1['length'];_0x416305++){var _0x350f85=excelRows[_0x48e5ad(0x20a)](_0x40eaf8=>_0x40eaf8[_0x48e5ad(0x189)]==_0x2f76b1[_0x416305][_0x48e5ad(0x1af)][_0x48e5ad(0x239)]['Email\x20*']);if(excelRows[_0x350f85][_0x48e5ad(0x241)]==_0x48e5ad(0x224))excelRows[_0x350f85][_0x48e5ad(0x25e)]='-',excelRows[_0x350f85][_0x48e5ad(0x20f)]='-',excelRows[_0x350f85][_0x48e5ad(0x25f)]='-',document['getElementById'](_0x48e5ad(0x15e))[_0x48e5ad(0x1be)]&&(excelRows[_0x350f85]['Designation\x20*']=$(_0x48e5ad(0x237))['val']()),document[_0x48e5ad(0x157)](_0x48e5ad(0x1b1))['checked']&&(excelRows[_0x350f85][_0x48e5ad(0x21a)]=_0x27a3b8[0x0][_0x48e5ad(0x1f2)][_0x48e5ad(0x174)]),document[_0x48e5ad(0x157)]('chkTopExecutive')[_0x48e5ad(0x1be)]&&(excelRows[_0x350f85][_0x48e5ad(0x21a)]=_0x48e5ad(0x149)),document[_0x48e5ad(0x157)]('chkGroup')[_0x48e5ad(0x1be)]&&(excelRows[_0x350f85][_0x48e5ad(0x216)]=$(_0x48e5ad(0x143))[_0x48e5ad(0x145)]());else{if(excelRows[_0x350f85][_0x48e5ad(0x241)]==_0x48e5ad(0x1e5)||excelRows[_0x350f85][_0x48e5ad(0x241)]==_0x48e5ad(0x1d3)){document[_0x48e5ad(0x157)](_0x48e5ad(0x228))[_0x48e5ad(0x1be)]&&(excelRows[_0x350f85][_0x48e5ad(0x25e)]=CompaniesId,excelRows[_0x350f85]['Department\x20*']=GetDepartments);document[_0x48e5ad(0x157)]('chkOfficeLocation')['checked']&&(excelRows[_0x350f85][_0x48e5ad(0x25e)]=CompaniesId,excelRows[_0x350f85]['Location\x20*']=Getofficelocation);document[_0x48e5ad(0x157)](_0x48e5ad(0x15e))[_0x48e5ad(0x1be)]&&(excelRows[_0x350f85]['Designation\x20*']=$(_0x48e5ad(0x237))['val']());document['getElementById'](_0x48e5ad(0x1b1))[_0x48e5ad(0x1be)]&&(excelRows[_0x350f85][_0x48e5ad(0x21a)]=_0x27a3b8[0x0][_0x48e5ad(0x1f2)]['Email']);document[_0x48e5ad(0x157)](_0x48e5ad(0x15b))[_0x48e5ad(0x1be)]&&(excelRows[_0x350f85][_0x48e5ad(0x21a)]=_0x48e5ad(0x149));document['getElementById'](_0x48e5ad(0x16b))['checked']&&(excelRows[_0x350f85][_0x48e5ad(0x216)]=$('#txtGroup')[_0x48e5ad(0x145)]());var _0x37c0b6=AllCompanies['filter'](function(_0xc6494f){var _0x5c1ad0=_0x48e5ad;return _0xc6494f['ID']==excelRows[_0x350f85][_0x5c1ad0(0x25e)];}),_0x5b5380=AllDepartments[_0x48e5ad(0x209)](function(_0x1bce13){var _0x30b0b6=_0x48e5ad;return _0x1bce13['ID']==excelRows[_0x350f85][_0x30b0b6(0x20f)];}),_0xdac70e=AllOfficeLocation['filter'](function(_0x53ea6f){return _0x53ea6f['ID']==excelRows[_0x350f85]['Location\x20*'];});_0x37c0b6[_0x48e5ad(0x1c3)]>0x0&&_0x5b5380['length']>0x0&&_0xdac70e['length']>0x0?(Ready=Ready+0x1,Error=Error-0x1,excelRows[_0x350f85][_0x48e5ad(0x241)]=_0x48e5ad(0x1d3)):(excelRows[_0x350f85]['Status']=_0x48e5ad(0x1e5),Error=Error+0x1);}else excelRows[_0x350f85][_0x48e5ad(0x241)]==_0x48e5ad(0x17a)&&(document[_0x48e5ad(0x157)]('chkDesignation')[_0x48e5ad(0x1be)]&&(excelRows[_0x350f85]['Designation\x20*']=$(_0x48e5ad(0x237))[_0x48e5ad(0x145)]()),document[_0x48e5ad(0x157)](_0x48e5ad(0x1b1))[_0x48e5ad(0x1be)]&&(excelRows[_0x350f85][_0x48e5ad(0x21a)]=_0x27a3b8[0x0][_0x48e5ad(0x1f2)][_0x48e5ad(0x174)]),document[_0x48e5ad(0x157)]('chkTopExecutive')[_0x48e5ad(0x1be)]&&(excelRows[_0x350f85][_0x48e5ad(0x21a)]='Chief\x20Executive'),document[_0x48e5ad(0x157)](_0x48e5ad(0x16b))['checked']&&(excelRows[_0x350f85]['Group\x20Name']=$('#txtGroup')[_0x48e5ad(0x145)]()),Ready=Ready+0x1,Error=Error-0x1,excelRows[_0x350f85][_0x48e5ad(0x241)]=_0x48e5ad(0x1d3));}}tabledata[_0x48e5ad(0x1f0)](excelRows),tabledata[_0x48e5ad(0x167)](pageIndex),$(_0x48e5ad(0x17e))[_0x48e5ad(0x232)](_0x48e5ad(0x1d5)),showmessage();}else alert(_0x48e5ad(0x1ca)),$(_0x48e5ad(0x255))[_0x48e5ad(0x145)]();}),$(a21_0x413b07(0x24f))[a21_0x413b07(0x225)](function(){var _0x1cf0c0=a21_0x413b07;CompaniesId=parseInt($('option:selected',$(this))['val']());var _0x58f4a8=AllOfficeLocation[_0x1cf0c0(0x209)](function(_0x56f1a5){var _0x1ebd1d=_0x1cf0c0;return _0x56f1a5[_0x1ebd1d(0x23a)]===CompaniesId;}),_0x26e678=document[_0x1cf0c0(0x157)](_0x1cf0c0(0x1b9));_0x26e678['innerHTML']='';for(var _0x2a0612=0x0;_0x2a0612<_0x58f4a8['length'];_0x2a0612++){var _0x15f160=_0x58f4a8[_0x2a0612]['OfficeName'],_0x585107=_0x58f4a8[_0x2a0612]['ID'];opt=document[_0x1cf0c0(0x1c2)]('option'),opt[_0x1cf0c0(0x16c)]=_0x585107,opt[_0x1cf0c0(0x16a)]=_0x15f160,_0x26e678['appendChild'](opt);}Getofficelocation=parseInt($(_0x1cf0c0(0x1c5),$(_0x1cf0c0(0x1e3)))['val']());var _0x61339b=AllDepartments['filter'](function(_0x230555){var _0x173bde=_0x1cf0c0;return _0x230555[_0x173bde(0x23a)]===CompaniesId;}),_0x26e678=document[_0x1cf0c0(0x157)]('ddlDepartment');_0x26e678['innerHTML']='';for(var _0x2a0612=0x0;_0x2a0612<_0x61339b[_0x1cf0c0(0x1c3)];_0x2a0612++){var _0x15f160=_0x61339b[_0x2a0612][_0x1cf0c0(0x1e4)],_0x585107=_0x61339b[_0x2a0612]['ID'];opt=document[_0x1cf0c0(0x1c2)](_0x1cf0c0(0x165)),opt[_0x1cf0c0(0x16c)]=_0x585107,opt[_0x1cf0c0(0x16a)]=_0x15f160,_0x26e678['appendChild'](opt);}GetDepartments=parseInt($(_0x1cf0c0(0x1c5),$(_0x1cf0c0(0x188)))[_0x1cf0c0(0x145)]());}),$(a21_0x413b07(0x188))[a21_0x413b07(0x225)](function(){var _0x863d8e=a21_0x413b07;GetDepartments=parseInt($(_0x863d8e(0x1c5),$(this))[_0x863d8e(0x145)]());}),$(a21_0x413b07(0x1e3))[a21_0x413b07(0x225)](function(){var _0x327b05=a21_0x413b07;Getofficelocation=parseInt($(_0x327b05(0x1c5),$(this))[_0x327b05(0x145)]());});function chkManagerevent(_0x40b77c){var _0x17227f=a21_0x413b07;if(_0x40b77c['checked'])$(_0x17227f(0x200))[_0x17227f(0x220)](_0x17227f(0x1be),![]),$(_0x17227f(0x18f))[_0x17227f(0x257)](_0x17227f(0x18b)),$('#txtmanager')[_0x17227f(0x159)]();else{}}var TopExecutive='';function chkTopExecutiveevent(_0x20d4a2){var _0xfa0053=a21_0x413b07;if(_0x20d4a2[_0xfa0053(0x1be)])$('#chkManager')[_0xfa0053(0x220)](_0xfa0053(0x1be),![]),$(_0xfa0053(0x18f))[_0xfa0053(0x220)](_0xfa0053(0x18b),!![]),$(_0xfa0053(0x18f))['val'](''),TopExecutive='Chief\x20Executive';else{}}$(a21_0x413b07(0x19d))[a21_0x413b07(0x1a0)](function(){var _0x1a612b=a21_0x413b07;tabledata[_0x1a612b(0x266)](_0x1a612b(0x1b0),_0x1a612b(0x202),{'sheetName':'EmployeeSyncreport'});});var dvExcel=document[a21_0x413b07(0x157)]('exceltble');dvExcel[a21_0x413b07(0x22b)]='';var outputArray=[];function removewithfilter(_0x3fe350){var _0x450bc9=a21_0x413b07;let _0x4b1beb=_0x3fe350[_0x450bc9(0x209)](function(_0x1e5266,_0x389e7e,_0x1ee3ad){var _0x1484d0=_0x450bc9;return _0x389e7e==_0x1ee3ad[_0x1484d0(0x1df)](_0x1e5266);});return _0x4b1beb;}function GetItemTypeForListName(_0x1d0a41){var _0x45239e=a21_0x413b07;return _0x45239e(0x1e7)+_0x1d0a41[_0x45239e(0x25c)](0x0)[_0x45239e(0x235)]()+_0x1d0a41[_0x45239e(0x1a5)]('\x20')[_0x45239e(0x160)]('')[_0x45239e(0x156)](0x1)+_0x45239e(0x1cf);}var response=response||[];function getItems(_0x3d59e4,_0x299cd4){var _0x43df21=a21_0x413b07;return $[_0x43df21(0x1c1)]({'url':_0x3d59e4,'type':_0x43df21(0x1cd),'async':![],'headers':{'accept':'application/json;odata=verbose'},'success':function(_0x45e2a1){var _0x1c9b21=_0x43df21;response=response[_0x1c9b21(0x215)](_0x45e2a1['d'][_0x1c9b21(0x22d)]),_0x45e2a1['d'][_0x1c9b21(0x278)]?(_0x3d59e4=_0x45e2a1['d'][_0x1c9b21(0x278)],getItems(_0x3d59e4,_0x299cd4)):_0x299cd4[_0x1c9b21(0x19a)](response);},'error':function(_0x342dc0){var _0xe847c5=_0x43df21;_0x299cd4[_0xe847c5(0x271)](_0x342dc0),console[_0xe847c5(0x1e8)](_0x342dc0);}}),_0x299cd4[_0x43df21(0x197)]();}function ConvertddmmyyTommddyy(_0x5c1bc1){var _0x9c1741=a21_0x413b07;return _0x5c1bc1['split']('/')[0x1]+'/'+_0x5c1bc1[_0x9c1741(0x1a5)]('/')[0x0]+'/'+_0x5c1bc1[_0x9c1741(0x1a5)]('/')[0x2];}function InsertWelcomeInAnnouncementList(_0x3bb58a){var _0x17080b=a21_0x413b07;$['ajax']({'url':_spPageContextInfo[_0x17080b(0x23c)]+_0x17080b(0x203),'type':_0x17080b(0x163),'async':![],'data':JSON['stringify'](_0x3bb58a),'headers':{'Accept':_0x17080b(0x1dd),'Content-Type':_0x17080b(0x1dd),'X-RequestDigest':$(_0x17080b(0x1d7))[_0x17080b(0x145)](),'X-HTTP-Method':_0x17080b(0x163)},'success':function(_0x2ac1de,_0x35dd67,_0x1c4d8d){var _0x49d4ba=_0x17080b;console[_0x49d4ba(0x1e8)]('Data\x20Send\x20to\x20Announcements');},'error':function(_0x2c5c7a){var _0x103221=_0x17080b;console[_0x103221(0x1e8)](_0x2c5c7a),console[_0x103221(0x1e8)](_0x103221(0x1dc)),currentDlg[_0x103221(0x262)]();}});}