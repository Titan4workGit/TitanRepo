var a15_0x49f919=a15_0x249f;(function(_0x429202,_0x480a44){var _0x51d2fd=a15_0x249f,_0x4b9976=_0x429202();while(!![]){try{var _0x1bced7=-parseInt(_0x51d2fd(0x302))/0x1*(-parseInt(_0x51d2fd(0x2c7))/0x2)+parseInt(_0x51d2fd(0x295))/0x3+-parseInt(_0x51d2fd(0x26e))/0x4*(-parseInt(_0x51d2fd(0x298))/0x5)+-parseInt(_0x51d2fd(0x30f))/0x6*(parseInt(_0x51d2fd(0x1f4))/0x7)+-parseInt(_0x51d2fd(0x2c4))/0x8+parseInt(_0x51d2fd(0x28c))/0x9*(parseInt(_0x51d2fd(0x1fe))/0xa)+-parseInt(_0x51d2fd(0x27f))/0xb*(parseInt(_0x51d2fd(0x1de))/0xc);if(_0x1bced7===_0x480a44)break;else _0x4b9976['push'](_0x4b9976['shift']());}catch(_0x5c7e7f){_0x4b9976['push'](_0x4b9976['shift']());}}}(a15_0x2519,0x2817d));var token,ClientId='',ClentSecret='',ClientUrl='',DeferredObj=$['Deferred'](),color_red='',Error=0x0,Ready=0x0,Exits=0x0,lblUpdate=0x0,ErrorUser='',alluserdata,contributersGroupId='',counusers=0x0,excelRows,AllCompanies,AllDepartments,AllOfficeLocation,tabledata,pageIndex,UserEmailId,warningmessage='',userfullname='',AvilableLicenses,ReadySelected=[],MiisingSelected=[],AddedEmployeeList=[],IsMiisingSelect,isReadeySelect,peoplePickerDiv='',EmployeeId='',EmployeeDepartment='',EmployeeOfficeLocation='',checkedAudience='';$(document)['ready'](function(){var _0x2e58a8=a15_0x249f;GraphAccessTokenTogetUserDetails(),GetCompanies(),GetOfficeLocation(),GetDepartments(),LoadShowUser([]),GetAllUserId(),GetEmployees(),$(_0x2e58a8(0x2b0))[_0x2e58a8(0x265)](AvilableLicenses);});function initializePeoplePicker(_0x350f1c){var _0x29a48d=a15_0x249f,_0xd2b9ca={};_0xd2b9ca[_0x29a48d(0x253)]=_0x29a48d(0x213),_0xd2b9ca[_0x29a48d(0x2ef)]=0xf,_0xd2b9ca['ResolvePrincipalSource']=0xf,_0xd2b9ca[_0x29a48d(0x309)]=![],_0xd2b9ca[_0x29a48d(0x2b7)]=0x32,_0xd2b9ca[_0x29a48d(0x237)]=_0x29a48d(0x210),this[_0x29a48d(0x20b)](_0x350f1c,null,_0xd2b9ca),$('.sp-peoplepicker-editorInput')[_0x29a48d(0x20f)](0xfa);}function GetSelectItem(){var _0x1e0f94=a15_0x249f;if(contributersGroupId!==''){var _0x2a1b21=tabledata[_0x1e0f94(0x2e5)]();counusers=0x0,IsaddedNewEmployee=![];for(var _0x9a067d=0x0;_0x9a067d<_0x2a1b21['length'];_0x9a067d++){var _0x564442=alluserdata[_0x1e0f94(0x246)](function(_0x40002a){var _0x5e0ce1=_0x1e0f94;return _0x40002a[_0x5e0ce1(0x2c9)]==_0x2a1b21[_0x9a067d][_0x5e0ce1(0x29f)]['data']['Email'];});AvilableLicenses>0x0?_0x564442[0x0]['Status']==_0x1e0f94(0x275)?IsaddedNewEmployee=AddNewEmployeeAllocated(_0x564442,_0x1e0f94(0x2c3)):_0x564442[0x0][_0x1e0f94(0x22a)]==_0x1e0f94(0x278)&&UpdateExistingEmployeeAllocated(_0x564442,_0x1e0f94(0x2c3)):($(_0x1e0f94(0x226))[_0x1e0f94(0x265)](counusers),alert(_0x1e0f94(0x1ec)),_0x9a067d=_0x2a1b21[_0x1e0f94(0x315)]);}warningmessage!=''&&(warningmessage+=userfullname,alert(warningmessage)),$(_0x1e0f94(0x226))[_0x1e0f94(0x265)](counusers),showmessage(),tabledata[_0x1e0f94(0x24d)](excelRows),tabledata[_0x1e0f94(0x280)](pageIndex),IsaddedNewEmployee&&($(_0x1e0f94(0x2ed))[_0x1e0f94(0x1fb)]({'backdrop':_0x1e0f94(0x206),'keyboard':![]},_0x1e0f94(0x2fd)),AddedEmployeeList[_0x1e0f94(0x315)]>0x0?$(_0x1e0f94(0x21e))[_0x1e0f94(0x2fd)]():$(_0x1e0f94(0x21e))[_0x1e0f94(0x2bb)]());}else $(_0x1e0f94(0x30c))[_0x1e0f94(0x294)]()[_0x1e0f94(0x232)](0x7d0)[_0x1e0f94(0x244)](),GetGroupIDByGroupName(),GetSelectItem();}$(a15_0x49f919(0x28b))[a15_0x49f919(0x235)](function(){var _0x5747fc=a15_0x49f919;$[_0x5747fc(0x1e4)]({'cache':![],'beforeSend':function(){var _0x1cbc45=_0x5747fc;$(_0x1cbc45(0x1f9))[_0x1cbc45(0x294)]();},'success':function(_0x449c82){var _0x476242=_0x5747fc;AzureUsrlist=[],GetAzureUsrlist(AdusersUrl,token),excelRows=[];for(var _0x546082=0x0;_0x546082<AzureUsrlist[_0x476242(0x315)];_0x546082++){if(AzureUsrlist[_0x546082][_0x476242(0x26d)]!=null&&AzureUsrlist[_0x546082][_0x476242(0x1e8)]==!![]){if(AzureUsrlist[_0x546082][_0x476242(0x22d)]!=_0x476242(0x2fe)){var _0x5c8e5f=EmployeeListUsers[_0x476242(0x246)](function(_0x3de97f){var _0x49aea4=_0x476242;return _0x3de97f[_0x49aea4(0x2c9)]['toLowerCase']()==AzureUsrlist[_0x546082]['mail']['toLowerCase']();}),_0x16d2ee=AllCompanies[_0x476242(0x246)](function(_0x210364){var _0x3495d4=_0x476242;if(AzureUsrlist[_0x546082][_0x3495d4(0x2e2)]!=null)return _0x210364[_0x3495d4(0x1db)][_0x3495d4(0x287)]()==AzureUsrlist[_0x546082]['companyName'][_0x3495d4(0x287)]();}),_0x47e20d=0x0;_0x16d2ee[_0x476242(0x315)]>0x0?_0x47e20d=_0x16d2ee[0x0]['Id']:_0x47e20d=parseInt(Logged_CompanyId);var _0x162ab8=AllOfficeLocation[_0x476242(0x246)](function(_0x113be3){var _0x58f5e9=_0x476242;if(AzureUsrlist[_0x546082][_0x58f5e9(0x2c0)]!=null)return _0x113be3[_0x58f5e9(0x2be)][_0x58f5e9(0x287)]()==AzureUsrlist[_0x546082][_0x58f5e9(0x2c0)][_0x58f5e9(0x287)]();}),_0x1673f7=0x0;_0x162ab8[_0x476242(0x315)]>0x0&&(_0x1673f7=_0x162ab8[0x0]['Id']);var _0x1b3d6f=AllDepartments['filter'](function(_0x5614d8){var _0x480a1e=_0x476242;if(AzureUsrlist[_0x546082][_0x480a1e(0x2b8)]!=null)return _0x5614d8['Title'][_0x480a1e(0x287)]()==AzureUsrlist[_0x546082][_0x480a1e(0x2b8)][_0x480a1e(0x287)]();}),_0x4c43fe=0x0;_0x1b3d6f[_0x476242(0x315)]>0x0&&(_0x4c43fe=_0x1b3d6f[0x0]['Id']);var _0x23aa65='',_0x38d679='';AzureUsrlist[_0x546082][_0x476242(0x25f)]!=undefined&&(_0x23aa65=AzureUsrlist[_0x546082][_0x476242(0x25f)]['mail']);AzureUsrlist[_0x546082][_0x476242(0x257)]!=undefined||AzureUsrlist[_0x546082][_0x476242(0x257)]!=null?(_0x38d679=new Date(AzureUsrlist[_0x546082][_0x476242(0x257)]),_0x38d679=$[_0x476242(0x205)][_0x476242(0x267)](_0x476242(0x261),_0x38d679)):(_0x38d679=new Date(),_0x38d679=$['datepicker'][_0x476242(0x267)](_0x476242(0x261),_0x38d679));if(_0x5c8e5f[_0x476242(0x315)]==0x0){var _0x2a24b5=AzureUsrlist[_0x546082][_0x476242(0x1e9)]==_0x476242(0x288)?'External':_0x476242(0x20c);excelRows[_0x476242(0x311)]({'Id':_0x546082,'Name':AzureUsrlist[_0x546082][_0x476242(0x271)],'Email':AzureUsrlist[_0x546082][_0x476242(0x26d)],'Type':_0x2a24b5,'Department':_0x4c43fe,'Company':_0x47e20d,'DepartmentName':AzureUsrlist[_0x546082][_0x476242(0x2b8)],'CompanyName':AzureUsrlist[_0x546082]['companyName'],'country':AzureUsrlist[_0x546082]['country'],'DateOfJoining':_0x38d679,'employeeId':AzureUsrlist[_0x546082][_0x476242(0x222)],'Manager':_0x23aa65,'postalCode':AzureUsrlist[_0x546082]['postalCode'],'state':AzureUsrlist[_0x546082][_0x476242(0x28e)],'streetAddress':AzureUsrlist[_0x546082][_0x476242(0x2ff)],'city':AzureUsrlist[_0x546082][_0x476242(0x2da)],'mobilePhone':AzureUsrlist[_0x546082]['mobilePhone'],'Location':_0x1673f7,'LocationName':AzureUsrlist[_0x546082][_0x476242(0x2c0)],'otherMails':AzureUsrlist[_0x546082][_0x476242(0x2b9)][0x0],'Designation':AzureUsrlist[_0x546082][_0x476242(0x2aa)]});}}}}Ready=0x0,Error=0x0,lblUpdate=0x0,counusers=0x0,Exits=0x0,$(_0x476242(0x2dd))[_0x476242(0x265)](0x0),$(_0x476242(0x304))[_0x476242(0x265)](0x0),$('#added')[_0x476242(0x265)](0x0),$(_0x476242(0x292))['text'](0x0),$(_0x476242(0x1e6))[_0x476242(0x265)](0x0);for(var _0x546082=0x0;_0x546082<excelRows[_0x476242(0x315)];_0x546082++){var _0x37d7a7='',_0x1c9dea=AzureUsrlist['filter'](function(_0x507f8b){var _0x4ae41d=_0x476242;if(_0x507f8b['mail']!=null){var _0x412083=_0x507f8b[_0x4ae41d(0x26d)][_0x4ae41d(0x287)]();return _0x412083==excelRows[_0x546082][_0x4ae41d(0x2c9)][_0x4ae41d(0x287)]();}});if(_0x1c9dea['length']>0x0){_0x37d7a7=_0x1c9dea[0x0][_0x476242(0x271)];var _0x116274=AllCompanies[_0x476242(0x246)](function(_0x4c4525){var _0x32b717=_0x476242;return _0x4c4525['ID']==excelRows[_0x546082][_0x32b717(0x1f7)];}),_0x4c8699=AllDepartments[_0x476242(0x246)](function(_0x30603c){return _0x30603c['ID']==excelRows[_0x546082]['Department'];}),_0x2a6545=AllOfficeLocation[_0x476242(0x246)](function(_0x117dfa){var _0x3071f0=_0x476242;return _0x117dfa['ID']==excelRows[_0x546082][_0x3071f0(0x21a)];});_0x116274['length']>0x0&&_0x4c8699[_0x476242(0x315)]>0x0&&_0x2a6545['length']>0x0?(Ready=Ready+0x1,ErrorUser=_0x476242(0x275)):(ErrorUser=_0x476242(0x21d),Error=Error+0x1);}else ErrorUser=_0x476242(0x24e),color_red=_0x476242(0x2b5),Error=Error+0x1;excelRows[_0x546082][_0x476242(0x22a)]=ErrorUser;}alluserdata=excelRows,LoadShowUser(excelRows),$(_0x476242(0x1f9))['fadeOut']();}});});var Temparray=[];$('#btnFilter')[a15_0x49f919(0x235)](function(){var _0x24bf15=a15_0x49f919;debugger;Temparray=alluserdata;let _0x236620=[...new Set(Temparray[_0x24bf15(0x299)](_0x168f92=>_0x168f92[_0x24bf15(0x209)]))];var _0x64218f=document['getElementById'](_0x24bf15(0x208));_0x64218f['innerHTML']='',opt[_0x24bf15(0x217)]='0',opt[_0x24bf15(0x265)]=_0x24bf15(0x1df),_0x64218f['appendChild'](opt);for(var _0x337262=0x0;_0x337262<_0x236620['length'];_0x337262++){opt=document[_0x24bf15(0x308)](_0x24bf15(0x2c1)),opt['value']=_0x236620[_0x337262],opt['text']=_0x236620[_0x337262],_0x64218f[_0x24bf15(0x220)](opt);}Temparray=alluserdata;var _0x47e6cf=[...new Set(Temparray['map'](_0x45f5b7=>_0x45f5b7[_0x24bf15(0x1ed)]))],_0x64218f=document[_0x24bf15(0x218)](_0x24bf15(0x1f5)),_0x415660=_0x24bf15(0x2dc);for(var _0x337262=0x0;_0x337262<_0x47e6cf[_0x24bf15(0x315)];_0x337262++){_0x415660+=_0x24bf15(0x2a9)+_0x47e6cf[_0x337262]+'\x22>'+_0x47e6cf[_0x337262]+'</option>';}$(_0x24bf15(0x238))[_0x24bf15(0x2ee)](_0x415660),Temparray=alluserdata;let _0x58f9e9=[...new Set(Temparray['map'](_0x50a0ff=>_0x50a0ff[_0x24bf15(0x207)]))];var _0x64218f=document[_0x24bf15(0x218)](_0x24bf15(0x2a2));_0x64218f[_0x24bf15(0x2de)]='',opt[_0x24bf15(0x217)]='0',opt[_0x24bf15(0x265)]=_0x24bf15(0x2a0),_0x64218f['appendChild'](opt);for(var _0x337262=0x0;_0x337262<_0x58f9e9[_0x24bf15(0x315)];_0x337262++){opt=document[_0x24bf15(0x308)](_0x24bf15(0x2c1)),opt['value']=_0x58f9e9[_0x337262],opt['text']=_0x58f9e9[_0x337262],_0x64218f[_0x24bf15(0x220)](opt);}}),$('#btnfiltervalue')['click'](function(){var _0x3fd683=a15_0x49f919;let _0x9a0ba5;var _0x4b51aa='',_0x124ac5=!![];$(_0x3fd683(0x215))[_0x3fd683(0x204)]()!='0'&&(_0x124ac5=![]);if($(_0x3fd683(0x310))[_0x3fd683(0x204)]()!='0')_0x124ac5=![];else return alert('Please\x20select\x20Department'),![];if($(_0x3fd683(0x238))[_0x3fd683(0x204)]()!='0')_0x124ac5=![];else return alert(_0x3fd683(0x2c6)),![];_0x9a0ba5=alluserdata['filter'](function(_0x242f17){var _0x5c348d=_0x3fd683;return _0x242f17[_0x5c348d(0x21a)]==$(_0x5c348d(0x231),$(_0x5c348d(0x238)))[_0x5c348d(0x204)]()&&_0x242f17[_0x5c348d(0x207)]==$(_0x5c348d(0x231),$('#ddlfilterDepartments'))[_0x5c348d(0x204)]()&&_0x242f17['Company']==$(_0x5c348d(0x231),$(_0x5c348d(0x215)))[_0x5c348d(0x204)]();});var _0x51dac3=alluserdata[_0x3fd683(0x221)](_0x5a3f8a=>_0x5a3f8a['Location']===$('option:selected',$('#ddlfilterOfficeLocation'))[_0x3fd683(0x204)]()&&_0x5a3f8a['Department']==$('option:selected',$(_0x3fd683(0x310)))[_0x3fd683(0x204)]()&&_0x5a3f8a['Company']==$(_0x3fd683(0x231),$(_0x3fd683(0x215)))[_0x3fd683(0x204)]());_0x124ac5?LoadShowUser(alluserdata):LoadShowUser(_0x9a0ba5);}),$(a15_0x49f919(0x2a4))[a15_0x49f919(0x1f1)](function(_0x2de32c){var _0x834a1d=a15_0x49f919;LoadShowUser(search($(_0x834a1d(0x2a4))[_0x834a1d(0x204)]()));});function search(_0x423ecb){var _0x4bd7f9=a15_0x49f919;return alluserdata[_0x4bd7f9(0x246)](({Name:_0x4ec669,Email:_0xfe0b92})=>{var _0x247381=_0x4bd7f9;return _0x4ec669['toLowerCase']()[_0x247381(0x26b)](_0x423ecb[_0x247381(0x287)]())>-0x1||_0xfe0b92[_0x247381(0x287)]()[_0x247381(0x26b)](_0x423ecb[_0x247381(0x287)]())>-0x1;});}$(a15_0x49f919(0x223))[a15_0x49f919(0x235)](function(){var _0x3f8c58=a15_0x49f919;$[_0x3f8c58(0x1e4)]({'cache':![],'beforeSend':function(){var _0x4f640a=_0x3f8c58;$('#overlaysearch')[_0x4f640a(0x294)]();},'success':function(_0x24ef89){var _0x4f788f=_0x3f8c58;AddedEmployeeList=[],SubmitReady(),$(_0x4f788f(0x1f9))[_0x4f788f(0x244)]();}});});function SubmitReady(){var _0x482ebd=a15_0x49f919;if(contributersGroupId!==''){var _0x3a595e=tabledata[_0x482ebd(0x2e5)]();counusers=0x0,IsaddedNewEmployee=![];for(var _0x30d2e7=0x0;_0x30d2e7<_0x3a595e[_0x482ebd(0x315)];_0x30d2e7++){var _0x2ce803=alluserdata[_0x482ebd(0x246)](function(_0x107f56){var _0x3c2e6b=_0x482ebd;return _0x107f56[_0x3c2e6b(0x2c9)]==_0x3a595e[_0x30d2e7][_0x3c2e6b(0x29f)][_0x3c2e6b(0x2e0)][_0x3c2e6b(0x2c9)];});if(AvilableLicenses>0x0)_0x2ce803[0x0][_0x482ebd(0x22a)]==_0x482ebd(0x275)?IsaddedNewEmployee=AddNewEmployeeAllocated(_0x2ce803,_0x482ebd(0x2c3)):_0x2ce803[0x0]['Status']==_0x482ebd(0x278)&&UpdateExistingEmployeeAllocated(_0x2ce803,'Employees');else return alert(_0x482ebd(0x1ec)),![];}warningmessage!=''&&(warningmessage+=userfullname,alert(warningmessage)),$(_0x482ebd(0x226))['text'](counusers),showmessage(),tabledata['setData'](excelRows),tabledata[_0x482ebd(0x280)](pageIndex),IsaddedNewEmployee&&($('#successfully_notifications')[_0x482ebd(0x1fb)]({'backdrop':_0x482ebd(0x206),'keyboard':![]},_0x482ebd(0x2fd)),AddedEmployeeList[_0x482ebd(0x315)]>0x0?$('#divAudience')[_0x482ebd(0x2fd)]():$(_0x482ebd(0x21e))[_0x482ebd(0x2bb)]());}else GetGroupIDByGroupName(),GetSelectItem();}$(a15_0x49f919(0x225))['on'](a15_0x49f919(0x235),function(){$['ajax']({'cache':![],'beforeSend':function(){var _0x5803b3=a15_0x249f;$(_0x5803b3(0x1f9))[_0x5803b3(0x294)]();},'success':function(_0x2441e3){var _0x4cf348=a15_0x249f;if(AddedEmployeeList[_0x4cf348(0x315)]>0x0&&checkedAudience!=_0x4cf348(0x2bc))for(var _0x5cbebb=0x0;_0x5cbebb<AddedEmployeeList[_0x4cf348(0x315)];_0x5cbebb++){var _0x3e1308=new Date(AddedEmployeeList[_0x5cbebb][_0x4cf348(0x1ea)][_0x4cf348(0x25d)]),_0x1a91f3=new Date();_0x1a91f3[_0x4cf348(0x26a)](_0x3e1308[_0x4cf348(0x2f5)]()+0x3),_0x3e1308=$['datepicker'][_0x4cf348(0x267)]('mm/dd/yy',_0x3e1308),_0x1a91f3=$[_0x4cf348(0x205)]['formatDate'](_0x4cf348(0x261),_0x1a91f3);var _0x292ca8=new Date(AddedEmployeeList[_0x5cbebb]['Metadata'][_0x4cf348(0x25d)]);_0x292ca8=$['datepicker'][_0x4cf348(0x267)](_0x4cf348(0x2a5),_0x292ca8);var _0x5dd151=[],_0x1eb5a0=[],_0xa6858f=[];_0xa6858f[_0x4cf348(0x311)](Logged_CompanyId);var _0x400bf6;_0x400bf6={'__metadata':{'type':_0x4cf348(0x2d0)}},(_0x400bf6[_0x4cf348(0x266)]=_0x4cf348(0x273),_0x400bf6[_0x4cf348(0x259)]=AddedEmployeeList[_0x5cbebb][_0x4cf348(0x2f2)][_0x4cf348(0x2b3)](),_0x400bf6['Title']=_0x4cf348(0x285),_0x400bf6['EmployeeName']=AddedEmployeeList[_0x5cbebb][_0x4cf348(0x1ea)][_0x4cf348(0x2ca)],_0x400bf6[_0x4cf348(0x2ce)]=AddedEmployeeList[_0x5cbebb]['Metadata']['Designation'],_0x400bf6['Department']=AddedEmployeeList[_0x5cbebb][_0x4cf348(0x2a7)],_0x400bf6[_0x4cf348(0x2a3)]=AddedEmployeeList[_0x5cbebb][_0x4cf348(0x306)],_0x400bf6[_0x4cf348(0x2af)]=_0x4cf348(0x1ee),_0x400bf6[_0x4cf348(0x263)]='Welcome',_0x400bf6['Audience']=checkedAudience,_0x400bf6[_0x4cf348(0x1eb)]='Approved',_0x400bf6[_0x4cf348(0x216)]=_0x3e1308,_0x400bf6[_0x4cf348(0x303)]=_0x1a91f3,_0x400bf6[_0x4cf348(0x23b)]=_0x4cf348(0x203)+_0x292ca8);if(checkedAudience=='Corporate')_0xa6858f=[0x0],_0x5dd151=[0x0],_0x1eb5a0=[0x0],_0x400bf6[_0x4cf348(0x281)]={'results':_0xa6858f},_0x400bf6[_0x4cf348(0x28a)]={'results':_0x1eb5a0},_0x400bf6[_0x4cf348(0x2e4)]={'results':_0x5dd151};else{if(checkedAudience==_0x4cf348(0x1f7))_0xa6858f[_0x4cf348(0x311)](AddedEmployeeList[_0x5cbebb][_0x4cf348(0x1ea)]['CompanyId']),_0x5dd151=[0x0],_0x1eb5a0=[0x0],_0x400bf6[_0x4cf348(0x281)]={'results':_0xa6858f},_0x400bf6['DepartmentsId']={'results':_0x1eb5a0},_0x400bf6[_0x4cf348(0x2e4)]={'results':_0x5dd151};else{if(checkedAudience==_0x4cf348(0x207))_0xa6858f=[0x0],_0x5dd151=[0x0],_0x1eb5a0['push'](AddedEmployeeList[_0x5cbebb][_0x4cf348(0x1ea)]['DepartmentId']),_0x400bf6[_0x4cf348(0x281)]={'results':_0xa6858f},_0x400bf6[_0x4cf348(0x28a)]={'results':_0x1eb5a0},_0x400bf6[_0x4cf348(0x2e4)]={'results':_0x5dd151};else checkedAudience==_0x4cf348(0x21a)&&(_0xa6858f=[0x0],_0x5dd151[_0x4cf348(0x311)](AddedEmployeeList[_0x5cbebb][_0x4cf348(0x1ea)]['OfficeLocationId']),_0x1eb5a0=[0x0],_0x400bf6[_0x4cf348(0x281)]={'results':_0xa6858f},_0x400bf6['DepartmentsId']={'results':_0x1eb5a0},_0x400bf6[_0x4cf348(0x2e4)]={'results':_0x5dd151});}}InsertWelcomeInAnnouncementList(_0x400bf6);}$(_0x4cf348(0x1f9))[_0x4cf348(0x244)]();}});}),$(a15_0x49f919(0x2fc))[a15_0x49f919(0x30e)](function(){var _0x367529=a15_0x49f919;checkedAudience=this[_0x367529(0x217)];});function isReadeySelecteds(){var _0x10a221=a15_0x49f919;isReadeySelect=document['getElementById'](_0x10a221(0x1f6));if(isReadeySelect[_0x10a221(0x2cf)]){tabledata[_0x10a221(0x230)](MiisingSelected),$(_0x10a221(0x229))[_0x10a221(0x2e6)](_0x10a221(0x2cf),![]),$('#IsMiisingSelected')[_0x10a221(0x2e6)](_0x10a221(0x2cf),![]),ReadySelected=[];for(var _0x481b31=0x0;_0x481b31<excelRows['length'];_0x481b31++){(excelRows[_0x481b31][_0x10a221(0x22a)]==_0x10a221(0x275)||excelRows[_0x481b31][_0x10a221(0x22a)]==_0x10a221(0x278))&&ReadySelected[_0x10a221(0x311)](_0x481b31);}$(_0x10a221(0x2ab))['prop'](_0x10a221(0x2cf),!![]),tabledata['selectRow'](ReadySelected);}else tabledata[_0x10a221(0x230)](ReadySelected),$(_0x10a221(0x2ab))[_0x10a221(0x2e6)](_0x10a221(0x2cf),![]);}function IsMiisingSelecteds(){var _0x11d9ae=a15_0x49f919;IsMiisingSelect=document['getElementById']('IsMiisingSelected');if(IsMiisingSelect[_0x11d9ae(0x2cf)]){tabledata[_0x11d9ae(0x230)](ReadySelected),$('#isReadeySelected')[_0x11d9ae(0x2e6)]('checked',![]),$(_0x11d9ae(0x2ab))[_0x11d9ae(0x2e6)](_0x11d9ae(0x2cf),![]),MiisingSelected=[];for(var _0x596ef9=0x0;_0x596ef9<excelRows[_0x11d9ae(0x315)];_0x596ef9++){(excelRows[_0x596ef9]['Status']==_0x11d9ae(0x21d)||excelRows[_0x596ef9][_0x11d9ae(0x22a)]==_0x11d9ae(0x278)||excelRows[_0x596ef9][_0x11d9ae(0x22a)]=='Ready')&&(MiisingSelected[_0x11d9ae(0x311)](_0x596ef9),$(_0x11d9ae(0x229))[_0x11d9ae(0x2e6)](_0x11d9ae(0x2cf),!![]));}tabledata[_0x11d9ae(0x202)](MiisingSelected);}else tabledata[_0x11d9ae(0x230)](MiisingSelected),$('.select-row_IsMiisingSelected')['prop'](_0x11d9ae(0x2cf),![]);}function AssignPermissiononDMSLibary(_0x173a38,_0x356228,_0x53b9c8){var _0x434025=a15_0x49f919,_0xebd8d3={'Accept':'application/json;odata=verbose','content-Type':_0x434025(0x293),'X-RequestDigest':jQuery(_0x434025(0x2d5))['val']()},_0x520351=_0x53b9c8+_0x434025(0x2d6)+_0x173a38+',roleDefId='+_0x356228+')';$[_0x434025(0x1e4)]({'url':_0x520351,'type':_0x434025(0x30d),'headers':_0xebd8d3,'dataType':_0x434025(0x2bf),'async':![],'success':function(_0xc938e2){var _0x2d3d02=_0x434025;console['log'](_0x2d3d02(0x282));},'error':function(_0x1169a1){var _0x32fb1d=_0x434025;console[_0x32fb1d(0x2a6)](JSON[_0x32fb1d(0x26f)](_0x1169a1)),Permissionloder[_0x32fb1d(0x24b)]();}});}function GetGroupIDByGroupName(){var _0xef7bf2=a15_0x49f919,_0x57563d=_spPageContextInfo[_0xef7bf2(0x1f8)]+_0xef7bf2(0x314);$[_0xef7bf2(0x1e4)]({'url':_0x57563d,'method':_0xef7bf2(0x1fd),'async':![],'headers':{'Accept':_0xef7bf2(0x228)},'success':function(_0x25ed89){contributersGroupId=_0x25ed89['d']['Id'];},'error':function(_0x41499c){var _0x1aff91=_0xef7bf2;console[_0x1aff91(0x2a6)](_0x41499c);}});}function GetListItems(_0x2b9661,_0x527a00){var _0xa7f325=a15_0x49f919,_0x32027d,_0x1ab448=_spPageContextInfo[_0xa7f325(0x1f8)]+_0xa7f325(0x22c)+_0x2b9661+'\x27)/items?$select=ID&$filter=ID\x20eq\x20'+_0x527a00+_0xa7f325(0x291);return $[_0xa7f325(0x1e4)]({'url':_0x1ab448,'method':_0xa7f325(0x1fd),'async':![],'headers':{'Accept':'application/json;\x20odata=verbose'},'success':function(_0x1e1780){var _0x384712=_0xa7f325;_0x1e1780['d'][_0x384712(0x270)][_0x384712(0x315)]>0x0?_0x32027d=![]:_0x32027d=!![];},'error':function(_0x2b1673){var _0x1ed488=_0xa7f325;console[_0x1ed488(0x2a6)](_0x2b1673);}}),_0x32027d;}function GetCompanies(){var _0x3c3aa6=a15_0x49f919,_0x1c07e4=_spPageContextInfo[_0x3c3aa6(0x1f8)]+_0x3c3aa6(0x27b);$[_0x3c3aa6(0x1e4)]({'url':_0x1c07e4,'method':_0x3c3aa6(0x1fd),'async':![],'headers':{'Accept':_0x3c3aa6(0x228)},'success':function(_0x408ff3){AllCompanies=_0x408ff3['d']['results'];},'error':function(_0x3a7335){console['log'](_0x3a7335);}});}function GetDepartments(){var _0x2eacea=a15_0x49f919,_0x1a229b=_spPageContextInfo[_0x2eacea(0x1f8)]+'/_api/web/lists/getByTitle(\x27Departments\x27)/items?$select=*';$[_0x2eacea(0x1e4)]({'url':_0x1a229b,'method':_0x2eacea(0x1fd),'async':![],'headers':{'Accept':'application/json;\x20odata=verbose'},'success':function(_0xaa2198){var _0x3a6d24=_0x2eacea;AllDepartments=_0xaa2198['d'][_0x3a6d24(0x270)];},'error':function(_0x5cf62b){console['log'](_0x5cf62b);}});}function GetOfficeLocation(){var _0x10d495=a15_0x49f919,_0x13a562=_spPageContextInfo[_0x10d495(0x1f8)]+_0x10d495(0x29a);$[_0x10d495(0x1e4)]({'url':_0x13a562,'method':'GET','async':![],'headers':{'Accept':_0x10d495(0x228)},'success':function(_0x463a5a){AllOfficeLocation=_0x463a5a['d']['results'];},'error':function(_0x3c639){var _0xd4efb=_0x10d495;console[_0xd4efb(0x2a6)](_0x3c639);}});}function GetSubSiteUrl(_0x16ace0,_0xc4aeee){var _0x404499=a15_0x49f919,_0x548134,_0x3582bb=_spPageContextInfo[_0x404499(0x1f8)]+_0x404499(0x22c)+_0x16ace0+'\x27)/items?$select=ID,SiteURL&$filter=ID\x20eq\x20'+_0xc4aeee+_0x404499(0x291);return $['ajax']({'url':_0x3582bb,'method':_0x404499(0x1fd),'async':![],'headers':{'Accept':'application/json;\x20odata=verbose'},'success':function(_0x567c66){var _0x21363a=_0x404499;_0x548134=_0x567c66['d'][_0x21363a(0x270)][0x0][_0x21363a(0x1e5)];},'error':function(_0x10dff6){var _0x41becd=_0x404499;console[_0x41becd(0x2a6)](_0x10dff6);}}),_0x548134;}function AddUserinSharePointGroup(_0x5300f0){var _0x2899db=a15_0x49f919,_0x5a5e14=$['Deferred'](),_0x3b8f5e=_0x2899db(0x27c),_0x4831e0=_0x3b8f5e+_0x5300f0,_0x3e6408=_spPageContextInfo[_0x2899db(0x1f8)]+'/_api/web/sitegroups('+contributersGroupId+_0x2899db(0x2f8);$[_0x2899db(0x1e4)]({'url':_0x3e6408,'type':_0x2899db(0x30d),'async':![],'data':JSON['stringify']({'__metadata':{'type':'SP.User'},'LoginName':_0x4831e0}),'headers':{'accept':_0x2899db(0x293),'content-type':_0x2899db(0x293),'X-RequestDigest':$(_0x2899db(0x2d5))[_0x2899db(0x204)]()},'success':_0x124e91,'error':_0x916084});function _0x124e91(_0x2de47a){var _0x17d8f0=_0x2899db;_0x5a5e14[_0x17d8f0(0x1e0)](_0x2de47a['d']['Id']),console[_0x17d8f0(0x2a6)](_0x17d8f0(0x1e3));}function _0x916084(_0x4edb66){var _0xc49507=_0x2899db;console[_0xc49507(0x2a6)](JSON[_0xc49507(0x26f)](_0x4edb66));}return _0x5a5e14['promise']();}function GetUserId(_0x40545d){var _0x566b46=a15_0x49f919,_0x1815bd='',_0x1fc17e=_0x566b46(0x27c),_0x18bc78=_spPageContextInfo['siteAbsoluteUrl'],_0x33adf4=_0x1fc17e+_0x40545d;return $[_0x566b46(0x1e4)]({'url':_0x18bc78+'/_api/web/siteusers(@v)?@v=\x27'+encodeURIComponent(_0x33adf4)+'\x27','method':_0x566b46(0x1fd),'headers':{'Accept':'application/json;\x20odata=verbose'},'async':![],'success':function(_0x5d4233){_0x1815bd=_0x5d4233['d']['Id'];},'error':function(_0x54191c){var _0x1db318=_0x566b46;console[_0x1db318(0x2a6)](JSON[_0x1db318(0x26f)](_0x54191c));}}),_0x1815bd;}var GetAllGroupsUser=[],GroupUrl=_spPageContextInfo['siteAbsoluteUrl']+a15_0x49f919(0x2f3);function a15_0x2519(){var _0x5444ab=['<input\x20type=\x22checkbox\x22\x20class=\x22\x22\x20disabled\x20/>','mobilePhone',')/users','#txtGroup','chkGroup','EnvironmentalSettings','input[type=radio][name=datasend]','show','PendingAcceptance','streetAddress','Not\x20SP\x20Permission','readonly','142461yikPrh','Expires','#Error','#ddlOfficeLocation','EmployeeOfficeLocation','target','createElement','AllowMultipleValues','#dvExcel','#upload','#overlayq','POST','change','100218ESXBSu','#ddlfilterDepartments','push','https://graph.microsoft.com/v1.0/users?$filter=mail\x20eq\x20\x27','chkOfficeLocation','/_api/web/sitegroups/getbyname(\x27Contributors\x27)?$select=id','length','row','CompanyName','findIndex','Worng\x20Manager','2923860MqdJOV','Select\x20Company','resolve','#txtmanager','append','User\x20Added','ajax','SiteURL','#Exits','#chkManager','accountEnabled','userType','Metadata','ApprovalStatus','Your\x20License\x20limit\x20has\x20been\x20ended','Location\x20*','Internal\x20Users','The\x20following\x20users\x20failed\x20to\x20sync\x20due\x20to\x20wrong\x20manager\x20defined!.\x0a','result','keyup','Group\x20Name','#btnDownLoadReport','91KANTuA','ddlfilterOfficeLocation','isReadeySelected','Company','webAbsoluteUrl','#overlaysearch','#UploadedItems','modal','chkManager','GET','10OiiIuy','undefined','/_api/web/lists/getbytitle(\x27','/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=999&$select=ID,AttachmentFiles,FullName,Designation,Manager,MobileNumber,ExtensionName,Email,LogonName/UserName,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department,AttachmentFiles\x20&$filter=\x20PrimaryCompany\x20eq\x20\x27Primary\x27\x20and\x20Status\x20eq\x20\x27Active\x27\x20','selectRow','DOJ:\x20','val','datepicker','static','Department','ddlfilterAllCompanies','Company\x20*','reject','SPClientPeoplePicker_InitStandaloneControlWrapper','Internal\x20','__next','Deferred','width','251px','OfficeName','CompanyIDId','User,DL,SecGroup,SPGroup','#ddlAllCompanies','#ddlfilterAllCompanies','Publish_Date','value','getElementById','#example-table','Location','Department\x20Id\x20is\x20not\x20Correct','Total\x20Row\x20Count:\x20','Required\x20Value\x20Missing','#divAudience','#ddlDepartment','appendChild','find','employeeId','#btnsubmitready','utils','#btnAudience','#added','[id$=\x27AssaginTomanager_TopSpan\x27]','application/json;\x20odata=verbose','.select-row_IsMiisingSelected','Status','fitColumns','/_api/web/lists/getByTitle(\x27','externalUserState','EmpUserId','Manager\x20*','deselectRow','option:selected','delay','download','xlsx','click','setHours','Width','#ddlfilterOfficeLocation','LogonNameId','</h3>\x20<p\x20class\x20=\x20\x22m-0\x22\x20>\x20Uploaded\x20</p>','Description','Date\x20Of\x20Birth','concat','responseText','/_api/web/lists/GetByTitle(\x27','when','ddlDepartment','sheet_to_row_object_array','Wrong\x20Manager','fadeOut','15%','filter','IsMiisingSelected','application/json;odata=nometadata','<h3\x20class=\x27m-0\x27>','focus','close','\x20,\x20','setData','Invalid\x20Profile','#txtDesignation','AssaginTomanager','Email\x20*','Active','PrincipalAccountType','slice','getValue','error1','employeeHireDate','</span>','EmployeeID','Manager','ChangeFileName','chkDepartment','JoiningDate','Added','manager','select','mm/dd/yy','getElement','WebPartName','after','text','Announcement_Type','formatDate','Department\x20*','\x20<span\x20style=\x27color:blue;\x20font-weight:bold;\x27>','setMonth','indexOf','local','mail','37004HEfxzs','stringify','results','displayName','This\x20browser\x20does\x20not\x20support\x20HTML5.','Welcome','message','Ready','postalCode','/_api/SP.OAuth.Token/Acquire','Already\x20Exist','<input\x20type=\x22checkbox\x22\x20id=\x22isReadeySelected\x22\x20onclick=\x22isReadeySelecteds()\x22\x20/>','read','/_api/web/lists/getByTitle(\x27Companies\x27)/items?$select=*','i:0#.f|membership|','DepartmentName','<input\x20type=\x22checkbox\x22\x20id=\x22IsMiisingSelected\x22\x20onclick=\x22IsMiisingSelecteds()\x22\x20/>','11ZvKmbV','setPage','CompanyId','User\x20has\x20been\x20assigned\x20permission\x20.','binary','readAsBinaryString','New\x20Joinee','charAt','toLowerCase','Guest','removeProp','DepartmentsId','#btnadsync','1176957Nvhlxz','LocationName','state','EntityData','_cell','&$top=1','#lblUpdate','application/json;odata=verbose','fadeIn','679995HJHpHv','Name','deselect','105eLJqaE','map','/_api/web/lists/getByTitle(\x27OfficeLocation\x27)/items?$select=*','chkDesignation','getQueryStringParameter','/_api/web/lists/GetByTitle(\x27Announcements\x27)/items','\x20<span\x20style=\x27color:green;\x20font-weight:bold;\x27>','_row','All','Office\x20Location\x20Id\x20is\x20not\x20Correct','ddlfilterDepartments','OfficeLocation','.searching','dd\x20M\x20yy','log','EmployeeDepartment','select#dropDownId\x20option:selected','<option\x20value=\x22','jobTitle','.select-row_isReadeySelected','#Rowcount','onload','Departments','UserType','#AvilableLicenses','getRow','1073741826','toString','https://graph.microsoft.com/v1.0/users?$top=999&$select=mail,displayName,userPrincipalName,department,officeLocation,companyName,otherMails,userType,identities,creationType,externalUserState,externalUserState,country,employeeId,jobTitle,postalCode,state,streetAddress,city,mobilePhone,accountEnabled,employeeHireDate\x20&$expand=manager($levels=max;$select=id,displayName,mail)','color-red','Updated','MaximumEntitySuggestions','department','otherMails','Chief\x20Executive','hide','NotSave','test','Title','json','officeLocation','option','\x20<span\x20style=\x27color:red;\x20font-weight:bold;\x27>','Employees','553240hdZaly','empty','Please\x20select\x20Location','2HgOGrV','remove','Email','FullName','<input\x20type=\x22checkbox\x22\x20class=\x22select-row_isReadeySelected\x22\x20aria-label=\x22select\x20this\x20row\x22\x20/>','#btnUploadExcel','promise','Designation','checked','SP.Data.AnnouncementsListItem','Bearer\x20','#chkTopExecutive','<span\x20class=\x27breakpoint\x27></span>','Primary','#__REQUESTDIGEST','/_api/web/lists/getByTitle(\x27DepartmentalDMS\x27)/roleassignments/addroleassignment(principalid=','https://graph.microsoft.com','\x27)/GetItemById(\x27','readAsArrayBuffer','city','Date\x20Of\x20Joining','<option\x20value=\x220\x22><strong>All</strong></option>','#Ready','innerHTML','Type','data','toUpperCase','companyName','@odata.nextLink','OfficeLocationsId','getSelectedRows','prop','center','Sheets','.breakpoint','#UploadExcel','done','chkTopExecutive','#successfully_notifications','html','SearchPrincipalSource','files','10%','EmployeeId','/_api/web/siteusers?$top=1000&$select=*,Id','.tabulator-page-size','getMonth'];a15_0x2519=function(){return _0x5444ab;};return a15_0x2519();}function GetAllUserId(){var _0x17e110=a15_0x49f919;$[_0x17e110(0x1e4)]({'url':GroupUrl,'method':_0x17e110(0x1fd),'headers':{'Accept':_0x17e110(0x228)},'async':![],'success':function(_0x1f873e){var _0xf26ab=_0x17e110;GetAllGroupsUser=GetAllGroupsUser[_0xf26ab(0x23d)](_0x1f873e['d']['results']),_0x1f873e['d']['__next']!=null&&(GroupUrl=_0x1f873e['d'][_0xf26ab(0x20d)],GetAllUserId());},'error':function(_0x3d03aa){var _0x3d2384=_0x17e110;console['log'](JSON[_0x3d2384(0x26f)](_0x3d03aa));}});}var LoginName;function UpdateExistingEmployeeAllocated(_0x4a16b5,_0x2f353b){var _0x37706b=a15_0x49f919;try{UserEmailId=_0x4a16b5[0x0][_0x37706b(0x2c9)],LoginName=_0x37706b(0x27c)+_0x4a16b5[0x0][_0x37706b(0x2c9)];var _0x2aac75,_0x18840a,_0x2c758c=GetAllGroupsUser[_0x37706b(0x246)](function(_0x55063c){var _0x57970f=_0x37706b;return _0x55063c[_0x57970f(0x2c9)][_0x57970f(0x287)]()==_0x4a16b5[0x0]['Email']['toLowerCase']();});if(_0x2c758c[_0x37706b(0x315)]>0x0)var _0x502d36=_0x2c758c[0x0]['Id'];else{}if(TopExecutive==_0x37706b(0x2ba)||_0x4a16b5[0x0]['Manager']==undefined)_0x4a16b5[0x0][_0x37706b(0x22f)]=_0x37706b(0x2ba),_0x2aac75=-0x1;else{var _0x523258=EmployeeListUsers[_0x37706b(0x246)](function(_0x2c6220){var _0x2fceba=_0x37706b,_0x259e82;if(_0x2c6220[_0x2fceba(0x25a)]!=null)return _0x259e82=_0x2c6220['Email'][_0x2fceba(0x287)](),_0x259e82==_0x4a16b5[0x0][_0x2fceba(0x25a)][_0x2fceba(0x287)]();});if(_0x523258['length']>0x0){_0x18840a=_0x523258[0x0]['FullName'];var _0x2c758c=GetAllGroupsUser['filter'](function(_0x25c717){var _0x4a7a5c=_0x37706b;return _0x25c717[_0x4a7a5c(0x2c9)][_0x4a7a5c(0x287)]()==_0x4a16b5[0x0][_0x4a7a5c(0x25a)][_0x4a7a5c(0x287)]();});if(_0x2c758c[_0x37706b(0x315)]>0x0)_0x2aac75=_0x2c758c[0x0]['Id'];else{}}else{IsManager=![],_0x2aac75='';var _0x26bc98=excelRows[_0x37706b(0x1dc)](_0x3ae847=>_0x3ae847['Email'][_0x37706b(0x287)]()==_0x4a16b5[0x0]['Email'][_0x37706b(0x287)]());excelRows[_0x26bc98][_0x37706b(0x22a)]=_0x37706b(0x1dd);}}var _0x5075d7,_0x5bae14=GetItemTypeForListName(_0x2f353b);_0x5075d7={'__metadata':{'type':_0x5bae14},'Designation':_0x4a16b5[0x0]['Designation'],'GroupName':_0x4a16b5[0x0]['Group\x20Name'],'Manager':_0x18840a,'ManagerLoginNameId':_0x2aac75},$[_0x37706b(0x240)](updateItemExitUser(_0x2f353b,_0x5075d7,_0x4a16b5[0x0][_0x37706b(0x22e)]))['done'](function(_0x56a2bd){var _0x514046=_0x37706b,_0x30d5f2=_0x56a2bd;if(_0x30d5f2){lblUpdate=lblUpdate+0x1,Exits=Exits-0x1;var _0x23fb15=excelRows[_0x514046(0x1dc)](_0x58f087=>_0x58f087[_0x514046(0x2c9)]==UserEmailId);excelRows[_0x23fb15][_0x514046(0x22a)]='Updated',showmessage();}});}catch(_0x104d58){console['log'](_0x104d58[_0x37706b(0x274)]);}}var IsManager=!![];function a15_0x249f(_0x3f53c8,_0x3aa169){var _0x251912=a15_0x2519();return a15_0x249f=function(_0x249fb8,_0x2fa526){_0x249fb8=_0x249fb8-0x1db;var _0x525275=_0x251912[_0x249fb8];return _0x525275;},a15_0x249f(_0x3f53c8,_0x3aa169);}function AddNewEmployeeAllocated(_0x5d9d59,_0x178904){var _0x1903c5=a15_0x49f919,_0x39fb52=![];try{var _0x49bc50=AllCompanies[_0x1903c5(0x246)](function(_0x2e85da){var _0x19310d=_0x1903c5;return _0x2e85da['ID']==parseInt(_0x5d9d59[0x0][_0x19310d(0x1f7)]);});if(!(_0x49bc50['length']>0x0))return alert('Company\x20Id\x20is\x20not\x20Correct'),_0x39fb52=![],![];var _0x1618c9=AllDepartments[_0x1903c5(0x246)](function(_0x365adb){return _0x365adb['ID']==parseInt(_0x5d9d59[0x0]['Department']);});if(!(_0x1618c9[_0x1903c5(0x315)]>0x0))return alert(_0x1903c5(0x21b)),_0x39fb52=![],![];var _0x609f7a=AllOfficeLocation['filter'](function(_0x297649){var _0x4481f7=_0x1903c5;return _0x297649['ID']==parseInt(_0x5d9d59[0x0][_0x4481f7(0x21a)]);});if(!(_0x609f7a[_0x1903c5(0x315)]>0x0))return alert(_0x1903c5(0x2a1)),_0x39fb52=![],![];if(_0x49bc50[_0x1903c5(0x315)]>0x0&&_0x1618c9[_0x1903c5(0x315)]>0x0&&_0x609f7a[_0x1903c5(0x315)]>0x0){EmployeeDepartment=_0x1618c9[0x0][_0x1903c5(0x27d)],EmployeeOfficeLocation=_0x609f7a[0x0]['OfficeName'],LoginName=_0x5d9d59[0x0]['Email'][_0x1903c5(0x287)]();var _0x44ff26,_0x596fe1,_0x57c1ac=GetAllGroupsUser[_0x1903c5(0x246)](function(_0x1e4836){var _0x3ebdec=_0x1903c5;return _0x1e4836['Email'][_0x3ebdec(0x287)]()==_0x5d9d59[0x0][_0x3ebdec(0x2c9)][_0x3ebdec(0x287)]();}),_0x10e756;if(_0x57c1ac['length']>0x0)var _0x10e756=_0x57c1ac[0x0]['Id'];else $['when'](AddUserinSharePointGroup(LoginName))[_0x1903c5(0x2eb)](function(_0x46590f){_0x10e756=_0x46590f;});if(TopExecutive=='Chief\x20Executive'||_0x5d9d59[0x0][_0x1903c5(0x25a)]==undefined)_0x5d9d59[0x0][_0x1903c5(0x22f)]='Chief\x20Executive',_0x44ff26=-0x1;else{var _0x3ed561=EmployeeListUsers[_0x1903c5(0x246)](function(_0x32e7e3){var _0x168ffe=_0x1903c5,_0x2214b0;if(_0x32e7e3[_0x168ffe(0x2c9)]!=null)return _0x2214b0=_0x32e7e3[_0x168ffe(0x2c9)][_0x168ffe(0x287)](),_0x2214b0==_0x5d9d59[0x0]['Manager'][_0x168ffe(0x287)]();});if(_0x3ed561['length']>0x0){_0x596fe1=_0x3ed561[0x0][_0x1903c5(0x2ca)];var _0x57c1ac=GetAllGroupsUser[_0x1903c5(0x246)](function(_0x4ef0bc){var _0x924233=_0x1903c5;return _0x4ef0bc[_0x924233(0x2c9)][_0x924233(0x287)]()==_0x5d9d59[0x0][_0x924233(0x25a)][_0x924233(0x287)]();});_0x57c1ac[_0x1903c5(0x315)]>0x0?_0x44ff26=_0x57c1ac[0x0]['Id']:_0x44ff26=AddUserinSharePointGroup(_0x5d9d59[0x0]['Manager'][_0x1903c5(0x287)]());}else{IsManager=![],_0x44ff26='';var _0x3c94e0=excelRows['findIndex'](_0x20f6b7=>_0x20f6b7['Email'][_0x1903c5(0x287)]()==LoginName);excelRows[_0x3c94e0][_0x1903c5(0x22a)]=_0x1903c5(0x243);}}var _0xefbe6d,_0x51b14f=GetItemTypeForListName(_0x178904);_0xefbe6d={'__metadata':{'type':_0x51b14f},'CompanyId':parseInt(_0x5d9d59[0x0][_0x1903c5(0x1f7)]),'DepartmentId':parseInt(_0x5d9d59[0x0]['Department']),'FullName':_0x5d9d59[0x0][_0x1903c5(0x296)],'Title':_0x5d9d59[0x0]['Name'],'ParentId':'-1','Email':_0x5d9d59[0x0][_0x1903c5(0x2c9)],'LogonNameId':_0x10e756,'Manager':_0x5d9d59[0x0]['Manager'],'ManagerLoginNameId':_0x44ff26,'OfficeLocationId':parseInt(_0x5d9d59[0x0][_0x1903c5(0x21a)]),'MobileNumber':_0x5d9d59[0x0][_0x1903c5(0x2f7)],'DateOfBirth':_0x5d9d59[0x0][_0x1903c5(0x23c)],'Gender':_0x5d9d59[0x0]['Gender'],'DateOfAnniversary':_0x5d9d59[0x0]['Date\x20Of\x20Marriage'],'JoiningDate':_0x5d9d59[0x0]['DateOfJoining'],'Designation':_0x5d9d59[0x0][_0x1903c5(0x2ce)],'PrimaryCompany':_0x1903c5(0x2d4),'EmployeeID':_0x5d9d59[0x0][_0x1903c5(0x222)],'GroupName':_0x5d9d59[0x0][_0x1903c5(0x1f2)],'Status':_0x1903c5(0x252),'PostalAddresses':_0x5d9d59[0x0]['postalCode'],'City':_0x5d9d59[0x0][_0x1903c5(0x2da)],'StateProvince':_0x5d9d59[0x0][_0x1903c5(0x28e)],'ZIPPostalCode':_0x5d9d59[0x0][_0x1903c5(0x276)],'Country':_0x5d9d59[0x0]['country'],'HomePhone':_0x5d9d59[0x0]['mobilePhone'],'OtherEMailAddress':_0x5d9d59[0x0][_0x1903c5(0x2b9)],'HomeAddress':_0x5d9d59[0x0]['Home\x20Address']},AddItemToList(_0x178904,_0xefbe6d);var _0x46a772=new Date(),_0x3cc7a3=new Date(_0x5d9d59[0x0]['DateOfJoining']),_0x1312b8=daysDifference(_0x3cc7a3,_0x46a772);_0x1312b8<=0xf&&AddedEmployeeList[_0x1903c5(0x311)]({'Metadata':_0xefbe6d,'EmployeeId':_0x5d9d59[0x0]['employeeId'],'EmployeeOfficeLocation':EmployeeOfficeLocation,'EmployeeDepartment':EmployeeDepartment}),_0x39fb52=!![];}}catch(_0x5e1dd6){console[_0x1903c5(0x2a6)](_0x5e1dd6['message']);}return _0x39fb52;}function daysDifference(_0x145517,_0x5ad09f){var _0x4d7019=a15_0x49f919,_0x271bdd=new Date(+_0x5ad09f)[_0x4d7019(0x236)](0xc)-new Date(+_0x145517)[_0x4d7019(0x236)](0xc);return Math['round'](_0x271bdd/0x5265c00);}function updateItemExitUser(_0x480170,_0x2001cd,_0x113e36){var _0x51cc05=a15_0x49f919,_0x32abbd=$['Deferred']();return $[_0x51cc05(0x1e4)]({'url':_spPageContextInfo[_0x51cc05(0x1f8)]+_0x51cc05(0x200)+_0x480170+_0x51cc05(0x2d8)+_0x113e36+'\x27)','type':_0x51cc05(0x30d),'headers':{'accept':_0x51cc05(0x293),'X-RequestDigest':$(_0x51cc05(0x2d5))[_0x51cc05(0x204)](),'content-Type':_0x51cc05(0x293),'X-Http-Method':'PATCH','If-Match':'*'},'data':JSON[_0x51cc05(0x26f)](_0x2001cd),'async':![],'success':function(_0x426b3e){var _0x15ad0e=_0x51cc05;_0x32abbd[_0x15ad0e(0x1e0)](!![]);},'error':function(_0x37a1af){_0x32abbd['reject'](_0x37a1af);}}),_0x32abbd['promise']();}function AddItemToList(_0x2a3c68,_0x9981ad){var _0x2078a0=a15_0x49f919;UserEmailId=_0x9981ad['Email'];var _0x57682b=_0x9981ad[_0x2078a0(0x2ca)],_0x42ec6e=$[_0x2078a0(0x20e)]();return $['ajax']({'url':_spPageContextInfo[_0x2078a0(0x1f8)]+_0x2078a0(0x200)+_0x2a3c68+'\x27)/items','type':_0x2078a0(0x30d),'async':![],'headers':{'accept':_0x2078a0(0x293),'X-RequestDigest':$(_0x2078a0(0x2d5))[_0x2078a0(0x204)](),'content-Type':_0x2078a0(0x293)},'data':JSON[_0x2078a0(0x26f)](_0x9981ad),'success':function(_0x1d7b71){var _0x4be165=_0x2078a0;counusers=counusers+0x1,AvilableLicenses=AvilableLicenses-0x1,Ready=Ready-0x1;var _0x1a03ad=excelRows['findIndex'](_0x15bbd5=>_0x15bbd5[_0x4be165(0x2c9)]==UserEmailId);excelRows[_0x1a03ad][_0x4be165(0x22a)]=_0x4be165(0x25e),showmessage();var _0x4b5558=GetSubSiteUrl(_0x4be165(0x2ae),_0x1d7b71['d']['DepartmentId']);AssignPermissiononDMSLibary(_0x1d7b71['d'][_0x4be165(0x239)],_0x4be165(0x2b2),_0x4b5558),_0x42ec6e[_0x4be165(0x1e0)](_0x1d7b71);},'error':function(_0x34d457){var _0x14cfbb=_0x2078a0;if(IsManager){var _0x569893=excelRows[_0x14cfbb(0x1dc)](_0x577d59=>_0x577d59['Email']==UserEmailId);excelRows[_0x569893][_0x14cfbb(0x22a)]=_0x14cfbb(0x300);}userfullname==''?(userfullname+=_0x57682b,warningmessage=_0x14cfbb(0x1ef)):userfullname+=_0x14cfbb(0x24c)+_0x57682b,Ready=Ready-0x1,Error=Error+0x1,console[_0x14cfbb(0x2a6)](JSON[_0x14cfbb(0x26f)](_0x34d457)),_0x42ec6e['reject'](JSON[_0x14cfbb(0x26f)](_0x34d457));}}),_0x42ec6e[_0x2078a0(0x2cd)]();}function LoadShowUser(_0x22b0a5){var _0x492d1c=a15_0x49f919;tabledata=new Tabulator(_0x492d1c(0x219),{'height':'','pagination':_0x492d1c(0x26c),'paginationSize':0xa,'layout':_0x492d1c(0x22b),'paginationSizeSelector':[0xa,0x19,0x32,0x64],'placeholder':'Click\x20on\x20Azure\x20Sync\x20button\x20first.','data':_0x22b0a5,'pageLoaded':function(_0x6034bc){var _0x26387d=_0x492d1c;_0x6034bc>=0x1?pageIndex=_0x6034bc:pageIndex=_0x6034bc,IsMiisingSelect=document[_0x26387d(0x218)](_0x26387d(0x247)),IsMiisingSelect[_0x26387d(0x2cf)]&&$(_0x26387d(0x229))['prop'](_0x26387d(0x2cf),!![]),isReadeySelect=document[_0x26387d(0x218)](_0x26387d(0x1f6)),isReadeySelect[_0x26387d(0x2cf)]&&$(_0x26387d(0x2ab))[_0x26387d(0x2e6)]('checked',!![]);},'columns':[{'formatter':function(_0x5e3953,_0x4f3b04){var _0x3d6822=_0x492d1c,_0x536787=_0x5e3953[_0x3d6822(0x290)]['row'][_0x3d6822(0x2e0)][_0x3d6822(0x22a)];return _0x536787=='Invalid\x20Profile'||_0x536787==_0x3d6822(0x21d)||_0x536787==_0x3d6822(0x25e)||_0x536787==_0x3d6822(0x2b6)?_0x3d6822(0x2f6):_0x3d6822(0x2cb);},'title':_0x492d1c(0x279),'field':'ID','width':'1%','headerSort':![],'cellClick':function(_0xbba1fe,_0x4da57f){var _0xdfb205=_0x492d1c,_0x2063d1=$(_0x4da57f[_0xdfb205(0x262)]()),_0x3d1487=_0x2063d1[_0xdfb205(0x221)](_0xdfb205(0x2ab));_0x3d1487[0x0]['checked']==![]&&$(_0x4da57f['getRow']()['getElement']())[_0xdfb205(0x221)](_0xdfb205(0x229))[0x0]['checked']==![]?_0x4da57f['getRow']()[_0xdfb205(0x297)]():_0x4da57f[_0xdfb205(0x2b1)]()[_0xdfb205(0x260)]();}},{'formatter':function(_0x22e834,_0xca6428){var _0xc39a67=_0x492d1c,_0x5bcc55=_0x22e834['_cell'][_0xc39a67(0x316)]['data'][_0xc39a67(0x22a)];return _0x5bcc55==_0xc39a67(0x21d)||_0x5bcc55=='Already\x20Exist'||_0x5bcc55==_0xc39a67(0x275)?'<input\x20type=\x22checkbox\x22\x20class=\x22select-row_IsMiisingSelected\x22\x20aria-label=\x22select\x20this\x20row\x22\x20/>':'<input\x20type=\x22checkbox\x22\x20class=\x22\x22\x20disabled\x20/>';},'title':_0x492d1c(0x27e),'hozAlign':_0x492d1c(0x2e7),'field':'ID','headerSort':![],'width':'1%','cellClick':function(_0x1a69dc,_0x5c6918){var _0x4ddfb5=_0x492d1c,_0x1d0652=$(_0x5c6918[_0x4ddfb5(0x262)]()),_0x595b7f=_0x1d0652['find'](_0x4ddfb5(0x229));_0x595b7f[0x0]['checked']==![]?_0x5c6918[_0x4ddfb5(0x2b1)]()[_0x4ddfb5(0x297)]():_0x5c6918[_0x4ddfb5(0x2b1)]()[_0x4ddfb5(0x260)]();}},{'title':_0x492d1c(0x22a),'field':'Status','width':_0x492d1c(0x2f1),'formatter':function(_0x10e894,_0x5235fd){var _0x24d136=_0x492d1c,_0x2b27df=_0x10e894[_0x24d136(0x255)]();if(_0x2b27df==_0x24d136(0x24e)||_0x2b27df=='Required\x20Value\x20Missing'||_0x2b27df==_0x24d136(0x300)||_0x2b27df==_0x24d136(0x1dd))return _0x24d136(0x2c2)+_0x2b27df+'</span>';else return _0x2b27df=='Already\x20Exist'?_0x24d136(0x269)+_0x2b27df+_0x24d136(0x258):_0x24d136(0x29e)+_0x2b27df+_0x24d136(0x258);}},{'title':_0x492d1c(0x2df),'field':'Type','width':_0x492d1c(0x2f1)},{'title':'Name','field':_0x492d1c(0x296),'width':_0x492d1c(0x2f1)},{'title':_0x492d1c(0x2c9),'field':_0x492d1c(0x2c9),'align':'left','width':_0x492d1c(0x245)},{'title':_0x492d1c(0x1f7),'field':_0x492d1c(0x1db),'width':_0x492d1c(0x2f1),'align':_0x492d1c(0x2e7)},{'title':_0x492d1c(0x207),'field':_0x492d1c(0x27d),'width':_0x492d1c(0x2f1),'align':_0x492d1c(0x2e7)},{'title':_0x492d1c(0x21a),'field':'LocationName','width':_0x492d1c(0x2f1),'align':_0x492d1c(0x2e7)},{'title':'Designation','field':_0x492d1c(0x2ce),'width':_0x492d1c(0x2f1)},{'title':_0x492d1c(0x25a),'field':_0x492d1c(0x25a),'width':_0x492d1c(0x2f1)},{'title':_0x492d1c(0x2db),'field':'DateOfJoining','width':_0x492d1c(0x2f1)},{'title':_0x492d1c(0x1f2),'field':_0x492d1c(0x1f2),'width':_0x492d1c(0x2f1)}]}),showmessage(),$(_0x492d1c(0x2ac))[_0x492d1c(0x2ee)](_0x492d1c(0x21c)),$(_0x492d1c(0x2e9))[_0x492d1c(0x2c8)](),$(_0x492d1c(0x2f4))[_0x492d1c(0x264)](_0x492d1c(0x2d3));}function showmessage(){var _0x4825c9=a15_0x49f919;$(_0x4825c9(0x2dd))[_0x4825c9(0x265)](Ready),$(_0x4825c9(0x304))['text'](Error),$(_0x4825c9(0x1e6))[_0x4825c9(0x265)](Exits),$('#lblUpdate')[_0x4825c9(0x265)](lblUpdate),$(_0x4825c9(0x2b0))['text'](AvilableLicenses);}function GraphAccessTokenTogetUserDetails(){var _0x275a0c=a15_0x49f919,_0x134557=new jQuery[(_0x275a0c(0x20e))](),_0x8708d7={'X-RequestDigest':$(_0x275a0c(0x2d5))[_0x275a0c(0x204)](),'accept':_0x275a0c(0x248),'content-type':'application/json;odata=nometadata'},_0x1a18c6={'resource':_0x275a0c(0x2d7)};return $[_0x275a0c(0x1e4)]({'url':_spPageContextInfo[_0x275a0c(0x1f8)]+_0x275a0c(0x277),'headers':_0x8708d7,'type':'POST','async':![],'data':JSON['stringify'](_0x1a18c6),'success':function(_0x4ea1a0){var _0x44f1e6=_0x275a0c;token=_0x4ea1a0['access_token'],_0x134557[_0x44f1e6(0x1e0)](token);},'error':function(_0x3a0422,_0x5c9aa1,_0x44c66e){var _0xbd8477=_0x275a0c;console[_0xbd8477(0x2a6)](_0x3a0422[_0xbd8477(0x23e)]),_0x134557[_0xbd8477(0x20a)](_0x3a0422['responseText']);}}),_0x134557[_0x275a0c(0x2cd)]();}var employeehtml='',userName='',AzureUsrlist=[],AdusersUrl=a15_0x49f919(0x2b4);function GetAzureUsrlist(_0x56de3e,_0x4c991e){var _0x1d5522=a15_0x49f919;return DeferredObj=$['Deferred'](),$[_0x1d5522(0x1e4)]({'method':_0x1d5522(0x1fd),'url':_0x56de3e,'headers':{'Authorization':_0x1d5522(0x2d1)+_0x4c991e,'Content-Type':'application/json'},'async':![],'success':function(_0x4b687d){var _0x231015=_0x1d5522;AzureUsrlist=AzureUsrlist[_0x231015(0x23d)](_0x4b687d[_0x231015(0x217)]),_0x4b687d[_0x231015(0x2e3)]!=null?(AdusersUrl=_0x4b687d['@odata.nextLink'],GetAzureUsrlist(AdusersUrl,_0x4c991e)):AdusersUrl=_0x231015(0x2b4);},'error':function(_0x120b4f){var _0x14f986=_0x1d5522;DeferredObj[_0x14f986(0x20a)](_0x120b4f),alert(_0x14f986(0x256)+JSON['stringify'](_0x120b4f));}}),DeferredObj[_0x1d5522(0x2cd)]();}function getEmployee(_0x16268a){var _0x44081e=a15_0x49f919,_0xabcf23=_0x44081e(0x312)+_0x16268a+'\x27';return DeferredObj=$[_0x44081e(0x20e)](),$[_0x44081e(0x1e4)]({'method':_0x44081e(0x1fd),'url':_0xabcf23,'headers':{'Authorization':'Bearer\x20'+token,'Content-Type':'application/json'},'async':![],'success':function(_0x5f73c8){var _0x47d6d2=_0x44081e;_0x5f73c8[_0x47d6d2(0x217)]['length']>0x0?DeferredObj[_0x47d6d2(0x1e0)](_0x5f73c8[_0x47d6d2(0x217)][0x0][_0x47d6d2(0x271)]):DeferredObj[_0x47d6d2(0x1e0)](_0x47d6d2(0x24e));},'error':function(_0x543eeb){var _0x209e02=_0x44081e;DeferredObj['reject'](_0x543eeb),alert(_0x209e02(0x256)+JSON[_0x209e02(0x26f)](_0x543eeb));}}),DeferredObj[_0x44081e(0x2cd)]();}function ClientCredentials(){var _0x13d370=a15_0x49f919,_0x4b0723=_0x13d370(0x2fb),_0x25630a=titanForWork[_0x13d370(0x29c)](_0x13d370(0x281)),_0x7d1f02=_spPageContextInfo[_0x13d370(0x1f8)]+_0x13d370(0x23f)+_0x4b0723+'\x27)/items?$filter=Title\x20eq\x20\x27Client_Credentials\x27\x20';$['ajax']({'url':_0x7d1f02,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x3d04bd){var _0x55306c=_0x13d370,_0xca57df=_0x3d04bd['d'][_0x55306c(0x270)];ClientId=_0xca57df[0x0]['ClientName'],ClentSecret=_0xca57df[0x0][_0x55306c(0x25b)],ClientUrl=_0xca57df[0x0][_0x55306c(0x23b)];},'error':function(_0x58a8d9){var _0x3384ee=_0x13d370;console[_0x3384ee(0x2a6)](_0x58a8d9);}});}var EmployeeListUsers=[],GetQueryURL=_spPageContextInfo[a15_0x49f919(0x1f8)]+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=999&$select=ID,AttachmentFiles,FullName,Designation,Manager,MobileNumber,ExtensionName,Email,LogonName/UserName,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department,AttachmentFiles\x20&$filter=\x20PrimaryCompany\x20eq\x20\x27Primary\x27\x20and\x20Status\x20eq\x20\x27Active\x27\x20';function GetEmployees(){var _0x4d1c52=a15_0x49f919;$[_0x4d1c52(0x1e4)]({'url':GetQueryURL,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'beforeSend':function(){},'success':function(_0x30b133){var _0x36b7c5=_0x4d1c52;EmployeeListUsers=EmployeeListUsers[_0x36b7c5(0x23d)](_0x30b133['d']['results']);if(_0x30b133['d'][_0x36b7c5(0x20d)]!=null)GetQueryURL=_0x30b133['d'][_0x36b7c5(0x20d)],GetEmployees();else{GetQueryURL=_spPageContextInfo[_0x36b7c5(0x1f8)]+_0x36b7c5(0x201);var _0x56e3bc='',_0x414db4=_spPageContextInfo[_0x36b7c5(0x1f8)]+'/_api/web/lists/getbytitle(\x27ExternalUsers\x27)/items?$select=*,InternalStakeholders/Title,Supervisor_Guest/Title,Client_Name/Title,LoginName/Title\x20&$expand=\x20LoginName,Client_Name,Supervisor_Guest,InternalStakeholders\x20&$filter=((Status\x20eq\x20\x27Initiated\x27)\x20or\x20(Status\x20eq\x20\x27Invited\x27\x20)or\x20(Status\x20eq\x20\x27Pending\x27)or\x20(Status\x20eq\x20\x27Accepted\x27))';extdfds=$['Deferred'](),$['when'](getItems(_0x414db4,extdfds))[_0x36b7c5(0x2eb)](function(_0xbd30fc){var _0x5cedf4=_0x36b7c5;response=[],_0x56e3bc=_0xbd30fc[_0x5cedf4(0x315)];});}AvilableLicenses=parseInt(UsersLicenceRequired)-(parseInt(EmployeeListUsers[_0x36b7c5(0x315)])+parseInt(_0x56e3bc));},'error':function(_0x5903d4){console['log'](_0x5903d4);}});}$(function(){var _0x5c06a3=a15_0x49f919;$(_0x5c06a3(0x30b))[_0x5c06a3(0x235)](function(){var _0x1447ef=_0x5c06a3;$(_0x1447ef(0x30c))['fadeIn']()[_0x1447ef(0x232)](0x5dc)['fadeOut']();var _0x23e1f3=document[_0x1447ef(0x218)]('fileUpload');GetEmployees(),LoadShowUser([]),Ready=0x0,Error=0x0,counusers=0x0;var _0xdae768=/^([a-zA-Z0-9\s_\\.\-:])+(.xls|.xlsx)$/;if(_0xdae768[_0x1447ef(0x2bd)](_0x23e1f3[_0x1447ef(0x217)][_0x1447ef(0x287)]())){if(typeof FileReader!=_0x1447ef(0x1ff)){var _0x4428e9=new FileReader();_0x4428e9[_0x1447ef(0x284)]?(_0x4428e9[_0x1447ef(0x2ad)]=function(_0x2418e7){var _0x17f461=_0x1447ef;ProcessExcel(_0x2418e7[_0x17f461(0x307)]['result']);},_0x4428e9[_0x1447ef(0x284)](_0x23e1f3[_0x1447ef(0x2f0)][0x0])):(_0x4428e9[_0x1447ef(0x2ad)]=function(_0x21268c){var _0x1bf930=_0x1447ef,_0xd48fec='',_0x3ad383=new Uint8Array(_0x21268c[_0x1bf930(0x307)][_0x1bf930(0x1f0)]);for(var _0x33380c=0x0;_0x33380c<_0x3ad383['byteLength'];_0x33380c++){_0xd48fec+=String['fromCharCode'](_0x3ad383[_0x33380c]);}ProcessExcel(_0xd48fec);},_0x4428e9[_0x1447ef(0x2d9)](_0x23e1f3[_0x1447ef(0x2f0)][0x0]));}else alert(_0x1447ef(0x272));}else alert('Please\x20upload\x20a\x20valid\x20Excel\x20file.');});});function ProcessExcel(_0x2b1906){var _0x57245c=a15_0x49f919,_0x2f2fd0=XLSX[_0x57245c(0x27a)](_0x2b1906,{'type':_0x57245c(0x283)}),_0x1097a0=_0x2f2fd0['SheetNames'][0x0];excelRows=XLSX[_0x57245c(0x224)][_0x57245c(0x242)](_0x2f2fd0[_0x57245c(0x2e8)][_0x1097a0]),$(_0x57245c(0x1fa))[_0x57245c(0x2c5)](),$('#UploadedItems')[_0x57245c(0x1e2)](_0x57245c(0x249)+excelRows[_0x57245c(0x315)]+_0x57245c(0x23a)),$(_0x57245c(0x30a))['html']('');for(var _0x343b69=0x0;_0x343b69<excelRows[_0x57245c(0x315)];_0x343b69++){var _0x44c13b='';ErrorUser='';var _0x55be12=EmployeeListUsers[_0x57245c(0x246)](function(_0x26b9bb){var _0x470488=_0x57245c,_0x1c86b3=_0x26b9bb['Email'][_0x470488(0x287)]();return _0x1c86b3==excelRows[_0x343b69][_0x470488(0x251)][_0x470488(0x287)]();});if(_0x55be12[_0x57245c(0x315)]>0x0){_0x44c13b=_0x55be12[0x0][_0x57245c(0x2ca)],color_red=_0x57245c(0x2b5),ErrorUser='Already\x20Exist',Exits=Exits+0x1;var _0x37e04d=_0x55be12[0x0]['ID'];excelRows[_0x343b69][_0x57245c(0x209)]='-',excelRows[_0x343b69]['Department\x20*']='-',excelRows[_0x343b69][_0x57245c(0x1ed)]='-';}else{var _0x2f499c=AzureUsrlist[_0x57245c(0x246)](function(_0x57aa9b){var _0x43c224=_0x57245c;if(_0x57aa9b[_0x43c224(0x26d)]!=null){var _0x3af52d=_0x57aa9b['mail'][_0x43c224(0x287)]();return _0x3af52d==excelRows[_0x343b69][_0x43c224(0x251)]['toLowerCase']();}});if(_0x2f499c[_0x57245c(0x315)]>0x0){_0x44c13b=_0x2f499c[0x0][_0x57245c(0x271)];var _0x4904a8=AllCompanies[_0x57245c(0x246)](function(_0x2fe17a){var _0x2c93eb=_0x57245c;return _0x2fe17a['ID']==excelRows[_0x343b69][_0x2c93eb(0x209)];}),_0x536133=AllDepartments['filter'](function(_0x12336b){var _0x4fba94=_0x57245c;return _0x12336b['ID']==excelRows[_0x343b69][_0x4fba94(0x268)];}),_0x2355e3=AllOfficeLocation[_0x57245c(0x246)](function(_0x110752){var _0x3d08b4=_0x57245c;return _0x110752['ID']==excelRows[_0x343b69][_0x3d08b4(0x1ed)];});_0x4904a8[_0x57245c(0x315)]>0x0&&_0x536133[_0x57245c(0x315)]>0x0&&_0x2355e3['length']>0x0?(Ready=Ready+0x1,ErrorUser=_0x57245c(0x275),excelRows[_0x343b69]['DepartmentNameDetail']=_0x536133[0x0][_0x57245c(0x27d)],excelRows[_0x343b69]['OfficeNameDetail']=_0x2355e3[0x0][_0x57245c(0x211)]):(ErrorUser=_0x57245c(0x21d),Error=Error+0x1);}else ErrorUser=_0x57245c(0x24e),color_red='color-red',Error=Error+0x1;}excelRows[_0x343b69]['Name']=_0x44c13b,excelRows[_0x343b69]['id']=_0x343b69,excelRows[_0x343b69][_0x57245c(0x22a)]=ErrorUser,excelRows[_0x343b69][_0x57245c(0x22e)]=_0x37e04d;}alluserdata=excelRows,LoadShowUser(excelRows);}function CompaniesDetails(){var _0x4e9565=a15_0x49f919,_0x3c50a1=document['getElementById']('ddlAllCompanies');_0x3c50a1[_0x4e9565(0x2de)]='',opt['value']='0',opt[_0x4e9565(0x265)]=_0x4e9565(0x1df),_0x3c50a1['appendChild'](opt);for(var _0x437cd6=0x0;_0x437cd6<AllCompanies[_0x4e9565(0x315)];_0x437cd6++){var _0xb0c319=AllCompanies[_0x437cd6][_0x4e9565(0x1db)],_0xe1ed53=AllCompanies[_0x437cd6]['ID'];opt=document[_0x4e9565(0x308)](_0x4e9565(0x2c1)),opt[_0x4e9565(0x217)]=_0xe1ed53,opt[_0x4e9565(0x265)]=_0xb0c319,_0x3c50a1[_0x4e9565(0x220)](opt);}$('.form-check-input')[_0x4e9565(0x2e6)](_0x4e9565(0x2cf),![]),$(_0x4e9565(0x1e1))[_0x4e9565(0x204)](''),$(_0x4e9565(0x2f9))[_0x4e9565(0x204)](''),$('#txtDesignation')[_0x4e9565(0x204)]('');}$(a15_0x49f919(0x2cc))['click'](function(){var _0x449b3c=a15_0x49f919,_0x306d66=tabledata[_0x449b3c(0x2e5)]();debugger;_0x306d66['length']>0x0?(CompaniesDetails(),$(_0x449b3c(0x2ea))[_0x449b3c(0x1fb)](_0x449b3c(0x2fd)),initializePeoplePicker(_0x449b3c(0x250)),peoplePickerDiv=$(_0x449b3c(0x227))):alert('Please\x20select\x20required\x20value\x20missing\x20row');});var GetDepartments,Getofficelocation,GetDesignation,GetGroup,CompaniesId,GetofficelocationName,GetDepartmentsName,CompaniesName;$('#btnmissingrequedvalue')[a15_0x49f919(0x235)](function(){var _0x3112b6=a15_0x49f919;if(document[_0x3112b6(0x218)](_0x3112b6(0x25c))[_0x3112b6(0x2cf)]==!![]||document[_0x3112b6(0x218)](_0x3112b6(0x313))[_0x3112b6(0x2cf)]==!![]||document['getElementById']('chkDesignation')[_0x3112b6(0x2cf)]==!![]||document[_0x3112b6(0x218)]('chkManager')[_0x3112b6(0x2cf)]==!![]||document[_0x3112b6(0x218)](_0x3112b6(0x2ec))[_0x3112b6(0x2cf)]==!![]||document[_0x3112b6(0x218)](_0x3112b6(0x2fa))['checked']==!![]){var _0x251398=tabledata[_0x3112b6(0x2e5)](),_0x17f970=SPClientPeoplePicker['SPClientPeoplePickerDict'][peoplePickerDiv[0x0]['id']],_0x3b8b9b=_0x17f970['GetAllUserInfo']();for(var _0x58a6ba=0x0;_0x58a6ba<_0x251398['length'];_0x58a6ba++){var _0x49c64f=excelRows[_0x3112b6(0x1dc)](_0x141d6b=>_0x141d6b[_0x3112b6(0x2c9)]==_0x251398[_0x58a6ba][_0x3112b6(0x29f)][_0x3112b6(0x2e0)][_0x3112b6(0x2c9)]);if(excelRows[_0x49c64f][_0x3112b6(0x22a)]==_0x3112b6(0x278))excelRows[_0x49c64f][_0x3112b6(0x1f7)]='-',excelRows[_0x49c64f]['Department']='-',excelRows[_0x49c64f][_0x3112b6(0x21a)]='-',document[_0x3112b6(0x218)](_0x3112b6(0x29b))[_0x3112b6(0x2cf)]&&(excelRows[_0x49c64f]['Designation']=$(_0x3112b6(0x24f))[_0x3112b6(0x204)]()),document[_0x3112b6(0x218)]('chkManager')['checked']&&(excelRows[_0x49c64f][_0x3112b6(0x25a)]=_0x3b8b9b[0x0]['EntityData'][_0x3112b6(0x2c9)]),document[_0x3112b6(0x218)](_0x3112b6(0x2ec))['checked']&&(excelRows[_0x49c64f][_0x3112b6(0x25a)]=_0x3112b6(0x2ba)),document['getElementById'](_0x3112b6(0x2fa))[_0x3112b6(0x2cf)]&&(excelRows[_0x49c64f][_0x3112b6(0x1f2)]=$(_0x3112b6(0x2f9))[_0x3112b6(0x204)]());else{if(excelRows[_0x49c64f][_0x3112b6(0x22a)]==_0x3112b6(0x21d)||excelRows[_0x49c64f][_0x3112b6(0x22a)]==_0x3112b6(0x275)){document[_0x3112b6(0x218)]('chkDepartment')['checked']&&(excelRows[_0x49c64f][_0x3112b6(0x1f7)]=CompaniesId,excelRows[_0x49c64f][_0x3112b6(0x1db)]=CompaniesName,excelRows[_0x49c64f][_0x3112b6(0x207)]=GetDepartments,excelRows[_0x49c64f]['DepartmentName']=GetDepartmentsName);document['getElementById'](_0x3112b6(0x313))[_0x3112b6(0x2cf)]&&(excelRows[_0x49c64f][_0x3112b6(0x1f7)]=CompaniesId,excelRows[_0x49c64f][_0x3112b6(0x1db)]=CompaniesName,excelRows[_0x49c64f]['Location']=Getofficelocation,excelRows[_0x49c64f][_0x3112b6(0x28d)]=GetofficelocationName);document['getElementById']('chkDesignation')[_0x3112b6(0x2cf)]&&(excelRows[_0x49c64f]['Designation']=$(_0x3112b6(0x24f))[_0x3112b6(0x204)]());document['getElementById'](_0x3112b6(0x1fc))[_0x3112b6(0x2cf)]&&(excelRows[_0x49c64f][_0x3112b6(0x25a)]=_0x3b8b9b[0x0][_0x3112b6(0x28f)][_0x3112b6(0x2c9)]);document[_0x3112b6(0x218)](_0x3112b6(0x2ec))[_0x3112b6(0x2cf)]&&(excelRows[_0x49c64f]['Manager']='Chief\x20Executive');document[_0x3112b6(0x218)](_0x3112b6(0x2fa))[_0x3112b6(0x2cf)]&&(excelRows[_0x49c64f][_0x3112b6(0x1f2)]=$(_0x3112b6(0x2f9))['val']());var _0x3e2725=AllCompanies[_0x3112b6(0x246)](function(_0x185f90){return _0x185f90['ID']==excelRows[_0x49c64f]['Company'];}),_0x345705=AllDepartments[_0x3112b6(0x246)](function(_0x5570c7){var _0x2326f7=_0x3112b6;return _0x5570c7['ID']==excelRows[_0x49c64f][_0x2326f7(0x207)];}),_0x1e6fae=AllOfficeLocation['filter'](function(_0x52b7ef){var _0x1b2b89=_0x3112b6;return _0x52b7ef['ID']==excelRows[_0x49c64f][_0x1b2b89(0x21a)];});_0x3e2725[_0x3112b6(0x315)]>0x0&&_0x345705[_0x3112b6(0x315)]>0x0&&_0x1e6fae['length']>0x0?(Ready=Ready+0x1,Error=Error-0x1,excelRows[_0x49c64f]['Status']=_0x3112b6(0x275)):(excelRows[_0x49c64f][_0x3112b6(0x22a)]='Required\x20Value\x20Missing',Error=Error+0x1);}else excelRows[_0x49c64f]['Status']==_0x3112b6(0x243)&&(document[_0x3112b6(0x218)](_0x3112b6(0x29b))[_0x3112b6(0x2cf)]&&(excelRows[_0x49c64f][_0x3112b6(0x2ce)]=$('#txtDesignation')[_0x3112b6(0x204)]()),document['getElementById'](_0x3112b6(0x1fc))[_0x3112b6(0x2cf)]&&(excelRows[_0x49c64f][_0x3112b6(0x25a)]=_0x3b8b9b[0x0][_0x3112b6(0x28f)][_0x3112b6(0x2c9)]),document['getElementById']('chkTopExecutive')[_0x3112b6(0x2cf)]&&(excelRows[_0x49c64f]['Manager']=_0x3112b6(0x2ba)),document['getElementById'](_0x3112b6(0x2fa))[_0x3112b6(0x2cf)]&&(excelRows[_0x49c64f][_0x3112b6(0x1f2)]=$(_0x3112b6(0x2f9))[_0x3112b6(0x204)]()),Ready=Ready+0x1,Error=Error-0x1,excelRows[_0x49c64f]['Status']=_0x3112b6(0x275));}}tabledata[_0x3112b6(0x24d)](excelRows),tabledata['setPage'](pageIndex),$(_0x3112b6(0x2ea))[_0x3112b6(0x1fb)](_0x3112b6(0x2bb)),showmessage();}else alert('please\x20check\x20at\x20list\x20one\x20checkbox\x20'),$(_0x3112b6(0x2a8))[_0x3112b6(0x204)]();}),$(a15_0x49f919(0x214))[a15_0x49f919(0x30e)](function(){var _0x50a5ba=a15_0x49f919;CompaniesId=parseInt($('option:selected',$(this))['val']()),CompaniesName=$(_0x50a5ba(0x231),$(this))[_0x50a5ba(0x265)]();var _0x2f3068=AllOfficeLocation['filter'](function(_0x4bb0ca){var _0x45371a=_0x50a5ba;return _0x4bb0ca[_0x45371a(0x212)]===CompaniesId;}),_0x3cd5bc=document[_0x50a5ba(0x218)]('ddlOfficeLocation');_0x3cd5bc[_0x50a5ba(0x2de)]='';for(var _0x3ef1aa=0x0;_0x3ef1aa<_0x2f3068[_0x50a5ba(0x315)];_0x3ef1aa++){var _0x108252=_0x2f3068[_0x3ef1aa][_0x50a5ba(0x211)],_0x5c1147=_0x2f3068[_0x3ef1aa]['ID'];opt=document[_0x50a5ba(0x308)]('option'),opt[_0x50a5ba(0x217)]=_0x5c1147,opt['text']=_0x108252,_0x3cd5bc[_0x50a5ba(0x220)](opt);}Getofficelocation=parseInt($('option:selected',$(_0x50a5ba(0x305)))[_0x50a5ba(0x204)]()),GetofficelocationName=$(_0x50a5ba(0x231),$('#ddlOfficeLocation'))[_0x50a5ba(0x265)]();var _0x37365f=AllDepartments[_0x50a5ba(0x246)](function(_0x342407){var _0x1ec589=_0x50a5ba;return _0x342407[_0x1ec589(0x212)]===CompaniesId;}),_0x3cd5bc=document[_0x50a5ba(0x218)](_0x50a5ba(0x241));_0x3cd5bc[_0x50a5ba(0x2de)]='';for(var _0x3ef1aa=0x0;_0x3ef1aa<_0x37365f[_0x50a5ba(0x315)];_0x3ef1aa++){var _0x108252=_0x37365f[_0x3ef1aa]['DepartmentName'],_0x5c1147=_0x37365f[_0x3ef1aa]['ID'];opt=document[_0x50a5ba(0x308)]('option'),opt[_0x50a5ba(0x217)]=_0x5c1147,opt[_0x50a5ba(0x265)]=_0x108252,_0x3cd5bc[_0x50a5ba(0x220)](opt);}GetDepartments=parseInt($(_0x50a5ba(0x231),$(_0x50a5ba(0x21f)))[_0x50a5ba(0x204)]()),GetDepartmentsName=$('option:selected',$(_0x50a5ba(0x21f)))[_0x50a5ba(0x265)]();}),$(a15_0x49f919(0x21f))[a15_0x49f919(0x30e)](function(){var _0x443b4f=a15_0x49f919;GetDepartments=parseInt($(_0x443b4f(0x231),$(this))['val']()),GetDepartmentsName=$(_0x443b4f(0x231),$('#ddlDepartment'))[_0x443b4f(0x265)]();}),$(a15_0x49f919(0x305))[a15_0x49f919(0x30e)](function(){var _0x3bc78c=a15_0x49f919;Getofficelocation=parseInt($('option:selected',$(this))[_0x3bc78c(0x204)]()),GetofficelocationName=$(_0x3bc78c(0x231),$(_0x3bc78c(0x305)))[_0x3bc78c(0x265)]();});function chkManagerevent(_0x11de77){var _0x101f50=a15_0x49f919;if(_0x11de77[_0x101f50(0x2cf)])$(_0x101f50(0x2d2))[_0x101f50(0x2e6)]('checked',![]),$('#txtmanager')[_0x101f50(0x289)](_0x101f50(0x301)),$(_0x101f50(0x1e1))[_0x101f50(0x24a)]();else{}}var TopExecutive='';function chkTopExecutiveevent(_0x5871eb){var _0x266134=a15_0x49f919;if(_0x5871eb[_0x266134(0x2cf)])$(_0x266134(0x1e7))[_0x266134(0x2e6)](_0x266134(0x2cf),![]),$(_0x266134(0x1e1))[_0x266134(0x2e6)](_0x266134(0x301),!![]),$('#txtmanager')['val'](''),TopExecutive=_0x266134(0x2ba);else{}}$(a15_0x49f919(0x1f3))[a15_0x49f919(0x235)](function(){var _0x55166c=a15_0x49f919;tabledata[_0x55166c(0x233)](_0x55166c(0x234),'EmployeeSyncReport.xlsx',{'sheetName':'EmployeeSyncreport'});});var dvExcel=document['getElementById']('exceltble');dvExcel[a15_0x49f919(0x2de)]='';var outputArray=[];function removewithfilter(_0x2d17b0){let _0x103e9f=_0x2d17b0['filter'](function(_0x27b8e4,_0x5bbe02,_0x65884b){var _0x43cf09=a15_0x249f;return _0x5bbe02==_0x65884b[_0x43cf09(0x26b)](_0x27b8e4);});return _0x103e9f;}function GetItemTypeForListName(_0x522976){var _0x2032fe=a15_0x49f919;return'SP.Data.'+_0x522976[_0x2032fe(0x286)](0x0)[_0x2032fe(0x2e1)]()+_0x522976['split']('\x20')['join']('')[_0x2032fe(0x254)](0x1)+'ListItem';}var response=response||[];function getItems(_0x33503f,_0x500684){var _0x1dc850=a15_0x49f919;return $[_0x1dc850(0x1e4)]({'url':_0x33503f,'type':_0x1dc850(0x1fd),'async':![],'headers':{'accept':_0x1dc850(0x293)},'success':function(_0x25b3c6){var _0x31b461=_0x1dc850;response=response[_0x31b461(0x23d)](_0x25b3c6['d'][_0x31b461(0x270)]),_0x25b3c6['d'][_0x31b461(0x20d)]?(_0x33503f=_0x25b3c6['d'][_0x31b461(0x20d)],getItems(_0x33503f,_0x500684)):_0x500684['resolve'](response);},'error':function(_0x34f835){_0x500684['reject'](_0x34f835),console['log'](_0x34f835);}}),_0x500684[_0x1dc850(0x2cd)]();}function InsertWelcomeInAnnouncementList(_0x13c8d8){var _0x263ab5=a15_0x49f919;$[_0x263ab5(0x1e4)]({'url':_spPageContextInfo[_0x263ab5(0x1f8)]+_0x263ab5(0x29d),'type':_0x263ab5(0x30d),'async':![],'data':JSON['stringify'](_0x13c8d8),'headers':{'Accept':'application/json;odata=verbose','Content-Type':'application/json;odata=verbose','X-RequestDigest':$('#__REQUESTDIGEST')[_0x263ab5(0x204)](),'X-HTTP-Method':_0x263ab5(0x30d)},'success':function(_0x5ec5fc,_0x7c6f4c,_0xaf47d6){var _0x1a8450=_0x263ab5;console[_0x1a8450(0x2a6)]('Data\x20Send\x20to\x20Announcements');},'error':function(_0xa24a7d){var _0x444f88=_0x263ab5;console[_0x444f88(0x2a6)](_0xa24a7d),console[_0x444f88(0x2a6)]('Data\x20Send\x20to\x20Announcements\x20Failed'),currentDlg[_0x444f88(0x24b)]();}});}