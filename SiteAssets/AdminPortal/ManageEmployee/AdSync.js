var a20_0x101df8=a20_0x204c;(function(_0x504547,_0x3497ba){var _0x1f83bc=a20_0x204c,_0x2374cd=_0x504547();while(!![]){try{var _0x1f524f=-parseInt(_0x1f83bc(0x281))/0x1+parseInt(_0x1f83bc(0x220))/0x2*(parseInt(_0x1f83bc(0x2eb))/0x3)+-parseInt(_0x1f83bc(0x217))/0x4+parseInt(_0x1f83bc(0x2aa))/0x5+parseInt(_0x1f83bc(0x216))/0x6*(-parseInt(_0x1f83bc(0x26e))/0x7)+parseInt(_0x1f83bc(0x2f6))/0x8*(parseInt(_0x1f83bc(0x1cd))/0x9)+parseInt(_0x1f83bc(0x2a2))/0xa;if(_0x1f524f===_0x3497ba)break;else _0x2374cd['push'](_0x2374cd['shift']());}catch(_0x25220e){_0x2374cd['push'](_0x2374cd['shift']());}}}(a20_0x19fc,0x2d086));var token,ClientId='',ClentSecret='',ClientUrl='',DeferredObj=$['Deferred'](),color_red='',Error=0x0,Ready=0x0,Exits=0x0,lblUpdate=0x0,ErrorUser='',alluserdata,contributersGroupId='',counusers=0x0,excelRows,AllCompanies,AllDepartments,AllOfficeLocation,tabledata,pageIndex,UserEmailId,warningmessage='',userfullname='',AvilableLicenses,ReadySelected=[],MiisingSelected=[],AddedEmployeeList=[],IsMiisingSelect,isReadeySelect,peoplePickerDiv='',EmployeeId='',EmployeeDepartment='',EmployeeOfficeLocation='',checkedAudience='';$(document)[a20_0x101df8(0x1ee)](function(){var _0x719744=a20_0x101df8;GraphAccessTokenTogetUserDetails(),GetCompanies(),GetOfficeLocation(),GetDepartments(),LoadShowUser([]),GetAllUserId(),GetEmployees(),$(_0x719744(0x1f1))[_0x719744(0x211)](AvilableLicenses);});function initializePeoplePicker(_0x463d6f){var _0x3f230f=a20_0x101df8,_0x360be0={};_0x360be0['PrincipalAccountType']=_0x3f230f(0x251),_0x360be0[_0x3f230f(0x2a5)]=0xf,_0x360be0['ResolvePrincipalSource']=0xf,_0x360be0['AllowMultipleValues']=![],_0x360be0[_0x3f230f(0x245)]=0x32,_0x360be0[_0x3f230f(0x2fc)]=_0x3f230f(0x231),this[_0x3f230f(0x26c)](_0x463d6f,null,_0x360be0),$(_0x3f230f(0x1ea))[_0x3f230f(0x1ff)](0xfa);}function GetSelectItem(){var _0x8f5ba9=a20_0x101df8;if(contributersGroupId!==''){var _0x2de44e=tabledata[_0x8f5ba9(0x2b9)]();counusers=0x0,IsaddedNewEmployee=![];for(var _0x4c4d02=0x0;_0x4c4d02<_0x2de44e[_0x8f5ba9(0x2ac)];_0x4c4d02++){var _0x259e68=alluserdata[_0x8f5ba9(0x1c8)](function(_0x4748f4){var _0x12ff32=_0x8f5ba9;return _0x4748f4['Email']==_0x2de44e[_0x4c4d02][_0x12ff32(0x25e)]['data'][_0x12ff32(0x2e1)];});AvilableLicenses>0x0?_0x259e68[0x0]['Status']==_0x8f5ba9(0x299)?IsaddedNewEmployee=AddNewEmployeeAllocated(_0x259e68,'Employees'):_0x259e68[0x0][_0x8f5ba9(0x2d8)]==_0x8f5ba9(0x1e2)&&UpdateExistingEmployeeAllocated(_0x259e68,'Employees'):($(_0x8f5ba9(0x1f4))[_0x8f5ba9(0x211)](counusers),alert('Your\x20License\x20limit\x20has\x20been\x20ended'),_0x4c4d02=_0x2de44e[_0x8f5ba9(0x2ac)]);}warningmessage!=''&&(warningmessage+=userfullname,alert(warningmessage)),$(_0x8f5ba9(0x1f4))[_0x8f5ba9(0x211)](counusers),showmessage(),tabledata[_0x8f5ba9(0x207)](excelRows),tabledata[_0x8f5ba9(0x1cb)](pageIndex),IsaddedNewEmployee&&($(_0x8f5ba9(0x2f5))[_0x8f5ba9(0x2b0)]({'backdrop':_0x8f5ba9(0x2f2),'keyboard':![]},_0x8f5ba9(0x2ff)),AddedEmployeeList[_0x8f5ba9(0x2ac)]>0x0?$(_0x8f5ba9(0x1ce))[_0x8f5ba9(0x2ff)]():$(_0x8f5ba9(0x1ce))['hide']());}else $(_0x8f5ba9(0x20e))['fadeIn']()[_0x8f5ba9(0x1da)](0x7d0)[_0x8f5ba9(0x267)](),GetGroupIDByGroupName(),GetSelectItem();}$(a20_0x101df8(0x269))[a20_0x101df8(0x2cd)](function(){var _0x442ca4=a20_0x101df8;$[_0x442ca4(0x238)]({'cache':![],'beforeSend':function(){var _0x110eb5=_0x442ca4;$(_0x110eb5(0x2ef))[_0x110eb5(0x263)]();},'success':function(_0x170d81){var _0x116b2f=_0x442ca4;AzureUsrlist=[],GetAzureUsrlist(AdusersUrl,token),excelRows=[];for(var _0x4cb3a9=0x0;_0x4cb3a9<AzureUsrlist[_0x116b2f(0x2ac)];_0x4cb3a9++){if(AzureUsrlist[_0x4cb3a9]['mail']!=null&&AzureUsrlist[_0x4cb3a9][_0x116b2f(0x253)]==!![]){if(AzureUsrlist[_0x4cb3a9][_0x116b2f(0x2b5)]!=_0x116b2f(0x2a9)){var _0x3b83a0=EmployeeListUsers[_0x116b2f(0x1c8)](function(_0x4f1e2c){var _0x5517a4=_0x116b2f;return _0x4f1e2c['Email'][_0x5517a4(0x2b4)]()==AzureUsrlist[_0x4cb3a9][_0x5517a4(0x2fa)][_0x5517a4(0x2b4)]();}),_0x43e2ec=AllCompanies[_0x116b2f(0x1c8)](function(_0x1ab820){var _0x44fa3f=_0x116b2f;if(AzureUsrlist[_0x4cb3a9]['companyName']!=null)return _0x1ab820[_0x44fa3f(0x1f5)][_0x44fa3f(0x2b4)]()==AzureUsrlist[_0x4cb3a9]['companyName'][_0x44fa3f(0x2b4)]();}),_0x41fa76=0x0;_0x43e2ec[_0x116b2f(0x2ac)]>0x0?_0x41fa76=_0x43e2ec[0x0]['Id']:_0x41fa76=parseInt(Logged_CompanyId);var _0xf74015=AllOfficeLocation[_0x116b2f(0x1c8)](function(_0x4b7f2c){var _0x18715f=_0x116b2f;if(AzureUsrlist[_0x4cb3a9][_0x18715f(0x23b)]!=null)return _0x4b7f2c['Title'][_0x18715f(0x2b4)]()==AzureUsrlist[_0x4cb3a9][_0x18715f(0x23b)][_0x18715f(0x2b4)]();}),_0x1ed4a4=0x0;_0xf74015[_0x116b2f(0x2ac)]>0x0&&(_0x1ed4a4=_0xf74015[0x0]['Id']);var _0x5be5cd=AllDepartments[_0x116b2f(0x1c8)](function(_0x3b8fad){var _0x5ce5cc=_0x116b2f;if(AzureUsrlist[_0x4cb3a9][_0x5ce5cc(0x1d9)]!=null)return _0x3b8fad[_0x5ce5cc(0x212)][_0x5ce5cc(0x2b4)]()==AzureUsrlist[_0x4cb3a9][_0x5ce5cc(0x1d9)]['toLowerCase']();}),_0x4debc7=0x0;_0x5be5cd['length']>0x0&&(_0x4debc7=_0x5be5cd[0x0]['Id']);var _0x22fd7a='',_0x27740b='';AzureUsrlist[_0x4cb3a9][_0x116b2f(0x2ca)]!=undefined&&(_0x22fd7a=AzureUsrlist[_0x4cb3a9][_0x116b2f(0x2ca)][_0x116b2f(0x2fa)]);AzureUsrlist[_0x4cb3a9][_0x116b2f(0x2bf)]!=undefined||AzureUsrlist[_0x4cb3a9]['employeeHireDate']!=null?(_0x27740b=new Date(AzureUsrlist[_0x4cb3a9][_0x116b2f(0x2bf)]),_0x27740b=$[_0x116b2f(0x2af)][_0x116b2f(0x2ec)](_0x116b2f(0x25c),_0x27740b)):(_0x27740b=new Date(),_0x27740b=$[_0x116b2f(0x2af)][_0x116b2f(0x2ec)](_0x116b2f(0x25c),_0x27740b));if(_0x3b83a0[_0x116b2f(0x2ac)]==0x0){var _0x253004=AzureUsrlist[_0x4cb3a9][_0x116b2f(0x201)]==_0x116b2f(0x2ee)?_0x116b2f(0x275):_0x116b2f(0x1f6);excelRows['push']({'Id':_0x4cb3a9,'Name':AzureUsrlist[_0x4cb3a9][_0x116b2f(0x1eb)],'Email':AzureUsrlist[_0x4cb3a9][_0x116b2f(0x2fa)],'Type':_0x253004,'Department':_0x4debc7,'Company':_0x41fa76,'DepartmentName':AzureUsrlist[_0x4cb3a9][_0x116b2f(0x1d9)],'CompanyName':AzureUsrlist[_0x4cb3a9][_0x116b2f(0x2d9)],'country':AzureUsrlist[_0x4cb3a9][_0x116b2f(0x2a4)],'DateOfJoining':_0x27740b,'employeeId':AzureUsrlist[_0x4cb3a9][_0x116b2f(0x2e9)],'Manager':_0x22fd7a,'postalCode':AzureUsrlist[_0x4cb3a9]['postalCode'],'state':AzureUsrlist[_0x4cb3a9][_0x116b2f(0x1e4)],'streetAddress':AzureUsrlist[_0x4cb3a9][_0x116b2f(0x2d7)],'city':AzureUsrlist[_0x4cb3a9][_0x116b2f(0x26b)],'mobilePhone':AzureUsrlist[_0x4cb3a9][_0x116b2f(0x21c)],'Location':_0x1ed4a4,'LocationName':AzureUsrlist[_0x4cb3a9][_0x116b2f(0x23b)],'otherMails':AzureUsrlist[_0x4cb3a9][_0x116b2f(0x1e0)][0x0],'Designation':AzureUsrlist[_0x4cb3a9]['jobTitle']});}}}}Ready=0x0,Error=0x0,lblUpdate=0x0,counusers=0x0,Exits=0x0,$(_0x116b2f(0x1ef))[_0x116b2f(0x211)](0x0),$('#Error')[_0x116b2f(0x211)](0x0),$(_0x116b2f(0x1f4))[_0x116b2f(0x211)](0x0),$(_0x116b2f(0x1cf))[_0x116b2f(0x211)](0x0),$(_0x116b2f(0x25a))['text'](0x0);for(var _0x4cb3a9=0x0;_0x4cb3a9<excelRows[_0x116b2f(0x2ac)];_0x4cb3a9++){var _0x274da0='',_0x4fd454=AzureUsrlist[_0x116b2f(0x1c8)](function(_0x4519cb){var _0xe681a3=_0x116b2f;if(_0x4519cb[_0xe681a3(0x2fa)]!=null){var _0x235d0f=_0x4519cb['mail'][_0xe681a3(0x2b4)]();return _0x235d0f==excelRows[_0x4cb3a9]['Email']['toLowerCase']();}});if(_0x4fd454[_0x116b2f(0x2ac)]>0x0){_0x274da0=_0x4fd454[0x0][_0x116b2f(0x1eb)];var _0x565fe0=AllCompanies[_0x116b2f(0x1c8)](function(_0x32d607){var _0x2acfca=_0x116b2f;return _0x32d607['ID']==excelRows[_0x4cb3a9][_0x2acfca(0x301)];}),_0x5af9a7=AllDepartments['filter'](function(_0xc072fa){return _0xc072fa['ID']==excelRows[_0x4cb3a9]['Department'];}),_0x2b0086=AllOfficeLocation[_0x116b2f(0x1c8)](function(_0x4cf26b){var _0x4e07eb=_0x116b2f;return _0x4cf26b['ID']==excelRows[_0x4cb3a9][_0x4e07eb(0x1fd)];});_0x565fe0[_0x116b2f(0x2ac)]>0x0&&_0x5af9a7[_0x116b2f(0x2ac)]>0x0&&_0x2b0086[_0x116b2f(0x2ac)]>0x0?(Ready=Ready+0x1,ErrorUser='Ready'):(ErrorUser=_0x116b2f(0x221),Error=Error+0x1);}else ErrorUser=_0x116b2f(0x2e0),color_red=_0x116b2f(0x305),Error=Error+0x1;excelRows[_0x4cb3a9][_0x116b2f(0x2d8)]=ErrorUser;}alluserdata=excelRows,LoadShowUser(excelRows),$('#overlaysearch')[_0x116b2f(0x267)]();}});});var Temparray=[];$('#btnFilter')[a20_0x101df8(0x2cd)](function(){var _0x5b49d3=a20_0x101df8;debugger;Temparray=alluserdata;let _0x8652f8=[...new Set(Temparray['map'](_0x3ab3f8=>_0x3ab3f8[_0x5b49d3(0x279)]))];var _0xc41568=document[_0x5b49d3(0x22a)]('ddlfilterAllCompanies');_0xc41568['innerHTML']='',opt['value']='0',opt[_0x5b49d3(0x211)]=_0x5b49d3(0x1f7),_0xc41568[_0x5b49d3(0x222)](opt);for(var _0x58be4b=0x0;_0x58be4b<_0x8652f8['length'];_0x58be4b++){opt=document['createElement'](_0x5b49d3(0x289)),opt[_0x5b49d3(0x2ed)]=_0x8652f8[_0x58be4b],opt[_0x5b49d3(0x211)]=_0x8652f8[_0x58be4b],_0xc41568[_0x5b49d3(0x222)](opt);}Temparray=alluserdata;var _0x23b973=[...new Set(Temparray[_0x5b49d3(0x2d5)](_0x4e9eee=>_0x4e9eee[_0x5b49d3(0x280)]))],_0xc41568=document[_0x5b49d3(0x22a)](_0x5b49d3(0x1df)),_0x331e93=_0x5b49d3(0x27c);for(var _0x58be4b=0x0;_0x58be4b<_0x23b973[_0x5b49d3(0x2ac)];_0x58be4b++){_0x331e93+=_0x5b49d3(0x294)+_0x23b973[_0x58be4b]+'\x22>'+_0x23b973[_0x58be4b]+_0x5b49d3(0x2ce);}$('#ddlfilterOfficeLocation')[_0x5b49d3(0x20c)](_0x331e93),Temparray=alluserdata;let _0x3cb81d=[...new Set(Temparray['map'](_0x12c4c6=>_0x12c4c6[_0x5b49d3(0x2a7)]))];var _0xc41568=document['getElementById'](_0x5b49d3(0x218));_0xc41568[_0x5b49d3(0x2db)]='',opt['value']='0',opt[_0x5b49d3(0x211)]='All',_0xc41568[_0x5b49d3(0x222)](opt);for(var _0x58be4b=0x0;_0x58be4b<_0x3cb81d[_0x5b49d3(0x2ac)];_0x58be4b++){opt=document[_0x5b49d3(0x277)]('option'),opt[_0x5b49d3(0x2ed)]=_0x3cb81d[_0x58be4b],opt[_0x5b49d3(0x211)]=_0x3cb81d[_0x58be4b],_0xc41568['appendChild'](opt);}}),$(a20_0x101df8(0x2c0))[a20_0x101df8(0x2cd)](function(){var _0x3dbfdb=a20_0x101df8;let _0x19fbb6;var _0x22895a='',_0x614167=!![];$(_0x3dbfdb(0x1e7))['val']()!='0'&&(_0x614167=![]);if($(_0x3dbfdb(0x1d8))[_0x3dbfdb(0x2c3)]()!='0')_0x614167=![];else return alert(_0x3dbfdb(0x2fd)),![];if($(_0x3dbfdb(0x21b))[_0x3dbfdb(0x2c3)]()!='0')_0x614167=![];else return alert('Please\x20select\x20Location'),![];_0x19fbb6=alluserdata[_0x3dbfdb(0x1c8)](function(_0x379416){var _0x131d35=_0x3dbfdb;return _0x379416[_0x131d35(0x1fd)]==$(_0x131d35(0x1f8),$(_0x131d35(0x21b)))[_0x131d35(0x2c3)]()&&_0x379416[_0x131d35(0x2a7)]==$(_0x131d35(0x1f8),$(_0x131d35(0x1d8)))[_0x131d35(0x2c3)]()&&_0x379416[_0x131d35(0x301)]==$('option:selected',$(_0x131d35(0x1e7)))['val']();});var _0x5f47e4=alluserdata[_0x3dbfdb(0x2b7)](_0x37a741=>_0x37a741['Location']===$(_0x3dbfdb(0x1f8),$('#ddlfilterOfficeLocation'))['val']()&&_0x37a741[_0x3dbfdb(0x2a7)]==$(_0x3dbfdb(0x1f8),$(_0x3dbfdb(0x1d8)))[_0x3dbfdb(0x2c3)]()&&_0x37a741[_0x3dbfdb(0x301)]==$(_0x3dbfdb(0x1f8),$('#ddlfilterAllCompanies'))[_0x3dbfdb(0x2c3)]());_0x614167?LoadShowUser(alluserdata):LoadShowUser(_0x19fbb6);}),$('.searching')[a20_0x101df8(0x24b)](function(_0x22be39){var _0x50c0eb=a20_0x101df8;LoadShowUser(search($(_0x50c0eb(0x1d5))['val']()));});function search(_0x31c52d){var _0x30e3c8=a20_0x101df8;return alluserdata[_0x30e3c8(0x1c8)](({Name:_0x3e949b,Email:_0x2104ec})=>{var _0x256b71=_0x30e3c8;return _0x3e949b['toLowerCase']()[_0x256b71(0x2e8)](_0x31c52d[_0x256b71(0x2b4)]())>-0x1||_0x2104ec[_0x256b71(0x2b4)]()[_0x256b71(0x2e8)](_0x31c52d[_0x256b71(0x2b4)]())>-0x1;});}$('#btnsubmitready')[a20_0x101df8(0x2cd)](function(){$['ajax']({'cache':![],'beforeSend':function(){var _0x13d3b9=a20_0x204c;$('#overlaysearch')[_0x13d3b9(0x263)]();},'success':function(_0x48e062){var _0x2e2d05=a20_0x204c;AddedEmployeeList=[],SubmitReady(),$(_0x2e2d05(0x2ef))['fadeOut']();}});});function SubmitReady(){var _0x44cbf7=a20_0x101df8;if(contributersGroupId!==''){var _0x91e4a8=tabledata[_0x44cbf7(0x2b9)]();counusers=0x0,IsaddedNewEmployee=![];for(var _0x45489e=0x0;_0x45489e<_0x91e4a8[_0x44cbf7(0x2ac)];_0x45489e++){var _0x3a93b6=alluserdata[_0x44cbf7(0x1c8)](function(_0x13189e){var _0x2f4f89=_0x44cbf7;return _0x13189e['Email']==_0x91e4a8[_0x45489e][_0x2f4f89(0x25e)][_0x2f4f89(0x21e)][_0x2f4f89(0x2e1)];});if(AvilableLicenses>0x0)_0x3a93b6[0x0][_0x44cbf7(0x2d8)]==_0x44cbf7(0x299)?IsaddedNewEmployee=AddNewEmployeeAllocated(_0x3a93b6,'Employees'):_0x3a93b6[0x0]['Status']=='Already\x20Exist'&&UpdateExistingEmployeeAllocated(_0x3a93b6,'Employees');else return alert(_0x44cbf7(0x2d3)),![];}warningmessage!=''&&(warningmessage+=userfullname,alert(warningmessage)),$(_0x44cbf7(0x1f4))[_0x44cbf7(0x211)](counusers),showmessage(),tabledata[_0x44cbf7(0x207)](excelRows),tabledata['setPage'](pageIndex),IsaddedNewEmployee&&($('#successfully_notifications')[_0x44cbf7(0x2b0)]({'backdrop':_0x44cbf7(0x2f2),'keyboard':![]},_0x44cbf7(0x2ff)),AddedEmployeeList[_0x44cbf7(0x2ac)]>0x0?$('#divAudience')[_0x44cbf7(0x2ff)]():$(_0x44cbf7(0x1ce))['hide']());}else GetGroupIDByGroupName(),GetSelectItem();}$(a20_0x101df8(0x2c1))['on'](a20_0x101df8(0x2cd),function(){var _0x27964b=a20_0x101df8;$[_0x27964b(0x238)]({'cache':![],'beforeSend':function(){var _0x301151=_0x27964b;$(_0x301151(0x2ef))[_0x301151(0x263)]();},'success':function(_0x4b50af){var _0x464c4f=_0x27964b;if(AddedEmployeeList[_0x464c4f(0x2ac)]>0x0&&checkedAudience!=_0x464c4f(0x230))for(var _0x43d37c=0x0;_0x43d37c<AddedEmployeeList[_0x464c4f(0x2ac)];_0x43d37c++){var _0x5af765=new Date(AddedEmployeeList[_0x43d37c]['Metadata'][_0x464c4f(0x265)]),_0x56fca8=new Date();_0x56fca8[_0x464c4f(0x2bd)](_0x5af765[_0x464c4f(0x28b)]()+0x3),_0x5af765=$[_0x464c4f(0x2af)][_0x464c4f(0x2ec)](_0x464c4f(0x25c),_0x5af765),_0x56fca8=$[_0x464c4f(0x2af)][_0x464c4f(0x2ec)](_0x464c4f(0x25c),_0x56fca8);var _0x21b74e=new Date(AddedEmployeeList[_0x43d37c][_0x464c4f(0x1d1)][_0x464c4f(0x265)]);_0x21b74e=$[_0x464c4f(0x2af)]['formatDate'](_0x464c4f(0x219),_0x21b74e);var _0x39b59d=[],_0x48ce0b=[],_0x13957b=[];_0x13957b[_0x464c4f(0x213)](Logged_CompanyId);var _0x314444;_0x314444={'__metadata':{'type':'SP.Data.AnnouncementsListItem'}},(_0x314444[_0x464c4f(0x2e6)]='Welcome',_0x314444[_0x464c4f(0x206)]=AddedEmployeeList[_0x43d37c][_0x464c4f(0x2cb)][_0x464c4f(0x225)](),_0x314444[_0x464c4f(0x212)]=_0x464c4f(0x23d),_0x314444[_0x464c4f(0x30c)]=AddedEmployeeList[_0x43d37c]['Metadata'][_0x464c4f(0x25f)],_0x314444[_0x464c4f(0x2d1)]=AddedEmployeeList[_0x43d37c][_0x464c4f(0x1d1)][_0x464c4f(0x2d1)],_0x314444[_0x464c4f(0x2a7)]=AddedEmployeeList[_0x43d37c][_0x464c4f(0x22d)],_0x314444['OfficeLocation']=AddedEmployeeList[_0x43d37c]['EmployeeOfficeLocation'],_0x314444['UserType']=_0x464c4f(0x1e6),_0x314444['WebPartName']=_0x464c4f(0x2f9),_0x314444[_0x464c4f(0x288)]=checkedAudience,_0x314444['ApprovalStatus']=_0x464c4f(0x20b),_0x314444[_0x464c4f(0x2b8)]=_0x5af765,_0x314444[_0x464c4f(0x309)]=_0x56fca8,_0x314444[_0x464c4f(0x2fe)]=_0x464c4f(0x1cc)+_0x21b74e);if(checkedAudience==_0x464c4f(0x252))_0x13957b=[0x0],_0x39b59d=[0x0],_0x48ce0b=[0x0],_0x314444['CompanyId']={'results':_0x13957b},_0x314444['DepartmentsId']={'results':_0x48ce0b},_0x314444[_0x464c4f(0x2fb)]={'results':_0x39b59d};else{if(checkedAudience==_0x464c4f(0x301))_0x13957b['push'](AddedEmployeeList[_0x43d37c][_0x464c4f(0x1d1)][_0x464c4f(0x2b6)]),_0x39b59d=[0x0],_0x48ce0b=[0x0],_0x314444[_0x464c4f(0x2b6)]={'results':_0x13957b},_0x314444['DepartmentsId']={'results':_0x48ce0b},_0x314444[_0x464c4f(0x2fb)]={'results':_0x39b59d};else{if(checkedAudience==_0x464c4f(0x2a7))_0x13957b=[0x0],_0x39b59d=[0x0],_0x48ce0b[_0x464c4f(0x213)](AddedEmployeeList[_0x43d37c][_0x464c4f(0x1d1)][_0x464c4f(0x1f0)]),_0x314444[_0x464c4f(0x2b6)]={'results':_0x13957b},_0x314444['DepartmentsId']={'results':_0x48ce0b},_0x314444['OfficeLocationsId']={'results':_0x39b59d};else checkedAudience=='Location'&&(_0x13957b=[0x0],_0x39b59d[_0x464c4f(0x213)](AddedEmployeeList[_0x43d37c][_0x464c4f(0x1d1)][_0x464c4f(0x2f4)]),_0x48ce0b=[0x0],_0x314444['CompanyId']={'results':_0x13957b},_0x314444['DepartmentsId']={'results':_0x48ce0b},_0x314444[_0x464c4f(0x2fb)]={'results':_0x39b59d});}}InsertWelcomeInAnnouncementList(_0x314444);}$(_0x464c4f(0x2ef))['fadeOut']();}});}),$(a20_0x101df8(0x21f))[a20_0x101df8(0x30a)](function(){var _0x4a3b1d=a20_0x101df8;checkedAudience=this[_0x4a3b1d(0x2ed)];});function isReadeySelecteds(){var _0x4137c5=a20_0x101df8;isReadeySelect=document['getElementById'](_0x4137c5(0x243));if(isReadeySelect[_0x4137c5(0x1dc)]){tabledata[_0x4137c5(0x1dd)](MiisingSelected),$(_0x4137c5(0x24d))['prop'](_0x4137c5(0x1dc),![]),$(_0x4137c5(0x2be))[_0x4137c5(0x2f0)](_0x4137c5(0x1dc),![]),ReadySelected=[];for(var _0x5e67f7=0x0;_0x5e67f7<excelRows[_0x4137c5(0x2ac)];_0x5e67f7++){(excelRows[_0x5e67f7]['Status']==_0x4137c5(0x299)||excelRows[_0x5e67f7][_0x4137c5(0x2d8)]==_0x4137c5(0x1e2))&&ReadySelected[_0x4137c5(0x213)](_0x5e67f7);}$(_0x4137c5(0x303))[_0x4137c5(0x2f0)](_0x4137c5(0x1dc),!![]),tabledata[_0x4137c5(0x21d)](ReadySelected);}else tabledata[_0x4137c5(0x1dd)](ReadySelected),$(_0x4137c5(0x303))[_0x4137c5(0x2f0)](_0x4137c5(0x1dc),![]);}function IsMiisingSelecteds(){var _0x2e2baa=a20_0x101df8;IsMiisingSelect=document[_0x2e2baa(0x22a)](_0x2e2baa(0x236));if(IsMiisingSelect[_0x2e2baa(0x1dc)]){tabledata[_0x2e2baa(0x1dd)](ReadySelected),$(_0x2e2baa(0x2e3))['prop'](_0x2e2baa(0x1dc),![]),$('.select-row_isReadeySelected')[_0x2e2baa(0x2f0)]('checked',![]),MiisingSelected=[];for(var _0x1084d4=0x0;_0x1084d4<excelRows[_0x2e2baa(0x2ac)];_0x1084d4++){(excelRows[_0x1084d4]['Status']==_0x2e2baa(0x221)||excelRows[_0x1084d4]['Status']==_0x2e2baa(0x1e2)||excelRows[_0x1084d4]['Status']=='Ready')&&(MiisingSelected[_0x2e2baa(0x213)](_0x1084d4),$(_0x2e2baa(0x24d))['prop'](_0x2e2baa(0x1dc),!![]));}tabledata[_0x2e2baa(0x21d)](MiisingSelected);}else tabledata[_0x2e2baa(0x1dd)](MiisingSelected),$(_0x2e2baa(0x24d))[_0x2e2baa(0x2f0)](_0x2e2baa(0x1dc),![]);}function AssignPermissiononDMSLibary(_0x15b231,_0x177833,_0xcfebc6){var _0x1e3f53=a20_0x101df8,_0x214340={'Accept':_0x1e3f53(0x237),'content-Type':_0x1e3f53(0x237),'X-RequestDigest':jQuery('#__REQUESTDIGEST')[_0x1e3f53(0x2c3)]()},_0x59db5c=_0xcfebc6+_0x1e3f53(0x2ea)+_0x15b231+',roleDefId='+_0x177833+')';$['ajax']({'url':_0x59db5c,'type':'POST','headers':_0x214340,'dataType':_0x1e3f53(0x242),'async':![],'success':function(_0x1b58a1){console['log']('User\x20has\x20been\x20assigned\x20permission\x20.');},'error':function(_0x130f72){var _0xcc44a2=_0x1e3f53;console[_0xcc44a2(0x202)](JSON['stringify'](_0x130f72)),Permissionloder[_0xcc44a2(0x1fb)]();}});}function GetGroupIDByGroupName(){var _0x15c3d3=a20_0x101df8,_0x32555b=_spPageContextInfo[_0x15c3d3(0x2a8)]+_0x15c3d3(0x254);$[_0x15c3d3(0x238)]({'url':_0x32555b,'method':_0x15c3d3(0x25d),'async':![],'headers':{'Accept':_0x15c3d3(0x246)},'success':function(_0xf3e5d5){contributersGroupId=_0xf3e5d5['d']['Id'];},'error':function(_0x5afc3d){var _0x4a916e=_0x15c3d3;console[_0x4a916e(0x202)](_0x5afc3d);}});}function GetListItems(_0x268c51,_0x2d20d8){var _0x227ff5=a20_0x101df8,_0x5814d5,_0x425308=_spPageContextInfo[_0x227ff5(0x2a8)]+'/_api/web/lists/getByTitle(\x27'+_0x268c51+_0x227ff5(0x2de)+_0x2d20d8+_0x227ff5(0x1ed);return $[_0x227ff5(0x238)]({'url':_0x425308,'method':_0x227ff5(0x25d),'async':![],'headers':{'Accept':'application/json;\x20odata=verbose'},'success':function(_0x796978){var _0x4e5575=_0x227ff5;_0x796978['d'][_0x4e5575(0x1db)][_0x4e5575(0x2ac)]>0x0?_0x5814d5=![]:_0x5814d5=!![];},'error':function(_0xa7a968){var _0x1e978a=_0x227ff5;console[_0x1e978a(0x202)](_0xa7a968);}}),_0x5814d5;}function GetCompanies(){var _0x4e83d2=a20_0x101df8,_0x104dba=_spPageContextInfo[_0x4e83d2(0x2a8)]+'/_api/web/lists/getByTitle(\x27Companies\x27)/items?$select=*';$['ajax']({'url':_0x104dba,'method':_0x4e83d2(0x25d),'async':![],'headers':{'Accept':_0x4e83d2(0x246)},'success':function(_0x255952){var _0x21ab04=_0x4e83d2;AllCompanies=_0x255952['d'][_0x21ab04(0x1db)];},'error':function(_0x4b5a98){var _0x5cd3ae=_0x4e83d2;console[_0x5cd3ae(0x202)](_0x4b5a98);}});}function GetDepartments(){var _0x76f0f3=a20_0x101df8,_0x3c196f=_spPageContextInfo['webAbsoluteUrl']+_0x76f0f3(0x27f);$[_0x76f0f3(0x238)]({'url':_0x3c196f,'method':_0x76f0f3(0x25d),'async':![],'headers':{'Accept':_0x76f0f3(0x246)},'success':function(_0x5e2e5d){var _0x3b4099=_0x76f0f3;AllDepartments=_0x5e2e5d['d'][_0x3b4099(0x1db)];},'error':function(_0x31e76d){var _0x938db6=_0x76f0f3;console[_0x938db6(0x202)](_0x31e76d);}});}function GetOfficeLocation(){var _0x376189=a20_0x101df8,_0x4d6e82=_spPageContextInfo[_0x376189(0x2a8)]+_0x376189(0x22b);$[_0x376189(0x238)]({'url':_0x4d6e82,'method':_0x376189(0x25d),'async':![],'headers':{'Accept':_0x376189(0x246)},'success':function(_0x1450e8){AllOfficeLocation=_0x1450e8['d']['results'];},'error':function(_0xaf6914){var _0x3c7953=_0x376189;console[_0x3c7953(0x202)](_0xaf6914);}});}function GetSubSiteUrl(_0x112a41,_0x4c70f1){var _0x208d6d=a20_0x101df8,_0x30d3d2,_0x16245c=_spPageContextInfo[_0x208d6d(0x2a8)]+_0x208d6d(0x240)+_0x112a41+_0x208d6d(0x2cf)+_0x4c70f1+_0x208d6d(0x1ed);return $[_0x208d6d(0x238)]({'url':_0x16245c,'method':'GET','async':![],'headers':{'Accept':_0x208d6d(0x246)},'success':function(_0x21d379){var _0x5371ba=_0x208d6d;_0x30d3d2=_0x21d379['d']['results'][0x0][_0x5371ba(0x1d0)];},'error':function(_0x39a643){var _0x27b64e=_0x208d6d;console[_0x27b64e(0x202)](_0x39a643);}}),_0x30d3d2;}function AddUserinSharePointGroup(_0xd6e727){var _0x57f194=a20_0x101df8,_0x41fbdd=$[_0x57f194(0x1e1)](),_0x44b2f7=_0x57f194(0x2b2),_0xf4f320=_0x44b2f7+_0xd6e727,_0x461de0=_spPageContextInfo[_0x57f194(0x2a8)]+_0x57f194(0x271)+contributersGroupId+_0x57f194(0x22f);$[_0x57f194(0x238)]({'url':_0x461de0,'type':_0x57f194(0x250),'async':![],'data':JSON[_0x57f194(0x1fa)]({'__metadata':{'type':_0x57f194(0x29c)},'LoginName':_0xf4f320}),'headers':{'accept':_0x57f194(0x237),'content-type':_0x57f194(0x237),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x57f194(0x2c3)]()},'success':_0x36e247,'error':_0x4e37e9});function _0x36e247(_0x1d1be3){var _0x35c945=_0x57f194;_0x41fbdd[_0x35c945(0x22e)](_0x1d1be3['d']['Id']),console[_0x35c945(0x202)](_0x35c945(0x2c9));}function _0x4e37e9(_0x3dba73){var _0x4a2e93=_0x57f194;console[_0x4a2e93(0x202)](JSON[_0x4a2e93(0x1fa)](_0x3dba73));}return _0x41fbdd[_0x57f194(0x1d7)]();}function GetUserId(_0x2bfb42){var _0x13d2cf=a20_0x101df8,_0xbb5846='',_0x57438c=_0x13d2cf(0x2b2),_0x582c4c=_spPageContextInfo[_0x13d2cf(0x26a)],_0x2a8507=_0x57438c+_0x2bfb42;return $[_0x13d2cf(0x238)]({'url':_0x582c4c+'/_api/web/siteusers(@v)?@v=\x27'+encodeURIComponent(_0x2a8507)+'\x27','method':_0x13d2cf(0x25d),'headers':{'Accept':_0x13d2cf(0x246)},'async':![],'success':function(_0x4fcea7){_0xbb5846=_0x4fcea7['d']['Id'];},'error':function(_0x5c6cb9){var _0x2f46cd=_0x13d2cf;console[_0x2f46cd(0x202)](JSON[_0x2f46cd(0x1fa)](_0x5c6cb9));}}),_0xbb5846;}var GetAllGroupsUser=[],GroupUrl=_spPageContextInfo[a20_0x101df8(0x26a)]+'/_api/web/siteusers?$top=1000&$select=*,Id';function GetAllUserId(){var _0x46570d=a20_0x101df8;$['ajax']({'url':GroupUrl,'method':_0x46570d(0x25d),'headers':{'Accept':_0x46570d(0x246)},'async':![],'success':function(_0x13eaaf){var _0x3c1401=_0x46570d;GetAllGroupsUser=GetAllGroupsUser['concat'](_0x13eaaf['d']['results']),_0x13eaaf['d'][_0x3c1401(0x1c5)]!=null&&(GroupUrl=_0x13eaaf['d']['__next'],GetAllUserId());},'error':function(_0x64e24d){var _0x3d7a4f=_0x46570d;console['log'](JSON[_0x3d7a4f(0x1fa)](_0x64e24d));}});}var LoginName;function UpdateExistingEmployeeAllocated(_0x478a38,_0x19b0aa){var _0x316668=a20_0x101df8;try{UserEmailId=_0x478a38[0x0][_0x316668(0x2e1)],LoginName=_0x316668(0x2b2)+_0x478a38[0x0][_0x316668(0x2e1)];var _0x38cc45,_0x1da885,_0xf8cb28=GetAllGroupsUser[_0x316668(0x1c8)](function(_0xa5c967){var _0x45d4c3=_0x316668;return _0xa5c967['Email'][_0x45d4c3(0x2b4)]()==_0x478a38[0x0][_0x45d4c3(0x2e1)][_0x45d4c3(0x2b4)]();});if(_0xf8cb28[_0x316668(0x2ac)]>0x0)var _0xab1bb9=_0xf8cb28[0x0]['Id'];else{}if(TopExecutive=='Chief\x20Executive'||_0x478a38[0x0]['Manager']==undefined)_0x478a38[0x0][_0x316668(0x2e7)]=_0x316668(0x258),_0x38cc45=-0x1;else{var _0x206ce2=EmployeeListUsers[_0x316668(0x1c8)](function(_0xa609d5){var _0x368847=_0x316668,_0x3be04d;if(_0xa609d5[_0x368847(0x284)]!=null)return _0x3be04d=_0xa609d5[_0x368847(0x2e1)][_0x368847(0x2b4)](),_0x3be04d==_0x478a38[0x0][_0x368847(0x284)]['toLowerCase']();});if(_0x206ce2[_0x316668(0x2ac)]>0x0){_0x1da885=_0x206ce2[0x0][_0x316668(0x25f)];var _0xf8cb28=GetAllGroupsUser[_0x316668(0x1c8)](function(_0x13698d){var _0x490223=_0x316668;return _0x13698d[_0x490223(0x2e1)][_0x490223(0x2b4)]()==_0x478a38[0x0][_0x490223(0x284)][_0x490223(0x2b4)]();});if(_0xf8cb28[_0x316668(0x2ac)]>0x0)_0x38cc45=_0xf8cb28[0x0]['Id'];else{}}else{IsManager=![],_0x38cc45='';var _0x797c99=excelRows[_0x316668(0x24c)](_0x48bd0b=>_0x48bd0b[_0x316668(0x2e1)][_0x316668(0x2b4)]()==_0x478a38[0x0]['Email'][_0x316668(0x2b4)]());excelRows[_0x797c99][_0x316668(0x2d8)]=_0x316668(0x1e8);}}var _0x5a41dc,_0x44c99d=GetItemTypeForListName(_0x19b0aa);_0x5a41dc={'__metadata':{'type':_0x44c99d},'Designation':_0x478a38[0x0][_0x316668(0x2d1)],'GroupName':_0x478a38[0x0]['Group\x20Name'],'Manager':_0x1da885,'ManagerLoginNameId':_0x38cc45},$[_0x316668(0x2cc)](updateItemExitUser(_0x19b0aa,_0x5a41dc,_0x478a38[0x0][_0x316668(0x1f2)]))[_0x316668(0x200)](function(_0x2d256c){var _0x1e984d=_0x316668,_0x28d284=_0x2d256c;if(_0x28d284){lblUpdate=lblUpdate+0x1,Exits=Exits-0x1;var _0x2ce0fc=excelRows['findIndex'](_0x4aa12b=>_0x4aa12b['Email']==UserEmailId);excelRows[_0x2ce0fc][_0x1e984d(0x2d8)]=_0x1e984d(0x2c8),showmessage();}});}catch(_0x417f34){console[_0x316668(0x202)](_0x417f34[_0x316668(0x23c)]);}}var IsManager=!![];function AddNewEmployeeAllocated(_0xadd62f,_0x2f9166){var _0x21c45c=a20_0x101df8,_0x20b85d=![];try{var _0x1b2791=AllCompanies[_0x21c45c(0x1c8)](function(_0x44c40a){var _0x488743=_0x21c45c;return _0x44c40a['ID']==parseInt(_0xadd62f[0x0][_0x488743(0x301)]);});if(!(_0x1b2791[_0x21c45c(0x2ac)]>0x0))return alert('Company\x20Id\x20is\x20not\x20Correct'),_0x20b85d=![],![];var _0x1d3f72=AllDepartments['filter'](function(_0x507374){var _0x3faef8=_0x21c45c;return _0x507374['ID']==parseInt(_0xadd62f[0x0][_0x3faef8(0x2a7)]);});if(!(_0x1d3f72[_0x21c45c(0x2ac)]>0x0))return alert('Department\x20Id\x20is\x20not\x20Correct'),_0x20b85d=![],![];var _0x3e2a52=AllOfficeLocation[_0x21c45c(0x1c8)](function(_0x169bbd){return _0x169bbd['ID']==parseInt(_0xadd62f[0x0]['Location']);});if(!(_0x3e2a52[_0x21c45c(0x2ac)]>0x0))return alert(_0x21c45c(0x2f8)),_0x20b85d=![],![];if(_0x1b2791['length']>0x0&&_0x1d3f72[_0x21c45c(0x2ac)]>0x0&&_0x3e2a52[_0x21c45c(0x2ac)]>0x0){EmployeeDepartment=_0x1d3f72[0x0][_0x21c45c(0x235)],EmployeeOfficeLocation=_0x3e2a52[0x0][_0x21c45c(0x210)],LoginName=_0xadd62f[0x0][_0x21c45c(0x2e1)][_0x21c45c(0x2b4)]();var _0x4f67e2,_0x2ca404,_0x3f2e90=GetAllGroupsUser[_0x21c45c(0x1c8)](function(_0x2c29a2){var _0x1d6f76=_0x21c45c;return _0x2c29a2['Email'][_0x1d6f76(0x2b4)]()==_0xadd62f[0x0][_0x1d6f76(0x2e1)][_0x1d6f76(0x2b4)]();}),_0x17c7ef;if(_0x3f2e90['length']>0x0)var _0x17c7ef=_0x3f2e90[0x0]['Id'];else $['when'](AddUserinSharePointGroup(LoginName))[_0x21c45c(0x200)](function(_0x57f1c2){_0x17c7ef=_0x57f1c2;});if(TopExecutive=='Chief\x20Executive'||_0xadd62f[0x0]['Manager']==undefined)_0xadd62f[0x0][_0x21c45c(0x2e7)]='Chief\x20Executive',_0x4f67e2=-0x1;else{var _0xd340eb=EmployeeListUsers[_0x21c45c(0x1c8)](function(_0x5a3a11){var _0x448a4c=_0x21c45c,_0x7de2f1;if(_0x5a3a11['Email']!=null)return _0x7de2f1=_0x5a3a11[_0x448a4c(0x2e1)]['toLowerCase'](),_0x7de2f1==_0xadd62f[0x0][_0x448a4c(0x284)][_0x448a4c(0x2b4)]();});if(_0xd340eb['length']>0x0){_0x2ca404=_0xd340eb[0x0][_0x21c45c(0x25f)];var _0x3f2e90=GetAllGroupsUser['filter'](function(_0x1f8740){var _0xa4e63a=_0x21c45c;return _0x1f8740[_0xa4e63a(0x2e1)][_0xa4e63a(0x2b4)]()==_0xadd62f[0x0][_0xa4e63a(0x284)][_0xa4e63a(0x2b4)]();});_0x3f2e90[_0x21c45c(0x2ac)]>0x0?_0x4f67e2=_0x3f2e90[0x0]['Id']:_0x4f67e2=AddUserinSharePointGroup(_0xadd62f[0x0][_0x21c45c(0x284)][_0x21c45c(0x2b4)]());}else{IsManager=![],_0x4f67e2='';var _0x315022=excelRows['findIndex'](_0x519f17=>_0x519f17[_0x21c45c(0x2e1)][_0x21c45c(0x2b4)]()==LoginName);excelRows[_0x315022][_0x21c45c(0x2d8)]='Wrong\x20Manager';}}var _0x23dd52,_0x16a799=GetItemTypeForListName(_0x2f9166);_0x23dd52={'__metadata':{'type':_0x16a799},'CompanyId':parseInt(_0xadd62f[0x0][_0x21c45c(0x301)]),'DepartmentId':parseInt(_0xadd62f[0x0][_0x21c45c(0x2a7)]),'FullName':_0xadd62f[0x0][_0x21c45c(0x20d)],'Title':_0xadd62f[0x0][_0x21c45c(0x20d)],'ParentId':'-1','Email':_0xadd62f[0x0][_0x21c45c(0x2e1)],'LogonNameId':_0x17c7ef,'Manager':_0xadd62f[0x0][_0x21c45c(0x284)],'ManagerLoginNameId':_0x4f67e2,'OfficeLocationId':parseInt(_0xadd62f[0x0]['Location']),'MobileNumber':_0xadd62f[0x0]['mobilePhone'],'DateOfBirth':_0xadd62f[0x0][_0x21c45c(0x259)],'Gender':_0xadd62f[0x0][_0x21c45c(0x292)],'DateOfAnniversary':_0xadd62f[0x0][_0x21c45c(0x2a0)],'JoiningDate':_0xadd62f[0x0][_0x21c45c(0x1c4)],'Designation':_0xadd62f[0x0][_0x21c45c(0x2d1)],'PrimaryCompany':_0x21c45c(0x29f),'EmployeeID':_0xadd62f[0x0][_0x21c45c(0x2e9)],'GroupName':_0xadd62f[0x0][_0x21c45c(0x1ec)],'Status':'Active','PostalAddresses':_0xadd62f[0x0]['postalCode'],'City':_0xadd62f[0x0]['city'],'StateProvince':_0xadd62f[0x0]['state'],'ZIPPostalCode':_0xadd62f[0x0][_0x21c45c(0x228)],'Country':_0xadd62f[0x0][_0x21c45c(0x2a4)],'HomePhone':_0xadd62f[0x0][_0x21c45c(0x21c)],'OtherEMailAddress':_0xadd62f[0x0]['otherMails'],'HomeAddress':_0xadd62f[0x0][_0x21c45c(0x2da)]},AddItemToList(_0x2f9166,_0x23dd52);var _0x316e73=new Date(),_0x322ad0=new Date(_0xadd62f[0x0][_0x21c45c(0x1c4)]),_0x205c9d=daysDifference(_0x322ad0,_0x316e73);_0x205c9d<=0xf&&AddedEmployeeList[_0x21c45c(0x213)]({'Metadata':_0x23dd52,'EmployeeId':_0xadd62f[0x0][_0x21c45c(0x2e9)],'EmployeeOfficeLocation':EmployeeOfficeLocation,'EmployeeDepartment':EmployeeDepartment}),_0x20b85d=!![];}}catch(_0xc82145){console[_0x21c45c(0x202)](_0xc82145['message']);}return _0x20b85d;}function daysDifference(_0x93e72,_0x56d0a1){var _0x27512d=a20_0x101df8,_0x5af479=new Date(+_0x56d0a1)[_0x27512d(0x304)](0xc)-new Date(+_0x93e72)[_0x27512d(0x304)](0xc);return Math[_0x27512d(0x278)](_0x5af479/0x5265c00);}function updateItemExitUser(_0x1a12a5,_0x5b4342,_0x5752ff){var _0x4f39ca=a20_0x101df8,_0x248961=$[_0x4f39ca(0x1e1)]();return $[_0x4f39ca(0x238)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x4f39ca(0x308)+_0x1a12a5+_0x4f39ca(0x1c9)+_0x5752ff+'\x27)','type':_0x4f39ca(0x250),'headers':{'accept':_0x4f39ca(0x237),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x4f39ca(0x2c3)](),'content-Type':'application/json;odata=verbose','X-Http-Method':'PATCH','If-Match':'*'},'data':JSON[_0x4f39ca(0x1fa)](_0x5b4342),'async':![],'success':function(_0x2d6e36){var _0x18fd76=_0x4f39ca;_0x248961[_0x18fd76(0x22e)](!![]);},'error':function(_0x43a114){_0x248961['reject'](_0x43a114);}}),_0x248961[_0x4f39ca(0x1d7)]();}function AddItemToList(_0x197df1,_0x2fffa9){var _0x52fb81=a20_0x101df8;UserEmailId=_0x2fffa9[_0x52fb81(0x2e1)];var _0x437411=_0x2fffa9[_0x52fb81(0x25f)],_0x22d7e3=$[_0x52fb81(0x1e1)]();return $[_0x52fb81(0x238)]({'url':_spPageContextInfo[_0x52fb81(0x2a8)]+_0x52fb81(0x308)+_0x197df1+_0x52fb81(0x28f),'type':_0x52fb81(0x250),'async':![],'headers':{'accept':_0x52fb81(0x237),'X-RequestDigest':$(_0x52fb81(0x2ad))[_0x52fb81(0x2c3)](),'content-Type':_0x52fb81(0x237)},'data':JSON[_0x52fb81(0x1fa)](_0x2fffa9),'success':function(_0x160de7){var _0x5245c5=_0x52fb81;counusers=counusers+0x1,AvilableLicenses=AvilableLicenses-0x1,Ready=Ready-0x1;var _0x41ab6a=excelRows['findIndex'](_0x5f5834=>_0x5f5834['Email']==UserEmailId);excelRows[_0x41ab6a][_0x5245c5(0x2d8)]=_0x5245c5(0x27e),showmessage();var _0x1cb329=GetSubSiteUrl(_0x5245c5(0x2dd),_0x160de7['d'][_0x5245c5(0x1f0)]);AssignPermissiononDMSLibary(_0x160de7['d'][_0x5245c5(0x306)],_0x5245c5(0x24f),_0x1cb329),_0x22d7e3[_0x5245c5(0x22e)](_0x160de7);},'error':function(_0x4fe27a){var _0x23f22f=_0x52fb81;if(IsManager){var _0x5c6075=excelRows[_0x23f22f(0x24c)](_0x55edd4=>_0x55edd4[_0x23f22f(0x2e1)]==UserEmailId);excelRows[_0x5c6075][_0x23f22f(0x2d8)]=_0x23f22f(0x1d2);}userfullname==''?(userfullname+=_0x437411,warningmessage=_0x23f22f(0x204)):userfullname+=_0x23f22f(0x2ab)+_0x437411,Ready=Ready-0x1,Error=Error+0x1,console['log'](JSON['stringify'](_0x4fe27a)),_0x22d7e3[_0x23f22f(0x29d)](JSON[_0x23f22f(0x1fa)](_0x4fe27a));}}),_0x22d7e3['promise']();}function LoadShowUser(_0xed114e){var _0x59b218=a20_0x101df8;tabledata=new Tabulator(_0x59b218(0x2f3),{'height':'','pagination':_0x59b218(0x24a),'paginationSize':0xa,'layout':_0x59b218(0x28c),'paginationSizeSelector':[0xa,0x19,0x32,0x64],'placeholder':_0x59b218(0x270),'data':_0xed114e,'pageLoaded':function(_0x3bdfba){var _0x202a26=_0x59b218;_0x3bdfba>=0x1?pageIndex=_0x3bdfba:pageIndex=_0x3bdfba,IsMiisingSelect=document['getElementById'](_0x202a26(0x236)),IsMiisingSelect[_0x202a26(0x1dc)]&&$(_0x202a26(0x24d))[_0x202a26(0x2f0)](_0x202a26(0x1dc),!![]),isReadeySelect=document[_0x202a26(0x22a)](_0x202a26(0x243)),isReadeySelect[_0x202a26(0x1dc)]&&$('.select-row_isReadeySelected')[_0x202a26(0x2f0)](_0x202a26(0x1dc),!![]);},'columns':[{'formatter':function(_0x35ac74,_0x5ec83d){var _0x837a77=_0x59b218,_0x3700f5=_0x35ac74[_0x837a77(0x2a6)][_0x837a77(0x290)][_0x837a77(0x21e)][_0x837a77(0x2d8)];return _0x3700f5==_0x837a77(0x2e0)||_0x3700f5==_0x837a77(0x221)||_0x3700f5=='Added'||_0x3700f5==_0x837a77(0x2c8)?_0x837a77(0x208):'<input\x20type=\x22checkbox\x22\x20class=\x22select-row_isReadeySelected\x22\x20aria-label=\x22select\x20this\x20row\x22\x20/>';},'title':_0x59b218(0x239),'field':'ID','width':'1%','headerSort':![],'cellClick':function(_0xbe53a0,_0x1c2b63){var _0x134b78=_0x59b218,_0x552826=$(_0x1c2b63[_0x134b78(0x249)]()),_0x225237=_0x552826['find']('.select-row_isReadeySelected');_0x225237[0x0][_0x134b78(0x1dc)]==![]&&$(_0x1c2b63['getRow']()[_0x134b78(0x249)]())[_0x134b78(0x2b7)](_0x134b78(0x24d))[0x0][_0x134b78(0x1dc)]==![]?_0x1c2b63[_0x134b78(0x287)]()[_0x134b78(0x302)]():_0x1c2b63[_0x134b78(0x287)]()[_0x134b78(0x244)]();}},{'formatter':function(_0x3d15de,_0x522792){var _0x13f882=_0x59b218,_0x3ff0d5=_0x3d15de[_0x13f882(0x2a6)][_0x13f882(0x290)][_0x13f882(0x21e)][_0x13f882(0x2d8)];return _0x3ff0d5==_0x13f882(0x221)||_0x3ff0d5==_0x13f882(0x1e2)||_0x3ff0d5==_0x13f882(0x299)?_0x13f882(0x26d):_0x13f882(0x208);},'title':_0x59b218(0x1ca),'hozAlign':_0x59b218(0x1fe),'field':'ID','headerSort':![],'width':'1%','cellClick':function(_0x23382d,_0x472a9d){var _0x3a93ff=_0x59b218,_0x53f652=$(_0x472a9d[_0x3a93ff(0x249)]()),_0x2bde8d=_0x53f652[_0x3a93ff(0x2b7)](_0x3a93ff(0x24d));_0x2bde8d[0x0][_0x3a93ff(0x1dc)]==![]?_0x472a9d[_0x3a93ff(0x287)]()['deselect']():_0x472a9d[_0x3a93ff(0x287)]()[_0x3a93ff(0x244)]();}},{'title':_0x59b218(0x2d8),'field':_0x59b218(0x2d8),'width':_0x59b218(0x227),'formatter':function(_0xd45026,_0x5857fd){var _0x345d13=_0x59b218,_0x359c56=_0xd45026[_0x345d13(0x2e2)]();if(_0x359c56==_0x345d13(0x2e0)||_0x359c56==_0x345d13(0x221)||_0x359c56=='Not\x20SP\x20Permission'||_0x359c56==_0x345d13(0x1e8))return _0x345d13(0x30b)+_0x359c56+_0x345d13(0x26f);else return _0x359c56==_0x345d13(0x1e2)?_0x345d13(0x234)+_0x359c56+_0x345d13(0x26f):_0x345d13(0x229)+_0x359c56+'</span>';}},{'title':'Type','field':_0x59b218(0x25b),'width':_0x59b218(0x227)},{'title':_0x59b218(0x20d),'field':_0x59b218(0x20d),'width':_0x59b218(0x227)},{'title':_0x59b218(0x2e1),'field':_0x59b218(0x2e1),'align':_0x59b218(0x209),'width':_0x59b218(0x29a)},{'title':_0x59b218(0x301),'field':_0x59b218(0x1f5),'width':_0x59b218(0x227),'align':_0x59b218(0x1fe)},{'title':'Department','field':'DepartmentName','width':_0x59b218(0x227),'align':_0x59b218(0x1fe)},{'title':_0x59b218(0x1fd),'field':_0x59b218(0x1f3),'width':'10%','align':'center'},{'title':_0x59b218(0x2d1),'field':_0x59b218(0x2d1),'width':_0x59b218(0x227)},{'title':'Manager','field':_0x59b218(0x284),'width':_0x59b218(0x227)},{'title':'Date\x20Of\x20Joining','field':_0x59b218(0x1c4),'width':_0x59b218(0x227)},{'title':_0x59b218(0x1ec),'field':'Group\x20Name','width':_0x59b218(0x227)}]}),showmessage(),$(_0x59b218(0x297))[_0x59b218(0x20c)](_0x59b218(0x2d0)),$(_0x59b218(0x272))['remove'](),$('.tabulator-page-size')[_0x59b218(0x295)](_0x59b218(0x2c4));}function showmessage(){var _0x4733e9=a20_0x101df8;$(_0x4733e9(0x1ef))[_0x4733e9(0x211)](Ready),$(_0x4733e9(0x2dc))[_0x4733e9(0x211)](Error),$(_0x4733e9(0x25a))[_0x4733e9(0x211)](Exits),$(_0x4733e9(0x1cf))[_0x4733e9(0x211)](lblUpdate),$(_0x4733e9(0x1f1))[_0x4733e9(0x211)](AvilableLicenses);}function GraphAccessTokenTogetUserDetails(){var _0x20ea83=a20_0x101df8,_0x502733=new jQuery[(_0x20ea83(0x1e1))](),_0x4f6bd4={'X-RequestDigest':$(_0x20ea83(0x2ad))[_0x20ea83(0x2c3)](),'accept':'application/json;odata=nometadata','content-type':_0x20ea83(0x24e)},_0x5d97fc={'resource':'https://graph.microsoft.com'};return $[_0x20ea83(0x238)]({'url':_spPageContextInfo['webAbsoluteUrl']+'/_api/SP.OAuth.Token/Acquire','headers':_0x4f6bd4,'type':_0x20ea83(0x250),'async':![],'data':JSON[_0x20ea83(0x1fa)](_0x5d97fc),'success':function(_0x1bf9a9){var _0x4fec6c=_0x20ea83;token=_0x1bf9a9['access_token'],_0x502733[_0x4fec6c(0x22e)](token);},'error':function(_0x1e7580,_0x329e15,_0x438833){var _0x267f91=_0x20ea83;console[_0x267f91(0x202)](_0x1e7580[_0x267f91(0x276)]),_0x502733[_0x267f91(0x29d)](_0x1e7580['responseText']);}}),_0x502733[_0x20ea83(0x1d7)]();}var employeehtml='',userName='',AzureUsrlist=[],AdusersUrl=a20_0x101df8(0x247);function GetAzureUsrlist(_0x1c57f6,_0x1922d6){var _0x241282=a20_0x101df8;return DeferredObj=$[_0x241282(0x1e1)](),$['ajax']({'method':_0x241282(0x25d),'url':_0x1c57f6,'headers':{'Authorization':_0x241282(0x29e)+_0x1922d6,'Content-Type':_0x241282(0x23f)},'async':![],'success':function(_0x30c659){var _0x5792c7=_0x241282;AzureUsrlist=AzureUsrlist[_0x5792c7(0x260)](_0x30c659[_0x5792c7(0x2ed)]),_0x30c659[_0x5792c7(0x266)]!=null?(AdusersUrl=_0x30c659[_0x5792c7(0x266)],GetAzureUsrlist(AdusersUrl,_0x1922d6)):AdusersUrl=_0x5792c7(0x247);},'error':function(_0x482be5){var _0x3c97bb=_0x241282;DeferredObj['reject'](_0x482be5),alert(_0x3c97bb(0x233)+JSON['stringify'](_0x482be5));}}),DeferredObj[_0x241282(0x1d7)]();}function getEmployee(_0xfe2936){var _0x2f99f3=a20_0x101df8,_0x37bd60=_0x2f99f3(0x29b)+_0xfe2936+'\x27';return DeferredObj=$[_0x2f99f3(0x1e1)](),$[_0x2f99f3(0x238)]({'method':_0x2f99f3(0x25d),'url':_0x37bd60,'headers':{'Authorization':_0x2f99f3(0x29e)+token,'Content-Type':_0x2f99f3(0x23f)},'async':![],'success':function(_0x1d5384){var _0x8b3952=_0x2f99f3;_0x1d5384[_0x8b3952(0x2ed)][_0x8b3952(0x2ac)]>0x0?DeferredObj[_0x8b3952(0x22e)](_0x1d5384['value'][0x0][_0x8b3952(0x1eb)]):DeferredObj['resolve']('Invalid\x20Profile');},'error':function(_0x2980bc){var _0x2bc550=_0x2f99f3;DeferredObj[_0x2bc550(0x29d)](_0x2980bc),alert('error1'+JSON[_0x2bc550(0x1fa)](_0x2980bc));}}),DeferredObj[_0x2f99f3(0x1d7)]();}function ClientCredentials(){var _0x58bc6c=a20_0x101df8,_0x595e2b='EnvironmentalSettings',_0x3316a1=titanForWork[_0x58bc6c(0x232)]('CompanyId'),_0x136951=_spPageContextInfo[_0x58bc6c(0x2a8)]+_0x58bc6c(0x273)+_0x595e2b+_0x58bc6c(0x2d2);$[_0x58bc6c(0x238)]({'url':_0x136951,'headers':{'Accept':_0x58bc6c(0x237)},'async':![],'success':function(_0x3fc666){var _0x54f5d9=_0x58bc6c,_0x13aa01=_0x3fc666['d']['results'];ClientId=_0x13aa01[0x0][_0x54f5d9(0x2c5)],ClentSecret=_0x13aa01[0x0]['ChangeFileName'],ClientUrl=_0x13aa01[0x0]['Description'];},'error':function(_0x22ba94){console['log'](_0x22ba94);}});}var EmployeeListUsers=[],GetQueryURL=_spPageContextInfo[a20_0x101df8(0x2a8)]+a20_0x101df8(0x2ba);function GetEmployees(){var _0x2db5d6=a20_0x101df8;$[_0x2db5d6(0x238)]({'url':GetQueryURL,'headers':{'Accept':_0x2db5d6(0x237)},'async':![],'beforeSend':function(){},'success':function(_0x13807d){var _0x272a42=_0x2db5d6;EmployeeListUsers=EmployeeListUsers[_0x272a42(0x260)](_0x13807d['d'][_0x272a42(0x1db)]);if(_0x13807d['d'][_0x272a42(0x1c5)]!=null)GetQueryURL=_0x13807d['d']['__next'],GetEmployees();else{GetQueryURL=_spPageContextInfo[_0x272a42(0x2a8)]+_0x272a42(0x2ba);var _0x54ab37='',_0x5556b1=_spPageContextInfo[_0x272a42(0x2a8)]+_0x272a42(0x2d4);extdfds=$[_0x272a42(0x1e1)](),$['when'](getItems(_0x5556b1,extdfds))[_0x272a42(0x200)](function(_0x510738){var _0x16882b=_0x272a42;response=[],_0x54ab37=_0x510738[_0x16882b(0x2ac)];});}AvilableLicenses=parseInt(UsersLicenceRequired)-(parseInt(EmployeeListUsers[_0x272a42(0x2ac)])+parseInt(_0x54ab37));},'error':function(_0x2d1b4a){console['log'](_0x2d1b4a);}});}$(function(){var _0x2df16a=a20_0x101df8;$(_0x2df16a(0x1c7))[_0x2df16a(0x2cd)](function(){var _0xd48541=_0x2df16a;$(_0xd48541(0x20e))[_0xd48541(0x263)]()[_0xd48541(0x1da)](0x5dc)[_0xd48541(0x267)]();var _0x4fac04=document[_0xd48541(0x22a)]('fileUpload');GetEmployees(),LoadShowUser([]),Ready=0x0,Error=0x0,counusers=0x0;var _0x37b17c=/^([a-zA-Z0-9\s_\\.\-:])+(.xls|.xlsx)$/;if(_0x37b17c[_0xd48541(0x2f7)](_0x4fac04[_0xd48541(0x2ed)][_0xd48541(0x2b4)]())){if(typeof FileReader!=_0xd48541(0x1d6)){var _0x597e7b=new FileReader();_0x597e7b[_0xd48541(0x286)]?(_0x597e7b[_0xd48541(0x2ae)]=function(_0x4b5469){var _0x56b978=_0xd48541;ProcessExcel(_0x4b5469[_0x56b978(0x274)]['result']);},_0x597e7b[_0xd48541(0x286)](_0x4fac04[_0xd48541(0x21a)][0x0])):(_0x597e7b[_0xd48541(0x2ae)]=function(_0x2a4c87){var _0x41bbdc=_0xd48541,_0x5d5d55='',_0x125650=new Uint8Array(_0x2a4c87['target'][_0x41bbdc(0x2bc)]);for(var _0x4a1104=0x0;_0x4a1104<_0x125650[_0x41bbdc(0x2a3)];_0x4a1104++){_0x5d5d55+=String[_0x41bbdc(0x296)](_0x125650[_0x4a1104]);}ProcessExcel(_0x5d5d55);},_0x597e7b[_0xd48541(0x307)](_0x4fac04[_0xd48541(0x21a)][0x0]));}else alert(_0xd48541(0x27d));}else alert(_0xd48541(0x23e));});});function ProcessExcel(_0x47e7d6){var _0x45df9a=a20_0x101df8,_0x57fc01=XLSX[_0x45df9a(0x1de)](_0x47e7d6,{'type':'binary'}),_0x2b81b0=_0x57fc01[_0x45df9a(0x28a)][0x0];excelRows=XLSX[_0x45df9a(0x214)][_0x45df9a(0x2c7)](_0x57fc01[_0x45df9a(0x1d4)][_0x2b81b0]),$(_0x45df9a(0x215))[_0x45df9a(0x203)](),$(_0x45df9a(0x215))['append'](_0x45df9a(0x1d3)+excelRows[_0x45df9a(0x2ac)]+_0x45df9a(0x27a)),$(_0x45df9a(0x2d6))[_0x45df9a(0x20c)]('');for(var _0x5ba3d3=0x0;_0x5ba3d3<excelRows[_0x45df9a(0x2ac)];_0x5ba3d3++){var _0x2e8b38='';ErrorUser='';var _0x82324a=EmployeeListUsers['filter'](function(_0x418b9f){var _0x57dc19=_0x45df9a,_0x935775=_0x418b9f[_0x57dc19(0x2e1)][_0x57dc19(0x2b4)]();return _0x935775==excelRows[_0x5ba3d3][_0x57dc19(0x23a)][_0x57dc19(0x2b4)]();});if(_0x82324a[_0x45df9a(0x2ac)]>0x0){_0x2e8b38=_0x82324a[0x0][_0x45df9a(0x25f)],color_red=_0x45df9a(0x305),ErrorUser=_0x45df9a(0x1e2),Exits=Exits+0x1;var _0x38a4a6=_0x82324a[0x0]['ID'];excelRows[_0x5ba3d3][_0x45df9a(0x279)]='-',excelRows[_0x5ba3d3][_0x45df9a(0x285)]='-',excelRows[_0x5ba3d3][_0x45df9a(0x280)]='-';}else{var _0x210867=AzureUsrlist[_0x45df9a(0x1c8)](function(_0x548c8d){var _0x16f08e=_0x45df9a;if(_0x548c8d['mail']!=null){var _0x4272fe=_0x548c8d['mail'][_0x16f08e(0x2b4)]();return _0x4272fe==excelRows[_0x5ba3d3][_0x16f08e(0x23a)]['toLowerCase']();}});if(_0x210867[_0x45df9a(0x2ac)]>0x0){_0x2e8b38=_0x210867[0x0][_0x45df9a(0x1eb)];var _0x22b35d=AllCompanies[_0x45df9a(0x1c8)](function(_0x103d7e){var _0x5bfa73=_0x45df9a;return _0x103d7e['ID']==excelRows[_0x5ba3d3][_0x5bfa73(0x279)];}),_0x5bdb4f=AllDepartments['filter'](function(_0x3c07c3){var _0x4c8cf8=_0x45df9a;return _0x3c07c3['ID']==excelRows[_0x5ba3d3][_0x4c8cf8(0x285)];}),_0x5b13d8=AllOfficeLocation[_0x45df9a(0x1c8)](function(_0x5735ee){var _0x450a86=_0x45df9a;return _0x5735ee['ID']==excelRows[_0x5ba3d3][_0x450a86(0x280)];});_0x22b35d[_0x45df9a(0x2ac)]>0x0&&_0x5bdb4f[_0x45df9a(0x2ac)]>0x0&&_0x5b13d8[_0x45df9a(0x2ac)]>0x0?(Ready=Ready+0x1,ErrorUser=_0x45df9a(0x299),excelRows[_0x5ba3d3][_0x45df9a(0x283)]=_0x5bdb4f[0x0][_0x45df9a(0x235)],excelRows[_0x5ba3d3][_0x45df9a(0x262)]=_0x5b13d8[0x0]['OfficeName']):(ErrorUser=_0x45df9a(0x221),Error=Error+0x1);}else ErrorUser='Invalid\x20Profile',color_red='color-red',Error=Error+0x1;}excelRows[_0x5ba3d3][_0x45df9a(0x20d)]=_0x2e8b38,excelRows[_0x5ba3d3]['id']=_0x5ba3d3,excelRows[_0x5ba3d3][_0x45df9a(0x2d8)]=ErrorUser,excelRows[_0x5ba3d3]['EmpUserId']=_0x38a4a6;}alluserdata=excelRows,LoadShowUser(excelRows);}function CompaniesDetails(){var _0x2cd171=a20_0x101df8,_0x3e0ade=document[_0x2cd171(0x22a)]('ddlAllCompanies');_0x3e0ade[_0x2cd171(0x2db)]='',opt[_0x2cd171(0x2ed)]='0',opt[_0x2cd171(0x211)]=_0x2cd171(0x1f7),_0x3e0ade['appendChild'](opt);for(var _0x3479cf=0x0;_0x3479cf<AllCompanies['length'];_0x3479cf++){var _0x17e835=AllCompanies[_0x3479cf][_0x2cd171(0x1f5)],_0x3f2c86=AllCompanies[_0x3479cf]['ID'];opt=document[_0x2cd171(0x277)]('option'),opt[_0x2cd171(0x2ed)]=_0x3f2c86,opt[_0x2cd171(0x211)]=_0x17e835,_0x3e0ade[_0x2cd171(0x222)](opt);}$(_0x2cd171(0x1c6))[_0x2cd171(0x2f0)]('checked',![]),$('#txtmanager')[_0x2cd171(0x2c3)](''),$(_0x2cd171(0x2c2))[_0x2cd171(0x2c3)](''),$(_0x2cd171(0x268))[_0x2cd171(0x2c3)]('');}$(a20_0x101df8(0x300))[a20_0x101df8(0x2cd)](function(){var _0x267631=a20_0x101df8,_0x301a85=tabledata[_0x267631(0x2b9)]();debugger;_0x301a85['length']>0x0?(CompaniesDetails(),$('#UploadExcel')['modal'](_0x267631(0x2ff)),initializePeoplePicker('AssaginTomanager'),peoplePickerDiv=$(_0x267631(0x1e5))):alert('Please\x20select\x20required\x20value\x20missing\x20row');});var GetDepartments,Getofficelocation,GetDesignation,GetGroup,CompaniesId,GetofficelocationName,GetDepartmentsName,CompaniesName;$(a20_0x101df8(0x223))['click'](function(){var _0xdae630=a20_0x101df8;if(document[_0xdae630(0x22a)](_0xdae630(0x2f1))[_0xdae630(0x1dc)]==!![]||document[_0xdae630(0x22a)](_0xdae630(0x241))[_0xdae630(0x1dc)]==!![]||document['getElementById'](_0xdae630(0x257))[_0xdae630(0x1dc)]==!![]||document[_0xdae630(0x22a)](_0xdae630(0x2b1))[_0xdae630(0x1dc)]==!![]||document[_0xdae630(0x22a)](_0xdae630(0x226))['checked']==!![]||document[_0xdae630(0x22a)](_0xdae630(0x264))[_0xdae630(0x1dc)]==!![]){var _0x2a3ace=tabledata[_0xdae630(0x2b9)](),_0x522646=SPClientPeoplePicker['SPClientPeoplePickerDict'][peoplePickerDiv[0x0]['id']],_0x1a512f=_0x522646['GetAllUserInfo']();for(var _0x5b2b3f=0x0;_0x5b2b3f<_0x2a3ace[_0xdae630(0x2ac)];_0x5b2b3f++){var _0x491a0b=excelRows[_0xdae630(0x24c)](_0x5d42b7=>_0x5d42b7['Email']==_0x2a3ace[_0x5b2b3f][_0xdae630(0x25e)][_0xdae630(0x21e)][_0xdae630(0x2e1)]);if(excelRows[_0x491a0b]['Status']==_0xdae630(0x1e2))excelRows[_0x491a0b]['Company']='-',excelRows[_0x491a0b]['Department']='-',excelRows[_0x491a0b][_0xdae630(0x1fd)]='-',document[_0xdae630(0x22a)](_0xdae630(0x257))['checked']&&(excelRows[_0x491a0b]['Designation']=$(_0xdae630(0x268))[_0xdae630(0x2c3)]()),document['getElementById'](_0xdae630(0x2b1))[_0xdae630(0x1dc)]&&(excelRows[_0x491a0b][_0xdae630(0x284)]=_0x1a512f[0x0]['EntityData'][_0xdae630(0x2e1)]),document['getElementById'](_0xdae630(0x226))[_0xdae630(0x1dc)]&&(excelRows[_0x491a0b][_0xdae630(0x284)]=_0xdae630(0x258)),document[_0xdae630(0x22a)](_0xdae630(0x264))[_0xdae630(0x1dc)]&&(excelRows[_0x491a0b]['Group\x20Name']=$(_0xdae630(0x2c2))[_0xdae630(0x2c3)]());else{if(excelRows[_0x491a0b][_0xdae630(0x2d8)]=='Required\x20Value\x20Missing'||excelRows[_0x491a0b][_0xdae630(0x2d8)]==_0xdae630(0x299)){document[_0xdae630(0x22a)](_0xdae630(0x2f1))[_0xdae630(0x1dc)]&&(excelRows[_0x491a0b][_0xdae630(0x301)]=CompaniesId,excelRows[_0x491a0b][_0xdae630(0x1f5)]=CompaniesName,excelRows[_0x491a0b][_0xdae630(0x2a7)]=GetDepartments,excelRows[_0x491a0b][_0xdae630(0x235)]=GetDepartmentsName);document['getElementById'](_0xdae630(0x241))[_0xdae630(0x1dc)]&&(excelRows[_0x491a0b][_0xdae630(0x301)]=CompaniesId,excelRows[_0x491a0b]['CompanyName']=CompaniesName,excelRows[_0x491a0b][_0xdae630(0x1fd)]=Getofficelocation,excelRows[_0x491a0b][_0xdae630(0x1f3)]=GetofficelocationName);document[_0xdae630(0x22a)]('chkDesignation')[_0xdae630(0x1dc)]&&(excelRows[_0x491a0b][_0xdae630(0x2d1)]=$(_0xdae630(0x268))[_0xdae630(0x2c3)]());document[_0xdae630(0x22a)](_0xdae630(0x2b1))[_0xdae630(0x1dc)]&&(excelRows[_0x491a0b][_0xdae630(0x284)]=_0x1a512f[0x0][_0xdae630(0x293)][_0xdae630(0x2e1)]);document[_0xdae630(0x22a)]('chkTopExecutive')[_0xdae630(0x1dc)]&&(excelRows[_0x491a0b][_0xdae630(0x284)]=_0xdae630(0x258));document['getElementById'](_0xdae630(0x264))[_0xdae630(0x1dc)]&&(excelRows[_0x491a0b][_0xdae630(0x1ec)]=$(_0xdae630(0x2c2))['val']());var _0x483bd3=AllCompanies[_0xdae630(0x1c8)](function(_0x16e8a){var _0x2895b9=_0xdae630;return _0x16e8a['ID']==excelRows[_0x491a0b][_0x2895b9(0x301)];}),_0xc7b237=AllDepartments[_0xdae630(0x1c8)](function(_0x2c97ae){return _0x2c97ae['ID']==excelRows[_0x491a0b]['Department'];}),_0x5ee6d3=AllOfficeLocation['filter'](function(_0x31dd17){var _0xe3614e=_0xdae630;return _0x31dd17['ID']==excelRows[_0x491a0b][_0xe3614e(0x1fd)];});_0x483bd3['length']>0x0&&_0xc7b237[_0xdae630(0x2ac)]>0x0&&_0x5ee6d3['length']>0x0?(Ready=Ready+0x1,Error=Error-0x1,excelRows[_0x491a0b]['Status']='Ready'):(excelRows[_0x491a0b][_0xdae630(0x2d8)]=_0xdae630(0x221),Error=Error+0x1);}else excelRows[_0x491a0b][_0xdae630(0x2d8)]=='Wrong\x20Manager'&&(document['getElementById'](_0xdae630(0x257))[_0xdae630(0x1dc)]&&(excelRows[_0x491a0b][_0xdae630(0x2d1)]=$(_0xdae630(0x268))['val']()),document[_0xdae630(0x22a)](_0xdae630(0x2b1))[_0xdae630(0x1dc)]&&(excelRows[_0x491a0b][_0xdae630(0x284)]=_0x1a512f[0x0][_0xdae630(0x293)][_0xdae630(0x2e1)]),document['getElementById'](_0xdae630(0x226))['checked']&&(excelRows[_0x491a0b][_0xdae630(0x284)]='Chief\x20Executive'),document[_0xdae630(0x22a)]('chkGroup')[_0xdae630(0x1dc)]&&(excelRows[_0x491a0b]['Group\x20Name']=$('#txtGroup')['val']()),Ready=Ready+0x1,Error=Error-0x1,excelRows[_0x491a0b][_0xdae630(0x2d8)]=_0xdae630(0x299));}}tabledata[_0xdae630(0x207)](excelRows),tabledata['setPage'](pageIndex),$(_0xdae630(0x224))[_0xdae630(0x2b0)](_0xdae630(0x282)),showmessage();}else alert(_0xdae630(0x20a)),$(_0xdae630(0x27b))[_0xdae630(0x2c3)]();}),$(a20_0x101df8(0x1c3))['change'](function(){var _0x50237e=a20_0x101df8;CompaniesId=parseInt($(_0x50237e(0x1f8),$(this))[_0x50237e(0x2c3)]()),CompaniesName=$('option:selected',$(this))[_0x50237e(0x211)]();var _0x17e2dd=AllOfficeLocation[_0x50237e(0x1c8)](function(_0x1df1b9){var _0x1a0fc3=_0x50237e;return _0x1df1b9[_0x1a0fc3(0x248)]===CompaniesId;}),_0x48f1c9=document[_0x50237e(0x22a)](_0x50237e(0x2c6));_0x48f1c9[_0x50237e(0x2db)]='';for(var _0x4e2b68=0x0;_0x4e2b68<_0x17e2dd[_0x50237e(0x2ac)];_0x4e2b68++){var _0x129598=_0x17e2dd[_0x4e2b68][_0x50237e(0x210)],_0x5f5db2=_0x17e2dd[_0x4e2b68]['ID'];opt=document['createElement'](_0x50237e(0x289)),opt['value']=_0x5f5db2,opt['text']=_0x129598,_0x48f1c9[_0x50237e(0x222)](opt);}Getofficelocation=parseInt($(_0x50237e(0x1f8),$(_0x50237e(0x261)))[_0x50237e(0x2c3)]()),GetofficelocationName=$(_0x50237e(0x1f8),$(_0x50237e(0x261)))[_0x50237e(0x211)]();var _0x50d15a=AllDepartments['filter'](function(_0x99dbf1){var _0x360302=_0x50237e;return _0x99dbf1[_0x360302(0x248)]===CompaniesId;}),_0x48f1c9=document[_0x50237e(0x22a)](_0x50237e(0x28d));_0x48f1c9[_0x50237e(0x2db)]='';for(var _0x4e2b68=0x0;_0x4e2b68<_0x50d15a[_0x50237e(0x2ac)];_0x4e2b68++){var _0x129598=_0x50d15a[_0x4e2b68][_0x50237e(0x235)],_0x5f5db2=_0x50d15a[_0x4e2b68]['ID'];opt=document['createElement']('option'),opt[_0x50237e(0x2ed)]=_0x5f5db2,opt[_0x50237e(0x211)]=_0x129598,_0x48f1c9[_0x50237e(0x222)](opt);}GetDepartments=parseInt($(_0x50237e(0x1f8),$(_0x50237e(0x298)))[_0x50237e(0x2c3)]()),GetDepartmentsName=$('option:selected',$(_0x50237e(0x298)))['text']();}),$(a20_0x101df8(0x298))['change'](function(){var _0x3e8c38=a20_0x101df8;GetDepartments=parseInt($(_0x3e8c38(0x1f8),$(this))[_0x3e8c38(0x2c3)]()),GetDepartmentsName=$(_0x3e8c38(0x1f8),$(_0x3e8c38(0x298)))[_0x3e8c38(0x211)]();}),$('#ddlOfficeLocation')[a20_0x101df8(0x30a)](function(){var _0x1afba1=a20_0x101df8;Getofficelocation=parseInt($('option:selected',$(this))[_0x1afba1(0x2c3)]()),GetofficelocationName=$(_0x1afba1(0x1f8),$('#ddlOfficeLocation'))['text']();});function chkManagerevent(_0x4662b3){var _0x76c9b=a20_0x101df8;if(_0x4662b3['checked'])$(_0x76c9b(0x1f9))[_0x76c9b(0x2f0)]('checked',![]),$(_0x76c9b(0x2e5))[_0x76c9b(0x28e)](_0x76c9b(0x1fc)),$(_0x76c9b(0x2e5))[_0x76c9b(0x291)]();else{}}var TopExecutive='';function chkTopExecutiveevent(_0x382d44){var _0x3f072b=a20_0x101df8;if(_0x382d44[_0x3f072b(0x1dc)])$('#chkManager')[_0x3f072b(0x2f0)](_0x3f072b(0x1dc),![]),$(_0x3f072b(0x2e5))[_0x3f072b(0x2f0)](_0x3f072b(0x1fc),!![]),$(_0x3f072b(0x2e5))[_0x3f072b(0x2c3)](''),TopExecutive=_0x3f072b(0x258);else{}}$('#btnDownLoadReport')[a20_0x101df8(0x2cd)](function(){var _0x183f44=a20_0x101df8;tabledata['download']('xlsx',_0x183f44(0x2e4),{'sheetName':_0x183f44(0x2df)});});var dvExcel=document[a20_0x101df8(0x22a)](a20_0x101df8(0x20f));function a20_0x19fc(){var _0x2c9dad=['Home\x20Address','innerHTML','#Error','Departments','\x27)/items?$select=ID&$filter=ID\x20eq\x20','EmployeeSyncreport','Invalid\x20Profile','Email','getValue','#isReadeySelected','EmployeeSyncReport.xlsx','#txtmanager','Announcement_Type','Manager\x20*','indexOf','employeeId','/_api/web/lists/getByTitle(\x27DepartmentalDMS\x27)/roleassignments/addroleassignment(principalid=','575652fORivT','formatDate','value','Guest','#overlaysearch','prop','chkDepartment','static','#example-table','OfficeLocationId','#successfully_notifications','80UWvmBI','test','Office\x20Location\x20Id\x20is\x20not\x20Correct','Welcome','mail','OfficeLocationsId','Width','Please\x20select\x20Department','Description','show','#btnUploadExcel','Company','deselect','.select-row_isReadeySelected','setHours','color-red','LogonNameId','readAsArrayBuffer','/_api/web/lists/getbytitle(\x27','Expires','change','\x20<span\x20style=\x27color:red;\x20font-weight:bold;\x27>','EmployeeName','#ddlAllCompanies','DateOfJoining','__next','.form-check-input','#upload','filter','\x27)/GetItemById(\x27','<input\x20type=\x22checkbox\x22\x20id=\x22IsMiisingSelected\x22\x20onclick=\x22IsMiisingSelecteds()\x22\x20/>','setPage','DOJ:\x20','323739jyNHun','#divAudience','#lblUpdate','SiteURL','Metadata','Not\x20SP\x20Permission','<h3\x20class=\x27m-0\x27>','Sheets','.searching','undefined','promise','#ddlfilterDepartments','department','delay','results','checked','deselectRow','read','ddlfilterOfficeLocation','otherMails','Deferred','Already\x20Exist','ListItem','state','[id$=\x27AssaginTomanager_TopSpan\x27]','Internal\x20Users','#ddlfilterAllCompanies','Worng\x20Manager','SP.Data.','.sp-peoplepicker-editorInput','displayName','Group\x20Name','&$top=1','ready','#Ready','DepartmentId','#AvilableLicenses','EmpUserId','LocationName','#added','CompanyName','Internal\x20','Select\x20Company','option:selected','#chkTopExecutive','stringify','close','readonly','Location','center','width','done','userType','log','empty','The\x20following\x20users\x20failed\x20to\x20sync\x20due\x20to\x20wrong\x20manager\x20defined!.\x0a','split','EmployeeID','setData','<input\x20type=\x22checkbox\x22\x20class=\x22\x22\x20disabled\x20/>','left','please\x20check\x20at\x20list\x20one\x20checkbox\x20','Approved','html','Name','#overlayq','exceltble','OfficeName','text','Title','push','utils','#UploadedItems','1861638PkYFEP','222948gZFqlK','ddlfilterDepartments','dd\x20M\x20yy','files','#ddlfilterOfficeLocation','mobilePhone','selectRow','data','input[type=radio][name=datasend]','2cGWDoz','Required\x20Value\x20Missing','appendChild','#btnmissingrequedvalue','#UploadExcel','toString','chkTopExecutive','10%','postalCode','\x20<span\x20style=\x27color:green;\x20font-weight:bold;\x27>','getElementById','/_api/web/lists/getByTitle(\x27OfficeLocation\x27)/items?$select=*','charAt','EmployeeDepartment','resolve',')/users','NotSave','251px','getQueryStringParameter','error1','\x20<span\x20style=\x27color:blue;\x20font-weight:bold;\x27>','DepartmentName','IsMiisingSelected','application/json;odata=verbose','ajax','<input\x20type=\x22checkbox\x22\x20id=\x22isReadeySelected\x22\x20onclick=\x22isReadeySelecteds()\x22\x20/>','Email\x20*','officeLocation','message','New\x20Joinee','Please\x20upload\x20a\x20valid\x20Excel\x20file.','application/json','/_api/web/lists/getByTitle(\x27','chkOfficeLocation','json','isReadeySelected','select','MaximumEntitySuggestions','application/json;\x20odata=verbose','https://graph.microsoft.com/v1.0/users?$top=999&$select=mail,displayName,userPrincipalName,department,officeLocation,companyName,otherMails,userType,identities,creationType,externalUserState,externalUserState,country,employeeId,jobTitle,postalCode,state,streetAddress,city,mobilePhone,accountEnabled,employeeHireDate\x20&$expand=manager($levels=max;$select=id,displayName,mail)','CompanyIDId','getElement','local','keyup','findIndex','.select-row_IsMiisingSelected','application/json;odata=nometadata','1073741826','POST','User,DL,SecGroup,SPGroup','Corporate','accountEnabled','/_api/web/sitegroups/getbyname(\x27Contributors\x27)?$select=id','Data\x20Send\x20to\x20Announcements\x20Failed','Data\x20Send\x20to\x20Announcements','chkDesignation','Chief\x20Executive','Date\x20Of\x20Birth','#Exits','Type','mm/dd/yy','GET','_row','FullName','concat','#ddlOfficeLocation','OfficeNameDetail','fadeIn','chkGroup','JoiningDate','@odata.nextLink','fadeOut','#txtDesignation','#btnadsync','siteAbsoluteUrl','city','SPClientPeoplePicker_InitStandaloneControlWrapper','<input\x20type=\x22checkbox\x22\x20class=\x22select-row_IsMiisingSelected\x22\x20aria-label=\x22select\x20this\x20row\x22\x20/>','7pCpYDO','</span>','Click\x20on\x20Azure\x20Sync\x20button\x20first.','/_api/web/sitegroups(','.breakpoint','/_api/web/lists/GetByTitle(\x27','target','External','responseText','createElement','round','Company\x20*','</h3>\x20<p\x20class\x20=\x20\x22m-0\x22\x20>\x20Uploaded\x20</p>','select#dropDownId\x20option:selected','<option\x20value=\x220\x22><strong>All</strong></option>','This\x20browser\x20does\x20not\x20support\x20HTML5.','Added','/_api/web/lists/getByTitle(\x27Departments\x27)/items?$select=*','Location\x20*','156188NWMOgq','hide','DepartmentNameDetail','Manager','Department\x20*','readAsBinaryString','getRow','Audience','option','SheetNames','getMonth','fitColumns','ddlDepartment','removeProp','\x27)/items','row','focus','Gender','EntityData','<option\x20value=\x22','after','fromCharCode','#Rowcount','#ddlDepartment','Ready','15%','https://graph.microsoft.com/v1.0/users?$filter=mail\x20eq\x20\x27','SP.User','reject','Bearer\x20','Primary','Date\x20Of\x20Marriage','/_api/web/lists/GetByTitle(\x27Announcements\x27)/items','1348970fBQWRp','byteLength','country','SearchPrincipalSource','_cell','Department','webAbsoluteUrl','PendingAcceptance','100805YzejCO','\x20,\x20','length','#__REQUESTDIGEST','onload','datepicker','modal','chkManager','i:0#.f|membership|','slice','toLowerCase','externalUserState','CompanyId','find','Publish_Date','getSelectedRows','/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=999&$select=ID,AttachmentFiles,FullName,Designation,Manager,MobileNumber,ExtensionName,Email,LogonName/UserName,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department,AttachmentFiles\x20&$filter=\x20PrimaryCompany\x20eq\x20\x27Primary\x27\x20and\x20Status\x20eq\x20\x27Active\x27\x20','toUpperCase','result','setMonth','#IsMiisingSelected','employeeHireDate','#btnfiltervalue','#btnAudience','#txtGroup','val','<span\x20class=\x27breakpoint\x27></span>','ClientName','ddlOfficeLocation','sheet_to_row_object_array','Updated','User\x20Added','manager','EmployeeId','when','click','</option>','\x27)/items?$select=ID,SiteURL&$filter=ID\x20eq\x20','Total\x20Row\x20Count:\x20','Designation','\x27)/items?$filter=Title\x20eq\x20\x27Client_Credentials\x27\x20','Your\x20License\x20limit\x20has\x20been\x20ended','/_api/web/lists/getbytitle(\x27ExternalUsers\x27)/items?$select=*,InternalStakeholders/Title,Supervisor_Guest/Title,Client_Name/Title,LoginName/Title\x20&$expand=\x20LoginName,Client_Name,Supervisor_Guest,InternalStakeholders\x20&$filter=((Status\x20eq\x20\x27Initiated\x27)\x20or\x20(Status\x20eq\x20\x27Invited\x27\x20)or\x20(Status\x20eq\x20\x27Pending\x27)or\x20(Status\x20eq\x20\x27Accepted\x27))','map','#dvExcel','streetAddress','Status','companyName'];a20_0x19fc=function(){return _0x2c9dad;};return a20_0x19fc();}dvExcel['innerHTML']='';var outputArray=[];function removewithfilter(_0x5115af){var _0x202d14=a20_0x101df8;let _0x70af78=_0x5115af[_0x202d14(0x1c8)](function(_0x453f2b,_0x423e5c,_0x518681){var _0x61da2a=_0x202d14;return _0x423e5c==_0x518681[_0x61da2a(0x2e8)](_0x453f2b);});return _0x70af78;}function GetItemTypeForListName(_0x3253ca){var _0x554418=a20_0x101df8;return _0x554418(0x1e9)+_0x3253ca[_0x554418(0x22c)](0x0)[_0x554418(0x2bb)]()+_0x3253ca[_0x554418(0x205)]('\x20')['join']('')[_0x554418(0x2b3)](0x1)+_0x554418(0x1e3);}var response=response||[];function getItems(_0x20fe8c,_0x127c0c){var _0x64e964=a20_0x101df8;return $[_0x64e964(0x238)]({'url':_0x20fe8c,'type':_0x64e964(0x25d),'async':![],'headers':{'accept':_0x64e964(0x237)},'success':function(_0x28b102){var _0x2f1db9=_0x64e964;response=response[_0x2f1db9(0x260)](_0x28b102['d'][_0x2f1db9(0x1db)]),_0x28b102['d']['__next']?(_0x20fe8c=_0x28b102['d'][_0x2f1db9(0x1c5)],getItems(_0x20fe8c,_0x127c0c)):_0x127c0c[_0x2f1db9(0x22e)](response);},'error':function(_0x3077c4){var _0x1f06db=_0x64e964;_0x127c0c[_0x1f06db(0x29d)](_0x3077c4),console['log'](_0x3077c4);}}),_0x127c0c[_0x64e964(0x1d7)]();}function a20_0x204c(_0x3374f8,_0xc577ce){var _0x19fc5b=a20_0x19fc();return a20_0x204c=function(_0x204c3a,_0x1ef5dd){_0x204c3a=_0x204c3a-0x1c3;var _0x27527b=_0x19fc5b[_0x204c3a];return _0x27527b;},a20_0x204c(_0x3374f8,_0xc577ce);}function InsertWelcomeInAnnouncementList(_0x39f514){var _0x4121e3=a20_0x101df8;$[_0x4121e3(0x238)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x4121e3(0x2a1),'type':_0x4121e3(0x250),'async':![],'data':JSON[_0x4121e3(0x1fa)](_0x39f514),'headers':{'Accept':_0x4121e3(0x237),'Content-Type':_0x4121e3(0x237),'X-RequestDigest':$(_0x4121e3(0x2ad))[_0x4121e3(0x2c3)](),'X-HTTP-Method':_0x4121e3(0x250)},'success':function(_0x2f4b9d,_0x3854c5,_0x59566b){var _0x55a256=_0x4121e3;console[_0x55a256(0x202)](_0x55a256(0x256));},'error':function(_0x1e6c1a){var _0x24fdf2=_0x4121e3;console[_0x24fdf2(0x202)](_0x1e6c1a),console[_0x24fdf2(0x202)](_0x24fdf2(0x255)),currentDlg['close']();}});}