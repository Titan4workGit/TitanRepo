var a20_0x358320=a20_0x6b1c;(function(_0x37fa9a,_0x1c5991){var _0x294acd=a20_0x6b1c,_0x446099=_0x37fa9a();while(!![]){try{var _0x5ac8f4=-parseInt(_0x294acd(0x1d2))/0x1*(-parseInt(_0x294acd(0x23e))/0x2)+-parseInt(_0x294acd(0x118))/0x3*(-parseInt(_0x294acd(0x139))/0x4)+-parseInt(_0x294acd(0x206))/0x5+parseInt(_0x294acd(0x237))/0x6*(-parseInt(_0x294acd(0x1bb))/0x7)+parseInt(_0x294acd(0x239))/0x8*(parseInt(_0x294acd(0x223))/0x9)+parseInt(_0x294acd(0x19b))/0xa*(-parseInt(_0x294acd(0x22c))/0xb)+-parseInt(_0x294acd(0x167))/0xc*(-parseInt(_0x294acd(0x1b1))/0xd);if(_0x5ac8f4===_0x1c5991)break;else _0x446099['push'](_0x446099['shift']());}catch(_0xcb634e){_0x446099['push'](_0x446099['shift']());}}}(a20_0x46e9,0x93c47));var token,ClientId='',ClentSecret='',ClientUrl='',DeferredObj=$[a20_0x358320(0x137)](),color_red='',Error=0x0,Ready=0x0,Exits=0x0,lblUpdate=0x0,ErrorUser='',alluserdata,contributersGroupId='',counusers=0x0,excelRows,AllCompanies,AllDepartments,AllOfficeLocation,tabledata,pageIndex,UserEmailId,warningmessage='',userfullname='',AvilableLicenses,ReadySelected=[],MiisingSelected=[],AddedEmployeeList=[],IsMiisingSelect,isReadeySelect,peoplePickerDiv='',EmployeeId='',EmployeeDepartment='',EmployeeOfficeLocation='',checkedAudience='';$(document)[a20_0x358320(0x1e0)](function(){var _0x5d9ccc=a20_0x358320;GraphAccessTokenTogetUserDetails(),GetCompanies(),GetOfficeLocation(),GetDepartments(),LoadShowUser([]),GetAllUserId(),GetEmployees(),$(_0x5d9ccc(0x256))[_0x5d9ccc(0x21f)](AvilableLicenses);});function initializePeoplePicker(_0x3f218e){var _0xf04f2b=a20_0x358320,_0x1d689f={};_0x1d689f[_0xf04f2b(0x24c)]=_0xf04f2b(0x164),_0x1d689f[_0xf04f2b(0x218)]=0xf,_0x1d689f['ResolvePrincipalSource']=0xf,_0x1d689f[_0xf04f2b(0x255)]=![],_0x1d689f[_0xf04f2b(0x14d)]=0x32,_0x1d689f['Width']='251px',this[_0xf04f2b(0x186)](_0x3f218e,null,_0x1d689f),$(_0xf04f2b(0x192))[_0xf04f2b(0x245)](0xfa);}function GetSelectItem(){var _0x521836=a20_0x358320;if(contributersGroupId!==''){var _0x5de2b3=tabledata[_0x521836(0x156)]();counusers=0x0,IsaddedNewEmployee=![];for(var _0x343ca1=0x0;_0x343ca1<_0x5de2b3['length'];_0x343ca1++){var _0x19927a=alluserdata[_0x521836(0x151)](function(_0x5514e5){var _0x7350f2=_0x521836;return _0x5514e5[_0x7350f2(0x15b)]==_0x5de2b3[_0x343ca1][_0x7350f2(0x1f5)][_0x7350f2(0x177)][_0x7350f2(0x15b)];});AvilableLicenses>0x0?_0x19927a[0x0][_0x521836(0x1d6)]==_0x521836(0x173)?IsaddedNewEmployee=AddNewEmployeeAllocated(_0x19927a,_0x521836(0x252)):_0x19927a[0x0][_0x521836(0x1d6)]=='Already\x20Exist'&&UpdateExistingEmployeeAllocated(_0x19927a,_0x521836(0x252)):($(_0x521836(0x1dc))[_0x521836(0x21f)](counusers),alert(_0x521836(0x15a)),_0x343ca1=_0x5de2b3[_0x521836(0x12f)]);}warningmessage!=''&&(warningmessage+=userfullname,alert(warningmessage)),$(_0x521836(0x1dc))['text'](counusers),showmessage(),tabledata[_0x521836(0x1aa)](excelRows),tabledata[_0x521836(0x1e4)](pageIndex),IsaddedNewEmployee&&($('#successfully_notifications')['modal']({'backdrop':_0x521836(0x209),'keyboard':![]},_0x521836(0x1c5)),AddedEmployeeList[_0x521836(0x12f)]>0x0?$('#divAudience')[_0x521836(0x1c5)]():$(_0x521836(0x117))[_0x521836(0x1bd)]());}else $(_0x521836(0x16e))['fadeIn']()[_0x521836(0x158)](0x7d0)['fadeOut'](),GetGroupIDByGroupName(),GetSelectItem();}$(a20_0x358320(0x198))[a20_0x358320(0x207)](function(){$['ajax']({'cache':![],'beforeSend':function(){var _0x9019ac=a20_0x6b1c;$(_0x9019ac(0x146))[_0x9019ac(0x163)]();},'success':function(_0x29f821){var _0x5b8baf=a20_0x6b1c;AzureUsrlist=[],GetAzureUsrlist(AdusersUrl,token),excelRows=[];for(var _0x1edec7=0x0;_0x1edec7<AzureUsrlist[_0x5b8baf(0x12f)];_0x1edec7++){if(AzureUsrlist[_0x1edec7]['mail']!=null&&AzureUsrlist[_0x1edec7][_0x5b8baf(0x12b)]==!![]){if(AzureUsrlist[_0x1edec7][_0x5b8baf(0x1f9)]!=_0x5b8baf(0x1e9)){var _0x16654e=EmployeeListUsers[_0x5b8baf(0x151)](function(_0x397446){var _0x5eaacb=_0x5b8baf;return _0x397446[_0x5eaacb(0x15b)][_0x5eaacb(0x230)]()==AzureUsrlist[_0x1edec7][_0x5eaacb(0x160)][_0x5eaacb(0x230)]();}),_0xb79ce2=AllCompanies[_0x5b8baf(0x151)](function(_0x4537f4){var _0x13aa43=_0x5b8baf;if(AzureUsrlist[_0x1edec7]['companyName']!=null)return _0x4537f4[_0x13aa43(0x11e)][_0x13aa43(0x230)]()==AzureUsrlist[_0x1edec7][_0x13aa43(0x1f2)][_0x13aa43(0x230)]();}),_0x542ed0=0x0;_0xb79ce2['length']>0x0?_0x542ed0=_0xb79ce2[0x0]['Id']:_0x542ed0=parseInt(Logged_CompanyId);var _0x4610d0=AllOfficeLocation[_0x5b8baf(0x151)](function(_0xa2fc8){var _0x4eba90=_0x5b8baf;if(AzureUsrlist[_0x1edec7]['officeLocation']!=null)return _0xa2fc8[_0x4eba90(0x1ba)][_0x4eba90(0x230)]()==AzureUsrlist[_0x1edec7]['officeLocation'][_0x4eba90(0x230)]();}),_0x35c6da=0x0;_0x4610d0[_0x5b8baf(0x12f)]>0x0&&(_0x35c6da=_0x4610d0[0x0]['Id']);var _0x50a438=AllDepartments[_0x5b8baf(0x151)](function(_0x1bd276){var _0xc784ad=_0x5b8baf;if(AzureUsrlist[_0x1edec7]['department']!=null)return _0x1bd276[_0xc784ad(0x1ba)][_0xc784ad(0x230)]()==AzureUsrlist[_0x1edec7]['department'][_0xc784ad(0x230)]();}),_0x4ddcfe=0x0;_0x50a438[_0x5b8baf(0x12f)]>0x0&&(_0x4ddcfe=_0x50a438[0x0]['Id']);var _0xffc05f='',_0x2dabaf='';AzureUsrlist[_0x1edec7][_0x5b8baf(0x22a)]!=undefined&&(_0xffc05f=AzureUsrlist[_0x1edec7][_0x5b8baf(0x22a)][_0x5b8baf(0x160)]);AzureUsrlist[_0x1edec7][_0x5b8baf(0x15c)]!=undefined||AzureUsrlist[_0x1edec7][_0x5b8baf(0x15c)]!=null?(_0x2dabaf=new Date(AzureUsrlist[_0x1edec7]['employeeHireDate']),_0x2dabaf=$[_0x5b8baf(0x1b2)]['formatDate'](_0x5b8baf(0x129),_0x2dabaf)):(_0x2dabaf=new Date(),_0x2dabaf=$['datepicker'][_0x5b8baf(0x236)](_0x5b8baf(0x129),_0x2dabaf));if(_0x16654e['length']==0x0){var _0x5e149e=AzureUsrlist[_0x1edec7][_0x5b8baf(0x178)]==_0x5b8baf(0x1cc)?'External':_0x5b8baf(0x20f);excelRows['push']({'Id':_0x1edec7,'Name':AzureUsrlist[_0x1edec7][_0x5b8baf(0x14f)],'Email':AzureUsrlist[_0x1edec7][_0x5b8baf(0x160)],'Type':_0x5e149e,'Department':_0x4ddcfe,'Company':_0x542ed0,'DepartmentName':AzureUsrlist[_0x1edec7][_0x5b8baf(0x11a)],'CompanyName':AzureUsrlist[_0x1edec7][_0x5b8baf(0x1f2)],'country':AzureUsrlist[_0x1edec7][_0x5b8baf(0x1cd)],'DateOfJoining':_0x2dabaf,'employeeId':AzureUsrlist[_0x1edec7]['employeeId'],'Manager':_0xffc05f,'postalCode':AzureUsrlist[_0x1edec7][_0x5b8baf(0x1fb)],'state':AzureUsrlist[_0x1edec7][_0x5b8baf(0x22e)],'streetAddress':AzureUsrlist[_0x1edec7][_0x5b8baf(0x14a)],'city':AzureUsrlist[_0x1edec7][_0x5b8baf(0x1db)],'mobilePhone':AzureUsrlist[_0x1edec7][_0x5b8baf(0x168)],'Location':_0x35c6da,'LocationName':AzureUsrlist[_0x1edec7][_0x5b8baf(0x1ac)],'otherMails':AzureUsrlist[_0x1edec7][_0x5b8baf(0x144)][0x0],'Designation':AzureUsrlist[_0x1edec7][_0x5b8baf(0x1a6)]});}}}}Ready=0x0,Error=0x0,lblUpdate=0x0,counusers=0x0,Exits=0x0,$('#Ready')[_0x5b8baf(0x21f)](0x0),$(_0x5b8baf(0x23a))['text'](0x0),$('#added')[_0x5b8baf(0x21f)](0x0),$('#lblUpdate')[_0x5b8baf(0x21f)](0x0),$(_0x5b8baf(0x250))[_0x5b8baf(0x21f)](0x0);for(var _0x1edec7=0x0;_0x1edec7<excelRows[_0x5b8baf(0x12f)];_0x1edec7++){var _0x1a9fe0='',_0x3b5cfa=AzureUsrlist['filter'](function(_0x313f99){var _0x3c6776=_0x5b8baf;if(_0x313f99[_0x3c6776(0x160)]!=null){var _0x57761a=_0x313f99[_0x3c6776(0x160)][_0x3c6776(0x230)]();return _0x57761a==excelRows[_0x1edec7][_0x3c6776(0x15b)][_0x3c6776(0x230)]();}});if(_0x3b5cfa[_0x5b8baf(0x12f)]>0x0){_0x1a9fe0=_0x3b5cfa[0x0][_0x5b8baf(0x14f)];var _0x2f1457=AllCompanies[_0x5b8baf(0x151)](function(_0x188686){var _0x79ef12=_0x5b8baf;return _0x188686['ID']==excelRows[_0x1edec7][_0x79ef12(0x242)];}),_0x2ff61f=AllDepartments['filter'](function(_0x35eb7d){var _0x5430bb=_0x5b8baf;return _0x35eb7d['ID']==excelRows[_0x1edec7][_0x5430bb(0x1ea)];}),_0x147b29=AllOfficeLocation[_0x5b8baf(0x151)](function(_0x13da54){var _0x2bcb04=_0x5b8baf;return _0x13da54['ID']==excelRows[_0x1edec7][_0x2bcb04(0x1ed)];});_0x2f1457['length']>0x0&&_0x2ff61f['length']>0x0&&_0x147b29[_0x5b8baf(0x12f)]>0x0?(Ready=Ready+0x1,ErrorUser=_0x5b8baf(0x173)):(ErrorUser=_0x5b8baf(0x1b8),Error=Error+0x1);}else ErrorUser=_0x5b8baf(0x1cf),color_red=_0x5b8baf(0x1be),Error=Error+0x1;excelRows[_0x1edec7][_0x5b8baf(0x1d6)]=ErrorUser;}alluserdata=excelRows,LoadShowUser(excelRows),$(_0x5b8baf(0x146))[_0x5b8baf(0x152)]();}});});var Temparray=[];$('#btnFilter')[a20_0x358320(0x207)](function(){var _0x2ea689=a20_0x358320;debugger;Temparray=alluserdata;let _0x43e5c5=[...new Set(Temparray[_0x2ea689(0x217)](_0x478187=>_0x478187[_0x2ea689(0x1f3)]))];var _0x367a3e=document[_0x2ea689(0x170)]('ddlfilterAllCompanies');_0x367a3e['innerHTML']='',opt[_0x2ea689(0x208)]='0',opt[_0x2ea689(0x21f)]='Select\x20Company',_0x367a3e[_0x2ea689(0x1a8)](opt);for(var _0x111bd9=0x0;_0x111bd9<_0x43e5c5[_0x2ea689(0x12f)];_0x111bd9++){opt=document[_0x2ea689(0x17e)](_0x2ea689(0x125)),opt[_0x2ea689(0x208)]=_0x43e5c5[_0x111bd9],opt[_0x2ea689(0x21f)]=_0x43e5c5[_0x111bd9],_0x367a3e['appendChild'](opt);}Temparray=alluserdata;var _0xd317c4=[...new Set(Temparray['map'](_0x4479d4=>_0x4479d4['Location\x20*']))],_0x367a3e=document['getElementById'](_0x2ea689(0x221)),_0x3025fc=_0x2ea689(0x119);for(var _0x111bd9=0x0;_0x111bd9<_0xd317c4[_0x2ea689(0x12f)];_0x111bd9++){_0x3025fc+=_0x2ea689(0x18e)+_0xd317c4[_0x111bd9]+'\x22>'+_0xd317c4[_0x111bd9]+'</option>';}$(_0x2ea689(0x246))[_0x2ea689(0x17d)](_0x3025fc),Temparray=alluserdata;let _0x337384=[...new Set(Temparray[_0x2ea689(0x217)](_0x2c1df3=>_0x2c1df3[_0x2ea689(0x1ea)]))];var _0x367a3e=document[_0x2ea689(0x170)](_0x2ea689(0x1b9));_0x367a3e[_0x2ea689(0x157)]='',opt[_0x2ea689(0x208)]='0',opt[_0x2ea689(0x21f)]=_0x2ea689(0x184),_0x367a3e[_0x2ea689(0x1a8)](opt);for(var _0x111bd9=0x0;_0x111bd9<_0x337384[_0x2ea689(0x12f)];_0x111bd9++){opt=document['createElement']('option'),opt[_0x2ea689(0x208)]=_0x337384[_0x111bd9],opt[_0x2ea689(0x21f)]=_0x337384[_0x111bd9],_0x367a3e[_0x2ea689(0x1a8)](opt);}}),$('#btnfiltervalue')[a20_0x358320(0x207)](function(){var _0x10dd74=a20_0x358320;let _0x37b526;var _0x42084b='',_0x4d84b6=!![];$(_0x10dd74(0x171))['val']()!='0'&&(_0x4d84b6=![]);if($(_0x10dd74(0x1fe))[_0x10dd74(0x143)]()!='0')_0x4d84b6=![];else return alert(_0x10dd74(0x211)),![];if($('#ddlfilterOfficeLocation')[_0x10dd74(0x143)]()!='0')_0x4d84b6=![];else return alert(_0x10dd74(0x240)),![];_0x37b526=alluserdata[_0x10dd74(0x151)](function(_0x23af91){var _0x55cbbc=_0x10dd74;return _0x23af91[_0x55cbbc(0x1ed)]==$('option:selected',$(_0x55cbbc(0x246)))[_0x55cbbc(0x143)]()&&_0x23af91[_0x55cbbc(0x1ea)]==$(_0x55cbbc(0x128),$(_0x55cbbc(0x1fe)))[_0x55cbbc(0x143)]()&&_0x23af91[_0x55cbbc(0x242)]==$(_0x55cbbc(0x128),$(_0x55cbbc(0x171)))[_0x55cbbc(0x143)]();});var _0x4f9916=alluserdata[_0x10dd74(0x1d8)](_0x224687=>_0x224687[_0x10dd74(0x1ed)]===$(_0x10dd74(0x128),$(_0x10dd74(0x246)))[_0x10dd74(0x143)]()&&_0x224687['Department']==$(_0x10dd74(0x128),$('#ddlfilterDepartments'))[_0x10dd74(0x143)]()&&_0x224687['Company']==$(_0x10dd74(0x128),$(_0x10dd74(0x171)))[_0x10dd74(0x143)]());_0x4d84b6?LoadShowUser(alluserdata):LoadShowUser(_0x37b526);}),$('.searching')[a20_0x358320(0x1f6)](function(_0x3a362b){var _0x238512=a20_0x358320;LoadShowUser(search($(_0x238512(0x18c))['val']()));});function search(_0x466b7e){var _0x28e887=a20_0x358320;return alluserdata[_0x28e887(0x151)](({Name:_0x1139e6,Email:_0x5d83ee})=>{var _0x275ee0=_0x28e887;return _0x1139e6[_0x275ee0(0x230)]()['indexOf'](_0x466b7e[_0x275ee0(0x230)]())>-0x1||_0x5d83ee[_0x275ee0(0x230)]()[_0x275ee0(0x19f)](_0x466b7e['toLowerCase']())>-0x1;});}$(a20_0x358320(0x1f8))['click'](function(){var _0x33aea2=a20_0x358320;$[_0x33aea2(0x175)]({'cache':![],'beforeSend':function(){var _0x49f192=_0x33aea2;$(_0x49f192(0x146))[_0x49f192(0x163)]();},'success':function(_0x4858be){var _0x3d69a0=_0x33aea2;AddedEmployeeList=[],SubmitReady(),$(_0x3d69a0(0x146))[_0x3d69a0(0x152)]();}});});function SubmitReady(){var _0x4127e5=a20_0x358320;if(contributersGroupId!==''){var _0x4fa342=tabledata[_0x4127e5(0x156)]();counusers=0x0,IsaddedNewEmployee=![];for(var _0x2dee7=0x0;_0x2dee7<_0x4fa342[_0x4127e5(0x12f)];_0x2dee7++){var _0x23c088=alluserdata[_0x4127e5(0x151)](function(_0x5a107c){var _0x293b92=_0x4127e5;return _0x5a107c[_0x293b92(0x15b)]==_0x4fa342[_0x2dee7]['_row'][_0x293b92(0x177)]['Email'];});if(AvilableLicenses>0x0)_0x23c088[0x0][_0x4127e5(0x1d6)]=='Ready'?IsaddedNewEmployee=AddNewEmployeeAllocated(_0x23c088,_0x4127e5(0x252)):_0x23c088[0x0][_0x4127e5(0x1d6)]==_0x4127e5(0x154)&&UpdateExistingEmployeeAllocated(_0x23c088,_0x4127e5(0x252));else return alert(_0x4127e5(0x15a)),![];}warningmessage!=''&&(warningmessage+=userfullname,alert(warningmessage)),$('#added')[_0x4127e5(0x21f)](counusers),showmessage(),tabledata['setData'](excelRows),tabledata[_0x4127e5(0x1e4)](pageIndex),IsaddedNewEmployee&&($(_0x4127e5(0x1c8))[_0x4127e5(0x121)]({'backdrop':'static','keyboard':![]},_0x4127e5(0x1c5)),AddedEmployeeList[_0x4127e5(0x12f)]>0x0?$(_0x4127e5(0x117))[_0x4127e5(0x1c5)]():$(_0x4127e5(0x117))[_0x4127e5(0x1bd)]());}else GetGroupIDByGroupName(),GetSelectItem();}$(a20_0x358320(0x123))['on']('click',function(){var _0x4b149c=a20_0x358320;$[_0x4b149c(0x175)]({'cache':![],'beforeSend':function(){var _0x3db17c=_0x4b149c;$(_0x3db17c(0x146))[_0x3db17c(0x163)]();},'success':function(_0x50546c){var _0x2dd4ec=_0x4b149c;if(AddedEmployeeList[_0x2dd4ec(0x12f)]>0x0&&checkedAudience!=_0x2dd4ec(0x1f1))for(var _0x3a162a=0x0;_0x3a162a<AddedEmployeeList[_0x2dd4ec(0x12f)];_0x3a162a++){var _0x2ee927=new Date(AddedEmployeeList[_0x3a162a][_0x2dd4ec(0x1c3)][_0x2dd4ec(0x20c)]),_0x3bbc63=new Date();_0x3bbc63[_0x2dd4ec(0x131)](_0x2ee927['getMonth']()+0x3),_0x2ee927=$[_0x2dd4ec(0x1b2)][_0x2dd4ec(0x236)](_0x2dd4ec(0x129),_0x2ee927),_0x3bbc63=$['datepicker']['formatDate'](_0x2dd4ec(0x129),_0x3bbc63);var _0x213b94=new Date(AddedEmployeeList[_0x3a162a][_0x2dd4ec(0x1c3)][_0x2dd4ec(0x20c)]);_0x213b94=$[_0x2dd4ec(0x1b2)]['formatDate'](_0x2dd4ec(0x251),_0x213b94);var _0x1ac56c=[],_0x14a788=[],_0x1e28a0=[];_0x1e28a0[_0x2dd4ec(0x1c1)](Logged_CompanyId);var _0x2aff67;_0x2aff67={'__metadata':{'type':'SP.Data.AnnouncementsListItem'}},(_0x2aff67[_0x2dd4ec(0x17a)]='Welcome',_0x2aff67[_0x2dd4ec(0x21d)]=AddedEmployeeList[_0x3a162a][_0x2dd4ec(0x249)][_0x2dd4ec(0x1e1)](),_0x2aff67[_0x2dd4ec(0x1ba)]='New\x20Joinee',_0x2aff67[_0x2dd4ec(0x116)]=AddedEmployeeList[_0x3a162a][_0x2dd4ec(0x1c3)][_0x2dd4ec(0x21e)],_0x2aff67['Designation']=AddedEmployeeList[_0x3a162a][_0x2dd4ec(0x1c3)][_0x2dd4ec(0x1a2)],_0x2aff67[_0x2dd4ec(0x1ea)]=AddedEmployeeList[_0x3a162a][_0x2dd4ec(0x142)],_0x2aff67[_0x2dd4ec(0x161)]=AddedEmployeeList[_0x3a162a][_0x2dd4ec(0x1c0)],_0x2aff67['UserType']=_0x2dd4ec(0x21c),_0x2aff67[_0x2dd4ec(0x1fc)]=_0x2dd4ec(0x1b3),_0x2aff67[_0x2dd4ec(0x227)]=checkedAudience,_0x2aff67[_0x2dd4ec(0x197)]=_0x2dd4ec(0x1f0),_0x2aff67[_0x2dd4ec(0x1d1)]=_0x2ee927,_0x2aff67[_0x2dd4ec(0x243)]=_0x3bbc63,_0x2aff67[_0x2dd4ec(0x1b7)]='DOJ:\x20'+_0x213b94);if(checkedAudience==_0x2dd4ec(0x12a))_0x1e28a0=[0x0],_0x1ac56c=[0x0],_0x14a788=[0x0],_0x2aff67['CompanyId']={'results':_0x1e28a0},_0x2aff67[_0x2dd4ec(0x19a)]={'results':_0x14a788},_0x2aff67['OfficeLocationsId']={'results':_0x1ac56c};else{if(checkedAudience=='Company')_0x1e28a0[_0x2dd4ec(0x1c1)](AddedEmployeeList[_0x3a162a][_0x2dd4ec(0x1c3)][_0x2dd4ec(0x199)]),_0x1ac56c=[0x0],_0x14a788=[0x0],_0x2aff67[_0x2dd4ec(0x199)]={'results':_0x1e28a0},_0x2aff67['DepartmentsId']={'results':_0x14a788},_0x2aff67[_0x2dd4ec(0x1a0)]={'results':_0x1ac56c};else{if(checkedAudience==_0x2dd4ec(0x1ea))_0x1e28a0=[0x0],_0x1ac56c=[0x0],_0x14a788[_0x2dd4ec(0x1c1)](AddedEmployeeList[_0x3a162a][_0x2dd4ec(0x1c3)][_0x2dd4ec(0x258)]),_0x2aff67[_0x2dd4ec(0x199)]={'results':_0x1e28a0},_0x2aff67[_0x2dd4ec(0x19a)]={'results':_0x14a788},_0x2aff67[_0x2dd4ec(0x1a0)]={'results':_0x1ac56c};else checkedAudience==_0x2dd4ec(0x1ed)&&(_0x1e28a0=[0x0],_0x1ac56c[_0x2dd4ec(0x1c1)](AddedEmployeeList[_0x3a162a][_0x2dd4ec(0x1c3)][_0x2dd4ec(0x1fd)]),_0x14a788=[0x0],_0x2aff67[_0x2dd4ec(0x199)]={'results':_0x1e28a0},_0x2aff67['DepartmentsId']={'results':_0x14a788},_0x2aff67[_0x2dd4ec(0x1a0)]={'results':_0x1ac56c});}}InsertWelcomeInAnnouncementList(_0x2aff67);}$(_0x2dd4ec(0x146))[_0x2dd4ec(0x152)]();}});}),$(a20_0x358320(0x1fa))['change'](function(){var _0x36c173=a20_0x358320;checkedAudience=this[_0x36c173(0x208)];});function isReadeySelecteds(){var _0x137bf6=a20_0x358320;isReadeySelect=document['getElementById'](_0x137bf6(0x16d));if(isReadeySelect['checked']){tabledata[_0x137bf6(0x203)](MiisingSelected),$(_0x137bf6(0x248))[_0x137bf6(0x18f)](_0x137bf6(0x202),![]),$(_0x137bf6(0x16a))[_0x137bf6(0x18f)](_0x137bf6(0x202),![]),ReadySelected=[];for(var _0x31ecfe=0x0;_0x31ecfe<excelRows['length'];_0x31ecfe++){(excelRows[_0x31ecfe][_0x137bf6(0x1d6)]==_0x137bf6(0x173)||excelRows[_0x31ecfe]['Status']==_0x137bf6(0x154))&&ReadySelected[_0x137bf6(0x1c1)](_0x31ecfe);}$(_0x137bf6(0x224))[_0x137bf6(0x18f)](_0x137bf6(0x202),!![]),tabledata[_0x137bf6(0x21a)](ReadySelected);}else tabledata[_0x137bf6(0x203)](ReadySelected),$(_0x137bf6(0x224))['prop'](_0x137bf6(0x202),![]);}function IsMiisingSelecteds(){var _0x1d9104=a20_0x358320;IsMiisingSelect=document[_0x1d9104(0x170)](_0x1d9104(0x135));if(IsMiisingSelect['checked']){tabledata['deselectRow'](ReadySelected),$(_0x1d9104(0x1ab))[_0x1d9104(0x18f)]('checked',![]),$(_0x1d9104(0x224))['prop']('checked',![]),MiisingSelected=[];for(var _0x294446=0x0;_0x294446<excelRows[_0x1d9104(0x12f)];_0x294446++){(excelRows[_0x294446][_0x1d9104(0x1d6)]==_0x1d9104(0x1b8)||excelRows[_0x294446][_0x1d9104(0x1d6)]==_0x1d9104(0x154)||excelRows[_0x294446][_0x1d9104(0x1d6)]==_0x1d9104(0x173))&&(MiisingSelected[_0x1d9104(0x1c1)](_0x294446),$('.select-row_IsMiisingSelected')['prop']('checked',!![]));}tabledata[_0x1d9104(0x21a)](MiisingSelected);}else tabledata[_0x1d9104(0x203)](MiisingSelected),$(_0x1d9104(0x248))[_0x1d9104(0x18f)](_0x1d9104(0x202),![]);}function AssignPermissiononDMSLibary(_0x823766,_0x3fff62,_0x3549d0){var _0x466039=a20_0x358320,_0x3e633a={'Accept':'application/json;odata=verbose','content-Type':_0x466039(0x132),'X-RequestDigest':jQuery('#__REQUESTDIGEST')[_0x466039(0x143)]()},_0x224af7=_0x3549d0+'/_api/web/lists/getByTitle(\x27DepartmentalDMS\x27)/roleassignments/addroleassignment(principalid='+_0x823766+_0x466039(0x1da)+_0x3fff62+')';$[_0x466039(0x175)]({'url':_0x224af7,'type':_0x466039(0x1e7),'headers':_0x3e633a,'dataType':_0x466039(0x234),'async':![],'success':function(_0x131265){console['log']('User\x20has\x20been\x20assigned\x20permission\x20.');},'error':function(_0x1200fc){var _0xb177=_0x466039;console[_0xb177(0x216)](JSON[_0xb177(0x18d)](_0x1200fc)),Permissionloder[_0xb177(0x238)]();}});}function GetGroupIDByGroupName(){var _0x55ee6f=a20_0x358320,_0x39eb74=_spPageContextInfo[_0x55ee6f(0x232)]+'/_api/web/sitegroups/getbyname(\x27Contributors\x27)?$select=id';$[_0x55ee6f(0x175)]({'url':_0x39eb74,'method':_0x55ee6f(0x16f),'async':![],'headers':{'Accept':_0x55ee6f(0x1af)},'success':function(_0x5ae0ae){contributersGroupId=_0x5ae0ae['d']['Id'];},'error':function(_0x2f6e8e){var _0x472b30=_0x55ee6f;console[_0x472b30(0x216)](_0x2f6e8e);}});}function GetListItems(_0x5d6e88,_0x2eb9f2){var _0x39104a=a20_0x358320,_0x342abe,_0x24d984=_spPageContextInfo[_0x39104a(0x232)]+'/_api/web/lists/getByTitle(\x27'+_0x5d6e88+_0x39104a(0x176)+_0x2eb9f2+_0x39104a(0x1f7);return $[_0x39104a(0x175)]({'url':_0x24d984,'method':_0x39104a(0x16f),'async':![],'headers':{'Accept':_0x39104a(0x1af)},'success':function(_0x2b9d42){var _0x2a8a3f=_0x39104a;_0x2b9d42['d'][_0x2a8a3f(0x122)][_0x2a8a3f(0x12f)]>0x0?_0x342abe=![]:_0x342abe=!![];},'error':function(_0x713ed9){var _0x5157e9=_0x39104a;console[_0x5157e9(0x216)](_0x713ed9);}}),_0x342abe;}function GetCompanies(){var _0x3c27de=a20_0x358320,_0x5b93b9=_spPageContextInfo[_0x3c27de(0x232)]+_0x3c27de(0x172);$['ajax']({'url':_0x5b93b9,'method':_0x3c27de(0x16f),'async':![],'headers':{'Accept':_0x3c27de(0x1af)},'success':function(_0x4e10c9){var _0x1c3828=_0x3c27de;AllCompanies=_0x4e10c9['d'][_0x1c3828(0x122)];},'error':function(_0x1e081b){var _0x24e2b0=_0x3c27de;console[_0x24e2b0(0x216)](_0x1e081b);}});}function GetDepartments(){var _0x138de7=a20_0x358320,_0x41bcd9=_spPageContextInfo['webAbsoluteUrl']+_0x138de7(0x185);$[_0x138de7(0x175)]({'url':_0x41bcd9,'method':'GET','async':![],'headers':{'Accept':'application/json;\x20odata=verbose'},'success':function(_0x5b8590){var _0x2b7ea9=_0x138de7;AllDepartments=_0x5b8590['d'][_0x2b7ea9(0x122)];},'error':function(_0x1be4c6){console['log'](_0x1be4c6);}});}function GetOfficeLocation(){var _0x130f18=a20_0x358320,_0x4f2f35=_spPageContextInfo[_0x130f18(0x232)]+_0x130f18(0x155);$[_0x130f18(0x175)]({'url':_0x4f2f35,'method':'GET','async':![],'headers':{'Accept':_0x130f18(0x1af)},'success':function(_0x51387d){var _0x3692c9=_0x130f18;AllOfficeLocation=_0x51387d['d'][_0x3692c9(0x122)];},'error':function(_0x4ca4c5){var _0x54c2c0=_0x130f18;console[_0x54c2c0(0x216)](_0x4ca4c5);}});}function GetSubSiteUrl(_0x59df34,_0x2bc894){var _0x135242=a20_0x358320,_0x863946,_0x479b6e=_spPageContextInfo[_0x135242(0x232)]+'/_api/web/lists/getByTitle(\x27'+_0x59df34+_0x135242(0x1bf)+_0x2bc894+_0x135242(0x1f7);return $[_0x135242(0x175)]({'url':_0x479b6e,'method':_0x135242(0x16f),'async':![],'headers':{'Accept':'application/json;\x20odata=verbose'},'success':function(_0xec9adb){var _0x5b7474=_0x135242;_0x863946=_0xec9adb['d'][_0x5b7474(0x122)][0x0]['SiteURL'];},'error':function(_0x1a7162){var _0x1433da=_0x135242;console[_0x1433da(0x216)](_0x1a7162);}}),_0x863946;}function AddUserinSharePointGroup(_0x1dbf0d){var _0x3a8d26=a20_0x358320,_0x2051ac=$[_0x3a8d26(0x137)](),_0x518be8=_0x3a8d26(0x24e),_0x393d6c=_0x518be8+_0x1dbf0d,_0x3603bc=_spPageContextInfo[_0x3a8d26(0x232)]+_0x3a8d26(0x16c)+contributersGroupId+')/users';$[_0x3a8d26(0x175)]({'url':_0x3603bc,'type':_0x3a8d26(0x1e7),'async':![],'data':JSON[_0x3a8d26(0x18d)]({'__metadata':{'type':_0x3a8d26(0x20b)},'LoginName':_0x393d6c}),'headers':{'accept':_0x3a8d26(0x132),'content-type':'application/json;odata=verbose','X-RequestDigest':$(_0x3a8d26(0x181))['val']()},'success':_0x360a34,'error':_0x2da173});function _0x360a34(_0x4e357d){var _0x2d3cfb=_0x3a8d26;_0x2051ac[_0x2d3cfb(0x149)](_0x4e357d['d']['Id']),console[_0x2d3cfb(0x216)]('User\x20Added');}function _0x2da173(_0x1d2c5f){var _0x8230b7=_0x3a8d26;console[_0x8230b7(0x216)](JSON['stringify'](_0x1d2c5f));}return _0x2051ac[_0x3a8d26(0x179)]();}function GetUserId(_0x4e9f16){var _0x4f8e92=a20_0x358320,_0x38737c='',_0x1f50bb=_0x4f8e92(0x24e),_0x41348c=_spPageContextInfo[_0x4f8e92(0x15f)],_0x458e41=_0x1f50bb+_0x4e9f16;return $[_0x4f8e92(0x175)]({'url':_0x41348c+_0x4f8e92(0x20e)+encodeURIComponent(_0x458e41)+'\x27','method':'GET','headers':{'Accept':'application/json;\x20odata=verbose'},'async':![],'success':function(_0x9da90){_0x38737c=_0x9da90['d']['Id'];},'error':function(_0x1d4514){var _0x254cd5=_0x4f8e92;console['log'](JSON[_0x254cd5(0x18d)](_0x1d4514));}}),_0x38737c;}var GetAllGroupsUser=[],GroupUrl=_spPageContextInfo[a20_0x358320(0x15f)]+a20_0x358320(0x150);function GetAllUserId(){var _0x45adc1=a20_0x358320;$[_0x45adc1(0x175)]({'url':GroupUrl,'method':_0x45adc1(0x16f),'headers':{'Accept':'application/json;\x20odata=verbose'},'async':![],'success':function(_0x5231bd){var _0x1b4f6c=_0x45adc1;GetAllGroupsUser=GetAllGroupsUser[_0x1b4f6c(0x229)](_0x5231bd['d'][_0x1b4f6c(0x122)]),_0x5231bd['d']['__next']!=null&&(GroupUrl=_0x5231bd['d'][_0x1b4f6c(0x195)],GetAllUserId());},'error':function(_0x309f49){var _0xd45c8a=_0x45adc1;console[_0xd45c8a(0x216)](JSON['stringify'](_0x309f49));}});}var LoginName;function UpdateExistingEmployeeAllocated(_0x575040,_0x2a3ff7){var _0x121883=a20_0x358320;try{UserEmailId=_0x575040[0x0][_0x121883(0x15b)],LoginName=_0x121883(0x24e)+_0x575040[0x0][_0x121883(0x15b)];var _0x409203,_0x42fce9,_0x32ec08=GetAllGroupsUser[_0x121883(0x151)](function(_0x194c85){var _0x5890aa=_0x121883;return _0x194c85[_0x5890aa(0x15b)][_0x5890aa(0x230)]()==_0x575040[0x0][_0x5890aa(0x15b)][_0x5890aa(0x230)]();});if(_0x32ec08['length']>0x0)var _0x16fb3c=_0x32ec08[0x0]['Id'];else{}if(TopExecutive==_0x121883(0x16b)||_0x575040[0x0]['Manager']==undefined)_0x575040[0x0][_0x121883(0x204)]=_0x121883(0x16b),_0x409203=-0x1;else{var _0x53e893=EmployeeListUsers[_0x121883(0x151)](function(_0x3209de){var _0x24825e=_0x121883,_0x141a46;if(_0x3209de[_0x24825e(0x12e)]!=null)return _0x141a46=_0x3209de['Email'][_0x24825e(0x230)](),_0x141a46==_0x575040[0x0]['Manager'][_0x24825e(0x230)]();});if(_0x53e893['length']>0x0){_0x42fce9=_0x53e893[0x0][_0x121883(0x21e)];var _0x32ec08=GetAllGroupsUser[_0x121883(0x151)](function(_0x2ed945){var _0x23b394=_0x121883;return _0x2ed945[_0x23b394(0x15b)][_0x23b394(0x230)]()==_0x575040[0x0][_0x23b394(0x12e)]['toLowerCase']();});if(_0x32ec08['length']>0x0)_0x409203=_0x32ec08[0x0]['Id'];else{}}else{IsManager=![],_0x409203='';var _0x43330b=excelRows[_0x121883(0x1c6)](_0x574d4b=>_0x574d4b[_0x121883(0x15b)]['toLowerCase']()==_0x575040[0x0][_0x121883(0x15b)][_0x121883(0x230)]());excelRows[_0x43330b]['Status']=_0x121883(0x1b4);}}var _0x46ba57,_0x43e012=GetItemTypeForListName(_0x2a3ff7);_0x46ba57={'__metadata':{'type':_0x43e012},'Designation':_0x575040[0x0][_0x121883(0x1a2)],'GroupName':_0x575040[0x0]['Group\x20Name'],'Manager':_0x42fce9,'ManagerLoginNameId':_0x409203},$[_0x121883(0x1eb)](updateItemExitUser(_0x2a3ff7,_0x46ba57,_0x575040[0x0]['EmpUserId']))[_0x121883(0x222)](function(_0x2cb3ee){var _0x2688a8=_0x121883,_0x30889d=_0x2cb3ee;if(_0x30889d){lblUpdate=lblUpdate+0x1,Exits=Exits-0x1;var _0x29cd19=excelRows['findIndex'](_0x3e3ac0=>_0x3e3ac0[_0x2688a8(0x15b)]==UserEmailId);excelRows[_0x29cd19][_0x2688a8(0x1d6)]=_0x2688a8(0x205),showmessage();}});}catch(_0x1cb2ff){console['log'](_0x1cb2ff[_0x121883(0x1cb)]);}}var IsManager=!![];function AddNewEmployeeAllocated(_0xf4fcf4,_0x4c9fd3){var _0x4208f0=a20_0x358320,_0xe9c19d=![];try{var _0x3841ea=AllCompanies['filter'](function(_0x362129){var _0x3b1e1f=a20_0x6b1c;return _0x362129['ID']==parseInt(_0xf4fcf4[0x0][_0x3b1e1f(0x242)]);});if(!(_0x3841ea[_0x4208f0(0x12f)]>0x0))return alert(_0x4208f0(0x23c)),_0xe9c19d=![],![];var _0x137143=AllDepartments['filter'](function(_0x3833e8){var _0x4e3189=_0x4208f0;return _0x3833e8['ID']==parseInt(_0xf4fcf4[0x0][_0x4e3189(0x1ea)]);});if(!(_0x137143[_0x4208f0(0x12f)]>0x0))return alert(_0x4208f0(0x1ca)),_0xe9c19d=![],![];var _0xc1c462=AllOfficeLocation[_0x4208f0(0x151)](function(_0x52b830){var _0x32264d=_0x4208f0;return _0x52b830['ID']==parseInt(_0xf4fcf4[0x0][_0x32264d(0x1ed)]);});if(!(_0xc1c462[_0x4208f0(0x12f)]>0x0))return alert('Office\x20Location\x20Id\x20is\x20not\x20Correct'),_0xe9c19d=![],![];if(_0x3841ea['length']>0x0&&_0x137143[_0x4208f0(0x12f)]>0x0&&_0xc1c462[_0x4208f0(0x12f)]>0x0){EmployeeDepartment=_0x137143[0x0][_0x4208f0(0x21b)],EmployeeOfficeLocation=_0xc1c462[0x0][_0x4208f0(0x1ee)],LoginName=_0xf4fcf4[0x0][_0x4208f0(0x15b)][_0x4208f0(0x230)]();var _0x4fd2ce,_0x1949c9,_0x4e3144=GetAllGroupsUser['filter'](function(_0xaace61){var _0x41e2d8=_0x4208f0;return _0xaace61[_0x41e2d8(0x15b)][_0x41e2d8(0x230)]()==_0xf4fcf4[0x0]['Email']['toLowerCase']();}),_0x5b24cd;if(_0x4e3144[_0x4208f0(0x12f)]>0x0)var _0x5b24cd=_0x4e3144[0x0]['Id'];else $['when'](AddUserinSharePointGroup(LoginName))[_0x4208f0(0x222)](function(_0x19d19a){_0x5b24cd=_0x19d19a;});if(TopExecutive=='Chief\x20Executive'||_0xf4fcf4[0x0]['Manager']==undefined)_0xf4fcf4[0x0]['Manager\x20*']='Chief\x20Executive',_0x4fd2ce=-0x1;else{var _0x2ed4dd=EmployeeListUsers[_0x4208f0(0x151)](function(_0x223b66){var _0xb23539=_0x4208f0,_0x2c9756;if(_0x223b66[_0xb23539(0x15b)]!=null)return _0x2c9756=_0x223b66[_0xb23539(0x15b)]['toLowerCase'](),_0x2c9756==_0xf4fcf4[0x0][_0xb23539(0x12e)][_0xb23539(0x230)]();});if(_0x2ed4dd[_0x4208f0(0x12f)]>0x0){_0x1949c9=_0x2ed4dd[0x0]['FullName'];var _0x4e3144=GetAllGroupsUser[_0x4208f0(0x151)](function(_0x21ffbe){var _0x15af28=_0x4208f0;return _0x21ffbe[_0x15af28(0x15b)][_0x15af28(0x230)]()==_0xf4fcf4[0x0]['Manager'][_0x15af28(0x230)]();});_0x4e3144['length']>0x0?_0x4fd2ce=_0x4e3144[0x0]['Id']:_0x4fd2ce=AddUserinSharePointGroup(_0xf4fcf4[0x0][_0x4208f0(0x12e)]['toLowerCase']());}else{IsManager=![],_0x4fd2ce='';var _0x469af5=excelRows[_0x4208f0(0x1c6)](_0xcfb296=>_0xcfb296[_0x4208f0(0x15b)]['toLowerCase']()==LoginName);excelRows[_0x469af5]['Status']=_0x4208f0(0x220);}}var _0xa3d101,_0x3fbf5f=GetItemTypeForListName(_0x4c9fd3);_0xa3d101={'__metadata':{'type':_0x3fbf5f},'CompanyId':parseInt(_0xf4fcf4[0x0][_0x4208f0(0x242)]),'DepartmentId':parseInt(_0xf4fcf4[0x0]['Department']),'FullName':_0xf4fcf4[0x0]['Name'],'Title':_0xf4fcf4[0x0][_0x4208f0(0x20d)],'ParentId':'-1','Email':_0xf4fcf4[0x0][_0x4208f0(0x15b)],'LogonNameId':_0x5b24cd,'Manager':_0xf4fcf4[0x0][_0x4208f0(0x12e)],'ManagerLoginNameId':_0x4fd2ce,'OfficeLocationId':parseInt(_0xf4fcf4[0x0]['Location']),'MobileNumber':_0xf4fcf4[0x0][_0x4208f0(0x168)],'DateOfBirth':_0xf4fcf4[0x0][_0x4208f0(0x1ff)],'Gender':_0xf4fcf4[0x0][_0x4208f0(0x253)],'DateOfAnniversary':_0xf4fcf4[0x0]['Date\x20Of\x20Marriage'],'JoiningDate':_0xf4fcf4[0x0][_0x4208f0(0x14c)],'Designation':_0xf4fcf4[0x0][_0x4208f0(0x1a2)],'PrimaryCompany':_0x4208f0(0x24b),'EmployeeID':_0xf4fcf4[0x0][_0x4208f0(0x24a)],'GroupName':_0xf4fcf4[0x0][_0x4208f0(0x182)],'Status':_0x4208f0(0x1a5),'PostalAddresses':_0xf4fcf4[0x0][_0x4208f0(0x1fb)],'City':_0xf4fcf4[0x0][_0x4208f0(0x1db)],'StateProvince':_0xf4fcf4[0x0][_0x4208f0(0x22e)],'ZIPPostalCode':_0xf4fcf4[0x0][_0x4208f0(0x1fb)],'Country':_0xf4fcf4[0x0][_0x4208f0(0x1cd)],'HomePhone':_0xf4fcf4[0x0][_0x4208f0(0x168)],'OtherEMailAddress':_0xf4fcf4[0x0][_0x4208f0(0x144)],'HomeAddress':_0xf4fcf4[0x0][_0x4208f0(0x22d)]},AddItemToList(_0x4c9fd3,_0xa3d101);var _0x2a9226=new Date(),_0x4c2d64=new Date(_0xf4fcf4[0x0][_0x4208f0(0x14c)]),_0x1c0d0b=daysDifference(_0x4c2d64,_0x2a9226);_0x1c0d0b<=0xf&&AddedEmployeeList['push']({'Metadata':_0xa3d101,'EmployeeId':_0xf4fcf4[0x0][_0x4208f0(0x24a)],'EmployeeOfficeLocation':EmployeeOfficeLocation,'EmployeeDepartment':EmployeeDepartment}),_0xe9c19d=!![];}}catch(_0x1abc2f){console[_0x4208f0(0x216)](_0x1abc2f[_0x4208f0(0x1cb)]);}return _0xe9c19d;}function daysDifference(_0x275f6f,_0x5a8235){var _0x369830=a20_0x358320,_0x470cab=new Date(+_0x5a8235)[_0x369830(0x166)](0xc)-new Date(+_0x275f6f)[_0x369830(0x166)](0xc);return Math[_0x369830(0x183)](_0x470cab/0x5265c00);}function updateItemExitUser(_0x312169,_0x3e48f6,_0x54f445){var _0x55b655=a20_0x358320,_0x50ca49=$[_0x55b655(0x137)]();return $[_0x55b655(0x175)]({'url':_spPageContextInfo[_0x55b655(0x232)]+_0x55b655(0x159)+_0x312169+'\x27)/GetItemById(\x27'+_0x54f445+'\x27)','type':_0x55b655(0x1e7),'headers':{'accept':_0x55b655(0x132),'X-RequestDigest':$(_0x55b655(0x181))['val'](),'content-Type':'application/json;odata=verbose','X-Http-Method':_0x55b655(0x141),'If-Match':'*'},'data':JSON['stringify'](_0x3e48f6),'async':![],'success':function(_0x333d23){var _0x515812=_0x55b655;_0x50ca49[_0x515812(0x149)](!![]);},'error':function(_0x4242f6){var _0x9fc134=_0x55b655;_0x50ca49[_0x9fc134(0x19c)](_0x4242f6);}}),_0x50ca49[_0x55b655(0x179)]();}function AddItemToList(_0x2d5c36,_0x14689d){var _0x9ac6b5=a20_0x358320;UserEmailId=_0x14689d[_0x9ac6b5(0x15b)];var _0x492c03=_0x14689d['FullName'],_0x2329d6=$[_0x9ac6b5(0x137)]();return $['ajax']({'url':_spPageContextInfo[_0x9ac6b5(0x232)]+_0x9ac6b5(0x159)+_0x2d5c36+_0x9ac6b5(0x11d),'type':'POST','async':![],'headers':{'accept':_0x9ac6b5(0x132),'X-RequestDigest':$(_0x9ac6b5(0x181))[_0x9ac6b5(0x143)](),'content-Type':'application/json;odata=verbose'},'data':JSON[_0x9ac6b5(0x18d)](_0x14689d),'success':function(_0x1d91dd){var _0x3a5e92=_0x9ac6b5;counusers=counusers+0x1,AvilableLicenses=AvilableLicenses-0x1,Ready=Ready-0x1;var _0x2dde31=excelRows['findIndex'](_0x315dc5=>_0x315dc5[_0x3a5e92(0x15b)]==UserEmailId);excelRows[_0x2dde31]['Status']=_0x3a5e92(0x219),showmessage();var _0x2bee45=GetSubSiteUrl(_0x3a5e92(0x24f),_0x1d91dd['d'][_0x3a5e92(0x258)]);AssignPermissiononDMSLibary(_0x1d91dd['d'][_0x3a5e92(0x124)],'1073741826',_0x2bee45),_0x2329d6[_0x3a5e92(0x149)](_0x1d91dd);},'error':function(_0x1108de){var _0x309685=_0x9ac6b5;if(IsManager){var _0x1276ac=excelRows[_0x309685(0x1c6)](_0x2bbd4f=>_0x2bbd4f[_0x309685(0x15b)]==UserEmailId);excelRows[_0x1276ac][_0x309685(0x1d6)]=_0x309685(0x1d4);}userfullname==''?(userfullname+=_0x492c03,warningmessage='The\x20following\x20users\x20failed\x20to\x20sync\x20due\x20to\x20wrong\x20manager\x20defined!.\x0a'):userfullname+=_0x309685(0x11c)+_0x492c03,Ready=Ready-0x1,Error=Error+0x1,console[_0x309685(0x216)](JSON[_0x309685(0x18d)](_0x1108de)),_0x2329d6['reject'](JSON[_0x309685(0x18d)](_0x1108de));}}),_0x2329d6[_0x9ac6b5(0x179)]();}function LoadShowUser(_0x382b43){var _0x1f0cb2=a20_0x358320;tabledata=new Tabulator(_0x1f0cb2(0x225),{'height':'','pagination':'local','paginationSize':0xa,'layout':'fitColumns','paginationSizeSelector':[0xa,0x19,0x32,0x64],'placeholder':_0x1f0cb2(0x200),'data':_0x382b43,'pageLoaded':function(_0x1d1a4a){var _0x3514a2=_0x1f0cb2;_0x1d1a4a>=0x1?pageIndex=_0x1d1a4a:pageIndex=_0x1d1a4a,IsMiisingSelect=document[_0x3514a2(0x170)](_0x3514a2(0x135)),IsMiisingSelect[_0x3514a2(0x202)]&&$(_0x3514a2(0x248))['prop'](_0x3514a2(0x202),!![]),isReadeySelect=document[_0x3514a2(0x170)](_0x3514a2(0x16d)),isReadeySelect['checked']&&$('.select-row_isReadeySelected')['prop']('checked',!![]);},'columns':[{'formatter':function(_0xb39e50,_0x102749){var _0x12245a=_0x1f0cb2,_0xdcaadc=_0xb39e50[_0x12245a(0x1b0)]['row'][_0x12245a(0x177)][_0x12245a(0x1d6)];return _0xdcaadc==_0x12245a(0x1cf)||_0xdcaadc==_0x12245a(0x1b8)||_0xdcaadc==_0x12245a(0x219)||_0xdcaadc==_0x12245a(0x205)?_0x12245a(0x1ce):'<input\x20type=\x22checkbox\x22\x20class=\x22select-row_isReadeySelected\x22\x20aria-label=\x22select\x20this\x20row\x22\x20/>';},'title':_0x1f0cb2(0x145),'field':'ID','width':'1%','headerSort':![],'cellClick':function(_0x1e8330,_0x3a6096){var _0x5b814d=_0x1f0cb2,_0x3481ef=$(_0x3a6096[_0x5b814d(0x235)]()),_0x35d6c2=_0x3481ef[_0x5b814d(0x1d8)](_0x5b814d(0x224));_0x35d6c2[0x0]['checked']==![]&&$(_0x3a6096[_0x5b814d(0x1c9)]()[_0x5b814d(0x235)]())[_0x5b814d(0x1d8)](_0x5b814d(0x248))[0x0][_0x5b814d(0x202)]==![]?_0x3a6096['getRow']()['deselect']():_0x3a6096['getRow']()['select']();}},{'formatter':function(_0x5cc405,_0x5ecded){var _0x1d15ff=_0x1f0cb2,_0x282a82=_0x5cc405[_0x1d15ff(0x1b0)][_0x1d15ff(0x214)]['data'][_0x1d15ff(0x1d6)];return _0x282a82==_0x1d15ff(0x1b8)||_0x282a82==_0x1d15ff(0x154)||_0x282a82==_0x1d15ff(0x173)?_0x1d15ff(0x127):_0x1d15ff(0x1ce);},'title':'<input\x20type=\x22checkbox\x22\x20id=\x22IsMiisingSelected\x22\x20onclick=\x22IsMiisingSelecteds()\x22\x20/>','hozAlign':_0x1f0cb2(0x11b),'field':'ID','headerSort':![],'width':'1%','cellClick':function(_0x49a801,_0x26d3b5){var _0x1b60f8=_0x1f0cb2,_0x244547=$(_0x26d3b5[_0x1b60f8(0x235)]()),_0x22521f=_0x244547[_0x1b60f8(0x1d8)](_0x1b60f8(0x248));_0x22521f[0x0][_0x1b60f8(0x202)]==![]?_0x26d3b5[_0x1b60f8(0x1c9)]()[_0x1b60f8(0x1a1)]():_0x26d3b5['getRow']()[_0x1b60f8(0x133)]();}},{'title':_0x1f0cb2(0x1d6),'field':'Status','width':_0x1f0cb2(0x23f),'formatter':function(_0xcd9432,_0x162009){var _0x36ec66=_0x1f0cb2,_0x393333=_0xcd9432['getValue']();if(_0x393333==_0x36ec66(0x1cf)||_0x393333==_0x36ec66(0x1b8)||_0x393333==_0x36ec66(0x1d4)||_0x393333=='Worng\x20Manager')return'\x20<span\x20style=\x27color:red;\x20font-weight:bold;\x27>'+_0x393333+_0x36ec66(0x20a);else return _0x393333==_0x36ec66(0x154)?'\x20<span\x20style=\x27color:blue;\x20font-weight:bold;\x27>'+_0x393333+'</span>':_0x36ec66(0x11f)+_0x393333+_0x36ec66(0x20a);}},{'title':_0x1f0cb2(0x22b),'field':'Type','width':_0x1f0cb2(0x23f)},{'title':_0x1f0cb2(0x20d),'field':_0x1f0cb2(0x20d),'width':_0x1f0cb2(0x23f)},{'title':_0x1f0cb2(0x15b),'field':_0x1f0cb2(0x15b),'align':_0x1f0cb2(0x1dd),'width':_0x1f0cb2(0x1a3)},{'title':'Company','field':_0x1f0cb2(0x11e),'width':_0x1f0cb2(0x23f),'align':_0x1f0cb2(0x11b)},{'title':'Department','field':_0x1f0cb2(0x21b),'width':'10%','align':_0x1f0cb2(0x11b)},{'title':'Location','field':_0x1f0cb2(0x23d),'width':'10%','align':_0x1f0cb2(0x11b)},{'title':_0x1f0cb2(0x1a2),'field':_0x1f0cb2(0x1a2),'width':_0x1f0cb2(0x23f)},{'title':'Manager','field':_0x1f0cb2(0x12e),'width':_0x1f0cb2(0x23f)},{'title':_0x1f0cb2(0x1ec),'field':_0x1f0cb2(0x14c),'width':'10%'},{'title':_0x1f0cb2(0x182),'field':_0x1f0cb2(0x182),'width':_0x1f0cb2(0x23f)}]}),showmessage(),$(_0x1f0cb2(0x1ef))[_0x1f0cb2(0x17d)](_0x1f0cb2(0x1e8)),$(_0x1f0cb2(0x228))[_0x1f0cb2(0x13a)](),$(_0x1f0cb2(0x1b6))[_0x1f0cb2(0x1d0)](_0x1f0cb2(0x1a4));}function showmessage(){var _0x371211=a20_0x358320;$(_0x371211(0x1f4))[_0x371211(0x21f)](Ready),$(_0x371211(0x23a))[_0x371211(0x21f)](Error),$(_0x371211(0x250))[_0x371211(0x21f)](Exits),$(_0x371211(0x13e))['text'](lblUpdate),$(_0x371211(0x256))[_0x371211(0x21f)](AvilableLicenses);}function GraphAccessTokenTogetUserDetails(){var _0x2a1a36=a20_0x358320,_0x92ab06=new jQuery['Deferred'](),_0x16e78a={'X-RequestDigest':$(_0x2a1a36(0x181))[_0x2a1a36(0x143)](),'accept':_0x2a1a36(0x226),'content-type':_0x2a1a36(0x226)},_0x41f482={'resource':_0x2a1a36(0x17c)};return $[_0x2a1a36(0x175)]({'url':_spPageContextInfo[_0x2a1a36(0x232)]+'/_api/SP.OAuth.Token/Acquire','headers':_0x16e78a,'type':_0x2a1a36(0x1e7),'async':![],'data':JSON['stringify'](_0x41f482),'success':function(_0x15cf75){token=_0x15cf75['access_token'],_0x92ab06['resolve'](token);},'error':function(_0x52b876,_0x6ce99e,_0x25ea1e){var _0x419615=_0x2a1a36;console['log'](_0x52b876[_0x419615(0x23b)]),_0x92ab06[_0x419615(0x19c)](_0x52b876[_0x419615(0x23b)]);}}),_0x92ab06['promise']();}var employeehtml='',userName='',AzureUsrlist=[],AdusersUrl=a20_0x358320(0x18b);function GetAzureUsrlist(_0x550d95,_0x4daaf8){var _0x54e2=a20_0x358320;return DeferredObj=$[_0x54e2(0x137)](),$[_0x54e2(0x175)]({'method':_0x54e2(0x16f),'url':_0x550d95,'headers':{'Authorization':_0x54e2(0x1df)+_0x4daaf8,'Content-Type':_0x54e2(0x196)},'async':![],'success':function(_0xfc99f3){var _0x23a4b0=_0x54e2;AzureUsrlist=AzureUsrlist[_0x23a4b0(0x229)](_0xfc99f3[_0x23a4b0(0x208)]),_0xfc99f3[_0x23a4b0(0x14b)]!=null?(AdusersUrl=_0xfc99f3[_0x23a4b0(0x14b)],GetAzureUsrlist(AdusersUrl,_0x4daaf8)):AdusersUrl=_0x23a4b0(0x18b);},'error':function(_0x2b8239){var _0x2bef1a=_0x54e2;DeferredObj[_0x2bef1a(0x19c)](_0x2b8239),alert(_0x2bef1a(0x169)+JSON[_0x2bef1a(0x18d)](_0x2b8239));}}),DeferredObj[_0x54e2(0x179)]();}function getEmployee(_0xaa5d41){var _0x42816c=a20_0x358320,_0x23418e=_0x42816c(0x22f)+_0xaa5d41+'\x27';return DeferredObj=$['Deferred'](),$[_0x42816c(0x175)]({'method':_0x42816c(0x16f),'url':_0x23418e,'headers':{'Authorization':_0x42816c(0x1df)+token,'Content-Type':_0x42816c(0x196)},'async':![],'success':function(_0x30ef05){var _0x1b7c60=_0x42816c;_0x30ef05[_0x1b7c60(0x208)]['length']>0x0?DeferredObj[_0x1b7c60(0x149)](_0x30ef05[_0x1b7c60(0x208)][0x0]['displayName']):DeferredObj[_0x1b7c60(0x149)](_0x1b7c60(0x1cf));},'error':function(_0x30947d){var _0x5554bb=_0x42816c;DeferredObj[_0x5554bb(0x19c)](_0x30947d),alert(_0x5554bb(0x169)+JSON[_0x5554bb(0x18d)](_0x30947d));}}),DeferredObj[_0x42816c(0x179)]();}function ClientCredentials(){var _0x236762=a20_0x358320,_0x279931=_0x236762(0x165),_0x2dbab7=titanForWork[_0x236762(0x1d5)]('CompanyId'),_0x37264a=_spPageContextInfo[_0x236762(0x232)]+_0x236762(0x120)+_0x279931+_0x236762(0x1c7);$['ajax']({'url':_0x37264a,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x4081c4){var _0x564ece=_0x236762,_0x393b08=_0x4081c4['d'][_0x564ece(0x122)];ClientId=_0x393b08[0x0]['ClientName'],ClentSecret=_0x393b08[0x0][_0x564ece(0x1b5)],ClientUrl=_0x393b08[0x0][_0x564ece(0x1b7)];},'error':function(_0x2eacdf){console['log'](_0x2eacdf);}});}var EmployeeListUsers=[],GetQueryURL=_spPageContextInfo[a20_0x358320(0x232)]+a20_0x358320(0x13f);function GetEmployees(){var _0x53629d=a20_0x358320;$[_0x53629d(0x175)]({'url':GetQueryURL,'headers':{'Accept':_0x53629d(0x132)},'async':![],'beforeSend':function(){},'success':function(_0x1a2887){var _0x4c9e9e=_0x53629d;EmployeeListUsers=EmployeeListUsers[_0x4c9e9e(0x229)](_0x1a2887['d'][_0x4c9e9e(0x122)]);if(_0x1a2887['d'][_0x4c9e9e(0x195)]!=null)GetQueryURL=_0x1a2887['d'][_0x4c9e9e(0x195)],GetEmployees();else{GetQueryURL=_spPageContextInfo[_0x4c9e9e(0x232)]+_0x4c9e9e(0x13f);var _0xe158e6='',_0x34a6f6=_spPageContextInfo[_0x4c9e9e(0x232)]+'/_api/web/lists/getbytitle(\x27ExternalUsers\x27)/items?$select=*,InternalStakeholders/Title,Supervisor_Guest/Title,Client_Name/Title,LoginName/Title\x20&$expand=\x20LoginName,Client_Name,Supervisor_Guest,InternalStakeholders\x20&$filter=((Status\x20eq\x20\x27Initiated\x27)\x20or\x20(Status\x20eq\x20\x27Invited\x27\x20)or\x20(Status\x20eq\x20\x27Pending\x27)or\x20(Status\x20eq\x20\x27Accepted\x27))';extdfds=$['Deferred'](),$[_0x4c9e9e(0x1eb)](getItems(_0x34a6f6,extdfds))[_0x4c9e9e(0x222)](function(_0x413cfd){var _0x21a1c8=_0x4c9e9e;response=[],_0xe158e6=_0x413cfd[_0x21a1c8(0x12f)];});}AvilableLicenses=parseInt(UsersLicenceRequired)-(parseInt(EmployeeListUsers['length'])+parseInt(_0xe158e6));},'error':function(_0x179e04){var _0x3c6a12=_0x53629d;console[_0x3c6a12(0x216)](_0x179e04);}});}$(function(){var _0x3c91bc=a20_0x358320;$(_0x3c91bc(0x247))[_0x3c91bc(0x207)](function(){var _0x3f582b=_0x3c91bc;$(_0x3f582b(0x16e))[_0x3f582b(0x163)]()[_0x3f582b(0x158)](0x5dc)[_0x3f582b(0x152)]();var _0x51472e=document[_0x3f582b(0x170)](_0x3f582b(0x24d));GetEmployees(),LoadShowUser([]),Ready=0x0,Error=0x0,counusers=0x0;var _0x298793=/^([a-zA-Z0-9\s_\\.\-:])+(.xls|.xlsx)$/;if(_0x298793['test'](_0x51472e[_0x3f582b(0x208)][_0x3f582b(0x230)]())){if(typeof FileReader!='undefined'){var _0x3b9025=new FileReader();_0x3b9025[_0x3f582b(0x213)]?(_0x3b9025[_0x3f582b(0x1d3)]=function(_0x3c9339){var _0x5d4fd7=_0x3f582b;ProcessExcel(_0x3c9339[_0x5d4fd7(0x14e)][_0x5d4fd7(0x1bc)]);},_0x3b9025['readAsBinaryString'](_0x51472e[_0x3f582b(0x1e5)][0x0])):(_0x3b9025[_0x3f582b(0x1d3)]=function(_0x2a7d83){var _0x51477b=_0x3f582b,_0x2b5da0='',_0x264f18=new Uint8Array(_0x2a7d83[_0x51477b(0x14e)][_0x51477b(0x1bc)]);for(var _0x35fdac=0x0;_0x35fdac<_0x264f18[_0x51477b(0x257)];_0x35fdac++){_0x2b5da0+=String[_0x51477b(0x1ad)](_0x264f18[_0x35fdac]);}ProcessExcel(_0x2b5da0);},_0x3b9025[_0x3f582b(0x194)](_0x51472e['files'][0x0]));}else alert(_0x3f582b(0x13c));}else alert('Please\x20upload\x20a\x20valid\x20Excel\x20file.');});});function a20_0x46e9(){var _0x4912af=['fromCharCode','Data\x20Send\x20to\x20Announcements','application/json;\x20odata=verbose','_cell','13sBZEPD','datepicker','Welcome','Worng\x20Manager','ChangeFileName','.tabulator-page-size','Description','Required\x20Value\x20Missing','ddlfilterDepartments','Title','4514433ILVtHe','result','hide','color-red','\x27)/items?$select=ID,SiteURL&$filter=ID\x20eq\x20','EmployeeOfficeLocation','push','removeProp','Metadata','<h3\x20class=\x27m-0\x27>','show','findIndex','\x27)/items?$filter=Title\x20eq\x20\x27Client_Credentials\x27\x20','#successfully_notifications','getRow','Department\x20Id\x20is\x20not\x20Correct','message','Guest','country','<input\x20type=\x22checkbox\x22\x20class=\x22\x22\x20disabled\x20/>','Invalid\x20Profile','after','Publish_Date','167261JMcQWJ','onload','Not\x20SP\x20Permission','getQueryStringParameter','Status','Select\x20Company','find','chkDesignation',',roleDefId=','city','#added','left','SPClientPeoplePickerDict','Bearer\x20','ready','toString','CompanyIDId','#dvExcel','setPage','files','split','POST','Total\x20Row\x20Count:\x20','PendingAcceptance','Department','when','Date\x20Of\x20Joining','Location','OfficeName','#Rowcount','Approved','NotSave','companyName','Company\x20*','#Ready','_row','keyup','&$top=1','#btnsubmitready','externalUserState','input[type=radio][name=datasend]','postalCode','WebPartName','OfficeLocationId','#ddlfilterDepartments','Date\x20Of\x20Birth','Click\x20on\x20Azure\x20Sync\x20button\x20first.','EmployeeSyncReport.xlsx','checked','deselectRow','Manager\x20*','Updated','3139435CKfQsX','click','value','static','</span>','SP.User','JoiningDate','Name','/_api/web/siteusers(@v)?@v=\x27','Internal\x20','#ddlAllCompanies','Please\x20select\x20Department','</h3>\x20<p\x20class\x20=\x20\x22m-0\x22\x20>\x20Uploaded\x20</p>','readAsBinaryString','row','#ddlOfficeLocation','log','map','SearchPrincipalSource','Added','selectRow','DepartmentName','Internal\x20Users','EmployeeID','FullName','text','Wrong\x20Manager','ddlfilterOfficeLocation','done','4851SqjEdJ','.select-row_isReadeySelected','#example-table','application/json;odata=nometadata','Audience','.breakpoint','concat','manager','Type','121308oNHpgk','Home\x20Address','state','https://graph.microsoft.com/v1.0/users?$filter=mail\x20eq\x20\x27','toLowerCase','chkOfficeLocation','webAbsoluteUrl','slice','json','getElement','formatDate','6rHWqsB','close','1336hXOQOH','#Error','responseText','Company\x20Id\x20is\x20not\x20Correct','LocationName','10vhjtXT','10%','Please\x20select\x20Location','read','Company','Expires','SheetNames','width','#ddlfilterOfficeLocation','#upload','.select-row_IsMiisingSelected','EmployeeId','employeeId','Primary','PrincipalAccountType','fileUpload','i:0#.f|membership|','Departments','#Exits','dd\x20M\x20yy','Employees','Gender','ListItem','AllowMultipleValues','#AvilableLicenses','byteLength','DepartmentId','GetAllUserInfo','EmployeeName','#divAudience','15627TCKJpd','<option\x20value=\x220\x22><strong>All</strong></option>','department','center','\x20,\x20','\x27)/items','CompanyName','\x20<span\x20style=\x27color:green;\x20font-weight:bold;\x27>','/_api/web/lists/GetByTitle(\x27','modal','results','#btnAudience','LogonNameId','option','#btnDownLoadReport','<input\x20type=\x22checkbox\x22\x20class=\x22select-row_IsMiisingSelected\x22\x20aria-label=\x22select\x20this\x20row\x22\x20/>','option:selected','mm/dd/yy','Corporate','accountEnabled','append','download','Manager','length','charAt','setMonth','application/json;odata=verbose','select','#ddlDepartment','IsMiisingSelected','empty','Deferred','focus','764gFUYSK','remove','chkGroup','This\x20browser\x20does\x20not\x20support\x20HTML5.','.form-check-input','#lblUpdate','/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=999&$select=ID,AttachmentFiles,FullName,Designation,Manager,MobileNumber,ExtensionName,Email,LogonName/UserName,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department,AttachmentFiles\x20&$filter=\x20PrimaryCompany\x20eq\x20\x27Primary\x27\x20and\x20Status\x20eq\x20\x27Active\x27\x20','#txtmanager','PATCH','EmployeeDepartment','val','otherMails','<input\x20type=\x22checkbox\x22\x20id=\x22isReadeySelected\x22\x20onclick=\x22isReadeySelecteds()\x22\x20/>','#overlaysearch','#txtGroup','#txtDesignation','resolve','streetAddress','@odata.nextLink','DateOfJoining','MaximumEntitySuggestions','target','displayName','/_api/web/siteusers?$top=1000&$select=*,Id','filter','fadeOut','chkTopExecutive','Already\x20Exist','/_api/web/lists/getByTitle(\x27OfficeLocation\x27)/items?$select=*','getSelectedRows','innerHTML','delay','/_api/web/lists/getbytitle(\x27','Your\x20License\x20limit\x20has\x20been\x20ended','Email','employeeHireDate','[id$=\x27AssaginTomanager_TopSpan\x27]','#UploadedItems','siteAbsoluteUrl','mail','OfficeLocation','join','fadeIn','User,DL,SecGroup,SPGroup','EnvironmentalSettings','setHours','1996272aostfJ','mobilePhone','error1','#IsMiisingSelected','Chief\x20Executive','/_api/web/sitegroups(','isReadeySelected','#overlayq','GET','getElementById','#ddlfilterAllCompanies','/_api/web/lists/getByTitle(\x27Companies\x27)/items?$select=*','Ready','OfficeNameDetail','ajax','\x27)/items?$select=ID&$filter=ID\x20eq\x20','data','userType','promise','Announcement_Type','Data\x20Send\x20to\x20Announcements\x20Failed','https://graph.microsoft.com','html','createElement','ddlOfficeLocation','/_api/web/lists/GetByTitle(\x27Announcements\x27)/items','#__REQUESTDIGEST','Group\x20Name','round','All','/_api/web/lists/getByTitle(\x27Departments\x27)/items?$select=*','SPClientPeoplePicker_InitStandaloneControlWrapper','#UploadExcel','ddlDepartment','sheet_to_row_object_array','Department\x20*','https://graph.microsoft.com/v1.0/users?$top=999&$select=mail,displayName,userPrincipalName,department,officeLocation,companyName,otherMails,userType,identities,creationType,externalUserState,externalUserState,country,employeeId,jobTitle,postalCode,state,streetAddress,city,mobilePhone,accountEnabled,employeeHireDate\x20&$expand=manager($levels=max;$select=id,displayName,mail)','.searching','stringify','<option\x20value=\x22','prop','change','chkManager','.sp-peoplepicker-editorInput','readonly','readAsArrayBuffer','__next','application/json','ApprovalStatus','#btnadsync','CompanyId','DepartmentsId','190fUKRvN','reject','chkDepartment','EntityData','indexOf','OfficeLocationsId','deselect','Designation','15%','<span\x20class=\x27breakpoint\x27></span>','Active','jobTitle','EmpUserId','appendChild','Email\x20*','setData','#isReadeySelected','officeLocation'];a20_0x46e9=function(){return _0x4912af;};return a20_0x46e9();}function ProcessExcel(_0x553e87){var _0xe15fd7=a20_0x358320,_0x8775d6=XLSX[_0xe15fd7(0x241)](_0x553e87,{'type':'binary'}),_0x254ceb=_0x8775d6[_0xe15fd7(0x244)][0x0];excelRows=XLSX['utils'][_0xe15fd7(0x189)](_0x8775d6['Sheets'][_0x254ceb]),$(_0xe15fd7(0x15e))[_0xe15fd7(0x136)](),$(_0xe15fd7(0x15e))[_0xe15fd7(0x12c)](_0xe15fd7(0x1c4)+excelRows['length']+_0xe15fd7(0x212)),$(_0xe15fd7(0x1e3))[_0xe15fd7(0x17d)]('');for(var _0x124305=0x0;_0x124305<excelRows[_0xe15fd7(0x12f)];_0x124305++){var _0x1a2df2='';ErrorUser='';var _0x34d4b9=EmployeeListUsers['filter'](function(_0xff71af){var _0x255940=_0xe15fd7,_0x297967=_0xff71af['Email'][_0x255940(0x230)]();return _0x297967==excelRows[_0x124305]['Email\x20*'][_0x255940(0x230)]();});if(_0x34d4b9[_0xe15fd7(0x12f)]>0x0){_0x1a2df2=_0x34d4b9[0x0][_0xe15fd7(0x21e)],color_red=_0xe15fd7(0x1be),ErrorUser=_0xe15fd7(0x154),Exits=Exits+0x1;var _0xefe333=_0x34d4b9[0x0]['ID'];excelRows[_0x124305][_0xe15fd7(0x1f3)]='-',excelRows[_0x124305][_0xe15fd7(0x18a)]='-',excelRows[_0x124305]['Location\x20*']='-';}else{var _0x4bfb3b=AzureUsrlist[_0xe15fd7(0x151)](function(_0x5550e0){var _0x49128e=_0xe15fd7;if(_0x5550e0[_0x49128e(0x160)]!=null){var _0x424385=_0x5550e0['mail'][_0x49128e(0x230)]();return _0x424385==excelRows[_0x124305][_0x49128e(0x1a9)][_0x49128e(0x230)]();}});if(_0x4bfb3b[_0xe15fd7(0x12f)]>0x0){_0x1a2df2=_0x4bfb3b[0x0][_0xe15fd7(0x14f)];var _0x4b3acc=AllCompanies[_0xe15fd7(0x151)](function(_0x568b6b){var _0x640575=_0xe15fd7;return _0x568b6b['ID']==excelRows[_0x124305][_0x640575(0x1f3)];}),_0xfde7fe=AllDepartments[_0xe15fd7(0x151)](function(_0x24c7a9){return _0x24c7a9['ID']==excelRows[_0x124305]['Department\x20*'];}),_0x5a7874=AllOfficeLocation[_0xe15fd7(0x151)](function(_0x2ba4ff){return _0x2ba4ff['ID']==excelRows[_0x124305]['Location\x20*'];});_0x4b3acc[_0xe15fd7(0x12f)]>0x0&&_0xfde7fe[_0xe15fd7(0x12f)]>0x0&&_0x5a7874[_0xe15fd7(0x12f)]>0x0?(Ready=Ready+0x1,ErrorUser=_0xe15fd7(0x173),excelRows[_0x124305]['DepartmentNameDetail']=_0xfde7fe[0x0][_0xe15fd7(0x21b)],excelRows[_0x124305][_0xe15fd7(0x174)]=_0x5a7874[0x0][_0xe15fd7(0x1ee)]):(ErrorUser='Required\x20Value\x20Missing',Error=Error+0x1);}else ErrorUser=_0xe15fd7(0x1cf),color_red=_0xe15fd7(0x1be),Error=Error+0x1;}excelRows[_0x124305][_0xe15fd7(0x20d)]=_0x1a2df2,excelRows[_0x124305]['id']=_0x124305,excelRows[_0x124305][_0xe15fd7(0x1d6)]=ErrorUser,excelRows[_0x124305][_0xe15fd7(0x1a7)]=_0xefe333;}alluserdata=excelRows,LoadShowUser(excelRows);}function CompaniesDetails(){var _0x1f8083=a20_0x358320,_0x7ed15c=document[_0x1f8083(0x170)]('ddlAllCompanies');_0x7ed15c[_0x1f8083(0x157)]='',opt[_0x1f8083(0x208)]='0',opt[_0x1f8083(0x21f)]=_0x1f8083(0x1d7),_0x7ed15c[_0x1f8083(0x1a8)](opt);for(var _0x157b93=0x0;_0x157b93<AllCompanies[_0x1f8083(0x12f)];_0x157b93++){var _0x134ddc=AllCompanies[_0x157b93][_0x1f8083(0x11e)],_0x281fd6=AllCompanies[_0x157b93]['ID'];opt=document[_0x1f8083(0x17e)](_0x1f8083(0x125)),opt[_0x1f8083(0x208)]=_0x281fd6,opt[_0x1f8083(0x21f)]=_0x134ddc,_0x7ed15c[_0x1f8083(0x1a8)](opt);}$(_0x1f8083(0x13d))[_0x1f8083(0x18f)](_0x1f8083(0x202),![]),$(_0x1f8083(0x140))['val'](''),$(_0x1f8083(0x147))[_0x1f8083(0x143)](''),$(_0x1f8083(0x148))[_0x1f8083(0x143)]('');}$('#btnUploadExcel')[a20_0x358320(0x207)](function(){var _0x5d3de0=a20_0x358320,_0x544527=tabledata['getSelectedRows']();debugger;_0x544527[_0x5d3de0(0x12f)]>0x0?(CompaniesDetails(),$('#UploadExcel')[_0x5d3de0(0x121)](_0x5d3de0(0x1c5)),initializePeoplePicker('AssaginTomanager'),peoplePickerDiv=$(_0x5d3de0(0x15d))):alert('Please\x20select\x20required\x20value\x20missing\x20row');});var GetDepartments,Getofficelocation,GetDesignation,GetGroup,CompaniesId,GetofficelocationName,GetDepartmentsName,CompaniesName;$('#btnmissingrequedvalue')['click'](function(){var _0x1e674a=a20_0x358320;if(document[_0x1e674a(0x170)](_0x1e674a(0x19d))['checked']==!![]||document['getElementById'](_0x1e674a(0x231))[_0x1e674a(0x202)]==!![]||document['getElementById'](_0x1e674a(0x1d9))[_0x1e674a(0x202)]==!![]||document[_0x1e674a(0x170)](_0x1e674a(0x191))[_0x1e674a(0x202)]==!![]||document[_0x1e674a(0x170)](_0x1e674a(0x153))[_0x1e674a(0x202)]==!![]||document['getElementById']('chkGroup')[_0x1e674a(0x202)]==!![]){var _0x44b028=tabledata[_0x1e674a(0x156)](),_0x32b9b4=SPClientPeoplePicker[_0x1e674a(0x1de)][peoplePickerDiv[0x0]['id']],_0x3f146d=_0x32b9b4[_0x1e674a(0x115)]();for(var _0x252f1d=0x0;_0x252f1d<_0x44b028['length'];_0x252f1d++){var _0x12c1dc=excelRows['findIndex'](_0x33a113=>_0x33a113[_0x1e674a(0x15b)]==_0x44b028[_0x252f1d]['_row'][_0x1e674a(0x177)][_0x1e674a(0x15b)]);if(excelRows[_0x12c1dc]['Status']==_0x1e674a(0x154))excelRows[_0x12c1dc][_0x1e674a(0x242)]='-',excelRows[_0x12c1dc]['Department']='-',excelRows[_0x12c1dc][_0x1e674a(0x1ed)]='-',document[_0x1e674a(0x170)](_0x1e674a(0x1d9))[_0x1e674a(0x202)]&&(excelRows[_0x12c1dc][_0x1e674a(0x1a2)]=$('#txtDesignation')[_0x1e674a(0x143)]()),document[_0x1e674a(0x170)](_0x1e674a(0x191))[_0x1e674a(0x202)]&&(excelRows[_0x12c1dc]['Manager']=_0x3f146d[0x0][_0x1e674a(0x19e)][_0x1e674a(0x15b)]),document['getElementById']('chkTopExecutive')[_0x1e674a(0x202)]&&(excelRows[_0x12c1dc][_0x1e674a(0x12e)]=_0x1e674a(0x16b)),document[_0x1e674a(0x170)](_0x1e674a(0x13b))[_0x1e674a(0x202)]&&(excelRows[_0x12c1dc][_0x1e674a(0x182)]=$(_0x1e674a(0x147))['val']());else{if(excelRows[_0x12c1dc][_0x1e674a(0x1d6)]==_0x1e674a(0x1b8)||excelRows[_0x12c1dc][_0x1e674a(0x1d6)]==_0x1e674a(0x173)){document['getElementById'](_0x1e674a(0x19d))[_0x1e674a(0x202)]&&(excelRows[_0x12c1dc][_0x1e674a(0x242)]=CompaniesId,excelRows[_0x12c1dc][_0x1e674a(0x11e)]=CompaniesName,excelRows[_0x12c1dc][_0x1e674a(0x1ea)]=GetDepartments,excelRows[_0x12c1dc][_0x1e674a(0x21b)]=GetDepartmentsName);document[_0x1e674a(0x170)]('chkOfficeLocation')[_0x1e674a(0x202)]&&(excelRows[_0x12c1dc][_0x1e674a(0x242)]=CompaniesId,excelRows[_0x12c1dc][_0x1e674a(0x11e)]=CompaniesName,excelRows[_0x12c1dc][_0x1e674a(0x1ed)]=Getofficelocation,excelRows[_0x12c1dc][_0x1e674a(0x23d)]=GetofficelocationName);document['getElementById'](_0x1e674a(0x1d9))[_0x1e674a(0x202)]&&(excelRows[_0x12c1dc][_0x1e674a(0x1a2)]=$(_0x1e674a(0x148))[_0x1e674a(0x143)]());document[_0x1e674a(0x170)](_0x1e674a(0x191))[_0x1e674a(0x202)]&&(excelRows[_0x12c1dc][_0x1e674a(0x12e)]=_0x3f146d[0x0][_0x1e674a(0x19e)][_0x1e674a(0x15b)]);document[_0x1e674a(0x170)](_0x1e674a(0x153))['checked']&&(excelRows[_0x12c1dc]['Manager']=_0x1e674a(0x16b));document[_0x1e674a(0x170)](_0x1e674a(0x13b))[_0x1e674a(0x202)]&&(excelRows[_0x12c1dc][_0x1e674a(0x182)]=$(_0x1e674a(0x147))[_0x1e674a(0x143)]());var _0x3d8655=AllCompanies[_0x1e674a(0x151)](function(_0x42dd7a){var _0x177650=_0x1e674a;return _0x42dd7a['ID']==excelRows[_0x12c1dc][_0x177650(0x242)];}),_0x4291bd=AllDepartments[_0x1e674a(0x151)](function(_0x408846){var _0x2db1d5=_0x1e674a;return _0x408846['ID']==excelRows[_0x12c1dc][_0x2db1d5(0x1ea)];}),_0x25c47e=AllOfficeLocation['filter'](function(_0x581396){var _0x247976=_0x1e674a;return _0x581396['ID']==excelRows[_0x12c1dc][_0x247976(0x1ed)];});_0x3d8655['length']>0x0&&_0x4291bd[_0x1e674a(0x12f)]>0x0&&_0x25c47e[_0x1e674a(0x12f)]>0x0?(Ready=Ready+0x1,Error=Error-0x1,excelRows[_0x12c1dc][_0x1e674a(0x1d6)]='Ready'):(excelRows[_0x12c1dc]['Status']='Required\x20Value\x20Missing',Error=Error+0x1);}else excelRows[_0x12c1dc]['Status']==_0x1e674a(0x220)&&(document['getElementById'](_0x1e674a(0x1d9))['checked']&&(excelRows[_0x12c1dc][_0x1e674a(0x1a2)]=$(_0x1e674a(0x148))[_0x1e674a(0x143)]()),document[_0x1e674a(0x170)](_0x1e674a(0x191))[_0x1e674a(0x202)]&&(excelRows[_0x12c1dc]['Manager']=_0x3f146d[0x0]['EntityData'][_0x1e674a(0x15b)]),document[_0x1e674a(0x170)](_0x1e674a(0x153))[_0x1e674a(0x202)]&&(excelRows[_0x12c1dc]['Manager']=_0x1e674a(0x16b)),document['getElementById'](_0x1e674a(0x13b))['checked']&&(excelRows[_0x12c1dc][_0x1e674a(0x182)]=$(_0x1e674a(0x147))[_0x1e674a(0x143)]()),Ready=Ready+0x1,Error=Error-0x1,excelRows[_0x12c1dc][_0x1e674a(0x1d6)]=_0x1e674a(0x173));}}tabledata[_0x1e674a(0x1aa)](excelRows),tabledata[_0x1e674a(0x1e4)](pageIndex),$(_0x1e674a(0x187))['modal']('hide'),showmessage();}else alert('please\x20check\x20at\x20list\x20one\x20checkbox\x20'),$('select#dropDownId\x20option:selected')[_0x1e674a(0x143)]();}),$(a20_0x358320(0x210))[a20_0x358320(0x190)](function(){var _0x400599=a20_0x358320;CompaniesId=parseInt($(_0x400599(0x128),$(this))[_0x400599(0x143)]()),CompaniesName=$(_0x400599(0x128),$(this))[_0x400599(0x21f)]();var _0x2e6ca8=AllOfficeLocation['filter'](function(_0x147c5e){return _0x147c5e['CompanyIDId']===CompaniesId;}),_0x390cdf=document[_0x400599(0x170)](_0x400599(0x17f));_0x390cdf['innerHTML']='';for(var _0xa3396c=0x0;_0xa3396c<_0x2e6ca8[_0x400599(0x12f)];_0xa3396c++){var _0x318eec=_0x2e6ca8[_0xa3396c][_0x400599(0x1ee)],_0x1771cf=_0x2e6ca8[_0xa3396c]['ID'];opt=document['createElement'](_0x400599(0x125)),opt['value']=_0x1771cf,opt[_0x400599(0x21f)]=_0x318eec,_0x390cdf[_0x400599(0x1a8)](opt);}Getofficelocation=parseInt($('option:selected',$(_0x400599(0x215)))[_0x400599(0x143)]()),GetofficelocationName=$(_0x400599(0x128),$('#ddlOfficeLocation'))[_0x400599(0x21f)]();var _0x1a79ee=AllDepartments['filter'](function(_0x21b5a3){var _0x3d5035=_0x400599;return _0x21b5a3[_0x3d5035(0x1e2)]===CompaniesId;}),_0x390cdf=document[_0x400599(0x170)](_0x400599(0x188));_0x390cdf['innerHTML']='';for(var _0xa3396c=0x0;_0xa3396c<_0x1a79ee[_0x400599(0x12f)];_0xa3396c++){var _0x318eec=_0x1a79ee[_0xa3396c][_0x400599(0x21b)],_0x1771cf=_0x1a79ee[_0xa3396c]['ID'];opt=document['createElement'](_0x400599(0x125)),opt[_0x400599(0x208)]=_0x1771cf,opt[_0x400599(0x21f)]=_0x318eec,_0x390cdf[_0x400599(0x1a8)](opt);}GetDepartments=parseInt($(_0x400599(0x128),$(_0x400599(0x134)))[_0x400599(0x143)]()),GetDepartmentsName=$(_0x400599(0x128),$(_0x400599(0x134)))[_0x400599(0x21f)]();}),$('#ddlDepartment')[a20_0x358320(0x190)](function(){var _0x470a9f=a20_0x358320;GetDepartments=parseInt($(_0x470a9f(0x128),$(this))[_0x470a9f(0x143)]()),GetDepartmentsName=$(_0x470a9f(0x128),$(_0x470a9f(0x134)))[_0x470a9f(0x21f)]();}),$(a20_0x358320(0x215))['change'](function(){var _0x214bd5=a20_0x358320;Getofficelocation=parseInt($(_0x214bd5(0x128),$(this))[_0x214bd5(0x143)]()),GetofficelocationName=$(_0x214bd5(0x128),$(_0x214bd5(0x215)))[_0x214bd5(0x21f)]();});function chkManagerevent(_0x59df33){var _0x215e1f=a20_0x358320;if(_0x59df33[_0x215e1f(0x202)])$('#chkTopExecutive')['prop']('checked',![]),$(_0x215e1f(0x140))[_0x215e1f(0x1c2)](_0x215e1f(0x193)),$(_0x215e1f(0x140))[_0x215e1f(0x138)]();else{}}var TopExecutive='';function chkTopExecutiveevent(_0x40b866){var _0x3802fe=a20_0x358320;if(_0x40b866[_0x3802fe(0x202)])$('#chkManager')[_0x3802fe(0x18f)](_0x3802fe(0x202),![]),$(_0x3802fe(0x140))[_0x3802fe(0x18f)](_0x3802fe(0x193),!![]),$('#txtmanager')[_0x3802fe(0x143)](''),TopExecutive=_0x3802fe(0x16b);else{}}$(a20_0x358320(0x126))[a20_0x358320(0x207)](function(){var _0x425068=a20_0x358320;tabledata[_0x425068(0x12d)]('xlsx',_0x425068(0x201),{'sheetName':'EmployeeSyncreport'});});var dvExcel=document[a20_0x358320(0x170)]('exceltble');dvExcel[a20_0x358320(0x157)]='';var outputArray=[];function removewithfilter(_0x1bf08f){var _0x514700=a20_0x358320;let _0x136f9b=_0x1bf08f[_0x514700(0x151)](function(_0x16fe41,_0x4cd9c7,_0x39f68b){var _0x5f0b30=_0x514700;return _0x4cd9c7==_0x39f68b[_0x5f0b30(0x19f)](_0x16fe41);});return _0x136f9b;}function GetItemTypeForListName(_0x1dcb25){var _0xc95c12=a20_0x358320;return'SP.Data.'+_0x1dcb25[_0xc95c12(0x130)](0x0)['toUpperCase']()+_0x1dcb25[_0xc95c12(0x1e6)]('\x20')[_0xc95c12(0x162)]('')[_0xc95c12(0x233)](0x1)+_0xc95c12(0x254);}function a20_0x6b1c(_0x23b60c,_0x468f15){var _0x46e9fc=a20_0x46e9();return a20_0x6b1c=function(_0x6b1cd9,_0x3ddd22){_0x6b1cd9=_0x6b1cd9-0x115;var _0x139d33=_0x46e9fc[_0x6b1cd9];return _0x139d33;},a20_0x6b1c(_0x23b60c,_0x468f15);}var response=response||[];function getItems(_0x5af994,_0x16571b){var _0x1deb2d=a20_0x358320;return $[_0x1deb2d(0x175)]({'url':_0x5af994,'type':'GET','async':![],'headers':{'accept':'application/json;odata=verbose'},'success':function(_0x3d27b2){var _0x2e36a0=_0x1deb2d;response=response[_0x2e36a0(0x229)](_0x3d27b2['d'][_0x2e36a0(0x122)]),_0x3d27b2['d'][_0x2e36a0(0x195)]?(_0x5af994=_0x3d27b2['d'][_0x2e36a0(0x195)],getItems(_0x5af994,_0x16571b)):_0x16571b[_0x2e36a0(0x149)](response);},'error':function(_0x34ea2a){var _0x1b05d7=_0x1deb2d;_0x16571b[_0x1b05d7(0x19c)](_0x34ea2a),console[_0x1b05d7(0x216)](_0x34ea2a);}}),_0x16571b[_0x1deb2d(0x179)]();}function InsertWelcomeInAnnouncementList(_0x493b6f){var _0x2fa5f3=a20_0x358320;$[_0x2fa5f3(0x175)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x2fa5f3(0x180),'type':_0x2fa5f3(0x1e7),'async':![],'data':JSON['stringify'](_0x493b6f),'headers':{'Accept':_0x2fa5f3(0x132),'Content-Type':'application/json;odata=verbose','X-RequestDigest':$(_0x2fa5f3(0x181))[_0x2fa5f3(0x143)](),'X-HTTP-Method':_0x2fa5f3(0x1e7)},'success':function(_0x4520a4,_0x2096d2,_0x316c61){var _0xe2fcf5=_0x2fa5f3;console[_0xe2fcf5(0x216)](_0xe2fcf5(0x1ae));},'error':function(_0x2e2f63){var _0x4ac0e8=_0x2fa5f3;console[_0x4ac0e8(0x216)](_0x2e2f63),console['log'](_0x4ac0e8(0x17b)),currentDlg[_0x4ac0e8(0x238)]();}});}