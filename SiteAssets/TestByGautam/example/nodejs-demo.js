var a457_0x3e4e4a=a457_0x1b35;(function(_0x29b716,_0x39f724){var _0x5cd2c4=a457_0x1b35,_0x584140=_0x29b716();while(!![]){try{var _0x33be9f=parseInt(_0x5cd2c4(0x1d9))/0x1*(parseInt(_0x5cd2c4(0x1b7))/0x2)+parseInt(_0x5cd2c4(0x190))/0x3*(parseInt(_0x5cd2c4(0x1b1))/0x4)+parseInt(_0x5cd2c4(0x19f))/0x5*(parseInt(_0x5cd2c4(0x1d7))/0x6)+-parseInt(_0x5cd2c4(0x19b))/0x7*(-parseInt(_0x5cd2c4(0x1bb))/0x8)+parseInt(_0x5cd2c4(0x1b2))/0x9+-parseInt(_0x5cd2c4(0x1f5))/0xa+-parseInt(_0x5cd2c4(0x1f1))/0xb;if(_0x33be9f===_0x39f724)break;else _0x584140['push'](_0x584140['shift']());}catch(_0x53dd12){_0x584140['push'](_0x584140['shift']());}}}(a457_0x31d7,0x99509));process[a457_0x3e4e4a(0x1f9)][a457_0x3e4e4a(0x189)]<0x5&&(console['log']('*ERROR*:\x20Not\x20enough\x20arguments\x20provided\x0a'),console['log'](a457_0x3e4e4a(0x1a7)),console[a457_0x3e4e4a(0x194)]('Example..:\x20node\x20nodejs-demo.js\x20admin@billg.onmicrosoft.com\x20c@ashm0ney\x20https://billg.sharepoint.com'),process[a457_0x3e4e4a(0x1a3)](-0x1));var fs=require('fs'),https=require(a457_0x3e4e4a(0x1e0)),sprLib;fs[a457_0x3e4e4a(0x192)]('../dist/sprestlib.js')?sprLib=require(a457_0x3e4e4a(0x1ff)):sprLib=require(a457_0x3e4e4a(0x1bc));(!sprLib||!sprLib[a457_0x3e4e4a(0x1ed)])&&(console['log'](a457_0x3e4e4a(0x191)),console['log']('sprLib\x20does\x20not\x20exist!'),process[a457_0x3e4e4a(0x1a3)](-0x1));function a457_0x31d7(){var _0x278dc5=['750sxlQuO','------------------------------------------------------------','resolve','application/x-www-form-urlencoded','exit','\x20\x20\x20\x20\x20\x20\x20\x20<a:EndpointReference><a:Address>','================================================================================','message','Usage....:\x20node\x20nodejs-demo.js\x20[spUsername]\x20[spPassword]\x20[spHostUrl]','\x20\x20\x20\x20\x20\x20</o:UsernameToken>','problem\x20with\x20request:\x20','folder','\x20\x20\x20\x20</o:Security>','info','binary','---------------------------------------------','from','`\x20uploaded\x20to:\x20`','3668RwcqqE','3013317sStstE','then','Announcements','catch','firstChild','1934cJWcco','renewSecurityToken','sprestlib-demo.html','SUCCESS:\x20\x22','1896FkYihr','sprestlib','Site\x20Assets','\x20\x20\x20\x20\x20\x20\x20\x20<o:Password>','getElementsByTagName','SUCCESS:\x20`','set-cookie','documentElement','POST','\x20\x20\x20\x20\x20\x20<t:RequestType>http://schemas.xmlsoap.org/ws/2005/02/trust/Issue</t:RequestType>','Email','\x0a================================================================================','----------------------------','toLowerCase','/sites/dev/','\x20\x20</s:Body>','\x0aTEST\x205:\x20sprLib.file().get()\x20-\x20get\x20a\x20file\x20from\x20\x27Shared\x20Documents\x27\x20Library','parseFromString','error','\x20\x20\x20\x20<a:ReplyTo><a:Address>http://www.w3.org/2005/08/addressing/anonymous</a:Address></a:ReplyTo>','toISOString','-----------------------------------------','substring','utf8','/extSTS.srf','\x20\x20\x20\x20<a:Action\x20s:mustUnderstand=\x221\x22>http://schemas.xmlsoap.org/ws/2005/02/trust/RST/Issue</a:Action>','DOMParser','\x0aTEST\x204:\x20sprLib.rest()\x20-\x20upload\x20a\x20local\x20file\x20to\x20\x27Shared\x20Documents\x27\x20Library','42852wRMVUv','\x20\x20<s:Body>','829bUeBVS','node-file-get-','\x20*\x20SUCCESS!!\x20Authenticated\x20into\x20\x22','get','https://','ItemCount','write','https','</o:Username>','Invalid\x20Username/Password','replace','nodeValue','upload','indexOf','file','setEncoding','\x20*\x20STEP\x202/2:\x20Auth\x20into\x20SharePoint\x20...','</a:Address></a:EndpointReference>','FAIL:\x20`fileBuffer`\x20is\x20empty','Created....:\x20','version','/sites/dev/Shared\x20Documents/','\x0aTEST\x201:\x20sprLib.user().info()','item','12478477tEhqjB','login.microsoftonline.com','end','baseUrl','6292530HgzOoY','\x20\x20\x20\x20\x20\x20<wsp:AppliesTo\x20xmlns:wsp=\x22http://schemas.xmlsoap.org/ws/2004/09/policy\x22>','user','gStrReqDig..:\x20','argv','create','Created','nodeConfig','\x20\x20<s:Header>','headers','../dist/sprestlib.js','\x20\x20\x20\x20<a:To\x20s:mustUnderstand=\x221\x22>https://login.microsoftonline.com/extSTS.srf</a:To>','Email......:\x20','length','\x20\x20\x20\x20\x20\x20\x20\x20<o:Username>','Title......:\x20','created\x20with\x20Node\x20demo','LoginName..:\x20','Title','writeFileSync','3OSHiKS','\x0aERROR:','existsSync','http://','log','ItemCount..:\x20','wsse:BinarySecurityToken','text/xml','request','readFileSync','</s:Envelope>','5404vGevmE','Id.........:\x20','\x0aTEST\x203:\x20sprLib.list(\x27Announcements\x27).create()','..\x0a..create\x20done!'];a457_0x31d7=function(){return _0x278dc5;};return a457_0x31d7();}function a457_0x1b35(_0x4c02d4,_0x59b21d){var _0x31d7b0=a457_0x31d7();return a457_0x1b35=function(_0x1b352e,_0x40b22d){_0x1b352e=_0x1b352e-0x188;var _0x8ec662=_0x31d7b0[_0x1b352e];return _0x8ec662;},a457_0x1b35(_0x4c02d4,_0x59b21d);}sprLib['nodeConfig']({'nodeEnabled':!![]}),console['log']('\x0aStarting\x20demo...'),console[a457_0x3e4e4a(0x194)](a457_0x3e4e4a(0x1a5)),console[a457_0x3e4e4a(0x194)]('>\x20SpRestLib\x20version:\x20'+sprLib[a457_0x3e4e4a(0x1ed)]+'\x0a');var SP_USER=process[a457_0x3e4e4a(0x1f9)][0x2],SP_PASS=process['argv'][0x3],SP_URL=process[a457_0x3e4e4a(0x1f9)][0x4][a457_0x3e4e4a(0x1e3)](/\/$/gi,''),SP_HOST=SP_URL[a457_0x3e4e4a(0x1c8)]()['replace'](a457_0x3e4e4a(0x1dd),'')['replace'](a457_0x3e4e4a(0x193),''),gBinarySecurityToken='',gAuthCookie1='',gAuthCookie2='',gStrReqDig='',gStrFilePath=a457_0x3e4e4a(0x1ee),gStrFileLoca='./',gStrFileName=a457_0x3e4e4a(0x1b9);Promise[a457_0x3e4e4a(0x1a1)]()[a457_0x3e4e4a(0x1b3)](()=>{var _0x1437cc=a457_0x3e4e4a;return console[_0x1437cc(0x194)]('\x20*\x20STEP\x201/2:\x20Auth\x20into\x20login.microsoftonline.com\x20...'),new Promise(function(_0x272791,_0x2c4477){var _0x2fd6e3=_0x1437cc,_0x1b096a='<s:Envelope\x20xmlns:s=\x22http://www.w3.org/2003/05/soap-envelope\x22\x20xmlns:a=\x22http://www.w3.org/2005/08/addressing\x22\x20xmlns:u=\x22http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\x22>\x0a'+_0x2fd6e3(0x1fd)+_0x2fd6e3(0x1d4)+_0x2fd6e3(0x1ce)+_0x2fd6e3(0x200)+'\x20\x20\x20\x20<o:Security\x20s:mustUnderstand=\x221\x22\x20xmlns:o=\x22http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\x22>'+'\x20\x20\x20\x20\x20\x20<o:UsernameToken>'+_0x2fd6e3(0x18a)+SP_USER+_0x2fd6e3(0x1e1)+_0x2fd6e3(0x1be)+SP_PASS+'</o:Password>'+_0x2fd6e3(0x1a8)+_0x2fd6e3(0x1ab)+'\x20\x20</s:Header>'+_0x2fd6e3(0x1d8)+'\x20\x20\x20\x20<t:RequestSecurityToken\x20xmlns:t=\x22http://schemas.xmlsoap.org/ws/2005/02/trust\x22>'+_0x2fd6e3(0x1f6)+_0x2fd6e3(0x1a4)+SP_URL+_0x2fd6e3(0x1ea)+'\x20\x20\x20\x20\x20\x20</wsp:AppliesTo>'+'\x20\x20\x20\x20\x20\x20<t:KeyType>http://schemas.xmlsoap.org/ws/2005/05/identity/NoProofKey</t:KeyType>'+_0x2fd6e3(0x1c4)+'\x20\x20\x20\x20\x20\x20<t:TokenType>urn:oasis:names:tc:SAML:1.0:assertion</t:TokenType>'+'\x20\x20\x20\x20</t:RequestSecurityToken>'+_0x2fd6e3(0x1ca)+_0x2fd6e3(0x19a),_0x1dec72={'hostname':_0x2fd6e3(0x1f2),'path':_0x2fd6e3(0x1d3),'method':_0x2fd6e3(0x1c3),'headers':{'Content-Type':'application/x-www-form-urlencoded','Content-Length':_0x1b096a[_0x2fd6e3(0x189)]}},_0x2d8ed3=https[_0x2fd6e3(0x198)](_0x1dec72,_0xc009e=>{var _0x5d5965=_0x2fd6e3;let _0x5afdc2='';_0xc009e[_0x5d5965(0x1e8)](_0x5d5965(0x1d2)),_0xc009e['on']('data',_0x4e6a36=>_0x5afdc2+=_0x4e6a36),_0xc009e['on'](_0x5d5965(0x1f3),()=>{var _0xbd93bd=_0x5d5965,_0x2fe8c4=require('xmldom')[_0xbd93bd(0x1d5)],_0x47ca9e=new _0x2fe8c4()[_0xbd93bd(0x1cc)](_0x5afdc2,_0xbd93bd(0x197));_0x47ca9e[_0xbd93bd(0x1c2)][_0xbd93bd(0x1bf)](_0xbd93bd(0x196))[_0xbd93bd(0x1f0)](0x0)?(gBinarySecurityToken=_0x47ca9e['documentElement'][_0xbd93bd(0x1bf)]('wsse:BinarySecurityToken')[_0xbd93bd(0x1f0)](0x0)[_0xbd93bd(0x1b6)][_0xbd93bd(0x1e4)],_0x272791()):_0x2c4477(_0xbd93bd(0x1e2));});});_0x2d8ed3['on'](_0x2fd6e3(0x1cd),_0x4397d6=>{var _0x40f713=_0x2fd6e3;console[_0x40f713(0x194)](_0x40f713(0x1a9)+_0x4397d6[_0x40f713(0x1a6)]),_0x2c4477();}),_0x2d8ed3[_0x2fd6e3(0x1df)](_0x1b096a),_0x2d8ed3['end']();});})[a457_0x3e4e4a(0x1b3)](()=>{var _0x15c7f1=a457_0x3e4e4a;return console['log'](_0x15c7f1(0x1e9)),new Promise(function(_0xa00e11,_0x386cdc){var _0x1ed775=_0x15c7f1,_0x3f1106={'hostname':SP_HOST,'agent':![],'path':'/_forms/default.aspx?wa=wsignin1.0','method':_0x1ed775(0x1c3),'headers':{'Content-Type':_0x1ed775(0x1a2),'Content-Length':gBinarySecurityToken[_0x1ed775(0x189)],'Host':SP_HOST}},_0x352cba=https['request'](_0x3f1106,_0xb2b612=>{var _0xaeeca9=_0x1ed775;gAuthCookie1=_0xb2b612[_0xaeeca9(0x1fe)]['set-cookie'][0x0]['substring'](0x0,_0xb2b612[_0xaeeca9(0x1fe)][_0xaeeca9(0x1c1)][0x0][_0xaeeca9(0x1e6)](';')),gAuthCookie2=_0xb2b612[_0xaeeca9(0x1fe)][_0xaeeca9(0x1c1)][0x1][_0xaeeca9(0x1d1)](0x0,_0xb2b612[_0xaeeca9(0x1fe)][_0xaeeca9(0x1c1)][0x1][_0xaeeca9(0x1e6)](';')),_0xa00e11();});_0x352cba['on'](_0x1ed775(0x1cd),_0x103f47=>{var _0x48d9f4=_0x1ed775;console[_0x48d9f4(0x194)](_0x48d9f4(0x1a9)+_0x103f47['message']),_0x386cdc(_0x103f47);}),_0x352cba[_0x1ed775(0x1df)](gBinarySecurityToken),_0x352cba[_0x1ed775(0x1f3)]();});})[a457_0x3e4e4a(0x1b3)](_0x35f951=>{var _0x21d52a=a457_0x3e4e4a;return console['log'](_0x21d52a(0x1db)+SP_HOST+'\x22'),sprLib[_0x21d52a(0x1fc)]({'cookie':gAuthCookie1+'\x20;'+gAuthCookie2,'server':SP_HOST}),sprLib[_0x21d52a(0x1f4)](_0x21d52a(0x1c9)),sprLib[_0x21d52a(0x1f7)]()['info']();})[a457_0x3e4e4a(0x1b3)](_0x2227db=>{var _0x46845d=a457_0x3e4e4a;return console['log'](_0x46845d(0x1ef)),console[_0x46845d(0x194)](_0x46845d(0x1c7)),console['log'](_0x46845d(0x19c)+_0x2227db['Id']),console['log'](_0x46845d(0x18b)+_0x2227db[_0x46845d(0x18e)]),console['log'](_0x46845d(0x18d)+_0x2227db['LoginName']),console[_0x46845d(0x194)](_0x46845d(0x188)+_0x2227db[_0x46845d(0x1c5)]),sprLib['list'](_0x46845d(0x1bd))[_0x46845d(0x1ac)]();})[a457_0x3e4e4a(0x1b3)](_0xcf749d=>{var _0x5d4734=a457_0x3e4e4a;return console['log']('\x0aTEST\x202:\x20sprLib.list(\x27Site\x20Assets\x27).info()'),console[_0x5d4734(0x194)](_0x5d4734(0x1d0)),console[_0x5d4734(0x194)](_0x5d4734(0x1ec)+_0xcf749d[_0x5d4734(0x1fb)]),console[_0x5d4734(0x194)](_0x5d4734(0x195)+_0xcf749d[_0x5d4734(0x1de)]),sprLib[_0x5d4734(0x1b8)]();})['then'](_0x5bbec6=>{var _0x309b58=a457_0x3e4e4a;return gStrReqDig=_0x5bbec6,console[_0x309b58(0x194)](_0x309b58(0x19d)),console[_0x309b58(0x194)](_0x309b58(0x1ae)),console[_0x309b58(0x194)](_0x309b58(0x1f8)+gStrReqDig),sprLib['list']({'name':_0x309b58(0x1b4),'requestDigest':gStrReqDig})[_0x309b58(0x1fa)]({'Title':_0x309b58(0x18c)});})['then'](_0x550de1=>{var _0x3eb696=a457_0x3e4e4a;return console['log'](_0x3eb696(0x19e)),console[_0x3eb696(0x194)]('New\x20item\x20ID...:\x20'+_0x550de1['ID']),console['log'](_0x3eb696(0x1d6)),console[_0x3eb696(0x194)]('------------------------------------------------------------'),sprLib[_0x3eb696(0x1aa)](gStrFilePath)[_0x3eb696(0x1e5)]({'name':gStrFileName,'data':fs[_0x3eb696(0x199)](gStrFileLoca+gStrFileName),'requestDigest':gStrReqDig,'overwrite':!![]});})[a457_0x3e4e4a(0x1b3)](_0x2e9f41=>{var _0x4d9242=a457_0x3e4e4a;return console[_0x4d9242(0x194)](_0x4d9242(0x1c0)+_0x2e9f41['Name']+_0x4d9242(0x1b0)+_0x2e9f41['ServerRelativeUrl']+'`'),console[_0x4d9242(0x194)](_0x4d9242(0x1cb)),console[_0x4d9242(0x194)](_0x4d9242(0x1a0)),sprLib[_0x4d9242(0x1e7)](gStrFilePath+'/'+gStrFileName)[_0x4d9242(0x1dc)]();})[a457_0x3e4e4a(0x1b3)](_0xd2c48f=>{var _0x4cb5b3=a457_0x3e4e4a;if(_0xd2c48f){var _0x1cc602=_0x4cb5b3(0x1da)+new Date()[_0x4cb5b3(0x1cf)]()['replace'](/\:|\.|\-/g,'')+'-'+gStrFileName;fs[_0x4cb5b3(0x18f)](_0x1cc602,Buffer[_0x4cb5b3(0x1af)](_0xd2c48f,_0x4cb5b3(0x1ad))),console[_0x4cb5b3(0x194)](_0x4cb5b3(0x1ba)+_0x1cc602+'\x22\x20downloaded!');}else console[_0x4cb5b3(0x194)](_0x4cb5b3(0x1eb));})[a457_0x3e4e4a(0x1b3)](()=>{var _0x307c8a=a457_0x3e4e4a;console[_0x307c8a(0x194)](_0x307c8a(0x1c6)),console[_0x307c8a(0x194)]('...demo\x20complete.\x0a');})[a457_0x3e4e4a(0x1b5)](_0x3a430a=>{var _0x20bbdb=a457_0x3e4e4a;console['error']('\x0a!!!\x20ERROR\x20!!!'),console[_0x20bbdb(0x1cd)](_0x3a430a);return;});