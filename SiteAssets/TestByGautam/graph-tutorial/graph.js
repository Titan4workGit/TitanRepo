(function(_0x364954,_0x4dd69e){const _0x5e6872=a460_0x1739,_0x190b77=_0x364954();while(!![]){try{const _0x479ffa=parseInt(_0x5e6872(0x9b))/0x1+-parseInt(_0x5e6872(0xa9))/0x2+parseInt(_0x5e6872(0x99))/0x3+parseInt(_0x5e6872(0x9c))/0x4*(parseInt(_0x5e6872(0x9e))/0x5)+-parseInt(_0x5e6872(0x93))/0x6*(-parseInt(_0x5e6872(0x90))/0x7)+-parseInt(_0x5e6872(0x87))/0x8+-parseInt(_0x5e6872(0x9f))/0x9*(parseInt(_0x5e6872(0x85))/0xa);if(_0x479ffa===_0x4dd69e)break;else _0x190b77['push'](_0x190b77['shift']());}catch(_0x21913d){_0x190b77['push'](_0x190b77['shift']());}}}(a460_0x54df,0x9ba0a));let graphClient=undefined;function a460_0x54df(){const _0x482441=['4shWQam','add','767210sIQwpP','3141abbTHD','ev-attendees','start/dateTime','value','required','InteractionType','graphUser','text','Client','PopUp','975244qqCOju','attendees','startOf','ev-body','ev-end','/me/calendarview','format','AuthCodeMSALBrowserAuthenticationProvider','utc','subject,organizer,start,end','error','id,displayName,mail,userPrincipalName,mailboxSettings','timeZone','body','8230WvQrlD','api','4287816vUsIyl','day','mailboxSettings','orderby','Please\x20provide\x20a\x20subject,\x20start,\x20and\x20end.','top','log','post','week','21kalcHT','header','getItem','1385898xQgCMi','Converted:\x20','getElementById','length','initWithMiddleware','calendar','2636847pRqVwC','get','222936lYVmpW'];a460_0x54df=function(){return _0x482441;};return a460_0x54df();}function initializeGraphClient(_0x14b6d1,_0x1701b6,_0x4f5a84){const _0x527516=a460_0x1739,_0x58641d=new MSGraphAuthCodeMSALBrowserAuthProvider[(_0x527516(0xb0))](_0x14b6d1,{'account':_0x1701b6,'scopes':_0x4f5a84,'interactionType':msal[_0x527516(0xa4)][_0x527516(0xa8)]});graphClient=MicrosoftGraph[_0x527516(0xa7)][_0x527516(0x97)]({'authProvider':_0x58641d});}function a460_0x1739(_0x3757fb,_0x10c496){const _0x54df96=a460_0x54df();return a460_0x1739=function(_0x1739cb,_0x48cb14){_0x1739cb=_0x1739cb-0x7f;let _0x38d5c6=_0x54df96[_0x1739cb];return _0x38d5c6;},a460_0x1739(_0x3757fb,_0x10c496);}async function getUser(){const _0x2e3647=a460_0x1739;return graphClient[_0x2e3647(0x86)]('/me')['select'](_0x2e3647(0x82))[_0x2e3647(0x9a)]();}async function getEvents(){const _0x5d441d=a460_0x1739,_0x1d7996=JSON['parse'](sessionStorage[_0x5d441d(0x92)](_0x5d441d(0xa5)));let _0x357243=getIanaFromWindows(_0x1d7996['mailboxSettings'][_0x5d441d(0x83)]);console[_0x5d441d(0x8d)](_0x5d441d(0x94)+_0x357243);let _0x589e03=moment['tz'](_0x357243)[_0x5d441d(0xab)](_0x5d441d(0x8f))[_0x5d441d(0x7f)](),_0x324bd2=moment(_0x589e03)[_0x5d441d(0x9d)](0x7,_0x5d441d(0x88));try{let _0x2b228a=await graphClient[_0x5d441d(0x86)](_0x5d441d(0xae))[_0x5d441d(0x91)]('Prefer','outlook.timezone=\x22'+_0x1d7996[_0x5d441d(0x89)][_0x5d441d(0x83)]+'\x22')['query']({'startDateTime':_0x589e03[_0x5d441d(0xaf)](),'endDateTime':_0x324bd2[_0x5d441d(0xaf)]()})['select'](_0x5d441d(0x80))[_0x5d441d(0x8a)](_0x5d441d(0xa1))[_0x5d441d(0x8c)](0x32)['get']();updatePage(Views[_0x5d441d(0x98)],_0x2b228a['value']);}catch(_0x45b3e4){updatePage(Views[_0x5d441d(0x81)],{'message':'Error\x20getting\x20events','debug':_0x45b3e4});}}async function createNewEvent(){const _0x10ab7b=a460_0x1739,_0x4e8d13=JSON['parse'](sessionStorage[_0x10ab7b(0x92)](_0x10ab7b(0xa5))),_0x1f41d7=document['getElementById']('ev-subject')[_0x10ab7b(0xa2)],_0x465c17=document[_0x10ab7b(0x95)](_0x10ab7b(0xa0))[_0x10ab7b(0xa2)],_0x26e555=document[_0x10ab7b(0x95)]('ev-start')[_0x10ab7b(0xa2)],_0x4db0a0=document[_0x10ab7b(0x95)](_0x10ab7b(0xad))['value'],_0x3d4158=document['getElementById'](_0x10ab7b(0xac))['value'];if(!_0x1f41d7||!_0x26e555||!_0x4db0a0){updatePage(Views[_0x10ab7b(0x81)],{'message':_0x10ab7b(0x8b)});return;}let _0x3a3c1b={'subject':_0x1f41d7,'start':{'dateTime':_0x26e555,'timeZone':_0x4e8d13[_0x10ab7b(0x89)]['timeZone']},'end':{'dateTime':_0x4db0a0,'timeZone':_0x4e8d13[_0x10ab7b(0x89)]['timeZone']}};if(_0x465c17){const _0x12848f=_0x465c17['split'](';');_0x3a3c1b[_0x10ab7b(0xaa)]=[];for(const _0x48791a of _0x12848f){_0x48791a[_0x10ab7b(0x96)]>0x0&&_0x3a3c1b[_0x10ab7b(0xaa)]['push']({'type':_0x10ab7b(0xa3),'emailAddress':{'address':_0x48791a}});}}_0x3d4158&&(_0x3a3c1b[_0x10ab7b(0x84)]={'contentType':_0x10ab7b(0xa6),'content':_0x3d4158});try{await graphClient[_0x10ab7b(0x86)]('/me/events')[_0x10ab7b(0x8e)](_0x3a3c1b),getEvents();}catch(_0x2b44b6){updatePage(Views[_0x10ab7b(0x81)],{'message':'Error\x20creating\x20event','debug':_0x2b44b6});}}