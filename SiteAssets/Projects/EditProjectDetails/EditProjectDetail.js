var a407_0xa38737=a407_0x2442;(function(_0x1ca78e,_0x23b0af){var _0x268432=a407_0x2442,_0x2f960e=_0x1ca78e();while(!![]){try{var _0x143e7f=parseInt(_0x268432(0x1ea))/0x1*(-parseInt(_0x268432(0x226))/0x2)+-parseInt(_0x268432(0x25c))/0x3*(-parseInt(_0x268432(0x2bd))/0x4)+parseInt(_0x268432(0x25e))/0x5+-parseInt(_0x268432(0x1bd))/0x6+parseInt(_0x268432(0x2ca))/0x7*(parseInt(_0x268432(0x1aa))/0x8)+parseInt(_0x268432(0x220))/0x9+-parseInt(_0x268432(0x236))/0xa;if(_0x143e7f===_0x23b0af)break;else _0x2f960e['push'](_0x2f960e['shift']());}catch(_0x2cf896){_0x2f960e['push'](_0x2f960e['shift']());}}}(a407_0x4dfd,0x38bda));var projectInternalName='',projectItemID='',CreatedId='';$(document)[a407_0xa38737(0x221)](function(){var _0x86dd75=a407_0xa38737;SP[_0x86dd75(0x2b3)][_0x86dd75(0x20f)](Initialization_ProjectSite,_0x86dd75(0x18b));}),$(document)['ready'](function(){var _0x5b2dab=a407_0xa38737;companyID=Logged_CompanyId,getProjectRights(),projecttouser='',InitializePeoplePicker(_0x5b2dab(0x178),![]),InitializePeoplePicker(_0x5b2dab(0x2ae),!![]),InitializePeoplePicker(_0x5b2dab(0x251),!![]),$('.dropdown\x20dt\x20a')['on']('click',function(){var _0x324715=_0x5b2dab;$('.dropdown\x20dd\x20ul')[_0x324715(0x2a8)]('fast');}),$(_0x5b2dab(0x2b4))['on'](_0x5b2dab(0x17b),function(){var _0x1bc04b=_0x5b2dab;$(_0x1bc04b(0x1a8))[_0x1bc04b(0x1f2)]();});function _0x4987fe(_0x3cbb96){var _0x2f5d42=_0x5b2dab;return $('#'+_0x3cbb96)[_0x2f5d42(0x1f3)](_0x2f5d42(0x286))[_0x2f5d42(0x207)]();}$(document)['bind']('click',function(_0x254a41){var _0x173156=_0x5b2dab,_0x5c2ec4=$(_0x254a41[_0x173156(0x1a0)]);if(!_0x5c2ec4[_0x173156(0x2b9)]()[_0x173156(0x1b5)]('dropdown'))$(_0x173156(0x1a8))['hide']();}),$('.txtPlannedStartDate')[_0x5b2dab(0x225)]({'changeMonth':!![],'changeYear':!![],'yearRange':_0x5b2dab(0x256)}),$('.txtPlannedStartDate')[_0x5b2dab(0x225)](_0x5b2dab(0x253),_0x5b2dab(0x1a4),_0x5b2dab(0x25a)),$(_0x5b2dab(0x217))[_0x5b2dab(0x225)]({'changeMonth':!![],'changeYear':!![],'yearRange':'-50:+50'}),$(_0x5b2dab(0x217))[_0x5b2dab(0x225)](_0x5b2dab(0x253),_0x5b2dab(0x1a4),_0x5b2dab(0x25a)),$(_0x5b2dab(0x187))[_0x5b2dab(0x225)]({'changeMonth':!![],'changeYear':!![],'yearRange':_0x5b2dab(0x256)}),$(_0x5b2dab(0x187))[_0x5b2dab(0x225)](_0x5b2dab(0x253),_0x5b2dab(0x1a4),_0x5b2dab(0x25a)),$('#txtProjectName')[_0x5b2dab(0x1f0)](function(){var _0x3393c6=_0x5b2dab,_0x2473c0=$('#txtProjectName')['val']();$[_0x3393c6(0x293)]($(_0x3393c6(0x1d8))[_0x3393c6(0x1d9)]())!=''&&CheckProjectCodeExistOrNot('True',_0x2473c0);}),window['atob']($[_0x5b2dab(0x1a6)](_0x5b2dab(0x1d4)))=='true'&&($(_0x5b2dab(0x1b9))[_0x5b2dab(0x1f2)](),$(_0x5b2dab(0x289))['hide'](),$(_0x5b2dab(0x21a))['hide'](),$(_0x5b2dab(0x1e2))[_0x5b2dab(0x1f2)]());}),$[a407_0xa38737(0x1a6)]=function(_0x35958b){var _0x1728e5=a407_0xa38737,_0x58d9aa=new RegExp(_0x1728e5(0x229)+_0x35958b+_0x1728e5(0x1c3))[_0x1728e5(0x254)](window['location'][_0x1728e5(0x2c3)]);return _0x58d9aa==null?_0x58d9aa=_0x1728e5(0x2be):_0x58d9aa[0x1]||0x0;};function InitializePeoplePicker(_0x30b24f,_0xaa2f47){var _0x439ed1=a407_0xa38737;_0xaa2f47==null&&(_0xaa2f47=![]);var _0xec8c2f={};_0xec8c2f[_0x439ed1(0x213)]=_0x439ed1(0x20d),_0xec8c2f[_0x439ed1(0x1c2)]=0xf,_0xec8c2f['ResolvePrincipalSource']=0xf,_0xec8c2f['AllowMultipleValues']=_0xaa2f47,_0xec8c2f['MaximumEntitySuggestions']=0x32,_0xec8c2f[_0x439ed1(0x1b0)]=_0x439ed1(0x24b),SPClientPeoplePicker_InitStandaloneControlWrapper(_0x30b24f,null,_0xec8c2f);}function getPeopleUserInfoGroups(_0x2caf27){var _0x5e1bc2=a407_0xa38737,_0x17df3e=new Array(),_0x454913=$(_0x5e1bc2(0x2a7)+_0x2caf27+'\x27]'),_0x2fc8a1=SPClientPeoplePicker[_0x5e1bc2(0x196)][_0x454913[0x1]['id']],_0x53e39a=_0x2fc8a1[_0x5e1bc2(0x29c)]();if(_0x53e39a[_0x5e1bc2(0x211)]>0x0)for(var _0x492220=0x0;_0x492220<_0x53e39a[_0x5e1bc2(0x211)];_0x492220++){_0x17df3e[_0x5e1bc2(0x22f)](GetUserIdGroups(_0x53e39a[_0x492220]['Key']));}return _0x17df3e;}function GetUserIdGroups(_0x3af7dd){var _0x2f235f=a407_0xa38737,_0x23ff5e='',_0x42fcc1=_0x2f235f(0x233),_0x114d64=_spPageContextInfo[_0x2f235f(0x1c1)],_0x176381=_0x3af7dd;return $[_0x2f235f(0x1ad)]({'url':_0x114d64+_0x2f235f(0x18e)+encodeURIComponent(_0x176381)+'\x27','method':_0x2f235f(0x2b0),'headers':{'Accept':_0x2f235f(0x24d)},'async':![],'success':function(_0xaaa6dd){_0x23ff5e=_0xaaa6dd['d']['Id'];},'error':function(_0x34cbf){var _0x5dd60a=_0x2f235f;console['log'](JSON[_0x5dd60a(0x298)](_0x34cbf));}}),_0x23ff5e;}function getmultiselctValue(){var _0x31b712=a407_0xa38737;$(_0x31b712(0x1f1))['on'](_0x31b712(0x17b),function(){var _0x314ba3=_0x31b712,_0x91b3ff=$(this)[_0x314ba3(0x294)](_0x314ba3(0x1c9))[_0x314ba3(0x1f3)](_0x314ba3(0x19b))[_0x314ba3(0x1d9)](),_0x91b3ff=$(this)[_0x314ba3(0x1d9)]()+',';if($(this)['is'](_0x314ba3(0x18c))){var _0x51cf33=_0x314ba3(0x280)+_0x91b3ff+'\x22>'+_0x91b3ff+_0x314ba3(0x263);$(_0x314ba3(0x175))[_0x314ba3(0x1b8)](_0x51cf33),$('.hida')[_0x314ba3(0x1f2)]();}else{$('span[title=\x22'+_0x91b3ff+'\x22]')['remove']();var _0x14e096=$(_0x314ba3(0x1b6));$(_0x314ba3(0x2ba))[_0x314ba3(0x1b8)](_0x14e096);}}),$('#txtProjectCode')['blur'](function(){var _0x1990db=_0x31b712,_0x13383d=$(_0x1990db(0x27e))[_0x1990db(0x1d9)]();$['trim']($(_0x1990db(0x27e))[_0x1990db(0x1d9)]())!=''&&CheckProjectCodeExistOrNot(_0x1990db(0x274),_0x13383d);});var _0x3ba540=new Array();_0x3ba540['push'](0x8),_0x3ba540[_0x31b712(0x22f)](0x9),_0x3ba540[_0x31b712(0x22f)](0x2e),_0x3ba540[_0x31b712(0x22f)](0x24),_0x3ba540['push'](0x23),_0x3ba540['push'](0x25),_0x3ba540[_0x31b712(0x22f)](0x27),_0x3ba540[_0x31b712(0x22f)](0x20),$('#txtProjectName')[_0x31b712(0x191)](function(_0x507cf6){var _0x2ce940=_0x31b712,_0x5877e3=_0x507cf6['keyCode']==0x0?_0x507cf6[_0x2ce940(0x252)]:_0x507cf6[_0x2ce940(0x180)],_0x1b902e=_0x5877e3>=0x30&&_0x5877e3<=0x39||_0x5877e3>=0x41&&_0x5877e3<=0x5a||_0x5877e3>=0x61&&_0x5877e3<=0x7a||_0x3ba540[_0x2ce940(0x1f7)](_0x507cf6['keyCode'])!=-0x1&&_0x507cf6['charCode']!=_0x507cf6['keyCode']||_0x507cf6['keyCode']==0x20;return _0x1b902e;});}function Initialization_ProjectSite(){var _0x2a88e7=a407_0xa38737;departmentID=titanForWork[_0x2a88e7(0x285)](_0x2a88e7(0x1ca)),companyID=Logged_CompanyId;if(companyID>0x0&&departmentID>0x0)getCurrentURL_EventCreateProjectSite(_0x2a88e7(0x1ab),departmentID);else companyID>0x0&&departmentID!=_0x2a88e7(0x177)&&getCurrentURL_EventCreateProjectSite('Companies',companyID);}function getCurrentURL_EventCreateProjectSite(_0x7b9d40,_0x209691){var _0x5acdee=a407_0xa38737;siteURLProjects=_spPageContextInfo[_0x5acdee(0x1b4)]+_0x5acdee(0x22a)+_0x7b9d40+_0x5acdee(0x247)+_0x209691+'\x27',$[_0x5acdee(0x1ad)]({'url':siteURLProjects,'headers':{'Accept':_0x5acdee(0x24a)},'async':![],'success':function(_0x4d501b){var _0x9a10a1=_0x5acdee,_0x241261=_0x4d501b['d'][_0x9a10a1(0x1ef)];_0x241261[_0x9a10a1(0x211)]>0x0&&(siteURL=_0x241261[0x0][_0x9a10a1(0x1c0)],siteclientContext=new SP[(_0x9a10a1(0x2c9))](siteURL),getConsultantDetails(siteclientContext),getDepartment(),officeLocation(),bindProjectType(),setTimeout(function(){GetProjectDetails();},0x7d0));},'error':function(_0x4ee997){var _0x55f5de=_0x5acdee;console[_0x55f5de(0x2a3)]($(_0x55f5de(0x266))[_0x55f5de(0x1d9)]());}});}function getDepartment(){var _0x39e328=a407_0xa38737,_0x54eeb9=titanForWork[_0x39e328(0x285)](_0x39e328(0x292)),_0x5e304a=new SP[(_0x39e328(0x2c9))](),_0x34094c=_0x5e304a[_0x39e328(0x2cc)]()[_0x39e328(0x295)]()[_0x39e328(0x29d)](_0x39e328(0x1ab)),_0x3eee12=new SP[(_0x39e328(0x1c8))](),_0x473bbf='<View><Query><Where><Eq><FieldRef\x20Name=\x27CompanyID\x27\x20/><Value\x20Type=\x27Lookup\x27>'+_0x54eeb9+_0x39e328(0x296);_0x3eee12['set_viewXml'](_0x473bbf);var _0x147f75=_0x34094c[_0x39e328(0x2bb)](_0x3eee12);_0x5e304a[_0x39e328(0x1dc)](_0x147f75),_0x5e304a[_0x39e328(0x215)](function(){var _0x46bf3d=_0x39e328,_0x52c93a=_0x147f75[_0x46bf3d(0x1b2)](),_0x152813=0x1,_0x343657=_0x46bf3d(0x23e);_0x343657+=_0x46bf3d(0x1bc);while(_0x52c93a['moveNext']()){var _0x36de88=_0x52c93a[_0x46bf3d(0x238)](),_0x350926=_0x36de88['get_item']('ID'),_0x1bb336=_0x36de88[_0x46bf3d(0x2a2)](_0x46bf3d(0x230));_0x343657+=_0x46bf3d(0x288)+_0x350926+'\x22>'+_0x1bb336+_0x46bf3d(0x194),_0x152813++;}_0x343657+=_0x46bf3d(0x26c),$(_0x46bf3d(0x268))[_0x46bf3d(0x1b8)](_0x343657),IsProjectAdmin==!![]?($(_0x46bf3d(0x261))[_0x46bf3d(0x287)]('disabled',![]),$(_0x46bf3d(0x1d8))[_0x46bf3d(0x287)](_0x46bf3d(0x18a),![])):($(_0x46bf3d(0x261))['prop'](_0x46bf3d(0x18a),!![]),$(_0x46bf3d(0x1d8))[_0x46bf3d(0x287)]('disabled',!![]));},function(){var _0x281c2c=_0x39e328;console[_0x281c2c(0x2a3)](_0x281c2c(0x271));});}function officeLocation(){var _0x1f1849=a407_0xa38737,_0x49f401=titanForWork[_0x1f1849(0x285)](_0x1f1849(0x292)),_0x59a063=new SP[(_0x1f1849(0x2c9))](),_0x195023=_0x59a063[_0x1f1849(0x2cc)]()['get_lists']()['getByTitle']('OfficeLocation'),_0x445e48=new SP[(_0x1f1849(0x1c8))](),_0x4c625c='<View><Query><Where><And><Eq><FieldRef\x20Name=\x27CompanyID\x27\x20/><Value\x20Type=\x27Lookup\x27>'+_0x49f401+_0x1f1849(0x1eb);_0x445e48[_0x1f1849(0x1d7)](_0x4c625c);var _0x511197=_0x195023['getItems'](_0x445e48);_0x59a063['load'](_0x511197),_0x59a063['executeQueryAsync'](function(){var _0x4ef6dd=_0x1f1849,_0x2e4a67=_0x511197['getEnumerator'](),_0x1b1077=0x1,_0x36dc5d=_0x4ef6dd(0x257);_0x36dc5d+=_0x4ef6dd(0x1bc);while(_0x2e4a67['moveNext']()){var _0x2cd974=_0x2e4a67[_0x4ef6dd(0x238)](),_0x1a9122=_0x2cd974[_0x4ef6dd(0x2a2)]('ID'),_0x16801f=_0x2cd974[_0x4ef6dd(0x2a2)](_0x4ef6dd(0x2c1));_0x36dc5d+=_0x4ef6dd(0x288)+_0x1a9122+'\x22>'+_0x16801f+_0x4ef6dd(0x194),_0x1b1077++;}_0x36dc5d+='</select>',$('#officeLocation')[_0x4ef6dd(0x1b8)](_0x36dc5d);},function(){var _0x3f3738=_0x1f1849;console[_0x3f3738(0x2a3)](_0x3f3738(0x271));});}function getConsultantDetails(_0x1c7dae){var _0x26555e=a407_0xa38737,_0x73539c=_0x1c7dae[_0x26555e(0x2cc)]()[_0x26555e(0x295)]()[_0x26555e(0x29d)](_0x26555e(0x1fe)),_0x1575b1=new SP[(_0x26555e(0x1c8))]();_0x1575b1['set_viewXml']('<View><OrderBy><FieldRef\x20Name=\x27ID\x27\x20Ascending=\x27False\x27/></OrderBy></View>');var _0x24587b=_0x73539c[_0x26555e(0x2bb)](_0x1575b1);_0x1c7dae[_0x26555e(0x1dc)](_0x24587b),_0x1c7dae[_0x26555e(0x215)](function(){var _0x562c68=_0x26555e,_0x3032f9='<ul>',_0x177993=_0x24587b[_0x562c68(0x1b2)](),_0x443257=_0x24587b[_0x562c68(0x28b)](),_0x4b2308=0x1;if(_0x443257>0x0){while(_0x177993[_0x562c68(0x1a2)]()){var _0x13d725=_0x177993[_0x562c68(0x238)](),_0x2fda08=_0x13d725['get_item'](_0x562c68(0x208));_0x3032f9+=_0x562c68(0x18f)+_0x2fda08+_0x562c68(0x21f)+_0x2fda08+_0x562c68(0x2af),_0x4b2308++;}_0x3032f9+=_0x562c68(0x2a5),$(_0x562c68(0x1c9))[_0x562c68(0x1b8)](_0x3032f9),getmultiselctValue();}},function(){});}function getConsultantValue(){var _0x5259ce=a407_0xa38737,_0x34832c='';return $(_0x5259ce(0x1cd))['each'](function(){var _0x2f281f=_0x5259ce;_0x34832c+=$(this)[_0x2f281f(0x207)]();}),_0x34832c;}function setPeoplePickerUsersInfoCurrentGroups(_0x17cf24,_0x576277){var _0x15d546=a407_0xa38737,_0x27f51d=$('[id^=\x27'+_0x17cf24+'\x27]'),_0x56ebac=SPClientPeoplePicker[_0x15d546(0x196)][_0x27f51d[0x1]['id']];_0x56ebac[_0x15d546(0x27b)](_0x576277,![]);}var OldPMNameID='';function GetProjectDetails(){var _0xbbb445=a407_0xa38737;BindPrograms();var _0x419424=titanForWork[_0xbbb445(0x285)](_0xbbb445(0x20e));siteURL=_spPageContextInfo[_0xbbb445(0x1b4)]+_0xbbb445(0x1a9)+_0x419424+'\x27',$[_0xbbb445(0x1ad)]({'url':siteURL,'headers':{'Accept':_0xbbb445(0x24a)},'async':![],'success':function(_0x5c88e4){var _0x3b302d=_0xbbb445,_0x21d423=_0x5c88e4['d']['results'],_0x3a7280=_0x21d423[0x0][_0x3b302d(0x27d)];if(_0x3a7280!=_spPageContextInfo[_0x3b302d(0x198)]&&IsProjectAdmin!=!![]&&IsDeptmentAdmin!=!![])alert(_0x3b302d(0x243)),window['location'][_0x3b302d(0x2c3)]=_0x3b302d(0x19a)+titanForWork[_0x3b302d(0x285)](_0x3b302d(0x292))+'';else{_0x21d423[0x0][_0x3b302d(0x249)]==null||_0x21d423[0x0][_0x3b302d(0x249)]==''?projectInternalName=_0x21d423[0x0]['ProjectName']:projectInternalName=_0x21d423[0x0][_0x3b302d(0x249)];var _0x269093=_0x21d423[0x0][_0x3b302d(0x22c)][_0x3b302d(0x230)];CreatedId=_0x21d423[0x0]['Author']['ID'];var _0x20e491=new Date(_0x21d423[0x0][_0x3b302d(0x235)]);_0x20e491=$['datepicker'][_0x3b302d(0x2a6)](_0x3b302d(0x1de),_0x20e491),$(_0x3b302d(0x188))[_0x3b302d(0x1e4)](_0x269093),$(_0x3b302d(0x201))[_0x3b302d(0x1e4)](_0x20e491);_0x21d423[0x0]['Stackeholder']['UserName']!=null&&setPeoplePickerUsersInfoCurrentGroups(_0x3b302d(0x251),_0x21d423[0x0]['Stackeholder']['UserName']);_0x21d423[0x0]['Sponsor'][_0x3b302d(0x245)]!=null&&setPeoplePickerUsersInfoCurrentGroups('SponsorTeamEmployeePicker',_0x21d423[0x0][_0x3b302d(0x267)][_0x3b302d(0x245)]);if(_0x21d423[0x0]['MultipleStackeholder'][_0x3b302d(0x1ef)]!=null)for(var _0x305e88=0x0;_0x305e88<_0x21d423[0x0][_0x3b302d(0x1f5)][_0x3b302d(0x1ef)][_0x3b302d(0x211)];_0x305e88++){setPeoplePickerUsersInfoCurrentGroups(_0x3b302d(0x251),_0x21d423[0x0]['MultipleStackeholder'][_0x3b302d(0x1ef)][_0x305e88][_0x3b302d(0x245)]);}if(_0x21d423[0x0]['MultipleSponsor'][_0x3b302d(0x1ef)]!=null)for(var _0x305e88=0x0;_0x305e88<_0x21d423[0x0][_0x3b302d(0x277)]['results'][_0x3b302d(0x211)];_0x305e88++){setPeoplePickerUsersInfoCurrentGroups('SponsorTeamEmployeePicker',_0x21d423[0x0]['MultipleSponsor'][_0x3b302d(0x1ef)][_0x305e88][_0x3b302d(0x245)]);}var _0x590aec=_0x21d423[0x0][_0x3b302d(0x1e9)]['Title'];;var _0x1420e7=_0x21d423[0x0][_0x3b302d(0x28e)],_0x3db6e7=_0x21d423[0x0]['ID'];projectItemID=_0x3db6e7;var _0x1ffb12=_0x21d423[0x0][_0x3b302d(0x27c)];if(_0x1ffb12!=null){var _0x2132ea=_0x1ffb12[_0x3b302d(0x22e)](',');$(_0x3b302d(0x1b1))[_0x3b302d(0x2c0)](function(_0x4ba5ef){var _0x53de01=_0x3b302d,_0x59e304=$(this)[_0x53de01(0x1e4)](),_0xd205e0=_0x2132ea[_0x53de01(0x1f7)](_0x59e304);if(_0xd205e0>-0x1){$(this)['find'](_0x53de01(0x218))[_0x53de01(0x287)](_0x53de01(0x23b),!![]),title=_0x59e304+',';var _0xd195e4=_0x53de01(0x280)+title+'\x22>'+title+'</span>';$(_0x53de01(0x175))[_0x53de01(0x1b8)](_0xd195e4),$('.hida')['hide']();}});}var _0x4f10ba=new Date(_0x21d423[0x0]['PlanedStartDate']);_0x4f10ba=$['datepicker']['formatDate'](_0x3b302d(0x25a),_0x4f10ba),$(_0x3b302d(0x19d))[_0x3b302d(0x1d9)](_0x4f10ba);var _0x118ae7=new Date(_0x21d423[0x0][_0x3b302d(0x1ba)]);$(_0x3b302d(0x21d))['datepicker']({'changeMonth':!![],'changeYear':!![],'yearRange':'-50:+50','minDate':_0x118ae7}),$(_0x3b302d(0x21d))[_0x3b302d(0x225)](_0x3b302d(0x253),_0x3b302d(0x1a4),_0x3b302d(0x25a)),_0x118ae7=$[_0x3b302d(0x225)][_0x3b302d(0x2a6)](_0x3b302d(0x25a),_0x118ae7),$('.txtPlannedEndDate')[_0x3b302d(0x1d9)](_0x118ae7);var _0x3edfcd=_0x21d423[0x0]['ActualStartDate'];_0x3edfcd!=null&&(_0x3edfcd=new Date(_0x21d423[0x0][_0x3b302d(0x202)]),_0x3edfcd=$[_0x3b302d(0x225)][_0x3b302d(0x2a6)](_0x3b302d(0x25a),_0x3edfcd),$(_0x3b302d(0x217))[_0x3b302d(0x1d9)](_0x3edfcd));var _0x304d4c=_0x21d423[0x0][_0x3b302d(0x1be)];_0x304d4c!=null&&(_0x304d4c=new Date(_0x21d423[0x0][_0x3b302d(0x1be)]),_0x304d4c=$[_0x3b302d(0x225)][_0x3b302d(0x2a6)](_0x3b302d(0x25a),_0x304d4c),$('.txtActualEndDate')[_0x3b302d(0x1d9)](_0x304d4c));$('#txtProjectCode')['val'](_0x21d423[0x0][_0x3b302d(0x24e)]),$(_0x3b302d(0x1d8))[_0x3b302d(0x1d9)](_0x21d423[0x0][_0x3b302d(0x173)]),$(_0x3b302d(0x26f))['val'](_0x21d423[0x0]['Domain']);var _0x3b2eb7=_0x21d423[0x0][_0x3b302d(0x1ca)];$('#departmentDiv')[_0x3b302d(0x1f3)]('select#departmentDetails\x20option[value=\x22'+_0x3b2eb7+'\x22]')['attr']('selected',_0x3b302d(0x203));var _0x1b906c=_0x21d423[0x0][_0x3b302d(0x259)];$(_0x3b302d(0x182))[_0x3b302d(0x1f3)](_0x3b302d(0x258)+_0x1b906c+'\x22]')['attr'](_0x3b302d(0x203),_0x3b302d(0x203));var _0x3a7280=_0x21d423[0x0][_0x3b302d(0x27d)];OldPMNameID=_0x21d423[0x0][_0x3b302d(0x27d)];var _0x11645d=_0x21d423[0x0]['ManagerName'][_0x3b302d(0x245)];setPeoplePickerUsersInfoCurrentGroups(_0x3b302d(0x178),_0x11645d);var _0x586c85=_0x21d423[0x0][_0x3b302d(0x18d)];$(_0x3b302d(0x1b7))[_0x3b302d(0x1f3)]('select#TaskTeamDetails\x20option[value=\x22'+_0x586c85+'\x22]')['attr'](_0x3b302d(0x203),_0x3b302d(0x203));var _0x2ae079=_0x21d423[0x0][_0x3b302d(0x1ce)];$('#SponsorTeam')[_0x3b302d(0x1f3)]('select#TaskTeamDetails\x20option[value=\x22'+_0x2ae079+'\x22]')[_0x3b302d(0x1e7)](_0x3b302d(0x203),_0x3b302d(0x203));var _0x213892=_0x21d423[0x0][_0x3b302d(0x1e9)][_0x3b302d(0x230)],_0xdd6b9f=_0x21d423[0x0]['ClientIDId'];$(_0x3b302d(0x1ff))[_0x3b302d(0x1d9)](_0x213892),$(_0x3b302d(0x1ff))[_0x3b302d(0x287)](_0x3b302d(0x18a),!![]);_0x1420e7!=''&&$(_0x3b302d(0x290)+_0x1420e7+']')[_0x3b302d(0x1e7)](_0x3b302d(0x203),_0x3b302d(0x203));if(_0x1420e7==_0x3b302d(0x234)||_0x1420e7=='OnHold')$(_0x3b302d(0x1d6))['hide']();else(_0x1420e7=='Completed'||_0x1420e7==_0x3b302d(0x273))&&$(_0x3b302d(0x1d6))['show']();var _0x40ea5a=$(_0x3b302d(0x1d1))[_0x3b302d(0x17a)](function(_0x1d415a,_0x2e530a){var _0x25821f=_0x3b302d;return $(_0x2e530a)[_0x25821f(0x1d9)]()==_0x21d423[0x0][_0x25821f(0x25b)];});_0x40ea5a['length']>0x0?$(_0x3b302d(0x242))[_0x3b302d(0x1d9)](_0x21d423[0x0][_0x3b302d(0x25b)]):$(_0x3b302d(0x242))[_0x3b302d(0x1b8)](_0x3b302d(0x288)+_0x21d423[0x0][_0x3b302d(0x25b)]+_0x3b302d(0x1fa)+_0x21d423[0x0][_0x3b302d(0x25b)]+'</option>');_0x21d423[0x0][_0x3b302d(0x262)]!=null?$(_0x3b302d(0x22d))[_0x3b302d(0x1d9)](_0x21d423[0x0][_0x3b302d(0x262)]):$(_0x3b302d(0x22d))[_0x3b302d(0x1d9)]('0');var _0x2c76b2=$(_0x3b302d(0x21d))[_0x3b302d(0x225)]('getDate'),_0xdd37b2=$(_0x3b302d(0x19d))[_0x3b302d(0x225)]('getDate'),_0x544297=(_0x2c76b2-_0xdd37b2)/(0x3e8*0x3c*0x3c*0x18),_0x339f05=Math[_0x3b302d(0x1e5)](_0x544297)+0x1,_0x4229cc=LoadAllHolidays();$(_0x3b302d(0x28d))[_0x3b302d(0x1e4)](_0x339f05+0x2-parseInt(_0x4229cc)),$(_0x3b302d(0x26a))['val'](_0x21d423[0x0][_0x3b302d(0x195)]);if(CreatedId!=_spPageContextInfo[_0x3b302d(0x198)]&&_spPageContextInfo[_0x3b302d(0x2b5)]!=!![]){var _0x67d8f3=$(_0x3b302d(0x2a7)+'ProjectManagerEmployeePicker'+'\x27]');_0x67d8f3=SPClientPeoplePicker[_0x3b302d(0x196)][_0x67d8f3[0x1]['id']],_0x67d8f3['SetEnabledState'](![]),$(_0x3b302d(0x1f8))[_0x3b302d(0x1f3)]('.sp-peoplepicker-delImage')[_0x3b302d(0x1f2)]();}(_0x21d423[0x0][_0x3b302d(0x28e)]=='OnHold'||_0x21d423[0x0]['Status']==_0x3b302d(0x234))&&(_0x21d423[0x0][_0x3b302d(0x22c)][_0x3b302d(0x276)][_0x3b302d(0x2a9)]()==_spPageContextInfo[_0x3b302d(0x1bf)][_0x3b302d(0x2a9)]()||_0x21d423[0x0][_0x3b302d(0x2ad)]['UserName'][_0x3b302d(0x2a9)]()==_spPageContextInfo[_0x3b302d(0x1bf)][_0x3b302d(0x2a9)]())&&($('.txtActualStartDate')[_0x3b302d(0x1e7)]('disabled',![]),$(_0x3b302d(0x242))[_0x3b302d(0x1e7)](_0x3b302d(0x18a),![])),(_0x21d423[0x0]['Status']=='Completed'||_0x21d423[0x0][_0x3b302d(0x28e)]==_0x3b302d(0x273))&&(_0x21d423[0x0][_0x3b302d(0x22c)][_0x3b302d(0x276)][_0x3b302d(0x2a9)]()==_spPageContextInfo[_0x3b302d(0x1bf)]['toLowerCase']()||_0x21d423[0x0][_0x3b302d(0x2ad)]['UserName'][_0x3b302d(0x2a9)]()==_spPageContextInfo['userEmail'][_0x3b302d(0x2a9)]())&&($(_0x3b302d(0x217))[_0x3b302d(0x1e7)]('disabled',![]),$(_0x3b302d(0x27e))[_0x3b302d(0x1e7)](_0x3b302d(0x18a),![])),_0x21d423[0x0]['ProgramID']['Id']!=null&&_0x21d423[0x0]['ProgramID']['Id']!=0x0&&$(_0x3b302d(0x1a7))['val'](_0x21d423[0x0][_0x3b302d(0x284)]['Id']);}},'error':function(_0x4f2486){var _0x25a631=_0xbbb445;console[_0x25a631(0x2a3)]($('#txtSomethingWentWrong')[_0x25a631(0x1d9)]());}});}$(function(){bindButtonClick();});var NewPMNameID='',StartDate='',EndDate='';function bindButtonClick(){var _0x5e9878=a407_0xa38737;$(_0x5e9878(0x17e))['on'](_0x5e9878(0x17b),function(){var _0x47cbaf=_0x5e9878,_0x462f76=$(_0x47cbaf(0x1d8))[_0x47cbaf(0x1d9)](),_0x154952=$('#txtProjectCode')[_0x47cbaf(0x1d9)](),_0x5d6ecb=$(_0x47cbaf(0x268))[_0x47cbaf(0x1f3)](_0x47cbaf(0x261))[_0x47cbaf(0x1d9)](),_0x3ca126=$('#officeLocation')[_0x47cbaf(0x1f3)](_0x47cbaf(0x1d2))[_0x47cbaf(0x1d9)](),_0x28a23f=$(_0x47cbaf(0x19d))['val'](),_0x3fc7d1=new Date(_0x28a23f);_0x28a23f=_0x3fc7d1['format'](_0x47cbaf(0x25f));var _0x4bcd56=$(_0x47cbaf(0x21d))[_0x47cbaf(0x1d9)](),_0x3fc7d1=new Date(_0x4bcd56);_0x4bcd56=_0x3fc7d1[_0x47cbaf(0x240)](_0x47cbaf(0x25f)),EstimatedHours=$('#EstimatedTime')[_0x47cbaf(0x1d9)]();if(parseFloat(EstimatedHours)<0x0)return alert(_0x47cbaf(0x1d3)),$(_0x47cbaf(0x22d))[_0x47cbaf(0x21e)](),![];var _0x4c2f6b=getPeoplePickerEmails(_0x47cbaf(0x251));for(var _0x52fd76=0x0;_0x52fd76<_0x4c2f6b[_0x47cbaf(0x211)];_0x52fd76++){if(CheckInternalUser(_0x4c2f6b[_0x52fd76])==![])return alert('Stakeholders\x20should\x20be\x20internal\x20employeees\x20only.'),![];}var _0x9289ff=getPeopleUserInfoGroups(_0x47cbaf(0x178));if(_0x9289ff[_0x47cbaf(0x211)]==0x0)return alert(_0x47cbaf(0x2c6)),![];if(_0x9289ff[_0x47cbaf(0x211)]==0x1){var _0x302786=IsMangerActive(_0x9289ff);if(!_0x302786)return alert(_0x47cbaf(0x212)),_0x302786='',![];else var _0x224ec5=_0x9289ff[0x0];}if(_0x9289ff[_0x47cbaf(0x211)]>0x1)return alert(_0x47cbaf(0x1bb)),![];NewPMNameID=_0x224ec5;var _0x40ec05=$(_0x47cbaf(0x26a))[_0x47cbaf(0x1d9)](),_0x414747='';_0x28a23f!=null&&_0x28a23f!=''&&(_0x414747=GetDateStandardFormat(_0x28a23f),StartDate=_0x414747);var _0x2927f7='';_0x4bcd56!=null&&_0x4bcd56!=''&&(_0x2927f7=GetDateStandardFormat(_0x4bcd56),EndDate=_0x2927f7);if(_0x462f76['trim']()==''||_0x28a23f==''||_0x4bcd56==''||$(_0x47cbaf(0x261))[_0x47cbaf(0x1d9)]()=='0')alert(_0x47cbaf(0x2c2));else _0x2927f7>_0x414747?(waitingDialog[_0x47cbaf(0x20c)](),updateListItem()):alert(_0x47cbaf(0x1ee));});}function CheckProjectCodeExistOrNot(_0x4cab30,_0x43abe6){var _0x1c695b=a407_0xa38737,_0x5512b6=titanForWork[_0x1c695b(0x285)](_0x1c695b(0x292)),_0x50a614=_0x1c695b(0x2b0),_0x136433={},_0x2c5458=![],_0x4f0521='';if(_0x4cab30==_0x1c695b(0x21c))_0x4f0521=_spPageContextInfo[_0x1c695b(0x1b4)]+_0x1c695b(0x272)+_0x5512b6+_0x1c695b(0x2bc)+_0x43abe6+_0x1c695b(0x1d5)+projectItemID+'\x27';else _0x4cab30==_0x1c695b(0x274)&&(_0x4f0521=_spPageContextInfo[_0x1c695b(0x1b4)]+_0x1c695b(0x237)+_0x43abe6+_0x1c695b(0x190)+_0x5512b6+'\x27');return $[_0x1c695b(0x1ad)]({'url':_0x4f0521,'type':_0x50a614,'data':_0x136433,'async':![],'headers':{'Accept':_0x1c695b(0x24a),'Content-Type':'application/json;odata=verbose','X-RequestDigest':$(_0x1c695b(0x2c5))['val'](),'IF-MATCH':'*','X-HTTP-Method':null},'cache':![],'success':function(_0x202fe0){var _0x18eff1=_0x1c695b,_0x3aee95,_0xe95f9b=_0x202fe0['d'][_0x18eff1(0x1ef)],_0xf7d373=_0x202fe0['d'][_0x18eff1(0x1ef)][_0x18eff1(0x211)];_0xf7d373>0x0&&(alert(_0x18eff1(0x29f)),$(_0x18eff1(0x1d8))[_0x18eff1(0x1d9)](''),$(_0x18eff1(0x1d8))[_0x18eff1(0x21e)]());},'error':function(_0x41a066){var _0x4b3671=_0x1c695b;Helper[_0x4b3671(0x1e0)]();}}),_0x2c5458;}function updateListItem(){var _0x2c9b3a=a407_0xa38737,_0x18f122=new Array();_0x18f122=getPeopleUserInfoGroups(_0x2c9b3a(0x251));var _0x5654cc=new Array();_0x5654cc=getPeopleUserInfoGroups('SponsorTeamEmployeePicker');var _0xabbc46=titanForWork['getQueryStringParameter'](_0x2c9b3a(0x20e)),_0x1d3ae4=$('#txtProjectCode')[_0x2c9b3a(0x1d9)](),_0x49a3f3=$('#txtProjectName')[_0x2c9b3a(0x1d9)](),_0x3cc66b=$(_0x2c9b3a(0x19d))[_0x2c9b3a(0x1d9)](),_0x34a90f=new Date(_0x3cc66b);_0x3cc66b=_0x34a90f[_0x2c9b3a(0x240)]('dd/MM/yyyy');var _0x4375a3='';_0x3cc66b!=null&&_0x3cc66b!=''&&(_0x4375a3=GetDateStandardFormat(_0x3cc66b));var _0x5345a3=$('.txtPlannedEndDate')[_0x2c9b3a(0x1d9)](),_0x34a90f=new Date(_0x5345a3);_0x5345a3=_0x34a90f[_0x2c9b3a(0x240)](_0x2c9b3a(0x25f));var _0x5cb718='';_0x5345a3!=null&&_0x5345a3!=''&&(_0x5cb718=GetDateStandardFormat(_0x5345a3));var _0x1aaebc=$(_0x2c9b3a(0x217))[_0x2c9b3a(0x1d9)](),_0x1a5283='';if(_0x1aaebc!=null&&_0x1aaebc!=''){var _0x34a90f=new Date(_0x1aaebc);_0x1aaebc=_0x34a90f[_0x2c9b3a(0x240)](_0x2c9b3a(0x25f)),_0x1a5283=GetDateStandardFormat(_0x1aaebc);}else _0x1a5283=null;txtProjectStatus=$(_0x2c9b3a(0x200))['val']();if(txtProjectStatus==_0x2c9b3a(0x273)||txtProjectStatus==_0x2c9b3a(0x282)){var _0x2c52cd='',_0x27095e=$('.txtActualEndDate')[_0x2c9b3a(0x1d9)]();if(_0x27095e!=null&&_0x27095e!=''){var _0x34a90f=new Date(_0x27095e);_0x27095e=_0x34a90f['format']('dd/MM/yyyy'),_0x2c52cd=GetDateStandardFormat(_0x27095e);}}else var _0x2c52cd=null;txtDepartmentID=$(_0x2c9b3a(0x268))['find'](_0x2c9b3a(0x261))[_0x2c9b3a(0x1d9)](),DepartmentFullName=$(_0x2c9b3a(0x268))[_0x2c9b3a(0x1f3)](_0x2c9b3a(0x275))[_0x2c9b3a(0x1e4)](),txtofficeLocationID=$(_0x2c9b3a(0x182))[_0x2c9b3a(0x1f3)]('#officeLocationDetails')['val'](),OfficeFullName=$(_0x2c9b3a(0x182))[_0x2c9b3a(0x1f3)]('select#officeLocationDetails\x20option:selected')[_0x2c9b3a(0x1e4)]();var _0x2d8359=getPeopleUserInfoGroups('ProjectManagerEmployeePicker');if(_0x2d8359[_0x2c9b3a(0x211)]==0x0)return alert(_0x2c9b3a(0x2c6)),![];_0x2d8359[_0x2c9b3a(0x211)]==0x1&&(txtManagerTeam=_0x2d8359[0x0]);txtStackeholderTeam=$('#StackeholderTeam')[_0x2c9b3a(0x1f3)](_0x2c9b3a(0x224))[_0x2c9b3a(0x1d9)](),txtSponsorTeam=$('#SponsorTeam')['find'](_0x2c9b3a(0x224))['val'](),txtDomain=$(_0x2c9b3a(0x26f))[_0x2c9b3a(0x1d9)]();var _0x35fd0a=$('#txtTechnology')[_0x2c9b3a(0x1d9)](),_0x5b5c8f=$(_0x2c9b3a(0x26a))[_0x2c9b3a(0x1d9)](),_0x63ac73=getConsultantValue();if(txtProjectStatus==_0x2c9b3a(0x273)||txtProjectStatus==_0x2c9b3a(0x282)){if($[_0x2c9b3a(0x293)](_0x1a5283)==''||_0x1a5283==null)alert(_0x2c9b3a(0x223)),waitingDialog[_0x2c9b3a(0x1f2)]();else{if($[_0x2c9b3a(0x293)](_0x2c52cd)==''||_0x2c52cd==null)alert('Please\x20enter\x20Actual\x20End\x20Date.'),waitingDialog[_0x2c9b3a(0x1f2)]();else txtProjectStatus==_0x2c9b3a(0x273)&&$[_0x2c9b3a(0x293)](_0x1a5283)!=''&&$[_0x2c9b3a(0x293)](_0x2c52cd)!=''&&_0x2c52cd<_0x1a5283?(alert(_0x2c9b3a(0x23c)),waitingDialog['hide']()):AddNewTak(_0x2c9b3a(0x1af),_0xabbc46,_0x1d3ae4,_0x49a3f3,_0x4375a3,_0x5cb718,_0x1a5283,_0x2c52cd,txtDepartmentID,DepartmentFullName,txtofficeLocationID,OfficeFullName,txtManagerTeam,txtStackeholderTeam,txtSponsorTeam,txtProjectStatus,_0x35fd0a,_0x5b5c8f,txtDomain,_0x63ac73,_0x18f122,_0x5654cc);}}else AddNewTak(_0x2c9b3a(0x1af),_0xabbc46,_0x1d3ae4,_0x49a3f3,_0x4375a3,_0x5cb718,_0x1a5283,_0x2c52cd,txtDepartmentID,DepartmentFullName,txtofficeLocationID,OfficeFullName,txtManagerTeam,txtStackeholderTeam,txtSponsorTeam,txtProjectStatus,_0x35fd0a,_0x5b5c8f,txtDomain,_0x63ac73,_0x18f122,_0x5654cc);AddProjectManagerAsADefaultMemeber(txtManagerTeam,_0x4375a3,_0x5cb718,_0x49a3f3,_0xabbc46);}function RelesedProjectManager(_0x1cca7d){var _0x517bd2=a407_0xa38737,_0x4fca1b,_0x39a6d6=new Date(),_0x5e93af=Logged_CompanyId;siteURL=_spPageContextInfo[_0x517bd2(0x1b4)]+_0x517bd2(0x20b)+_0x1cca7d+_0x517bd2(0x26b),$[_0x517bd2(0x1ad)]({'url':siteURL,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x3a3a0e){var _0x17c6b6=_0x517bd2,_0x1d452b=_0x3a3a0e['d'][_0x17c6b6(0x1ef)];if(_0x1d452b[_0x17c6b6(0x211)]>0x0){_0x4fca1b=_0x1d452b[0x0]['ID'];var _0x3d77d5=_0x1d452b[0x0][_0x17c6b6(0x2b6)];$['ajax']({'url':_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/GetByTitle(\x27ProjectTeamDetails\x27)/items(\x27'+_0x4fca1b+'\x27)','type':_0x17c6b6(0x1fb),'async':![],'data':JSON[_0x17c6b6(0x298)]({'__metadata':{'type':'SP.Data.ProjectTeamDetailsListItem'},'TeamPermission':![],'DocumentPermission':![],'TaskPermission':![],'Status':'Relesed','ReleseDate':_0x39a6d6}),'headers':{'Accept':_0x17c6b6(0x24a),'Content-Type':_0x17c6b6(0x24a),'X-RequestDigest':$(_0x17c6b6(0x2c5))[_0x17c6b6(0x1d9)](),'IF-MATCH':'*','X-HTTP-Method':_0x17c6b6(0x205)},'success':function(_0x1645f2){var _0x51c1d7=_0x17c6b6;console[_0x51c1d7(0x2a3)](_0x51c1d7(0x299)),(CreatedId==_spPageContextInfo['userId']||_spPageContextInfo['isSiteAdmin']==!![])&&(NewPMNameID!=OldPMNameID&&_0x3d77d5!=_spPageContextInfo[_0x51c1d7(0x198)]&&BreakInheritePermissionDMSLibrary(_0x3d77d5,_0x51c1d7(0x19e),'Remove'));},'error':function(_0x188f13){var _0x3e49d6=_0x17c6b6;console['log'](_0x3e49d6(0x2b1)),console[_0x3e49d6(0x2a3)](_0x188f13);}});}},'error':function(_0x1ec4fa){var _0x18848b=_0x517bd2;console['log'](_0x18848b(0x28c)),console[_0x18848b(0x2a3)](_0x1ec4fa);}});}function GetProjectManager(_0x1a7aa3){var _0x5e0150=a407_0xa38737,_0x50ca97,_0x55b868=new Date(),_0x9db252=Logged_CompanyId;siteURL=_spPageContextInfo[_0x5e0150(0x1b4)]+_0x5e0150(0x20b)+_0x1a7aa3+'\x27\x20and\x20Role\x20eq\x20\x27Project\x20Manager\x27\x20and\x20Status\x20eq\x20\x27Active\x27&$OrderBy\x20ID\x20desc',$[_0x5e0150(0x1ad)]({'url':siteURL,'headers':{'Accept':_0x5e0150(0x24a)},'async':![],'success':function(_0x3db99a){var _0x4cf6c3=_0x5e0150,_0x24ff7d=_0x3db99a['d'][_0x4cf6c3(0x1ef)];if(_0x24ff7d['length']>0x0){_0x50ca97=_0x24ff7d[0x0]['ID'];var _0x557767=_0x24ff7d[0x0][_0x4cf6c3(0x2b6)];$[_0x4cf6c3(0x1ad)]({'url':_spPageContextInfo[_0x4cf6c3(0x1b4)]+'/_api/web/lists/GetByTitle(\x27ProjectTeamDetails\x27)/items(\x27'+_0x50ca97+'\x27)','type':'POST','async':![],'data':JSON[_0x4cf6c3(0x298)]({'__metadata':{'type':'SP.Data.ProjectTeamDetailsListItem'},'TeamPermission':![],'DocumentPermission':![],'TaskPermission':![],'Status':_0x4cf6c3(0x248),'ReleseDate':_0x55b868}),'headers':{'Accept':_0x4cf6c3(0x24a),'Content-Type':_0x4cf6c3(0x24a),'X-RequestDigest':$(_0x4cf6c3(0x2c5))[_0x4cf6c3(0x1d9)](),'IF-MATCH':'*','X-HTTP-Method':_0x4cf6c3(0x205)},'success':function(_0x2695d3){var _0x5207d4=_0x4cf6c3;(CreatedId==_spPageContextInfo[_0x5207d4(0x198)]||_spPageContextInfo[_0x5207d4(0x2b5)]==!![])&&(NewPMNameID!=OldPMNameID&&_0x557767!=_spPageContextInfo[_0x5207d4(0x198)]&&BreakInheritePermissionDMSLibrary(_0x557767,_0x5207d4(0x19e),_0x5207d4(0x2b7)));console[_0x5207d4(0x2a3)](_0x5207d4(0x299));var _0x5cdf8c=_0x5207d4(0x2ab),_0x1b304b=_0x5207d4(0x23f),_0x3d1c03={'__metadata':{'type':_0x5207d4(0x2bf)+_0x5cdf8c+_0x5207d4(0x1b3)},'TeamMemberId':txtManagerTeam,'Role':_0x1b304b,'EngageDate':StartDate,'ExpectedReleseDate':EndDate,'TeamPermission':!![],'DocumentPermission':!![],'TaskPermission':!![],'CompanyId':Logged_CompanyId,'ProjectId':titanForWork[_0x5207d4(0x285)]('ProjectID')};UniversalinsertProject(_0x5cdf8c,_0x3d1c03),(CreatedId==_spPageContextInfo[_0x5207d4(0x198)]||_spPageContextInfo[_0x5207d4(0x2b5)]==!![])&&(NewPMNameID!=OldPMNameID&&BreakInheritePermissionDMSLibrary(txtManagerTeam,_0x5207d4(0x181),'Add'));},'error':function(_0x52db9a){var _0x150287=_0x4cf6c3;console[_0x150287(0x2a3)](_0x150287(0x2b1)),console[_0x150287(0x2a3)](_0x52db9a);}});}},'error':function(_0x452542){var _0x50e79a=_0x5e0150;console['log'](_0x50e79a(0x28c)),console[_0x50e79a(0x2a3)](_0x452542);}});}function GetProjectTeamMemberID(_0x39a70d){var _0x32041c=a407_0xa38737,_0x34cf07=_0x39a70d,_0xc43f64,_0x46838b=Logged_CompanyId,_0x3b1880=$(_0x32041c(0x1d8))[_0x32041c(0x1d9)]();return siteURL=_spPageContextInfo[_0x32041c(0x1b4)]+'/_api/web/lists/getbytitle(\x27ProjectTeamDetails\x27)/items?$select=*,ID&$filter=ProjectId\x20eq\x20\x27'+_0x39a70d+_0x32041c(0x185),$[_0x32041c(0x1ad)]({'url':siteURL,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x3ea845){var _0x1d2a0a=_0x32041c,_0x595383=_0x3ea845['d'][_0x1d2a0a(0x1ef)];if(_0x595383['length']>0x0){var _0x66092c=0x0;for(var _0x4a9963=0x0;_0x4a9963<_0x595383[_0x1d2a0a(0x211)];_0x4a9963++){var _0x794ec6=_0x595383[_0x4a9963][_0x1d2a0a(0x2b6)];if(NewPMNameID==_0x794ec6[_0x1d2a0a(0x1ac)]()){_0xc43f64=_0x595383[_0x4a9963]['ID'],RelesedProjectManager(_0x34cf07);break;}else _0x66092c=_0x66092c+0x1;}_0x66092c==_0x595383[_0x1d2a0a(0x211)]&&GetProjectManager(_0x34cf07);}else{var _0x4f825d='ProjectTeamDetails',_0x6a30e2='Project\x20Manager',_0x314442={'__metadata':{'type':_0x1d2a0a(0x2bf)+_0x4f825d+_0x1d2a0a(0x1b3)},'TeamMemberId':txtManagerTeam,'Role':_0x6a30e2,'EngageDate':StartDate,'ExpectedReleseDate':EndDate,'TeamPermission':!![],'DocumentPermission':!![],'TaskPermission':!![],'CompanyId':Logged_CompanyId,'ProjectId':titanForWork[_0x1d2a0a(0x285)](_0x1d2a0a(0x20e))};UniversalinsertProject(_0x4f825d,_0x314442);}},'error':function(_0x135ad1){var _0xcb28fe=_0x32041c;console[_0xcb28fe(0x2a3)](_0x135ad1);}}),_0xc43f64;}function AddProjectManagerAsADefaultMemeber(_0x13e059,_0x5bd70a,_0x7a31df,_0x101377,_0xb6a387){var _0x5a0b86=a407_0xa38737,_0x4ec2d1=GetProjectTeamMemberID(_0xb6a387);if(_0x4ec2d1!=undefined){var _0x5a229d=$['Deferred'](),_0x22d645='ProjectTeamDetails',_0x46e01a=CreateMetadataForAddingProjectManager(_0x22d645,_0x13e059,_0x5bd70a,_0x7a31df,_0x101377),_0x399f58=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/getbytitle(\x27'+_0x22d645+_0x5a0b86(0x17f)+_0x4ec2d1+')',_0x24deb3={'Accept':'application/json;odata=verbose','Content-Type':_0x5a0b86(0x24a),'X-RequestDigest':$(_0x5a0b86(0x2c5))[_0x5a0b86(0x1d9)](),'IF-MATCH':'*','X-HTTP-Method':_0x5a0b86(0x205)};return $[_0x5a0b86(0x1ad)]({'url':_0x399f58,'type':'POST','async':![],'headers':_0x24deb3,'data':JSON['stringify'](_0x46e01a),'success':function(_0x4c66e7){var _0x8a77b8=_0x5a0b86;console[_0x8a77b8(0x2a3)](_0x8a77b8(0x1c6)),(CreatedId==_spPageContextInfo['userId']||_spPageContextInfo[_0x8a77b8(0x2b5)]==!![])&&(NewPMNameID!=OldPMNameID&&BreakInheritePermissionDMSLibrary(_0x13e059,_0x8a77b8(0x181),_0x8a77b8(0x193)));},'error':function(_0x4d5eaa){var _0x343702=_0x5a0b86;console[_0x343702(0x2a3)](data),_0x5a229d[_0x343702(0x2a0)](_0x4d5eaa);}}),_0x5a229d[_0x5a0b86(0x25d)]();}}function CreateMetadataForAddingProjectManager(_0x1d3a00,_0x4d0d41,_0x5a51b2,_0xc41764,_0x529cea){var _0xd2dca=a407_0xa38737,_0x55b928=GetItemTypeForListName(_0x1d3a00),_0x39611b;return _0x39611b={'__metadata':{'type':_0x55b928}},_0x39611b[_0xd2dca(0x2b6)]=_0x4d0d41,_0x39611b[_0xd2dca(0x26d)]='Project\x20Manager',_0x39611b[_0xd2dca(0x2b2)]=_0x5a51b2,_0x39611b[_0xd2dca(0x28e)]=_0xd2dca(0x1ae),_0x39611b[_0xd2dca(0x28f)]=_0xc41764,_0x39611b['TeamPermission']=!![],_0x39611b[_0xd2dca(0x2b8)]=!![],_0x39611b[_0xd2dca(0x19f)]=!![],_0x39611b[_0xd2dca(0x292)]=Logged_CompanyId,_0x39611b;}function a407_0x2442(_0x2297c1,_0x320d9d){var _0x4dfde1=a407_0x4dfd();return a407_0x2442=function(_0x2442b5,_0x267689){_0x2442b5=_0x2442b5-0x172;var _0x556c45=_0x4dfde1[_0x2442b5];return _0x556c45;},a407_0x2442(_0x2297c1,_0x320d9d);}function LoadAllHolidays(){var _0x180836=a407_0xa38737,_0x2fb386=0x0,_0x5701d4=$('.txtPlannedStartDate')[_0x180836(0x1d9)](),_0x5b93d0=new Date(_0x5701d4);_0x5701d4=_0x5b93d0[_0x180836(0x240)](_0x180836(0x25f));var _0x2b8ad4=new Date(ConvertDateTimeFormat(_0x5701d4,'/')),_0x2b32d2=_0x2b8ad4[_0x180836(0x21b)]()+'-'+(_0x2b8ad4['getMonth']()+0x1)+'-'+_0x2b8ad4['getDate'](),_0xe88cfd=$(_0x180836(0x21d))[_0x180836(0x1d9)](),_0x5b93d0=new Date(_0xe88cfd);_0xe88cfd=_0x5b93d0[_0x180836(0x240)](_0x180836(0x25f));var _0x549e2d=new Date(ConvertDateTimeFormat(_0xe88cfd,'/')),_0x4f2b5d=_0x549e2d[_0x180836(0x21b)]()+'-'+(_0x549e2d[_0x180836(0x176)]()+0x1)+'-'+_0x549e2d['getDate'](),_0x5bdd0e=_spPageContextInfo[_0x180836(0x1b4)]+_0x180836(0x174)+Logged_Location+'\x27\x20and\x20CompanyID\x20eq\x20\x27'+Logged_CompanyId+_0x180836(0x1fd)+_0x2b32d2+_0x180836(0x1e8)+_0x4f2b5d+'\x27';return $[_0x180836(0x1ad)]({'url':_0x5bdd0e,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x54f0e6){var _0x29a2b5=_0x180836;_0x2fb386=_0x54f0e6['d'][_0x29a2b5(0x1ef)]['length'];},'myError':function(_0x2e603b){console['log'](_0x2e603b);}}),_0x2fb386;}function ConvertDateTimeFormat(_0x5575e2,_0x232ad4){var _0x1ef66d=a407_0xa38737;return _0x5575e2[_0x1ef66d(0x22e)](_0x232ad4)[0x1]+''+_0x232ad4+''+_0x5575e2[_0x1ef66d(0x22e)](_0x232ad4)[0x0]+''+_0x232ad4+''+_0x5575e2[_0x1ef66d(0x22e)](_0x232ad4)[0x2];}function AddNewTak(_0x41919c,_0x517e44,_0x132849,_0x3e94f6,_0x480837,_0xe520f3,_0x52cf9d,_0x38c6e0,_0x4c8976,_0x400ec8,_0x498e10,_0x19ce9c,_0x19967c,_0x1f5063,_0x376ab3,_0x20f53f,_0x441e2d,_0x2b00ad,_0x4a8f30,_0x29173f,_0x54da11,_0x4b69aa){var _0x3c0588=a407_0xa38737;try{$('#EstimatedTime')[_0x3c0588(0x1d9)]()==''&&$(_0x3c0588(0x22d))[_0x3c0588(0x1d9)]('0');var _0x25ac17,_0xedb7e1=GetItemTypeForListName(_0x41919c);_0x25ac17={'__metadata':{'type':_0xedb7e1},'Title':_0x3e94f6,'ProjectCode':_0x132849,'ProjectName':_0x3e94f6,'ProjectDescription':_0x2b00ad,'DepartmentId':_0x4c8976,'Department_IDId':_0x4c8976,'ActualStartDate':_0x52cf9d,'ActualEndDate':_0x38c6e0,'PlanedStartDate':_0x480837,'PlanedEndDate':_0xe520f3,'TechnologyUsed':_0x441e2d,'Status':_0x20f53f,'DepartmentName':_0x400ec8,'ConsultantName':_0x29173f,'ManagerNameId':_0x19967c,'StackeholderId':null,'SponsorId':null,'OfficeLocation':_0x19ce9c,'Domain':_0x4a8f30,'OfficeLocationID':_0x498e10,'Office_Location_IdId':_0x498e10,'MultipleStackeholderId':{'results':_0x54da11},'MultipleSponsorId':{'results':_0x4b69aa},'ProjectInternalName':projectInternalName,'EstimatedWorkHours':$(_0x3c0588(0x22d))[_0x3c0588(0x1d9)](),'ProgramIDId':$(_0x3c0588(0x1a7))[_0x3c0588(0x1d9)]()},(_0x52cf9d==null||_0x52cf9d=='')&&delete _0x25ac17[_0x3c0588(0x202)],_0x20f53f!='Live'&&_0x20f53f!=_0x3c0588(0x239)&&((_0x38c6e0==null||_0x38c6e0=='')&&delete _0x25ac17[_0x3c0588(0x1be)]),(_0xe520f3==null||_0xe520f3=='')&&delete _0x25ac17[_0x3c0588(0x1ba)],(_0x480837==null||_0x480837=='')&&delete _0x25ac17['PlanedStartDate'],AddItemToList(_0x41919c,_0x25ac17,_0x517e44);}catch(_0x2a080f){console[_0x3c0588(0x2a3)](_0x2a080f['message']);}}function AddItemToList(_0x557694,_0x5268e5,_0x258d02){var _0x3afff2=a407_0xa38737,_0x1a112a=$[_0x3afff2(0x279)]();return $[_0x3afff2(0x1ad)]({'url':_spPageContextInfo[_0x3afff2(0x1b4)]+'/_api/web/lists/getbytitle(\x27'+_0x557694+_0x3afff2(0x1a5)+_0x258d02+'\x27)','type':_0x3afff2(0x1fb),'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$('#__REQUESTDIGEST')[_0x3afff2(0x1d9)](),'content-Type':_0x3afff2(0x24a),'X-Http-Method':_0x3afff2(0x2aa),'If-Match':'*'},'data':JSON[_0x3afff2(0x298)](_0x5268e5),'async':![],'success':function(_0x1f5e44){var _0xa74636=_0x3afff2;_0x1a112a[_0xa74636(0x1f9)](!![]);IsProjectAdmin==!![]&&UpdateProjectSiteTitle();alert(_0xa74636(0x22b)),waitingDialog['hide']();var _0x2e128b=Logged_CompanyId,_0x2ea5bf=_spPageContextInfo[_0xa74636(0x189)];if(window[_0xa74636(0x1cb)]($[_0xa74636(0x1a6)](_0xa74636(0x1d4)))!=_0xa74636(0x1a3)){var _0x411bc0='';_0x411bc0=_spPageContextInfo[_0xa74636(0x1b4)]+_0xa74636(0x1db)+Logged_CompanyId+_0xa74636(0x1dd)+projectItemID+_0xa74636(0x1c7)+$[_0xa74636(0x293)]($(_0xa74636(0x1d8))[_0xa74636(0x1d9)]()),location['href']=_0x411bc0;}else location[_0xa74636(0x2c3)]=$[_0xa74636(0x1a6)]('sourceLocation')+_0xa74636(0x1c7)+$(_0xa74636(0x1d8))[_0xa74636(0x1d9)]();},'error':function(_0x4d3406){var _0x679d00=_0x3afff2;console['log'](JSON[_0x679d00(0x298)](_0x4d3406)),_0x1a112a[_0x679d00(0x2a0)](_0x4d3406);}}),_0x1a112a[_0x3afff2(0x25d)]();}function GetItemTypeForListName(_0xe0c52f){var _0x18142b=a407_0xa38737;return _0x18142b(0x2bf)+_0xe0c52f[_0x18142b(0x1a1)](0x0)[_0x18142b(0x17c)]()+_0xe0c52f['split']('\x20')['join']('')[_0x18142b(0x23d)](0x1)+_0x18142b(0x1b3);}function UpdateProjectSiteTitle(){var _0x59b39e=a407_0xa38737,_0x47241d=$(_0x59b39e(0x1d8))['val'](),_0x5f040f=JSON[_0x59b39e(0x298)]({'__metadata':{'type':_0x59b39e(0x1e3)},'Description':_0x59b39e(0x1cc),'Title':_0x47241d}),_0x555640=titanForWork[_0x59b39e(0x285)](_0x59b39e(0x214))+_0x59b39e(0x204)+projectInternalName+'/_api/web';$[_0x59b39e(0x1ad)]({'url':_0x555640,'type':_0x59b39e(0x1fb),'async':![],'data':_0x5f040f,'headers':{'accept':_0x59b39e(0x24a),'content-type':'application/json;odata=verbose','X-RequestDigest':$(_0x59b39e(0x2c5))[_0x59b39e(0x1d9)](),'X-HTTP-Method':_0x59b39e(0x205)},'success':function(_0x503b47){var _0x87f3cb=_0x59b39e;console[_0x87f3cb(0x2a3)](_0x87f3cb(0x1ec));},'error':function(_0x629f85){var _0x4a00aa=_0x59b39e;console[_0x4a00aa(0x2a3)](_0x4a00aa(0x210));}});}function GetDateStandardFormat(_0xb16d5f){var _0x2004a3=ConvertDateFormatToddMMyyyy(_0xb16d5f),_0xea482b=new Date(_0x2004a3),_0x1d4bdc=0x3c*0x3c*0x18*0x3e8,_0x59abc7=new Date(_0xea482b['getTime']()),_0x2c7597=_0x59abc7['toISOString']();return _0x2c7597;}function ConvertDateFormatToddMMyyyy(_0x3ceaa3){var _0x57e6bb=a407_0xa38737,_0x4605d4=stringToDate(_0x3ceaa3,_0x57e6bb(0x25f),'/');return _0x4605d4;}function stringToDate(_0x2b73c9,_0x3e6978,_0x1f23a5){var _0x18b844=a407_0xa38737,_0x5c9f22=_0x3e6978[_0x18b844(0x2a9)](),_0x6d9b27=_0x5c9f22[_0x18b844(0x22e)](_0x1f23a5),_0x3e773c=_0x2b73c9[_0x18b844(0x22e)](_0x1f23a5),_0x5f3065=_0x6d9b27[_0x18b844(0x1f7)]('mm'),_0x5c9bdc=_0x6d9b27[_0x18b844(0x1f7)]('dd'),_0x305221=_0x6d9b27['indexOf'](_0x18b844(0x19c)),_0x58982d=parseInt(_0x3e773c[_0x5f3065]);_0x58982d-=0x1;var _0x45d02f=new Date(_0x3e773c[_0x305221],_0x58982d,_0x3e773c[_0x5c9bdc]);return _0x45d02f;}$(document)['ready'](function(){var _0x33ed12=a407_0xa38737;$('#ProjectStatus')[_0x33ed12(0x26e)](function(){var _0x443b19=_0x33ed12,_0x3f5dbb=$(_0x443b19(0x200))['val']();if(_0x3f5dbb=='Live'||_0x3f5dbb==_0x443b19(0x239))$('.MandActDate')[_0x443b19(0x1f2)](),$('.txtActualEndDate\x20')['val'](''),$(_0x443b19(0x1d6))['hide']();else(_0x3f5dbb==_0x443b19(0x282)||_0x3f5dbb==_0x443b19(0x273))&&($(_0x443b19(0x2a4))['show'](),$(_0x443b19(0x1d6))[_0x443b19(0x20c)]());}),$(_0x33ed12(0x1d6))[_0x33ed12(0x1f2)](),$(_0x33ed12(0x1f4))[_0x33ed12(0x17b)](function(){var _0xcad3a7=_0x33ed12;window[_0xcad3a7(0x1cb)]($[_0xcad3a7(0x1a6)](_0xcad3a7(0x1d4)))!='true'?location[_0xcad3a7(0x2c3)]=document['referrer']:location[_0xcad3a7(0x2c3)]=$[_0xcad3a7(0x1a6)](_0xcad3a7(0x227))+_0xcad3a7(0x24c)+$('#txtProjectName')[_0xcad3a7(0x1d9)]();}),$(_0x33ed12(0x19d))['prop'](_0x33ed12(0x18a),!![]);});function GetProjectDetailsformail(){var _0x370bce=a407_0xa38737,_0x14bb45=titanForWork[_0x370bce(0x285)](_0x370bce(0x20e));projectManage=[],StakeHolders=[],ProjectSponsors=[],stackToUsers='',sponsorToUsers='',projectItemDetails=[];var _0xc578d5=_spPageContextInfo[_0x370bce(0x1b4)]+_0x370bce(0x283)+_0x14bb45+'\x27';$[_0x370bce(0x1ad)]({'url':_0xc578d5,'method':_0x370bce(0x2b0),'headers':{'Accept':'application/json;\x20odata=verbose'},'async':![],'success':function(_0x2b87fa){var _0x8aa69a=_0x370bce,_0x4a4aa6=_0x2b87fa,_0x39fdec='';for(var _0x7d4e6c=0x0;_0x7d4e6c<_0x4a4aa6['d'][_0x8aa69a(0x1ef)][_0x8aa69a(0x211)];_0x7d4e6c++){_0x4a4aa6['d'][_0x8aa69a(0x1ef)][_0x7d4e6c][_0x8aa69a(0x2ad)]!=null&&(projectManage[_0x8aa69a(0x22f)](_0x4a4aa6['d']['results'][_0x7d4e6c][_0x8aa69a(0x2ad)]['UserName']),projecttouser+=_0x4a4aa6['d']['results'][_0x7d4e6c][_0x8aa69a(0x2ad)][_0x8aa69a(0x230)]+',',projecttouser=projecttouser[_0x8aa69a(0x2c7)](/,(\s+)?$/,''));if(_0x4a4aa6['d'][_0x8aa69a(0x1ef)][_0x7d4e6c]['MultipleStackeholder']['results']!=null){for(var _0x23426d=0x0;_0x23426d<_0x4a4aa6['d']['results'][_0x7d4e6c][_0x8aa69a(0x1f5)][_0x8aa69a(0x1ef)][_0x8aa69a(0x211)];_0x23426d++){StakeHolders['push'](_0x4a4aa6['d']['results'][_0x7d4e6c]['MultipleStackeholder'][_0x8aa69a(0x1ef)][_0x23426d][_0x8aa69a(0x245)]),stackToUsers+=_0x4a4aa6['d'][_0x8aa69a(0x1ef)][_0x7d4e6c]['MultipleStackeholder'][_0x8aa69a(0x1ef)][_0x23426d]['Title']+',';}stackToUsers=stackToUsers['replace'](/,(\s+)?$/,'');}if(_0x4a4aa6['d']['results'][_0x7d4e6c]['MultipleSponsor'][_0x8aa69a(0x1ef)]!=null){for(var _0x23426d=0x0;_0x23426d<_0x4a4aa6['d']['results'][_0x7d4e6c][_0x8aa69a(0x277)][_0x8aa69a(0x1ef)]['length'];_0x23426d++){ProjectSponsors[_0x8aa69a(0x22f)](_0x4a4aa6['d']['results'][_0x7d4e6c][_0x8aa69a(0x277)][_0x8aa69a(0x1ef)][_0x23426d][_0x8aa69a(0x245)]),sponsorToUsers+=_0x4a4aa6['d'][_0x8aa69a(0x1ef)][_0x7d4e6c][_0x8aa69a(0x277)][_0x8aa69a(0x1ef)][_0x23426d][_0x8aa69a(0x230)]+',';}sponsorToUsers=sponsorToUsers[_0x8aa69a(0x2c7)](/,(\s+)?$/,'');}alluser=StakeHolders['concat'](ProjectSponsors,projectManage),projectItemDetails[_0x8aa69a(0x22f)](TaskMetadata(_0x4a4aa6['d']['results'][_0x7d4e6c],projecttouser,stackToUsers,sponsorToUsers));}},'error':function(_0x36d5e7){var _0x210a64=_0x370bce;console[_0x210a64(0x2a3)](JSON[_0x210a64(0x298)](_0x36d5e7));}});}function GetTaskEmailTemplate(_0x6129fb){var _0x5953d7=a407_0xa38737,_0x90dc03=_spPageContextInfo[_0x5953d7(0x1c1)]+_0x5953d7(0x1e1)+_0x6129fb+'\x27';$[_0x5953d7(0x1ad)]({'url':_0x90dc03,'headers':{'accept':_0x5953d7(0x24a),'content-type':_0x5953d7(0x24a),'X-RequestDigest':$(_0x5953d7(0x2c5))[_0x5953d7(0x1d9)]()},'async':![],'success':function(_0x3ea213){var _0x47635a=_0x5953d7,_0x40eab2=_0x3ea213['d'][_0x47635a(0x1ef)];for(var _0x5a0198=0x0;_0x5a0198<_0x40eab2['length'];_0x5a0198++){_0x40eab2[_0x5a0198][_0x47635a(0x29e)]!=null&&(emailBodyContent=_0x40eab2[_0x5a0198]['Body']),_0x40eab2[_0x5a0198][_0x47635a(0x27f)]!=null&&(taskEmailSubject=_0x40eab2[_0x5a0198][_0x47635a(0x27f)]);}},'error':function(_0x24ea80){var _0x1cc13e=_0x5953d7;console[_0x1cc13e(0x2a3)]('error');}});}function SendTaskEmail(){var _0xca86dc=a407_0xa38737,_0x1b44c7=emailBodyContent,_0x2d84fd=taskEmailSubject;projectItemDetails[_0xca86dc(0x206)](function(_0x2b8683){var _0x46c03f=_0xca86dc;_0x1b44c7=_0x1b44c7[_0x46c03f(0x2c7)](_0x46c03f(0x278),_0x2b8683[_0x46c03f(0x2a1)]),_0x1b44c7=_0x1b44c7[_0x46c03f(0x2c7)]('{{ProjectCode}}',_0x2b8683[_0x46c03f(0x24e)]),_0x1b44c7=_0x1b44c7[_0x46c03f(0x2c7)](_0x46c03f(0x184),_0x2b8683['ProjectName']),_0x1b44c7=_0x1b44c7['replace'](_0x46c03f(0x27a),_0x2b8683[_0x46c03f(0x1f6)]),_0x1b44c7=_0x1b44c7['replace'](_0x46c03f(0x216),_0x2b8683['Status']),_0x1b44c7=_0x1b44c7[_0x46c03f(0x2c7)](_0x46c03f(0x27a),_0x2b8683[_0x46c03f(0x1f6)]),_0x2b8683['DepartmentName']==_0x46c03f(0x24f)?_0x1b44c7=_0x1b44c7[_0x46c03f(0x2c7)](_0x46c03f(0x1fc),''):_0x1b44c7=_0x1b44c7[_0x46c03f(0x2c7)](_0x46c03f(0x1fc),_0x2b8683[_0x46c03f(0x265)]),_0x2b8683[_0x46c03f(0x179)]=='-Select-'?_0x1b44c7=_0x1b44c7['replace'](_0x46c03f(0x246),''):_0x1b44c7=_0x1b44c7[_0x46c03f(0x2c7)]('{{Location}}',_0x2b8683['OfficeLocation']),_0x1b44c7=_0x1b44c7['replace'](_0x46c03f(0x1da),_0x2b8683[_0x46c03f(0x219)]),_0x1b44c7=_0x1b44c7[_0x46c03f(0x2c7)](_0x46c03f(0x29a),_0x2b8683[_0x46c03f(0x1ba)]),_0x1b44c7=_0x1b44c7['replace'](_0x46c03f(0x2cb),_spPageContextInfo[_0x46c03f(0x1b4)]+_0x46c03f(0x1db)+companyID+_0x46c03f(0x1dd)+_0x2b8683['ID']+_0x46c03f(0x1c7)+_0x2b8683[_0x46c03f(0x173)]+'');});var _0x5d7ef1=_spPageContextInfo[_0xca86dc(0x1bf)],_0x20321b;_0x20321b={'properties':{'__metadata':{'type':'SP.Utilities.EmailProperties'},'From':_0x5d7ef1,'To':{'results':alluser},'Body':_0x1b44c7,'Subject':_0x2d84fd}};var _0x24dcfa=_spPageContextInfo[_0xca86dc(0x189)]+_0xca86dc(0x1c4);$['ajax']({'contentType':_0xca86dc(0x228),'url':_0x24dcfa,'type':_0xca86dc(0x1fb),'data':JSON[_0xca86dc(0x298)](_0x20321b),'async':![],'headers':{'Accept':'application/json;odata=verbose','content-type':'application/json;odata=verbose','X-RequestDigest':$(_0xca86dc(0x2c5))[_0xca86dc(0x1d9)]()},'success':function(_0x194959){var _0x1b6649=_0xca86dc;console[_0x1b6649(0x2a3)](_0x1b6649(0x264));},'error':function(_0x54ab0c){var _0x28e146=_0xca86dc;waitingDialog[_0x28e146(0x1f2)](),console[_0x28e146(0x2a3)]('SendEmailSharedNotification\x20\x20'+JSON['stringify'](_0x54ab0c));}});}function TaskMetadata(_0x489977,_0x3e5bf3,_0x133a32,_0x29ea01){var _0x48b9ce=a407_0xa38737,_0x37a2ad={};return _0x37a2ad[_0x48b9ce(0x173)]=_0x489977[_0x48b9ce(0x173)]==null?'':_0x489977[_0x48b9ce(0x173)],_0x37a2ad[_0x48b9ce(0x1f6)]=_0x489977[_0x48b9ce(0x1e9)][_0x48b9ce(0x230)]==null?'':_0x489977[_0x48b9ce(0x1e9)]['Title'],_0x37a2ad[_0x48b9ce(0x265)]=_0x489977[_0x48b9ce(0x265)]==null?'':_0x489977[_0x48b9ce(0x265)],_0x37a2ad[_0x48b9ce(0x28e)]=_0x489977[_0x48b9ce(0x28e)]==null?'':_0x489977[_0x48b9ce(0x28e)],_0x37a2ad[_0x48b9ce(0x24e)]=_0x489977[_0x48b9ce(0x24e)]==null?'':_0x489977[_0x48b9ce(0x24e)],_0x37a2ad[_0x48b9ce(0x179)]=_0x489977[_0x48b9ce(0x179)]==null?'':_0x489977[_0x48b9ce(0x179)],_0x37a2ad['ID']=_0x489977['OfficeLocation']==null?'':_0x489977['ID'],_0x37a2ad[_0x48b9ce(0x172)]=_0x489977['ProjectSiteURL'],_0x37a2ad[_0x48b9ce(0x2a1)]=_0x3e5bf3,_0x37a2ad[_0x48b9ce(0x2cd)]=_0x133a32,_0x37a2ad[_0x48b9ce(0x241)]=_0x29ea01,_0x37a2ad[_0x48b9ce(0x219)]=_0x489977['PlanedStartDate'],_0x37a2ad[_0x48b9ce(0x219)]=new Date(_0x37a2ad[_0x48b9ce(0x219)]),_0x37a2ad['PlanedStartDate']=$['datepicker'][_0x48b9ce(0x2a6)](_0x48b9ce(0x1de),_0x37a2ad[_0x48b9ce(0x219)]),_0x37a2ad[_0x48b9ce(0x1ba)]=_0x489977[_0x48b9ce(0x1ba)],_0x37a2ad[_0x48b9ce(0x1ba)]=new Date(_0x37a2ad[_0x48b9ce(0x1ba)]),_0x37a2ad[_0x48b9ce(0x1ba)]=$[_0x48b9ce(0x225)][_0x48b9ce(0x2a6)]('dd-M-yy',_0x37a2ad['PlanedEndDate']),_0x37a2ad;}var IsProjectAdmin=![],IsDeptmentAdmin=![];function getProjectRights(){var _0x52ce6f=a407_0xa38737;debugger;var _0x2d6789,_0x1075c3='ProcessApprovers',_0x577f0c=titanForWork[_0x52ce6f(0x285)](_0x52ce6f(0x292)),_0x497817=Logged_DepartmentId,_0x55c71a=_spPageContextInfo[_0x52ce6f(0x1b4)]+_0x52ce6f(0x22a)+_0x1075c3+_0x52ce6f(0x199)+_0x577f0c+_0x52ce6f(0x23a)+_spPageContextInfo[_0x52ce6f(0x198)]+_0x52ce6f(0x260);$[_0x52ce6f(0x1ad)]({'url':_0x55c71a,'headers':{'Accept':_0x52ce6f(0x24a)},'async':!![],'success':function(_0x1ffbdb){var _0x45a333=_0x52ce6f,_0x22cd0a=_0x1ffbdb['d'][_0x45a333(0x1ef)];if(_0x22cd0a[_0x45a333(0x211)]>0x0)for(var _0x564d45=0x0;_0x564d45<_0x22cd0a['length'];_0x564d45++){var _0x3d4eb6=_0x22cd0a[_0x564d45]['WebPartName'],_0x531c72=_0x22cd0a[_0x564d45][_0x45a333(0x197)]['ID'];if(_0x3d4eb6=='Project\x20Admin')IsProjectAdmin=!![];else _0x3d4eb6=='Project'&&_0x497817==_0x531c72&&(IsDeptmentAdmin=!![]);}else IsProjectAdmin=![],IsDeptmentAdmmin=![];},'error':function(_0x5c62e2){var _0x2c0b90=_0x52ce6f;console[_0x2c0b90(0x2a3)]($(_0x2c0b90(0x266))['val']());}});}function a407_0x4dfd(){var _0x492bf4=['.messageCheckbox','PlanedStartDate','#ms-designer-ribbon','getFullYear','True','.txtPlannedEndDate','focus','\x20/>','3842136nSDDMs','ready','appendTo','Please\x20enter\x20Actual\x20Start\x20Date.','#TaskTeamDetails','datepicker','8vmHLSy','sourceLocation','application/json','[?&]','/_api/web/lists/getbytitle(\x27','Project\x20Details\x20Updated\x20Successfully','Author','#EstimatedTime','split','push','Title','Permission\x20has\x20been\x20breaked\x20successfully!',',roleDefId=','i:0#.f|membership|','Live','Created','602540IgdpKW','/_api/Web/Lists/GetByTitle(\x27ProjectDetails\x27)/Items?$select=Title&$filter=ProjectCode\x20eq\x20\x27','get_current','OnHold','\x27\x20and\x20ContributorsId\x20eq\x20\x27','checked','Actual\x20End\x20Date\x20can\x20not\x20less\x20than\x20Actual\x20Start\x20Date.','slice','<select\x20name=\x22officeLocation\x22\x20id=\x22departmentDetails\x22\x20class=\x22form-control\x22>','Project\x20Manager','format','sponsorToUsers','#txtTechnology','Unauthorized\x20access!','DELETE','UserName','{{Location}}','\x27)/items?$select=ID,SiteURL&$filter=ID\x20eq\x20\x27','Relesed','ProjectInternalName','application/json;odata=verbose','100%','&&ProjectName=','application/json;\x20odata=verbose','ProjectCode','-Select-','when','StackeholderTeamEmployeePicker','charCode','option','exec','CatogeryName','-50:+50','<select\x20name=\x22officeLocation\x22\x20id=\x22officeLocationDetails\x22\x20class=\x22form-control\x22>','select#officeLocationDetails\x20option[value=\x22','OfficeLocationID','MM\x20dd,\x20yy','TechnologyUsed','153393grxDWR','promise','2128245NwmsVJ','dd/MM/yyyy','\x27\x20and\x20(WebPartName\x20eq\x20\x27Project\x20Admin\x27\x20or\x20WebPartName\x20eq\x20\x27Project\x27)','#departmentDetails','EstimatedWorkHours','</span>','Message\x20has\x20been\x20sent.','DepartmentName','#txtSomethingWentWrong','Sponsor','#departmentDiv','\x27)/items','#txtDescription','\x27\x20and\x20Role\x20eq\x20\x27Project\x20Manager\x27\x20and\x20Status\x20eq\x20\x27Active\x27&$OrderBy\x20ID\x20desc','</select>','Role','change','#txtDomain','Key','error\x20:\x20Project\x20Details\x20web\x20part','/_api/Web/Lists/GetByTitle(\x27ProjectDetails\x27)/Items?$select=Title&$filter=CompanyId\x20eq\x20\x27','Terminated','False','select#departmentDetails\x20option:selected','EMail','MultipleSponsor','{{ProjectManager}}','Deferred','{{ProjectClientName}}','AddUserKeys','ConsultantName','ManagerNameId','#txtProjectCode','Subject','<span\x20title=\x22','\x20Successfully\x20removed\x20Permission\x20!','Completed','/_api/lists/getbytitle(\x27ProjectDetails\x27)/items?$select=*,ManagerName/Title,ManagerName/UserName,MultipleStackeholder/Title,MultipleStackeholder/UserName,MultipleSponsor/Title,MultipleSponsor/UserName,ClientID/Title&$Expand=ManagerName,ClientID,MultipleStackeholder,MultipleSponsor&$Filter=ID\x20eq\x20\x27','ProgramID','getQueryStringParameter','dt\x20a\x20span.value','prop','<option\x20value=\x22','.SideTabMenu','json','get_count','GetProjectManager','#txtWorkingDays','Status','ExpectedReleseDate','#ProjectStatus\x20option[value=','add\x20success','CompanyId','trim','closest','get_lists','</Value></Eq></Where><OrderBy><FieldRef\x20Name=\x27Title\x27/></OrderBy></Query></View>','getItemsWithQueryItem','stringify','OLD\x20PROJECT\x20MANAGER\x20RELESED!','{{PlannedEndDate}}','data','GetAllUserInfo','getByTitle','Body','Project\x20name\x20already\x20exist.','reject','projecttouser','get_item','log','.MandActDate','</ul>','formatDate','[id^=\x27','slideToggle','toLowerCase','PATCH','ProjectTeamDetails','SP.User','ManagerName','SponsorTeamEmployeePicker','</li>','GET','ERROR\x20:\x20OLD\x20PROJECT\x20MANAGER\x20RELESED!','EngageDate','SOD','.dropdown\x20dd\x20ul\x20li\x20a','isSiteAdmin','TeamMemberId','Remove','DocumentPermission','parents','.dropdown\x20dt\x20a','getItems','\x27\x20and\x20ProjectName\x20eq\x20\x27','16RYZlkx','null','SP.Data.','each','OfficeName','Please\x20fill\x20all\x20required\x20fields.','href','User\x20has\x20been\x20assigned\x20permission\x20.','#__REQUESTDIGEST','Please\x20Fill\x20the\x20Manager','replace','done','ClientContext','7skQQlh','{{Projectlink}}','get_web','stackToUsers','ProjectSiteURL','ProjectName','/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?select=*,ID,Title&$filter=OfficeLocationID\x20eq\x20\x27','.multiSel','getMonth','undefined','ProjectManagerEmployeePicker','OfficeLocation','filter','click','toUpperCase','<option></option>','#createNewProjectSite','\x27)/items(','keyCode','1073741829','#officeLocation','EntityType','{{ProjectName}}','\x27&$OrderBy\x20ID\x20desc','/_api/web/lists/getByTitle(\x27Documents\x27)/roleassignments/getbyprincipalid(','.txtActualEndDate','#createdByName','webServerRelativeUrl','disabled','sp.js',':checked','StackeholderId','/_api/web/siteusers(@v)?@v=\x27','<li><input\x20class=\x22messageCheckbox\x22\x20type=\x22checkbox\x22\x20value=','\x27\x20and\x20CompanyId\x20eq\x20\x27','keypress','__next','Add','</option>','ProjectDescription','SPClientPeoplePickerDict','Department','userId','\x27)/items?$select=*,Department/DepartmentName,Department/ID&$expand=Department&$filter=CompanyId\x20eq\x20\x27','../Pages/Default.aspx?WebAppId=','input[type=\x22checkbox\x22]','yyyy','.txtPlannedStartDate','1073741826','TaskPermission','target','charAt','moveNext','true','dateFormat','\x27)/GetItemById(\x27','urlParam','#ddlProgramList','.dropdown\x20dd\x20ul','/_api/web/lists/getbytitle(\x27ProjectDetails\x27)/items?$expand=ProgramID,MultipleStackeholder,ManagerName,Stackeholder,MultipleSponsor,ClientID,Sponsor,Author&$select=*,ProgramID/Id,ProgramID/Title,Stackeholder/UserName,Sponsor/UserName,MultipleStackeholder/UserName,MultipleSponsor/UserName,ManagerName/Title,ManagerName/UserName,ClientID/Title,Author/ID,Author/Title,Author/EMail&$filter=ID\x20eq\x20\x27','340672MNGCEd','Departments','toString','ajax','Active','ProjectDetails','Width','.mutliSelect\x20li','getEnumerator','ListItem','webAbsoluteUrl','hasClass','.hida','#StackeholderTeam','append','#s4-bodyContainer\x20.navbar-custom','PlanedEndDate','please\x20insert\x20only\x201\x20Manager','<option\x20value=\x220\x22>-Select-</option>','2711526kOfEEb','ActualEndDate','userEmail','SiteURL','siteAbsoluteUrl','SearchPrincipalSource','=([^&#]*)','/_api/SP.Utilities.Utility.SendEmail','/_api/web/lists/getbytitle(\x27Employees\x27)/items/','Project\x20Manager\x20Added\x20As\x20A\x20Default\x20Team\x20Member.','&ProjectName=','CamlQuery','.mutliSelect','DepartmentId','atob','Project\x20site','.multiSel\x20span','SponsorId','\x27)&$top=5000','Permission\x20has\x20been\x20assigned\x20successfully!','#txtTechnology\x20option','#officeLocationDetails','Estimated\x20hours\x20cannot\x20be\x20less\x20than\x20zero.','IsModal','\x27\x20and\x20Id\x20ne\x20\x27','.ActualEndDate','set_viewXml','#txtProjectName','val','{{PlannedStartDate}}','/Pages/ViewProjectDetails.aspx?WebAppId=','load','&ProjectID=','dd-M-yy','/_api/web/lists/getbytitle(\x27CategoryMaster\x27)/items?$select=CategoryType,CatogeryName&$filter=CategoryType\x20eq\x20\x27Project\x20Type\x27\x20and\x20Status\x20eq\x20\x27Yes\x27','CloseWaitDialog','/_api/web/Lists/GetByTitle(\x27EmailTemplate\x27)/Items?$select=ID,Body,Subject,EmailType,Title&$filter=Title\x20eq\x20\x27','#masterFooter','SP.Web','text','round','/_api/web/lists/getByTitle(\x27Documents\x27)/roleassignments/addroleassignment(principalid=','attr','\x27\x20and\x20Holiday_start\x20le\x20\x27','ClientID','88769SyUbGA','</Value></Eq><Eq><FieldRef\x20Name=\x27OfficeLocationId\x27\x20/><Value\x20Type=\x27Text\x27>0</Value></Eq></And></Where><OrderBy><FieldRef\x20Name=\x27OfficeName\x27/></OrderBy></Query></View>','site\x20updated','An\x20error\x20occurred\x20in\x20Program\x20method.','Planned\x20End\x20Date\x20can\x20not\x20less\x20than\x20Planned\x20Start\x20Date.','results','blur','.mutliSelect\x20input[type=\x22checkbox\x22]','hide','find','#cancelProjectEdit','MultipleStackeholder','ClientName','indexOf','#ProjectManagerEmployeePicker_TopSpan_ResolvedList','resolve','\x22selected>','POST','{{Department}}','\x27\x20and\x20Holiday_start\x20ge\x20\x27','Consultant_List','#clientTitle','#ProjectStatus','#CreatedOn','ActualStartDate','selected','/DMS/','MERGE','forEach','html','Consultant_Comp','empty','includes','/_api/web/lists/getbytitle(\x27ProjectTeamDetails\x27)/items?$select=ID,TeamMemberId&$filter=ProjectId\x20eq\x20\x27','show','User','ProjectID','executeOrDelayUntilScriptLoaded','Error\x20updating\x20site','length','Employee\x20is\x20not\x20active\x20','PrincipalAccountType','CompanySiteUrl','executeQueryAsync','{{Status}}','.txtActualStartDate'];a407_0x4dfd=function(){return _0x492bf4;};return a407_0x4dfd();}function UniversalinsertProject(_0x565e5a,_0x271e25){var _0x30c316=a407_0xa38737;$[_0x30c316(0x1ad)]({'url':_spPageContextInfo[_0x30c316(0x1b4)]+'/_api/web/lists/GetByTitle(\x27'+_0x565e5a+_0x30c316(0x269),'type':_0x30c316(0x1fb),'contentType':_0x30c316(0x24a),'data':JSON[_0x30c316(0x298)](_0x271e25),'async':![],'headers':{'Accept':_0x30c316(0x24a),'X-RequestDigest':$(_0x30c316(0x2c5))['val']()},'success':function(_0x121190){var _0x1ba5d2=_0x30c316;console[_0x1ba5d2(0x2a3)](_0x1ba5d2(0x291));},'error':function(_0x1a27f2){var _0x909a33=_0x30c316;console['log'](_0x909a33(0x29b));}});}function IsMangerActive(_0x5bf8b){var _0x10fcb2=a407_0xa38737,_0x52e29b=titanForWork[_0x10fcb2(0x285)]('CompanyId'),_0x3fcbe4='';return RestQuery='?$select=*,LogonName/EMail,LogonName/Id,LogonName/FirstName,LogonName/LastName,LogonName/EMail&$expand=LogonName\x20&$filter=\x20Status\x20eq\x20\x27Active\x27\x20and\x20Company/ID\x20eq\x20'+_0x52e29b+'\x20and\x20LogonNameId\x20eq\x20'+_0x5bf8b+'',$[_0x10fcb2(0x250)](CommonFunction[_0x10fcb2(0x297)]('Employees',RestQuery))['done'](function(_0x54e693){var _0x3cd8af=_0x10fcb2;try{_0x54e693['results'][_0x3cd8af(0x211)]>0x0?_0x3fcbe4=_0x54e693[_0x3cd8af(0x1ef)][0x0]['ID']:_0x3fcbe4=![];}catch(_0x5b3f1c){alert(_0x5b3f1c);}}),_0x3fcbe4;}function AddUserToOwnerGroup(_0x33a319){var _0x3cc77f=a407_0xa38737;debugger;var _0x2884cb={'__metadata':{'type':_0x3cc77f(0x2ac)},'LoginName':_0x33a319},_0x5a2ee9=_spPageContextInfo[_0x3cc77f(0x1b4)]+'/_api/web/sitegroups/getbyname(\x27Owners\x27)/users';$[_0x3cc77f(0x1ad)]({'url':_0x5a2ee9,'type':_0x3cc77f(0x1fb),'async':![],'headers':{'accept':_0x3cc77f(0x24a),'X-RequestDigest':$(_0x3cc77f(0x2c5))[_0x3cc77f(0x1d9)](),'content-Type':_0x3cc77f(0x24a)},'data':JSON[_0x3cc77f(0x298)](_0x2884cb),'success':function(_0x34bc61){debugger;},'error':function(_0x54b238){}});}function BreakInheritePermissionDMSLibrary(_0x17ef1d,_0x1fe1fa,_0xf2216){var _0x97ccfa=a407_0xa38737,_0x2d25a6=titanForWork[_0x97ccfa(0x285)]('CompanySiteUrl')+_0x97ccfa(0x204)+projectInternalName,_0x3970db={'Accept':_0x97ccfa(0x24a),'content-Type':'application/json;odata=verbose','X-RequestDigest':jQuery(_0x97ccfa(0x2c5))[_0x97ccfa(0x1d9)]()},_0x4362bf=_0x2d25a6+'/_api/web/lists/getByTitle(\x27Documents\x27)/breakroleinheritance(copyRoleAssignments=false,\x20clearSubscopes=true)';$[_0x97ccfa(0x1ad)]({'url':_0x4362bf,'type':_0x97ccfa(0x1fb),'headers':_0x3970db,'async':![],'dataType':_0x97ccfa(0x28a),'success':function(_0x5b8abe){var _0x35a1a4=_0x97ccfa;console[_0x35a1a4(0x2a3)](_0x35a1a4(0x231)),_0xf2216==_0x35a1a4(0x193)?$[_0x35a1a4(0x250)](AssignPermissiononDMSLibary(_0x17ef1d,_0x1fe1fa))[_0x35a1a4(0x2c8)](function(_0x5d8894){var _0x10e988=_0x35a1a4;console[_0x10e988(0x2a3)](_0x10e988(0x1d0));}):$[_0x35a1a4(0x250)](DeleteUserPermissionOnDMSLibrary(_0x17ef1d))[_0x35a1a4(0x2c8)](function(_0x3965fd){console['log']('Permission\x20has\x20been\x20removed\x20successfully!');});},'error':function(_0x39cdcf){var _0x346865=_0x97ccfa;console[_0x346865(0x2a3)](JSON[_0x346865(0x298)](_0x39cdcf));}});}function AssignPermissiononDMSLibary(_0x1312e5,_0x2a18bf){var _0x48be33=a407_0xa38737,_0xe15879=titanForWork[_0x48be33(0x285)](_0x48be33(0x214))+_0x48be33(0x204)+projectInternalName,_0x11fa14={'Accept':_0x48be33(0x24a),'content-Type':_0x48be33(0x24a),'X-RequestDigest':jQuery(_0x48be33(0x2c5))['val']()},_0x45dd79=_0xe15879+_0x48be33(0x1e6)+_0x1312e5+_0x48be33(0x232)+_0x2a18bf+')';$[_0x48be33(0x1ad)]({'url':_0x45dd79,'type':_0x48be33(0x1fb),'headers':_0x11fa14,'dataType':'json','async':![],'success':function(_0x1dabab){var _0x69fd00=_0x48be33;console[_0x69fd00(0x2a3)](_0x69fd00(0x2c4));},'error':function(_0x544daa){var _0x2c9cf8=_0x48be33;console[_0x2c9cf8(0x2a3)](JSON[_0x2c9cf8(0x298)](_0x544daa));}});}function DeleteUserPermissionOnDMSLibrary(_0x10dae3){var _0x1cc767=a407_0xa38737,_0x1e8e85=titanForWork[_0x1cc767(0x285)]('CompanySiteUrl')+'/DMS/'+projectInternalName,_0x10bf39={'X-RequestDigest':$(_0x1cc767(0x2c5))[_0x1cc767(0x1d9)](),'X-HTTP-Method':_0x1cc767(0x244)},_0x4648e9=_0x1e8e85+_0x1cc767(0x186)+_0x10dae3+')';$[_0x1cc767(0x1ad)]({'url':_0x4648e9,'type':_0x1cc767(0x1fb),'headers':_0x10bf39,'async':![],'success':function(_0x4e6a90){var _0x130d7a=_0x1cc767;console['log'](_0x10dae3+_0x130d7a(0x281));},'error':function(_0x274ff5){var _0x1f51a9=_0x1cc767;console['log'](JSON[_0x1f51a9(0x298)](_0x274ff5));}});}function bindProjectType(){var _0x2f59f3=a407_0xa38737;$(_0x2f59f3(0x242))[_0x2f59f3(0x209)]();var _0x4fe9a0=_spPageContextInfo[_0x2f59f3(0x1b4)]+_0x2f59f3(0x1df);$[_0x2f59f3(0x1ad)]({'url':_0x4fe9a0,'headers':{'Accept':_0x2f59f3(0x24a)},'async':!![],'success':function(_0xd6666){var _0x153e6f=_0x2f59f3;$(_0x153e6f(0x1bc))[_0x153e6f(0x222)](_0x153e6f(0x242));for(var _0x583017=0x0;_0x583017<_0xd6666['d'][_0x153e6f(0x1ef)][_0x153e6f(0x211)];_0x583017++){$(_0x153e6f(0x242))[_0x153e6f(0x1b8)](_0x153e6f(0x288)+_0xd6666['d']['results'][_0x583017]['CatogeryName']+'\x22>'+_0xd6666['d'][_0x153e6f(0x1ef)][_0x583017][_0x153e6f(0x255)]+_0x153e6f(0x194));}},'myError':function(_0x152dfe){}});}function getPeoplePickerEmails(_0x3143ab){var _0x1b94c5=a407_0xa38737,_0x10e99d=[],_0x5b90ea=$('[id^=\x27'+_0x3143ab+'\x27]'),_0x5a9646=SPClientPeoplePicker[_0x1b94c5(0x196)][_0x5b90ea[0x1]['id']],_0x594530=_0x5a9646[_0x1b94c5(0x29c)]();if(_0x594530[_0x1b94c5(0x211)]>0x0){var _0x41233c=new Array();for(var _0x4aa2c6=0x0;_0x4aa2c6<_0x594530[_0x1b94c5(0x211)];_0x4aa2c6++){var _0x24db19=_0x594530[_0x4aa2c6][_0x1b94c5(0x270)],_0x284880=_0x594530[_0x4aa2c6][_0x1b94c5(0x183)];if(_0x284880=='User'){var _0x366dea=_0x594530[_0x4aa2c6]['Key'][_0x1b94c5(0x22e)]('|')[0x2];_0x366dea[_0x1b94c5(0x20a)]('#')==!![]&&(_0x366dea=_0x366dea[_0x1b94c5(0x22e)]('#')[0x0],_0x366dea=_0x366dea['replace']('_','@')),_0x10e99d[_0x1b94c5(0x22f)](_0x366dea);}}}return _0x10e99d;}function CheckInternalUser(_0x4e9d4e){var _0x12cb8c=a407_0xa38737,_0x3144a2=![];return RestQuery='?$select=Email,LogonName/EMail,Status&$expand=LogonName&$filter=\x20Status\x20eq\x20\x27Active\x27\x20and\x20(LogonName/EMail\x20eq\x20\x27'+_0x4e9d4e+'\x27\x20or\x20Email\x20eq\x20\x27'+_0x4e9d4e+_0x12cb8c(0x1cf),(dfds=$[_0x12cb8c(0x279)](),url=_spPageContextInfo['webAbsoluteUrl']+_0x12cb8c(0x1c5)+RestQuery),$[_0x12cb8c(0x250)](getItems(url,dfds))[_0x12cb8c(0x2c8)](function(_0x1911b4){var _0x202d2c=_0x12cb8c;try{response=[],_0x1911b4[_0x202d2c(0x211)]>0x0&&(_0x3144a2=!![]);}catch(_0x515ec0){alert(_0x515ec0);}}),_0x3144a2;}function BindPrograms(){var _0x2e0bb2=a407_0xa38737,_0x341ace='',_0x597286=_spPageContextInfo[_0x2e0bb2(0x1b4)]+'/_api/web/lists/getbytitle(\x27ProgramList\x27)/items?select=ID,Title&$top=5000&$orderby=Title\x20asc';$[_0x2e0bb2(0x1ad)]({'url':_0x597286,'async':![],'headers':{'Accept':_0x2e0bb2(0x24a)},'success':function(_0x15127c){var _0x3988aa=_0x2e0bb2,_0x1cfb57=_0x15127c['d'][_0x3988aa(0x1ef)];if(_0x1cfb57[_0x3988aa(0x211)]>0x0){$(_0x3988aa(0x1a7))[_0x3988aa(0x209)](),$('#ddlProgramList')['append']($(_0x3988aa(0x17d))['val']('0')[_0x3988aa(0x207)](_0x3988aa(0x24f)));for(i=0x0;i<_0x1cfb57[_0x3988aa(0x211)];i++){$(_0x3988aa(0x1a7))['append'](_0x3988aa(0x288)+_0x1cfb57[i]['ID']+'\x22>'+_0x1cfb57[i][_0x3988aa(0x230)]+'</option>');}}},'error':function(_0x35715b){var _0x259f72=_0x2e0bb2;console[_0x259f72(0x2a3)](_0x259f72(0x1ed)+_0x35715b);}});}var response=response||[];function getItems(_0x3209fa,_0x1b1a62){var _0x471f81=a407_0xa38737;return $['ajax']({'url':_0x3209fa,'type':_0x471f81(0x2b0),'async':![],'headers':{'accept':_0x471f81(0x24a)},'success':function(_0x4dfab1){var _0x20bc87=_0x471f81;response=response['concat'](_0x4dfab1['d']['results']),_0x4dfab1['d'][_0x20bc87(0x192)]?(_0x3209fa=_0x4dfab1['d']['__next'],getItems(_0x3209fa,_0x1b1a62)):_0x1b1a62[_0x20bc87(0x1f9)](response);},'error':function(_0x3d09ad){var _0x34486f=_0x471f81;_0x1b1a62[_0x34486f(0x2a0)](_0x3d09ad),console[_0x34486f(0x2a3)](_0x3d09ad);}}),_0x1b1a62[_0x471f81(0x25d)]();}