function a229_0x17c0(_0x1d8156,_0x3cbe96){var _0x236f11=a229_0x236f();return a229_0x17c0=function(_0x17c073,_0x4c1ea3){_0x17c073=_0x17c073-0x1ef;var _0x44408b=_0x236f11[_0x17c073];return _0x44408b;},a229_0x17c0(_0x1d8156,_0x3cbe96);}var a229_0x50b935=a229_0x17c0;(function(_0x31917e,_0x415f7f){var _0x39dc67=a229_0x17c0,_0x4e9ce5=_0x31917e();while(!![]){try{var _0x510b2a=parseInt(_0x39dc67(0x297))/0x1+-parseInt(_0x39dc67(0x286))/0x2+parseInt(_0x39dc67(0x28a))/0x3+parseInt(_0x39dc67(0x28b))/0x4*(-parseInt(_0x39dc67(0x22d))/0x5)+parseInt(_0x39dc67(0x261))/0x6+parseInt(_0x39dc67(0x22f))/0x7*(-parseInt(_0x39dc67(0x25b))/0x8)+parseInt(_0x39dc67(0x2a8))/0x9;if(_0x510b2a===_0x415f7f)break;else _0x4e9ce5['push'](_0x4e9ce5['shift']());}catch(_0x6a69e7){_0x4e9ce5['push'](_0x4e9ce5['shift']());}}}(a229_0x236f,0x67b23));var currentFileSiteURL='',mydeptSiteUrl='',currentDlgShare='';$(document)[a229_0x50b935(0x258)](function(){var _0x443ee4=a229_0x50b935;getDeptSiteUrl(),$(_0x443ee4(0x298))[_0x443ee4(0x296)](function(){OpenSharePopup();}),$(_0x443ee4(0x2a4))[_0x443ee4(0x296)](function(){var _0x53de94=_0x443ee4,_0x5828bb='Sharing\x20files...',_0x4d3664=_0x53de94(0x23b),_0x9f6c20=0xc8,_0x3347c6=0x190;SP['SOD']['loadMultiple'](['strings.js',_0x53de94(0x226)],function(){var _0x20a299=_0x53de94;currentDlgShare=SP['UI']['ModalDialog'][_0x20a299(0x234)](_0x5828bb,_0x4d3664,_0x9f6c20,_0x3347c6);}),setTimeout(function(){DeptSharemutiplefile();},0x64);}),$(_0x443ee4(0x20e))['change'](function(){var _0x50383c=_0x443ee4;clearPeoplePickerControl(_0x50383c(0x250)),$(_0x50383c(0x217))['show']();if($(this)['val']()==_0x50383c(0x207))$('.orgDropdowndivDeptFolder')['show'](),$('.folderpeoplepickerdivshowhide')['hide'](),$(_0x50383c(0x21a))[_0x50383c(0x1fb)]()==null?getGuestClients(_0x50383c(0x29d)):($(_0x50383c(0x27e))[_0x50383c(0x249)](_0x50383c(0x225),![]),$(_0x50383c(0x29f))[_0x50383c(0x1f4)](_0x50383c(0x259)));else{if($(this)[_0x50383c(0x1fb)]()=='0'||$(this)['val']()==_0x50383c(0x26c))$(_0x50383c(0x208))[_0x50383c(0x293)](),$(_0x50383c(0x217))['hide']();else $(this)[_0x50383c(0x1fb)]()!=_0x50383c(0x233)&&$(this)[_0x50383c(0x1fb)]()!='0'?($('.orgDropdowndivDeptFolder')['hide'](),GetDeptSharingGpUsers($(this)['val'](),_0x50383c(0x209))):$(_0x50383c(0x208))[_0x50383c(0x293)]();}}),$(_0x443ee4(0x21a))[_0x443ee4(0x232)](function(){var _0x5ee62c=_0x443ee4;getOrgEmps($(_0x5ee62c(0x1f7))[_0x5ee62c(0x1f4)]());}),$(_0x443ee4(0x213))[_0x443ee4(0x296)](function(){var _0x5f54dc=_0x443ee4,_0x5e35d7=_0x5f54dc(0x26a),_0xf8ff34=_0x5f54dc(0x23b),_0x1160d2=0xc8,_0x2d9410=0x190;SP['SOD'][_0x5f54dc(0x21d)]([_0x5f54dc(0x27c),'sp.ui.dialog.js'],function(){var _0x1d81c5=_0x5f54dc;currentDlgShare=SP['UI'][_0x1d81c5(0x25c)][_0x1d81c5(0x234)](_0x5e35d7,_0xf8ff34,_0x1160d2,_0x2d9410);}),setTimeout(function(){deptDocFolderSharing();},0x64);}),$(_0x443ee4(0x267))[_0x443ee4(0x296)](function(){var _0x4e960f=_0x443ee4;$('#myDeptFolderSharing')[_0x4e960f(0x240)](_0x4e960f(0x293)),$(_0x4e960f(0x217))[_0x4e960f(0x293)](),$('.orgDropdowndivDeptFolder')['hide'](),$(_0x4e960f(0x2a2))['html'](''),$('.mulinput')[_0x4e960f(0x249)](_0x4e960f(0x225),![]),$(_0x4e960f(0x29f))['text'](_0x4e960f(0x259));});});function CreatDeptDocfromTemplateWordFile(){var _0x590c41=a229_0x50b935;CommonDeptFileCreate(_0x590c41(0x292),0x1);}function CreatDeptDocfromTemplateExcelFile(){var _0x52f99c=a229_0x50b935;CommonDeptFileCreate(_0x52f99c(0x291),0x2);}function a229_0x236f(){var _0x3c7d8e=['_api/Web/Lists/getByTitle(\x27DepartmentalDMS\x27)/Items(',',\x20shared\x20the\x20following\x20document\x20with\x20you.<br/><br/>','prop','userDisplayName','siteId','_api/web/Lists/GetByTitle(\x27DepartmentalDMS\x27)/getItemById(','#shareWithDeptFolderPermission\x20:selected','when','{{doclink}}','customSharingDeptFolderPplPickr','/_api/SP.Sharing.DocumentSharingManager.UpdateDocumentSharingInfo','#chekedSendEmail','Kindly\x20enter\x20sharing\x20users.','close','SiteURL','\x20Successfully\x20removed\x20Permission\x20!','<div><strong>Permission:</strong>\x20','ready','Select','serverUrl','461144xRcoSi','ModalDialog','webAbsoluteUrl','#sharefilename','replace','/Pages/MyDocuments.aspx?WebAppId=1','369672pFYEfx','POST','#chkDeptFolderSendEmail','/DepartmentalDMS','.context-menu','value','#btnDeptCancelShareFolder,\x20#btnCloseDeptShare','SP.Utilities.EmailProperties','whatever','Sharing\x20folder...','{{filename}}','Private','Sharing\x20Dept_Doc\x20Folder\x20','/_api/web/GetFolderByServerRelativeUrl(\x27','done','/DepartmentalDMS/','#sharefiletilte','userId','reject','customShareingPoplePicker','RoleAssignments','\x27\x20and\x20LogonUser/ID\x20eq\x20\x27','.orgDropdowndiv','toUpperCase','results','empty','ServerRelativeUrl','strings.js','pptx','.mulinput','push','application/json;\x20odata=verbose',')/roleassignments/getbyprincipalid(','append','webServerRelativeUrl','#filedocumentname','application/json;odata=verbose','694482wXzYty','ServerRedirectedEmbedUri','File','#lblSelectedCurrentEmail','2014335JmarWv','441352wcvAQE','Name','Please\x20enter\x20sharing\x20users.','UserName','filter','/_api/web/GetFileByServerRelativeUrl(\x27','xlsx','dotx','hide','#lblSelectedFileUrl','MyDepartmentDocumentCurrentFolder','click','67747wcORYl','#deptDocShare','{{Permission}}','#txtSharedDocumetnOnDemandId','#sharedWithPermission','#currentSubFolderMyDepartment','ddlOrgNameDeptFolder','SharedId','.multiBox','/DepartmentalDMS/Forms/template.','This\x20is\x20an\x20auto\x20generated\x20email.\x20Please\x20don\x27t\x20reply.','#deptSharedFolderUsersLists','Department','#Deptmutiplesharefile','Reference','Deferred','origin','7477857bzjwtR','Error\x20while\x20checking\x20out:\x20','#myDeptFolderSharing','</div>','#myModalDocumentSharing','{{details}}','#lblFileName','\x27)/ListItemAllFields/roleassignments/getbyprincipalid(','text','indexOf','<br/><br/>','#ddlOrgNameDeptFolder\x20:selected','ajax','{{sharedby}}','/_api/web/lists/getbytitle(\x27DocumentSharedGroups\x27)/items?$select=ID,SharingLevel,SharedUsers/Title,SharedUsers/UserName,SharedUsers/ID,LogonUser/ID,LogonUser/UserName&$expand=SharedUsers,LogonUser&$filter=LogonUser/ID\x20eq\x20\x27','val','Read','PrincipalId','GetMyDocumentsWithFilesFolder','SP.Data.','\x27)/checkin','#__REQUESTDIGEST','Revoked','--select--','join','file\x20chekin','\x27)/ListItemAllFields/breakroleinheritance(true)','Organization','.orgDropdowndivDeptFolder','Folder','SharedDocument','fail','/DocumentManagementSystem/Forms/template.','attr','#sharingTypeDeptFolderPermissionLvl','#sharedWithPermission\x20:selected','json','_api/web/lists/getByTitle(\x27DepartmentalDMS\x27)/getItemById(','SharedUsers','#btnDeptShareFolder','Type','ItemId','length','.folderpeoplepickerdivshowhide','Folder\x27s\x20permission\x20has\x20been\x20set\x20private.','split','#ddlOrgNameDeptFolder','stringify','Please\x20look\x20at\x20the\x20following\x20File/Folder.','loadMultiple','trigger','location','{{fileype}}','DepartmentalDMS','Please\x20select\x20one\x20or\x20more\x20file','>Click\x20here</a>\x20to\x20open\x20the\x20document.</div>','Kindly\x20select\x20any\x20organization.','checked','sp.ui.dialog.js','error:\x20','permission\x20deleted\x20sucessfully.','#shareWithDeptFolderPermission','null','log','Guest\x20users\x20are\x20not\x20available\x20in\x20selected\x20organization(s).','5GvZehJ','DELETE','91QEJmcv','#shareingTypePermissionLevel','#lblDocTiltle','change','Selective','showWaitScreenWithNoClose','resolve','html','<option></option>','SharePoint.OpenDocuments','Error:\x20',')?$select=ServerRedirectedEmbedUri,File/Name,File/ServerRelativeUrl,Folder/Name,Folder/ServerRelativeUrl,Shared/Title,SharedId&$expand=File,Folder,SharedId','<br\x20/>Please\x20wait!!','SharingLevel','<div><strong>Reference\x20No\x20:</strong>\x20','#lblFolderDeptTiltle','Dear\x20User,<br/><br/>','modal','/_layouts/CreateNewDocument.aspx?id=','siteAbsoluteUrl','#myModalShareHistory','_api/web/getfilebyserverrelativeurl(\x27','#lblDocNumber','Restricted\x20View'];a229_0x236f=function(){return _0x3c7d8e;};return a229_0x236f();}function CreatDeptDocfromTemplatePPTFile(){var _0xd9a3fd=a229_0x50b935;CommonDeptFileCreate(_0xd9a3fd(0x27d),0x3);}function CommonDeptFileCreate(_0x3f770e,_0x1a1ef5){var _0x27c1de=a229_0x50b935,_0x22e654='',_0x5267fa=$(_0x27c1de(0x29c))[_0x27c1de(0x1fb)]();_0x5267fa=_0x5267fa['slice'](0x10,-0x1);if(mydeptSiteUrl=='null')return alert('Department\x20site\x20URL\x20is\x20not\x20found!'),![];_0x5267fa==''?createNewDocumentWithRedirect2(_0x22e654,mydeptSiteUrl+_0x27c1de(0x2a0)+_0x3f770e,mydeptSiteUrl+_0x27c1de(0x264),'SharePoint.OpenDocuments',![],mydeptSiteUrl+'/_layouts/CreateNewDocument.aspx?id='+myCompanyUrl+_0x27c1de(0x20c)+_0x3f770e,!![],_0x1a1ef5):createNewDocumentWithRedirect2(_0x22e654,mydeptSiteUrl+_0x27c1de(0x2a0)+_0x3f770e,mydeptSiteUrl+_0x27c1de(0x270)+_0x5267fa,_0x27c1de(0x238),![],mydeptSiteUrl+_0x27c1de(0x241)+myCompanyUrl+_0x27c1de(0x20c)+_0x3f770e,!![],_0x1a1ef5);}function getDeptSiteUrl(){var _0x22ed61=a229_0x50b935,_0x445bbf='?$select=ID,SiteURL&$top=5000&$filter=ID\x20eq\x20\x27'+Logged_DepartmentId+'\x27\x20';dfds=$['Deferred'](),url=_spPageContextInfo[_0x22ed61(0x25d)]+'/_api/web/lists/getbytitle(\x27Departments\x27)/items/'+_0x445bbf,$[_0x22ed61(0x24e)](getItems(url,dfds))[_0x22ed61(0x26f)](function(_0x5a8549){var _0x9de6e1=_0x22ed61;response=[],_0x5a8549[_0x9de6e1(0x216)]>0x0?mydeptSiteUrl=_0x5a8549[0x0][_0x9de6e1(0x255)]:mydeptSiteUrl=_0x9de6e1(0x22a);});}function OpenSharePopup(){var _0x2ee1a8=a229_0x50b935;$(_0x2ee1a8(0x277))['hide']();if(selectedDepartmentDoc[_0x2ee1a8(0x216)]>0x0)globalsharingDocumentDetails='',globalSharingDocumentDocumentType='',$(_0x2ee1a8(0x252))[_0x2ee1a8(0x20d)](_0x2ee1a8(0x225),!![]),$(_0x2ee1a8(0x29a))[_0x2ee1a8(0x1fb)](''),$(_0x2ee1a8(0x1f2))[_0x2ee1a8(0x236)](''),$(_0x2ee1a8(0x245))[_0x2ee1a8(0x236)](''),$(_0x2ee1a8(0x231))[_0x2ee1a8(0x236)](''),$(_0x2ee1a8(0x29b))[_0x2ee1a8(0x1fb)](_0x2ee1a8(0x203)),$(_0x2ee1a8(0x230))[_0x2ee1a8(0x1fb)]('0'),$(_0x2ee1a8(0x25e))[_0x2ee1a8(0x293)](),$(_0x2ee1a8(0x271))[_0x2ee1a8(0x293)](),$(_0x2ee1a8(0x284))[_0x2ee1a8(0x293)](),sharedUsersIdArrayListItemCollection=[],sharedUsersEmailIDsArrayListItemCollection=[],clearPeoplePickerControl(_0x2ee1a8(0x274)),$(_0x2ee1a8(0x1f0))['modal']('show'),$('.MyDocsShare')[_0x2ee1a8(0x293)](),$('#Deptmutiplesharefile')['show'](),BindMySharingGroups(),$('#shareingTypePermissionLevel')[_0x2ee1a8(0x21e)](_0x2ee1a8(0x232));else return alert(_0x2ee1a8(0x222)),![];}function DeptSharemutiplefile(){var _0x85263d=a229_0x50b935;if(selectedDepartmentDoc['length']>0x0){var _0x21b8da=$(_0x85263d(0x230))['val'](),_0x9d2b00=$(_0x85263d(0x29b))[_0x85263d(0x1fb)]();if(_0x21b8da=='0'||_0x21b8da==null||_0x21b8da=='')return currentDlgShare!=''&&currentDlgShare[_0x85263d(0x254)](),alert('Kindly\x20select\x20sharing\x20type.'),![];else{if(_0x9d2b00==null||_0x9d2b00==''||_0x9d2b00==_0x85263d(0x203))return currentDlgShare!=''&&currentDlgShare[_0x85263d(0x254)](),alert('Kindly\x20select\x20permission\x20type.'),![];}if(_0x21b8da=='Private')$(_0x85263d(0x252))[_0x85263d(0x20d)]('checked',![]);else{if(_0x21b8da=='Organization'){sharedHistoryUser=sharedUsersIdArrayListItemCollection;if($(_0x85263d(0x29f))[_0x85263d(0x1f4)]()[_0x85263d(0x1f5)](_0x85263d(0x259))==0x0)return currentDlgShare!=''&&currentDlgShare['close'](),alert(_0x85263d(0x224)),![];if(sharedUsersIdArrayListItemCollection[_0x85263d(0x216)]==0x0)return currentDlgShare!=''&&currentDlgShare[_0x85263d(0x254)](),alert(_0x85263d(0x22c)),![];}else{sharedHistoryUser=[],sharedUsersIdArrayListItemCollection=[],sharedUsersEmailIDsArrayListItemCollection=[];if(getUserInfoFromPeoplePicker(_0x85263d(0x274))){if(sharedUsersIdArrayListItemCollection!=null){sharedHistoryUser=sharedUsersIdArrayListItemCollection;if(sharedUsersIdArrayListItemCollection[_0x85263d(0x216)]==0x0)return currentDlgShare!=''&&currentDlgShare[_0x85263d(0x254)](),alert(_0x85263d(0x253)),![];}else return currentDlgShare!=''&&currentDlgShare[_0x85263d(0x254)](),alert(_0x85263d(0x253)),![];}else return currentDlgShare!=''&&currentDlgShare[_0x85263d(0x254)](),alert(_0x85263d(0x253)),![];}}for(var _0x4770f5=0x0;_0x4770f5<selectedDepartmentDoc[_0x85263d(0x216)];_0x4770f5++){currentFileSiteURL=window[_0x85263d(0x21f)][_0x85263d(0x2a7)]+selectedDepartmentDocrelativeurl[_0x4770f5][_0x85263d(0x219)]('DepartmentalDMS')[0x0];var _0x20a85c=selectedDepartmentDoc[_0x4770f5],_0x173d20=GetDeptFileServerRelativeUrl(_0x20a85c,_0x85263d(0x288));arrSharedUserIds=[];var _0x3c04d5=-0x1;while(++_0x3c04d5<sharedUsersIdArrayListItemCollection[_0x85263d(0x216)]){arrSharedUserIds[_0x3c04d5]=sharedUsersIdArrayListItemCollection[_0x3c04d5];}sharedUsersIdArrayListItemCollection=sharedUsersIdArrayListItemCollection['concat'](sharefileuser);if(_0x21b8da=='Private')sharedUsersIdArrayListItemCollection=[],$[_0x85263d(0x24e)](BreakInheritePermissionOnItemSharing(myCompanyUrl,_0x173d20,_0x20a85c,_spPageContextInfo[_0x85263d(0x272)],sharedUsersIdArrayListItemCollection))[_0x85263d(0x26f)](function(_0x4f20c4){DeleteSharedLink(_0x20a85c);});else{var _0x180d17=$(_0x85263d(0x230))[_0x85263d(0x1fb)](),_0x407031=$('#sharedWithPermission')['val']();ShareFilesFolder(_0x173d20,_0x85263d(0x288));if(sharedUsersIdArrayListItemCollection[_0x85263d(0x216)]>0x0){var _0x1661ac=$(_0x85263d(0x230))[_0x85263d(0x1fb)]();updateDeptDocPropertiesOnItemSharing(_0x20a85c,_0x173d20,_0x1661ac,sharedUsersIdArrayListItemCollection,currentFileSiteURL,![]),GetDocumentsRevoke(sharedHistoryUser,_0x20a85c),_0x21b8da==_0x85263d(0x207)?AddSharedLinkToListOrg(shredLinkFileName,_0x173d20,arrUserClientWise,_0x20a85c,_0x85263d(0x288),_0x180d17,_0x407031,_0x85263d(0x2a3)):AddSharedLinkToList22(shredLinkFileName,_0x173d20,sharedHistoryUser,_0x20a85c,_0x85263d(0x288),_0x180d17,_0x407031,_0x85263d(0x2a3));}sharedUsersIdArrayListItemCollection=sharedHistoryUser;}sharefileuser=[];}selectedDocumentserverrelativeurl=[],selectedDepartmentDoc=[];if($(_0x85263d(0x252))[_0x85263d(0x249)](_0x85263d(0x225))==!![]){if(arrDepartmntEmail['length']>0x0){var _0x3d2b6d='',_0x201773=$(_0x85263d(0x20f))[_0x85263d(0x1f4)]();_0x201773==_0x85263d(0x203)&&(_0x201773='');_0x3d2b6d=_0x85263d(0x23f)+_spPageContextInfo[_0x85263d(0x24a)]+_0x85263d(0x248);for(i=0x0;i<arrDepartmntEmail['length'];i++){_0x3d2b6d=_0x3d2b6d+'<div><strong>File\x20Name\x20:</strong>'+arrDepartmntEmail[i]['File']+'</div>'+_0x85263d(0x23d)+arrDepartmntEmail[i][_0x85263d(0x2a5)]+'</div>'+'<div><strong>Title:</strong>\x20'+arrDepartmntEmail[i]['Title']+_0x85263d(0x1ef)+'<div><strong>Type:</strong>\x20'+arrDepartmntEmail[i][_0x85263d(0x214)]+'</div>'+_0x85263d(0x257)+_0x201773+_0x85263d(0x1ef)+'<div><a\x20href='+arrDepartmntEmail[i][_0x85263d(0x25a)]+_0x85263d(0x223)+_0x85263d(0x1f6);}_0x3d2b6d+=_0x85263d(0x2a1);}arrDepartmntEmail=[];var _0x48bc54=[];_0x48bc54[_0x85263d(0x27f)]($(_0x85263d(0x289))['html']());var _0x5d7a74=$(_0x85263d(0x230))[_0x85263d(0x1fb)](),_0x51ae45=$('#lblSelectedCurrentEmail')[_0x85263d(0x236)](),_0x5b2cdd;_0x5b2cdd={'properties':{'__metadata':{'type':'SP.Utilities.EmailProperties'},'From':_0x51ae45,'To':{'results':sharedUsersEmailIDsArrayListItemCollection},'CC':{'results':_0x48bc54},'Body':_0x3d2b6d,'Subject':sharedEmailSubject}},SendEmailSharedNotification(_0x5b2cdd);}}else alert(_0x85263d(0x222)),currentDlgShare!=''&&currentDlgShare[_0x85263d(0x254)]();currentDlgShare!=''&&currentDlgShare[_0x85263d(0x254)]();}function GetDeptFileServerRelativeUrl(_0x30ebd6,_0x9ffd2f){var _0x4619be=a229_0x50b935,_0x454341='',_0x28a7d8=currentFileSiteURL+_0x4619be(0x24c)+_0x30ebd6+_0x4619be(0x23a);return $[_0x4619be(0x1f8)]({'url':_0x28a7d8,'headers':{'accept':_0x4619be(0x285),'content-type':_0x4619be(0x285),'X-RequestDigest':$(_0x4619be(0x201))[_0x4619be(0x1fb)]()},'async':![],'success':function(_0x170ea3){var _0x2203cc=_0x4619be;if(_0x9ffd2f==_0x2203cc(0x288)){_0x454341=_0x170ea3['d'][_0x2203cc(0x288)]['ServerRelativeUrl'],shredLinkFileName=_0x170ea3['d'][_0x2203cc(0x288)]['Name'],commonserverRedirectedEmbedUri=_0x170ea3['d'][_0x2203cc(0x287)];if(_0x170ea3['d'][_0x2203cc(0x29e)]!=null)for(var _0x5f5466=0x0;_0x5f5466<_0x170ea3['d'][_0x2203cc(0x29e)]['results'][_0x2203cc(0x216)];_0x5f5466++){var _0x1e596c=_0x170ea3['d'][_0x2203cc(0x29e)][_0x2203cc(0x279)][_0x5f5466];sharefileuser[_0x2203cc(0x27f)](_0x1e596c);}(commonserverRedirectedEmbedUri==null||commonserverRedirectedEmbedUri=='')&&(commonserverRedirectedEmbedUri='');}else _0x454341=_0x170ea3['d'][_0x2203cc(0x209)][_0x2203cc(0x27b)],shredLinkFolderName=_0x170ea3['d']['Folder']['Name'],commonserverRedirectedEmbedUri='';},'eror':function(_0x3af684){var _0x269e6c=_0x4619be;console[_0x269e6c(0x22b)](_0x269e6c(0x227)+JSON[_0x269e6c(0x21b)](_0x3af684)),currentDlgShare!=''&&currentDlgShare['close']();}}),_0x454341;}function updateDeptDocPropertiesOnItemSharing(_0x22345d,_0x3340fb,_0x197218,_0xa9a3dc,_0x135869,_0x67ae4f){var _0xa5cb76=a229_0x50b935,_0x107a8d=$(_0xa5cb76(0x29b))[_0xa5cb76(0x1fb)](),_0x159514=$('#txtPermissionLevelId')[_0xa5cb76(0x1fb)]();$(_0xa5cb76(0x230))[_0xa5cb76(0x1fb)]()==_0xa5cb76(0x26c)&&(_0x159514='',_0x107a8d='');(_0x107a8d=='--select--'||_0x107a8d==null||_0x107a8d=='')&&(_0x159514='',_0x107a8d='');var _0x50fae6=_0xa5cb76(0x221),_0xb2e89b,_0x4bef44=GetItemTypeDeptList(_0x50fae6);_0xb2e89b={'__metadata':{'type':_0x4bef44},'SecurityLevel':_0x197218,'PermissionLevel':_0x107a8d,'PermissionLevelId':_0x159514,'SharedId':{'results':_0xa9a3dc}},checkoutDeptDocument(_0x3340fb)['done'](function(){var _0x5ba8dc=_0xa5cb76;updateItemWithIDItemListDocuments(_0x50fae6,_0xb2e89b,_0x22345d,_0x135869,_0x67ae4f)[_0x5ba8dc(0x26f)](function(){checkInDeptDocument(_0x3340fb)['done'](function(){var _0x1f159d=a229_0x17c0,_0x1e0602=readTargetUrlCookie(_0x1f159d(0x295)+_spPageContextInfo[_0x1f159d(0x24b)]);departmentDoc[_0x1f159d(0x1fe)](_0x1e0602);});});})[_0xa5cb76(0x20b)](function(_0x19841e){var _0x3dbc80=_0xa5cb76;console['log'](_0x3dbc80(0x227)+JSON[_0x3dbc80(0x21b)](_0x19841e)),currentDlgShare!=''&&currentDlgShare['close']();});}function GetItemTypeDeptList(_0x3858d6){var _0x19470a=a229_0x50b935;return _0x19470a(0x1ff)+_0x3858d6['charAt'](0x0)[_0x19470a(0x278)]()+_0x3858d6[_0x19470a(0x219)]('\x20')[_0x19470a(0x204)]('')['slice'](0x1)+'Item';}function checkoutDeptDocument(_0x2e2491){var _0x4af2a1=a229_0x50b935,_0x25fd17=$[_0x4af2a1(0x2a6)]();return $['ajax']({'url':currentFileSiteURL+'_api/web/getfilebyserverrelativeurl(\x27'+_0x2e2491+'\x27)/checkout','method':_0x4af2a1(0x262),'headers':{'accept':_0x4af2a1(0x285),'content-type':_0x4af2a1(0x285),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x4af2a1(0x1fb)]()},'success':function(_0x374cc6){var _0x436e60=_0x4af2a1,_0x383c8c=_0x374cc6;_0x25fd17['resolve'](_0x374cc6['d']),console[_0x436e60(0x22b)]('success:File\x20Checked\x20out\x20');},'error':function(_0x339d9a){var _0xce2496=_0x4af2a1;alert(_0xce2496(0x2a9)+JSON[_0xce2496(0x21b)](_0x339d9a)),currentDlgShare!=''&&currentDlgShare[_0xce2496(0x254)]();}}),_0x25fd17;}function checkInDeptDocument(_0x571fff){var _0xb4fe34=a229_0x50b935,_0x421f1e=currentFileSiteURL+_0xb4fe34(0x244)+_0x571fff+_0xb4fe34(0x200),_0x4a9d6b=$[_0xb4fe34(0x2a6)]();return $[_0xb4fe34(0x1f8)]({'url':_0x421f1e,'method':_0xb4fe34(0x262),'data':JSON['stringify']({'checkInType':0x2,'comment':_0xb4fe34(0x269)}),'headers':{'accept':_0xb4fe34(0x285),'content-type':_0xb4fe34(0x285),'X-RequestDigest':$(_0xb4fe34(0x201))[_0xb4fe34(0x1fb)]()},'success':function(_0x4ca72f){var _0x24c3e7=_0xb4fe34,_0x1daa3a=_0x4ca72f;_0x4a9d6b[_0x24c3e7(0x235)](_0x4ca72f['d']),console[_0x24c3e7(0x22b)](_0x24c3e7(0x205));},'error':function(_0x4d14b1){var _0xe417d2=_0xb4fe34;_0x4a9d6b[_0xe417d2(0x273)](_0x4d14b1),currentDlgShare!=''&&currentDlgShare[_0xe417d2(0x254)]();}}),_0x4a9d6b;}var SelectedFolderPathURL='';function DeptShareFolderProperties(_0x109bdd,_0x22b4db,_0x15d102){var _0x5b8cef=a229_0x50b935;SelectedFolderPathURL=window[_0x5b8cef(0x21f)][_0x5b8cef(0x2a7)]+_0x15d102[_0x5b8cef(0x219)](_0x5b8cef(0x221))[0x0],BindDeptSharingGroups(),commonUsedFolderSharingId=_0x109bdd,$('#chkDeptFolderSendEmail')[_0x5b8cef(0x20d)](_0x5b8cef(0x225),![]),sharedUsersIdArrayListItemCollection=[],sharedUsersEmailIDsArrayListItemCollection=[],clearPeoplePickerControl('customSharingDeptFolderPplPickr'),$(_0x5b8cef(0x20e))[_0x5b8cef(0x1fb)]('0'),$('#shareingTypePermissionLevel')[_0x5b8cef(0x21e)](_0x5b8cef(0x232)),$('#myDeptFolderSharing')[_0x5b8cef(0x240)]('show'),$(_0x5b8cef(0x23e))[_0x5b8cef(0x236)](_0x22b4db);}function BindDeptSharingGroups(){var _0x29a4f7=a229_0x50b935;$(_0x29a4f7(0x265))[_0x29a4f7(0x293)]();var _0x5be3cb=_spPageContextInfo[_0x29a4f7(0x283)]+_0x29a4f7(0x1fa)+_spPageContextInfo['userId']+'\x27';$[_0x29a4f7(0x1f8)]({'url':_0x5be3cb,'headers':{'Accept':_0x29a4f7(0x285)},'async':![],'success':function(_0x20e98a){var _0x2f4081=_0x29a4f7;$(_0x2f4081(0x20e))[_0x2f4081(0x27a)]()[_0x2f4081(0x282)]('<option\x20value=\x220\x22>-Select\x20Sharing-</option>'),$(_0x2f4081(0x20e))[_0x2f4081(0x282)]($(_0x2f4081(0x237))[_0x2f4081(0x20d)](_0x2f4081(0x266),_0x2f4081(0x26c))[_0x2f4081(0x1f4)](_0x2f4081(0x26c))),$('#sharingTypeDeptFolderPermissionLvl')[_0x2f4081(0x282)]($(_0x2f4081(0x237))[_0x2f4081(0x20d)](_0x2f4081(0x266),_0x2f4081(0x233))[_0x2f4081(0x1f4)](_0x2f4081(0x233))),$('#sharingTypeDeptFolderPermissionLvl')[_0x2f4081(0x282)]($(_0x2f4081(0x237))[_0x2f4081(0x20d)](_0x2f4081(0x266),_0x2f4081(0x207))[_0x2f4081(0x1f4)](_0x2f4081(0x207)));for(var _0x59d3ab=0x0;_0x59d3ab<_0x20e98a['d']['results'][_0x2f4081(0x216)];_0x59d3ab++){$(_0x2f4081(0x20e))[_0x2f4081(0x282)]($('<option></option>')[_0x2f4081(0x20d)](_0x2f4081(0x266),_0x20e98a['d'][_0x2f4081(0x279)][_0x59d3ab][_0x2f4081(0x23c)])[_0x2f4081(0x1f4)](_0x20e98a['d'][_0x2f4081(0x279)][_0x59d3ab][_0x2f4081(0x23c)]));}},'eror':function(_0x3d3650){var _0x568ad6=_0x29a4f7;console[_0x568ad6(0x22b)](_0x568ad6(0x227)+JSON[_0x568ad6(0x21b)](_0x3d3650)),currentDlgShare!=''&&currentDlgShare['close']();}});}function GetDeptSharingGpUsers(_0x4c4046,_0x261107){var _0x55fadc=a229_0x50b935;sharedUsersIdArrayListItemCollection=[],sharedUsersEmailIDsArrayListItemCollection=[];var _0x590c5f=_spPageContextInfo[_0x55fadc(0x283)]+'/_api/web/lists/getbytitle(\x27DocumentSharedGroups\x27)/items?$select=ID,SharingLevel,SharedUsers/Title,SharedUsers/UserName,SharedUsers/ID,LogonUser/ID,LogonUser/UserName&$expand=SharedUsers,LogonUser&$filter=SharingLevel\x20eq\x20\x27'+_0x4c4046+_0x55fadc(0x276)+_spPageContextInfo[_0x55fadc(0x272)]+'\x27';$[_0x55fadc(0x1f8)]({'url':_0x590c5f,'headers':{'Accept':_0x55fadc(0x285)},'async':![],'success':function(_0x21f9ad){var _0x4bf8c4=_0x55fadc,_0x397706='';for(var _0x3d637f=0x0;_0x3d637f<_0x21f9ad['d'][_0x4bf8c4(0x279)][_0x4bf8c4(0x216)];_0x3d637f++){for(var _0x10f965=0x0;_0x10f965<_0x21f9ad['d'][_0x4bf8c4(0x279)][_0x3d637f]['SharedUsers']['results']['length'];_0x10f965++){sharedUsersIdArrayListItemCollection['indexOf'](_0x21f9ad['d'][_0x4bf8c4(0x279)][_0x3d637f]['SharedUsers'][_0x4bf8c4(0x279)][_0x10f965]['ID'])==-0x1&&(sharedUsersIdArrayListItemCollection[_0x4bf8c4(0x27f)](_0x21f9ad['d'][_0x4bf8c4(0x279)][_0x3d637f][_0x4bf8c4(0x212)][_0x4bf8c4(0x279)][_0x10f965]['ID']),SetAndResolvePeoplePicker('customSharingDeptFolderPplPickr',_0x21f9ad['d'][_0x4bf8c4(0x279)][_0x3d637f][_0x4bf8c4(0x212)][_0x4bf8c4(0x279)][_0x10f965][_0x4bf8c4(0x28e)],![]));}}},'eror':function(_0x1bf89d){var _0x1795ca=_0x55fadc;console[_0x1795ca(0x22b)]('Error:\x20'+JSON['stringify'](_0x1bf89d)),currentDlgShare!=''&&currentDlgShare[_0x1795ca(0x254)]();}});}function deptDocFolderSharing(){var _0x546305=a229_0x50b935,_0x41b4c7=$(_0x546305(0x20e))[_0x546305(0x1fb)](),_0x386f40=$(_0x546305(0x229))['val']();if(_0x41b4c7=='0'||_0x41b4c7==null||_0x41b4c7=='')return currentDlgShare!=''&&currentDlgShare['close'](),alert('Please\x20select\x20sharing\x20type.'),![];else{if(_0x386f40==null||_0x386f40==''||_0x386f40==_0x546305(0x203))return currentDlgShare!=''&&currentDlgShare[_0x546305(0x254)](),alert('Kindly\x20select\x20permission\x20type.'),![];else{if(_0x41b4c7==_0x546305(0x207)){sharedHistoryUser=sharedUsersIdArrayListItemCollection;if($('#ddlOrgNameDeptFolder')[_0x546305(0x1fb)]()=='0')return currentDlgShare!=''&&currentDlgShare[_0x546305(0x254)](),alert(_0x546305(0x224)),![];if(sharedUsersIdArrayListItemCollection[_0x546305(0x216)]==0x0)return currentDlgShare!=''&&currentDlgShare['close'](),alert('Guest\x20users\x20are\x20not\x20available\x20in\x20selected\x20organization(s).'),![];}}}if(_0x41b4c7==_0x546305(0x26c))$('#chkDeptFolderSendEmail')[_0x546305(0x20d)](_0x546305(0x225),![]);else{if(_0x41b4c7!=_0x546305(0x207)){sharedUsersIdArrayListItemCollection=[],sharedUsersEmailIDsArrayListItemCollection=[];if(getUserInfoFromPeoplePicker('customSharingDeptFolderPplPickr')){if(sharedUsersIdArrayListItemCollection!=null){if(sharedUsersIdArrayListItemCollection['length']==0x0)return currentDlgShare!=''&&currentDlgShare[_0x546305(0x254)](),alert(_0x546305(0x28d)),![];}else return currentDlgShare!=''&&currentDlgShare[_0x546305(0x254)](),alert('Please\x20enter\x20sharing\x20users.'),![];}else return currentDlgShare!=''&&currentDlgShare[_0x546305(0x254)](),alert(_0x546305(0x28d)),![];}}var _0x383b4f=GetDeptFileServerUrlById(commonUsedFolderSharingId,_0x546305(0x209));_0x41b4c7==_0x546305(0x26c)?(updateFolderProperties(commonUsedFolderSharingId,mydeptSiteUrl,![],_0x546305(0x221),'Private'),$[_0x546305(0x24e)](GetAllDeptFolderUsrsSharedPrincipleId(commonUsedFolderSharingId))[_0x546305(0x26f)](function(_0x53d9e3){var _0x1fff19=_0x546305;DeleteSharedLink(commonUsedFolderSharingId);var _0xfae430=readTargetUrlCookie(_0x1fff19(0x295)+_spPageContextInfo[_0x1fff19(0x24b)]);departmentDoc[_0x1fff19(0x1fe)](_0xfae430),alert(_0x1fff19(0x218)),$(_0x1fff19(0x2aa))[_0x1fff19(0x240)](_0x1fff19(0x293)),currentDlgShare!=''&&currentDlgShare[_0x1fff19(0x254)]();})):(updateFolderProperties(commonUsedFolderSharingId,mydeptSiteUrl,![],_0x546305(0x221),_0x41b4c7),ShareDeptFilesFolder(_0x383b4f,'Folder',_0x41b4c7));}function GetDeptFileServerUrlById(_0x105282,_0x2fe9c8){var _0x4d60d2=a229_0x50b935,_0x5d6524='',_0x4b2d87=SelectedFolderPathURL+_0x4d60d2(0x24c)+_0x105282+_0x4d60d2(0x23a);return $[_0x4d60d2(0x1f8)]({'url':_0x4b2d87,'headers':{'accept':_0x4d60d2(0x285),'content-type':_0x4d60d2(0x285),'X-RequestDigest':$('#__REQUESTDIGEST')['val']()},'async':![],'success':function(_0x25e283){var _0x40d141=_0x4d60d2;if(_0x2fe9c8==_0x40d141(0x288)){_0x5d6524=_0x25e283['d']['File']['ServerRelativeUrl'],shredLinkFileName=_0x25e283['d'][_0x40d141(0x288)][_0x40d141(0x28c)],commonserverRedirectedEmbedUri=_0x25e283['d'][_0x40d141(0x287)];if(_0x25e283['d'][_0x40d141(0x29e)]!=null)for(var _0x45d061=0x0;_0x45d061<_0x25e283['d'][_0x40d141(0x29e)][_0x40d141(0x279)][_0x40d141(0x216)];_0x45d061++){var _0x3da25c=_0x25e283['d']['SharedId'][_0x40d141(0x279)][_0x45d061];sharefileuser[_0x40d141(0x27f)](_0x3da25c);}(commonserverRedirectedEmbedUri==null||commonserverRedirectedEmbedUri=='')&&(commonserverRedirectedEmbedUri='');}else _0x5d6524=_0x25e283['d'][_0x40d141(0x209)][_0x40d141(0x27b)],shredLinkFolderName=_0x25e283['d'][_0x40d141(0x209)][_0x40d141(0x28c)],commonserverRedirectedEmbedUri='';},'eror':function(_0x3d7cfa){var _0x21dbc4=_0x4d60d2;console[_0x21dbc4(0x22b)](_0x21dbc4(0x239)+JSON[_0x21dbc4(0x21b)](_0x3d7cfa));}}),_0x5d6524;}function GetAllDeptFolderUsrsSharedPrincipleId(_0x20ca5d){var _0x3da043=a229_0x50b935,_0x2ff9c3=$[_0x3da043(0x2a6)](),_0xc8338c=new Date(),_0x1c8abb=Date['parse'](_0xc8338c);return $['ajax']({'url':SelectedFolderPathURL+_0x3da043(0x247)+_0x20ca5d+')?$expand=RoleAssignments/Member/Users'+_0x1c8abb,'method':'GET','async':![],'headers':{'Accept':_0x3da043(0x280)},'success':function(_0x455644){var _0x46c833=_0x3da043;_0x2ff9c3[_0x46c833(0x235)](_0x455644['d']['results']);for(var _0xa81165=0x0;_0xa81165<_0x455644['d'][_0x46c833(0x275)][_0x46c833(0x279)][_0x46c833(0x216)];_0xa81165++){if(_0x455644['d'][_0x46c833(0x275)][_0x46c833(0x279)][_0xa81165][_0x46c833(0x1fd)]!=_spPageContextInfo[_0x46c833(0x272)]){var _0x4f09e8=_0x455644['d']['RoleAssignments'][_0x46c833(0x279)][_0xa81165][_0x46c833(0x1fd)];DeleteDeptFolderPrinciple(_0x20ca5d,_0x4f09e8);}}},'error':function(_0x5dc178){_0x2ff9c3['reject'](_0x5dc178),waitingDialog['hide']();}}),_0x2ff9c3['promise']();}function DeleteDeptFolderPrinciple(_0x41bf28,_0x23d444){var _0x13af26=a229_0x50b935,_0x12d0aa=$['Deferred'](),_0x585907={'X-RequestDigest':$(_0x13af26(0x201))['val'](),'X-HTTP-Method':_0x13af26(0x22e)},_0x55c139=SelectedFolderPathURL+_0x13af26(0x211)+_0x41bf28+_0x13af26(0x281)+_0x23d444+')';return $[_0x13af26(0x1f8)]({'url':_0x55c139,'type':_0x13af26(0x262),'headers':_0x585907,'async':![],'dataType':_0x13af26(0x210),'success':function(_0x42725b){var _0x2b2828=_0x13af26;_0x12d0aa[_0x2b2828(0x235)](_0x42725b['d'][_0x2b2828(0x279)]),console['log'](_0x23d444+_0x2b2828(0x256));},'error':function(_0x403219){var _0x23c734=_0x13af26;_0x12d0aa['reject'](_0x403219),console[_0x23c734(0x22b)](JSON[_0x23c734(0x21b)](_0x403219));}}),_0x12d0aa['promise']();}function ShareDeptFilesFolder(_0x105e0c,_0x1ebdc6,_0x49cac8){var _0xac7319=a229_0x50b935,_0x24df3e=[],_0x4b3af1=0x1;if($(_0xac7319(0x229))[_0xac7319(0x1fb)]()==_0xac7319(0x1fc))_0x4b3af1=0x1;else $(_0xac7319(0x229))[_0xac7319(0x1fb)]()==_0xac7319(0x246)?_0x4b3af1=0x7:_0x4b3af1=0x2;var _0x174e2d=createJSONMetadata(sharedUsersEmailIDsArrayListItemCollection,_0x4b3af1),_0x59d345=_spPageContextInfo[_0xac7319(0x25d)]+_0xac7319(0x251);$['ajax']({'url':_0x59d345,'method':_0xac7319(0x262),'async':![],'data':JSON[_0xac7319(0x21b)]({'resourceAddress':document[_0xac7319(0x21f)][_0xac7319(0x2a7)]+_0x105e0c,'userRoleAssignments':_0x174e2d,'validateExistingPermissions':![],'additiveMode':![],'sendServerManagedNotification':![],'customMessage':_0xac7319(0x21c),'includeAnonymousLinksInNotification':![]}),'headers':{'accept':_0xac7319(0x285),'content-type':'application/json;odata=verbose','X-RequestDigest':$(_0xac7319(0x201))['val']()},'success':function(_0x2dc16a){var _0x16674f=_0xac7319,_0x3ca4d9=$('#sharingTypeDeptFolderPermissionLvl')[_0x16674f(0x1fb)](),_0x46d59d='';if(_0x1ebdc6==_0x16674f(0x209)){GetDocumentsRevoke(sharedUsersIdArrayListItemCollection,commonUsedFolderSharingId);_0x49cac8=='Organization'&&_0x1ebdc6==_0x16674f(0x209)?AddSharedLinkToListOrg(shredLinkFolderName,_0x105e0c,arrUserClientWise,commonUsedFolderSharingId,'Folder',_0x3ca4d9,$('#shareWithDeptFolderPermission')['val'](),_0x16674f(0x2a3)):AddSharedLinkToList22(shredLinkFolderName,_0x105e0c,sharedUsersIdArrayListItemCollection,commonUsedFolderSharingId,_0x16674f(0x209),_0x3ca4d9,$(_0x16674f(0x229))[_0x16674f(0x1fb)](),_0x16674f(0x2a3));$(_0x16674f(0x263))[_0x16674f(0x249)]('checked')==!![]&&EmailDeptSharedProperties(sharedUsersEmailIDsArrayListItemCollection,_0x1ebdc6);var _0x1decf8=readTargetUrlCookie(_0x16674f(0x295)+_spPageContextInfo[_0x16674f(0x24b)]);departmentDoc[_0x16674f(0x1fe)](_0x1decf8);}$('#myDeptFolderSharing')['modal'](_0x16674f(0x293)),currentDlgShare!=''&&currentDlgShare[_0x16674f(0x254)](),$('.mulinput')[_0x16674f(0x249)](_0x16674f(0x225),![]),$(_0x16674f(0x29f))[_0x16674f(0x1f4)](_0x16674f(0x259)),$(_0x16674f(0x208))[_0x16674f(0x293)]();},'error':function(_0x139f99){var _0x51bcc3=_0xac7319;alert(_0x51bcc3(0x26d)+JSON[_0x51bcc3(0x21b)](_0x139f99)),currentDlgShare!=''&&currentDlgShare[_0x51bcc3(0x254)]();}});}function EmailDeptSharedProperties(_0x2fe7ce,_0x5bc23a){var _0x3bec57=a229_0x50b935,_0x31ab1b=[];_0x31ab1b[_0x3bec57(0x27f)]($('#lblSelectedCurrentEmail')[_0x3bec57(0x236)]());var _0xd144f=$(_0x3bec57(0x20e))[_0x3bec57(0x1fb)](),_0x35f437='',_0x144171=emailBodyContent;if(_0x5bc23a==_0x3bec57(0x209)){var _0x1d13a5=$(_0x3bec57(0x24d))[_0x3bec57(0x1f4)]();_0x1d13a5==_0x3bec57(0x203)&&(_0x1d13a5=''),_0x144171=_0x144171[_0x3bec57(0x25f)](_0x3bec57(0x26b),$('#lblFolderDeptTiltle')[_0x3bec57(0x1f4)]()),_0x144171=_0x144171['replace'](_0x3bec57(0x220),_0x3bec57(0x209)),_0x144171=_0x144171[_0x3bec57(0x25f)]('{{details}}',''),_0x144171=_0x144171[_0x3bec57(0x25f)]('{{doclink}}',_spPageContextInfo[_0x3bec57(0x242)]+_0x3bec57(0x260)),_0x144171=_0x144171[_0x3bec57(0x25f)](_0x3bec57(0x299),_0x1d13a5);}else{globalSharingDocumentDocumentType==null&&(globalSharingDocumentDocumentType='');globalsharingDocumentDetails==null&&(globalsharingDocumentDetails='');var _0x1d13a5=$('#sharedWithPermission\x20\x20:selected')[_0x3bec57(0x1f4)]();_0x1d13a5==_0x3bec57(0x203)&&(_0x1d13a5=''),_0x144171=_0x144171[_0x3bec57(0x25f)]('{{filename}}',$('#lblFileName')[_0x3bec57(0x236)]()),_0x144171=_0x144171[_0x3bec57(0x25f)](_0x3bec57(0x220),globalSharingDocumentDocumentType),_0x144171=_0x144171[_0x3bec57(0x25f)](_0x3bec57(0x1f1),globalsharingDocumentDetails),_0x144171=_0x144171[_0x3bec57(0x25f)](_0x3bec57(0x24f),encodeURI(document[_0x3bec57(0x21f)][_0x3bec57(0x2a7)]+'/'+$(_0x3bec57(0x294))[_0x3bec57(0x1f4)]())),_0x144171=_0x144171[_0x3bec57(0x25f)](_0x3bec57(0x299),_0x1d13a5);}_0x144171=_0x144171[_0x3bec57(0x25f)](_0x3bec57(0x1f9),_spPageContextInfo[_0x3bec57(0x24a)]),_0x35f437=_0x144171;var _0x22fbe6=$('#lblSelectedCurrentEmail')[_0x3bec57(0x236)](),_0x32440b;_0x32440b={'properties':{'__metadata':{'type':_0x3bec57(0x268)},'From':_0x22fbe6,'To':{'results':_0x2fe7ce},'CC':{'results':_0x31ab1b},'Body':_0x35f437,'Subject':sharedEmailSubject}},SendEmailSharedNotification(_0x32440b);}function RevokeDepartmntPermission(_0xd8b822,_0x48e3b5,_0x6883b8,_0x307600){var _0x325485=a229_0x50b935,_0x365f32={'Accept':_0x325485(0x285),'content-Type':'application/json;odata=verbose','X-RequestDigest':jQuery('#__REQUESTDIGEST')[_0x325485(0x1fb)]()},_0x398b7d=mydeptSiteUrl+'/_api/web/GetFileByServerRelativeUrl(\x27'+_0x48e3b5+_0x325485(0x206);if(_0x307600!='')$[_0x325485(0x1f8)]({'url':_0x398b7d,'type':'POST','headers':_0x365f32,'dataType':_0x325485(0x210),'success':function(_0x2e35ca){var _0x1f6be8=_0x325485;DeleatePermissionDeptDocs(_0x6883b8,_0x48e3b5,_0xd8b822,_0x307600,_0x1f6be8(0x233),0x0,0x0);},'error':function(_0x49b25d){var _0x48c631=_0x325485;console['log'](JSON[_0x48c631(0x21b)](_0x49b25d));}});else{_0x6883b8=decodeURI(_0x6883b8);var _0x358280=arrSharedOrgUsers[_0x325485(0x28f)](function(_0x247cfe){return _0x6883b8==_0x247cfe['Organization'];});$[_0x325485(0x1f8)]({'url':_0x398b7d,'type':_0x325485(0x262),'headers':_0x365f32,'dataType':_0x325485(0x210),'success':function(_0x13bf62){var _0x4b5baf=_0x325485;for(k=0x0;k<_0x358280[_0x4b5baf(0x216)];k++){DeleatePermissionDeptDocs(_0x358280[k]['userId'],_0x48e3b5,_0xd8b822,_0x358280[k][_0x4b5baf(0x215)],'Organization',k,_0x358280['length']);}},'error':function(_0x2eb2ee){var _0x1cdc4d=_0x325485;console[_0x1cdc4d(0x22b)](JSON[_0x1cdc4d(0x21b)](_0x2eb2ee));}});}}function DeleatePermissionDeptDocs(_0x3f0b40,_0x2bac8e,_0x56b0dd,_0x44f99a,_0x23095f,_0x41fe22,_0x4a3e1f){var _0x3e7250=a229_0x50b935,_0x5c5708={'X-RequestDigest':$(_0x3e7250(0x201))[_0x3e7250(0x1fb)](),'X-HTTP-Method':_0x3e7250(0x22e)},_0x187363=mydeptSiteUrl+_0x3e7250(0x290)+_0x2bac8e+_0x3e7250(0x1f3)+_0x3f0b40+')';$[_0x3e7250(0x1f8)]({'url':_0x187363,'type':_0x3e7250(0x262),'headers':_0x5c5708,'async':![],'success':function(_0x2dc086){var _0x43f9a2=_0x3e7250,_0x9d93af='SharedDocument',_0x47627b,_0x2108ea=GetItemTypeForListNameDetailsGroups(_0x9d93af);_0x47627b={'__metadata':{'type':_0x2108ea},'PermissionStatus':_0x43f9a2(0x202)},$['when'](updateItemWithIDItemListDocuments(_0x9d93af,_0x47627b,_0x44f99a,myCompanyUrl))['done'](function(_0x948c97){var _0x5b7264=_0x43f9a2;_0x23095f==_0x5b7264(0x207)?_0x41fe22+0x1==_0x4a3e1f&&alert('permission\x20deleted\x20sucessfully.'):alert(_0x5b7264(0x228)),$(_0x5b7264(0x243))[_0x5b7264(0x240)](_0x5b7264(0x293));}),console[_0x43f9a2(0x22b)](_0x3f0b40+_0x43f9a2(0x256));},'error':function(_0x14e0d1){var _0x21f946=_0x3e7250;console[_0x21f946(0x22b)](JSON[_0x21f946(0x21b)](_0x14e0d1));}});}function BreakInheritePermissionFolderSharing(_0x266014,_0x58a9e2,_0x40db20,_0x2a540a){var _0x139bc2=a229_0x50b935,_0x32d659={'Accept':'application/json;odata=verbose','content-Type':_0x139bc2(0x285),'X-RequestDigest':jQuery(_0x139bc2(0x201))['val']()},_0x5658ec=myCompanyUrl+_0x139bc2(0x26e)+_0x58a9e2+_0x139bc2(0x206);if(_0x2a540a!='')$[_0x139bc2(0x1f8)]({'url':_0x5658ec,'type':'POST','headers':_0x32d659,'dataType':_0x139bc2(0x210),'success':function(_0x42eae4){DeleateUserPermissionFolder(_0x40db20,_0x58a9e2,_0x266014,_0x2a540a,'Selective',0x0,0x0);},'error':function(_0x2706f3){var _0x6472b9=_0x139bc2;console[_0x6472b9(0x22b)](JSON[_0x6472b9(0x21b)](_0x2706f3));}});else{_0x40db20=decodeURI(_0x40db20);var _0x74d3f5=arrSharedOrgUsers[_0x139bc2(0x28f)](function(_0x955276){var _0x488641=_0x139bc2;return _0x40db20==_0x955276[_0x488641(0x207)];});$[_0x139bc2(0x1f8)]({'url':_0x5658ec,'type':_0x139bc2(0x262),'headers':_0x32d659,'dataType':_0x139bc2(0x210),'success':function(_0xb31f97){var _0x1cf5db=_0x139bc2;for(k=0x0;k<_0x74d3f5[_0x1cf5db(0x216)];k++){DeleateUserPermissionFolder(_0x74d3f5[k][_0x1cf5db(0x272)],_0x58a9e2,_0x266014,_0x74d3f5[k]['ItemId'],_0x1cf5db(0x207),k,_0x74d3f5['length']);}},'error':function(_0x108a91){var _0x14104a=_0x139bc2;console[_0x14104a(0x22b)](JSON[_0x14104a(0x21b)](_0x108a91));}});}}function BreakPermissionDeptDocFolder(_0x5d2871,_0x5ce565,_0x3c05fb,_0x70e6df){var _0xe481f8=a229_0x50b935,_0x5989fb={'Accept':_0xe481f8(0x285),'content-Type':_0xe481f8(0x285),'X-RequestDigest':jQuery(_0xe481f8(0x201))[_0xe481f8(0x1fb)]()},_0x353be2=mydeptSiteUrl+_0xe481f8(0x26e)+_0x5ce565+'\x27)/ListItemAllFields/breakroleinheritance(true)';if(_0x70e6df!='')$[_0xe481f8(0x1f8)]({'url':_0x353be2,'type':_0xe481f8(0x262),'headers':_0x5989fb,'dataType':_0xe481f8(0x210),'success':function(_0x510a2c){DeleteDeptPermissionFolder(_0x3c05fb,_0x5ce565,_0x5d2871,_0x70e6df,'Selective',0x0,0x0);},'error':function(_0x1a7005){var _0x11bc2c=_0xe481f8;console[_0x11bc2c(0x22b)](JSON[_0x11bc2c(0x21b)](_0x1a7005));}});else{_0x3c05fb=decodeURI(_0x3c05fb);var _0x265e5e=arrSharedOrgUsers[_0xe481f8(0x28f)](function(_0x4cecfb){var _0x5a1aef=_0xe481f8;return _0x3c05fb==_0x4cecfb[_0x5a1aef(0x207)];});$[_0xe481f8(0x1f8)]({'url':_0x353be2,'type':_0xe481f8(0x262),'headers':_0x5989fb,'dataType':_0xe481f8(0x210),'success':function(_0x43943b){var _0xec123f=_0xe481f8;for(k=0x0;k<_0x265e5e['length'];k++){DeleteDeptPermissionFolder(_0x265e5e[k]['userId'],_0x5ce565,_0x5d2871,_0x265e5e[k]['ItemId'],_0xec123f(0x207),k,_0x265e5e[_0xec123f(0x216)]);}},'error':function(_0x54ce48){var _0x35c5c7=_0xe481f8;console[_0x35c5c7(0x22b)](JSON[_0x35c5c7(0x21b)](_0x54ce48));}});}}function DeleteDeptPermissionFolder(_0xe9a4f2,_0x2caa20,_0x286802,_0x11f437,_0x354b39,_0x4e049e,_0x27e865){var _0x21c0d2=a229_0x50b935,_0x3e6662={'X-RequestDigest':$('#__REQUESTDIGEST')['val'](),'X-HTTP-Method':_0x21c0d2(0x22e)},_0x3b8485=mydeptSiteUrl+_0x21c0d2(0x26e)+_0x2caa20+_0x21c0d2(0x1f3)+_0xe9a4f2+')';$[_0x21c0d2(0x1f8)]({'url':_0x3b8485,'type':_0x21c0d2(0x262),'headers':_0x3e6662,'async':![],'success':function(_0x4ff209){var _0x184f68=_0x21c0d2,_0x5034d0=_0x184f68(0x20a),_0xea2b8c,_0x1fa0a3=GetItemTypeForListNameDetailsGroups(_0x5034d0);_0xea2b8c={'__metadata':{'type':_0x1fa0a3},'PermissionStatus':_0x184f68(0x202)},$[_0x184f68(0x24e)](updateItemWithIDItemListDocuments(_0x5034d0,_0xea2b8c,_0x11f437,myCompanyUrl))[_0x184f68(0x26f)](function(_0x13ca8c){var _0x32ded5=_0x184f68;_0x354b39=='Organization'?_0x4e049e+0x1==_0x27e865&&alert('permission\x20deleted\x20sucessfully.'):alert(_0x32ded5(0x228)),$(_0x32ded5(0x243))[_0x32ded5(0x240)]('hide');}),console[_0x184f68(0x22b)](_0xe9a4f2+_0x184f68(0x256));},'error':function(_0x38ea47){var _0x78f695=_0x21c0d2;console[_0x78f695(0x22b)](JSON[_0x78f695(0x21b)](_0x38ea47));}});}