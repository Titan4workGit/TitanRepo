function a5_0x3c2e(_0x2e9980,_0xd93db9){var _0x5c8c8f=a5_0x5c8c();return a5_0x3c2e=function(_0x3c2e7b,_0x1204b6){_0x3c2e7b=_0x3c2e7b-0xbe;var _0x31f937=_0x5c8c8f[_0x3c2e7b];return _0x31f937;},a5_0x3c2e(_0x2e9980,_0xd93db9);}var a5_0x3468ec=a5_0x3c2e;(function(_0x3b495c,_0x2060d6){var _0x5385bf=a5_0x3c2e,_0x161f1b=_0x3b495c();while(!![]){try{var _0x49529c=-parseInt(_0x5385bf(0xff))/0x1+-parseInt(_0x5385bf(0x13a))/0x2*(-parseInt(_0x5385bf(0x12d))/0x3)+-parseInt(_0x5385bf(0x137))/0x4+-parseInt(_0x5385bf(0x151))/0x5*(-parseInt(_0x5385bf(0x17c))/0x6)+parseInt(_0x5385bf(0x16e))/0x7+parseInt(_0x5385bf(0x10a))/0x8+-parseInt(_0x5385bf(0x131))/0x9;if(_0x49529c===_0x2060d6)break;else _0x161f1b['push'](_0x161f1b['shift']());}catch(_0x36a2d6){_0x161f1b['push'](_0x161f1b['shift']());}}}(a5_0x5c8c,0x8093f));var currentFileSiteURL='',mydeptSiteUrl='',currentDlgShare='';$(document)[a5_0x3468ec(0x104)](function(){var _0x11810a=a5_0x3468ec;getDeptSiteUrl(),$(_0x11810a(0x15a))[_0x11810a(0x12e)](function(){OpenSharePopup();}),$(_0x11810a(0xf4))['click'](function(){var _0x2ee1af=_0x11810a,_0x49236b=_0x2ee1af(0x10d),_0x58e2eb=_0x2ee1af(0x10b),_0x5361b5=0xc8,_0x57663c=0x190;SP[_0x2ee1af(0x145)]['loadMultiple']([_0x2ee1af(0x10f),_0x2ee1af(0xef)],function(){var _0x2bc9d9=_0x2ee1af;currentDlgShare=SP['UI'][_0x2bc9d9(0xd3)][_0x2bc9d9(0x113)](_0x49236b,_0x58e2eb,_0x5361b5,_0x57663c);}),setTimeout(function(){DeptSharemutiplefile();},0x64);}),$('#sharingTypeDeptFolderPermissionLvl')[_0x11810a(0xd5)](function(){var _0x270294=_0x11810a;clearPeoplePickerControl(_0x270294(0x150)),$(_0x270294(0x147))[_0x270294(0xf8)]();if($(this)[_0x270294(0x11d)]()==_0x270294(0x15e))$(_0x270294(0x14e))['show'](),$(_0x270294(0x147))[_0x270294(0x120)](),$(_0x270294(0xd4))[_0x270294(0x11d)]()==null?getGuestClients(_0x270294(0xc9)):($(_0x270294(0xe6))['prop'](_0x270294(0x116),![]),$(_0x270294(0x134))[_0x270294(0x12f)](_0x270294(0xed)));else{if($(this)[_0x270294(0x11d)]()=='0'||$(this)[_0x270294(0x11d)]()==_0x270294(0x15b))$(_0x270294(0x14e))[_0x270294(0x120)](),$(_0x270294(0x147))[_0x270294(0x120)]();else $(this)[_0x270294(0x11d)]()!=_0x270294(0x135)&&$(this)[_0x270294(0x11d)]()!='0'?($(_0x270294(0x14e))[_0x270294(0x120)](),GetDeptSharingGpUsers($(this)[_0x270294(0x11d)](),_0x270294(0xe7))):$('.orgDropdowndivDeptFolder')[_0x270294(0x120)]();}}),$(_0x11810a(0xd4))[_0x11810a(0xd5)](function(){var _0x4242be=_0x11810a;getOrgEmps($(_0x4242be(0x16b))[_0x4242be(0x12f)]());}),$('#btnDeptShareFolder')[_0x11810a(0x12e)](function(){var _0x2318a6=_0x11810a,_0x193fd7=_0x2318a6(0x146),_0x25c162=_0x2318a6(0x10b),_0x1a32fb=0xc8,_0xca8db6=0x190;SP['SOD'][_0x2318a6(0x16d)]([_0x2318a6(0x10f),_0x2318a6(0xef)],function(){var _0x3957a9=_0x2318a6;currentDlgShare=SP['UI']['ModalDialog'][_0x3957a9(0x113)](_0x193fd7,_0x25c162,_0x1a32fb,_0xca8db6);}),setTimeout(function(){deptDocFolderSharing();},0x64);}),$('#btnDeptCancelShareFolder,\x20#btnCloseDeptShare')[_0x11810a(0x12e)](function(){var _0x5487af=_0x11810a;$('#myDeptFolderSharing')[_0x5487af(0xfd)]('hide'),$(_0x5487af(0x147))[_0x5487af(0x120)](),$('.orgDropdowndivDeptFolder')[_0x5487af(0x120)](),$(_0x5487af(0x138))[_0x5487af(0x168)](''),$(_0x5487af(0xe6))['prop']('checked',![]),$(_0x5487af(0x134))[_0x5487af(0x12f)](_0x5487af(0xed));});});function CreatDeptDocfromTemplateWordFile(){CommonDeptFileCreate('dotx',0x1);}function CreatDeptDocfromTemplateExcelFile(){var _0x558979=a5_0x3468ec;CommonDeptFileCreate(_0x558979(0xf1),0x2);}function CreatDeptDocfromTemplatePPTFile(){var _0x19afd3=a5_0x3468ec;CommonDeptFileCreate(_0x19afd3(0x17a),0x3);}function CommonDeptFileCreate(_0x5b739c,_0x8d7eec){var _0x17ad3f=a5_0x3468ec,_0x5e113f='',_0x5a9a8b=$(_0x17ad3f(0xf3))['val']();_0x5a9a8b=_0x5a9a8b[_0x17ad3f(0xc5)](0x10,-0x1);if(mydeptSiteUrl==_0x17ad3f(0x152))return alert(_0x17ad3f(0x126)),![];_0x5a9a8b==''?createNewDocumentWithRedirect2(_0x5e113f,mydeptSiteUrl+_0x17ad3f(0x121)+_0x5b739c,mydeptSiteUrl+_0x17ad3f(0x105),_0x17ad3f(0x14d),![],mydeptSiteUrl+_0x17ad3f(0xc7)+myCompanyUrl+_0x17ad3f(0xe8)+_0x5b739c,!![],_0x8d7eec):createNewDocumentWithRedirect2(_0x5e113f,mydeptSiteUrl+_0x17ad3f(0x121)+_0x5b739c,mydeptSiteUrl+_0x17ad3f(0xbe)+_0x5a9a8b,_0x17ad3f(0x14d),![],mydeptSiteUrl+'/_layouts/CreateNewDocument.aspx?id='+myCompanyUrl+'/DocumentManagementSystem/Forms/template.'+_0x5b739c,!![],_0x8d7eec);}function getDeptSiteUrl(){var _0x59544e=a5_0x3468ec,_0x3642fc=_0x59544e(0xd1)+Logged_DepartmentId+'\x27\x20';dfds=$[_0x59544e(0x112)](),url=_spPageContextInfo[_0x59544e(0x124)]+'/_api/web/lists/getbytitle(\x27Departments\x27)/items/'+_0x3642fc,$[_0x59544e(0xc2)](getItems(url,dfds))[_0x59544e(0x143)](function(_0xf39e8f){var _0x58893c=_0x59544e;response=[],_0xf39e8f['length']>0x0?mydeptSiteUrl=_0xf39e8f[0x0][_0x58893c(0xe5)]:mydeptSiteUrl=_0x58893c(0x152);});}function OpenSharePopup(){var _0x38c463=a5_0x3468ec;$(_0x38c463(0x162))['hide']();if(selectedDepartmentDoc['length']>0x0)globalsharingDocumentDetails='',globalSharingDocumentDocumentType='',$(_0x38c463(0xeb))[_0x38c463(0xec)](_0x38c463(0x116),!![]),$(_0x38c463(0x15d))[_0x38c463(0x11d)](''),$(_0x38c463(0xc3))[_0x38c463(0x168)](''),$(_0x38c463(0x14f))[_0x38c463(0x168)](''),$(_0x38c463(0x100))[_0x38c463(0x168)](''),$(_0x38c463(0x114))['val'](_0x38c463(0x11c)),$('#shareingTypePermissionLevel')['val']('0'),$('#sharefilename')[_0x38c463(0x120)](),$(_0x38c463(0xc0))['hide'](),$(_0x38c463(0x170))['hide'](),sharedUsersIdArrayListItemCollection=[],sharedUsersEmailIDsArrayListItemCollection=[],clearPeoplePickerControl(_0x38c463(0x119)),$(_0x38c463(0xcb))['modal']('show'),$(_0x38c463(0x142))['hide'](),$(_0x38c463(0xf4))[_0x38c463(0xf8)](),BindMySharingGroups(),$(_0x38c463(0x13c))['trigger'](_0x38c463(0xd5));else return alert('Please\x20select\x20one\x20or\x20more\x20file'),![];}function DeptSharemutiplefile(){var _0x10db24=a5_0x3468ec;if(selectedDepartmentDoc[_0x10db24(0x11b)]>0x0){var _0x1a5e76=$('#shareingTypePermissionLevel')['val'](),_0x2285cd=$(_0x10db24(0x114))['val']();if(_0x1a5e76=='0'||_0x1a5e76==null||_0x1a5e76=='')return currentDlgShare!=''&&currentDlgShare[_0x10db24(0xf2)](),alert('Kindly\x20select\x20sharing\x20type.'),![];else{if(_0x2285cd==null||_0x2285cd==''||_0x2285cd==_0x10db24(0x11c))return currentDlgShare!=''&&currentDlgShare['close'](),alert(_0x10db24(0xd7)),![];}if(_0x1a5e76==_0x10db24(0x15b))$('#chekedSendEmail')[_0x10db24(0xec)](_0x10db24(0x116),![]);else{if(_0x1a5e76==_0x10db24(0x15e)){sharedHistoryUser=sharedUsersIdArrayListItemCollection;if($(_0x10db24(0x134))[_0x10db24(0x12f)]()[_0x10db24(0x12a)](_0x10db24(0xed))==0x0)return currentDlgShare!=''&&currentDlgShare[_0x10db24(0xf2)](),alert(_0x10db24(0x165)),![];if(sharedUsersIdArrayListItemCollection[_0x10db24(0x11b)]==0x0)return currentDlgShare!=''&&currentDlgShare[_0x10db24(0xf2)](),alert('Guest\x20users\x20are\x20not\x20available\x20in\x20selected\x20organization(s).'),![];}else{sharedHistoryUser=[],sharedUsersIdArrayListItemCollection=[],sharedUsersEmailIDsArrayListItemCollection=[];if(getUserInfoFromPeoplePicker(_0x10db24(0x119))){if(sharedUsersIdArrayListItemCollection!=null){sharedHistoryUser=sharedUsersIdArrayListItemCollection;if(sharedUsersIdArrayListItemCollection[_0x10db24(0x11b)]==0x0)return currentDlgShare!=''&&currentDlgShare[_0x10db24(0xf2)](),alert('Kindly\x20enter\x20sharing\x20users.'),![];}else return currentDlgShare!=''&&currentDlgShare[_0x10db24(0xf2)](),alert(_0x10db24(0x13e)),![];}else return currentDlgShare!=''&&currentDlgShare['close'](),alert(_0x10db24(0x13e)),![];}}for(var _0x5c6057=0x0;_0x5c6057<selectedDepartmentDoc['length'];_0x5c6057++){currentFileSiteURL=window[_0x10db24(0xc1)][_0x10db24(0x140)]+selectedDepartmentDocrelativeurl[_0x5c6057][_0x10db24(0xca)](_0x10db24(0xe2))[0x0];var _0x3895c2=selectedDepartmentDoc[_0x5c6057],_0x4487a1=GetDeptFileServerRelativeUrl(_0x3895c2,_0x10db24(0x118));arrSharedUserIds=[];var _0x364cdc=-0x1;while(++_0x364cdc<sharedUsersIdArrayListItemCollection[_0x10db24(0x11b)]){arrSharedUserIds[_0x364cdc]=sharedUsersIdArrayListItemCollection[_0x364cdc];}sharedUsersIdArrayListItemCollection=sharedUsersIdArrayListItemCollection[_0x10db24(0x149)](sharefileuser);if(_0x1a5e76=='Private')sharedUsersIdArrayListItemCollection=[],$['when'](BreakInheritePermissionOnItemSharing(myCompanyUrl,_0x4487a1,_0x3895c2,_spPageContextInfo[_0x10db24(0xc8)],sharedUsersIdArrayListItemCollection))['done'](function(_0x406086){DeleteSharedLink(_0x3895c2);});else{var _0x541209=$('#shareingTypePermissionLevel')[_0x10db24(0x11d)](),_0x24d907=$(_0x10db24(0x114))[_0x10db24(0x11d)]();ShareFilesFolder(_0x4487a1,_0x10db24(0x118));if(sharedUsersIdArrayListItemCollection[_0x10db24(0x11b)]>0x0){var _0x573a24=$(_0x10db24(0x13c))[_0x10db24(0x11d)]();updateDeptDocPropertiesOnItemSharing(_0x3895c2,_0x4487a1,_0x573a24,sharedUsersIdArrayListItemCollection,currentFileSiteURL,![]),GetDocumentsRevoke(sharedHistoryUser,_0x3895c2),_0x1a5e76=='Organization'?AddSharedLinkToListOrg(shredLinkFileName,_0x4487a1,arrUserClientWise,_0x3895c2,_0x10db24(0x118),_0x541209,_0x24d907,_0x10db24(0x16c)):AddSharedLinkToList22(shredLinkFileName,_0x4487a1,sharedHistoryUser,_0x3895c2,_0x10db24(0x118),_0x541209,_0x24d907,'Department');}sharedUsersIdArrayListItemCollection=sharedHistoryUser;}sharefileuser=[];}selectedDocumentserverrelativeurl=[],selectedDepartmentDoc=[];if($('#chekedSendEmail')[_0x10db24(0x166)](_0x10db24(0x116))==!![]){if(arrDepartmntEmail[_0x10db24(0x11b)]>0x0){var _0x297101='',_0x31526e=$(_0x10db24(0x172))['text']();_0x31526e=='--select--'&&(_0x31526e='');_0x297101='Dear\x20User,<br/><br/>'+_spPageContextInfo[_0x10db24(0xda)]+_0x10db24(0x163);for(i=0x0;i<arrDepartmntEmail[_0x10db24(0x11b)];i++){_0x297101=_0x297101+'<div><strong>File\x20Name\x20:</strong>'+arrDepartmntEmail[i][_0x10db24(0x118)]+_0x10db24(0x173)+_0x10db24(0x160)+arrDepartmntEmail[i]['Reference']+_0x10db24(0x173)+_0x10db24(0x129)+arrDepartmntEmail[i]['Title']+'</div>'+_0x10db24(0x16a)+arrDepartmntEmail[i][_0x10db24(0x130)]+'</div>'+_0x10db24(0x154)+_0x31526e+_0x10db24(0x173)+_0x10db24(0x178)+arrDepartmntEmail[i][_0x10db24(0x141)]+_0x10db24(0x122)+_0x10db24(0x148);}_0x297101+=_0x10db24(0x158);}arrDepartmntEmail=[];var _0x1c1a88=[];_0x1c1a88[_0x10db24(0xdf)]($(_0x10db24(0x117))[_0x10db24(0x168)]());var _0x416347=$(_0x10db24(0x13c))['val'](),_0x2f372b=$(_0x10db24(0x117))[_0x10db24(0x168)](),_0x292131;_0x292131={'properties':{'__metadata':{'type':_0x10db24(0xbf)},'From':_0x2f372b,'To':{'results':sharedUsersEmailIDsArrayListItemCollection},'CC':{'results':_0x1c1a88},'Body':_0x297101,'Subject':sharedEmailSubject}},SendEmailSharedNotification(_0x292131);}}else alert('Please\x20select\x20one\x20or\x20more\x20file'),currentDlgShare!=''&&currentDlgShare[_0x10db24(0xf2)]();currentDlgShare!=''&&currentDlgShare[_0x10db24(0xf2)]();}function GetDeptFileServerRelativeUrl(_0x2090ec,_0x3ddc02){var _0x100bca=a5_0x3468ec,_0x4a945='',_0x5522dc=currentFileSiteURL+'_api/web/Lists/GetByTitle(\x27DepartmentalDMS\x27)/getItemById('+_0x2090ec+')?$select=ServerRedirectedEmbedUri,File/Name,File/ServerRelativeUrl,Folder/Name,Folder/ServerRelativeUrl,Shared/Title,SharedId&$expand=File,Folder,SharedId';return $['ajax']({'url':_0x5522dc,'headers':{'accept':_0x100bca(0x174),'content-type':_0x100bca(0x174),'X-RequestDigest':$(_0x100bca(0x109))[_0x100bca(0x11d)]()},'async':![],'success':function(_0x16fb90){var _0x4daf07=_0x100bca;if(_0x3ddc02=='File'){_0x4a945=_0x16fb90['d'][_0x4daf07(0x118)][_0x4daf07(0x12b)],shredLinkFileName=_0x16fb90['d']['File'][_0x4daf07(0xea)],commonserverRedirectedEmbedUri=_0x16fb90['d'][_0x4daf07(0x10c)];if(_0x16fb90['d'][_0x4daf07(0x136)]!=null)for(var _0x49c995=0x0;_0x49c995<_0x16fb90['d'][_0x4daf07(0x136)][_0x4daf07(0x157)][_0x4daf07(0x11b)];_0x49c995++){var _0x14aa8e=_0x16fb90['d'][_0x4daf07(0x136)][_0x4daf07(0x157)][_0x49c995];sharefileuser[_0x4daf07(0xdf)](_0x14aa8e);}(commonserverRedirectedEmbedUri==null||commonserverRedirectedEmbedUri=='')&&(commonserverRedirectedEmbedUri='');}else _0x4a945=_0x16fb90['d'][_0x4daf07(0xe7)]['ServerRelativeUrl'],shredLinkFolderName=_0x16fb90['d'][_0x4daf07(0xe7)][_0x4daf07(0xea)],commonserverRedirectedEmbedUri='';},'eror':function(_0x362975){var _0x55d5c5=_0x100bca;console[_0x55d5c5(0x156)]('error:\x20'+JSON['stringify'](_0x362975)),currentDlgShare!=''&&currentDlgShare[_0x55d5c5(0xf2)]();}}),_0x4a945;}function updateDeptDocPropertiesOnItemSharing(_0x52213d,_0x41a353,_0x5327bd,_0x55583f,_0xc50d4a,_0x588e49){var _0x40d57c=a5_0x3468ec,_0x260e70=$(_0x40d57c(0x114))['val'](),_0x15d79d=$('#txtPermissionLevelId')[_0x40d57c(0x11d)]();$(_0x40d57c(0x13c))[_0x40d57c(0x11d)]()=='Private'&&(_0x15d79d='',_0x260e70='');(_0x260e70=='--select--'||_0x260e70==null||_0x260e70=='')&&(_0x15d79d='',_0x260e70='');var _0x23cb85=_0x40d57c(0xe2),_0x31e310,_0x2b0b15=GetItemTypeDeptList(_0x23cb85);_0x31e310={'__metadata':{'type':_0x2b0b15},'SecurityLevel':_0x5327bd,'PermissionLevel':_0x260e70,'PermissionLevelId':_0x15d79d,'SharedId':{'results':_0x55583f}},checkoutDeptDocument(_0x41a353)[_0x40d57c(0x143)](function(){updateItemWithIDItemListDocuments(_0x23cb85,_0x31e310,_0x52213d,_0xc50d4a,_0x588e49)['done'](function(){checkInDeptDocument(_0x41a353)['done'](function(){var _0x91312=a5_0x3c2e,_0x5b324c=readTargetUrlCookie(_0x91312(0x11f)+_spPageContextInfo[_0x91312(0x14c)]);departmentDoc[_0x91312(0x167)](_0x5b324c);});});})[_0x40d57c(0xde)](function(_0x2b8609){var _0xcfca5=_0x40d57c;console[_0xcfca5(0x156)](_0xcfca5(0xdb)+JSON[_0xcfca5(0x110)](_0x2b8609)),currentDlgShare!=''&&currentDlgShare['close']();});}function GetItemTypeDeptList(_0x2cf9af){var _0x20fbd4=a5_0x3468ec;return _0x20fbd4(0x106)+_0x2cf9af[_0x20fbd4(0xd0)](0x0)[_0x20fbd4(0x13b)]()+_0x2cf9af[_0x20fbd4(0xca)]('\x20')[_0x20fbd4(0xd9)]('')['slice'](0x1)+_0x20fbd4(0xd6);}function checkoutDeptDocument(_0x2dfb92){var _0x4178f6=a5_0x3468ec,_0x5b42b2=$[_0x4178f6(0x112)]();return $['ajax']({'url':currentFileSiteURL+_0x4178f6(0x115)+_0x2dfb92+'\x27)/checkout','method':_0x4178f6(0xee),'headers':{'accept':_0x4178f6(0x174),'content-type':_0x4178f6(0x174),'X-RequestDigest':$(_0x4178f6(0x109))[_0x4178f6(0x11d)]()},'success':function(_0x50d981){var _0x2992bc=_0x4178f6,_0x243d6f=_0x50d981;_0x5b42b2[_0x2992bc(0x17b)](_0x50d981['d']),console[_0x2992bc(0x156)](_0x2992bc(0x102));},'error':function(_0x214f27){var _0x11bb60=_0x4178f6;alert(_0x11bb60(0xd8)+JSON['stringify'](_0x214f27)),currentDlgShare!=''&&currentDlgShare[_0x11bb60(0xf2)]();}}),_0x5b42b2;}function checkInDeptDocument(_0x351c30){var _0x227e50=a5_0x3468ec,_0x2f02d5=currentFileSiteURL+_0x227e50(0x115)+_0x351c30+_0x227e50(0x144),_0x364a07=$[_0x227e50(0x112)]();return $['ajax']({'url':_0x2f02d5,'method':'POST','data':JSON[_0x227e50(0x110)]({'checkInType':0x2,'comment':_0x227e50(0x133)}),'headers':{'accept':_0x227e50(0x174),'content-type':_0x227e50(0x174),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x227e50(0x11d)]()},'success':function(_0x110bdb){var _0x15d613=_0x227e50,_0x4274c2=_0x110bdb;_0x364a07[_0x15d613(0x17b)](_0x110bdb['d']),console[_0x15d613(0x156)]('file\x20chekin');},'error':function(_0x358291){var _0x39ca17=_0x227e50;_0x364a07[_0x39ca17(0xcc)](_0x358291),currentDlgShare!=''&&currentDlgShare[_0x39ca17(0xf2)]();}}),_0x364a07;}var SelectedFolderPathURL='';function DeptShareFolderProperties(_0x4e6e1c,_0x2b242a,_0x5ce927){var _0x4ae699=a5_0x3468ec;SelectedFolderPathURL=window[_0x4ae699(0xc1)][_0x4ae699(0x140)]+_0x5ce927[_0x4ae699(0xca)](_0x4ae699(0xe2))[0x0],BindDeptSharingGroups(),commonUsedFolderSharingId=_0x4e6e1c,$(_0x4ae699(0xe3))[_0x4ae699(0xec)](_0x4ae699(0x116),![]),sharedUsersIdArrayListItemCollection=[],sharedUsersEmailIDsArrayListItemCollection=[],clearPeoplePickerControl(_0x4ae699(0x150)),$(_0x4ae699(0x128))['val']('0'),$('#shareingTypePermissionLevel')['trigger']('change'),$(_0x4ae699(0x164))[_0x4ae699(0xfd)](_0x4ae699(0xf8)),$(_0x4ae699(0x175))[_0x4ae699(0x168)](_0x2b242a);}function BindDeptSharingGroups(){var _0x34ef73=a5_0x3468ec;$('.context-menu')[_0x34ef73(0x120)]();var _0x121cf7=_spPageContextInfo[_0x34ef73(0x123)]+'/_api/web/lists/getbytitle(\x27DocumentSharedGroups\x27)/items?$select=ID,SharingLevel,SharedUsers/Title,SharedUsers/UserName,SharedUsers/ID,LogonUser/ID,LogonUser/UserName&$expand=SharedUsers,LogonUser&$filter=LogonUser/ID\x20eq\x20\x27'+_spPageContextInfo['userId']+'\x27';$['ajax']({'url':_0x121cf7,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x407513){var _0x498298=_0x34ef73;$(_0x498298(0x128))[_0x498298(0x101)]()['append'](_0x498298(0x125)),$(_0x498298(0x128))['append']($(_0x498298(0xfa))[_0x498298(0xec)](_0x498298(0x176),_0x498298(0x15b))[_0x498298(0x12f)]('Private')),$(_0x498298(0x128))[_0x498298(0x14b)]($(_0x498298(0xfa))['attr']('value',_0x498298(0x135))['text']('Selective')),$('#sharingTypeDeptFolderPermissionLvl')[_0x498298(0x14b)]($(_0x498298(0xfa))[_0x498298(0xec)](_0x498298(0x176),_0x498298(0x15e))[_0x498298(0x12f)](_0x498298(0x15e)));for(var _0x4b8e86=0x0;_0x4b8e86<_0x407513['d'][_0x498298(0x157)][_0x498298(0x11b)];_0x4b8e86++){$('#sharingTypeDeptFolderPermissionLvl')[_0x498298(0x14b)]($(_0x498298(0xfa))[_0x498298(0xec)]('value',_0x407513['d']['results'][_0x4b8e86][_0x498298(0xe0)])[_0x498298(0x12f)](_0x407513['d'][_0x498298(0x157)][_0x4b8e86]['SharingLevel']));}},'eror':function(_0x142475){var _0x483672=_0x34ef73;console[_0x483672(0x156)](_0x483672(0xdb)+JSON[_0x483672(0x110)](_0x142475)),currentDlgShare!=''&&currentDlgShare[_0x483672(0xf2)]();}});}function GetDeptSharingGpUsers(_0x256d23,_0x3d4631){var _0x1e4618=a5_0x3468ec;sharedUsersIdArrayListItemCollection=[],sharedUsersEmailIDsArrayListItemCollection=[];var _0x4422f2=_spPageContextInfo[_0x1e4618(0x123)]+_0x1e4618(0x12c)+_0x256d23+_0x1e4618(0xc4)+_spPageContextInfo[_0x1e4618(0xc8)]+'\x27';$[_0x1e4618(0x13d)]({'url':_0x4422f2,'headers':{'Accept':_0x1e4618(0x174)},'async':![],'success':function(_0x5c355e){var _0xcd7e1d=_0x1e4618,_0x58bb97='';for(var _0x50dd1e=0x0;_0x50dd1e<_0x5c355e['d']['results'][_0xcd7e1d(0x11b)];_0x50dd1e++){for(var _0x19c62d=0x0;_0x19c62d<_0x5c355e['d'][_0xcd7e1d(0x157)][_0x50dd1e]['SharedUsers'][_0xcd7e1d(0x157)]['length'];_0x19c62d++){sharedUsersIdArrayListItemCollection[_0xcd7e1d(0x12a)](_0x5c355e['d'][_0xcd7e1d(0x157)][_0x50dd1e][_0xcd7e1d(0xdc)][_0xcd7e1d(0x157)][_0x19c62d]['ID'])==-0x1&&(sharedUsersIdArrayListItemCollection[_0xcd7e1d(0xdf)](_0x5c355e['d'][_0xcd7e1d(0x157)][_0x50dd1e][_0xcd7e1d(0xdc)]['results'][_0x19c62d]['ID']),SetAndResolvePeoplePicker(_0xcd7e1d(0x150),_0x5c355e['d'][_0xcd7e1d(0x157)][_0x50dd1e][_0xcd7e1d(0xdc)]['results'][_0x19c62d][_0xcd7e1d(0x139)],![]));}}},'eror':function(_0x5ee862){var _0x5f2c55=_0x1e4618;console[_0x5f2c55(0x156)](_0x5f2c55(0x179)+JSON['stringify'](_0x5ee862)),currentDlgShare!=''&&currentDlgShare[_0x5f2c55(0xf2)]();}});}function a5_0x5c8c(){var _0x56624b=['3569616xbQbqE','<br\x20/>Please\x20wait!!','ServerRedirectedEmbedUri','Sharing\x20files...','filter','strings.js','stringify','Please\x20enter\x20sharing\x20users.','Deferred','showWaitScreenWithNoClose','#sharedWithPermission','_api/web/getfilebyserverrelativeurl(\x27','checked','#lblSelectedCurrentEmail','File','customShareingPoplePicker','\x27)/ListItemAllFields/breakroleinheritance(true)','length','--select--','val','/_api/SP.Sharing.DocumentSharingManager.UpdateDocumentSharingInfo','MyDepartmentDocumentCurrentFolder','hide','/DepartmentalDMS/Forms/template.','>Click\x20here</a>\x20to\x20open\x20the\x20document.</div>','webServerRelativeUrl','webAbsoluteUrl','<option\x20value=\x220\x22>-Select\x20Sharing-</option>','Department\x20site\x20URL\x20is\x20not\x20found!','#shareWithDeptFolderPermission','#sharingTypeDeptFolderPermissionLvl','<div><strong>Title:</strong>\x20','indexOf','ServerRelativeUrl','/_api/web/lists/getbytitle(\x27DocumentSharedGroups\x27)/items?$select=ID,SharingLevel,SharedUsers/Title,SharedUsers/UserName,SharedUsers/ID,LogonUser/ID,LogonUser/UserName&$expand=SharedUsers,LogonUser&$filter=SharingLevel\x20eq\x20\x27','677988IhFYLZ','click','text','Type','470124AQrvoQ','Revoked','whatever','.multiBox','Selective','SharedId','515136OQJEwJ','#deptSharedFolderUsersLists','UserName','4NBrgaH','toUpperCase','#shareingTypePermissionLevel','ajax','Kindly\x20enter\x20sharing\x20users.','Please\x20select\x20sharing\x20type.','origin','serverUrl','.MyDocsShare','done','\x27)/checkin','SOD','Sharing\x20folder...','.folderpeoplepickerdivshowhide','<br/><br/>','concat','ItemId','append','siteId','SharePoint.OpenDocuments','.orgDropdowndivDeptFolder','#lblDocNumber','customSharingDeptFolderPplPickr','19310HaxStF','null','SharedDocument','<div><strong>Permission:</strong>\x20','_api/web/Lists/GetByTitle(\x27DepartmentalDMS\x27)/getItemById(','log','results','This\x20is\x20an\x20auto\x20generated\x20email.\x20Please\x20don\x27t\x20reply.','Sharing\x20Dept_Doc\x20Folder\x20','#deptDocShare','Private','permission\x20deleted\x20sucessfully.','#txtSharedDocumetnOnDemandId','Organization','/_api/web/GetFileByServerRelativeUrl(\x27','<div><strong>Reference\x20No\x20:</strong>\x20','{{Permission}}','.orgDropdowndiv',',\x20shared\x20the\x20following\x20document\x20with\x20you.<br/><br/>','#myDeptFolderSharing','Kindly\x20select\x20any\x20organization.','prop','GetMyDocumentsWithFilesFolder','html','{{filename}}','<div><strong>Type:</strong>\x20','#ddlOrgNameDeptFolder\x20:selected','Department','loadMultiple','740943NgyBsF','Restricted\x20View','#filedocumentname','_api/Web/Lists/getByTitle(\x27DepartmentalDMS\x27)/Items(','#sharedWithPermission\x20:selected','</div>','application/json;odata=verbose','#lblFolderDeptTiltle','value','application/json;\x20odata=verbose','<div><a\x20href=','Error:\x20','pptx','resolve','120UtkCcJ',')?$select=ServerRedirectedEmbedUri,File/Name,File/ServerRelativeUrl,Folder/Name,Folder/ServerRelativeUrl,Shared/Title,SharedId&$expand=File,Folder,SharedId','/DepartmentalDMS/','SP.Utilities.EmailProperties','#sharefiletilte','location','when','#lblFileName','\x27\x20and\x20LogonUser/ID\x20eq\x20\x27','slice','{{details}}','/_layouts/CreateNewDocument.aspx?id=','userId','ddlOrgNameDeptFolder','split','#myModalDocumentSharing','reject','replace','Guest\x20users\x20are\x20not\x20available\x20in\x20selected\x20organization(s).','{{doclink}}','charAt','?$select=ID,SiteURL&$top=5000&$filter=ID\x20eq\x20\x27','json','ModalDialog','#ddlOrgNameDeptFolder','change','Item','Kindly\x20select\x20permission\x20type.','Error\x20while\x20checking\x20out:\x20','join','userDisplayName','error:\x20','SharedUsers','{{sharedby}}','fail','push','SharingLevel','DELETE','DepartmentalDMS','#chkDeptFolderSendEmail','/_api/web/GetFolderByServerRelativeUrl(\x27','SiteURL','.mulinput','Folder','/DocumentManagementSystem/Forms/template.','_api/web/lists/getByTitle(\x27DepartmentalDMS\x27)/getItemById(','Name','#chekedSendEmail','attr','Select','POST','sp.ui.dialog.js','#myModalShareHistory','xlsx','close','#currentSubFolderMyDepartment','#Deptmutiplesharefile','RoleAssignments','#sharedWithPermission\x20\x20:selected','\x27)/ListItemAllFields/roleassignments/getbyprincipalid(','show','PrincipalId','<option></option>','{{fileype}}','Please\x20look\x20at\x20the\x20following\x20File/Folder.','modal','parse','373608NriYUv','#lblDocTiltle','empty','success:File\x20Checked\x20out\x20','\x20Successfully\x20removed\x20Permission\x20!','ready','/DepartmentalDMS','SP.Data.','siteAbsoluteUrl',')?$expand=RoleAssignments/Member/Users','#__REQUESTDIGEST'];a5_0x5c8c=function(){return _0x56624b;};return a5_0x5c8c();}function deptDocFolderSharing(){var _0x5f4b14=a5_0x3468ec,_0x216103=$(_0x5f4b14(0x128))[_0x5f4b14(0x11d)](),_0xb9b703=$(_0x5f4b14(0x127))[_0x5f4b14(0x11d)]();if(_0x216103=='0'||_0x216103==null||_0x216103=='')return currentDlgShare!=''&&currentDlgShare[_0x5f4b14(0xf2)](),alert(_0x5f4b14(0x13f)),![];else{if(_0xb9b703==null||_0xb9b703==''||_0xb9b703==_0x5f4b14(0x11c))return currentDlgShare!=''&&currentDlgShare[_0x5f4b14(0xf2)](),alert(_0x5f4b14(0xd7)),![];else{if(_0x216103==_0x5f4b14(0x15e)){sharedHistoryUser=sharedUsersIdArrayListItemCollection;if($('#ddlOrgNameDeptFolder')[_0x5f4b14(0x11d)]()=='0')return currentDlgShare!=''&&currentDlgShare[_0x5f4b14(0xf2)](),alert('Kindly\x20select\x20any\x20organization.'),![];if(sharedUsersIdArrayListItemCollection[_0x5f4b14(0x11b)]==0x0)return currentDlgShare!=''&&currentDlgShare[_0x5f4b14(0xf2)](),alert(_0x5f4b14(0xce)),![];}}}if(_0x216103=='Private')$(_0x5f4b14(0xe3))[_0x5f4b14(0xec)](_0x5f4b14(0x116),![]);else{if(_0x216103!=_0x5f4b14(0x15e)){sharedUsersIdArrayListItemCollection=[],sharedUsersEmailIDsArrayListItemCollection=[];if(getUserInfoFromPeoplePicker('customSharingDeptFolderPplPickr')){if(sharedUsersIdArrayListItemCollection!=null){if(sharedUsersIdArrayListItemCollection[_0x5f4b14(0x11b)]==0x0)return currentDlgShare!=''&&currentDlgShare[_0x5f4b14(0xf2)](),alert(_0x5f4b14(0x111)),![];}else return currentDlgShare!=''&&currentDlgShare[_0x5f4b14(0xf2)](),alert('Please\x20enter\x20sharing\x20users.'),![];}else return currentDlgShare!=''&&currentDlgShare[_0x5f4b14(0xf2)](),alert(_0x5f4b14(0x111)),![];}}var _0x223763=GetDeptFileServerUrlById(commonUsedFolderSharingId,_0x5f4b14(0xe7));_0x216103==_0x5f4b14(0x15b)?(updateFolderProperties(commonUsedFolderSharingId,mydeptSiteUrl,![],_0x5f4b14(0xe2),_0x5f4b14(0x15b)),$[_0x5f4b14(0xc2)](GetAllDeptFolderUsrsSharedPrincipleId(commonUsedFolderSharingId))['done'](function(_0x46a7fc){var _0x17832b=_0x5f4b14;DeleteSharedLink(commonUsedFolderSharingId);var _0x546ece=readTargetUrlCookie(_0x17832b(0x11f)+_spPageContextInfo['siteId']);departmentDoc[_0x17832b(0x167)](_0x546ece),alert('Folder\x27s\x20permission\x20has\x20been\x20set\x20private.'),$('#myDeptFolderSharing')['modal']('hide'),currentDlgShare!=''&&currentDlgShare['close']();})):(updateFolderProperties(commonUsedFolderSharingId,mydeptSiteUrl,![],'DepartmentalDMS',_0x216103),ShareDeptFilesFolder(_0x223763,'Folder',_0x216103));}function GetDeptFileServerUrlById(_0x3f583a,_0x88920d){var _0x22f184=a5_0x3468ec,_0x18aa4f='',_0x5b111b=SelectedFolderPathURL+_0x22f184(0x155)+_0x3f583a+_0x22f184(0x17d);return $[_0x22f184(0x13d)]({'url':_0x5b111b,'headers':{'accept':'application/json;odata=verbose','content-type':_0x22f184(0x174),'X-RequestDigest':$(_0x22f184(0x109))[_0x22f184(0x11d)]()},'async':![],'success':function(_0x161ff2){var _0x49461e=_0x22f184;if(_0x88920d==_0x49461e(0x118)){_0x18aa4f=_0x161ff2['d']['File'][_0x49461e(0x12b)],shredLinkFileName=_0x161ff2['d']['File'][_0x49461e(0xea)],commonserverRedirectedEmbedUri=_0x161ff2['d'][_0x49461e(0x10c)];if(_0x161ff2['d'][_0x49461e(0x136)]!=null)for(var _0x1fffc0=0x0;_0x1fffc0<_0x161ff2['d'][_0x49461e(0x136)]['results'][_0x49461e(0x11b)];_0x1fffc0++){var _0x582782=_0x161ff2['d'][_0x49461e(0x136)][_0x49461e(0x157)][_0x1fffc0];sharefileuser[_0x49461e(0xdf)](_0x582782);}(commonserverRedirectedEmbedUri==null||commonserverRedirectedEmbedUri=='')&&(commonserverRedirectedEmbedUri='');}else _0x18aa4f=_0x161ff2['d'][_0x49461e(0xe7)][_0x49461e(0x12b)],shredLinkFolderName=_0x161ff2['d'][_0x49461e(0xe7)][_0x49461e(0xea)],commonserverRedirectedEmbedUri='';},'eror':function(_0x483bbf){var _0x4f63e3=_0x22f184;console[_0x4f63e3(0x156)]('Error:\x20'+JSON[_0x4f63e3(0x110)](_0x483bbf));}}),_0x18aa4f;}function GetAllDeptFolderUsrsSharedPrincipleId(_0x2e65d7){var _0x4c365f=a5_0x3468ec,_0x37cf96=$[_0x4c365f(0x112)](),_0x2ca026=new Date(),_0x237f3d=Date[_0x4c365f(0xfe)](_0x2ca026);return $[_0x4c365f(0x13d)]({'url':SelectedFolderPathURL+_0x4c365f(0x171)+_0x2e65d7+_0x4c365f(0x108)+_0x237f3d,'method':'GET','async':![],'headers':{'Accept':_0x4c365f(0x177)},'success':function(_0xbb8821){var _0x2e498e=_0x4c365f;_0x37cf96['resolve'](_0xbb8821['d'][_0x2e498e(0x157)]);for(var _0x2043ae=0x0;_0x2043ae<_0xbb8821['d'][_0x2e498e(0xf5)][_0x2e498e(0x157)][_0x2e498e(0x11b)];_0x2043ae++){if(_0xbb8821['d'][_0x2e498e(0xf5)][_0x2e498e(0x157)][_0x2043ae][_0x2e498e(0xf9)]!=_spPageContextInfo[_0x2e498e(0xc8)]){var _0x3abc55=_0xbb8821['d']['RoleAssignments']['results'][_0x2043ae][_0x2e498e(0xf9)];DeleteDeptFolderPrinciple(_0x2e65d7,_0x3abc55);}}},'error':function(_0x561815){var _0x1bb6f4=_0x4c365f;_0x37cf96[_0x1bb6f4(0xcc)](_0x561815),waitingDialog['hide']();}}),_0x37cf96['promise']();}function DeleteDeptFolderPrinciple(_0x5595d4,_0x3e1935){var _0xceff18=a5_0x3468ec,_0x185430=$[_0xceff18(0x112)](),_0x17fc9d={'X-RequestDigest':$(_0xceff18(0x109))[_0xceff18(0x11d)](),'X-HTTP-Method':_0xceff18(0xe1)},_0x4bea65=SelectedFolderPathURL+_0xceff18(0xe9)+_0x5595d4+')/roleassignments/getbyprincipalid('+_0x3e1935+')';return $[_0xceff18(0x13d)]({'url':_0x4bea65,'type':_0xceff18(0xee),'headers':_0x17fc9d,'async':![],'dataType':_0xceff18(0xd2),'success':function(_0x51021d){var _0x44904a=_0xceff18;_0x185430[_0x44904a(0x17b)](_0x51021d['d'][_0x44904a(0x157)]),console[_0x44904a(0x156)](_0x3e1935+_0x44904a(0x103));},'error':function(_0x49b43c){var _0xfe6a91=_0xceff18;_0x185430['reject'](_0x49b43c),console[_0xfe6a91(0x156)](JSON['stringify'](_0x49b43c));}}),_0x185430['promise']();}function ShareDeptFilesFolder(_0x3ead11,_0x56f90d,_0x73640){var _0xe115a2=a5_0x3468ec,_0x39f55a=[],_0x291684=0x1;if($(_0xe115a2(0x127))[_0xe115a2(0x11d)]()=='Read')_0x291684=0x1;else $('#shareWithDeptFolderPermission')['val']()==_0xe115a2(0x16f)?_0x291684=0x7:_0x291684=0x2;var _0x561024=createJSONMetadata(sharedUsersEmailIDsArrayListItemCollection,_0x291684),_0x4ec157=_spPageContextInfo[_0xe115a2(0x124)]+_0xe115a2(0x11e);$[_0xe115a2(0x13d)]({'url':_0x4ec157,'method':_0xe115a2(0xee),'async':![],'data':JSON[_0xe115a2(0x110)]({'resourceAddress':document[_0xe115a2(0xc1)][_0xe115a2(0x140)]+_0x3ead11,'userRoleAssignments':_0x561024,'validateExistingPermissions':![],'additiveMode':![],'sendServerManagedNotification':![],'customMessage':_0xe115a2(0xfc),'includeAnonymousLinksInNotification':![]}),'headers':{'accept':'application/json;odata=verbose','content-type':_0xe115a2(0x174),'X-RequestDigest':$(_0xe115a2(0x109))[_0xe115a2(0x11d)]()},'success':function(_0x549ba4){var _0x456a01=_0xe115a2,_0x1e1efc=$(_0x456a01(0x128))[_0x456a01(0x11d)](),_0x39821c='';if(_0x56f90d==_0x456a01(0xe7)){GetDocumentsRevoke(sharedUsersIdArrayListItemCollection,commonUsedFolderSharingId);_0x73640==_0x456a01(0x15e)&&_0x56f90d==_0x456a01(0xe7)?AddSharedLinkToListOrg(shredLinkFolderName,_0x3ead11,arrUserClientWise,commonUsedFolderSharingId,_0x456a01(0xe7),_0x1e1efc,$(_0x456a01(0x127))[_0x456a01(0x11d)](),'Department'):AddSharedLinkToList22(shredLinkFolderName,_0x3ead11,sharedUsersIdArrayListItemCollection,commonUsedFolderSharingId,'Folder',_0x1e1efc,$(_0x456a01(0x127))[_0x456a01(0x11d)](),'Department');$('#chkDeptFolderSendEmail')['prop'](_0x456a01(0x116))==!![]&&EmailDeptSharedProperties(sharedUsersEmailIDsArrayListItemCollection,_0x56f90d);var _0x1daead=readTargetUrlCookie(_0x456a01(0x11f)+_spPageContextInfo[_0x456a01(0x14c)]);departmentDoc[_0x456a01(0x167)](_0x1daead);}$(_0x456a01(0x164))['modal'](_0x456a01(0x120)),currentDlgShare!=''&&currentDlgShare[_0x456a01(0xf2)](),$(_0x456a01(0xe6))['prop'](_0x456a01(0x116),![]),$(_0x456a01(0x134))['text']('Select'),$(_0x456a01(0x14e))[_0x456a01(0x120)]();},'error':function(_0x50d067){var _0x8993f3=_0xe115a2;alert(_0x8993f3(0x159)+JSON[_0x8993f3(0x110)](_0x50d067)),currentDlgShare!=''&&currentDlgShare[_0x8993f3(0xf2)]();}});}function EmailDeptSharedProperties(_0x415b0b,_0x10ddaa){var _0x47e947=a5_0x3468ec,_0x3b2b20=[];_0x3b2b20['push']($(_0x47e947(0x117))[_0x47e947(0x168)]());var _0x37a7bb=$('#sharingTypeDeptFolderPermissionLvl')[_0x47e947(0x11d)](),_0x4c0e01='',_0x4f8f5c=emailBodyContent;if(_0x10ddaa==_0x47e947(0xe7)){var _0xf30ea=$('#shareWithDeptFolderPermission\x20:selected')[_0x47e947(0x12f)]();_0xf30ea=='--select--'&&(_0xf30ea=''),_0x4f8f5c=_0x4f8f5c[_0x47e947(0xcd)](_0x47e947(0x169),$('#lblFolderDeptTiltle')[_0x47e947(0x12f)]()),_0x4f8f5c=_0x4f8f5c[_0x47e947(0xcd)](_0x47e947(0xfb),_0x47e947(0xe7)),_0x4f8f5c=_0x4f8f5c[_0x47e947(0xcd)]('{{details}}',''),_0x4f8f5c=_0x4f8f5c[_0x47e947(0xcd)](_0x47e947(0xcf),_spPageContextInfo[_0x47e947(0x107)]+'/Pages/MyDocuments.aspx?WebAppId=1'),_0x4f8f5c=_0x4f8f5c['replace'](_0x47e947(0x161),_0xf30ea);}else{globalSharingDocumentDocumentType==null&&(globalSharingDocumentDocumentType='');globalsharingDocumentDetails==null&&(globalsharingDocumentDetails='');var _0xf30ea=$(_0x47e947(0xf6))[_0x47e947(0x12f)]();_0xf30ea=='--select--'&&(_0xf30ea=''),_0x4f8f5c=_0x4f8f5c[_0x47e947(0xcd)](_0x47e947(0x169),$('#lblFileName')['html']()),_0x4f8f5c=_0x4f8f5c['replace'](_0x47e947(0xfb),globalSharingDocumentDocumentType),_0x4f8f5c=_0x4f8f5c[_0x47e947(0xcd)](_0x47e947(0xc6),globalsharingDocumentDetails),_0x4f8f5c=_0x4f8f5c[_0x47e947(0xcd)]('{{doclink}}',encodeURI(document['location']['origin']+'/'+$('#lblSelectedFileUrl')[_0x47e947(0x12f)]())),_0x4f8f5c=_0x4f8f5c[_0x47e947(0xcd)](_0x47e947(0x161),_0xf30ea);}_0x4f8f5c=_0x4f8f5c[_0x47e947(0xcd)](_0x47e947(0xdd),_spPageContextInfo[_0x47e947(0xda)]),_0x4c0e01=_0x4f8f5c;var _0x124c38=$('#lblSelectedCurrentEmail')['html'](),_0x1b1bfb;_0x1b1bfb={'properties':{'__metadata':{'type':'SP.Utilities.EmailProperties'},'From':_0x124c38,'To':{'results':_0x415b0b},'CC':{'results':_0x3b2b20},'Body':_0x4c0e01,'Subject':sharedEmailSubject}},SendEmailSharedNotification(_0x1b1bfb);}function RevokeDepartmntPermission(_0x5eb3ed,_0xe0d04c,_0x36a783,_0x5b4aa2){var _0x337791=a5_0x3468ec,_0x1b596e={'Accept':_0x337791(0x174),'content-Type':_0x337791(0x174),'X-RequestDigest':jQuery(_0x337791(0x109))[_0x337791(0x11d)]()},_0x2a409d=mydeptSiteUrl+_0x337791(0x15f)+_0xe0d04c+_0x337791(0x11a);if(_0x5b4aa2!='')$['ajax']({'url':_0x2a409d,'type':_0x337791(0xee),'headers':_0x1b596e,'dataType':_0x337791(0xd2),'success':function(_0x274b57){var _0x60e3d=_0x337791;DeleatePermissionDeptDocs(_0x36a783,_0xe0d04c,_0x5eb3ed,_0x5b4aa2,_0x60e3d(0x135),0x0,0x0);},'error':function(_0x23478a){var _0x4e336a=_0x337791;console[_0x4e336a(0x156)](JSON[_0x4e336a(0x110)](_0x23478a));}});else{_0x36a783=decodeURI(_0x36a783);var _0x1b8a5e=arrSharedOrgUsers[_0x337791(0x10e)](function(_0x4061f1){var _0x7e3ac4=_0x337791;return _0x36a783==_0x4061f1[_0x7e3ac4(0x15e)];});$[_0x337791(0x13d)]({'url':_0x2a409d,'type':_0x337791(0xee),'headers':_0x1b596e,'dataType':'json','success':function(_0x44d3dd){var _0x104e3f=_0x337791;for(k=0x0;k<_0x1b8a5e[_0x104e3f(0x11b)];k++){DeleatePermissionDeptDocs(_0x1b8a5e[k][_0x104e3f(0xc8)],_0xe0d04c,_0x5eb3ed,_0x1b8a5e[k][_0x104e3f(0x14a)],_0x104e3f(0x15e),k,_0x1b8a5e[_0x104e3f(0x11b)]);}},'error':function(_0x18d8e4){var _0x441550=_0x337791;console[_0x441550(0x156)](JSON['stringify'](_0x18d8e4));}});}}function DeleatePermissionDeptDocs(_0x35e6e9,_0x3eabdf,_0x7a9c2a,_0x3bfba8,_0x3cdd34,_0x1f7cea,_0x5cedc0){var _0x45f081=a5_0x3468ec,_0x3be3ec={'X-RequestDigest':$(_0x45f081(0x109))['val'](),'X-HTTP-Method':_0x45f081(0xe1)},_0xe58175=mydeptSiteUrl+_0x45f081(0x15f)+_0x3eabdf+_0x45f081(0xf7)+_0x35e6e9+')';$[_0x45f081(0x13d)]({'url':_0xe58175,'type':_0x45f081(0xee),'headers':_0x3be3ec,'async':![],'success':function(_0x49117c){var _0x5378a1=_0x45f081,_0xd250b4='SharedDocument',_0x5b17ea,_0xa48a91=GetItemTypeForListNameDetailsGroups(_0xd250b4);_0x5b17ea={'__metadata':{'type':_0xa48a91},'PermissionStatus':_0x5378a1(0x132)},$[_0x5378a1(0xc2)](updateItemWithIDItemListDocuments(_0xd250b4,_0x5b17ea,_0x3bfba8,myCompanyUrl))[_0x5378a1(0x143)](function(_0x401291){var _0x1ae619=_0x5378a1;_0x3cdd34==_0x1ae619(0x15e)?_0x1f7cea+0x1==_0x5cedc0&&alert(_0x1ae619(0x15c)):alert(_0x1ae619(0x15c)),$(_0x1ae619(0xf0))['modal'](_0x1ae619(0x120));}),console[_0x5378a1(0x156)](_0x35e6e9+_0x5378a1(0x103));},'error':function(_0x16b870){var _0x4b9d49=_0x45f081;console[_0x4b9d49(0x156)](JSON['stringify'](_0x16b870));}});}function BreakInheritePermissionFolderSharing(_0x3ad637,_0x57f3ac,_0x40674c,_0x512c0d){var _0x3907c9=a5_0x3468ec,_0x5e3f88={'Accept':_0x3907c9(0x174),'content-Type':_0x3907c9(0x174),'X-RequestDigest':jQuery(_0x3907c9(0x109))[_0x3907c9(0x11d)]()},_0x482c48=myCompanyUrl+_0x3907c9(0xe4)+_0x57f3ac+_0x3907c9(0x11a);if(_0x512c0d!='')$['ajax']({'url':_0x482c48,'type':_0x3907c9(0xee),'headers':_0x5e3f88,'dataType':'json','success':function(_0x29952d){var _0x212ef3=_0x3907c9;DeleateUserPermissionFolder(_0x40674c,_0x57f3ac,_0x3ad637,_0x512c0d,_0x212ef3(0x135),0x0,0x0);},'error':function(_0xaf6138){console['log'](JSON['stringify'](_0xaf6138));}});else{_0x40674c=decodeURI(_0x40674c);var _0x4b93da=arrSharedOrgUsers[_0x3907c9(0x10e)](function(_0x3ab22a){var _0x129e56=_0x3907c9;return _0x40674c==_0x3ab22a[_0x129e56(0x15e)];});$[_0x3907c9(0x13d)]({'url':_0x482c48,'type':'POST','headers':_0x5e3f88,'dataType':_0x3907c9(0xd2),'success':function(_0x15f067){var _0x316685=_0x3907c9;for(k=0x0;k<_0x4b93da['length'];k++){DeleateUserPermissionFolder(_0x4b93da[k]['userId'],_0x57f3ac,_0x3ad637,_0x4b93da[k][_0x316685(0x14a)],'Organization',k,_0x4b93da['length']);}},'error':function(_0x364690){var _0x38ea5a=_0x3907c9;console[_0x38ea5a(0x156)](JSON[_0x38ea5a(0x110)](_0x364690));}});}}function BreakPermissionDeptDocFolder(_0x513049,_0x4804c4,_0x19e38c,_0x30b163){var _0x3fe50e=a5_0x3468ec,_0x451ee4={'Accept':_0x3fe50e(0x174),'content-Type':_0x3fe50e(0x174),'X-RequestDigest':jQuery('#__REQUESTDIGEST')[_0x3fe50e(0x11d)]()},_0x1d504e=mydeptSiteUrl+_0x3fe50e(0xe4)+_0x4804c4+_0x3fe50e(0x11a);if(_0x30b163!='')$['ajax']({'url':_0x1d504e,'type':_0x3fe50e(0xee),'headers':_0x451ee4,'dataType':_0x3fe50e(0xd2),'success':function(_0x3bbed8){DeleteDeptPermissionFolder(_0x19e38c,_0x4804c4,_0x513049,_0x30b163,'Selective',0x0,0x0);},'error':function(_0x403271){var _0x5570be=_0x3fe50e;console[_0x5570be(0x156)](JSON[_0x5570be(0x110)](_0x403271));}});else{_0x19e38c=decodeURI(_0x19e38c);var _0x240b6a=arrSharedOrgUsers[_0x3fe50e(0x10e)](function(_0xee5aa4){var _0x1d1f20=_0x3fe50e;return _0x19e38c==_0xee5aa4[_0x1d1f20(0x15e)];});$['ajax']({'url':_0x1d504e,'type':_0x3fe50e(0xee),'headers':_0x451ee4,'dataType':_0x3fe50e(0xd2),'success':function(_0x28dcc0){var _0x372376=_0x3fe50e;for(k=0x0;k<_0x240b6a[_0x372376(0x11b)];k++){DeleteDeptPermissionFolder(_0x240b6a[k]['userId'],_0x4804c4,_0x513049,_0x240b6a[k]['ItemId'],_0x372376(0x15e),k,_0x240b6a[_0x372376(0x11b)]);}},'error':function(_0x26ef36){var _0x53d9fa=_0x3fe50e;console[_0x53d9fa(0x156)](JSON[_0x53d9fa(0x110)](_0x26ef36));}});}}function DeleteDeptPermissionFolder(_0x89fa43,_0x2f2539,_0x1e58e3,_0x40f256,_0x3ba04c,_0x385885,_0x2940a4){var _0x27f675=a5_0x3468ec,_0x35dc9a={'X-RequestDigest':$('#__REQUESTDIGEST')[_0x27f675(0x11d)](),'X-HTTP-Method':_0x27f675(0xe1)},_0xd4743b=mydeptSiteUrl+_0x27f675(0xe4)+_0x2f2539+_0x27f675(0xf7)+_0x89fa43+')';$[_0x27f675(0x13d)]({'url':_0xd4743b,'type':_0x27f675(0xee),'headers':_0x35dc9a,'async':![],'success':function(_0x305c58){var _0x133ed0=_0x27f675,_0x2effb1=_0x133ed0(0x153),_0x51e219,_0x571d77=GetItemTypeForListNameDetailsGroups(_0x2effb1);_0x51e219={'__metadata':{'type':_0x571d77},'PermissionStatus':_0x133ed0(0x132)},$[_0x133ed0(0xc2)](updateItemWithIDItemListDocuments(_0x2effb1,_0x51e219,_0x40f256,myCompanyUrl))['done'](function(_0x5caa6b){var _0x10ef6a=_0x133ed0;_0x3ba04c==_0x10ef6a(0x15e)?_0x385885+0x1==_0x2940a4&&alert(_0x10ef6a(0x15c)):alert(_0x10ef6a(0x15c)),$('#myModalShareHistory')[_0x10ef6a(0xfd)](_0x10ef6a(0x120));}),console[_0x133ed0(0x156)](_0x89fa43+_0x133ed0(0x103));},'error':function(_0x2384f9){var _0x470e65=_0x27f675;console[_0x470e65(0x156)](JSON['stringify'](_0x2384f9));}});}