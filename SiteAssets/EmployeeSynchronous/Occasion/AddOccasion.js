var a267_0xd265e9=a267_0x458e;(function(_0x18355f,_0x523917){var _0x57f77a=a267_0x458e,_0x5561f3=_0x18355f();while(!![]){try{var _0x4d3450=-parseInt(_0x57f77a(0x144))/0x1*(-parseInt(_0x57f77a(0x147))/0x2)+-parseInt(_0x57f77a(0x146))/0x3+-parseInt(_0x57f77a(0x12f))/0x4+-parseInt(_0x57f77a(0x156))/0x5+-parseInt(_0x57f77a(0x12c))/0x6+-parseInt(_0x57f77a(0x13d))/0x7*(-parseInt(_0x57f77a(0x14e))/0x8)+parseInt(_0x57f77a(0x12a))/0x9;if(_0x4d3450===_0x523917)break;else _0x5561f3['push'](_0x5561f3['shift']());}catch(_0xc1ed90){_0x5561f3['push'](_0x5561f3['shift']());}}}(a267_0x426a,0x6f7cd));var currentCompanyid='',getCurrentCompanySiteURL='';$(document)[a267_0xd265e9(0x11e)](function(){var _0x2a4d85=a267_0xd265e9;currentCompanyid=titanForWork['getQueryStringParameter']('CompanyId');var _0xe1b949=new Array();_0xe1b949[_0x2a4d85(0x175)](_0x2a4d85(0x15c));var _0x1df656=UserExistInProcessApprover(currentCompanyid,'',_0xe1b949);for(var _0x5911c4=0x0;_0x5911c4<_0x1df656[_0x2a4d85(0x16f)];_0x5911c4++){if(_0x1df656[_0x5911c4]['webPartName']=='Occasion')$(_0x2a4d85(0x13b))['show']();else{}}$(_0x2a4d85(0x13b))['is'](_0x2a4d85(0x134))==![]&&$('#messageNotAthorizedAcces')[_0x2a4d85(0x13e)](_0x2a4d85(0x141));$(_0x2a4d85(0x169))[_0x2a4d85(0x14f)]({'changeMonth':!![],'changeYear':!![],'yearRange':_0x2a4d85(0x166)}),$(_0x2a4d85(0x169))['datepicker'](_0x2a4d85(0x155),_0x2a4d85(0x116),_0x2a4d85(0x179));currentCompanyid!=null&&currentCompanyid!=''&&(currentCompanyid['indexOf']('#')!=-0x1&&(currentCompanyid=currentCompanyid[_0x2a4d85(0x14d)]('#')[0x0]),currentCompanyid=currentCompanyid);GetCompanyEmployees(currentCompanyid,_0x2a4d85(0x158)),$(_0x2a4d85(0x130))[_0x2a4d85(0x149)](function(){var _0x513b52=_0x2a4d85;GetCompanyEmployees($(this)[_0x513b52(0x117)](),_0x513b52(0x15e));}),$(_0x2a4d85(0x16e))['click'](function(){AddOccasion();}),$(_0x2a4d85(0x164))[_0x2a4d85(0x17f)](function(){redirectCancel();});var _0x4a4ba3=titanForWork[_0x2a4d85(0x176)]('itemId'),_0x38c120=GetSiteUrl();getCurrentCompanySiteURL=_0x38c120,BindOccasiontype(),_0x4a4ba3!=''&&_0x4a4ba3!=null&&LoadOccasions(getCurrentCompanySiteURL,_0x4a4ba3);});function BindOccasiontype(){var _0x4785bb=a267_0xd265e9;$[_0x4785bb(0x163)]({'url':_spPageContextInfo[_0x4785bb(0x173)]+'/_api/web/lists/getbytitle(\x27OccasionMaster\x27)/items?$select=OccasionDefault,OccasionLang1,OccasionLang2,OccasionLang3,OccasionLang4,OccasionLang5,OccasionLang6,OccasionLang7,OccasionLang8,OccasionLang9,OccasionLang10','type':_0x4785bb(0x122),'async':![],'headers':{'accept':_0x4785bb(0x161)},'success':function(_0x2934a8){var _0x3d6735=_0x4785bb,_0x351951=_0x2934a8['d'][_0x3d6735(0x15b)];for(var _0x34150e=0x0;_0x34150e<_0x351951[_0x3d6735(0x16f)];_0x34150e++){var _0x556c7a=_0x351951[_0x34150e][_0x3d6735(0x13c)],_0x406531=_0x351951[_0x34150e]['OccasionLang1'];$('#ddlOccasionType')[_0x3d6735(0x142)]($(_0x3d6735(0x178))[_0x3d6735(0x14a)](_0x3d6735(0x15f),_0x556c7a)['text'](_0x406531));}},'error':function(_0x10484d){var _0x1be044=_0x4785bb;alert(JSON[_0x1be044(0x120)](_0x10484d));}});}function GetDateStandardFormat(_0x5b9df5){var _0xaf097d=a267_0xd265e9,_0x5ce8ae=ConvertDateFormatToddMMyyyy(_0x5b9df5),_0x560ef3=new Date(_0x5ce8ae),_0x2f34a1=0x3c*0x3c*0x18*0x3e8,_0x3aed0a=new Date(_0x560ef3[_0xaf097d(0x174)]()),_0x3721ad=_0x3aed0a[_0xaf097d(0x162)]();return _0x3721ad;}function ConvertDateFormatToddMMyyyy(_0x50f36a){var _0xffa25a=stringToDate(_0x50f36a,'dd/MM/yyyy','/');return _0xffa25a;}function stringToDate(_0x3ba698,_0x2303ef,_0x2ac0ae){var _0x591d9b=a267_0xd265e9,_0x651bc=_0x2303ef[_0x591d9b(0x11a)](),_0x91e850=_0x651bc[_0x591d9b(0x14d)](_0x2ac0ae),_0x5df75f=_0x3ba698['split'](_0x2ac0ae),_0x5ac4e1=_0x91e850[_0x591d9b(0x125)]('mm'),_0x208da4=_0x91e850['indexOf']('dd'),_0x3c5754=_0x91e850['indexOf'](_0x591d9b(0x132)),_0x54b37d=parseInt(_0x5df75f[_0x5ac4e1]);_0x54b37d-=0x1;var _0x235d96=new Date(_0x5df75f[_0x3c5754],_0x54b37d,_0x5df75f[_0x208da4]);return _0x235d96;}function AddOccasion(){var _0x1eeef4=a267_0xd265e9,_0x2b1349=$(_0x1eeef4(0x130))['val']();if(_0x2b1349!=0x0){var _0x3dc6b5=$('#ddlOccasionType')[_0x1eeef4(0x117)](),_0x5d0462='';if($(_0x1eeef4(0x169))[_0x1eeef4(0x117)]()==''||$(_0x1eeef4(0x169))['val']()==null){alert(_0x1eeef4(0x14c));return;}else _0x5d0462=GetDateStandardFormat($(_0x1eeef4(0x169))[_0x1eeef4(0x117)]());if(_0x5d0462==''||_0x5d0462==null){alert('Please\x20select\x20Occasion\x20Date.');return;}else{var _0x5f2ce7=titanForWork[_0x1eeef4(0x176)]('itemId'),_0x78c123=$(_0x1eeef4(0x140))[_0x1eeef4(0x117)]();_0x5f2ce7==''||_0x5f2ce7==null?ValidateUserIsAlreadyExistthisOccasion(_0x3dc6b5,_0x5d0462,_0x78c123,'')==!![]?AddNewOccasionDetails(_0x2b1349,_0x3dc6b5,_0x5d0462,_0x78c123,_0x5f2ce7):alert('Occasion\x20is\x20already\x20added\x20for\x20this\x20date\x20and\x20employee.'):ValidateUserIsAlreadyExistthisOccasion(_0x3dc6b5,_0x5d0462,_0x78c123,_0x5f2ce7)==!![]?AddNewOccasionDetails(_0x2b1349,_0x3dc6b5,_0x5d0462,_0x78c123,_0x5f2ce7):alert(_0x1eeef4(0x133));}}else alert(_0x1eeef4(0x138));}function GetSiteUrl(){var _0x327be4=a267_0xd265e9,_0x448e81='',_0x468c57='';return _0x448e81=_spPageContextInfo[_0x327be4(0x173)]+_0x327be4(0x11d)+currentCompanyid+'\x27',$[_0x327be4(0x163)]({'url':_0x448e81,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x26efc2){var _0x3adabc=_0x327be4,_0x3ecc36=_0x26efc2['d'][_0x3adabc(0x15b)];_0x3ecc36[_0x3adabc(0x16f)]>0x0&&(_0x468c57=_0x3ecc36[0x0][_0x3adabc(0x17d)]);},'eror':function(_0x2d06cb){var _0x1d9835=_0x327be4;console[_0x1d9835(0x128)]('error');}}),_0x468c57;}function LoadOccasions(_0x40472a,_0x5a789d){var _0x23c237=a267_0xd265e9,_0x1be365=_0x40472a+_0x23c237(0x137)+_0x5a789d+'\x27';$['ajax']({'url':_0x1be365,'headers':{'Accept':_0x23c237(0x161)},'async':![],'success':function(_0x534c5d){var _0x394ced=_0x23c237,_0xd3b8a2=_0x534c5d['d'][_0x394ced(0x15b)];if(_0xd3b8a2['length']>0x0){$(_0x394ced(0x130))[_0x394ced(0x117)](_0xd3b8a2[0x0][_0x394ced(0x12e)]);var _0x2480bb=new Date(_0xd3b8a2[0x0][_0x394ced(0x153)]),_0x2070c4='';_0x2070c4=$['datepicker'][_0x394ced(0x154)](_0x394ced(0x179),_0x2480bb),$(_0x394ced(0x169))[_0x394ced(0x117)](_0x2070c4),$(_0x394ced(0x13a))[_0x394ced(0x117)](_0xd3b8a2[0x0][_0x394ced(0x119)]),GetCompanyEmployees(_0xd3b8a2[0x0]['EmployeeId'],_0x394ced(0x15e));}},'eror':function(_0x11c8ea){var _0x2ea66d=_0x23c237;console[_0x2ea66d(0x128)](_0x2ea66d(0x124));}});}function a267_0x426a(){var _0x167271=['done','UserName','Deferred','#btnsubmit','length','\x27)/GetItemById(\x27','charAt','department','webAbsoluteUrl','getTime','push','getQueryStringParameter','#spanarea','<option></option>','dd/mm/yy','join','Occasion\x20has\x20been\x20updated\x20successfully.','Company','SiteURL','OfficeLocation','click','dateFormat','val','\x27\x20and\x20Status\x20eq\x20\x27Active\x27','OccasionType','toLowerCase','\x27\x20and\x20UserNameId\x20eq\x20\x27','#empinformation','/_api/web/lists/getbytitle(\x27Companies\x27)/items?$select=ID,SiteURL&$filter=ID\x20eq\x20\x27','ready','Occasion\x20has\x20been\x20added\x20successfully.','stringify','href','GET','/_api/web/lists/getbytitle(\x27Employees\x27)/items?$select=','error','indexOf','hide','slice','log','resolve','11091888pPJqqX','Email','675966rpKmsm','OfficeName','EmployeeId','351572BgKQDM','#ddlemployee','show','yyyy','Occasion\x20is\x20already\x20added\x20for\x20this\x20date\x20and\x20employee.',':visible','/_api/web/lists/getbytitle(\x27OccasionDetails\x27)/items?$select=ID,UserNameId,EmployeeId,OccasionType,OccasionDate,OccasionImageURL&$top=10','\x27\x20and\x20OccasionType\x20eq\x20\x27','/_api/web/lists/getbytitle(\x27OccasionDetails\x27)/items?$select=ID,UserNameId,EmployeeId,OccasionType,OccasionDate,OccasionImageURL&$filter=ID\x20eq\x20\x27','Please\x20select\x20employee.','PATCH','#ddlOccasionType','#newOccasionbx','OccasionDefault','154595XivOKj','text','LogonName','#spanemplyeePeopleId','You\x20are\x20not\x20authorized\x20to\x20access\x20this\x20page.','append','ID,JoiningDate,DateOfAnniversary,FullName,DateOfBirth,LogonName/Title,LogonName/ID,LogonName/UserName,OfficeLocation/OfficeName,Email,Department/DepartmentName,Designation,Company/CompanyName,Company/ID,Manager,MobileNumber&$expand=LogonName,Company,Department,OfficeLocation&$filter=ID\x20eq\x20\x27','141TNpBmG','#spandepartment','2416611RxiIcc','8902sULeip','<option\x20value=\x220\x22>-Select\x20Employee-</option>','change','attr','Title','Please\x20select\x20Occasion\x20Date.','split','8hQruRC','datepicker','Department\x20:\x20','empty','reject','OccasionDate','formatDate','option','2096820XtfDNt','promise','BindDropDown','#__REQUESTDIGEST','/_api/web/lists/getbytitle(\x27','results','Occasion','\x27)/items','LoadProfile','value','SP.Data.','application/json;odata=verbose','toISOString','ajax','#btncancel','&undefinedstr=undefinedstr','-1:+0','POST','#spanEmailId','#occasiondate','ListItem'];a267_0x426a=function(){return _0x167271;};return a267_0x426a();}function AddNewOccasionDetails(_0x3a021f,_0x2269a7,_0x57e866,_0x22bec9,_0x3337d8){var _0x5d011c=a267_0xd265e9,_0x50c22d=getCurrentCompanySiteURL,_0x4e1a7a='OccasionDetails',_0x4f1b49=GetItemTypeForListNameDetails(_0x4e1a7a),_0x44b60d;_0x44b60d={'__metadata':{'type':_0x4f1b49},'EmployeeId':_0x3a021f,'OccasionType':_0x2269a7,'OccasionDate':_0x57e866,'Details':_0x2269a7,'Title':_0x2269a7,'UserNameId':parseInt(_0x22bec9)},_0x3337d8==''||_0x3337d8==null?$['when'](AddItemToList(_0x50c22d,_0x4e1a7a,_0x44b60d))['done'](function(_0x56cd78){var _0x530552=a267_0x458e;alert(_0x530552(0x11f));}):$['when'](updateItemWithID(_0x50c22d,_0x4e1a7a,_0x44b60d,parseInt(_0x3337d8)))[_0x5d011c(0x16b)](function(_0x428c22){var _0x2c4417=_0x5d011c;alert(_0x2c4417(0x17b));});}function redirectCancel(){var _0x329e53=a267_0xd265e9,_0x2c2844=titanForWork[_0x329e53(0x176)]('sourcelocation'),_0x51c7f1=titanForWork['getQueryStringParameter'](_0x329e53(0x172)),_0x16d516='';_0x51c7f1!=null&&_0x51c7f1!=''&&(_0x16d516='&DepartmentId='+_0x51c7f1);var _0x4090f1=_0x2c2844+'?WebAppId='+currentCompanyid+_0x16d516+_0x329e53(0x165);$(location)['attr'](_0x329e53(0x121),_0x4090f1);}function GetItemTypeForListNameDetails(_0x25bfa9){var _0x1262e2=a267_0xd265e9;return _0x1262e2(0x160)+_0x25bfa9[_0x1262e2(0x171)](0x0)['toUpperCase']()+_0x25bfa9['split']('\x20')[_0x1262e2(0x17a)]('')[_0x1262e2(0x127)](0x1)+_0x1262e2(0x16a);}function a267_0x458e(_0x3c7bb0,_0x24edbf){var _0x426a7b=a267_0x426a();return a267_0x458e=function(_0x458e01,_0x3cf4d1){_0x458e01=_0x458e01-0x116;var _0x2630ad=_0x426a7b[_0x458e01];return _0x2630ad;},a267_0x458e(_0x3c7bb0,_0x24edbf);}function AddItemToList(_0x194123,_0x4257f3,_0x3bae39){var _0x3c72f9=a267_0xd265e9,_0x41673f=$[_0x3c72f9(0x16d)]();return $[_0x3c72f9(0x163)]({'url':_0x194123+_0x3c72f9(0x15a)+_0x4257f3+_0x3c72f9(0x15d),'type':'POST','async':![],'headers':{'accept':_0x3c72f9(0x161),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x3c72f9(0x117)](),'content-Type':_0x3c72f9(0x161)},'data':JSON[_0x3c72f9(0x120)](_0x3bae39),'success':function(_0x24dbcc){var _0x1a0652=_0x3c72f9;_0x41673f[_0x1a0652(0x129)](_0x24dbcc);},'error':function(_0x3862ac){var _0x329ee8=_0x3c72f9;alert(JSON[_0x329ee8(0x120)](_0x3862ac)),_0x41673f[_0x329ee8(0x152)](_0x3862ac);}}),_0x41673f[_0x3c72f9(0x157)]();}function updateItemWithID(_0x4a9bbd,_0x1748b6,_0x11c517,_0x4293ce){var _0x949bc4=a267_0xd265e9,_0x1b69bf=$['Deferred']();return $['ajax']({'url':_0x4a9bbd+_0x949bc4(0x15a)+_0x1748b6+_0x949bc4(0x170)+_0x4293ce+'\x27)','type':_0x949bc4(0x167),'headers':{'accept':_0x949bc4(0x161),'X-RequestDigest':$(_0x949bc4(0x159))[_0x949bc4(0x117)](),'content-Type':'application/json;odata=verbose','X-Http-Method':_0x949bc4(0x139),'If-Match':'*'},'data':JSON[_0x949bc4(0x120)](_0x11c517),'async':![],'success':function(_0xbe816d){_0x1b69bf['resolve'](!![]);},'error':function(_0x22ba1a){var _0x1e69ad=_0x949bc4;alert(JSON['stringify'](_0x22ba1a)),_0x1b69bf[_0x1e69ad(0x152)](_0x22ba1a);}}),_0x1b69bf['promise']();}function GetCompanyEmployees(_0x1ded9b,_0xa140c8){var _0x2fb52a=a267_0xd265e9,_0x50ddfa='';_0xa140c8==_0x2fb52a(0x158)&&($(_0x2fb52a(0x130))[_0x2fb52a(0x151)]()[_0x2fb52a(0x142)](_0x2fb52a(0x148)),_0x50ddfa='ID,LogonName/Title,LogonName/UserName,CompanyId&$expand=LogonName&$filter=CompanyId\x20eq\x20\x27'+_0x1ded9b+'\x27\x20and\x20Status\x20eq\x20\x27Active\x27');_0xa140c8==_0x2fb52a(0x15e)&&(_0x50ddfa=_0x2fb52a(0x143)+_0x1ded9b+_0x2fb52a(0x118));var _0x4d0f5b=_spPageContextInfo[_0x2fb52a(0x173)]+_0x2fb52a(0x123)+_0x50ddfa;$['ajax']({'url':_0x4d0f5b,'headers':{'Accept':_0x2fb52a(0x161)},'async':![],'success':function(_0x25c33b){var _0x10df18=_0x2fb52a,_0xc1f701=_0x25c33b['d']['results'];_0xc1f701[_0x10df18(0x16f)]==0x0&&$(_0x10df18(0x11c))[_0x10df18(0x126)]();for(var _0x3f00ff=0x0;_0x3f00ff<_0xc1f701[_0x10df18(0x16f)];_0x3f00ff++){if(_0xa140c8=='BindDropDown'){var _0x4c8740=_0xc1f701[_0x3f00ff][_0x10df18(0x13f)][_0x10df18(0x14b)];(_0x4c8740==null||_0x4c8740=='')&&(_0x4c8740='');var _0x386769=_0xc1f701[_0x3f00ff]['ID'];$(_0x10df18(0x130))['append']($(_0x10df18(0x178))[_0x10df18(0x14a)](_0x10df18(0x15f),_0x386769)[_0x10df18(0x13e)](_0x4c8740));}if(_0xa140c8==_0x10df18(0x15e)){$(_0x10df18(0x11c))[_0x10df18(0x131)]();var _0x4c8740=_0xc1f701[_0x3f00ff][_0x10df18(0x13f)][_0x10df18(0x14b)];(_0x4c8740==null||_0x4c8740=='')&&(_0x4c8740='');var _0x5d8c6e=_0xc1f701[_0x3f00ff][_0x10df18(0x13f)][_0x10df18(0x16c)];(_0x5d8c6e==null||_0x5d8c6e=='')&&(_0x5d8c6e='');var _0xfa2932=_0xc1f701[_0x3f00ff][_0x10df18(0x12b)];(_0xfa2932==null||_0xfa2932=='')&&(_0xfa2932='');var _0x27b7c0=_0xc1f701[_0x3f00ff][_0x10df18(0x13f)]['ID'];$(_0x10df18(0x140))[_0x10df18(0x117)](_0x27b7c0),$(_0x10df18(0x168))[_0x10df18(0x13e)](_0xfa2932);var _0x83d47=_0xc1f701[_0x3f00ff]['Department']['DepartmentName'];(_0x83d47==null||_0x83d47=='')&&(_0x83d47='');$(_0x10df18(0x145))[_0x10df18(0x13e)](_0x10df18(0x150)+_0x83d47);var _0x1b7633=_0xc1f701[_0x3f00ff]['Designation'];(_0x1b7633==null||_0x1b7633=='')&&(_0x1b7633='');$('#spandesination')[_0x10df18(0x13e)](_0x1b7633);var _0x2f9183=_0xc1f701[_0x3f00ff][_0x10df18(0x17c)]['CompanyName'];(_0x2f9183==null||_0x2f9183=='')&&(_0x2f9183='');var _0x136076=_0xc1f701[_0x3f00ff]['Manager'];(_0x136076==null||_0x136076=='')&&(_0x136076='');var _0x5eee9d=_0xc1f701[_0x3f00ff]['MobileNumber'];(_0x5eee9d==null||_0x5eee9d=='')&&(_0x5eee9d='');var _0x492dc9=_0xc1f701[_0x3f00ff][_0x10df18(0x17e)][_0x10df18(0x12d)];(_0x492dc9==null||_0x492dc9=='')&&(_0x492dc9=''),$(_0x10df18(0x177))[_0x10df18(0x13e)](_0x492dc9);}}},'eror':function(_0x126f55){var _0x1f9236=_0x2fb52a;console[_0x1f9236(0x128)](_0x1f9236(0x124));}});}function ValidateUserIsAlreadyExistthisOccasion(_0x2bc717,_0x55382b,_0x18a03f,_0x4b6ed8){var _0x753302=a267_0xd265e9,_0x3e3fe5=!![],_0x352b45='';_0x352b45='&$filter=OccasionDate\x20eq\x20\x27'+_0x55382b+_0x753302(0x11b)+_0x18a03f+_0x753302(0x136)+_0x2bc717+'\x27';var _0x587d64=getCurrentCompanySiteURL+_0x753302(0x135)+_0x352b45;return $['ajax']({'url':_0x587d64,'headers':{'Accept':_0x753302(0x161)},'async':![],'success':function(_0x4029d2){var _0x350e36=_0x753302,_0x11465f=_0x4029d2['d'][_0x350e36(0x15b)];if(_0x11465f[_0x350e36(0x16f)]>0x0)for(var _0xc95909=0x0;_0xc95909<_0x11465f[_0x350e36(0x16f)];_0xc95909++){_0x11465f[_0xc95909]['ID']!=_0x4b6ed8&&(_0x3e3fe5=![]);}},'eror':function(_0x2f0ada){var _0x59b42a=_0x753302;console[_0x59b42a(0x128)](_0x59b42a(0x124));}}),_0x3e3fe5;}