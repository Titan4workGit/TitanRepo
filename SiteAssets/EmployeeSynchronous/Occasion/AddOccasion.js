var _0x46dfb9=_0x326c;(function(_0x45364c,_0x4e31be){var _0x51bf96=_0x326c,_0x290dc4=_0x45364c();while(!![]){try{var _0x2645dd=parseInt(_0x51bf96(0xf7))/0x1*(parseInt(_0x51bf96(0x149))/0x2)+parseInt(_0x51bf96(0x13a))/0x3+parseInt(_0x51bf96(0x10a))/0x4+parseInt(_0x51bf96(0xef))/0x5+parseInt(_0x51bf96(0x13f))/0x6+-parseInt(_0x51bf96(0x131))/0x7+-parseInt(_0x51bf96(0x101))/0x8;if(_0x2645dd===_0x4e31be)break;else _0x290dc4['push'](_0x290dc4['shift']());}catch(_0x52bd96){_0x290dc4['push'](_0x290dc4['shift']());}}}(_0x38e7,0xd2a99));var currentCompanyid='',getCurrentCompanySiteURL='';$(document)[_0x46dfb9(0xfe)](function(){var _0x180949=_0x46dfb9;currentCompanyid=titanForWork[_0x180949(0xe9)](_0x180949(0xfd));var _0x77a742=new Array();_0x77a742[_0x180949(0x11b)]('Occasion');var _0x410bdd=UserExistInProcessApprover(currentCompanyid,'',_0x77a742);for(var _0x3bdcca=0x0;_0x3bdcca<_0x410bdd[_0x180949(0x14c)];_0x3bdcca++){if(_0x410bdd[_0x3bdcca][_0x180949(0x107)]=='Occasion')$(_0x180949(0xf4))[_0x180949(0x10c)]();else{}}$(_0x180949(0xf4))['is'](':visible')==![]&&$(_0x180949(0x135))['text'](_0x180949(0x152));$(_0x180949(0x13c))[_0x180949(0x109)]({'changeMonth':!![],'changeYear':!![],'yearRange':_0x180949(0x117)}),$(_0x180949(0x13c))[_0x180949(0x109)](_0x180949(0xf5),_0x180949(0x123),_0x180949(0x148));currentCompanyid!=null&&currentCompanyid!=''&&(currentCompanyid[_0x180949(0xed)]('#')!=-0x1&&(currentCompanyid=currentCompanyid[_0x180949(0x12d)]('#')[0x0]),currentCompanyid=currentCompanyid);GetCompanyEmployees(currentCompanyid,_0x180949(0x104)),$(_0x180949(0xf2))[_0x180949(0x120)](function(){var _0x2d53c2=_0x180949;GetCompanyEmployees($(this)[_0x2d53c2(0x146)](),_0x2d53c2(0x140));}),$(_0x180949(0x118))['click'](function(){AddOccasion();}),$(_0x180949(0xfa))[_0x180949(0x103)](function(){redirectCancel();});var _0x5a17b8=titanForWork[_0x180949(0xe9)]('itemId'),_0x204530=GetSiteUrl();getCurrentCompanySiteURL=_0x204530,BindOccasiontype(),_0x5a17b8!=''&&_0x5a17b8!=null&&LoadOccasions(getCurrentCompanySiteURL,_0x5a17b8);});function BindOccasiontype(){var _0x4452b3=_0x46dfb9;$['ajax']({'url':_spPageContextInfo[_0x4452b3(0xfc)]+_0x4452b3(0xeb),'type':_0x4452b3(0x125),'async':![],'headers':{'accept':_0x4452b3(0xf6)},'success':function(_0x46c107){var _0x6274fe=_0x4452b3,_0x5d21f5=_0x46c107['d'][_0x6274fe(0x150)];for(var _0x4784c9=0x0;_0x4784c9<_0x5d21f5['length'];_0x4784c9++){var _0x39d480=_0x5d21f5[_0x4784c9][_0x6274fe(0x112)],_0x331e9f=_0x5d21f5[_0x4784c9][_0x6274fe(0x12b)];$('#ddlOccasionType')['append']($(_0x6274fe(0x13b))[_0x6274fe(0x141)]('value',_0x39d480)[_0x6274fe(0x143)](_0x331e9f));}},'error':function(_0x48b7c9){var _0x49cd60=_0x4452b3;alert(JSON[_0x49cd60(0x13d)](_0x48b7c9));}});}function GetDateStandardFormat(_0x51c555){var _0x3b5605=_0x46dfb9,_0x26da83=ConvertDateFormatToddMMyyyy(_0x51c555),_0x25ea1a=new Date(_0x26da83),_0x55cb05=0x3c*0x3c*0x18*0x3e8,_0x24d927=new Date(_0x25ea1a[_0x3b5605(0xff)]()),_0x4bdb7d=_0x24d927[_0x3b5605(0x113)]();return _0x4bdb7d;}function ConvertDateFormatToddMMyyyy(_0x4f3471){var _0x26aa58=_0x46dfb9,_0x590d38=stringToDate(_0x4f3471,_0x26aa58(0x108),'/');return _0x590d38;}function stringToDate(_0x206797,_0x3e5f00,_0x448a28){var _0x90c48f=_0x46dfb9,_0x35e67c=_0x3e5f00[_0x90c48f(0x134)](),_0x22d7a0=_0x35e67c['split'](_0x448a28),_0x35de33=_0x206797[_0x90c48f(0x12d)](_0x448a28),_0x138bcc=_0x22d7a0['indexOf']('mm'),_0x184758=_0x22d7a0['indexOf']('dd'),_0x2865d1=_0x22d7a0[_0x90c48f(0xed)](_0x90c48f(0x10e)),_0x6861e=parseInt(_0x35de33[_0x138bcc]);_0x6861e-=0x1;var _0x3add15=new Date(_0x35de33[_0x2865d1],_0x6861e,_0x35de33[_0x184758]);return _0x3add15;}function AddOccasion(){var _0xd99722=_0x46dfb9,_0xee1f96=$('#ddlemployee')['val']();if(_0xee1f96!=0x0){var _0x4b7c11=$(_0xd99722(0x12e))[_0xd99722(0x146)](),_0x544561='';if($(_0xd99722(0x13c))[_0xd99722(0x146)]()==''||$(_0xd99722(0x13c))['val']()==null){alert(_0xd99722(0x145));return;}else _0x544561=GetDateStandardFormat($(_0xd99722(0x13c))['val']());if(_0x544561==''||_0x544561==null){alert(_0xd99722(0x145));return;}else{var _0x3939a7=titanForWork[_0xd99722(0xe9)]('itemId'),_0x275ebb=$(_0xd99722(0x133))['val']();_0x3939a7==''||_0x3939a7==null?ValidateUserIsAlreadyExistthisOccasion(_0x4b7c11,_0x544561,_0x275ebb,'')==!![]?AddNewOccasionDetails(_0xee1f96,_0x4b7c11,_0x544561,_0x275ebb,_0x3939a7):alert('Occasion\x20is\x20already\x20added\x20for\x20this\x20date\x20and\x20employee.'):ValidateUserIsAlreadyExistthisOccasion(_0x4b7c11,_0x544561,_0x275ebb,_0x3939a7)==!![]?AddNewOccasionDetails(_0xee1f96,_0x4b7c11,_0x544561,_0x275ebb,_0x3939a7):alert('Occasion\x20is\x20already\x20added\x20for\x20this\x20date\x20and\x20employee.');}}else alert(_0xd99722(0x10f));}function GetSiteUrl(){var _0x479a76=_0x46dfb9,_0x46eba8='',_0x3433b8='';return _0x46eba8=_spPageContextInfo[_0x479a76(0xfc)]+'/_api/web/lists/getbytitle(\x27Companies\x27)/items?$select=ID,SiteURL&$filter=ID\x20eq\x20\x27'+currentCompanyid+'\x27',$[_0x479a76(0x111)]({'url':_0x46eba8,'headers':{'Accept':_0x479a76(0xf6)},'async':![],'success':function(_0x1924ef){var _0x3a7d65=_0x479a76,_0x2ad4fa=_0x1924ef['d'][_0x3a7d65(0x150)];_0x2ad4fa['length']>0x0&&(_0x3433b8=_0x2ad4fa[0x0][_0x3a7d65(0x144)]);},'eror':function(_0x57ed25){var _0x53839e=_0x479a76;console[_0x53839e(0x122)]('error');}}),_0x3433b8;}function LoadOccasions(_0x3c9401,_0x4f4b1d){var _0x2925db=_0x46dfb9,_0x2bd05c=_0x3c9401+'/_api/web/lists/getbytitle(\x27OccasionDetails\x27)/items?$select=ID,UserNameId,EmployeeId,OccasionType,OccasionDate,OccasionImageURL&$filter=ID\x20eq\x20\x27'+_0x4f4b1d+'\x27';$[_0x2925db(0x111)]({'url':_0x2bd05c,'headers':{'Accept':_0x2925db(0xf6)},'async':![],'success':function(_0x18ee6a){var _0x35e8ac=_0x2925db,_0x44f83e=_0x18ee6a['d']['results'];if(_0x44f83e[_0x35e8ac(0x14c)]>0x0){$('#ddlemployee')[_0x35e8ac(0x146)](_0x44f83e[0x0]['EmployeeId']);var _0x248c07=new Date(_0x44f83e[0x0]['OccasionDate']),_0x1c15a7='';_0x1c15a7=$['datepicker']['formatDate'](_0x35e8ac(0x148),_0x248c07),$(_0x35e8ac(0x13c))['val'](_0x1c15a7),$(_0x35e8ac(0x12e))[_0x35e8ac(0x146)](_0x44f83e[0x0][_0x35e8ac(0x14a)]),GetCompanyEmployees(_0x44f83e[0x0][_0x35e8ac(0x127)],'LoadProfile');}},'eror':function(_0x3eae15){var _0x5ef3b2=_0x2925db;console[_0x5ef3b2(0x122)](_0x5ef3b2(0xf3));}});}function AddNewOccasionDetails(_0x50883c,_0x3bca79,_0x1f34fe,_0x1d9f22,_0x1cbd25){var _0x54d83e=_0x46dfb9,_0x3b7198=getCurrentCompanySiteURL,_0x397eec='OccasionDetails',_0x33c442=GetItemTypeForListNameDetails(_0x397eec),_0x9921e7;_0x9921e7={'__metadata':{'type':_0x33c442},'EmployeeId':_0x50883c,'OccasionType':_0x3bca79,'OccasionDate':_0x1f34fe,'Details':_0x3bca79,'Title':_0x3bca79,'UserNameId':parseInt(_0x1d9f22)},_0x1cbd25==''||_0x1cbd25==null?$[_0x54d83e(0x11a)](AddItemToList(_0x3b7198,_0x397eec,_0x9921e7))[_0x54d83e(0xea)](function(_0xbb466c){alert('Occasion\x20has\x20been\x20added\x20successfully.');}):$['when'](updateItemWithID(_0x3b7198,_0x397eec,_0x9921e7,parseInt(_0x1cbd25)))[_0x54d83e(0xea)](function(_0x5494cc){var _0x59cc5b=_0x54d83e;alert(_0x59cc5b(0x147));});}function redirectCancel(){var _0x409ede=_0x46dfb9,_0x52769e=titanForWork['getQueryStringParameter']('sourcelocation'),_0x2964b1=titanForWork['getQueryStringParameter']('department'),_0x2c529d='';_0x2964b1!=null&&_0x2964b1!=''&&(_0x2c529d=_0x409ede(0x129)+_0x2964b1);var _0x4198df=_0x52769e+_0x409ede(0x12a)+currentCompanyid+_0x2c529d+_0x409ede(0xf1);$(location)[_0x409ede(0x141)](_0x409ede(0x11c),_0x4198df);}function GetItemTypeForListNameDetails(_0x156327){var _0x5bbf8a=_0x46dfb9;return _0x5bbf8a(0x12f)+_0x156327[_0x5bbf8a(0x14d)](0x0)[_0x5bbf8a(0x132)]()+_0x156327[_0x5bbf8a(0x12d)]('\x20')[_0x5bbf8a(0xee)]('')[_0x5bbf8a(0x142)](0x1)+_0x5bbf8a(0x119);}function _0x326c(_0x1ac444,_0x51bc92){var _0x38e7a2=_0x38e7();return _0x326c=function(_0x326cc2,_0x5e03da){_0x326cc2=_0x326cc2-0xe9;var _0x1f5e0e=_0x38e7a2[_0x326cc2];return _0x1f5e0e;},_0x326c(_0x1ac444,_0x51bc92);}function AddItemToList(_0x27394d,_0x2c0e7c,_0x4c9682){var _0x15ed83=_0x46dfb9,_0x31b5de=$[_0x15ed83(0x110)]();return $['ajax']({'url':_0x27394d+'/_api/web/lists/getbytitle(\x27'+_0x2c0e7c+_0x15ed83(0x11f),'type':'POST','async':![],'headers':{'accept':_0x15ed83(0xf6),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x15ed83(0x146)](),'content-Type':_0x15ed83(0xf6)},'data':JSON['stringify'](_0x4c9682),'success':function(_0xc0a5c7){var _0x2037dc=_0x15ed83;_0x31b5de[_0x2037dc(0x10d)](_0xc0a5c7);},'error':function(_0x147777){var _0x5a3a49=_0x15ed83;alert(JSON[_0x5a3a49(0x13d)](_0x147777)),_0x31b5de[_0x5a3a49(0x10b)](_0x147777);}}),_0x31b5de[_0x15ed83(0x12c)]();}function updateItemWithID(_0x48f786,_0x526407,_0x4be2f8,_0x560006){var _0x81eb97=_0x46dfb9,_0x3625e3=$['Deferred']();return $[_0x81eb97(0x111)]({'url':_0x48f786+_0x81eb97(0xf9)+_0x526407+_0x81eb97(0xf0)+_0x560006+'\x27)','type':'POST','headers':{'accept':_0x81eb97(0xf6),'X-RequestDigest':$(_0x81eb97(0x11e))['val'](),'content-Type':_0x81eb97(0xf6),'X-Http-Method':_0x81eb97(0xfb),'If-Match':'*'},'data':JSON[_0x81eb97(0x13d)](_0x4be2f8),'async':![],'success':function(_0x6dcba2){var _0x493259=_0x81eb97;_0x3625e3[_0x493259(0x10d)](!![]);},'error':function(_0x1500c4){var _0x580376=_0x81eb97;alert(JSON[_0x580376(0x13d)](_0x1500c4)),_0x3625e3[_0x580376(0x10b)](_0x1500c4);}}),_0x3625e3[_0x81eb97(0x12c)]();}function GetCompanyEmployees(_0x4c5347,_0x40c531){var _0x71d43b=_0x46dfb9,_0x291319='';_0x40c531==_0x71d43b(0x104)&&($(_0x71d43b(0xf2))[_0x71d43b(0x136)]()[_0x71d43b(0xf8)](_0x71d43b(0x14f)),_0x291319='ID,LogonName/Title,LogonName/UserName,CompanyId&$expand=LogonName&$filter=CompanyId\x20eq\x20\x27'+_0x4c5347+'\x27\x20and\x20Status\x20eq\x20\x27Active\x27');_0x40c531==_0x71d43b(0x140)&&(_0x291319=_0x71d43b(0x105)+_0x4c5347+_0x71d43b(0x14e));var _0x554234=_spPageContextInfo[_0x71d43b(0xfc)]+'/_api/web/lists/getbytitle(\x27Employees\x27)/items?$select='+_0x291319;$[_0x71d43b(0x111)]({'url':_0x554234,'headers':{'Accept':_0x71d43b(0xf6)},'async':![],'success':function(_0x174fcc){var _0x38fa5c=_0x71d43b,_0x27e36f=_0x174fcc['d'][_0x38fa5c(0x150)];_0x27e36f['length']==0x0&&$('#empinformation')['hide']();for(var _0x2cb62f=0x0;_0x2cb62f<_0x27e36f[_0x38fa5c(0x14c)];_0x2cb62f++){if(_0x40c531==_0x38fa5c(0x104)){var _0x15b15e=_0x27e36f[_0x2cb62f][_0x38fa5c(0x124)]['Title'];(_0x15b15e==null||_0x15b15e=='')&&(_0x15b15e='');var _0x414a4b=_0x27e36f[_0x2cb62f]['ID'];$('#ddlemployee')[_0x38fa5c(0xf8)]($(_0x38fa5c(0x13b))[_0x38fa5c(0x141)]('value',_0x414a4b)[_0x38fa5c(0x143)](_0x15b15e));}if(_0x40c531=='LoadProfile'){$(_0x38fa5c(0x115))[_0x38fa5c(0x10c)]();var _0x15b15e=_0x27e36f[_0x2cb62f][_0x38fa5c(0x124)]['Title'];(_0x15b15e==null||_0x15b15e=='')&&(_0x15b15e='');var _0x4f6049=_0x27e36f[_0x2cb62f]['LogonName'][_0x38fa5c(0x102)];(_0x4f6049==null||_0x4f6049=='')&&(_0x4f6049='');var _0x2ca0bc=_0x27e36f[_0x2cb62f][_0x38fa5c(0xec)];(_0x2ca0bc==null||_0x2ca0bc=='')&&(_0x2ca0bc='');var _0x3965b0=_0x27e36f[_0x2cb62f][_0x38fa5c(0x124)]['ID'];$(_0x38fa5c(0x133))[_0x38fa5c(0x146)](_0x3965b0),$(_0x38fa5c(0x13e))[_0x38fa5c(0x143)](_0x2ca0bc);var _0x4634dc=_0x27e36f[_0x2cb62f][_0x38fa5c(0x151)][_0x38fa5c(0x106)];(_0x4634dc==null||_0x4634dc=='')&&(_0x4634dc='');$(_0x38fa5c(0x114))[_0x38fa5c(0x143)](_0x38fa5c(0x121)+_0x4634dc);var _0x5479d4=_0x27e36f[_0x2cb62f][_0x38fa5c(0x139)];(_0x5479d4==null||_0x5479d4=='')&&(_0x5479d4='');$(_0x38fa5c(0x126))[_0x38fa5c(0x143)](_0x5479d4);var _0x183117=_0x27e36f[_0x2cb62f][_0x38fa5c(0x137)][_0x38fa5c(0x100)];(_0x183117==null||_0x183117=='')&&(_0x183117='');var _0xba9cd3=_0x27e36f[_0x2cb62f][_0x38fa5c(0x14b)];(_0xba9cd3==null||_0xba9cd3=='')&&(_0xba9cd3='');var _0x1ad06d=_0x27e36f[_0x2cb62f][_0x38fa5c(0x116)];(_0x1ad06d==null||_0x1ad06d=='')&&(_0x1ad06d='');var _0x15b289=_0x27e36f[_0x2cb62f][_0x38fa5c(0x128)]['OfficeName'];(_0x15b289==null||_0x15b289=='')&&(_0x15b289=''),$(_0x38fa5c(0x138))['text'](_0x15b289);}}},'eror':function(_0x52bdd5){var _0x12e6bb=_0x71d43b;console[_0x12e6bb(0x122)](_0x12e6bb(0xf3));}});}function ValidateUserIsAlreadyExistthisOccasion(_0x3a6c24,_0x1028ce,_0x467fce,_0x150499){var _0x2a8f52=_0x46dfb9,_0x1f5399=!![],_0x1fa4cd='';_0x1fa4cd='&$filter=OccasionDate\x20eq\x20\x27'+_0x1028ce+_0x2a8f52(0x11d)+_0x467fce+'\x27\x20and\x20OccasionType\x20eq\x20\x27'+_0x3a6c24+'\x27';var _0x206786=getCurrentCompanySiteURL+_0x2a8f52(0x130)+_0x1fa4cd;return $[_0x2a8f52(0x111)]({'url':_0x206786,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x482ddf){var _0x54c686=_0x2a8f52,_0x29a890=_0x482ddf['d'][_0x54c686(0x150)];if(_0x29a890[_0x54c686(0x14c)]>0x0)for(var _0x8df4dc=0x0;_0x8df4dc<_0x29a890[_0x54c686(0x14c)];_0x8df4dc++){_0x29a890[_0x8df4dc]['ID']!=_0x150499&&(_0x1f5399=![]);}},'eror':function(_0xa0a1b0){var _0x345356=_0x2a8f52;console[_0x345356(0x122)](_0x345356(0xf3));}}),_0x1f5399;}function _0x38e7(){var _0x3bf60e=['\x27)/items','change','Department\x20:\x20','log','dateFormat','LogonName','GET','#spandesination','EmployeeId','OfficeLocation','&DepartmentId=','?WebAppId=','OccasionLang1','promise','split','#ddlOccasionType','SP.Data.','/_api/web/lists/getbytitle(\x27OccasionDetails\x27)/items?$select=ID,UserNameId,EmployeeId,OccasionType,OccasionDate,OccasionImageURL&$top=10','7546007MFLgGT','toUpperCase','#spanemplyeePeopleId','toLowerCase','#messageNotAthorizedAcces','empty','Company','#spanarea','Designation','311979VXzIgM','<option></option>','#occasiondate','stringify','#spanEmailId','3667212BRUNaI','LoadProfile','attr','slice','text','SiteURL','Please\x20select\x20Occasion\x20Date.','val','Occasion\x20has\x20been\x20updated\x20successfully.','dd/mm/yy','788EDamig','OccasionType','Manager','length','charAt','\x27\x20and\x20Status\x20eq\x20\x27Active\x27','<option\x20value=\x220\x22>-Select\x20Employee-</option>','results','Department','You\x20are\x20not\x20authorized\x20to\x20access\x20this\x20page.','getQueryStringParameter','done','/_api/web/lists/getbytitle(\x27OccasionMaster\x27)/items?$select=OccasionDefault,OccasionLang1,OccasionLang2,OccasionLang3,OccasionLang4,OccasionLang5,OccasionLang6,OccasionLang7,OccasionLang8,OccasionLang9,OccasionLang10','Email','indexOf','join','3892085cVsINy','\x27)/GetItemById(\x27','&undefinedstr=undefinedstr','#ddlemployee','error','#newOccasionbx','option','application/json;odata=verbose','3594yUHAQH','append','/_api/web/lists/getbytitle(\x27','#btncancel','PATCH','webAbsoluteUrl','CompanyId','ready','getTime','CompanyName','11697424CNFWud','UserName','click','BindDropDown','ID,JoiningDate,DateOfAnniversary,FullName,DateOfBirth,LogonName/Title,LogonName/ID,LogonName/UserName,OfficeLocation/OfficeName,Email,Department/DepartmentName,Designation,Company/CompanyName,Company/ID,Manager,MobileNumber&$expand=LogonName,Company,Department,OfficeLocation&$filter=ID\x20eq\x20\x27','DepartmentName','webPartName','dd/MM/yyyy','datepicker','1973616krbuCA','reject','show','resolve','yyyy','Please\x20select\x20employee.','Deferred','ajax','OccasionDefault','toISOString','#spandepartment','#empinformation','MobileNumber','-1:+0','#btnsubmit','ListItem','when','push','href','\x27\x20and\x20UserNameId\x20eq\x20\x27','#__REQUESTDIGEST'];_0x38e7=function(){return _0x3bf60e;};return _0x38e7();}