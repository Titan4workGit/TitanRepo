var a252_0x346f9d=a252_0x5c6e;(function(_0x59f9ff,_0x3a1f40){var _0x46a2c6=a252_0x5c6e,_0x30cae6=_0x59f9ff();while(!![]){try{var _0x4192ed=parseInt(_0x46a2c6(0x24c))/0x1+parseInt(_0x46a2c6(0x22f))/0x2+-parseInt(_0x46a2c6(0x296))/0x3+-parseInt(_0x46a2c6(0x28e))/0x4*(-parseInt(_0x46a2c6(0x201))/0x5)+-parseInt(_0x46a2c6(0x220))/0x6+-parseInt(_0x46a2c6(0x269))/0x7+parseInt(_0x46a2c6(0x245))/0x8;if(_0x4192ed===_0x3a1f40)break;else _0x30cae6['push'](_0x30cae6['shift']());}catch(_0x1e3190){_0x30cae6['push'](_0x30cae6['shift']());}}}(a252_0x4c26,0x7352a));var currentCompanyid='',contributersGroupId='';$(document)['ready'](function(){var _0x111b8e=a252_0x5c6e;WaitMessage(),$('[data-toggle=\x22tooltip\x22]')['tooltip'](),currentCompanyid=titanForWork[_0x111b8e(0x26b)](_0x111b8e(0x1f4)),GetGroupIDByGroupName(),currentCompanyid!=null&&currentCompanyid!=''&&(currentCompanyid['indexOf']('#')!=-0x1&&(currentCompanyid=currentCompanyid[_0x111b8e(0x27f)]('#')[0x0]),currentCompanyid=currentCompanyid),$('#idsynch')['prop'](_0x111b8e(0x295),'../Pages/EmployeeSynchronous.aspx?WebAppId='+currentCompanyid),GetOfficeLocation('No'),GetEmployeeList(0x0),GetCompanies(),GetDepartment(0x0),$(_0x111b8e(0x223))[_0x111b8e(0x275)](function(){var _0x59c68a=_0x111b8e;parseInt($('#ddlTempCompany')[_0x59c68a(0x224)]())==0x0||parseInt($(_0x59c68a(0x2a1))[_0x59c68a(0x224)]())==0x0||parseInt($('#ddlTempOfficeLocation')[_0x59c68a(0x224)]())==0x0?alert(_0x59c68a(0x209)):ValidationCheckBox()==!![]?ValidationLicencedCheckBox()==!![]&&(WaitMessage(),$[_0x59c68a(0x1ef)](AddEmployeeData())[_0x59c68a(0x211)](function(_0x1ae66d){GetEmployeeList(0x1),GetCompanies(),GetOfficeLocation('No'),GetDepartment(0x0),$('#query')['val']('');})):alert(_0x59c68a(0x2a2));}),$('#btnEmpUpdate')[_0x111b8e(0x275)](function(){var _0xad4037=_0x111b8e;ValidationCheckBox()==![]?alert('Please\x20select\x20at\x20least\x20one\x20record\x20from\x20list.'):(WaitMessage(),$[_0xad4037(0x1ef)](UpdateEmployeeData())[_0xad4037(0x211)](function(_0x4bd81b){var _0x5536b0=_0xad4037;GetEmployeeList(0x1),GetCompanies(),GetOfficeLocation('No'),GetDepartment(0x0),$(_0x5536b0(0x21f))[_0x5536b0(0x224)]('');}));}),PageLoad(),$(_0x111b8e(0x221))['click'](function(){}),keyWordSearch(),$(_0x111b8e(0x255))[_0x111b8e(0x28c)](function(){var _0x5a5d7a=_0x111b8e;GetDepartment($(this)['val']()),GetOfficeLocation($(this)[_0x5a5d7a(0x224)]());}),setTimeout(function(){CloseWaitDialog();},0x4e20);});function keyWordSearch(){var _0x549ffb=a252_0x5c6e;$(_0x549ffb(0x268))['on'](_0x549ffb(0x21d),function(){var _0x38f1a1=_0x549ffb,_0x36b5d6=$(this)[_0x38f1a1(0x224)](),_0x5a1d1d=new RegExp(_0x36b5d6,'i');$(_0x38f1a1(0x2a3))[_0x38f1a1(0x23c)]('tr')[_0x38f1a1(0x244)](function(){var _0x5ae4e1=_0x38f1a1;!($(this)[_0x5ae4e1(0x23c)]('td')['text']()[_0x5ae4e1(0x239)](_0x5a1d1d)>=0x0)&&$(this)[_0x5ae4e1(0x237)](_0x5ae4e1(0x274))['hide'](),$(this)['find']('td')[_0x5ae4e1(0x297)]()['search'](_0x5a1d1d)>=0x0&&$(this)[_0x5ae4e1(0x273)]();});});}function GetGroupIDByGroupName(){var _0x3b7674=a252_0x5c6e,_0x1f5319=_spPageContextInfo[_0x3b7674(0x2b1)]+_0x3b7674(0x280);$[_0x3b7674(0x2ac)]({'url':_0x1f5319,'method':_0x3b7674(0x1ee),'async':![],'headers':{'Accept':'application/json;\x20odata=verbose'},'success':function(_0x2992f2){contributersGroupId=_0x2992f2['d']['Id'];},'error':function(_0x313b7e){console['log'](_0x313b7e);}});}function AddUserinSharePointGroup(_0x1d18d0){var _0x506eb9=a252_0x5c6e,_0x376ef9=_spPageContextInfo[_0x506eb9(0x2b1)]+_0x506eb9(0x1f1)+contributersGroupId+_0x506eb9(0x227);$[_0x506eb9(0x2ac)]({'url':_0x376ef9,'type':'POST','async':![],'data':JSON[_0x506eb9(0x28b)]({'__metadata':{'type':_0x506eb9(0x1f2)},'LoginName':_0x1d18d0}),'headers':{'accept':'application/json;odata=verbose','content-type':_0x506eb9(0x285),'X-RequestDigest':$(_0x506eb9(0x232))[_0x506eb9(0x224)]()},'success':_0x1f93f5,'error':_0x3945a7});function _0x1f93f5(_0x182fbd){var _0x2a710c=_0x506eb9;console[_0x2a710c(0x22c)]('User\x20Added');}function _0x3945a7(_0x106272){var _0x22e2f9=_0x506eb9;console[_0x22e2f9(0x22c)](JSON[_0x22e2f9(0x28b)](_0x106272));}}function UpdateEmployeeData(){var _0x561d2f=a252_0x5c6e,_0x40a142=$(_0x561d2f(0x2af))['length'];return $(_0x561d2f(0x2af))[_0x561d2f(0x244)](function(_0x565741){var _0x4a289d=_0x561d2f,_0x27682d=$(this)['is'](_0x4a289d(0x26a));if(_0x27682d==!![]){var _0x591bfa=$(this)['find'](_0x4a289d(0x26e))['prop']('checked');if(_0x591bfa==!![]){var _0x467b50=$(this)[_0x4a289d(0x23c)](_0x4a289d(0x26e))['val'](),_0x9018bd=$(this)['find']('td')[0x1][_0x4a289d(0x27c)],_0x1351c8=$(this)[_0x4a289d(0x23c)]('td')[0x2][_0x4a289d(0x27c)],_0x51172d=$(this)[_0x4a289d(0x23c)]('td')[0x3][_0x4a289d(0x27c)],_0x4c6e99=$(this)[_0x4a289d(0x23c)]('td')[0x4][_0x4a289d(0x27c)],_0x433721=$(this)['find'](_0x4a289d(0x20e))['val'](),_0x32240c=$(this)['find'](_0x4a289d(0x1ff))[_0x4a289d(0x224)](),_0x3dc806=$(this)[_0x4a289d(0x23c)](_0x4a289d(0x214))[_0x4a289d(0x224)](),_0x2388a9=$(this)[_0x4a289d(0x23c)](_0x4a289d(0x238))[_0x4a289d(0x224)](),_0xf43618=$(this)[_0x4a289d(0x23c)](_0x4a289d(0x278))['val'](),_0xeb11c7=$(this)[_0x4a289d(0x23c)](_0x4a289d(0x28d))[_0x4a289d(0x224)](),_0x304048='';_0x2388a9!=null&&_0x2388a9!=''&&(_0x304048=GetDateStandardFormat(_0x2388a9));var _0x24b899='';_0xf43618!=null&&_0xf43618!=''&&(_0x24b899=GetDateStandardFormat(_0xf43618));var _0x2ead8a='';_0xeb11c7!=null&&_0xeb11c7!=''&&(_0x2ead8a=GetDateStandardFormat(_0xeb11c7)),(_0x51172d==null||_0x51172d=='')&&(_0x51172d=_0x1351c8),updateManager(_0x4a289d(0x1fb),_0x433721,_0x32240c,_0x3dc806,_0x304048,_0x24b899,_0x2ead8a,_0x467b50);}}}),!![];}function updateManager(_0x371f12,_0x35048e,_0x2aaf16,_0x374804,_0x18fa69,_0xb15542,_0x15cb30,_0x45ac72){var _0x3830d2=a252_0x5c6e;try{var _0x6beb12,_0x336cb9=GetItemTypeForListName(_0x371f12);_0x6beb12={'__metadata':{'type':_0x336cb9},'Designation':_0x35048e,'Manager':_0x2aaf16,'MobileNumber':_0x374804,'DOB':_0x18fa69,'DOA':_0xb15542,'DOJ':_0x15cb30},$[_0x3830d2(0x1ef)](updateItemWithID(_0x371f12,_0x6beb12,_0x45ac72))[_0x3830d2(0x211)](function(_0x4b0980){});}catch(_0x547167){console[_0x3830d2(0x22c)](_0x547167[_0x3830d2(0x287)]);}}function a252_0x4c26(){var _0x3aac2d=['siteAbsoluteUrl','\x27/></td><td><input\x20style=\x27width:\x20100%\x27\x20type=\x27text\x27\x20class=\x27dob\x27\x20value=\x27','-70:+0','OfficeLocation','prop','each','6301976wrIYVz','DateOfBirth','SP.UserProfiles.js','json','DELETE','</ul>','/_layouts/15/','334110xqNEEl','https://graph.microsoft.com','<option></option>','access_token','UserName','/_api/web/lists/getByTitle(\x27TempEmployee\x27)/items','\x27/></td><td><input\x20style=\x27width:\x20100%\x27\x20type=\x27text\x27\x20class=\x27doa\x27\x20value=\x27','mail','/_api/web/lists/getbytitle(\x27','#ddlTempCompany','/_api/SP.OAuth.Token/Acquire','table','#synchedMessage','toISOString','getScript','getMonth','Item\x20Added','yyyy','/_api/web/lists/GetByTitle(\x27OfficeLocation\x27)/items?$select=ID,OfficeName,CompanyID/ID&$expand=CompanyID&$filter=OfficeLocationId\x20eq\x20\x270\x27\x20and\x20CompanyID/ID\x20eq\x20\x27','displayName','charAt','LogonName','application/json;\x20odata=verbose','oddrow','<ul><li><strong></strong></li>','FullName','error','parent','#search_field','1313984QeAWAD',':visible','getQueryStringParameter','You\x20don\x27t\x20have\x20enough\x20licence\x20\x0a\x20Consumed\x20Licence\x20\x20:\x20','head','.empidchk','https://graph.microsoft.com/v1.0/users?$top=100','<option\x20value=\x220\x22>-Select\x20Company-</option>','sorter','PATCH','show','.myHead','click',',\x0a\x20\x20Remaining\x20Licence\x20is\x20:\x20\x20','application/json;odata.metadata=none','.doa','Deferred','\x27/></td></tr>','tableTempEmp','innerText','javascript:EmployeesCompanies(\x27','HomePhone','split','/_api/web/sitegroups/getbyname(\x27Contributors\x27)?$select=id','indexOf','<option\x20value=\x220\x22>-Select\x20Department-</option>','LastName','option','application/json;odata=verbose','append','message','<option\x20value=\x220\x22>-Select\x20Office\x20Location-</option>','waitDialog','Bearer\x20','stringify','change','.doj','68884MNGZLP','frameElement','Title','dd/MM/yyyy','DateOfAnniversary','length','results','href','1506354lIudic','text','slice','\x27)/items','MiddleName','/_api/web/siteusers(@v)?@v=\x27','#ddlTempOfficeLocation','evenrow','dd/mm/yy','.ddlpagingNotAllocated','<div\x20style=\x27width:100%;text-align:\x20center;font-size:14px\x27>Not\x20Defined\x20Yet</div>','#ddlTempDepartment','Please\x20select\x20at\x20least\x20one\x20record\x20from\x20list.','#tableTempEmp\x20tbody','currentpage','#tableTempEmpAllocated\x20tbody\x20tr','Successfully\x20synced.','?$top=1000&$expand=LogonName&$select=ID,LogonName/UserName','</td><td><input\x20type=\x27text\x27\x20style=\x27width:\x20100%\x27\x20class=\x27desgination\x27\x20value=\x27','deleted\x20item','readonly','responseText','ajax','Company','close','#tableTempEmp\x20tbody\x20tr','columns','webAbsoluteUrl','attr','totalpages','/_api/web/lists/getbytitle(\x27Employees\x27)/items','OtherMobileNumber','checked','hide','Employees','GET','when','html','/_api/web/sitegroups(','SP.User','pagedropdown','CompanyId','Primary','Active','\x27/></td><td><input\x20type=\x27text\x27\x20style=\x27width:\x20100%\x27\x20class=\x27doj\x27\x20value=\x27','reject','/_api/web/lists/getbytitle(\x27Departments\x27)/items?$select=ID,CompanyIDId/ID,DepartmentName&$filter=CompanyIDId\x20\x20eq\x20\x27','Department','TempEmployee','</tbody></table>','mm/dd/yy','Total\x20Licenced\x20:','.manager','get_message','185AvSPst','#modalTitanPreview','DOJ','DepartmentName','</td><td>','DOA','@odata.nextLink','Email','Please\x20select\x20company,department\x20and\x20office\x20location.','desc','userPrincipalName','tablenav','/_api/web/lists/getbytitle(\x27Employees\x27)/items?$select=ID,FullName,LogonName/UserName,Department/DepartmentName,Company/CompanyName,Company/ID&$expand=LogonName,Company,Department&$filter=LogonName/UserName\x20\x20eq\x20\x27','.desgination','<tr><td\x20style=\x27text-align:center;\x27><input\x20type=\x27checkbox\x27\x20class=\x27empidchk\x27\x20name=\x27empid\x27\x20value=','/_api/Web/Lists/getByTitle(\x27TempEmployee\x27)/getItemById(','done','dateFormat','datepicker','.mobile','#mainDivArea','MobileNumber','application/json;odata=nometadata','Error:\x20','resolve','empty','Designation','CompanyName','keyup','formatDate','#query','4397934JNNJKR','#btnGetEmp','surname','#btnEmpSubmit','val','getDate','</li>',')/users','push','i:0#.f|membership|','promise','toString','log','POST','totalrecords','272294sjDJls','FirstName','/_api/web/lists/getbytitle(\x27TempEmployee\x27)/items','#__REQUESTDIGEST','\x27)/GetItemById(\x27','LogonName\x20is\x20not\x20in\x20valid\x20format\x20!','Manager','\x27\x20and\x20CompanyId\x20eq\x20\x27','not','.dob','search','toUpperCase','value','find','toLowerCase','selectedrow'];a252_0x4c26=function(){return _0x3aac2d;};return a252_0x4c26();}function updateItemWithID(_0x2bc237,_0xf5ed6b,_0x2bc1c4){var _0x2e4c18=a252_0x5c6e,_0x4c99be=$[_0x2e4c18(0x279)]();return $[_0x2e4c18(0x2ac)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x2e4c18(0x254)+_0x2bc237+_0x2e4c18(0x233)+_0x2bc1c4+'\x27)','type':_0x2e4c18(0x22d),'headers':{'accept':_0x2e4c18(0x285),'X-RequestDigest':$(_0x2e4c18(0x232))[_0x2e4c18(0x224)](),'content-Type':_0x2e4c18(0x285),'X-Http-Method':_0x2e4c18(0x272),'If-Match':'*'},'data':JSON[_0x2e4c18(0x28b)](_0xf5ed6b),'async':![],'success':function(_0x23251a){var _0x3d8883=_0x2e4c18;_0x4c99be[_0x3d8883(0x219)](!![]);},'error':function(_0x450dbf){var _0x22dcba=_0x2e4c18;CloseWaitDialog(),alert(JSON['stringify'](_0x450dbf)),_0x4c99be[_0x22dcba(0x1f8)](_0x450dbf);}}),_0x4c99be[_0x2e4c18(0x22a)]();}function AddEmployeeData(){var _0x150e32=a252_0x5c6e,_0x2c8785=$(_0x150e32(0x2af))[_0x150e32(0x293)];return $('#tableTempEmp\x20tbody\x20tr')[_0x150e32(0x244)](function(_0x3290dc){var _0x507c9e=_0x150e32,_0x555a40=$(this)['is'](':visible');if(_0x555a40==!![]){var _0x4d441a=$(this)[_0x507c9e(0x23c)]('.empidchk')[_0x507c9e(0x243)](_0x507c9e(0x1eb));if(_0x4d441a==!![]){var _0x4ebb44=$(this)[_0x507c9e(0x23c)]('td')[0x1]['innerText'],_0x596887=$(this)[_0x507c9e(0x23c)]('td')[0x2][_0x507c9e(0x27c)],_0x597058=$(this)[_0x507c9e(0x23c)]('td')[0x3][_0x507c9e(0x27c)],_0x16226b=$(this)[_0x507c9e(0x23c)]('td')[0x4][_0x507c9e(0x27c)],_0x45cc0b=$(this)[_0x507c9e(0x23c)](_0x507c9e(0x20e))[_0x507c9e(0x224)](),_0x10cdab=$(this)[_0x507c9e(0x23c)](_0x507c9e(0x1ff))[_0x507c9e(0x224)](),_0x49bdff=$(this)[_0x507c9e(0x23c)](_0x507c9e(0x214))[_0x507c9e(0x224)](),_0x5eee56=$(this)[_0x507c9e(0x23c)](_0x507c9e(0x238))[_0x507c9e(0x224)](),_0x4887ad=$(this)[_0x507c9e(0x23c)]('.doa')[_0x507c9e(0x224)](),_0x40b957=$(this)[_0x507c9e(0x23c)]('.doj')[_0x507c9e(0x224)](),_0x381df8='';_0x5eee56!=null&&_0x5eee56!=''&&(_0x381df8=GetDateStandardFormat(_0x5eee56));var _0x50cac8='';_0x4887ad!=null&&_0x4887ad!=''&&(_0x50cac8=GetDateStandardFormat(_0x4887ad));var _0x16902b='';_0x40b957!=null&&_0x40b957!=''&&(_0x16902b=GetDateStandardFormat(_0x40b957)),(_0x597058==null||_0x597058=='')&&(_0x597058=_0x596887),AddUserinSharePointGroup(_0x507c9e(0x229)+_0x596887),AddNewEmployee(_0x507c9e(0x1ed),_0x4ebb44,_0x597058,_0x596887,_0x45cc0b,_0x10cdab,_0x10cdab,_0x49bdff,_0x381df8,_0x50cac8,_0x16902b);}}}),!![];}function GetDateStandardFormat(_0x486b77){var _0x548d46=a252_0x5c6e,_0x51b3d8=ConvertDateFormatToddMMyyyy(_0x486b77),_0x2ba6a1=new Date(_0x51b3d8),_0x1e41a1=0x3c*0x3c*0x18*0x3e8,_0x3387ea=new Date(_0x2ba6a1['getTime']()),_0x1c116a=_0x3387ea[_0x548d46(0x259)]();return _0x1c116a;}function GetOfficeLocation(_0x1789e0){var _0x427e95=a252_0x5c6e;$(_0x427e95(0x29c))[_0x427e95(0x21a)]()['append'](_0x427e95(0x288));var _0x43edfa=_spPageContextInfo[_0x427e95(0x2b1)]+_0x427e95(0x25e)+_0x1789e0+'\x27';$[_0x427e95(0x2ac)]({'url':_0x43edfa,'headers':{'Accept':_0x427e95(0x285)},'async':![],'success':function(_0x3bf291){var _0x1f6686=_0x427e95,_0x2886d5=_0x3bf291['d'][_0x1f6686(0x294)];for(var _0x7e057f=0x0;_0x7e057f<_0x2886d5[_0x1f6686(0x293)];_0x7e057f++){$(_0x1f6686(0x29c))[_0x1f6686(0x286)]($(_0x1f6686(0x24e))[_0x1f6686(0x2b2)](_0x1f6686(0x23b),_0x3bf291['d'][_0x1f6686(0x294)][_0x7e057f]['ID'])[_0x1f6686(0x297)](_0x3bf291['d'][_0x1f6686(0x294)][_0x7e057f]['OfficeName']));}},'eror':function(_0x41473f){var _0x5844f5=_0x427e95;console[_0x5844f5(0x22c)](_0x5844f5(0x266));}});}function GetTempEmployeeList(_0x50a19c){var _0x44433c=a252_0x5c6e,_0x12c52a=0x0,_0x1ed874=_spPageContextInfo[_0x44433c(0x2b1)]+'/_api/web/lists/getbytitle(\x27TempEmployee\x27)/items?$select=ID,FullName,LogonName,Email,Department,Designation,Company,Manager,MobileNumber,OfficeLocation,DOB,DOA,DOJ&$top=1000';$[_0x44433c(0x2ac)]({'url':_0x1ed874,'headers':{'Accept':_0x44433c(0x285)},'async':!![],'success':function(_0x1d0eae){var _0x3b67b1=_0x44433c,_0x79aa=_0x1d0eae['d'][_0x3b67b1(0x294)],_0xda87f9='<div\x20id=\x27mainTablearea\x27\x20class=\x27table-responsive\x27><table\x20cellpadding=\x270\x27\x20\x20cellspacing=\x270\x27\x20border=\x271\x27\x20id=\x27tableTempEmp\x27\x20class=\x27table-width\x20tinytable\x20table\x20table-bordered\x20table-striped\x20table-hover\x20js-basic-example\x20dataTable\x20no-footer\x20employee_syn_table\x27></div><thead\x20class=\x27panel-heading\x27><tr><th\x20class=\x27nosort\x27\x20style=\x27width:40px;text-align:center;\x27><h6></h6></th><th\x20class=\x27nosort\x27><h6>Name</h6></th><th\x20\x20class=\x27nosort\x27><h6>Login</h6></th><th\x20\x20class=\x27nosort\x27><h6>Email</h6></th><th\x20class=\x27nosort\x27><h6>Department</h6></th><th\x20class=\x27nosort\x27><h6>Designation</h6></th><th\x20class=\x27nosort\x27><h6>Manager</h6></th><th\x20class=\x27nosort\x27><h6>MobileNo</h6></th><th\x20class=\x27nosort\x27><h6>DOB</h6></th><th\x20class=\x27nosort\x27><h6>DOA</h6></th><th\x20class=\x27nosort\x27><h6>DOJ</h6></th></tr></thead><tbody\x20class=\x27panel\x27>',_0x5c9514='';for(var _0x20a391=0x0;_0x20a391<_0x79aa[_0x3b67b1(0x293)];_0x20a391++){var _0x4ad8eb=_0x79aa[_0x20a391][_0x3b67b1(0x265)];(_0x4ad8eb==null||_0x4ad8eb=='')&&(_0x4ad8eb='');var _0x363441=_0x79aa[_0x20a391][_0x3b67b1(0x261)];(_0x363441==null||_0x363441=='')&&(_0x363441='');var _0x568e02=_0x79aa[_0x20a391][_0x3b67b1(0x208)];(_0x568e02==null||_0x568e02=='')&&(_0x568e02='');var _0x5e9b5b=_0x79aa[_0x20a391][_0x3b67b1(0x1fa)];(_0x5e9b5b==null||_0x5e9b5b=='')&&(_0x5e9b5b='');var _0x20ecb7=_0x79aa[_0x20a391][_0x3b67b1(0x21b)];(_0x20ecb7==null||_0x20ecb7=='')&&(_0x20ecb7='');var _0x29e13f=_0x79aa[_0x20a391][_0x3b67b1(0x2ad)];(_0x29e13f==null||_0x29e13f=='')&&(_0x29e13f='');var _0x3d178d=_0x79aa[_0x20a391][_0x3b67b1(0x235)];(_0x3d178d==null||_0x3d178d=='')&&(_0x3d178d='');var _0x3f8db3=_0x79aa[_0x20a391]['MobileNumber'];(_0x3f8db3==null||_0x3f8db3=='')&&(_0x3f8db3='');var _0x5188be=_0x79aa[_0x20a391]['OfficeLocation'];(_0x5188be==null||_0x5188be=='')&&(_0x5188be='');var _0x5ed506=_0x79aa[_0x20a391]['DOB'],_0x5bb42c='';if(_0x5ed506==null||_0x5ed506=='')_0x5ed506='';else{var _0x368972=new Date(_0x5ed506);_0x5ed506=$[_0x3b67b1(0x213)][_0x3b67b1(0x21e)](_0x3b67b1(0x1fd),_0x368972);}var _0x4e2cde=_0x79aa[_0x20a391][_0x3b67b1(0x206)];if(_0x4e2cde==null||_0x4e2cde=='')_0x4e2cde='';else{var _0x368972=new Date(_0x4e2cde);_0x4e2cde=$['datepicker']['formatDate'](_0x3b67b1(0x1fd),_0x368972);}var _0xcb669f=_0x79aa[_0x20a391][_0x3b67b1(0x203)];if(_0xcb669f==null||_0xcb669f=='')_0xcb669f='';else{var _0x368972=new Date(_0xcb669f);_0xcb669f=$['datepicker'][_0x3b67b1(0x21e)]('mm/dd/yy',_0x368972);}var _0x56af95=_0x3b67b1(0x27d)+_0x363441+'\x27)';employeeList[_0x3b67b1(0x281)](_0x363441['toLowerCase']())==-0x1?(tempemployeeList[_0x3b67b1(0x281)](_0x363441[_0x3b67b1(0x23d)]())==-0x1&&_0x12c52a++,_0x5c9514=_0x5c9514+_0x3b67b1(0x20f)+_0x79aa[_0x20a391]['ID']+'></td><td>'+_0x4ad8eb+'</td><td>'+_0x363441+'</td><td>'+_0x568e02+_0x3b67b1(0x205)+_0x5e9b5b+_0x3b67b1(0x2a8)+_0x20ecb7+'\x27/></td><td><input\x20style=\x27width:\x20100%\x27\x20type=\x27text\x27\x20class=\x27manager\x27\x20value=\x27'+_0x3d178d+'\x27/></td><td><input\x20style=\x27width:\x20100%\x27\x20type=\x27text\x27\x20class=\x27mobile\x27\x20value=\x27'+_0x3f8db3+_0x3b67b1(0x240)+_0x5ed506+_0x3b67b1(0x252)+_0x4e2cde+_0x3b67b1(0x1f7)+_0xcb669f+_0x3b67b1(0x27a)):tempemployeeList[_0x3b67b1(0x281)](_0x363441['toLowerCase']())==-0x1&&_0x12c52a++;}var _0x282835=_0xda87f9+_0x5c9514+_0x3b67b1(0x1fc),_0x3e1b39=$(_0x3b67b1(0x215));_0x3e1b39[_0x3b67b1(0x1f0)](''),_0x3e1b39[_0x3b67b1(0x286)](_0x282835),$(_0x3b67b1(0x29f))[_0x3b67b1(0x243)]('selectedIndex',0x1),$(_0x3b67b1(0x238))['datepicker']({'changeMonth':!![],'changeYear':!![],'yearRange':_0x3b67b1(0x241)}),$(_0x3b67b1(0x238))[_0x3b67b1(0x213)]('option',_0x3b67b1(0x212),'dd/mm/yy'),$(_0x3b67b1(0x278))[_0x3b67b1(0x213)]({'changeMonth':!![],'changeYear':!![],'yearRange':_0x3b67b1(0x241)}),$(_0x3b67b1(0x278))[_0x3b67b1(0x213)](_0x3b67b1(0x284),_0x3b67b1(0x212),'dd/mm/yy'),$(_0x3b67b1(0x28d))['datepicker']({'changeMonth':!![],'changeYear':!![],'yearRange':_0x3b67b1(0x241)}),$('.doj')[_0x3b67b1(0x213)]('option','dateFormat',_0x3b67b1(0x29e)),$(_0x3b67b1(0x238))[_0x3b67b1(0x244)](function(){var _0x4bbcbb=_0x3b67b1;$(this)['prop'](_0x4bbcbb(0x2aa),!![]);}),$(_0x3b67b1(0x278))['each'](function(){var _0x298481=_0x3b67b1;$(this)[_0x298481(0x243)]('readonly',!![]);}),$('.doj')[_0x3b67b1(0x244)](function(){var _0x2e7cc5=_0x3b67b1;$(this)['prop'](_0x2e7cc5(0x2aa),!![]);}),_0x50a19c==0x0&&($(_0x3b67b1(0x258))[_0x3b67b1(0x273)](),$(_0x3b67b1(0x258))[_0x3b67b1(0x297)](_0x3b67b1(0x2a6)),setTimeout(function(){var _0xb3f4df=_0x3b67b1;$('#synchedMessage')[_0xb3f4df(0x1ec)]();},0x2710)),GenerateTable(),CloseWaitDialog();},'eror':function(_0x26a796){var _0x1eaf70=_0x44433c;CloseWaitDialog(),console[_0x1eaf70(0x22c)](_0x1eaf70(0x266));}});}var sorter;function GenerateTable(){var _0x132138=a252_0x5c6e;sorter=new TINY[(_0x132138(0x257))][(_0x132138(0x271))](_0x132138(0x271),_0x132138(0x27b),{'headclass':_0x132138(0x26d),'ascclass':'asc','descclass':_0x132138(0x20a),'evenclass':_0x132138(0x29d),'oddclass':_0x132138(0x263),'evenselclass':'evenselected','oddselclass':'oddselected','paginate':!![],'size':0xa,'colddid':_0x132138(0x2b0),'currentid':_0x132138(0x2a4),'totalid':_0x132138(0x2b3),'startingrecid':'startrecord','endingrecid':'endrecord','totalrecid':_0x132138(0x22e),'hoverid':_0x132138(0x23e),'pageddid':_0x132138(0x1f3),'navid':_0x132138(0x20c),'sortdir':0x1,'init':!![]});}function getFormattedDate(_0x553a57){var _0x146f13=a252_0x5c6e,_0x373716=new Date(_0x553a57),_0x14a052=_0x373716['getFullYear'](),_0x27f942=(0x1+_0x373716[_0x146f13(0x25b)]())['toString']();_0x27f942=_0x27f942['length']>0x1?_0x27f942:'0'+_0x27f942;var _0x5a8b17=_0x373716[_0x146f13(0x225)]()[_0x146f13(0x22b)]();return _0x5a8b17=_0x5a8b17['length']>0x1?_0x5a8b17:'0'+_0x5a8b17,_0x5a8b17+'/'+_0x27f942+'/'+_0x14a052;}function EmployeesCompanies(_0x3857ae){var _0x144156=a252_0x5c6e;try{var _0x654e=_spPageContextInfo[_0x144156(0x2b1)]+_0x144156(0x20d)+_0x3857ae+'\x27';$[_0x144156(0x2ac)]({'url':_0x654e,'headers':{'Accept':_0x144156(0x285)},'async':!![],'success':function(_0x43b218){var _0x369a34=_0x144156,_0x108dca=_0x43b218['d'][_0x369a34(0x294)],_0xdee06d=_0x369a34(0x264),_0x3e247d='';for(var _0x5b5a30=0x0;_0x5b5a30<_0x108dca[_0x369a34(0x293)];_0x5b5a30++){var _0x498d62=_0x108dca[_0x5b5a30][_0x369a34(0x261)][_0x369a34(0x250)];(_0x498d62==null||_0x498d62=='')&&(_0x498d62='');var _0x533644=_0x108dca[_0x5b5a30][_0x369a34(0x2ad)][_0x369a34(0x21c)];(_0x533644==null||_0x533644=='')&&(_0x533644='');var _0x3ddc7e=_0x108dca[_0x5b5a30]['Department'][_0x369a34(0x204)];(_0x3ddc7e==null||_0x3ddc7e=='')&&(_0x3ddc7e=''),_0x3e247d=_0x3e247d+'<li>'+_0x533644+'==>'+_0x3ddc7e+_0x369a34(0x226);}var _0x1fe73a=_0xdee06d+_0x3e247d+_0x369a34(0x24a),_0x5531e0=$('#mainDivCompanies');_0x5531e0[_0x369a34(0x1f0)](''),_0x108dca['length']==0x0&&(_0x1fe73a=_0x1fe73a+_0x369a34(0x2a0)),_0x5531e0[_0x369a34(0x286)](_0x1fe73a),CloseWaitDialog(),$(_0x369a34(0x202))['modal'](_0x369a34(0x273));},'eror':function(_0xb052be){var _0xb31c03=_0x144156;CloseWaitDialog(),console[_0xb31c03(0x22c)](_0xb31c03(0x266));}});}catch(_0x264220){CloseWaitDialog(),alert(_0x144156(0x234));}}function EmployeeCheckListValidation(_0x473397,_0x570de8,_0x12cd02){var _0x518d3f=a252_0x5c6e,_0x260eaf=![];try{var _0x475ec1=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/getbytitle(\x27Employees\x27)/items?$select=ID,DepartmentId,LogonName/UserName,Company/ID&$expand=LogonName,Company&$filter=LogonName/UserName\x20\x20eq\x20\x27'+_0x473397+_0x518d3f(0x236)+_0x570de8+'\x27';$[_0x518d3f(0x2ac)]({'url':_0x475ec1,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x11bd8c){var _0x49bf27=_0x518d3f,_0x3af3ce=_0x11bd8c['d'][_0x49bf27(0x294)];_0x3af3ce[_0x49bf27(0x293)]>0x0&&(_0x260eaf=!![]);},'eror':function(_0xd58e92){var _0x540917=_0x518d3f;CloseWaitDialog(),console[_0x540917(0x22c)](_0x540917(0x266));}});}catch(_0x3af1a4){alert(_0x518d3f(0x234));}return _0x260eaf;}function GetCompanies(){var _0x59b426=a252_0x5c6e;$(_0x59b426(0x255))[_0x59b426(0x21a)]()['append'](_0x59b426(0x270));var _0x29cf30=_spPageContextInfo[_0x59b426(0x2b1)]+'/_api/web/lists/getbytitle(\x27Companies\x27)/items?$select=ID,CompanyName';$[_0x59b426(0x2ac)]({'url':_0x29cf30,'headers':{'Accept':_0x59b426(0x285)},'async':![],'success':function(_0x672e98){var _0x4daa0e=_0x59b426,_0x5337ac=_0x672e98['d']['results'];for(var _0x2cbb48=0x0;_0x2cbb48<_0x5337ac[_0x4daa0e(0x293)];_0x2cbb48++){$(_0x4daa0e(0x255))[_0x4daa0e(0x286)]($(_0x4daa0e(0x24e))[_0x4daa0e(0x2b2)](_0x4daa0e(0x23b),_0x672e98['d']['results'][_0x2cbb48]['ID'])[_0x4daa0e(0x297)](_0x672e98['d'][_0x4daa0e(0x294)][_0x2cbb48][_0x4daa0e(0x21c)]));}},'eror':function(_0x17c0b4){var _0x54fe1f=_0x59b426;console[_0x54fe1f(0x22c)]('error');}});}function ValidationCheckBox(){var _0xf8992c=a252_0x5c6e,_0x1b9921=![];return $(_0xf8992c(0x2af))[_0xf8992c(0x244)](function(_0x38f91e){var _0x38d959=_0xf8992c,_0x5322ee=$(this)['is'](':visible');if(_0x5322ee==!![]){var _0x139dae=$(this)[_0x38d959(0x23c)](_0x38d959(0x26e))[_0x38d959(0x243)]('checked');_0x139dae==!![]&&(_0x1b9921=!![]);}}),_0x1b9921;}function ValidationLicencedCheckBox(){var _0x319316=a252_0x5c6e,_0x125ae0=!![],_0x1eb250=0x0;$(_0x319316(0x2af))[_0x319316(0x244)](function(_0x33fddd){var _0x44819e=_0x319316,_0x48ea83=$(this)['is'](':visible');if(_0x48ea83==!![]){var _0x167526=$(this)[_0x44819e(0x23c)](_0x44819e(0x26e))['prop']('checked');_0x167526==!![]&&_0x1eb250++;}}),console[_0x319316(0x22c)]('selectedItemsCount\x20:'+_0x1eb250);var _0x1d1030=GetLicencedUsersCount(),_0x1b2124=_0x1d1030+_0x1eb250,_0x532071=UsersLicenceRequired;console[_0x319316(0x22c)](_0x319316(0x1fe)+_0x532071);if(_0x1b2124>_0x532071){_0x125ae0=![];var _0x1a5d67=_0x532071-_0x1d1030;alert(_0x319316(0x26c)+_0x1d1030+_0x319316(0x276)+_0x1a5d67);}return _0x125ae0;}function ValidationCheckBoxAllocated(){var _0x2ce625=a252_0x5c6e,_0x4bdc20=![];return $(_0x2ce625(0x2a5))[_0x2ce625(0x244)](function(_0x3f917f){var _0x371b16=_0x2ce625,_0x39ddb5=$(this)['is'](_0x371b16(0x26a));if(_0x39ddb5==!![]){var _0x50dc6b=$(this)[_0x371b16(0x23c)](_0x371b16(0x26e))[_0x371b16(0x243)](_0x371b16(0x1eb));_0x50dc6b==!![]&&(_0x4bdc20=!![]);}}),_0x4bdc20;}function GetDepartment(_0x42eba2){var _0x409bb8=a252_0x5c6e;$(_0x409bb8(0x2a1))[_0x409bb8(0x21a)]()[_0x409bb8(0x286)](_0x409bb8(0x282));var _0xcb10dc=_spPageContextInfo[_0x409bb8(0x2b1)]+_0x409bb8(0x1f9)+_0x42eba2+'\x27';$[_0x409bb8(0x2ac)]({'url':_0xcb10dc,'headers':{'Accept':_0x409bb8(0x285)},'async':![],'success':function(_0x9d16cd){var _0x2cf9cc=_0x409bb8,_0x4ae03e=_0x9d16cd['d'][_0x2cf9cc(0x294)];for(var _0x20d1f2=0x0;_0x20d1f2<_0x4ae03e['length'];_0x20d1f2++){$(_0x2cf9cc(0x2a1))[_0x2cf9cc(0x286)]($(_0x2cf9cc(0x24e))[_0x2cf9cc(0x2b2)](_0x2cf9cc(0x23b),_0x9d16cd['d'][_0x2cf9cc(0x294)][_0x20d1f2]['ID'])[_0x2cf9cc(0x297)](_0x9d16cd['d'][_0x2cf9cc(0x294)][_0x20d1f2][_0x2cf9cc(0x204)]));}},'eror':function(_0x355273){console['log']('error');}});}function AddNewEmployee(_0x205825,_0xfa0f44,_0x5a49d7,_0x27dbf0,_0x412f9a,_0x392afb,_0x2fa655,_0x20dfd3,_0x1de2b5,_0x1f65ad,_0x2bd665){var _0x4db4c7=a252_0x5c6e;try{var _0x440a49=GetUserId(_0x27dbf0);if(_0x440a49==''||_0x440a49==null)alert('User\x20:'+_0x27dbf0+'\x20is\x20not\x20valid\x20user\x20!');else{var _0x533e4d=parseInt($(_0x4db4c7(0x255))[_0x4db4c7(0x224)]()),_0x11f40e=parseInt($('#ddlTempDepartment')[_0x4db4c7(0x224)]()),_0xe597d=parseInt($(_0x4db4c7(0x29c))[_0x4db4c7(0x224)]()),_0x4088ce,_0x37f87c=GetItemTypeForListName(_0x205825);_0x4088ce={'__metadata':{'type':_0x37f87c},'CompanyId':_0x533e4d,'DepartmentId':_0x11f40e,'FullName':_0xfa0f44,'Email':_0x5a49d7,'ParentId':'-1','LogonNameId':_0x440a49,'Manager':_0x392afb,'OfficeLocationId':_0xe597d,'MobileNumber':_0x20dfd3,'DateOfBirth':_0x1de2b5,'DateOfAnniversary':_0x1f65ad,'JoiningDate':_0x2bd665,'Designation':_0x412f9a,'PrimaryCompany':_0x4db4c7(0x1f5),'Status':_0x4db4c7(0x1f6)},(_0x440a49==''||_0x440a49==null)&&delete _0x4088ce[_0x4db4c7(0x1f4)],(_0x1de2b5==null||_0x1de2b5=='')&&delete _0x4088ce[_0x4db4c7(0x246)],(_0x1f65ad==null||_0x1f65ad=='')&&delete _0x4088ce[_0x4db4c7(0x292)],(_0x2bd665==null||_0x2bd665=='')&&delete _0x4088ce['JoiningDate'],AddItemToList(_0x205825,_0x4088ce,![]);}}catch(_0x13d5a1){console[_0x4db4c7(0x22c)](_0x13d5a1['message']);}}function GetItemTypeForListName(_0x3740dd){var _0x5b1e63=a252_0x5c6e;return'SP.Data.'+_0x3740dd[_0x5b1e63(0x260)](0x0)[_0x5b1e63(0x23a)]()+_0x3740dd[_0x5b1e63(0x27f)]('\x20')['join']('')[_0x5b1e63(0x298)](0x1)+'ListItem';}function AddItemToList(_0x490018,_0x3e0e59,_0x51a072){var _0x2be9d0=a252_0x5c6e,_0x2e36ba=$[_0x2be9d0(0x279)]();return $[_0x2be9d0(0x2ac)]({'url':_spPageContextInfo[_0x2be9d0(0x2b1)]+_0x2be9d0(0x254)+_0x490018+_0x2be9d0(0x299),'type':_0x2be9d0(0x22d),'async':_0x51a072,'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x2be9d0(0x232))['val'](),'content-Type':_0x2be9d0(0x285)},'data':JSON[_0x2be9d0(0x28b)](_0x3e0e59),'success':function(_0x14e896){_0x2e36ba['resolve'](_0x14e896);},'error':function(_0x17e1ed){alert(JSON['stringify'](_0x17e1ed)),_0x2e36ba['reject'](_0x17e1ed);}}),_0x2e36ba[_0x2be9d0(0x22a)]();}function GetUserId(_0x5c4131){var _0x538c23=a252_0x5c6e,_0x4c7736='',_0x3811c1=_0x538c23(0x229),_0x1ccb9b=_spPageContextInfo[_0x538c23(0x23f)],_0x5b7eaa=_0x3811c1+_0x5c4131;return $['ajax']({'url':_0x1ccb9b+'/_api/web/siteusers(@v)?@v=\x27'+encodeURIComponent(_0x5b7eaa)+'\x27','method':_0x538c23(0x1ee),'headers':{'Accept':_0x538c23(0x262)},'async':![],'success':function(_0x3d4d39){_0x4c7736=_0x3d4d39['d']['Id'];},'error':function(_0x217303){console['log'](JSON['stringify'](_0x217303));}}),_0x4c7736;}function ConvertDateFormatToddMMyyyy(_0x1313c3){var _0x731cae=a252_0x5c6e,_0x3dbf64=stringToDate(_0x1313c3,_0x731cae(0x291),'/');return _0x3dbf64;}function stringToDate(_0x294b5e,_0x518566,_0x1a55db){var _0x297463=a252_0x5c6e,_0x44493f=_0x518566[_0x297463(0x23d)](),_0x2010ea=_0x44493f[_0x297463(0x27f)](_0x1a55db),_0x49970d=_0x294b5e[_0x297463(0x27f)](_0x1a55db),_0x1ba426=_0x2010ea[_0x297463(0x281)]('mm'),_0x5dc817=_0x2010ea[_0x297463(0x281)]('dd'),_0x3706fc=_0x2010ea[_0x297463(0x281)](_0x297463(0x25d)),_0x2ce0c7=parseInt(_0x49970d[_0x1ba426]);_0x2ce0c7-=0x1;var _0x5e89f4=new Date(_0x49970d[_0x3706fc],_0x2ce0c7,_0x49970d[_0x5dc817]);return _0x5e89f4;}var employeeList=new Array(),tempemployeeList=new Array();function GetEmployeeList(_0x509d36){var _0x34fb0e=a252_0x5c6e;employeeList=[],WaitMessage();var _0xef82b2=_0x34fb0e(0x2a7),_0x4e5901=_spPageContextInfo['webAbsoluteUrl']+_0x34fb0e(0x2b4)+_0xef82b2;$[_0x34fb0e(0x2ac)]({'url':_0x4e5901,'data':{'format':_0x34fb0e(0x248)},'type':_0x34fb0e(0x1ee),'dataType':_0x34fb0e(0x248),'async':![],'success':function(_0x4b9757){var _0x3d5161=_0x34fb0e,_0x1bb760=_0x4b9757;for(var _0x4f07a9=0x0;_0x4f07a9<_0x1bb760[_0x3d5161(0x23b)]['length'];_0x4f07a9++){if(_0x1bb760[_0x3d5161(0x23b)][_0x4f07a9][_0x3d5161(0x261)]!=undefined){var _0x45632d=_0x1bb760[_0x3d5161(0x23b)][_0x4f07a9][_0x3d5161(0x261)]['UserName'];_0x45632d!=null&&(employeeList[_0x3d5161(0x281)](_0x45632d['toLowerCase']())==-0x1&&employeeList[_0x3d5161(0x228)](_0x45632d[_0x3d5161(0x23d)]()));}}}}),_0x509d36==0x1&&GetTempEmployeeList(_0x509d36);}function GetTempEmployee(){var _0x12a2f8=a252_0x5c6e;tempemployeeList=[];var _0xd417a8='?$top=100&$select=ID,LogonName',_0xba3e57=_spPageContextInfo[_0x12a2f8(0x2b1)]+_0x12a2f8(0x231)+_0xd417a8;$[_0x12a2f8(0x2ac)]({'url':_0xba3e57,'data':{'format':_0x12a2f8(0x248)},'type':_0x12a2f8(0x1ee),'dataType':'json','async':![],'success':function(_0x5ae105){var _0x16c83f=_0x12a2f8,_0x1b2cf4=_0x5ae105;for(var _0x3eaaab=0x0;_0x3eaaab<_0x1b2cf4[_0x16c83f(0x23b)][_0x16c83f(0x293)];_0x3eaaab++){var _0x4c3601=_0x1b2cf4[_0x16c83f(0x23b)][_0x3eaaab][_0x16c83f(0x261)];tempemployeeList[_0x16c83f(0x281)](_0x4c3601[_0x16c83f(0x23d)]())==-0x1&&tempemployeeList['push'](_0x4c3601['toLowerCase']());}}});}function WaitMessage(){var _0x123f9e=a252_0x5c6e;waitingDialog[_0x123f9e(0x273)]();}function CloseWaitDialog(){var _0x28cf85=a252_0x5c6e;waitingDialog[_0x28cf85(0x1ec)]();}function CloseWaitDialog2(){var _0x1e6333=a252_0x5c6e;window[_0x1e6333(0x28f)]!=null?window[_0x1e6333(0x267)]['waitDialog']!=null&&window[_0x1e6333(0x267)][_0x1e6333(0x289)][_0x1e6333(0x2ae)]():window[_0x1e6333(0x267)]['waitDialog']!=null&&window['parent'][_0x1e6333(0x289)][_0x1e6333(0x2ae)]();}function a252_0x5c6e(_0x1d1317,_0x42edba){var _0x4c26c7=a252_0x4c26();return a252_0x5c6e=function(_0x5c6e68,_0x156dc0){_0x5c6e68=_0x5c6e68-0x1ea;var _0x2175bd=_0x4c26c7[_0x5c6e68];return _0x2175bd;},a252_0x5c6e(_0x1d1317,_0x42edba);}var scriptbase=_spPageContextInfo['webAbsoluteUrl']+a252_0x346f9d(0x24b);function PageLoad(){var _0x5120fc=a252_0x346f9d;$('.btnMoreEmployeeListSynch')[_0x5120fc(0x275)](function(){GraphAccessTokenTogetUserDetails();}),$[_0x5120fc(0x25a)](scriptbase+'SP.js',function(){var _0x53b753=_0x5120fc;$[_0x53b753(0x25a)](scriptbase+_0x53b753(0x247),ReadyFucnction);});}function ReadyFucnction(){var _0x21f9b1=a252_0x346f9d;$[_0x21f9b1(0x1ef)](GetTempEmployee())['done'](function(_0x2c569e){GraphAccessTokenTogetUserDetails();});}function GraphAccessTokenTogetUserDetails(){var _0x42c34a=a252_0x346f9d,_0x322c9b=new jQuery[(_0x42c34a(0x279))](),_0x23c6c0={'X-RequestDigest':$(_0x42c34a(0x232))[_0x42c34a(0x224)](),'accept':_0x42c34a(0x217),'content-type':_0x42c34a(0x217)},_0x4fbb2a={'resource':_0x42c34a(0x24d)};return $[_0x42c34a(0x2ac)]({'url':_spPageContextInfo[_0x42c34a(0x2b1)]+_0x42c34a(0x256),'headers':_0x23c6c0,'type':_0x42c34a(0x22d),'data':JSON[_0x42c34a(0x28b)](_0x4fbb2a),'success':function(_0x405485){var _0x47dc47=_0x42c34a,_0x1a236f=_0x405485[_0x47dc47(0x24f)];GetUsersDtails(_0x1a236f),_0x322c9b[_0x47dc47(0x219)](_0x1a236f);},'error':function(_0xb68eb1,_0x3bca7a,_0x6ed13){var _0x4d8dde=_0x42c34a;console['log'](_0xb68eb1[_0x4d8dde(0x2ab)]),_0x322c9b[_0x4d8dde(0x1f8)](_0xb68eb1[_0x4d8dde(0x2ab)]);}}),_0x322c9b[_0x42c34a(0x22a)]();}var odurlGraphUserRestQuery=a252_0x346f9d(0x26f),_NextToken;function GetUsersDtails(_0x277d9d){var _0x1ac647=a252_0x346f9d;_NextToken=_0x277d9d,$[_0x1ac647(0x2ac)]({'url':odurlGraphUserRestQuery,'dataType':_0x1ac647(0x248),'headers':{'Authorization':_0x1ac647(0x28a)+_0x277d9d},'accept':_0x1ac647(0x277),'success':function(_0x354434){var _0x596978=_0x1ac647,_0x1836ba=new Array(),_0x2c4b36=_0x354434[_0x596978(0x23b)];for(var _0x4a2827=0x0;_0x4a2827<_0x354434[_0x596978(0x23b)][_0x596978(0x293)];_0x4a2827++){var _0x333ef5=_0x2c4b36[_0x4a2827]['givenName'],_0x469987='',_0x196007=_0x2c4b36[_0x4a2827][_0x596978(0x222)],_0x508e31=_0x2c4b36[_0x4a2827][_0x596978(0x25f)],_0x1b5697=_0x2c4b36[_0x4a2827][_0x596978(0x20b)],_0xd7f020=_0x2c4b36[_0x4a2827][_0x596978(0x253)],_0x785132='',_0x28ea72=_0x2c4b36[_0x4a2827]['jobTitle'],_0x560846='',_0x83a08d='',_0x44f8e5=_0x2c4b36[_0x4a2827]['mobilePhone'],_0x23f3ff='',_0x524164='',_0x29efa6='';if(_0x1b5697[_0x596978(0x281)]('#EXT#')==-0x1){var _0xdf29b0=UserProfileProperties(_0x333ef5,_0x469987,_0x196007,_0x508e31,_0x1b5697,_0xd7f020,_0x785132,_0x28ea72,_0x560846,_0x83a08d,_0x44f8e5,_0x23f3ff,_0x524164,_0x29efa6);_0x1836ba[_0x596978(0x228)](_0xdf29b0);}else{var _0xdf29b0=UserProfileProperties(_0x333ef5,_0x469987,_0x196007,_0x508e31,_0x1b5697,_0xd7f020,_0x785132,_0x28ea72,_0x560846,_0x83a08d,_0x44f8e5,_0x23f3ff,_0x524164,_0x29efa6);_0x1836ba[_0x596978(0x228)](_0xdf29b0);}}for(var _0x4a2827=0x0;_0x4a2827<_0x1836ba[_0x596978(0x293)];_0x4a2827++){var _0x333ef5=_0x1836ba[_0x4a2827][_0x596978(0x230)],_0x469987=_0x1836ba[_0x4a2827]['MiddleName'],_0x196007=_0x1836ba[_0x4a2827][_0x596978(0x283)],_0x508e31=_0x1836ba[_0x4a2827][_0x596978(0x265)],_0x1b5697=_0x1836ba[_0x4a2827][_0x596978(0x261)],_0xd7f020=_0x1836ba[_0x4a2827][_0x596978(0x208)],_0x785132=_0x1836ba[_0x4a2827][_0x596978(0x1fa)],_0x28ea72=_0x1836ba[_0x4a2827][_0x596978(0x21b)],_0x560846=_0x1836ba[_0x4a2827][_0x596978(0x2ad)],_0x83a08d=_0x1836ba[_0x4a2827][_0x596978(0x235)],_0x44f8e5=_0x1836ba[_0x4a2827][_0x596978(0x216)],_0x23f3ff=_0x1836ba[_0x4a2827][_0x596978(0x27e)],_0x524164=_0x1836ba[_0x4a2827][_0x596978(0x242)],_0x29efa6=_0x1836ba[_0x4a2827][_0x596978(0x1ea)];{var _0x4d46ca='';{}tempemployeeList[_0x596978(0x281)](_0x1b5697)==-0x1&&(CreateListItem(_0x333ef5,_0x469987,_0x196007,_0x508e31,_0x1b5697,_0xd7f020,_0x785132,_0x28ea72,_0x560846,_0x4d46ca,_0x44f8e5,_0x23f3ff,_0x524164,_0x29efa6),tempemployeeList[_0x596978(0x228)](_0x1b5697));}}_0x354434[_0x596978(0x207)]!=null?(odurlGraphUserRestQuery=_0x354434[_0x596978(0x207)],GetUsersDtails(_NextToken)):$('.btnMoreEmployeeListSynch')[_0x596978(0x1ec)](),GetTempEmployeeList(0x0),CloseWaitDialog();}});}function UserProfileProperties(_0x31b677,_0x3ec477,_0x24b8f8,_0x5ef93b,_0x31327a,_0x2afa47,_0x24dd90,_0x196462,_0x57a945,_0x7a2148,_0x5d26e3,_0x5dac4a,_0x178180,_0x18db0f){var _0x536061=a252_0x346f9d,_0x3c090a={};return _0x3c090a[_0x536061(0x230)]=_0x31b677,_0x3c090a[_0x536061(0x29a)]=_0x3ec477,_0x3c090a[_0x536061(0x283)]=_0x24b8f8,_0x3c090a[_0x536061(0x265)]=_0x5ef93b,_0x3c090a[_0x536061(0x261)]=_0x31327a,_0x3c090a[_0x536061(0x208)]=_0x2afa47,_0x3c090a['Department']=_0x24dd90,_0x3c090a['Designation']=_0x196462,_0x3c090a[_0x536061(0x2ad)]=_0x57a945,_0x3c090a[_0x536061(0x235)]=_0x7a2148,_0x3c090a['MobileNumber']=_0x5d26e3,_0x3c090a['HomePhone']=_0x5dac4a,_0x3c090a['OfficeLocation']=_0x178180,_0x3c090a[_0x536061(0x1ea)]=_0x18db0f,_0x3c090a;}function CreateListItem(_0x458f93,_0x4c009a,_0x19a162,_0x5a8285,_0x423f9b,_0x50e981,_0x5b2cfb,_0xc53da0,_0x591893,_0x17c88c,_0xdbc0b4,_0x196618,_0x4aa13c,_0x74e298){var _0x50db5e=a252_0x346f9d,_0x5d8a03='TempEmployee';try{var _0x15ff37=_0x50e981;(_0x15ff37==null||_0x15ff37=='')&&(_0x15ff37=_0x423f9b);var _0x92576d,_0x2674f1=GetItemTypeForListName(_0x5d8a03);_0x92576d={'__metadata':{'type':_0x2674f1},'FirstName':_0x458f93,'LastName':_0x19a162,'MiddleName':_0x4c009a,'FullName':_0x5a8285,'LogonName':_0x423f9b,'Email':_0x15ff37,'Department':_0x5b2cfb,'Designation':_0xc53da0,'Company':_0x591893,'Manager':_0x17c88c,'MobileNumber':_0xdbc0b4,'HomePhone':_0x196618,'OfficeLocation':_0x4aa13c,'OtherMobileNumber':_0x74e298},$[_0x50db5e(0x1ef)](AddItemToList(_0x5d8a03,_0x92576d,!![]))[_0x50db5e(0x211)](function(_0x108936){});}catch(_0x31b4b8){console[_0x50db5e(0x22c)](_0x31b4b8['message']);}}function onQuerySucceeded(){var _0x46b2e4=a252_0x346f9d;console[_0x46b2e4(0x22c)](_0x46b2e4(0x25c));}function onQueryFailed(_0x3842de,_0x80b40b){var _0x20cdad=a252_0x346f9d;alert(_0x20cdad(0x218)+_0x80b40b[_0x20cdad(0x200)]());}function GetUserFullName(_0x16f498){var _0x105d0f=a252_0x346f9d,_0x39cf45='',_0x4e0153='i:0#.f|membership|',_0x5a51f2=_spPageContextInfo[_0x105d0f(0x23f)],_0x487f32=_0x4e0153+_0x16f498;return $[_0x105d0f(0x2ac)]({'url':_0x5a51f2+_0x105d0f(0x29b)+encodeURIComponent(_0x487f32)+'\x27','method':_0x105d0f(0x1ee),'headers':{'Accept':'application/json;\x20odata=verbose'},'async':![],'success':function(_0x333474){var _0x432f2d=_0x105d0f;_0x39cf45=_0x333474['d'][_0x432f2d(0x290)];},'error':function(_0x300fa0){var _0x48d16b=_0x105d0f;console[_0x48d16b(0x22c)](JSON[_0x48d16b(0x28b)](_0x300fa0));}}),_0x39cf45;}function GetAllItemsToDelete(){var _0xbd5910=a252_0x346f9d;$['ajax']({'url':_spPageContextInfo[_0xbd5910(0x2b1)]+_0xbd5910(0x251),'type':_0xbd5910(0x1ee),'headers':{'accept':_0xbd5910(0x285)},'success':function(_0x3cb2ac){var _0x4be44e=_0xbd5910,_0x93feed=_0x3cb2ac['d']['results'];for(var _0x4646a8=0x0;_0x4646a8<_0x93feed[_0x4be44e(0x293)];_0x4646a8++){var _0x5676b4=_spPageContextInfo[_0x4be44e(0x2b1)]+_0x4be44e(0x210)+_0x93feed[_0x4646a8]['ID']+')';deleteItem(_0x5676b4);}},'error':function(_0x20eb96){var _0x3f8e74=_0xbd5910;console[_0x3f8e74(0x22c)](JSON[_0x3f8e74(0x28b)](_0x20eb96));}});}function deleteItem(_0xdfb598){var _0x3ca847=a252_0x346f9d;$[_0x3ca847(0x2ac)]({'url':_0xdfb598,'type':_0x3ca847(0x249),'headers':{'accept':_0x3ca847(0x285),'X-RequestDigest':$('#__REQUESTDIGEST')['val'](),'If-Match':'*'},'success':function(_0x501464){var _0x4251c7=_0x3ca847;console['log'](_0x4251c7(0x2a9));},'error':function(_0x127c19){var _0x5cb191=_0x3ca847;console['log'](JSON[_0x5cb191(0x28b)](_0x127c19));}});}function GetLicencedUsersCount(){var _0x156887=a252_0x346f9d,_0x1e4ec9=0x0,_0x3a5688='?$top=100&$expand=LogonName&$select=ID,LogonName/UserName&$filter=Status\x20eq\x20\x27Active\x27',_0x10d9df=_spPageContextInfo[_0x156887(0x2b1)]+_0x156887(0x2b4)+_0x3a5688;return $['ajax']({'url':_0x10d9df,'data':{'format':_0x156887(0x248)},'type':_0x156887(0x1ee),'dataType':'json','async':![],'success':function(_0x446482){var _0x4720bf=_0x156887,_0x4a6a1d=_0x446482,_0x5cfb80=[];for(var _0x421600=0x0;_0x421600<_0x4a6a1d[_0x4720bf(0x23b)][_0x4720bf(0x293)];_0x421600++){if(_0x4a6a1d[_0x4720bf(0x23b)][_0x421600]['LogonName']!=undefined){var _0x1d0972=_0x4a6a1d[_0x4720bf(0x23b)][_0x421600][_0x4720bf(0x261)][_0x4720bf(0x250)];_0x1d0972!=null&&(_0x5cfb80[_0x4720bf(0x281)](_0x1d0972[_0x4720bf(0x23d)]())==-0x1&&_0x5cfb80['push'](_0x1d0972['toLowerCase']()));}}_0x1e4ec9=_0x5cfb80[_0x4720bf(0x293)];}}),_0x1e4ec9;}