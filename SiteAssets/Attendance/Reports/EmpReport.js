var _0x36d2a6=_0x121b;(function(_0x3bb1d4,_0x8c2854){var _0x4e5a63=_0x121b,_0x2e03b1=_0x3bb1d4();while(!![]){try{var _0x435620=parseInt(_0x4e5a63(0x137))/0x1*(parseInt(_0x4e5a63(0x125))/0x2)+parseInt(_0x4e5a63(0x1b3))/0x3+-parseInt(_0x4e5a63(0x132))/0x4+-parseInt(_0x4e5a63(0x1e6))/0x5+parseInt(_0x4e5a63(0x126))/0x6+-parseInt(_0x4e5a63(0x180))/0x7*(parseInt(_0x4e5a63(0x1c0))/0x8)+-parseInt(_0x4e5a63(0x15e))/0x9*(-parseInt(_0x4e5a63(0x1e2))/0xa);if(_0x435620===_0x8c2854)break;else _0x2e03b1['push'](_0x2e03b1['shift']());}catch(_0x145670){_0x2e03b1['push'](_0x2e03b1['shift']());}}}(_0x142b,0x2529b));var Totaldays=0x0,CompanyID='',GstartDate='',GEmpID=0x0;function _0x142b(){var _0x399159=['AttendanceType','setDate','#Att','1189867wWGzNI','Holiday_start','AttendanceItemId','Empendrecord','Aug','SPClientPeoplePicker','00:00','Data\x20has\x20been\x20saved.','OfficeName','/Pages/TimeSheetEntry.aspx?WebAppId=2&Recall=','LogonName','Error!\x20Something\x20went\x20wrong.','OfficeLocation','asc','\x27\x20and\x20(WebPartName\x20eq\x20\x27HR\x20Admin\x27)','\x20,\x20','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Att','join','format','Key','<a\x20class=\x27LinkBtn\x27\x20href=\x27','#OfficeLoc','#Total-Leave-Absent','PrincipalAccountType','Jun','hide','#EndDate','results','></div></td>','/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?select=*,ID,Title&$filter=OfficeLocationID\x20eq\x20\x27','#EmpreportFrom','/_api/web/lists/GetByTitle(\x27EmpAttendance\x27)/items(','ResolvePrincipalSource','#Timeview','ajax','=([^&#]*)','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27','Title','Empstartrecord','SearchPrincipalSource','oddrow','urlParam','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27></div></td>','Emptotalpages','attr','#ResultDiv','EID','Dec','User,DL,SecGroup,SPGroup','color','\x27\x20and\x20AttendanceDate\x20le\x20\x27','241329BYFgds','get','.NoRecordFound','slice','<td><div\x20class=\x27checkbox\x20m-0\x27\x20style=\x27display:\x20','#Total-Attendance','getDate','oddselected','YYYY-MM-DD','columns','GetAllUserInfo','EmpWorkHours','\x27\x20and\x20Employee\x20eq\x20\x27','8IwkDPz','/_api/web/lists/GetByTitle(\x27EmpAttendance\x27)/items','#EmpName','</tr>','Oct',',0,','end','MERGE','modal','val','[?&]','Monday','none','Leave\x20withdrawal\x20Successfully\x20Completed.','#StartDate','Unauthorized\x20access!','ProcessApprovers','\x27\x20and\x20Holiday_start\x20le\x20\x27','location','#Workingdays','log','getFullYear','evenrow','Worksheet','\x27&$top=200&$orderby=Holiday_start\x20asc','split','#FdateTH','indexOf','280px','Saturday','UserId','userId','Are\x20you\x20sure\x20to\x20withdraw\x20the\x20Leave?',')\x27>Withdraw</a></div></td>','30QNRgES','/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?$filter=OfficeLocationID\x20eq\x20(\x27','MaximumEntitySuggestions','DD/MM/YYYY','229385kzEzHV','\x27\x20and\x20Company/ID\x20\x20eq\x20\x27','<html\x20xmlns:o=\x22urn:schemas-microsoft-com:office:office\x22\x20xmlns:x=\x22urn:schemas-microsoft-com:office:excel\x22\x20xmlns=\x22http://www.w3.org/TR/REC-html40\x22><head><!--[if\x20gte\x20mso\x209]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>','webAbsoluteUrl','getDay','#EmpTotalItemscount','SP.Data.EmpAttendanceListItem','AttendanceDate','children','/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27','/_api/web/ensureuser','push','An\x20error\x20occurred.\x20Please\x20try\x20again.','DD\x20MMM\x20YYYY','\x27)and\x20Holiday_start\x20eq\x20\x27','toISOString','#EmpreportTo','151532pfTRdI','1579248xUSirW','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=','grep','Jan','&sourcelocation=../Pages/Myworkplace.aspx\x27\x20><span\x20id=\x27Timeview','block','View','This\x20is\x20a\x20Holiday,\x20are\x20you\x20sure\x20to\x20submit\x20your\x20attendance.','MM\x20dd,\x20yy','desc','Jul','nodeType','725468FGQOKw','\x27\x20class=\x27employee-report-holiday\x27></span></div></td>','#EdateTH','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27\x20style=\x27display:\x20','</div></td>','2ZrJDsS','#EmpRow','><span>','empty','data:application/vnd.ms-excel;base64,','CompanyId','sorter','#HolidayMessage','ready','href','<tr\x20class=\x27text-center\x27\x20>','POST','Width','floor','#TotalWorkdayTH','\x20\x27><a\x20href=\x27#\x27\x20class=\x27custom-edit-btn\x27\x20data-toggle=\x27modal\x27\x20data-target=\x27#attendance-reportEdit\x27\x20onclick=\x27attendanceEditModal(','exec','May','#EmpReportTable','#attendance-reportEdit','#EmpTitle','css','getMonth','Employee','#attendance-report-filter','Plese\x20select\x20proper\x20attandence.','#officeLocTH','Sunday','tablenav','length','round','On-Leave','parse','</span><span\x20id=\x27H','Hdate','red','WorkHours','Wednesday','responseJSON','162783ZxkApV','On-LeaveWithdraw','HrAction','#__REQUESTDIGEST','datepicker','toString','getQueryStringParameter','SPClientPeoplePicker_InitStandaloneControlWrapper','#AttendanceDDL','Feb',')\x27><i\x20class=\x27fa\x20fa-pencil\x27></i></a></div></td>','text','Tuesday','table','<td><div\x20class=\x27checkbox\x20m-0\x27></div></td>','Invalid\x20date\x20range.\x0aFrom\x20Date\x20should\x20not\x20be\x20bigger\x20than\x20To\x20Date','error','EmpReportTableData','Thursday','\x27>Fill</span></a>','&Mode=','display','\x27\x20and\x20ContributorsId\x20eq\x20\x27','map','Holiday','btoa','#HoliaysTotal','application/json;odata=verbose','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Time','stringify','#HolidayMessagediv'];_0x142b=function(){return _0x399159;};return _0x142b();}$(document)[_0x36d2a6(0x13f)](function(){var _0x2b9138=_0x36d2a6;ValidateHrAdmin(),CompanyID=titanForWork[_0x2b9138(0x164)](_0x2b9138(0x13c));var _0x94b8db=$[_0x2b9138(0x1a9)](_0x2b9138(0x1ae)),_0x2aba99=$[_0x2b9138(0x1a9)]('start'),_0x1ea221=$[_0x2b9138(0x1a9)](_0x2b9138(0x1c6));if(_0x94b8db!=null){GEmpID=_0x94b8db;var _0x2ee6d5=_0x2aba99[_0x2b9138(0x1b6)](0x0,0x4)+'-'+_0x2aba99[_0x2b9138(0x1b6)](0x4,0x6)+'-'+_0x2aba99[_0x2b9138(0x1b6)](0x6,0x8),_0x19bce9=_0x1ea221[_0x2b9138(0x1b6)](0x0,0x4)+'-'+_0x1ea221[_0x2b9138(0x1b6)](0x4,0x6)+'-'+_0x1ea221['slice'](0x6,0x8),_0x484a64=new Date(_0x19bce9),_0x59ad55=_0x484a64[_0x2b9138(0x1f5)](),_0x11678b=_0x59ad55[_0x2b9138(0x1d9)]('T');GstartDate=_0x2ee6d5,$(_0x2b9138(0x19e))['datepicker']({'dateFormat':_0x2b9138(0x12e)})[_0x2b9138(0x162)](_0x2b9138(0x17e),new Date(_0x2ee6d5)),$(_0x2b9138(0x1f6))[_0x2b9138(0x162)]({'dateFormat':_0x2b9138(0x12e)})[_0x2b9138(0x162)](_0x2b9138(0x17e),new Date(_0x19bce9));var _0x5856bf=$(_0x2b9138(0x19e))[_0x2b9138(0x162)](_0x2b9138(0x1b9)),_0x385ff3=$(_0x2b9138(0x1f6))['datepicker']('getDate');days=(_0x385ff3-_0x5856bf)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math[_0x2b9138(0x155)](days)+0x1,$(_0x2b9138(0x1ce))[_0x2b9138(0x169)](formatDateReportEmp($('#EmpreportFrom')[_0x2b9138(0x1c9)]())),$(_0x2b9138(0x19a))[_0x2b9138(0x169)](formatDateReportEmp($(_0x2b9138(0x1f6))[_0x2b9138(0x1c9)]()));var _0x326f93=_spPageContextInfo['webAbsoluteUrl']+_0x2b9138(0x1ef)+_0x94b8db+'\x27\x20and\x20Company/ID\x20\x20eq\x20\x27'+CompanyID+'\x27';EmployeeListDat(_0x326f93),LoadAllHolidays();var _0x184034=_spPageContextInfo[_0x2b9138(0x1e9)]+'/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27'+_0x2ee6d5+_0x2b9138(0x1b2)+_0x11678b[0x0]+_0x2b9138(0x1bf)+_0x94b8db+'\x27\x20';getFileData(_0x184034);var _0x326f93=_spPageContextInfo[_0x2b9138(0x1e9)]+_0x2b9138(0x1ef)+_0x94b8db+_0x2b9138(0x1e7)+CompanyID+'\x27';EmployeeListDat(_0x326f93),LoadAllHolidays(),initializePeoplePicker('EmployeeName');}});var EmployeeID='',ItemID='',SelectedDate='',TDID='';function attendanceEditModal(_0xc5ff43,_0x163f9a,_0x3c116c){var _0x108f40=_0x36d2a6;EmployeeID=0x0,ItemID=0x0,SelectedDate='',TDID=_0x3c116c,EmployeeID=_0xc5ff43,ItemID=_0x163f9a;var _0xc11841=_0x3c116c[_0x108f40(0x163)](),_0x57a5bc=_0xc11841[_0x108f40(0x1b6)](0x0,0x4)+'-'+_0xc11841[_0x108f40(0x1b6)](0x4,0x6)+'-'+_0xc11841[_0x108f40(0x1b6)](0x6,0x8),_0x3ddde3=new Date(_0x57a5bc);SelectedDate=_0x3ddde3['toISOString']()[_0x108f40(0x1d9)]('T')[0x0];var _0x2f7239=formatDateReportEmp(_0x3ddde3);$('#SelDate')[_0x108f40(0x169)](_0x2f7239),GetHolidays(_0x57a5bc);}function UpdateAttendance(){var _0x327b45=_0x36d2a6;ItemID==0x0?(G_Validateholiday==!![]?confirm(_0x327b45(0x12d))&&PushNewAttendance():PushNewAttendance(),Applyfilter(),LoadAllHolidays()):(G_Validateholiday==!![]?confirm(_0x327b45(0x12d))&&ModifyAttendance():ModifyAttendance(),Applyfilter(),LoadAllHolidays());}function PushNewAttendance(){var _0x361346=_0x36d2a6;$(_0x361346(0x166))[_0x361346(0x1c9)]()!=_0x361346(0x176)||G_Validateholiday==!![]?$['ajax']({'url':_spPageContextInfo['webAbsoluteUrl']+_0x361346(0x1c1),'type':'POST','async':![],'data':JSON[_0x361346(0x17b)]({'__metadata':{'type':_0x361346(0x1ec)},'AttendanceDate':SelectedDate,'EmployeeId':EmployeeID,'AttendanceType':$(_0x361346(0x166))[_0x361346(0x1c9)]()}),'headers':{'Accept':_0x361346(0x179),'Content-Type':_0x361346(0x179),'X-RequestDigest':$(_0x361346(0x161))[_0x361346(0x1c9)](),'X-HTTP-Method':_0x361346(0x142)},'success':function(_0x23e387,_0xf9d819,_0x233451){var _0x341c22=_0x361346;$(_0x341c22(0x17f)+TDID)[_0x341c22(0x169)]($(_0x341c22(0x166))[_0x341c22(0x1c9)]()),alert(_0x341c22(0x187)),$(_0x341c22(0x14a))[_0x341c22(0x1c8)](_0x341c22(0x199)),GetAttendanceorLeaves();},'error':function(_0xdb5e7d,_0x51a930,_0x35b130){var _0x142ddd=_0x361346;alert(_0x142ddd(0x18b));}}):alert(_0x361346(0x150));}function ModifyAttendance(){var _0x34e14c=_0x36d2a6;$(_0x34e14c(0x166))[_0x34e14c(0x1c9)]()!=_0x34e14c(0x176)||G_Validateholiday==!![]?$[_0x34e14c(0x1a2)]({'url':_spPageContextInfo[_0x34e14c(0x1e9)]+_0x34e14c(0x19f)+ItemID+')','type':_0x34e14c(0x142),'async':![],'data':JSON[_0x34e14c(0x17b)]({'__metadata':{'type':_0x34e14c(0x1ec)},'AttendanceType':$(_0x34e14c(0x166))[_0x34e14c(0x1c9)]()}),'headers':{'Accept':_0x34e14c(0x179),'Content-Type':_0x34e14c(0x179),'X-RequestDigest':$(_0x34e14c(0x161))[_0x34e14c(0x1c9)](),'IF-MATCH':'*','X-HTTP-Method':_0x34e14c(0x1c7)},'success':function(_0x2c7c55,_0x4f1d46,_0x32cc14){var _0x1b5761=_0x34e14c;$(_0x1b5761(0x17f)+TDID)[_0x1b5761(0x169)]($(_0x1b5761(0x166))['val']()),$(_0x1b5761(0x1a1)+TDID)['text'](_0x1b5761(0x186)),alert(_0x1b5761(0x187)),$('#attendance-reportEdit')[_0x1b5761(0x1c8)](_0x1b5761(0x199)),GetAttendanceorLeaves();},'error':function(_0x199e37,_0xbbe5f7,_0x17dd78){var _0x5d24e1=_0x34e14c;alert(_0x5d24e1(0x18b));}}):alert(_0x34e14c(0x150));}function initializePeoplePicker(_0x4fbf0e){var _0x17d27e=_0x36d2a6,_0x506f92={};_0x506f92[_0x17d27e(0x197)]=_0x17d27e(0x1b0),_0x506f92[_0x17d27e(0x1a7)]=0xf,_0x506f92[_0x17d27e(0x1a0)]=0xf,_0x506f92['AllowMultipleValues']=![],_0x506f92[_0x17d27e(0x1e4)]=0x32,_0x506f92[_0x17d27e(0x143)]=_0x17d27e(0x1dc),this[_0x17d27e(0x165)](_0x4fbf0e,null,_0x506f92);}function Applyfilter(){var _0x65cb76=_0x36d2a6,_0x598ce9=moment($(_0x65cb76(0x19e))[_0x65cb76(0x1c9)](),'LL')[_0x65cb76(0x192)](_0x65cb76(0x1f3)),_0x5c29f1=moment($(_0x65cb76(0x1f6))[_0x65cb76(0x1c9)](),'LL')[_0x65cb76(0x192)](_0x65cb76(0x1f3));if(Date[_0x65cb76(0x157)](_0x598ce9)>Date[_0x65cb76(0x157)](_0x5c29f1))alert(_0x65cb76(0x16d));else{$(_0x65cb76(0x14f))[_0x65cb76(0x1c8)](_0x65cb76(0x199));var _0x1dd323=$[_0x65cb76(0x1a9)](_0x65cb76(0x1ae)),_0x37f9e8=$(_0x65cb76(0x19e))[_0x65cb76(0x162)](_0x65cb76(0x1b9)),_0x16a3a2=$(_0x65cb76(0x1f6))[_0x65cb76(0x162)](_0x65cb76(0x1b9));days=(_0x16a3a2-_0x37f9e8)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math[_0x65cb76(0x155)](days)+0x1,$('#StartDate')[_0x65cb76(0x169)](formatDateReportEmp($('#EmpreportFrom')[_0x65cb76(0x1c9)]())),$('#EndDate')[_0x65cb76(0x169)](formatDateReportEmp($(_0x65cb76(0x1f6))[_0x65cb76(0x1c9)]()));var _0x598ce9=moment($(_0x65cb76(0x19e))[_0x65cb76(0x1c9)](),'LL')[_0x65cb76(0x192)](_0x65cb76(0x1bb)),_0x5c29f1=moment($('#EmpreportTo')[_0x65cb76(0x1c9)](),'LL')[_0x65cb76(0x192)](_0x65cb76(0x1bb)),_0x10cc96=new Date(_0x5c29f1),_0x41b178=_0x10cc96[_0x65cb76(0x1f5)](),_0x18e650=_0x41b178[_0x65cb76(0x1d9)]('T');GstartDate=_0x598ce9;var _0x2e1e2e=ensureUser($('#EmployeeName')[_0x65cb76(0x1ee)]()[_0x65cb76(0x1ee)]()[_0x65cb76(0x1ac)]('id'));if(_0x2e1e2e==0x0){_0x1dd323=_0x1dd323,GEmpID=_0x1dd323;var _0x1d9efe=_spPageContextInfo['webAbsoluteUrl']+_0x65cb76(0x1a4)+_0x598ce9+_0x65cb76(0x1b2)+_0x18e650[0x0]+_0x65cb76(0x1bf)+_0x1dd323+'\x27\x20';getFileData(_0x1d9efe);var _0x5618da=_spPageContextInfo['webAbsoluteUrl']+_0x65cb76(0x1ef)+_0x1dd323+_0x65cb76(0x1e7)+CompanyID+'\x27';EmployeeListDat(_0x5618da);}else{if(ISHRADMIN==!![]){_0x1dd323=_0x2e1e2e,GEmpID=_0x2e1e2e;var _0x1d9efe=_spPageContextInfo['webAbsoluteUrl']+_0x65cb76(0x1a4)+_0x598ce9+_0x65cb76(0x1b2)+_0x18e650[0x0]+_0x65cb76(0x1bf)+_0x1dd323+'\x27\x20';getFileData(_0x1d9efe);var _0x5618da=_spPageContextInfo[_0x65cb76(0x1e9)]+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27'+_0x1dd323+'\x27\x20and\x20Company/ID\x20\x20eq\x20\x27'+CompanyID+'\x27';EmployeeListDat(_0x5618da);}else alert(_0x65cb76(0x1cf));}LoadAllHolidays();}}var DataIdList=[],EmpAttendanceData=[],TotalLeavesorAbsent=[];function getFileData(_0x2a4e24){var _0x3ed4b4=_0x36d2a6;jQuery[_0x3ed4b4(0x1a2)]({'url':_0x2a4e24,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x5b8b9e){var _0x38e2dc=_0x3ed4b4;EmpAttendanceData=[];var _0x35c248=_0x5b8b9e['d'][_0x38e2dc(0x19b)];DataIdList=[];var _0x525e5d=[];TotalLeavesorAbsent=[];for(var _0x180f07=0x0;_0x180f07<_0x35c248[_0x38e2dc(0x154)];_0x180f07++){if(_0x35c248[_0x180f07][_0x38e2dc(0x17d)]!=_0x38e2dc(0x156)&&_0x35c248[_0x180f07][_0x38e2dc(0x17d)]!=_0x38e2dc(0x176))_0x525e5d[_0x38e2dc(0x1f1)](_0x35c248[_0x180f07][_0x38e2dc(0x17d)]);else{if(_0x35c248[_0x180f07][_0x38e2dc(0x17d)]=='On-Leave')TotalLeavesorAbsent[_0x38e2dc(0x1f1)](_0x35c248[_0x180f07][_0x38e2dc(0x17d)]);else _0x35c248[_0x180f07][_0x38e2dc(0x17d)]==_0x38e2dc(0x176)&&TotalLeavesorAbsent['push'](_0x35c248[_0x180f07]['AttendanceType']);}var _0x23cedc=_0x35c248[_0x180f07]['ID'],_0xb2371c=_0x35c248[_0x180f07][_0x38e2dc(0x14e)]['Title'],_0x400a57=_0x35c248[_0x180f07][_0x38e2dc(0x14e)]['ID'],_0x5e1ed1=formatDateReportEmp(_0x35c248[_0x180f07][_0x38e2dc(0x1ed)]),_0x3658cb=_0x35c248[_0x180f07]['AttendanceType'],_0x4eeb41=_0x35c248[_0x180f07][_0x38e2dc(0x15b)],_0x3947f3=_0x35c248[_0x180f07]['HrAction'];EmpAttendanceData['push']({'UserId':_0x400a57,'EmpName':_0xb2371c,'AttendanceDate':_0x5e1ed1,'AttendanceType':_0x3658cb,'AttendanceItemId':_0x23cedc,'EmpWorkHours':_0x4eeb41,'HrAction':_0x3947f3});}var _0x282dff='';$(_0x38e2dc(0x149))[_0x38e2dc(0x13a)]();var _0x595fda=0x0,_0x37178d=0x0;for(var _0x301086=0x0;_0x301086<Totaldays;_0x301086++){var _0x496cef=new Date(GstartDate);_0x496cef['setDate'](_0x496cef[_0x38e2dc(0x1b9)]()+_0x301086);var _0x17a1ee=moment(_0x496cef,_0x38e2dc(0x1e5))['format'](_0x38e2dc(0x1bb)),_0x17a1ee=_0x17a1ee[_0x38e2dc(0x1d9)]('-')[_0x38e2dc(0x191)]('');DataIdList[_0x38e2dc(0x1f1)](_0x17a1ee);var _0x2e9c99=formatDateReportEmp(_0x496cef),_0x3330f2=EmpAttendanceData['map'](function(_0x2dd4af){var _0x171301=_0x38e2dc;return _0x2dd4af[_0x171301(0x1ed)];})[_0x38e2dc(0x1db)](_0x2e9c99);if(_0x3330f2!=-0x1){var _0x597e67=EmpAttendanceData[_0x3330f2][_0x38e2dc(0x17d)],_0xae14a9=EmpAttendanceData[_0x3330f2]['EmpWorkHours'],_0x3947f3=EmpAttendanceData[_0x3330f2]['HrAction'],_0x1bff6b=EmpAttendanceData[_0x3330f2][_0x38e2dc(0x1de)],_0x4a64b2=EmpAttendanceData[_0x3330f2][_0x38e2dc(0x182)],_0x26fa1f=EmpAttendanceData[_0x3330f2][_0x38e2dc(0x1ed)],_0x435c60=_0x38e2dc(0x1cc),_0x5090c6='block';_0x3947f3==!![]&&(_0x435c60=_0x38e2dc(0x12b),_0x5090c6='none');if(_0x597e67!=_0x38e2dc(0x156)&&_0x597e67!=_0x38e2dc(0x176)){if(_0xae14a9==null)var _0x58e270=_0x38e2dc(0x194)+_spPageContextInfo['webAbsoluteUrl']+_0x38e2dc(0x189)+_0x17a1ee+_0x38e2dc(0x172)+window[_0x38e2dc(0x177)](_0x38e2dc(0x12c))+_0x38e2dc(0x12a)+_0x17a1ee+_0x38e2dc(0x171);else var _0x58e270='<a\x20href=\x27'+_spPageContextInfo['webAbsoluteUrl']+'/Pages/TimeSheetEntry.aspx?WebAppId=2&Recall='+_0x17a1ee+_0x38e2dc(0x172)+window['btoa'](_0x38e2dc(0x12c))+'&sourcelocation=../Pages/Myworkplace.aspx\x27>'+ConvertHHMM(_0xae14a9)+'</a>';}else var _0x58e270='';var _0x32a799=![],_0x33c541=Date[_0x38e2dc(0x157)](_0x26fa1f[_0x38e2dc(0x1d9)](',')[0x0]),_0x53467a=new Date(),_0x5220f0=Date[_0x38e2dc(0x157)](moment(_0x53467a)[_0x38e2dc(0x192)]('DD\x20MMM\x20YYYY'));_0x33c541>_0x5220f0&&(_0x32a799=!![]),_0x37178d=_0x37178d+0x1,_0x32a799!=!![]?(_0x282dff+=_0x38e2dc(0x141),_0x282dff+=_0x38e2dc(0x127)+_0x17a1ee+_0x38e2dc(0x139)+formatDateReportEmp(_0x496cef)+_0x38e2dc(0x158)+_0x17a1ee+_0x38e2dc(0x133),_0x282dff+=_0x38e2dc(0x190)+_0x17a1ee+'>'+_0x597e67+'</div></td>',_0x282dff+=_0x38e2dc(0x17a)+_0x17a1ee+'>'+_0x58e270+_0x38e2dc(0x136),_0x282dff+=_0x38e2dc(0x1b7)+_0x435c60+'\x20\x27><label><i\x20class=\x27fa\x20fa-check\x27\x20aria-hidden=\x27true\x27\x20style=\x27color:\x20red;\x27></i></label></div></td>',_0x282dff+=_0x38e2dc(0x135)+_0x5090c6+_0x38e2dc(0x146)+GEmpID+','+_0x4a64b2+','+_0x17a1ee+_0x38e2dc(0x168),_0x282dff+=_0x38e2dc(0x1c3)):(_0x282dff+='<tr\x20class=\x27text-center\x27\x20>',_0x282dff+=_0x38e2dc(0x127)+_0x17a1ee+'><span>'+formatDateReportEmp(_0x496cef)+'</span><span\x20id=\x27H'+_0x17a1ee+_0x38e2dc(0x133),_0x282dff+=_0x38e2dc(0x190)+_0x17a1ee+'>'+_0x597e67+'<a\x20href=\x27#\x27\x20class=\x27Withdraw-Leave-link\x27\x20onclick=\x27WithdrawLeave('+_0x4a64b2+','+_0x17a1ee+_0x38e2dc(0x1e1),_0x282dff+=_0x38e2dc(0x17a)+_0x17a1ee+'>'+_0x58e270+_0x38e2dc(0x136),_0x282dff+=_0x38e2dc(0x1b7)+_0x435c60+'\x20\x27><label><i\x20class=\x27fa\x20fa-check\x27\x20aria-hidden=\x27true\x27\x20style=\x27color:\x20red;\x27></i></label></div></td>',_0x282dff+=_0x38e2dc(0x135)+_0x5090c6+'\x20\x27></div></td>',_0x282dff+='</tr>');}else{var _0x3d092e=formatDateReportEmp(_0x496cef),_0x32a799=![],_0x33c541=Date['parse'](_0x3d092e[_0x38e2dc(0x1d9)](',')[0x0]),_0x53467a=new Date(),_0x5220f0=Date[_0x38e2dc(0x157)](moment(_0x53467a)[_0x38e2dc(0x192)](_0x38e2dc(0x1f3)));_0x33c541>_0x5220f0&&(_0x32a799=!![]);_0x595fda=_0x595fda+0x1;if(_0x32a799!=!![]){var _0x3e347b=_0x38e2dc(0x194)+_spPageContextInfo[_0x38e2dc(0x1e9)]+_0x38e2dc(0x189)+_0x17a1ee+_0x38e2dc(0x172)+window[_0x38e2dc(0x177)]('View')+'&sourcelocation=../Pages/Myworkplace.aspx\x27\x20><span\x20id=\x27Timeview'+_0x17a1ee+_0x38e2dc(0x171);_0x282dff+=_0x38e2dc(0x141),_0x282dff+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id='+_0x17a1ee+_0x38e2dc(0x139)+formatDateReportEmp(_0x496cef)+'</span><span\x20id=\x27H'+_0x17a1ee+_0x38e2dc(0x133),_0x282dff+=_0x38e2dc(0x190)+_0x17a1ee+_0x38e2dc(0x19c),_0x282dff+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Time'+_0x17a1ee+_0x38e2dc(0x19c),_0x282dff+=_0x38e2dc(0x16c),_0x282dff+='<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27><a\x20href=\x27#\x27\x20class=\x27custom-edit-btn\x27\x20data-toggle=\x27modal\x27\x20data-target=\x27#attendance-reportEdit\x27\x20onclick=\x27attendanceEditModal('+GEmpID+_0x38e2dc(0x1c5)+_0x17a1ee+_0x38e2dc(0x168),_0x282dff+=_0x38e2dc(0x1c3);}else{var _0x3e347b=_0x38e2dc(0x194)+_spPageContextInfo['webAbsoluteUrl']+_0x38e2dc(0x189)+_0x17a1ee+_0x38e2dc(0x172)+window[_0x38e2dc(0x177)](_0x38e2dc(0x12c))+_0x38e2dc(0x12a)+_0x17a1ee+_0x38e2dc(0x171);_0x282dff+=_0x38e2dc(0x141),_0x282dff+=_0x38e2dc(0x127)+_0x17a1ee+_0x38e2dc(0x139)+formatDateReportEmp(_0x496cef)+_0x38e2dc(0x158)+_0x17a1ee+_0x38e2dc(0x133),_0x282dff+=_0x38e2dc(0x190)+_0x17a1ee+_0x38e2dc(0x19c),_0x282dff+=_0x38e2dc(0x17a)+_0x17a1ee+_0x38e2dc(0x19c),_0x282dff+=_0x38e2dc(0x16c),_0x282dff+=_0x38e2dc(0x1aa),_0x282dff+=_0x38e2dc(0x1c3);}}}var _0x194d4b=$[_0x38e2dc(0x128)](_0x35c248,function(_0x2aaeb0){var _0x1bccd2=_0x38e2dc;return _0x2aaeb0[_0x1bccd2(0x17d)]!=_0x1bccd2(0x156)&&_0x2aaeb0['AttendanceType']!=_0x1bccd2(0x176);}),_0x5a85a1=parseInt(TotalLeavesorAbsent[_0x38e2dc(0x154)])+parseInt(_0x595fda)-parseInt($(_0x38e2dc(0x178))[_0x38e2dc(0x169)]());_0x5a85a1<0x0&&(_0x5a85a1=0x0);$(_0x38e2dc(0x1b5))[_0x38e2dc(0x199)](),$(_0x38e2dc(0x1eb))[_0x38e2dc(0x169)](Totaldays);var _0x49e5fd=parseInt(_0x37178d)-parseInt(TotalLeavesorAbsent[_0x38e2dc(0x154)]);$(_0x38e2dc(0x1b8))[_0x38e2dc(0x169)](_0x194d4b[_0x38e2dc(0x154)]),$(_0x38e2dc(0x149))['append'](_0x282dff),EmpTableConfiguration();},'error':function(_0x4eb688,_0x11a06a){var _0x568288=_0x3ed4b4;console[_0x568288(0x1d4)](JSON[_0x568288(0x17b)](_0x4eb688));}});}function WithdrawLeave(_0x369a16,_0x5c8a1d){var _0x446eb3=_0x36d2a6;confirm(_0x446eb3(0x1e0))&&$['ajax']({'url':_spPageContextInfo[_0x446eb3(0x1e9)]+_0x446eb3(0x19f)+_0x369a16+')','type':_0x446eb3(0x142),'headers':{'X-RequestDigest':$(_0x446eb3(0x161))[_0x446eb3(0x1c9)](),'IF-MATCH':'*','X-HTTP-Method':'DELETE'},'success':function(_0x79a771,_0x53a447,_0x70b558){var _0x149f47=_0x446eb3;$(_0x149f47(0x17f)+_0x5c8a1d)[_0x149f47(0x14c)](_0x149f47(0x173),_0x149f47(0x1cc)),alert(_0x149f47(0x1cd));},'error':function(_0x3306ab,_0x2f283b,_0x1cec1b){var _0x17083d=_0x446eb3;$(_0x17083d(0x1ad))['empty']()[_0x17083d(0x169)](data['responseJSON'][_0x17083d(0x16e)]);}});}function ConvertDateTimeFormat(_0x56e75c,_0x2f142d){var _0x21e3ad=_0x36d2a6;return _0x56e75c[_0x21e3ad(0x1d9)](_0x2f142d)[0x1]+''+_0x2f142d+''+_0x56e75c[_0x21e3ad(0x1d9)](_0x2f142d)[0x0]+''+_0x2f142d+''+_0x56e75c[_0x21e3ad(0x1d9)](_0x2f142d)[0x2];}var GEmployeeID=0x0,LocID=0x0;function EmployeeListDat(_0x1e7465){var _0x43198c=_0x36d2a6;GEmployeeID=0x0,$[_0x43198c(0x1a2)]({'url':_0x1e7465,'headers':{'Accept':_0x43198c(0x179)},'async':![],'success':function(_0x592e4d){var _0x1db302=_0x43198c,_0x2ff174=_0x592e4d['d']['results'];_0x2ff174['length']>0x0?($(_0x1db302(0x1c2))[_0x1db302(0x169)](_0x2ff174[0x0]['LogonName']['Title']),GEmployeeID=_0x2ff174[0x0][_0x1db302(0x18a)]['ID'],$(_0x1db302(0x14b))['text'](_0x2ff174[0x0][_0x1db302(0x18a)][_0x1db302(0x1a5)]),$(_0x1db302(0x195))[_0x1db302(0x169)](_0x2ff174[0x0]['OfficeLocation'][_0x1db302(0x188)]),$(_0x1db302(0x151))[_0x1db302(0x169)](_0x2ff174[0x0][_0x1db302(0x18c)][_0x1db302(0x188)]),LocID=_0x2ff174[0x0][_0x1db302(0x18c)]['ID']):($(_0x1db302(0x1c2))[_0x1db302(0x169)](''),$(_0x1db302(0x195))[_0x1db302(0x169)](''),LocID=0x0);},'error':function(_0x4d0940){var _0x4c6999=_0x43198c;console[_0x4c6999(0x1d4)](_0x4d0940);}});}function EmpTableConfiguration(){var _0x5095f4=_0x36d2a6;sorter=new TINY[(_0x5095f4(0x16b))][(_0x5095f4(0x13d))](_0x5095f4(0x13d),_0x5095f4(0x16f),{'ascclass':_0x5095f4(0x18d),'descclass':_0x5095f4(0x12f),'evenclass':_0x5095f4(0x1d6),'oddclass':_0x5095f4(0x1a8),'evenselclass':'evenselected','oddselclass':_0x5095f4(0x1ba),'paginate':!![],'size':0xa,'colddid':_0x5095f4(0x1bc),'currentid':'Empcurrentpage','totalid':_0x5095f4(0x1ab),'startingrecid':_0x5095f4(0x1a6),'endingrecid':_0x5095f4(0x183),'totalrecid':'Emptotalrecords','hoverid':'selectedrow','pageddid':'Emppagedropdown','navid':_0x5095f4(0x153),'sortdir':0x1,'init':!![]});}$[_0x36d2a6(0x1a9)]=function(_0x794a0d){var _0x232bbf=_0x36d2a6,_0x2961ad=new RegExp(_0x232bbf(0x1ca)+_0x794a0d+_0x232bbf(0x1a3))[_0x232bbf(0x147)](window['location'][_0x232bbf(0x140)]);if(_0x2961ad==null)return null;return decodeURI(_0x2961ad[0x1])||0x0;};function formatDateReportEmp(_0x3495c7){var _0x46b0e3=_0x36d2a6,_0x4e55d6=[_0x46b0e3(0x152),_0x46b0e3(0x1cb),_0x46b0e3(0x16a),_0x46b0e3(0x15c),_0x46b0e3(0x170),'Friday',_0x46b0e3(0x1dd)],_0xa99e3f=new Date(_0x3495c7);if(isNaN(_0xa99e3f['getTime']()))return _0x3495c7;else{var _0x210bff=new Array();return _0x210bff[0x0]=_0x46b0e3(0x129),_0x210bff[0x1]=_0x46b0e3(0x167),_0x210bff[0x2]='Mar',_0x210bff[0x3]='Apr',_0x210bff[0x4]=_0x46b0e3(0x148),_0x210bff[0x5]=_0x46b0e3(0x198),_0x210bff[0x6]=_0x46b0e3(0x130),_0x210bff[0x7]=_0x46b0e3(0x184),_0x210bff[0x8]='Sept',_0x210bff[0x9]=_0x46b0e3(0x1c4),_0x210bff[0xa]='Nov',_0x210bff[0xb]=_0x46b0e3(0x1af),day=_0xa99e3f[_0x46b0e3(0x1b9)](),day<0xa&&(day='0'+day),day+'\x20'+_0x210bff[_0xa99e3f[_0x46b0e3(0x14d)]()]+'\x20'+_0xa99e3f['getFullYear']()+',\x20'+_0x4e55d6[_0xa99e3f[_0x46b0e3(0x1ea)]()];}}function ConvertHHMM(_0x3fda10){var _0x2fd51a=_0x36d2a6;if(_0x3fda10!=null){var _0x1e0081=Math[_0x2fd51a(0x144)](_0x3fda10/0x3c),_0x50c93c=_0x3fda10%0x3c;_0x1e0081<0xa&&(_0x1e0081='0'+_0x1e0081);_0x50c93c<0xa&&(_0x50c93c='0'+_0x50c93c);var _0x117839=_0x1e0081+':'+_0x50c93c;}else var _0x117839='';return _0x117839;}var AttandenceOnHolidays=0x0,HolidaysListDTL=[];function LoadAllHolidays(){var _0x65cdc9=_0x36d2a6;TotalOfficeDays=0x0,HolidaysListDTL=[];var _0x5f0b64=new Date($(_0x65cdc9(0x19e))[_0x65cdc9(0x1c9)]()),_0x451a1=_0x5f0b64['getFullYear']()+'-'+(_0x5f0b64[_0x65cdc9(0x14d)]()+0x1)+'-'+_0x5f0b64[_0x65cdc9(0x1b9)](),_0x3bb42c=new Date($(_0x65cdc9(0x1f6))[_0x65cdc9(0x1c9)]()),_0xa8941e=_0x3bb42c[_0x65cdc9(0x1d5)]()+'-'+(_0x3bb42c[_0x65cdc9(0x14d)]()+0x1)+'-'+_0x3bb42c['getDate'](),_0x377ea7=_spPageContextInfo[_0x65cdc9(0x1e9)]+_0x65cdc9(0x19d)+LocID+'\x27\x20and\x20CompanyID\x20eq\x20\x27'+CompanyID+'\x27\x20and\x20Holiday_start\x20ge\x20\x27'+_0x451a1+_0x65cdc9(0x1d1)+_0xa8941e+'\x27';$[_0x65cdc9(0x1a2)]({'url':_0x377ea7,'headers':{'Accept':_0x65cdc9(0x179)},'async':![],'success':function(_0x4e9b16){var _0x1a9b1a=_0x65cdc9,_0x585dac=_0x4e9b16['d'][_0x1a9b1a(0x19b)][_0x1a9b1a(0x154)],_0xa643f4=0x0;for(var _0x417f80=0x0;_0x417f80<_0x585dac;_0x417f80++){var _0x560348=new Date(_0x4e9b16['d'][_0x1a9b1a(0x19b)][_0x417f80][_0x1a9b1a(0x181)]),_0x288814=moment(_0x560348,'DD/MM/YYYY')[_0x1a9b1a(0x192)](_0x1a9b1a(0x1bb)),_0x288814=_0x288814[_0x1a9b1a(0x1d9)]('-')[_0x1a9b1a(0x191)](''),_0x1ca6dd=_0x4e9b16['d'][_0x1a9b1a(0x19b)][_0x417f80][_0x1a9b1a(0x1a5)];HolidaysListDTL[_0x1a9b1a(0x1f1)]({'Hdate':_0x288814,'Title':_0x1ca6dd}),$('#'+_0x288814)[_0x1a9b1a(0x14c)](_0x1a9b1a(0x1b1),_0x1a9b1a(0x15a)),$('#H'+_0x288814)[_0x1a9b1a(0x169)](_0x1a9b1a(0x18f)+_0x1ca6dd),$(_0x1a9b1a(0x17f)+_0x288814)[_0x1a9b1a(0x169)]()!=''&&(_0xa643f4=_0xa643f4+0x1);}AttandenceOnHolidays=0x0;for(var _0x4f9fa3=0x0;_0x4f9fa3<HolidaysListDTL['length'];_0x4f9fa3++){var _0x3dd951=$(_0x1a9b1a(0x17f)+HolidaysListDTL[_0x4f9fa3][_0x1a9b1a(0x159)])[_0x1a9b1a(0x169)]();_0x3dd951!=''&&_0x3dd951!=_0x1a9b1a(0x156)&&_0x3dd951!='Holiday'&&(AttandenceOnHolidays=AttandenceOnHolidays+0x1);}var _0x5568a2=0x0,_0x4c6e5a=0x0,_0x19c0ae=0x0;for(var _0x3b9684=0x0;_0x3b9684<DataIdList['length'];_0x3b9684++){var _0x55a2e7=$(_0x1a9b1a(0x17f)+DataIdList[_0x3b9684])[_0x1a9b1a(0x169)]();_0x55a2e7==_0x1a9b1a(0x15f)&&(_0x55a2e7=_0x55a2e7[_0x1a9b1a(0x1d9)]('Withdraw')[0x0]),(_0x55a2e7==''||_0x55a2e7==_0x1a9b1a(0x156))&&(_0x4c6e5a=_0x4c6e5a+0x1),_0x55a2e7==_0x1a9b1a(0x156)&&(_0x19c0ae=_0x19c0ae+0x1),_0x55a2e7==_0x1a9b1a(0x176)&&(_0x5568a2=_0x5568a2+0x1);}var _0x81027d=_0x4c6e5a+AttandenceOnHolidays-(_0x585dac-_0x5568a2);_0x81027d<0x0&&(_0x81027d=0x0),_0x81027d!='0'?$(_0x1a9b1a(0x196))['text'](_0x81027d):_0x19c0ae>0x0&&$('#Total-Leave-Absent')[_0x1a9b1a(0x169)](_0x19c0ae),$(_0x1a9b1a(0x178))[_0x1a9b1a(0x169)](_0x585dac),$(_0x1a9b1a(0x1d3))[_0x1a9b1a(0x169)](parseInt(Totaldays)-parseInt(_0x585dac)),$(_0x1a9b1a(0x1da))[_0x1a9b1a(0x169)](formatDateReportEmp(ConvertDateTimeFormat($(_0x1a9b1a(0x19e))[_0x1a9b1a(0x1c9)](),'/'))),$(_0x1a9b1a(0x134))[_0x1a9b1a(0x169)](formatDateReportEmp(ConvertDateTimeFormat($('#EmpreportTo')[_0x1a9b1a(0x1c9)](),'/'))),$(_0x1a9b1a(0x145))[_0x1a9b1a(0x169)](parseInt(Totaldays)-parseInt(_0x585dac)),$('#HolidaysTH')['text'](_0x585dac);},'myError':function(_0x34ab4a){}});}function ensureUser(_0x4a9da5){var _0x42d61c=_0x36d2a6,_0x4840a6=0x0,_0x2d3747=_0x4a9da5,_0x17ad6b=this[_0x42d61c(0x185)]['SPClientPeoplePickerDict'][_0x2d3747],_0x4efce6=_0x17ad6b[_0x42d61c(0x1bd)](),_0x1650fa=_0x4efce6[0x0];if(_0x1650fa){var _0x97ff3b={'logonName':_0x1650fa[_0x42d61c(0x193)]};$[_0x42d61c(0x1a2)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x42d61c(0x1f0),'type':_0x42d61c(0x142),'async':![],'contentType':_0x42d61c(0x179),'data':JSON[_0x42d61c(0x17b)](_0x97ff3b),'headers':{'X-RequestDigest':$(_0x42d61c(0x161))['val'](),'accept':_0x42d61c(0x179)},'success':function(_0x265812,_0x1e05c9,_0x73ec57){_0x4840a6=_0x265812['d']['Id'];},'error':function(_0x56e94c,_0x47e12b,_0x22bb9b){}});}else _0x4840a6=0x0;return _0x4840a6;}function _0x121b(_0x47be94,_0x531752){var _0x142b06=_0x142b();return _0x121b=function(_0x121b2d,_0x4f01c3){_0x121b2d=_0x121b2d-0x125;var _0x3e6bcf=_0x142b06[_0x121b2d];return _0x3e6bcf;},_0x121b(_0x47be94,_0x531752);}var tableToExcel=(function(){var _0x5b5985=_0x36d2a6,_0x1b3a21=_0x5b5985(0x13b),_0x4aed0b=_0x5b5985(0x1e8),_0x1a8026=function(_0x568a86){var _0x4219e9=_0x5b5985;return window[_0x4219e9(0x177)](unescape(encodeURIComponent(_0x568a86)));},_0x5b9b25=function(_0x23196b,_0x4f460b){return _0x23196b['replace'](/{(\w+)}/g,function(_0x10d06a,_0x18e9ed){return _0x4f460b[_0x18e9ed];});};return function(_0x23304d,_0x4bbd2c){var _0x57d533=_0x5b5985;if(!_0x23304d[_0x57d533(0x131)])_0x23304d=document['getElementById'](_0x23304d);var _0x2c08d9={'worksheet':_0x4bbd2c||_0x57d533(0x1d7),'table':_0x23304d['innerHTML']};window[_0x57d533(0x1d2)]['href']=_0x1b3a21+_0x1a8026(_0x5b9b25(_0x4aed0b,_0x2c08d9));};}()),ISHRADMIN=![];function ValidateHrAdmin(){var _0x805e4f=_0x36d2a6,_0x2b4b55=_0x805e4f(0x1d0),_0x14e6b2=_spPageContextInfo[_0x805e4f(0x1e9)]+'/_api/web/lists/getbytitle(\x27'+_0x2b4b55+'\x27)/items?$select=*,Department/DepartmentName,Department/ID&$expand=Department&$filter=CompanyId\x20eq\x20\x27'+titanForWork[_0x805e4f(0x164)](_0x805e4f(0x13c))+_0x805e4f(0x174)+_spPageContextInfo[_0x805e4f(0x1df)]+_0x805e4f(0x18e);$[_0x805e4f(0x1a2)]({'url':_0x14e6b2,'async':![],'type':_0x805e4f(0x1b4),'headers':{'Accept':_0x805e4f(0x179)},'success':function(_0xa779f0){var _0x1be33c=_0x805e4f,_0x28a7b2=_0xa779f0['d'][_0x1be33c(0x19b)];_0x28a7b2[_0x1be33c(0x154)]>0x0?($(_0x1be33c(0x138))[_0x1be33c(0x14c)](_0x1be33c(0x173),'block'),ISHRADMIN=!![]):(ISHRADMIN=![],$(_0x1be33c(0x138))[_0x1be33c(0x199)]());},'error':function(_0x8a63e5){var _0x20d291=_0x805e4f;console['log'](_0x8a63e5[_0x20d291(0x15d)]['error']);}});}function GetAttendanceorLeaves(){var _0x4e04c7=_0x36d2a6,_0x42b93d=$[_0x4e04c7(0x1a9)](_0x4e04c7(0x1ae)),_0x1e2fc0=$(_0x4e04c7(0x19e))[_0x4e04c7(0x162)]('getDate'),_0x552685=$(_0x4e04c7(0x1f6))['datepicker'](_0x4e04c7(0x1b9));days=(_0x552685-_0x1e2fc0)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math[_0x4e04c7(0x155)](days)+0x1,$(_0x4e04c7(0x1ce))[_0x4e04c7(0x169)](formatDateReportEmp($('#EmpreportFrom')[_0x4e04c7(0x1c9)]())),$(_0x4e04c7(0x19a))[_0x4e04c7(0x169)](formatDateReportEmp($(_0x4e04c7(0x1f6))[_0x4e04c7(0x1c9)]()));var _0x8047e9=moment($(_0x4e04c7(0x19e))[_0x4e04c7(0x1c9)](),'LL')[_0x4e04c7(0x192)](_0x4e04c7(0x1bb)),_0x7f955b=moment($('#EmpreportTo')[_0x4e04c7(0x1c9)](),'LL')[_0x4e04c7(0x192)](_0x4e04c7(0x1bb)),_0x1e3c84=new Date(_0x7f955b),_0x1e23ff=_0x1e3c84[_0x4e04c7(0x1f5)](),_0x536e29=_0x1e23ff[_0x4e04c7(0x1d9)]('T');GstartDate=_0x8047e9;var _0x29489e=ensureUser($('#EmployeeName')[_0x4e04c7(0x1ee)]()[_0x4e04c7(0x1ee)]()[_0x4e04c7(0x1ac)]('id'));if(_0x29489e==0x0){var _0x3d2885=_spPageContextInfo[_0x4e04c7(0x1e9)]+_0x4e04c7(0x1ef)+_0x42b93d+_0x4e04c7(0x1e7)+CompanyID+'\x27';EmployeeListDat(_0x3d2885),LoadAllHolidays(),_0x42b93d=_0x42b93d,GEmpID=_0x42b93d;var _0x1e0ac7=_spPageContextInfo[_0x4e04c7(0x1e9)]+_0x4e04c7(0x1a4)+_0x8047e9+_0x4e04c7(0x1b2)+_0x536e29+_0x4e04c7(0x1bf)+_0x42b93d+'\x27\x20';UpdateHeaderfields(_0x1e0ac7);}else{if(ISHRADMIN==!![]){_0x42b93d=_0x29489e,GEmpID=_0x29489e;var _0x3d2885=_spPageContextInfo[_0x4e04c7(0x1e9)]+_0x4e04c7(0x1ef)+_0x42b93d+_0x4e04c7(0x1e7)+CompanyID+'\x27';EmployeeListDat(_0x3d2885),LoadAllHolidays();var _0x1e0ac7=_spPageContextInfo[_0x4e04c7(0x1e9)]+'/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27'+_0x8047e9+_0x4e04c7(0x1b2)+_0x536e29+_0x4e04c7(0x1bf)+_0x42b93d+'\x27\x20';UpdateHeaderfields(_0x1e0ac7);var _0x3d2885=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27'+_0x42b93d+_0x4e04c7(0x1e7)+CompanyID+'\x27';}else alert(_0x4e04c7(0x1cf));}LoadAllHolidays();}function GetFilterData(_0x4ac61b){var _0x27569a=_0x36d2a6;jQuery[_0x27569a(0x1a2)]({'url':_0x4ac61b,'headers':{'Accept':_0x27569a(0x179)},'async':![],'success':function(_0x17e060){var _0xd66fe5=_0x27569a,_0x1a7ab6=_0x17e060['d'][_0xd66fe5(0x19b)],_0x493dac=[];TotalLeavesorAbsent=[];for(var _0xdcb082=0x0;_0xdcb082<_0x1a7ab6[_0xd66fe5(0x154)];_0xdcb082++){if(_0x1a7ab6[_0xdcb082][_0xd66fe5(0x17d)]!=_0xd66fe5(0x156)&&_0x1a7ab6[_0xdcb082][_0xd66fe5(0x17d)]!=_0xd66fe5(0x176))_0x493dac[_0xd66fe5(0x1f1)](_0x1a7ab6[_0xdcb082][_0xd66fe5(0x17d)]);else _0x1a7ab6[_0xdcb082][_0xd66fe5(0x17d)]=='On-Leave'&&TotalLeavesorAbsent[_0xd66fe5(0x1f1)](_0x1a7ab6[_0xdcb082][_0xd66fe5(0x17d)]);}var _0xa73ede=$[_0xd66fe5(0x128)](_0x1a7ab6,function(_0x540a2b){var _0x31fa00=_0xd66fe5;return _0x540a2b[_0x31fa00(0x17d)]!=_0x31fa00(0x156)&&_0x540a2b[_0x31fa00(0x17d)]!=_0x31fa00(0x176);});$('#Total-Attendance')[_0xd66fe5(0x169)](_0xa73ede['length']);},'error':function(_0x2fd011,_0x47a0f7){console['log'](JSON['stringify'](_0x2fd011));}});}var G_Validateholiday=![];function GetHolidays(_0x545ab7){var _0x2044d8=_0x36d2a6,_0x2ed27b=_spPageContextInfo[_0x2044d8(0x1e9)]+_0x2044d8(0x1e3)+LocID+_0x2044d8(0x1f4)+_0x545ab7+'\x27\x20and\x20CompanyID\x20eq\x20\x27'+titanForWork['getQueryStringParameter']('CompanyId')+_0x2044d8(0x1d8);$[_0x2044d8(0x1a2)]({'url':_0x2ed27b,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x4d6f0c){var _0x4c56ee=_0x2044d8,_0x32cb93=_0x4d6f0c['d'][_0x4c56ee(0x19b)];_0x32cb93[_0x4c56ee(0x154)]>0x0?($(_0x4c56ee(0x17c))['text'](_0x32cb93[0x0][_0x4c56ee(0x1a5)]),$(_0x4c56ee(0x13e))[_0x4c56ee(0x14c)](_0x4c56ee(0x173),_0x4c56ee(0x12b)),G_Validateholiday=!![]):($(_0x4c56ee(0x17c))['text'](''),$(_0x4c56ee(0x13e))[_0x4c56ee(0x14c)](_0x4c56ee(0x173),_0x4c56ee(0x1cc)),G_Validateholiday=![]);},'error':function(_0x3b9de0){var _0x3323c5=_0x2044d8;alert(_0x3323c5(0x1f2));}});}var EmpAttendanceData=[],TotalLeavesorAbsent=[];function UpdateHeaderfields(_0x27359f){var _0x272de7=_0x36d2a6;jQuery['ajax']({'url':_0x27359f,'headers':{'Accept':_0x272de7(0x179)},'async':!![],'success':function(_0x57ea5f){var _0x2979a4=_0x272de7;EmpAttendanceData=[];var _0x531c65=_0x57ea5f['d'][_0x2979a4(0x19b)],_0x961ee5=[];TotalLeavesorAbsent=[];for(var _0x55f68a=0x0;_0x55f68a<_0x531c65[_0x2979a4(0x154)];_0x55f68a++){if(_0x531c65[_0x55f68a][_0x2979a4(0x17d)]!=_0x2979a4(0x156)&&_0x531c65[_0x55f68a][_0x2979a4(0x17d)]!='Holiday')_0x961ee5['push'](_0x531c65[_0x55f68a]['AttendanceType']);else{if(_0x531c65[_0x55f68a][_0x2979a4(0x17d)]==_0x2979a4(0x156))TotalLeavesorAbsent[_0x2979a4(0x1f1)](_0x531c65[_0x55f68a][_0x2979a4(0x17d)]);else _0x531c65[_0x55f68a]['AttendanceType']==_0x2979a4(0x176)&&TotalLeavesorAbsent['push'](_0x531c65[_0x55f68a][_0x2979a4(0x17d)]);}var _0x3257c6=_0x531c65[_0x55f68a]['ID'],_0x47ce08=_0x531c65[_0x55f68a][_0x2979a4(0x14e)][_0x2979a4(0x1a5)],_0x46ec53=_0x531c65[_0x55f68a]['Employee']['ID'],_0x281ffb=formatDateReportEmp(_0x531c65[_0x55f68a][_0x2979a4(0x1ed)]),_0x1476e5=_0x531c65[_0x55f68a][_0x2979a4(0x17d)],_0x4c2821=_0x531c65[_0x55f68a][_0x2979a4(0x15b)],_0x5b11ff=_0x531c65[_0x55f68a][_0x2979a4(0x160)];EmpAttendanceData['push']({'UserId':_0x46ec53,'EmpName':_0x47ce08,'AttendanceDate':_0x281ffb,'AttendanceType':_0x1476e5,'AttendanceItemId':_0x3257c6,'EmpWorkHours':_0x4c2821,'HrAction':_0x5b11ff});}var _0x2b22eb='',_0x3dc878=0x0,_0x127178=0x0;for(var _0x456eb9=0x0;_0x456eb9<Totaldays;_0x456eb9++){var _0x4d5724=new Date(GstartDate);_0x4d5724['setDate'](_0x4d5724[_0x2979a4(0x1b9)]()+_0x456eb9);var _0x4a5c60=moment(_0x4d5724,_0x2979a4(0x1e5))[_0x2979a4(0x192)](_0x2979a4(0x1bb)),_0x4a5c60=_0x4a5c60[_0x2979a4(0x1d9)]('-')[_0x2979a4(0x191)](''),_0x80eae5=formatDateReportEmp(_0x4d5724),_0x37fb08=EmpAttendanceData[_0x2979a4(0x175)](function(_0x5871c7){var _0x3fc4b3=_0x2979a4;return _0x5871c7[_0x3fc4b3(0x1ed)];})[_0x2979a4(0x1db)](_0x80eae5);if(_0x37fb08!=-0x1){var _0x22f69e=EmpAttendanceData[_0x37fb08][_0x2979a4(0x17d)],_0x37960f=EmpAttendanceData[_0x37fb08][_0x2979a4(0x1be)],_0x5b11ff=EmpAttendanceData[_0x37fb08][_0x2979a4(0x160)],_0x26ae68=EmpAttendanceData[_0x37fb08]['UserId'],_0x520eae=EmpAttendanceData[_0x37fb08][_0x2979a4(0x182)];_0x127178=_0x127178+0x1;}else _0x3dc878=_0x3dc878+0x1;}var _0x17e957=parseInt(TotalLeavesorAbsent[_0x2979a4(0x154)])+parseInt(_0x3dc878)-parseInt($('#HoliaysTotal')['text']());_0x17e957<0x0&&(_0x17e957=0x0);$(_0x2979a4(0x1eb))[_0x2979a4(0x169)](Totaldays);var _0x42a962=parseInt(_0x127178)-parseInt(TotalLeavesorAbsent[_0x2979a4(0x154)]),_0x494863=$[_0x2979a4(0x128)](_0x531c65,function(_0x5602ab){var _0x4c3721=_0x2979a4;return _0x5602ab[_0x4c3721(0x17d)]!=_0x4c3721(0x156)&&_0x5602ab[_0x4c3721(0x17d)]!=_0x4c3721(0x176);});$(_0x2979a4(0x1b8))['text'](_0x494863[_0x2979a4(0x154)]);},'error':function(_0x55c2af,_0x2a5d9f){var _0x4d5435=_0x272de7;console[_0x4d5435(0x1d4)](JSON[_0x4d5435(0x17b)](_0x55c2af));}});}