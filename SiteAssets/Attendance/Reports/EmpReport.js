var a6_0x525372=a6_0x571d;(function(_0x177ff9,_0x372f41){var _0x1ebc50=a6_0x571d,_0x2f5946=_0x177ff9();while(!![]){try{var _0x401b80=parseInt(_0x1ebc50(0x1ca))/0x1+-parseInt(_0x1ebc50(0x283))/0x2*(parseInt(_0x1ebc50(0x233))/0x3)+parseInt(_0x1ebc50(0x1f9))/0x4*(-parseInt(_0x1ebc50(0x23d))/0x5)+parseInt(_0x1ebc50(0x234))/0x6*(-parseInt(_0x1ebc50(0x23f))/0x7)+-parseInt(_0x1ebc50(0x215))/0x8*(parseInt(_0x1ebc50(0x25d))/0x9)+parseInt(_0x1ebc50(0x260))/0xa*(-parseInt(_0x1ebc50(0x235))/0xb)+parseInt(_0x1ebc50(0x272))/0xc;if(_0x401b80===_0x372f41)break;else _0x2f5946['push'](_0x2f5946['shift']());}catch(_0x4440b2){_0x2f5946['push'](_0x2f5946['shift']());}}}(a6_0x43df,0x96a2b));function a6_0x571d(_0x46e66b,_0x4aba2f){var _0x43df11=a6_0x43df();return a6_0x571d=function(_0x571dc7,_0x362cde){_0x571dc7=_0x571dc7-0x1b6;var _0x386e33=_0x43df11[_0x571dc7];return _0x386e33;},a6_0x571d(_0x46e66b,_0x4aba2f);}var Totaldays=0x0,CompanyID='',GstartDate='',GEmpID=0x0;$(document)[a6_0x525372(0x245)](function(){var _0x575315=a6_0x525372;ValidateHrAdmin(),CompanyID=titanForWork[_0x575315(0x1f6)](_0x575315(0x264));var _0x1027a4=$[_0x575315(0x1c3)]('EID'),_0x57ec73=$[_0x575315(0x1c3)](_0x575315(0x203)),_0x930e4=$[_0x575315(0x1c3)](_0x575315(0x1d3));if(_0x1027a4!=null){GEmpID=_0x1027a4;var _0x345cbf=_0x57ec73[_0x575315(0x1bb)](0x0,0x4)+'-'+_0x57ec73['slice'](0x4,0x6)+'-'+_0x57ec73[_0x575315(0x1bb)](0x6,0x8),_0x16ec79=_0x930e4[_0x575315(0x1bb)](0x0,0x4)+'-'+_0x930e4['slice'](0x4,0x6)+'-'+_0x930e4['slice'](0x6,0x8),_0x3df1de=new Date(_0x16ec79),_0x53a6a0=_0x3df1de[_0x575315(0x212)](),_0x1e02fa=_0x53a6a0[_0x575315(0x286)]('T');GstartDate=_0x345cbf,$(_0x575315(0x1d7))[_0x575315(0x1ee)]({'dateFormat':_0x575315(0x27f)})[_0x575315(0x1ee)](_0x575315(0x23b),new Date(_0x345cbf)),$(_0x575315(0x230))[_0x575315(0x1ee)]({'dateFormat':'MM\x20dd,\x20yy'})[_0x575315(0x1ee)](_0x575315(0x23b),new Date(_0x16ec79));var _0x5d63b3=$(_0x575315(0x1d7))[_0x575315(0x1ee)](_0x575315(0x262)),_0x3f2630=$(_0x575315(0x230))['datepicker']('getDate');days=(_0x3f2630-_0x5d63b3)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math[_0x575315(0x242)](days)+0x1,$('#StartDate')[_0x575315(0x1b7)](formatDateReportEmp($(_0x575315(0x1d7))[_0x575315(0x25e)]())),$(_0x575315(0x221))[_0x575315(0x1b7)](formatDateReportEmp($('#EmpreportTo')[_0x575315(0x25e)]()));var _0x168b60=_spPageContextInfo[_0x575315(0x1c6)]+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27'+_0x1027a4+_0x575315(0x201)+CompanyID+'\x27';EmployeeListDat(_0x168b60),LoadAllHolidays();var _0x8fc48f=_spPageContextInfo[_0x575315(0x1c6)]+_0x575315(0x277)+_0x345cbf+'\x27\x20and\x20AttendanceDate\x20le\x20\x27'+_0x1e02fa[0x0]+'\x27\x20and\x20Employee\x20eq\x20\x27'+_0x1027a4+'\x27\x20';getFileData(_0x8fc48f);var _0x168b60=_spPageContextInfo[_0x575315(0x1c6)]+_0x575315(0x258)+_0x1027a4+_0x575315(0x201)+CompanyID+'\x27';EmployeeListDat(_0x168b60),LoadAllHolidays(),initializePeoplePicker(_0x575315(0x1e0));}});var EmployeeID='',ItemID='',SelectedDate='',TDID='';function attendanceEditModal(_0x567604,_0x231efb,_0x16e675){var _0x471192=a6_0x525372;EmployeeID=0x0,ItemID=0x0,SelectedDate='',TDID=_0x16e675,EmployeeID=_0x567604,ItemID=_0x231efb;var _0x6ab8fc=_0x16e675[_0x471192(0x1dc)](),_0x149d9e=_0x6ab8fc[_0x471192(0x1bb)](0x0,0x4)+'-'+_0x6ab8fc[_0x471192(0x1bb)](0x4,0x6)+'-'+_0x6ab8fc[_0x471192(0x1bb)](0x6,0x8),_0x3b58bf=new Date(_0x149d9e);SelectedDate=_0x3b58bf[_0x471192(0x212)]()[_0x471192(0x286)]('T')[0x0];var _0x44b8b8=formatDateReportEmp(_0x3b58bf);$('#SelDate')['text'](_0x44b8b8),GetHolidays(_0x149d9e);}function UpdateAttendance(){var _0x4c2fed=a6_0x525372;ItemID==0x0?(G_Validateholiday==!![]?confirm(_0x4c2fed(0x1da))&&PushNewAttendance():PushNewAttendance(),Applyfilter(),LoadAllHolidays()):(G_Validateholiday==!![]?confirm(_0x4c2fed(0x1da))&&ModifyAttendance():ModifyAttendance(),Applyfilter(),LoadAllHolidays());}function PushNewAttendance(){var _0x28667d=a6_0x525372;$(_0x28667d(0x1bc))[_0x28667d(0x25e)]()!='Holiday'||G_Validateholiday==!![]?$[_0x28667d(0x28c)]({'url':_spPageContextInfo[_0x28667d(0x1c6)]+'/_api/web/lists/GetByTitle(\x27EmpAttendance\x27)/items','type':_0x28667d(0x223),'async':![],'data':JSON[_0x28667d(0x284)]({'__metadata':{'type':_0x28667d(0x244)},'AttendanceDate':SelectedDate,'EmployeeId':EmployeeID,'AttendanceType':$(_0x28667d(0x1bc))[_0x28667d(0x25e)]()}),'headers':{'Accept':_0x28667d(0x1c5),'Content-Type':_0x28667d(0x1c5),'X-RequestDigest':$(_0x28667d(0x23e))[_0x28667d(0x25e)](),'X-HTTP-Method':'POST'},'success':function(_0x17e78d,_0x75d4eb,_0x131c19){var _0x17c5a8=_0x28667d;$(_0x17c5a8(0x22f)+TDID)[_0x17c5a8(0x1b7)]($('#AttendanceDDL')['val']()),alert(_0x17c5a8(0x271)),$(_0x17c5a8(0x240))['modal']('hide'),GetAttendanceorLeaves();},'error':function(_0x5e7edd,_0x5184d8,_0x5e96a7){var _0x1eb1f0=_0x28667d;alert(_0x1eb1f0(0x249));}}):alert(_0x28667d(0x1fc));}function ModifyAttendance(){var _0x547cf9=a6_0x525372;$(_0x547cf9(0x1bc))[_0x547cf9(0x25e)]()!=_0x547cf9(0x1de)||G_Validateholiday==!![]?$[_0x547cf9(0x28c)]({'url':_spPageContextInfo[_0x547cf9(0x1c6)]+_0x547cf9(0x28e)+ItemID+')','type':'POST','async':![],'data':JSON[_0x547cf9(0x284)]({'__metadata':{'type':_0x547cf9(0x244)},'AttendanceType':$('#AttendanceDDL')['val']()}),'headers':{'Accept':'application/json;odata=verbose','Content-Type':'application/json;odata=verbose','X-RequestDigest':$(_0x547cf9(0x23e))[_0x547cf9(0x25e)](),'IF-MATCH':'*','X-HTTP-Method':_0x547cf9(0x278)},'success':function(_0xc4fbd9,_0x229906,_0x1c3809){var _0x44e21d=_0x547cf9;$(_0x44e21d(0x22f)+TDID)[_0x44e21d(0x1b7)]($(_0x44e21d(0x1bc))[_0x44e21d(0x25e)]()),$('#Timeview'+TDID)[_0x44e21d(0x1b7)](_0x44e21d(0x1d4)),alert('Data\x20has\x20been\x20saved.'),$(_0x44e21d(0x240))['modal'](_0x44e21d(0x1f1)),GetAttendanceorLeaves();},'error':function(_0x4aee35,_0x1d2908,_0x2043ba){alert('Error!\x20Something\x20went\x20wrong.');}}):alert(_0x547cf9(0x1fc));}function initializePeoplePicker(_0x1ebc6b){var _0x458d29=a6_0x525372,_0x3f1b10={};_0x3f1b10['PrincipalAccountType']=_0x458d29(0x27d),_0x3f1b10[_0x458d29(0x279)]=0xf,_0x3f1b10[_0x458d29(0x22a)]=0xf,_0x3f1b10['AllowMultipleValues']=![],_0x3f1b10[_0x458d29(0x257)]=0x32,_0x3f1b10[_0x458d29(0x26c)]=_0x458d29(0x1c8),this[_0x458d29(0x237)](_0x1ebc6b,null,_0x3f1b10);}function Applyfilter(){var _0xf748f1=a6_0x525372,_0x19a5a2=moment($(_0xf748f1(0x1d7))[_0xf748f1(0x25e)](),'LL')['format']('DD\x20MMM\x20YYYY'),_0x4366c9=moment($('#EmpreportTo')[_0xf748f1(0x25e)](),'LL')[_0xf748f1(0x222)]('DD\x20MMM\x20YYYY');if(Date[_0xf748f1(0x204)](_0x19a5a2)>Date['parse'](_0x4366c9))alert(_0xf748f1(0x24b));else{$(_0xf748f1(0x232))['modal'](_0xf748f1(0x1f1));var _0x263cc7=$['urlParam'](_0xf748f1(0x22b)),_0xa23671=$(_0xf748f1(0x1d7))['datepicker'](_0xf748f1(0x262)),_0x38f15f=$(_0xf748f1(0x230))[_0xf748f1(0x1ee)]('getDate');days=(_0x38f15f-_0xa23671)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math[_0xf748f1(0x242)](days)+0x1,$('#StartDate')['text'](formatDateReportEmp($('#EmpreportFrom')[_0xf748f1(0x25e)]())),$(_0xf748f1(0x221))[_0xf748f1(0x1b7)](formatDateReportEmp($(_0xf748f1(0x230))[_0xf748f1(0x25e)]()));var _0x19a5a2=moment($(_0xf748f1(0x1d7))[_0xf748f1(0x25e)](),'LL')['format'](_0xf748f1(0x200)),_0x4366c9=moment($(_0xf748f1(0x230))[_0xf748f1(0x25e)](),'LL')[_0xf748f1(0x222)](_0xf748f1(0x200)),_0x42f8e8=new Date(_0x4366c9),_0xbad5cd=_0x42f8e8[_0xf748f1(0x212)](),_0x261101=_0xbad5cd[_0xf748f1(0x286)]('T');GstartDate=_0x19a5a2;var _0x42badb=ensureUser($(_0xf748f1(0x214))[_0xf748f1(0x1c9)]()[_0xf748f1(0x1c9)]()['attr']('id'));if(_0x42badb==0x0){_0x263cc7=_0x263cc7,GEmpID=_0x263cc7;var _0x431902=_spPageContextInfo[_0xf748f1(0x1c6)]+'/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27'+_0x19a5a2+_0xf748f1(0x211)+_0x261101[0x0]+_0xf748f1(0x267)+_0x263cc7+'\x27\x20';getFileData(_0x431902);var _0x3fbd14=_spPageContextInfo['webAbsoluteUrl']+_0xf748f1(0x258)+_0x263cc7+'\x27\x20and\x20Company/ID\x20\x20eq\x20\x27'+CompanyID+'\x27';EmployeeListDat(_0x3fbd14);}else{if(ISHRADMIN==!![]){_0x263cc7=_0x42badb,GEmpID=_0x42badb;var _0x431902=_spPageContextInfo[_0xf748f1(0x1c6)]+_0xf748f1(0x277)+_0x19a5a2+'\x27\x20and\x20AttendanceDate\x20le\x20\x27'+_0x261101[0x0]+_0xf748f1(0x267)+_0x263cc7+'\x27\x20';getFileData(_0x431902);var _0x3fbd14=_spPageContextInfo['webAbsoluteUrl']+_0xf748f1(0x258)+_0x263cc7+_0xf748f1(0x201)+CompanyID+'\x27';EmployeeListDat(_0x3fbd14);}else alert('Unauthorized\x20access!');}LoadAllHolidays();}}var DataIdList=[],EmpAttendanceData=[],TotalLeavesorAbsent=[];function getFileData(_0x43f42e){var _0x2c5770=a6_0x525372;jQuery[_0x2c5770(0x28c)]({'url':_0x43f42e,'headers':{'Accept':_0x2c5770(0x1c5)},'async':![],'success':function(_0x3e4e79){var _0x8b5fea=_0x2c5770;EmpAttendanceData=[];var _0x595c31=_0x3e4e79['d'][_0x8b5fea(0x1c2)];DataIdList=[];var _0x42a75a=[];TotalLeavesorAbsent=[];for(var _0x5cb7f2=0x0;_0x5cb7f2<_0x595c31[_0x8b5fea(0x274)];_0x5cb7f2++){if(_0x595c31[_0x5cb7f2][_0x8b5fea(0x28a)]!=_0x8b5fea(0x1fe)&&_0x595c31[_0x5cb7f2][_0x8b5fea(0x28a)]!=_0x8b5fea(0x1de))_0x42a75a[_0x8b5fea(0x1ea)](_0x595c31[_0x5cb7f2][_0x8b5fea(0x28a)]);else{if(_0x595c31[_0x5cb7f2][_0x8b5fea(0x28a)]==_0x8b5fea(0x1fe))TotalLeavesorAbsent['push'](_0x595c31[_0x5cb7f2][_0x8b5fea(0x28a)]);else _0x595c31[_0x5cb7f2][_0x8b5fea(0x28a)]=='Holiday'&&TotalLeavesorAbsent['push'](_0x595c31[_0x5cb7f2][_0x8b5fea(0x28a)]);}var _0x17e982=_0x595c31[_0x5cb7f2]['ID'],_0x3493b5=_0x595c31[_0x5cb7f2]['Employee'][_0x8b5fea(0x23c)],_0x3b9f56=_0x595c31[_0x5cb7f2][_0x8b5fea(0x1fb)]['ID'],_0x490669=formatDateReportEmp(_0x595c31[_0x5cb7f2]['AttendanceDate']),_0x12d692=_0x595c31[_0x5cb7f2][_0x8b5fea(0x28a)],_0x1c6236=_0x595c31[_0x5cb7f2][_0x8b5fea(0x238)],_0x2eb698=_0x595c31[_0x5cb7f2]['HrAction'];EmpAttendanceData[_0x8b5fea(0x1ea)]({'UserId':_0x3b9f56,'EmpName':_0x3493b5,'AttendanceDate':_0x490669,'AttendanceType':_0x12d692,'AttendanceItemId':_0x17e982,'EmpWorkHours':_0x1c6236,'HrAction':_0x2eb698});}var _0x42bc5c='';$(_0x8b5fea(0x224))['empty']();var _0xdd8c1f=0x0,_0x784b9b=0x0;for(var _0x5d5de7=0x0;_0x5d5de7<Totaldays;_0x5d5de7++){var _0x3e34aa=new Date(GstartDate);_0x3e34aa[_0x8b5fea(0x23b)](_0x3e34aa['getDate']()+_0x5d5de7);var _0x2288a1=moment(_0x3e34aa,_0x8b5fea(0x251))[_0x8b5fea(0x222)](_0x8b5fea(0x200)),_0x2288a1=_0x2288a1[_0x8b5fea(0x286)]('-')[_0x8b5fea(0x1cf)]('');DataIdList[_0x8b5fea(0x1ea)](_0x2288a1);var _0x243d28=formatDateReportEmp(_0x3e34aa),_0x189873=EmpAttendanceData['map'](function(_0x402d77){var _0x1976ca=_0x8b5fea;return _0x402d77[_0x1976ca(0x1d0)];})[_0x8b5fea(0x209)](_0x243d28);if(_0x189873!=-0x1){var _0x32ee2c=EmpAttendanceData[_0x189873][_0x8b5fea(0x28a)],_0x35a61a=EmpAttendanceData[_0x189873]['EmpWorkHours'],_0x2eb698=EmpAttendanceData[_0x189873][_0x8b5fea(0x228)],_0x250b99=EmpAttendanceData[_0x189873]['UserId'],_0xf921ce=EmpAttendanceData[_0x189873]['AttendanceItemId'],_0x4c7ff7=EmpAttendanceData[_0x189873]['AttendanceDate'],_0x5d61e7=_0x8b5fea(0x208),_0x5a7e56=_0x8b5fea(0x24d);_0x2eb698==!![]&&(_0x5d61e7=_0x8b5fea(0x24d),_0x5a7e56=_0x8b5fea(0x208));if(_0x32ee2c!=_0x8b5fea(0x1fe)&&_0x32ee2c!='Holiday'){if(_0x35a61a==null)var _0x13124a='<a\x20class=\x27LinkBtn\x27\x20href=\x27'+_spPageContextInfo[_0x8b5fea(0x1c6)]+'/Pages/TimeSheetEntry.aspx?WebAppId=2&Recall='+_0x2288a1+_0x8b5fea(0x1e5)+window['btoa'](_0x8b5fea(0x227))+'&sourcelocation=../Pages/Myworkplace.aspx\x27\x20><span\x20id=\x27Timeview'+_0x2288a1+_0x8b5fea(0x254);else var _0x13124a='<a\x20href=\x27'+_spPageContextInfo['webAbsoluteUrl']+_0x8b5fea(0x1d8)+_0x2288a1+_0x8b5fea(0x1e5)+window[_0x8b5fea(0x1cd)](_0x8b5fea(0x227))+_0x8b5fea(0x25b)+ConvertHHMM(_0x35a61a)+_0x8b5fea(0x276);}else var _0x13124a='';var _0x52f3f2=![],_0x4e1452=Date[_0x8b5fea(0x204)](_0x4c7ff7['split'](',')[0x0]),_0x2c5476=new Date(),_0x4a0631=Date[_0x8b5fea(0x204)](moment(_0x2c5476)[_0x8b5fea(0x222)](_0x8b5fea(0x268)));_0x4e1452>_0x4a0631&&(_0x52f3f2=!![]),_0x784b9b=_0x784b9b+0x1,_0x52f3f2!=!![]?(_0x42bc5c+=_0x8b5fea(0x1e7),_0x42bc5c+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id='+_0x2288a1+_0x8b5fea(0x1df)+formatDateReportEmp(_0x3e34aa)+_0x8b5fea(0x236)+_0x2288a1+_0x8b5fea(0x1eb),_0x42bc5c+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Att'+_0x2288a1+'>'+_0x32ee2c+_0x8b5fea(0x1ba),_0x42bc5c+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Time'+_0x2288a1+'>'+_0x13124a+_0x8b5fea(0x1ba),_0x42bc5c+=_0x8b5fea(0x206)+_0x5d61e7+_0x8b5fea(0x20e),_0x42bc5c+=_0x8b5fea(0x24c)+_0x5a7e56+_0x8b5fea(0x27e)+GEmpID+','+_0xf921ce+','+_0x2288a1+_0x8b5fea(0x26d),_0x42bc5c+=_0x8b5fea(0x1d5)):(_0x42bc5c+=_0x8b5fea(0x1e7),_0x42bc5c+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id='+_0x2288a1+_0x8b5fea(0x1df)+formatDateReportEmp(_0x3e34aa)+'</span><span\x20id=\x27H'+_0x2288a1+_0x8b5fea(0x1eb),_0x42bc5c+=_0x8b5fea(0x1e1)+_0x2288a1+'>'+_0x32ee2c+_0x8b5fea(0x1c0)+_0xf921ce+','+_0x2288a1+_0x8b5fea(0x20f),_0x42bc5c+=_0x8b5fea(0x21a)+_0x2288a1+'>'+_0x13124a+_0x8b5fea(0x1ba),_0x42bc5c+=_0x8b5fea(0x206)+_0x5d61e7+_0x8b5fea(0x20e),_0x42bc5c+=_0x8b5fea(0x24c)+_0x5a7e56+_0x8b5fea(0x246),_0x42bc5c+='</tr>');}else{var _0x2f1bc3=formatDateReportEmp(_0x3e34aa),_0x52f3f2=![],_0x4e1452=Date[_0x8b5fea(0x204)](_0x2f1bc3[_0x8b5fea(0x286)](',')[0x0]),_0x2c5476=new Date(),_0x4a0631=Date[_0x8b5fea(0x204)](moment(_0x2c5476)[_0x8b5fea(0x222)](_0x8b5fea(0x268)));_0x4e1452>_0x4a0631&&(_0x52f3f2=!![]);_0xdd8c1f=_0xdd8c1f+0x1;if(_0x52f3f2!=!![]){var _0x3d0b6e=_0x8b5fea(0x1cb)+_spPageContextInfo['webAbsoluteUrl']+_0x8b5fea(0x1d8)+_0x2288a1+'&Mode='+window[_0x8b5fea(0x1cd)](_0x8b5fea(0x227))+_0x8b5fea(0x23a)+_0x2288a1+_0x8b5fea(0x254);_0x42bc5c+=_0x8b5fea(0x1e7),_0x42bc5c+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id='+_0x2288a1+_0x8b5fea(0x1df)+formatDateReportEmp(_0x3e34aa)+_0x8b5fea(0x236)+_0x2288a1+'\x27\x20class=\x27employee-report-holiday\x27></span></div></td>',_0x42bc5c+=_0x8b5fea(0x1e1)+_0x2288a1+_0x8b5fea(0x21b),_0x42bc5c+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Time'+_0x2288a1+_0x8b5fea(0x21b),_0x42bc5c+=_0x8b5fea(0x207),_0x42bc5c+=_0x8b5fea(0x25a)+GEmpID+',0,'+_0x2288a1+_0x8b5fea(0x26d),_0x42bc5c+='</tr>';}else{var _0x3d0b6e=_0x8b5fea(0x1cb)+_spPageContextInfo[_0x8b5fea(0x1c6)]+_0x8b5fea(0x1d8)+_0x2288a1+_0x8b5fea(0x1e5)+window[_0x8b5fea(0x1cd)]('View')+_0x8b5fea(0x23a)+_0x2288a1+_0x8b5fea(0x254);_0x42bc5c+=_0x8b5fea(0x1e7),_0x42bc5c+=_0x8b5fea(0x287)+_0x2288a1+_0x8b5fea(0x1df)+formatDateReportEmp(_0x3e34aa)+_0x8b5fea(0x236)+_0x2288a1+'\x27\x20class=\x27employee-report-holiday\x27></span></div></td>',_0x42bc5c+=_0x8b5fea(0x1e1)+_0x2288a1+_0x8b5fea(0x21b),_0x42bc5c+=_0x8b5fea(0x21a)+_0x2288a1+_0x8b5fea(0x21b),_0x42bc5c+='<td><div\x20class=\x27checkbox\x20m-0\x27></div></td>',_0x42bc5c+=_0x8b5fea(0x24f),_0x42bc5c+=_0x8b5fea(0x1d5);}}}var _0x33b2bc=$[_0x8b5fea(0x21e)](_0x595c31,function(_0x3a2218){var _0x20ed9a=_0x8b5fea;return _0x3a2218[_0x20ed9a(0x28a)]!=_0x20ed9a(0x1fe)&&_0x3a2218[_0x20ed9a(0x28a)]!='Holiday';}),_0x2d874a=parseInt(TotalLeavesorAbsent['length'])+parseInt(_0xdd8c1f)-parseInt($(_0x8b5fea(0x1d9))['text']());_0x2d874a<0x0&&(_0x2d874a=0x0);$(_0x8b5fea(0x1bd))[_0x8b5fea(0x1f1)](),$(_0x8b5fea(0x1f2))[_0x8b5fea(0x1b7)](Totaldays);var _0x35ed2b=parseInt(_0x784b9b)-parseInt(TotalLeavesorAbsent['length']);$(_0x8b5fea(0x1bf))[_0x8b5fea(0x1b7)](_0x33b2bc['length']),$(_0x8b5fea(0x224))['append'](_0x42bc5c),EmpTableConfiguration();},'error':function(_0x4545fa,_0x1c0af6){console['log'](JSON['stringify'](_0x4545fa));}});}function WithdrawLeave(_0x26bb80,_0x1869be){var _0x1dac9b=a6_0x525372;confirm(_0x1dac9b(0x210))&&$['ajax']({'url':_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/GetByTitle(\x27EmpAttendance\x27)/items('+_0x26bb80+')','type':_0x1dac9b(0x223),'headers':{'X-RequestDigest':$(_0x1dac9b(0x23e))['val'](),'IF-MATCH':'*','X-HTTP-Method':_0x1dac9b(0x218)},'success':function(_0x4285ef,_0x1ad118,_0x21b354){var _0x1d9494=_0x1dac9b;$('#Att'+_0x1869be)[_0x1d9494(0x1ce)](_0x1d9494(0x285),'none'),alert(_0x1d9494(0x248));},'error':function(_0x3b8834,_0x153dc7,_0x2c7516){var _0x23ddfc=_0x1dac9b;$(_0x23ddfc(0x256))[_0x23ddfc(0x1e2)]()[_0x23ddfc(0x1b7)](data[_0x23ddfc(0x253)][_0x23ddfc(0x1fa)]);}});}function ConvertDateTimeFormat(_0x216e66,_0x1f8f4f){var _0x2bde2f=a6_0x525372;return _0x216e66[_0x2bde2f(0x286)](_0x1f8f4f)[0x1]+''+_0x1f8f4f+''+_0x216e66[_0x2bde2f(0x286)](_0x1f8f4f)[0x0]+''+_0x1f8f4f+''+_0x216e66[_0x2bde2f(0x286)](_0x1f8f4f)[0x2];}var GEmployeeID=0x0,LocID=0x0;function EmployeeListDat(_0x51c228){var _0x56030a=a6_0x525372;GEmployeeID=0x0,$['ajax']({'url':_0x51c228,'headers':{'Accept':_0x56030a(0x1c5)},'async':![],'success':function(_0x46378e){var _0x560508=_0x56030a,_0xf4412d=_0x46378e['d'][_0x560508(0x1c2)];_0xf4412d[_0x560508(0x274)]>0x0?($(_0x560508(0x26a))[_0x560508(0x1b7)](_0xf4412d[0x0]['LogonName'][_0x560508(0x23c)]),GEmployeeID=_0xf4412d[0x0][_0x560508(0x21f)]['ID'],$('#EmpTitle')[_0x560508(0x1b7)](_0xf4412d[0x0]['LogonName'][_0x560508(0x23c)]),$(_0x560508(0x24e))[_0x560508(0x1b7)](_0xf4412d[0x0][_0x560508(0x1ff)]['OfficeName']),$('#officeLocTH')[_0x560508(0x1b7)](_0xf4412d[0x0][_0x560508(0x1ff)][_0x560508(0x275)]),LocID=_0xf4412d[0x0][_0x560508(0x1ff)]['ID']):($('#EmpName')[_0x560508(0x1b7)](''),$(_0x560508(0x24e))[_0x560508(0x1b7)](''),LocID=0x0);},'error':function(_0x24f17e){var _0x43d8c3=_0x56030a;console[_0x43d8c3(0x1b8)](_0x24f17e);}});}function EmpTableConfiguration(){var _0x1bcc75=a6_0x525372;sorter=new TINY[(_0x1bcc75(0x26e))]['sorter'](_0x1bcc75(0x20c),_0x1bcc75(0x205),{'ascclass':_0x1bcc75(0x202),'descclass':_0x1bcc75(0x28d),'evenclass':_0x1bcc75(0x282),'oddclass':_0x1bcc75(0x1f4),'evenselclass':_0x1bcc75(0x27a),'oddselclass':_0x1bcc75(0x26f),'paginate':!![],'size':0xa,'colddid':_0x1bcc75(0x220),'currentid':_0x1bcc75(0x243),'totalid':'Emptotalpages','startingrecid':_0x1bcc75(0x21c),'endingrecid':_0x1bcc75(0x281),'totalrecid':_0x1bcc75(0x250),'hoverid':_0x1bcc75(0x273),'pageddid':'Emppagedropdown','navid':_0x1bcc75(0x225),'sortdir':0x1,'init':!![]});}$[a6_0x525372(0x1c3)]=function(_0x568f80){var _0xb33bb8=a6_0x525372,_0xe32679=new RegExp(_0xb33bb8(0x216)+_0x568f80+'=([^&#]*)')['exec'](window[_0xb33bb8(0x1f0)][_0xb33bb8(0x265)]);if(_0xe32679==null)return null;return decodeURI(_0xe32679[0x1])||0x0;};function formatDateReportEmp(_0x5225dc){var _0x825ab8=a6_0x525372,_0x10b614=['Sunday',_0x825ab8(0x1f7),_0x825ab8(0x28b),_0x825ab8(0x289),_0x825ab8(0x1d6),'Friday',_0x825ab8(0x1be)],_0x271307=new Date(_0x5225dc);if(isNaN(_0x271307[_0x825ab8(0x229)]()))return _0x5225dc;else{var _0x3f9fcb=new Array();return _0x3f9fcb[0x0]=_0x825ab8(0x1c4),_0x3f9fcb[0x1]=_0x825ab8(0x288),_0x3f9fcb[0x2]=_0x825ab8(0x259),_0x3f9fcb[0x3]=_0x825ab8(0x20b),_0x3f9fcb[0x4]='May',_0x3f9fcb[0x5]='Jun',_0x3f9fcb[0x6]=_0x825ab8(0x1b6),_0x3f9fcb[0x7]=_0x825ab8(0x1ed),_0x3f9fcb[0x8]=_0x825ab8(0x1e6),_0x3f9fcb[0x9]='Oct',_0x3f9fcb[0xa]=_0x825ab8(0x252),_0x3f9fcb[0xb]=_0x825ab8(0x1c1),day=_0x271307[_0x825ab8(0x262)](),day<0xa&&(day='0'+day),day+'\x20'+_0x3f9fcb[_0x271307[_0x825ab8(0x22d)]()]+'\x20'+_0x271307[_0x825ab8(0x1f8)]()+',\x20'+_0x10b614[_0x271307[_0x825ab8(0x1e4)]()];}}function ConvertHHMM(_0x2279d7){var _0x45fa85=a6_0x525372;if(_0x2279d7!=null){var _0x30fba9=Math[_0x45fa85(0x219)](_0x2279d7/0x3c),_0x2abb23=_0x2279d7%0x3c;_0x30fba9<0xa&&(_0x30fba9='0'+_0x30fba9);_0x2abb23<0xa&&(_0x2abb23='0'+_0x2abb23);var _0x4ebb8c=_0x30fba9+':'+_0x2abb23;}else var _0x4ebb8c='';return _0x4ebb8c;}var AttandenceOnHolidays=0x0,HolidaysListDTL=[];function LoadAllHolidays(){var _0xff71d1=a6_0x525372;TotalOfficeDays=0x0,HolidaysListDTL=[];var _0x3be890=new Date($(_0xff71d1(0x1d7))[_0xff71d1(0x25e)]()),_0x25f0ee=_0x3be890[_0xff71d1(0x1f8)]()+'-'+(_0x3be890[_0xff71d1(0x22d)]()+0x1)+'-'+_0x3be890[_0xff71d1(0x262)](),_0x474900=new Date($('#EmpreportTo')[_0xff71d1(0x25e)]()),_0x55b197=_0x474900['getFullYear']()+'-'+(_0x474900[_0xff71d1(0x22d)]()+0x1)+'-'+_0x474900[_0xff71d1(0x262)](),_0x1f456e=_spPageContextInfo[_0xff71d1(0x1c6)]+_0xff71d1(0x25f)+LocID+'\x27\x20and\x20CompanyID\x20eq\x20\x27'+CompanyID+_0xff71d1(0x22e)+_0x25f0ee+_0xff71d1(0x1b9)+_0x55b197+'\x27';$['ajax']({'url':_0x1f456e,'headers':{'Accept':_0xff71d1(0x1c5)},'async':![],'success':function(_0x9eae5b){var _0x486e0a=_0xff71d1,_0x3da19c=_0x9eae5b['d'][_0x486e0a(0x1c2)][_0x486e0a(0x274)],_0x4bac8c=0x0;for(var _0x579acc=0x0;_0x579acc<_0x3da19c;_0x579acc++){var _0x209a74=new Date(_0x9eae5b['d'][_0x486e0a(0x1c2)][_0x579acc][_0x486e0a(0x1e8)]),_0x2a89cf=moment(_0x209a74,_0x486e0a(0x251))[_0x486e0a(0x222)]('YYYY-MM-DD'),_0x2a89cf=_0x2a89cf[_0x486e0a(0x286)]('-')[_0x486e0a(0x1cf)](''),_0x346104=_0x9eae5b['d'][_0x486e0a(0x1c2)][_0x579acc]['Title'];HolidaysListDTL['push']({'Hdate':_0x2a89cf,'Title':_0x346104}),$('#'+_0x2a89cf)[_0x486e0a(0x1ce)](_0x486e0a(0x1ec),'red'),$('#H'+_0x2a89cf)[_0x486e0a(0x1b7)](_0x486e0a(0x1d2)+_0x346104),$(_0x486e0a(0x22f)+_0x2a89cf)['text']()!=''&&(_0x4bac8c=_0x4bac8c+0x1);}AttandenceOnHolidays=0x0;for(var _0x26cb12=0x0;_0x26cb12<HolidaysListDTL[_0x486e0a(0x274)];_0x26cb12++){var _0x59ea0e=$(_0x486e0a(0x22f)+HolidaysListDTL[_0x26cb12][_0x486e0a(0x1f3)])['text']();_0x59ea0e!=''&&_0x59ea0e!='On-Leave'&&_0x59ea0e!='Holiday'&&(AttandenceOnHolidays=AttandenceOnHolidays+0x1);}var _0x5b6b16=0x0,_0x9d8274=0x0,_0x377868=0x0;for(var _0x2c6e08=0x0;_0x2c6e08<DataIdList['length'];_0x2c6e08++){var _0x45e0c7=$('#Att'+DataIdList[_0x2c6e08])[_0x486e0a(0x1b7)]();_0x45e0c7==_0x486e0a(0x261)&&(_0x45e0c7=_0x45e0c7[_0x486e0a(0x286)](_0x486e0a(0x20d))[0x0]),(_0x45e0c7==''||_0x45e0c7==_0x486e0a(0x1fe))&&(_0x9d8274=_0x9d8274+0x1),_0x45e0c7==_0x486e0a(0x1fe)&&(_0x377868=_0x377868+0x1),_0x45e0c7==_0x486e0a(0x1de)&&(_0x5b6b16=_0x5b6b16+0x1);}var _0x5c9ec4=_0x9d8274+AttandenceOnHolidays-(_0x3da19c-_0x5b6b16);_0x5c9ec4<0x0&&(_0x5c9ec4=0x0),_0x5c9ec4!='0'?$(_0x486e0a(0x226))[_0x486e0a(0x1b7)](_0x5c9ec4):_0x377868>0x0&&$(_0x486e0a(0x226))['text'](_0x377868),$(_0x486e0a(0x1d9))[_0x486e0a(0x1b7)](_0x3da19c),$(_0x486e0a(0x269))[_0x486e0a(0x1b7)](parseInt(Totaldays)-parseInt(_0x3da19c)),$('#FdateTH')[_0x486e0a(0x1b7)](formatDateReportEmp(ConvertDateTimeFormat($(_0x486e0a(0x1d7))['val'](),'/'))),$('#EdateTH')[_0x486e0a(0x1b7)](formatDateReportEmp(ConvertDateTimeFormat($(_0x486e0a(0x230))['val'](),'/'))),$(_0x486e0a(0x1fd))[_0x486e0a(0x1b7)](parseInt(Totaldays)-parseInt(_0x3da19c)),$(_0x486e0a(0x213))[_0x486e0a(0x1b7)](_0x3da19c);},'myError':function(_0x3075e7){}});}function ensureUser(_0x2817f2){var _0x2d6740=a6_0x525372,_0x2e1617=0x0,_0x131519=_0x2817f2,_0x56f856=this[_0x2d6740(0x247)][_0x2d6740(0x280)][_0x131519],_0x5e6afd=_0x56f856[_0x2d6740(0x21d)](),_0x36a2b7=_0x5e6afd[0x0];if(_0x36a2b7){var _0x4ce411={'logonName':_0x36a2b7[_0x2d6740(0x1dd)]};$[_0x2d6740(0x28c)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x2d6740(0x1c7),'type':_0x2d6740(0x223),'async':![],'contentType':_0x2d6740(0x1c5),'data':JSON[_0x2d6740(0x284)](_0x4ce411),'headers':{'X-RequestDigest':$(_0x2d6740(0x23e))[_0x2d6740(0x25e)](),'accept':_0x2d6740(0x1c5)},'success':function(_0x3c24a9,_0x3e692c,_0x18b3d1){_0x2e1617=_0x3c24a9['d']['Id'];},'error':function(_0x5a73e1,_0x20454d,_0x2d18c5){}});}else _0x2e1617=0x0;return _0x2e1617;}var tableToExcel=(function(){var _0x1298b2=a6_0x525372,_0x123393='data:application/vnd.ms-excel;base64,',_0x7edd98=_0x1298b2(0x1e3),_0x5165d0=function(_0x53fe65){var _0x433894=_0x1298b2;return window[_0x433894(0x1cd)](unescape(encodeURIComponent(_0x53fe65)));},_0x4b30a3=function(_0x1961ed,_0x20adca){var _0x7b3dd8=_0x1298b2;return _0x1961ed[_0x7b3dd8(0x263)](/{(\w+)}/g,function(_0x4c50a5,_0x4901a9){return _0x20adca[_0x4901a9];});};return function(_0x52ca18,_0x1223dc){var _0x4ca764=_0x1298b2;if(!_0x52ca18['nodeType'])_0x52ca18=document['getElementById'](_0x52ca18);var _0x41f5ea={'worksheet':_0x1223dc||_0x4ca764(0x239),'table':_0x52ca18[_0x4ca764(0x27b)]};window['location'][_0x4ca764(0x265)]=_0x123393+_0x5165d0(_0x4b30a3(_0x7edd98,_0x41f5ea));};}()),ISHRADMIN=![];function ValidateHrAdmin(){var _0x2ae64b=a6_0x525372,_0x4da3e2=_0x2ae64b(0x217),_0x5abcbd=_spPageContextInfo['webAbsoluteUrl']+_0x2ae64b(0x20a)+_0x4da3e2+'\x27)/items?$select=*,Department/DepartmentName,Department/ID&$expand=Department&$filter=CompanyId\x20eq\x20\x27'+titanForWork[_0x2ae64b(0x1f6)](_0x2ae64b(0x264))+_0x2ae64b(0x22c)+_spPageContextInfo[_0x2ae64b(0x27c)]+'\x27\x20and\x20(WebPartName\x20eq\x20\x27HR\x20Admin\x27)';$[_0x2ae64b(0x28c)]({'url':_0x5abcbd,'async':![],'type':_0x2ae64b(0x1d1),'headers':{'Accept':_0x2ae64b(0x1c5)},'success':function(_0x71df71){var _0x5da05b=_0x2ae64b,_0x4e7a2d=_0x71df71['d']['results'];_0x4e7a2d[_0x5da05b(0x274)]>0x0?($('#EmpRow')[_0x5da05b(0x1ce)](_0x5da05b(0x285),'block'),ISHRADMIN=!![]):(ISHRADMIN=![],$(_0x5da05b(0x266))[_0x5da05b(0x1f1)]());},'error':function(_0x102b2d){var _0x20a042=_0x2ae64b;console[_0x20a042(0x1b8)](_0x102b2d[_0x20a042(0x253)][_0x20a042(0x1fa)]);}});}function GetAttendanceorLeaves(){var _0x7203ee=a6_0x525372,_0x4383a5=$[_0x7203ee(0x1c3)](_0x7203ee(0x22b)),_0x28b713=$(_0x7203ee(0x1d7))[_0x7203ee(0x1ee)](_0x7203ee(0x262)),_0x48d2e1=$(_0x7203ee(0x230))[_0x7203ee(0x1ee)](_0x7203ee(0x262));days=(_0x48d2e1-_0x28b713)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math['round'](days)+0x1,$(_0x7203ee(0x26b))[_0x7203ee(0x1b7)](formatDateReportEmp($(_0x7203ee(0x1d7))[_0x7203ee(0x25e)]())),$(_0x7203ee(0x221))[_0x7203ee(0x1b7)](formatDateReportEmp($(_0x7203ee(0x230))['val']()));var _0x5d1bde=moment($(_0x7203ee(0x1d7))[_0x7203ee(0x25e)](),'LL')['format']('YYYY-MM-DD'),_0x42a4d1=moment($(_0x7203ee(0x230))['val'](),'LL')['format']('YYYY-MM-DD'),_0x3974d4=new Date(_0x42a4d1),_0x1a9e8b=_0x3974d4[_0x7203ee(0x212)](),_0x96d546=_0x1a9e8b[_0x7203ee(0x286)]('T');GstartDate=_0x5d1bde;var _0x4cc1cb=ensureUser($(_0x7203ee(0x214))[_0x7203ee(0x1c9)]()[_0x7203ee(0x1c9)]()[_0x7203ee(0x231)]('id'));if(_0x4cc1cb==0x0){var _0x2499d3=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27'+_0x4383a5+_0x7203ee(0x201)+CompanyID+'\x27';EmployeeListDat(_0x2499d3),LoadAllHolidays(),_0x4383a5=_0x4383a5,GEmpID=_0x4383a5;var _0x30fb23=_spPageContextInfo[_0x7203ee(0x1c6)]+'/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27'+_0x5d1bde+_0x7203ee(0x211)+_0x96d546+_0x7203ee(0x267)+_0x4383a5+'\x27\x20';UpdateHeaderfields(_0x30fb23);}else{if(ISHRADMIN==!![]){_0x4383a5=_0x4cc1cb,GEmpID=_0x4cc1cb;var _0x2499d3=_spPageContextInfo[_0x7203ee(0x1c6)]+_0x7203ee(0x258)+_0x4383a5+'\x27\x20and\x20Company/ID\x20\x20eq\x20\x27'+CompanyID+'\x27';EmployeeListDat(_0x2499d3),LoadAllHolidays();var _0x30fb23=_spPageContextInfo[_0x7203ee(0x1c6)]+'/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27'+_0x5d1bde+_0x7203ee(0x211)+_0x96d546+'\x27\x20and\x20Employee\x20eq\x20\x27'+_0x4383a5+'\x27\x20';UpdateHeaderfields(_0x30fb23);var _0x2499d3=_spPageContextInfo[_0x7203ee(0x1c6)]+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27'+_0x4383a5+_0x7203ee(0x201)+CompanyID+'\x27';}else alert(_0x7203ee(0x25c));}LoadAllHolidays();}function a6_0x43df(){var _0x10dc6a=['This\x20is\x20a\x20Holiday,\x20are\x20you\x20sure\x20to\x20submit\x20your\x20attendance.','map','toString','Key','Holiday','><span>','EmployeeName','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Att','empty','<html\x20xmlns:o=\x22urn:schemas-microsoft-com:office:office\x22\x20xmlns:x=\x22urn:schemas-microsoft-com:office:excel\x22\x20xmlns=\x22http://www.w3.org/TR/REC-html40\x22><head><!--[if\x20gte\x20mso\x209]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>','getDay','&Mode=','Sept','<tr\x20class=\x27text-center\x27\x20>','Holiday_start','An\x20error\x20occurred.\x20Please\x20try\x20again.','push','\x27\x20class=\x27employee-report-holiday\x27></span></div></td>','color','Aug','datepicker','#HolidayMessagediv','location','hide','#EmpTotalItemscount','Hdate','oddrow','\x27&$top=200&$orderby=Holiday_start\x20asc','getQueryStringParameter','Monday','getFullYear','41876jNohCy','error','Employee','Plese\x20select\x20proper\x20attandence.','#TotalWorkdayTH','On-Leave','OfficeLocation','YYYY-MM-DD','\x27\x20and\x20Company/ID\x20\x20eq\x20\x27','asc','start','parse','EmpReportTableData','<td><div\x20class=\x27checkbox\x20m-0\x27\x20style=\x27display:\x20','<td><div\x20class=\x27checkbox\x20m-0\x27></div></td>','none','indexOf','/_api/web/lists/getbytitle(\x27','Apr','sorter','Withdraw','\x20\x27><label><i\x20class=\x27fa\x20fa-check\x27\x20aria-hidden=\x27true\x27\x20style=\x27color:\x20red;\x27></i></label></div></td>',')\x27>Withdraw</a></div></td>','Are\x20you\x20sure\x20to\x20withdraw\x20the\x20Leave?','\x27\x20and\x20AttendanceDate\x20le\x20\x27','toISOString','#HolidaysTH','#EmployeeName','3379952SFuAXQ','[?&]','ProcessApprovers','DELETE','floor','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Time','></div></td>','Empstartrecord','GetAllUserInfo','grep','LogonName','columns','#EndDate','format','POST','#EmpReportTable','tablenav','#Total-Leave-Absent','View','HrAction','getTime','ResolvePrincipalSource','EID','\x27\x20and\x20ContributorsId\x20eq\x20\x27','getMonth','\x27\x20and\x20Holiday_start\x20ge\x20\x27','#Att','#EmpreportTo','attr','#attendance-report-filter','69jDMwOW','660wlEpSN','1276517lHMsqK','</span><span\x20id=\x27H','SPClientPeoplePicker_InitStandaloneControlWrapper','WorkHours','Worksheet','&sourcelocation=../Pages/Myworkplace.aspx\x27\x20><span\x20id=\x27Timeview','setDate','Title','125Rwwssb','#__REQUESTDIGEST','17234jypQuw','#attendance-reportEdit','UserId','round','Empcurrentpage','SP.Data.EmpAttendanceListItem','ready','\x20\x27></div></td>','SPClientPeoplePicker','Leave\x20withdrawal\x20Successfully\x20Completed.','Error!\x20Something\x20went\x20wrong.','\x27\x20and\x20CompanyID\x20eq\x20\x27','Invalid\x20date\x20range.\x0aFrom\x20Date\x20should\x20not\x20be\x20bigger\x20than\x20To\x20Date','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27\x20style=\x27display:\x20','block','#OfficeLoc','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27></div></td>','Emptotalrecords','DD/MM/YYYY','Nov','responseJSON','\x27>Fill</span></a>','AttendanceItemId','#ResultDiv','MaximumEntitySuggestions','/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27','Mar','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27><a\x20href=\x27#\x27\x20class=\x27custom-edit-btn\x27\x20data-toggle=\x27modal\x27\x20data-target=\x27#attendance-reportEdit\x27\x20onclick=\x27attendanceEditModal(','&sourcelocation=../Pages/Myworkplace.aspx\x27>','Unauthorized\x20access!','18aBYcBf','val','/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?select=*,ID,Title&$filter=OfficeLocationID\x20eq\x20\x27','30ZXXSdw','On-LeaveWithdraw','getDate','replace','CompanyId','href','#EmpRow','\x27\x20and\x20Employee\x20eq\x20\x27','DD\x20MMM\x20YYYY','#Workingdays','#EmpName','#StartDate','Width',')\x27><i\x20class=\x27fa\x20fa-pencil\x27></i></a></div></td>','table','oddselected','/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?$filter=OfficeLocationID\x20eq\x20(\x27','Data\x20has\x20been\x20saved.','33745800KAukEI','selectedrow','length','OfficeName','</a>','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27','MERGE','SearchPrincipalSource','evenselected','innerHTML','userId','User,DL,SecGroup,SPGroup','\x20\x27><a\x20href=\x27#\x27\x20class=\x27custom-edit-btn\x27\x20data-toggle=\x27modal\x27\x20data-target=\x27#attendance-reportEdit\x27\x20onclick=\x27attendanceEditModal(','MM\x20dd,\x20yy','SPClientPeoplePickerDict','Empendrecord','evenrow','98708EakwUK','stringify','display','split','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=','Feb','Wednesday','AttendanceType','Tuesday','ajax','desc','/_api/web/lists/GetByTitle(\x27EmpAttendance\x27)/items(','Jul','text','log','\x27\x20and\x20Holiday_start\x20le\x20\x27','</div></td>','slice','#AttendanceDDL','.NoRecordFound','Saturday','#Total-Attendance','<a\x20href=\x27#\x27\x20class=\x27Withdraw-Leave-link\x27\x20onclick=\x27WithdrawLeave(','Dec','results','urlParam','Jan','application/json;odata=verbose','webAbsoluteUrl','/_api/web/ensureuser','280px','children','665669VuxNJz','<a\x20class=\x27LinkBtn\x27\x20href=\x27','#HolidayMessage','btoa','css','join','AttendanceDate','get','\x20,\x20','end','00:00','</tr>','Thursday','#EmpreportFrom','/Pages/TimeSheetEntry.aspx?WebAppId=2&Recall=','#HoliaysTotal'];a6_0x43df=function(){return _0x10dc6a;};return a6_0x43df();}function GetFilterData(_0x27ddfe){var _0x55d8da=a6_0x525372;jQuery[_0x55d8da(0x28c)]({'url':_0x27ddfe,'headers':{'Accept':_0x55d8da(0x1c5)},'async':![],'success':function(_0x545b9a){var _0x2861db=_0x55d8da,_0x2c96b2=_0x545b9a['d'][_0x2861db(0x1c2)],_0x3004e9=[];TotalLeavesorAbsent=[];for(var _0x48cd1e=0x0;_0x48cd1e<_0x2c96b2[_0x2861db(0x274)];_0x48cd1e++){if(_0x2c96b2[_0x48cd1e][_0x2861db(0x28a)]!=_0x2861db(0x1fe)&&_0x2c96b2[_0x48cd1e][_0x2861db(0x28a)]!='Holiday')_0x3004e9[_0x2861db(0x1ea)](_0x2c96b2[_0x48cd1e]['AttendanceType']);else _0x2c96b2[_0x48cd1e][_0x2861db(0x28a)]==_0x2861db(0x1fe)&&TotalLeavesorAbsent['push'](_0x2c96b2[_0x48cd1e][_0x2861db(0x28a)]);}var _0x5c2c2c=$[_0x2861db(0x21e)](_0x2c96b2,function(_0x42b5d3){var _0xe2a758=_0x2861db;return _0x42b5d3[_0xe2a758(0x28a)]!=_0xe2a758(0x1fe)&&_0x42b5d3[_0xe2a758(0x28a)]!=_0xe2a758(0x1de);});$('#Total-Attendance')[_0x2861db(0x1b7)](_0x5c2c2c[_0x2861db(0x274)]);},'error':function(_0x2513ac,_0x2d70d3){var _0x595814=_0x55d8da;console[_0x595814(0x1b8)](JSON[_0x595814(0x284)](_0x2513ac));}});}var G_Validateholiday=![];function GetHolidays(_0x57fe66){var _0x457208=a6_0x525372,_0x1119c0=_spPageContextInfo[_0x457208(0x1c6)]+_0x457208(0x270)+LocID+'\x27)and\x20Holiday_start\x20eq\x20\x27'+_0x57fe66+_0x457208(0x24a)+titanForWork['getQueryStringParameter']('CompanyId')+_0x457208(0x1f5);$['ajax']({'url':_0x1119c0,'headers':{'Accept':_0x457208(0x1c5)},'async':![],'success':function(_0x5aac5a){var _0x3a5253=_0x457208,_0x18ce44=_0x5aac5a['d'][_0x3a5253(0x1c2)];_0x18ce44['length']>0x0?($(_0x3a5253(0x1ef))[_0x3a5253(0x1b7)](_0x18ce44[0x0][_0x3a5253(0x23c)]),$(_0x3a5253(0x1cc))[_0x3a5253(0x1ce)](_0x3a5253(0x285),_0x3a5253(0x24d)),G_Validateholiday=!![]):($(_0x3a5253(0x1ef))[_0x3a5253(0x1b7)](''),$(_0x3a5253(0x1cc))['css']('display','none'),G_Validateholiday=![]);},'error':function(_0x1f66c9){var _0xfdfec2=_0x457208;alert(_0xfdfec2(0x1e9));}});}var EmpAttendanceData=[],TotalLeavesorAbsent=[];function UpdateHeaderfields(_0x598060){jQuery['ajax']({'url':_0x598060,'headers':{'Accept':'application/json;odata=verbose'},'async':!![],'success':function(_0x241cad){var _0x3047fb=a6_0x571d;EmpAttendanceData=[];var _0x10a311=_0x241cad['d']['results'],_0x51f014=[];TotalLeavesorAbsent=[];for(var _0x4670f2=0x0;_0x4670f2<_0x10a311[_0x3047fb(0x274)];_0x4670f2++){if(_0x10a311[_0x4670f2][_0x3047fb(0x28a)]!=_0x3047fb(0x1fe)&&_0x10a311[_0x4670f2][_0x3047fb(0x28a)]!=_0x3047fb(0x1de))_0x51f014[_0x3047fb(0x1ea)](_0x10a311[_0x4670f2]['AttendanceType']);else{if(_0x10a311[_0x4670f2][_0x3047fb(0x28a)]=='On-Leave')TotalLeavesorAbsent[_0x3047fb(0x1ea)](_0x10a311[_0x4670f2][_0x3047fb(0x28a)]);else _0x10a311[_0x4670f2][_0x3047fb(0x28a)]==_0x3047fb(0x1de)&&TotalLeavesorAbsent['push'](_0x10a311[_0x4670f2][_0x3047fb(0x28a)]);}var _0x11bbb9=_0x10a311[_0x4670f2]['ID'],_0x1952c0=_0x10a311[_0x4670f2][_0x3047fb(0x1fb)][_0x3047fb(0x23c)],_0x1e431a=_0x10a311[_0x4670f2]['Employee']['ID'],_0xdf16a7=formatDateReportEmp(_0x10a311[_0x4670f2][_0x3047fb(0x1d0)]),_0x2dadf2=_0x10a311[_0x4670f2][_0x3047fb(0x28a)],_0xbb6a6d=_0x10a311[_0x4670f2][_0x3047fb(0x238)],_0x5aa1c4=_0x10a311[_0x4670f2][_0x3047fb(0x228)];EmpAttendanceData[_0x3047fb(0x1ea)]({'UserId':_0x1e431a,'EmpName':_0x1952c0,'AttendanceDate':_0xdf16a7,'AttendanceType':_0x2dadf2,'AttendanceItemId':_0x11bbb9,'EmpWorkHours':_0xbb6a6d,'HrAction':_0x5aa1c4});}var _0x4fc8dc='',_0x2748e0=0x0,_0x375599=0x0;for(var _0x5c2a22=0x0;_0x5c2a22<Totaldays;_0x5c2a22++){var _0x1b7134=new Date(GstartDate);_0x1b7134[_0x3047fb(0x23b)](_0x1b7134[_0x3047fb(0x262)]()+_0x5c2a22);var _0x1d6e0a=moment(_0x1b7134,_0x3047fb(0x251))[_0x3047fb(0x222)](_0x3047fb(0x200)),_0x1d6e0a=_0x1d6e0a[_0x3047fb(0x286)]('-')[_0x3047fb(0x1cf)](''),_0x432533=formatDateReportEmp(_0x1b7134),_0x1a6132=EmpAttendanceData[_0x3047fb(0x1db)](function(_0x387d75){return _0x387d75['AttendanceDate'];})[_0x3047fb(0x209)](_0x432533);if(_0x1a6132!=-0x1){var _0x51ca5e=EmpAttendanceData[_0x1a6132]['AttendanceType'],_0x148534=EmpAttendanceData[_0x1a6132]['EmpWorkHours'],_0x5aa1c4=EmpAttendanceData[_0x1a6132][_0x3047fb(0x228)],_0x603159=EmpAttendanceData[_0x1a6132][_0x3047fb(0x241)],_0x420fd5=EmpAttendanceData[_0x1a6132][_0x3047fb(0x255)];_0x375599=_0x375599+0x1;}else _0x2748e0=_0x2748e0+0x1;}var _0x1b06f4=parseInt(TotalLeavesorAbsent[_0x3047fb(0x274)])+parseInt(_0x2748e0)-parseInt($('#HoliaysTotal')['text']());_0x1b06f4<0x0&&(_0x1b06f4=0x0);$(_0x3047fb(0x1f2))[_0x3047fb(0x1b7)](Totaldays);var _0x29dc75=parseInt(_0x375599)-parseInt(TotalLeavesorAbsent[_0x3047fb(0x274)]),_0xd7d42a=$[_0x3047fb(0x21e)](_0x10a311,function(_0x2d8373){var _0x46c36c=_0x3047fb;return _0x2d8373['AttendanceType']!=_0x46c36c(0x1fe)&&_0x2d8373[_0x46c36c(0x28a)]!='Holiday';});$(_0x3047fb(0x1bf))[_0x3047fb(0x1b7)](_0xd7d42a[_0x3047fb(0x274)]);},'error':function(_0x3ace56,_0x11697c){var _0x5a7df3=a6_0x571d;console[_0x5a7df3(0x1b8)](JSON['stringify'](_0x3ace56));}});}