var a44_0x2c48b1=a44_0x5a04;(function(_0x16dbba,_0x547c6e){var _0x292c15=a44_0x5a04,_0x7d0ab3=_0x16dbba();while(!![]){try{var _0x55985e=parseInt(_0x292c15(0x1c8))/0x1+-parseInt(_0x292c15(0x180))/0x2*(-parseInt(_0x292c15(0x1b3))/0x3)+-parseInt(_0x292c15(0x196))/0x4*(parseInt(_0x292c15(0x16d))/0x5)+parseInt(_0x292c15(0x1ec))/0x6*(parseInt(_0x292c15(0x204))/0x7)+-parseInt(_0x292c15(0x1a4))/0x8*(-parseInt(_0x292c15(0x1f3))/0x9)+-parseInt(_0x292c15(0x150))/0xa*(-parseInt(_0x292c15(0x203))/0xb)+parseInt(_0x292c15(0x166))/0xc*(-parseInt(_0x292c15(0x1cc))/0xd);if(_0x55985e===_0x547c6e)break;else _0x7d0ab3['push'](_0x7d0ab3['shift']());}catch(_0x2843ab){_0x7d0ab3['push'](_0x7d0ab3['shift']());}}}(a44_0x50c3,0xce4d9));var Totaldays=0x0,CompanyID='',GstartDate='',GEmpID=0x0;$(document)[a44_0x2c48b1(0x14d)](function(){var _0x31bb58=a44_0x2c48b1;ValidateHrAdmin(),CompanyID=titanForWork[_0x31bb58(0x20b)](_0x31bb58(0x16e));var _0x3fde7a=$[_0x31bb58(0x216)](_0x31bb58(0x1d5)),_0x18b4ba=$['urlParam'](_0x31bb58(0x182)),_0x390c19=$[_0x31bb58(0x216)]('end');if(_0x3fde7a!=null){GEmpID=_0x3fde7a;var _0x65ee17=_0x18b4ba[_0x31bb58(0x178)](0x0,0x4)+'-'+_0x18b4ba['slice'](0x4,0x6)+'-'+_0x18b4ba[_0x31bb58(0x178)](0x6,0x8),_0x5920f2=_0x390c19[_0x31bb58(0x178)](0x0,0x4)+'-'+_0x390c19[_0x31bb58(0x178)](0x4,0x6)+'-'+_0x390c19[_0x31bb58(0x178)](0x6,0x8),_0x1dbe31=new Date(_0x5920f2),_0xa96c25=_0x1dbe31[_0x31bb58(0x210)](),_0x56a576=_0xa96c25[_0x31bb58(0x209)]('T');GstartDate=_0x65ee17,$(_0x31bb58(0x14a))[_0x31bb58(0x185)]({'dateFormat':_0x31bb58(0x1d8)})['datepicker'](_0x31bb58(0x18b),new Date(_0x65ee17)),$(_0x31bb58(0x1be))[_0x31bb58(0x185)]({'dateFormat':_0x31bb58(0x1d8)})['datepicker'](_0x31bb58(0x18b),new Date(_0x5920f2));var _0x53ce75=$('#EmpreportFrom')[_0x31bb58(0x185)](_0x31bb58(0x172)),_0x3078c3=$(_0x31bb58(0x1be))[_0x31bb58(0x185)](_0x31bb58(0x172));days=(_0x3078c3-_0x53ce75)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math[_0x31bb58(0x199)](days)+0x1,$(_0x31bb58(0x1a8))[_0x31bb58(0x1e8)](formatDateReportEmp($(_0x31bb58(0x14a))[_0x31bb58(0x154)]())),$('#EndDate')[_0x31bb58(0x1e8)](formatDateReportEmp($(_0x31bb58(0x1be))[_0x31bb58(0x154)]()));var _0x7192ed=_spPageContextInfo[_0x31bb58(0x1e0)]+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27'+_0x3fde7a+_0x31bb58(0x1d6)+CompanyID+'\x27';EmployeeListDat(_0x7192ed),LoadAllHolidays();var _0x1157f4=_spPageContextInfo[_0x31bb58(0x1e0)]+_0x31bb58(0x189)+_0x65ee17+_0x31bb58(0x188)+_0x56a576[0x0]+_0x31bb58(0x1a0)+_0x3fde7a+'\x27\x20';getFileData(_0x1157f4);var _0x7192ed=_spPageContextInfo[_0x31bb58(0x1e0)]+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27'+_0x3fde7a+_0x31bb58(0x1d6)+CompanyID+'\x27';EmployeeListDat(_0x7192ed),LoadAllHolidays(),initializePeoplePicker(_0x31bb58(0x19f));}});var EmployeeID='',ItemID='',SelectedDate='',TDID='';function attendanceEditModal(_0x13b202,_0x1dd8eb,_0x5afcd9){var _0xe2da1f=a44_0x2c48b1;EmployeeID=0x0,ItemID=0x0,SelectedDate='',TDID=_0x5afcd9,EmployeeID=_0x13b202,ItemID=_0x1dd8eb;var _0x3df795=_0x5afcd9[_0xe2da1f(0x1a6)](),_0x3f95e8=_0x3df795[_0xe2da1f(0x178)](0x0,0x4)+'-'+_0x3df795['slice'](0x4,0x6)+'-'+_0x3df795[_0xe2da1f(0x178)](0x6,0x8),_0x3bd7a2=new Date(_0x3f95e8);SelectedDate=_0x3bd7a2[_0xe2da1f(0x210)]()['split']('T')[0x0];var _0x181126=formatDateReportEmp(_0x3bd7a2);$(_0xe2da1f(0x1d4))[_0xe2da1f(0x1e8)](_0x181126),GetHolidays(_0x3f95e8);}function UpdateAttendance(){var _0x567c1b=a44_0x2c48b1;ItemID==0x0?(G_Validateholiday==!![]?confirm('This\x20is\x20a\x20Holiday,\x20are\x20you\x20sure\x20to\x20submit\x20your\x20attendance.')&&PushNewAttendance():PushNewAttendance(),Applyfilter(),LoadAllHolidays()):(G_Validateholiday==!![]?confirm(_0x567c1b(0x1fa))&&ModifyAttendance():ModifyAttendance(),Applyfilter(),LoadAllHolidays());}function PushNewAttendance(){var _0x13072d=a44_0x2c48b1;$(_0x13072d(0x18f))[_0x13072d(0x154)]()!='Holiday'||G_Validateholiday==!![]?$[_0x13072d(0x19b)]({'url':_spPageContextInfo[_0x13072d(0x1e0)]+'/_api/web/lists/GetByTitle(\x27EmpAttendance\x27)/items','type':_0x13072d(0x1bc),'async':![],'data':JSON[_0x13072d(0x1c5)]({'__metadata':{'type':_0x13072d(0x197)},'AttendanceDate':SelectedDate,'EmployeeId':EmployeeID,'AttendanceType':$(_0x13072d(0x18f))[_0x13072d(0x154)]()}),'headers':{'Accept':_0x13072d(0x177),'Content-Type':_0x13072d(0x177),'X-RequestDigest':$(_0x13072d(0x1e2))[_0x13072d(0x154)](),'X-HTTP-Method':_0x13072d(0x1bc)},'success':function(_0x14e485,_0x471fa7,_0x588fb5){var _0x2a9f9e=_0x13072d;$(_0x2a9f9e(0x1e3)+TDID)[_0x2a9f9e(0x1e8)]($(_0x2a9f9e(0x18f))[_0x2a9f9e(0x154)]()),alert('Data\x20has\x20been\x20saved.'),$(_0x2a9f9e(0x16a))['modal'](_0x2a9f9e(0x1d9)),GetAttendanceorLeaves();},'error':function(_0x2174cb,_0x387847,_0x1f7f23){alert('Error!\x20Something\x20went\x20wrong.');}}):alert(_0x13072d(0x184));}function ModifyAttendance(){var _0x10a2ee=a44_0x2c48b1;$(_0x10a2ee(0x18f))[_0x10a2ee(0x154)]()!=_0x10a2ee(0x1ce)||G_Validateholiday==!![]?$['ajax']({'url':_spPageContextInfo[_0x10a2ee(0x1e0)]+_0x10a2ee(0x148)+ItemID+')','type':_0x10a2ee(0x1bc),'async':![],'data':JSON[_0x10a2ee(0x1c5)]({'__metadata':{'type':_0x10a2ee(0x197)},'AttendanceType':$(_0x10a2ee(0x18f))[_0x10a2ee(0x154)]()}),'headers':{'Accept':'application/json;odata=verbose','Content-Type':_0x10a2ee(0x177),'X-RequestDigest':$(_0x10a2ee(0x1e2))['val'](),'IF-MATCH':'*','X-HTTP-Method':'MERGE'},'success':function(_0x415e31,_0x1a1c0b,_0x54941f){var _0x194b58=_0x10a2ee;$(_0x194b58(0x1e3)+TDID)[_0x194b58(0x1e8)]($(_0x194b58(0x18f))[_0x194b58(0x154)]()),$('#Timeview'+TDID)[_0x194b58(0x1e8)](_0x194b58(0x1ad)),alert(_0x194b58(0x1e4)),$(_0x194b58(0x16a))[_0x194b58(0x1fc)]('hide'),GetAttendanceorLeaves();},'error':function(_0x1eee8a,_0x118375,_0x2e8895){alert('Error!\x20Something\x20went\x20wrong.');}}):alert(_0x10a2ee(0x184));}function initializePeoplePicker(_0x449d32){var _0x2c352c=a44_0x2c48b1,_0x54a3db={};_0x54a3db['PrincipalAccountType']='User,DL,SecGroup,SPGroup',_0x54a3db[_0x2c352c(0x1ee)]=0xf,_0x54a3db[_0x2c352c(0x167)]=0xf,_0x54a3db['AllowMultipleValues']=![],_0x54a3db[_0x2c352c(0x191)]=0x32,_0x54a3db[_0x2c352c(0x17a)]='280px',this['SPClientPeoplePicker_InitStandaloneControlWrapper'](_0x449d32,null,_0x54a3db);}function Applyfilter(){var _0x2a4b95=a44_0x2c48b1,_0x311c59=moment($('#EmpreportFrom')[_0x2a4b95(0x154)](),'LL')[_0x2a4b95(0x20f)](_0x2a4b95(0x1f0)),_0x55bec8=moment($(_0x2a4b95(0x1be))[_0x2a4b95(0x154)](),'LL')[_0x2a4b95(0x20f)]('DD\x20MMM\x20YYYY');if(Date[_0x2a4b95(0x17f)](_0x311c59)>Date[_0x2a4b95(0x17f)](_0x55bec8))alert(_0x2a4b95(0x19c));else{$('#attendance-report-filter')[_0x2a4b95(0x1fc)](_0x2a4b95(0x1d9));var _0x58ae86=$['urlParam'](_0x2a4b95(0x1d5)),_0x8dedd1=$(_0x2a4b95(0x14a))['datepicker'](_0x2a4b95(0x172)),_0x3add60=$(_0x2a4b95(0x1be))['datepicker'](_0x2a4b95(0x172));days=(_0x3add60-_0x8dedd1)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math[_0x2a4b95(0x199)](days)+0x1,$('#StartDate')[_0x2a4b95(0x1e8)](formatDateReportEmp($(_0x2a4b95(0x14a))[_0x2a4b95(0x154)]())),$(_0x2a4b95(0x15b))[_0x2a4b95(0x1e8)](formatDateReportEmp($(_0x2a4b95(0x1be))[_0x2a4b95(0x154)]()));var _0x311c59=moment($(_0x2a4b95(0x14a))['val'](),'LL')[_0x2a4b95(0x20f)](_0x2a4b95(0x176)),_0x55bec8=moment($('#EmpreportTo')[_0x2a4b95(0x154)](),'LL')['format'](_0x2a4b95(0x176)),_0xe0faef=new Date(_0x55bec8),_0x38f82b=_0xe0faef['toISOString'](),_0x3ba58d=_0x38f82b[_0x2a4b95(0x209)]('T');GstartDate=_0x311c59;var _0x1eb18d=ensureUser($(_0x2a4b95(0x190))[_0x2a4b95(0x17d)]()[_0x2a4b95(0x17d)]()[_0x2a4b95(0x1e5)]('id'));if(_0x1eb18d==0x0){_0x58ae86=_0x58ae86,GEmpID=_0x58ae86;var _0x1fe1a2=_spPageContextInfo[_0x2a4b95(0x1e0)]+'/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27'+_0x311c59+_0x2a4b95(0x188)+_0x3ba58d[0x0]+'\x27\x20and\x20Employee\x20eq\x20\x27'+_0x58ae86+'\x27\x20';getFileData(_0x1fe1a2);var _0x534e05=_spPageContextInfo[_0x2a4b95(0x1e0)]+_0x2a4b95(0x14c)+_0x58ae86+_0x2a4b95(0x1d6)+CompanyID+'\x27';EmployeeListDat(_0x534e05);}else{if(ISHRADMIN==!![]){_0x58ae86=_0x1eb18d,GEmpID=_0x1eb18d;var _0x1fe1a2=_spPageContextInfo[_0x2a4b95(0x1e0)]+_0x2a4b95(0x189)+_0x311c59+_0x2a4b95(0x188)+_0x3ba58d[0x0]+_0x2a4b95(0x1a0)+_0x58ae86+'\x27\x20';getFileData(_0x1fe1a2);var _0x534e05=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27'+_0x58ae86+_0x2a4b95(0x1d6)+CompanyID+'\x27';EmployeeListDat(_0x534e05);}else alert(_0x2a4b95(0x181));}LoadAllHolidays();}}var DataIdList=[],EmpAttendanceData=[],TotalLeavesorAbsent=[];function getFileData(_0x4b362b){var _0x4175dd=a44_0x2c48b1;jQuery['ajax']({'url':_0x4b362b,'headers':{'Accept':_0x4175dd(0x177)},'async':![],'success':function(_0x430b58){var _0x52dd55=_0x4175dd;EmpAttendanceData=[];var _0x5c2218=_0x430b58['d']['results'];DataIdList=[];var _0x487945=[];TotalLeavesorAbsent=[];for(var _0x2ed2d7=0x0;_0x2ed2d7<_0x5c2218['length'];_0x2ed2d7++){if(_0x5c2218[_0x2ed2d7][_0x52dd55(0x1b9)]!=_0x52dd55(0x198)&&_0x5c2218[_0x2ed2d7][_0x52dd55(0x1b9)]!=_0x52dd55(0x1ce))_0x487945[_0x52dd55(0x156)](_0x5c2218[_0x2ed2d7][_0x52dd55(0x1b9)]);else{if(_0x5c2218[_0x2ed2d7][_0x52dd55(0x1b9)]==_0x52dd55(0x198))TotalLeavesorAbsent['push'](_0x5c2218[_0x2ed2d7][_0x52dd55(0x1b9)]);else _0x5c2218[_0x2ed2d7][_0x52dd55(0x1b9)]==_0x52dd55(0x1ce)&&TotalLeavesorAbsent[_0x52dd55(0x156)](_0x5c2218[_0x2ed2d7]['AttendanceType']);}var _0x270f61=_0x5c2218[_0x2ed2d7]['ID'],_0x4b4c66=_0x5c2218[_0x2ed2d7]['Employee'][_0x52dd55(0x1ab)],_0x3d4f95=_0x5c2218[_0x2ed2d7]['Employee']['ID'],_0xaa5d35=formatDateReportEmp(_0x5c2218[_0x2ed2d7][_0x52dd55(0x1b8)]),_0x1a1eae=_0x5c2218[_0x2ed2d7][_0x52dd55(0x1b9)],_0x563e0a=_0x5c2218[_0x2ed2d7][_0x52dd55(0x1b2)],_0x6ad474=_0x5c2218[_0x2ed2d7]['HrAction'];EmpAttendanceData['push']({'UserId':_0x3d4f95,'EmpName':_0x4b4c66,'AttendanceDate':_0xaa5d35,'AttendanceType':_0x1a1eae,'AttendanceItemId':_0x270f61,'EmpWorkHours':_0x563e0a,'HrAction':_0x6ad474});}var _0xece071='';$(_0x52dd55(0x179))[_0x52dd55(0x1d2)]();var _0xe4fe33=0x0,_0x5dd2bc=0x0;for(var _0x8b042f=0x0;_0x8b042f<Totaldays;_0x8b042f++){var _0x28b156=new Date(GstartDate);_0x28b156[_0x52dd55(0x18b)](_0x28b156[_0x52dd55(0x172)]()+_0x8b042f);var _0x557335=moment(_0x28b156,_0x52dd55(0x195))[_0x52dd55(0x20f)](_0x52dd55(0x176)),_0x557335=_0x557335['split']('-')[_0x52dd55(0x1f8)]('');DataIdList['push'](_0x557335);var _0xe0fe63=formatDateReportEmp(_0x28b156),_0x563351=EmpAttendanceData['map'](function(_0x12c245){return _0x12c245['AttendanceDate'];})['indexOf'](_0xe0fe63);if(_0x563351!=-0x1){var _0x38e77a=EmpAttendanceData[_0x563351][_0x52dd55(0x1b9)],_0x4bcb36=EmpAttendanceData[_0x563351][_0x52dd55(0x1dd)],_0x6ad474=EmpAttendanceData[_0x563351][_0x52dd55(0x213)],_0xbed38f=EmpAttendanceData[_0x563351][_0x52dd55(0x18a)],_0x3b4c66=EmpAttendanceData[_0x563351]['AttendanceItemId'],_0xeaac5d=EmpAttendanceData[_0x563351][_0x52dd55(0x1b8)],_0x375f58=_0x52dd55(0x161),_0x47815f=_0x52dd55(0x205);_0x6ad474==!![]&&(_0x375f58=_0x52dd55(0x205),_0x47815f=_0x52dd55(0x161));if(_0x38e77a!='On-Leave'&&_0x38e77a!='Holiday'){if(_0x4bcb36==null)var _0x5b276a=_0x52dd55(0x1ae)+_spPageContextInfo[_0x52dd55(0x1e0)]+_0x52dd55(0x1d7)+_0x557335+_0x52dd55(0x162)+window[_0x52dd55(0x17e)]('View')+'&sourcelocation=../Pages/Myworkplace.aspx\x27\x20><span\x20id=\x27Timeview'+_0x557335+_0x52dd55(0x1af);else var _0x5b276a=_0x52dd55(0x217)+_spPageContextInfo[_0x52dd55(0x1e0)]+_0x52dd55(0x1d7)+_0x557335+_0x52dd55(0x162)+window[_0x52dd55(0x17e)]('View')+_0x52dd55(0x14b)+ConvertHHMM(_0x4bcb36)+_0x52dd55(0x1e6);}else var _0x5b276a='';var _0x450d21=![],_0x26c600=Date[_0x52dd55(0x17f)](_0xeaac5d[_0x52dd55(0x209)](',')[0x0]),_0x2ac93a=new Date(),_0x5ccb39=Date[_0x52dd55(0x17f)](moment(_0x2ac93a)[_0x52dd55(0x20f)](_0x52dd55(0x1f0)));_0x26c600>_0x5ccb39&&(_0x450d21=!![]),_0x5dd2bc=_0x5dd2bc+0x1,_0x450d21!=!![]?(_0xece071+=_0x52dd55(0x15c),_0xece071+=_0x52dd55(0x1a5)+_0x557335+'><span>'+formatDateReportEmp(_0x28b156)+_0x52dd55(0x1f6)+_0x557335+'\x27\x20class=\x27employee-report-holiday\x27></span></div></td>',_0xece071+=_0x52dd55(0x1aa)+_0x557335+'>'+_0x38e77a+'</div></td>',_0xece071+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Time'+_0x557335+'>'+_0x5b276a+_0x52dd55(0x16c),_0xece071+='<td><div\x20class=\x27checkbox\x20m-0\x27\x20style=\x27display:\x20'+_0x375f58+'\x20\x27><label><i\x20class=\x27fa\x20fa-check\x27\x20aria-hidden=\x27true\x27\x20style=\x27color:\x20red;\x27></i></label></div></td>',_0xece071+=_0x52dd55(0x1ca)+_0x47815f+_0x52dd55(0x163)+GEmpID+','+_0x3b4c66+','+_0x557335+_0x52dd55(0x15e),_0xece071+=_0x52dd55(0x1f9)):(_0xece071+='<tr\x20class=\x27text-center\x27\x20>',_0xece071+=_0x52dd55(0x1a5)+_0x557335+_0x52dd55(0x20c)+formatDateReportEmp(_0x28b156)+_0x52dd55(0x1f6)+_0x557335+_0x52dd55(0x20e),_0xece071+=_0x52dd55(0x1aa)+_0x557335+'>'+_0x38e77a+_0x52dd55(0x201)+_0x3b4c66+','+_0x557335+_0x52dd55(0x1e7),_0xece071+=_0x52dd55(0x1b7)+_0x557335+'>'+_0x5b276a+'</div></td>',_0xece071+=_0x52dd55(0x151)+_0x375f58+_0x52dd55(0x1b6),_0xece071+=_0x52dd55(0x1ca)+_0x47815f+_0x52dd55(0x186),_0xece071+=_0x52dd55(0x1f9));}else{var _0x1cb9b5=formatDateReportEmp(_0x28b156),_0x450d21=![],_0x26c600=Date[_0x52dd55(0x17f)](_0x1cb9b5[_0x52dd55(0x209)](',')[0x0]),_0x2ac93a=new Date(),_0x5ccb39=Date['parse'](moment(_0x2ac93a)[_0x52dd55(0x20f)](_0x52dd55(0x1f0)));_0x26c600>_0x5ccb39&&(_0x450d21=!![]);_0xe4fe33=_0xe4fe33+0x1;if(_0x450d21!=!![]){var _0x39cd74=_0x52dd55(0x1ae)+_spPageContextInfo['webAbsoluteUrl']+_0x52dd55(0x1d7)+_0x557335+_0x52dd55(0x162)+window[_0x52dd55(0x17e)](_0x52dd55(0x147))+_0x52dd55(0x214)+_0x557335+_0x52dd55(0x1af);_0xece071+=_0x52dd55(0x15c),_0xece071+=_0x52dd55(0x1a5)+_0x557335+'><span>'+formatDateReportEmp(_0x28b156)+_0x52dd55(0x1f6)+_0x557335+_0x52dd55(0x20e),_0xece071+=_0x52dd55(0x1aa)+_0x557335+'></div></td>',_0xece071+=_0x52dd55(0x1b7)+_0x557335+_0x52dd55(0x183),_0xece071+=_0x52dd55(0x1a1),_0xece071+=_0x52dd55(0x206)+GEmpID+_0x52dd55(0x159)+_0x557335+')\x27><i\x20class=\x27fa\x20fa-pencil\x27></i></a></div></td>',_0xece071+=_0x52dd55(0x1f9);}else{var _0x39cd74='<a\x20class=\x27LinkBtn\x27\x20href=\x27'+_spPageContextInfo['webAbsoluteUrl']+'/Pages/TimeSheetEntry.aspx?WebAppId=2&Recall='+_0x557335+_0x52dd55(0x162)+window['btoa'](_0x52dd55(0x147))+_0x52dd55(0x214)+_0x557335+_0x52dd55(0x1af);_0xece071+=_0x52dd55(0x15c),_0xece071+=_0x52dd55(0x1a5)+_0x557335+'><span>'+formatDateReportEmp(_0x28b156)+_0x52dd55(0x1f6)+_0x557335+_0x52dd55(0x20e),_0xece071+=_0x52dd55(0x1aa)+_0x557335+_0x52dd55(0x183),_0xece071+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Time'+_0x557335+_0x52dd55(0x183),_0xece071+='<td><div\x20class=\x27checkbox\x20m-0\x27></div></td>',_0xece071+=_0x52dd55(0x16b),_0xece071+='</tr>';}}}var _0x4cc6c6=$[_0x52dd55(0x171)](_0x5c2218,function(_0x28ae95){var _0x12e307=_0x52dd55;return _0x28ae95[_0x12e307(0x1b9)]!=_0x12e307(0x198)&&_0x28ae95['AttendanceType']!=_0x12e307(0x1ce);}),_0x14e316=parseInt(TotalLeavesorAbsent[_0x52dd55(0x1d0)])+parseInt(_0xe4fe33)-parseInt($(_0x52dd55(0x1d3))[_0x52dd55(0x1e8)]());_0x14e316<0x0&&(_0x14e316=0x0);$(_0x52dd55(0x1a2))[_0x52dd55(0x1d9)](),$(_0x52dd55(0x164))['text'](Totaldays);var _0x185a87=parseInt(_0x5dd2bc)-parseInt(TotalLeavesorAbsent['length']);$(_0x52dd55(0x1fe))[_0x52dd55(0x1e8)](_0x4cc6c6[_0x52dd55(0x1d0)]),$(_0x52dd55(0x179))[_0x52dd55(0x1b1)](_0xece071),EmpTableConfiguration();},'error':function(_0x1687df,_0x50d5a5){var _0x4f9088=_0x4175dd;console[_0x4f9088(0x20d)](JSON[_0x4f9088(0x1c5)](_0x1687df));}});}function WithdrawLeave(_0x3b7b87,_0x255de8){var _0x21288e=a44_0x2c48b1;confirm(_0x21288e(0x152))&&$['ajax']({'url':_spPageContextInfo[_0x21288e(0x1e0)]+_0x21288e(0x148)+_0x3b7b87+')','type':_0x21288e(0x1bc),'headers':{'X-RequestDigest':$('#__REQUESTDIGEST')[_0x21288e(0x154)](),'IF-MATCH':'*','X-HTTP-Method':'DELETE'},'success':function(_0x28244b,_0x1fb0e4,_0x5d330b){var _0x4b5dcd=_0x21288e;$(_0x4b5dcd(0x1e3)+_0x255de8)['css']('display',_0x4b5dcd(0x161)),alert('Leave\x20withdrawal\x20Successfully\x20Completed.');},'error':function(_0x4b0a69,_0x4dad26,_0x538227){var _0x8da8e5=_0x21288e;$(_0x8da8e5(0x1c3))[_0x8da8e5(0x1d2)]()[_0x8da8e5(0x1e8)](data[_0x8da8e5(0x20a)][_0x8da8e5(0x155)]);}});}function ConvertDateTimeFormat(_0x3197f9,_0x4f923b){var _0x73b128=a44_0x2c48b1;return _0x3197f9['split'](_0x4f923b)[0x1]+''+_0x4f923b+''+_0x3197f9[_0x73b128(0x209)](_0x4f923b)[0x0]+''+_0x4f923b+''+_0x3197f9[_0x73b128(0x209)](_0x4f923b)[0x2];}var GEmployeeID=0x0,LocID=0x0;function EmployeeListDat(_0x365d3b){var _0x41e6f9=a44_0x2c48b1;GEmployeeID=0x0,$[_0x41e6f9(0x19b)]({'url':_0x365d3b,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x58a8ee){var _0x3ebfc6=_0x41e6f9,_0x1d3f79=_0x58a8ee['d']['results'];_0x1d3f79[_0x3ebfc6(0x1d0)]>0x0?($(_0x3ebfc6(0x1c7))[_0x3ebfc6(0x1e8)](_0x1d3f79[0x0][_0x3ebfc6(0x211)][_0x3ebfc6(0x1ab)]),GEmployeeID=_0x1d3f79[0x0][_0x3ebfc6(0x211)]['ID'],$(_0x3ebfc6(0x207))['text'](_0x1d3f79[0x0][_0x3ebfc6(0x211)][_0x3ebfc6(0x1ab)]),$('#OfficeLoc')[_0x3ebfc6(0x1e8)](_0x1d3f79[0x0][_0x3ebfc6(0x1db)][_0x3ebfc6(0x157)]),$(_0x3ebfc6(0x218))[_0x3ebfc6(0x1e8)](_0x1d3f79[0x0][_0x3ebfc6(0x1db)][_0x3ebfc6(0x157)]),LocID=_0x1d3f79[0x0]['OfficeLocation']['ID']):($(_0x3ebfc6(0x1c7))[_0x3ebfc6(0x1e8)](''),$(_0x3ebfc6(0x1f5))[_0x3ebfc6(0x1e8)](''),LocID=0x0);},'error':function(_0x118339){console['log'](_0x118339);}});}function EmpTableConfiguration(){var _0x4dcfa5=a44_0x2c48b1;sorter=new TINY['table'][(_0x4dcfa5(0x1f7))](_0x4dcfa5(0x1f7),'EmpReportTableData',{'ascclass':_0x4dcfa5(0x193),'descclass':'desc','evenclass':'evenrow','oddclass':_0x4dcfa5(0x1fd),'evenselclass':_0x4dcfa5(0x1ea),'oddselclass':'oddselected','paginate':!![],'size':0xa,'colddid':_0x4dcfa5(0x146),'currentid':_0x4dcfa5(0x1bf),'totalid':_0x4dcfa5(0x19a),'startingrecid':_0x4dcfa5(0x15d),'endingrecid':_0x4dcfa5(0x1e1),'totalrecid':_0x4dcfa5(0x1da),'hoverid':'selectedrow','pageddid':_0x4dcfa5(0x1c6),'navid':_0x4dcfa5(0x1bd),'sortdir':0x1,'init':!![]});}$[a44_0x2c48b1(0x216)]=function(_0x292d1e){var _0x2be65f=a44_0x2c48b1,_0x74c535=new RegExp(_0x2be65f(0x1f4)+_0x292d1e+'=([^&#]*)')[_0x2be65f(0x1ef)](window[_0x2be65f(0x1c4)][_0x2be65f(0x165)]);if(_0x74c535==null)return null;return decodeURI(_0x74c535[0x1])||0x0;};function formatDateReportEmp(_0x58322f){var _0x3cea9a=a44_0x2c48b1,_0x3b47c3=[_0x3cea9a(0x1df),_0x3cea9a(0x208),_0x3cea9a(0x1ff),_0x3cea9a(0x160),'Thursday',_0x3cea9a(0x1b0),'Saturday'],_0x603472=new Date(_0x58322f);if(isNaN(_0x603472['getTime']()))return _0x58322f;else{var _0x4634aa=new Array();return _0x4634aa[0x0]=_0x3cea9a(0x169),_0x4634aa[0x1]=_0x3cea9a(0x153),_0x4634aa[0x2]=_0x3cea9a(0x1d1),_0x4634aa[0x3]=_0x3cea9a(0x1c2),_0x4634aa[0x4]=_0x3cea9a(0x1fb),_0x4634aa[0x5]=_0x3cea9a(0x1a7),_0x4634aa[0x6]=_0x3cea9a(0x17b),_0x4634aa[0x7]=_0x3cea9a(0x1e9),_0x4634aa[0x8]=_0x3cea9a(0x173),_0x4634aa[0x9]=_0x3cea9a(0x15f),_0x4634aa[0xa]='Nov',_0x4634aa[0xb]='Dec',day=_0x603472['getDate'](),day<0xa&&(day='0'+day),day+'\x20'+_0x4634aa[_0x603472['getMonth']()]+'\x20'+_0x603472['getFullYear']()+',\x20'+_0x3b47c3[_0x603472[_0x3cea9a(0x215)]()];}}function ConvertHHMM(_0x3ff78e){var _0x275499=a44_0x2c48b1;if(_0x3ff78e!=null){var _0x5232e8=Math[_0x275499(0x1c9)](_0x3ff78e/0x3c),_0x5b1b37=_0x3ff78e%0x3c;_0x5232e8<0xa&&(_0x5232e8='0'+_0x5232e8);_0x5b1b37<0xa&&(_0x5b1b37='0'+_0x5b1b37);var _0x2d7399=_0x5232e8+':'+_0x5b1b37;}else var _0x2d7399='';return _0x2d7399;}var AttandenceOnHolidays=0x0,HolidaysListDTL=[];function LoadAllHolidays(){var _0x25ec1a=a44_0x2c48b1;TotalOfficeDays=0x0,HolidaysListDTL=[];var _0x49edaf=new Date($(_0x25ec1a(0x14a))[_0x25ec1a(0x154)]()),_0x4859a9=_0x49edaf['getFullYear']()+'-'+(_0x49edaf[_0x25ec1a(0x19d)]()+0x1)+'-'+_0x49edaf[_0x25ec1a(0x172)](),_0x222d2c=new Date($(_0x25ec1a(0x1be))[_0x25ec1a(0x154)]()),_0x5abadb=_0x222d2c[_0x25ec1a(0x1c0)]()+'-'+(_0x222d2c[_0x25ec1a(0x19d)]()+0x1)+'-'+_0x222d2c[_0x25ec1a(0x172)](),_0x4e8316=_spPageContextInfo[_0x25ec1a(0x1e0)]+'/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?select=*,ID,Title&$filter=OfficeLocationID\x20eq\x20\x27'+LocID+'\x27\x20and\x20CompanyID\x20eq\x20\x27'+CompanyID+_0x25ec1a(0x1a3)+_0x4859a9+_0x25ec1a(0x1c1)+_0x5abadb+'\x27';$[_0x25ec1a(0x19b)]({'url':_0x4e8316,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x346038){var _0x19d34c=_0x25ec1a,_0x248051=_0x346038['d'][_0x19d34c(0x14e)][_0x19d34c(0x1d0)],_0x5704ff=0x0;for(var _0x308ed5=0x0;_0x308ed5<_0x248051;_0x308ed5++){var _0x78f7bb=new Date(_0x346038['d'][_0x19d34c(0x14e)][_0x308ed5][_0x19d34c(0x1b4)]),_0xa2d87c=moment(_0x78f7bb,_0x19d34c(0x195))[_0x19d34c(0x20f)](_0x19d34c(0x176)),_0xa2d87c=_0xa2d87c[_0x19d34c(0x209)]('-')[_0x19d34c(0x1f8)](''),_0x10bd80=_0x346038['d'][_0x19d34c(0x14e)][_0x308ed5][_0x19d34c(0x1ab)];HolidaysListDTL['push']({'Hdate':_0xa2d87c,'Title':_0x10bd80}),$('#'+_0xa2d87c)['css']('color',_0x19d34c(0x175)),$('#H'+_0xa2d87c)[_0x19d34c(0x1e8)]('\x20,\x20'+_0x10bd80),$(_0x19d34c(0x1e3)+_0xa2d87c)[_0x19d34c(0x1e8)]()!=''&&(_0x5704ff=_0x5704ff+0x1);}AttandenceOnHolidays=0x0;for(var _0x7a5b02=0x0;_0x7a5b02<HolidaysListDTL[_0x19d34c(0x1d0)];_0x7a5b02++){var _0x5e87d5=$(_0x19d34c(0x1e3)+HolidaysListDTL[_0x7a5b02][_0x19d34c(0x1cf)])[_0x19d34c(0x1e8)]();_0x5e87d5!=''&&_0x5e87d5!='On-Leave'&&_0x5e87d5!=_0x19d34c(0x1ce)&&(AttandenceOnHolidays=AttandenceOnHolidays+0x1);}var _0x230808=0x0,_0x5a4ec9=0x0,_0x103cec=0x0;for(var _0x26c8b9=0x0;_0x26c8b9<DataIdList['length'];_0x26c8b9++){var _0x3e678d=$(_0x19d34c(0x1e3)+DataIdList[_0x26c8b9])[_0x19d34c(0x1e8)]();_0x3e678d=='On-LeaveWithdraw'&&(_0x3e678d=_0x3e678d['split'](_0x19d34c(0x1bb))[0x0]),(_0x3e678d==''||_0x3e678d=='On-Leave')&&(_0x5a4ec9=_0x5a4ec9+0x1),_0x3e678d==_0x19d34c(0x198)&&(_0x103cec=_0x103cec+0x1),_0x3e678d==_0x19d34c(0x1ce)&&(_0x230808=_0x230808+0x1);}var _0xeeb762=_0x5a4ec9+AttandenceOnHolidays-(_0x248051-_0x230808);_0xeeb762<0x0&&(_0xeeb762=0x0),_0xeeb762!='0'?$(_0x19d34c(0x1cd))[_0x19d34c(0x1e8)](_0xeeb762):_0x103cec>0x0&&$(_0x19d34c(0x1cd))['text'](_0x103cec),$(_0x19d34c(0x1d3))[_0x19d34c(0x1e8)](_0x248051),$(_0x19d34c(0x18e))['text'](parseInt(Totaldays)-parseInt(_0x248051)),$('#FdateTH')['text'](formatDateReportEmp(ConvertDateTimeFormat($(_0x19d34c(0x14a))[_0x19d34c(0x154)](),'/'))),$(_0x19d34c(0x200))[_0x19d34c(0x1e8)](formatDateReportEmp(ConvertDateTimeFormat($(_0x19d34c(0x1be))[_0x19d34c(0x154)](),'/'))),$(_0x19d34c(0x174))[_0x19d34c(0x1e8)](parseInt(Totaldays)-parseInt(_0x248051)),$(_0x19d34c(0x1ba))[_0x19d34c(0x1e8)](_0x248051);},'myError':function(_0x213eaa){}});}function ensureUser(_0x3392b2){var _0x424857=a44_0x2c48b1,_0x2925fa=0x0,_0xba50e8=_0x3392b2,_0x42feb4=this[_0x424857(0x149)][_0x424857(0x168)][_0xba50e8],_0x4c5896=_0x42feb4[_0x424857(0x158)](),_0x445846=_0x4c5896[0x0];if(_0x445846){var _0x4088e0={'logonName':_0x445846[_0x424857(0x145)]};$[_0x424857(0x19b)]({'url':_spPageContextInfo[_0x424857(0x1e0)]+_0x424857(0x15a),'type':_0x424857(0x1bc),'async':![],'contentType':_0x424857(0x177),'data':JSON[_0x424857(0x1c5)](_0x4088e0),'headers':{'X-RequestDigest':$('#__REQUESTDIGEST')['val'](),'accept':_0x424857(0x177)},'success':function(_0x5c86b4,_0x163735,_0xb3c446){_0x2925fa=_0x5c86b4['d']['Id'];},'error':function(_0x5c757b,_0x3536ea,_0x29fa76){}});}else _0x2925fa=0x0;return _0x2925fa;}function a44_0x5a04(_0x63316d,_0x299810){var _0x50c303=a44_0x50c3();return a44_0x5a04=function(_0x5a0427,_0x3fb6f6){_0x5a0427=_0x5a0427-0x145;var _0x218bd3=_0x50c303[_0x5a0427];return _0x218bd3;},a44_0x5a04(_0x63316d,_0x299810);}function a44_0x50c3(){var _0x4bd360=['00:00','<a\x20class=\x27LinkBtn\x27\x20href=\x27','\x27>Fill</span></a>','Friday','append','WorkHours','12OEyrBF','Holiday_start','/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?$filter=OfficeLocationID\x20eq\x20(\x27','\x20\x27><label><i\x20class=\x27fa\x20fa-check\x27\x20aria-hidden=\x27true\x27\x20style=\x27color:\x20red;\x27></i></label></div></td>','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Time','AttendanceDate','AttendanceType','#HolidaysTH','Withdraw','POST','tablenav','#EmpreportTo','Empcurrentpage','getFullYear','\x27\x20and\x20Holiday_start\x20le\x20\x27','Apr','#ResultDiv','location','stringify','Emppagedropdown','#EmpName','976631ICnryF','floor','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27\x20style=\x27display:\x20','\x27\x20and\x20ContributorsId\x20eq\x20\x27','16820089kaeKtg','#Total-Leave-Absent','Holiday','Hdate','length','Mar','empty','#HoliaysTotal','#SelDate','EID','\x27\x20and\x20Company/ID\x20\x20eq\x20\x27','/Pages/TimeSheetEntry.aspx?WebAppId=2&Recall=','MM\x20dd,\x20yy','hide','Emptotalrecords','OfficeLocation','data:application/vnd.ms-excel;base64,','EmpWorkHours','#HolidayMessage','Sunday','webAbsoluteUrl','Empendrecord','#__REQUESTDIGEST','#Att','Data\x20has\x20been\x20saved.','attr','</a>',')\x27>Withdraw</a></div></td>','text','Aug','evenselected','<html\x20xmlns:o=\x22urn:schemas-microsoft-com:office:office\x22\x20xmlns:x=\x22urn:schemas-microsoft-com:office:excel\x22\x20xmlns=\x22http://www.w3.org/TR/REC-html40\x22><head><!--[if\x20gte\x20mso\x209]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>','6DpUnre','ProcessApprovers','SearchPrincipalSource','exec','DD\x20MMM\x20YYYY','getElementById','nodeType','1413lXXfVf','[?&]','#OfficeLoc','</span><span\x20id=\x27H','sorter','join','</tr>','This\x20is\x20a\x20Holiday,\x20are\x20you\x20sure\x20to\x20submit\x20your\x20attendance.','May','modal','oddrow','#Total-Attendance','Tuesday','#EdateTH','<a\x20href=\x27#\x27\x20class=\x27Withdraw-Leave-link\x27\x20onclick=\x27WithdrawLeave(','Employee','11SkFPic','7164101GXmkSq','block','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27><a\x20href=\x27#\x27\x20class=\x27custom-edit-btn\x27\x20data-toggle=\x27modal\x27\x20data-target=\x27#attendance-reportEdit\x27\x20onclick=\x27attendanceEditModal(','#EmpTitle','Monday','split','responseJSON','getQueryStringParameter','><span>','log','\x27\x20class=\x27employee-report-holiday\x27></span></div></td>','format','toISOString','LogonName','#EmpRow','HrAction','&sourcelocation=../Pages/Myworkplace.aspx\x27\x20><span\x20id=\x27Timeview','getDay','urlParam','<a\x20href=\x27','#officeLocTH','get','Key','columns','View','/_api/web/lists/GetByTitle(\x27EmpAttendance\x27)/items(','SPClientPeoplePicker','#EmpreportFrom','&sourcelocation=../Pages/Myworkplace.aspx\x27>','/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27','ready','results','indexOf','3147110XNwWVY','<td><div\x20class=\x27checkbox\x20m-0\x27\x20style=\x27display:\x20','Are\x20you\x20sure\x20to\x20withdraw\x20the\x20Leave?','Feb','val','error','push','OfficeName','GetAllUserInfo',',0,','/_api/web/ensureuser','#EndDate','<tr\x20class=\x27text-center\x27\x20>','Empstartrecord',')\x27><i\x20class=\x27fa\x20fa-pencil\x27></i></a></div></td>','Oct','Wednesday','none','&Mode=','\x20\x27><a\x20href=\x27#\x27\x20class=\x27custom-edit-btn\x27\x20data-toggle=\x27modal\x27\x20data-target=\x27#attendance-reportEdit\x27\x20onclick=\x27attendanceEditModal(','#EmpTotalItemscount','href','12pAKuct','ResolvePrincipalSource','SPClientPeoplePickerDict','Jan','#attendance-reportEdit','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27></div></td>','</div></td>','10fnppkn','CompanyId','map','css','grep','getDate','Sept','#TotalWorkdayTH','red','YYYY-MM-DD','application/json;odata=verbose','slice','#EmpReportTable','Width','Jul','#HolidayMessagediv','children','btoa','parse','19258isxdQR','Unauthorized\x20access!','start','></div></td>','Plese\x20select\x20proper\x20attandence.','datepicker','\x20\x27></div></td>','replace','\x27\x20and\x20AttendanceDate\x20le\x20\x27','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27','UserId','setDate','innerHTML','\x27)/items?$select=*,Department/DepartmentName,Department/ID&$expand=Department&$filter=CompanyId\x20eq\x20\x27','#Workingdays','#AttendanceDDL','#EmployeeName','MaximumEntitySuggestions','userId','asc','An\x20error\x20occurred.\x20Please\x20try\x20again.','DD/MM/YYYY','2755916qcAmFY','SP.Data.EmpAttendanceListItem','On-Leave','round','Emptotalpages','ajax','Invalid\x20date\x20range.\x0aFrom\x20Date\x20should\x20not\x20be\x20bigger\x20than\x20To\x20Date','getMonth','/_api/web/lists/getbytitle(\x27','EmployeeName','\x27\x20and\x20Employee\x20eq\x20\x27','<td><div\x20class=\x27checkbox\x20m-0\x27></div></td>','.NoRecordFound','\x27\x20and\x20Holiday_start\x20ge\x20\x27','59288ZKoAvk','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=','toString','Jun','#StartDate','\x27)and\x20Holiday_start\x20eq\x20\x27','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Att','Title','\x27\x20and\x20(WebPartName\x20eq\x20\x27HR\x20Admin\x27)'];a44_0x50c3=function(){return _0x4bd360;};return a44_0x50c3();}var tableToExcel=(function(){var _0x59e660=a44_0x2c48b1,_0x477f61=_0x59e660(0x1dc),_0x2d3d85=_0x59e660(0x1eb),_0x1bc38e=function(_0x28f990){var _0x443e1e=_0x59e660;return window[_0x443e1e(0x17e)](unescape(encodeURIComponent(_0x28f990)));},_0x42255d=function(_0x2d4a47,_0x3a09e7){var _0x72aa91=_0x59e660;return _0x2d4a47[_0x72aa91(0x187)](/{(\w+)}/g,function(_0x4c015b,_0xb52c18){return _0x3a09e7[_0xb52c18];});};return function(_0x18f0e6,_0x33e500){var _0x51f820=_0x59e660;if(!_0x18f0e6[_0x51f820(0x1f2)])_0x18f0e6=document[_0x51f820(0x1f1)](_0x18f0e6);var _0x109eff={'worksheet':_0x33e500||'Worksheet','table':_0x18f0e6[_0x51f820(0x18c)]};window[_0x51f820(0x1c4)][_0x51f820(0x165)]=_0x477f61+_0x1bc38e(_0x42255d(_0x2d3d85,_0x109eff));};}()),ISHRADMIN=![];function ValidateHrAdmin(){var _0x4d98e0=a44_0x2c48b1,_0x28c386=_0x4d98e0(0x1ed),_0x55e919=_spPageContextInfo[_0x4d98e0(0x1e0)]+_0x4d98e0(0x19e)+_0x28c386+_0x4d98e0(0x18d)+titanForWork[_0x4d98e0(0x20b)](_0x4d98e0(0x16e))+_0x4d98e0(0x1cb)+_spPageContextInfo[_0x4d98e0(0x192)]+_0x4d98e0(0x1ac);$['ajax']({'url':_0x55e919,'async':![],'type':_0x4d98e0(0x219),'headers':{'Accept':_0x4d98e0(0x177)},'success':function(_0xa1af6a){var _0x10c62f=_0x4d98e0,_0x633d2c=_0xa1af6a['d'][_0x10c62f(0x14e)];_0x633d2c['length']>0x0?($(_0x10c62f(0x212))['css']('display',_0x10c62f(0x205)),ISHRADMIN=!![]):(ISHRADMIN=![],$(_0x10c62f(0x212))['hide']());},'error':function(_0x56ef46){var _0x4d40ad=_0x4d98e0;console['log'](_0x56ef46[_0x4d40ad(0x20a)][_0x4d40ad(0x155)]);}});}function GetAttendanceorLeaves(){var _0x261a46=a44_0x2c48b1,_0x5ee6f1=$[_0x261a46(0x216)](_0x261a46(0x1d5)),_0x19d7b3=$('#EmpreportFrom')[_0x261a46(0x185)](_0x261a46(0x172)),_0x1ab3da=$('#EmpreportTo')[_0x261a46(0x185)](_0x261a46(0x172));days=(_0x1ab3da-_0x19d7b3)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math[_0x261a46(0x199)](days)+0x1,$(_0x261a46(0x1a8))['text'](formatDateReportEmp($(_0x261a46(0x14a))[_0x261a46(0x154)]())),$(_0x261a46(0x15b))[_0x261a46(0x1e8)](formatDateReportEmp($(_0x261a46(0x1be))['val']()));var _0xdba05d=moment($(_0x261a46(0x14a))[_0x261a46(0x154)](),'LL')[_0x261a46(0x20f)](_0x261a46(0x176)),_0x47380a=moment($('#EmpreportTo')[_0x261a46(0x154)](),'LL')[_0x261a46(0x20f)](_0x261a46(0x176)),_0x4c2215=new Date(_0x47380a),_0x9aab2e=_0x4c2215[_0x261a46(0x210)](),_0x31996f=_0x9aab2e['split']('T');GstartDate=_0xdba05d;var _0x3458e9=ensureUser($(_0x261a46(0x190))[_0x261a46(0x17d)]()[_0x261a46(0x17d)]()[_0x261a46(0x1e5)]('id'));if(_0x3458e9==0x0){var _0x160114=_spPageContextInfo[_0x261a46(0x1e0)]+_0x261a46(0x14c)+_0x5ee6f1+'\x27\x20and\x20Company/ID\x20\x20eq\x20\x27'+CompanyID+'\x27';EmployeeListDat(_0x160114),LoadAllHolidays(),_0x5ee6f1=_0x5ee6f1,GEmpID=_0x5ee6f1;var _0x55cd22=_spPageContextInfo[_0x261a46(0x1e0)]+_0x261a46(0x189)+_0xdba05d+_0x261a46(0x188)+_0x31996f+_0x261a46(0x1a0)+_0x5ee6f1+'\x27\x20';UpdateHeaderfields(_0x55cd22);}else{if(ISHRADMIN==!![]){_0x5ee6f1=_0x3458e9,GEmpID=_0x3458e9;var _0x160114=_spPageContextInfo[_0x261a46(0x1e0)]+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27'+_0x5ee6f1+_0x261a46(0x1d6)+CompanyID+'\x27';EmployeeListDat(_0x160114),LoadAllHolidays();var _0x55cd22=_spPageContextInfo['webAbsoluteUrl']+'/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27'+_0xdba05d+_0x261a46(0x188)+_0x31996f+_0x261a46(0x1a0)+_0x5ee6f1+'\x27\x20';UpdateHeaderfields(_0x55cd22);var _0x160114=_spPageContextInfo[_0x261a46(0x1e0)]+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27'+_0x5ee6f1+_0x261a46(0x1d6)+CompanyID+'\x27';}else alert(_0x261a46(0x181));}LoadAllHolidays();}function GetFilterData(_0x5ad974){var _0x37d824=a44_0x2c48b1;jQuery['ajax']({'url':_0x5ad974,'headers':{'Accept':_0x37d824(0x177)},'async':![],'success':function(_0x1e5364){var _0x5eb72b=_0x37d824,_0x1f005f=_0x1e5364['d'][_0x5eb72b(0x14e)],_0x2c938f=[];TotalLeavesorAbsent=[];for(var _0x4ea08f=0x0;_0x4ea08f<_0x1f005f[_0x5eb72b(0x1d0)];_0x4ea08f++){if(_0x1f005f[_0x4ea08f][_0x5eb72b(0x1b9)]!=_0x5eb72b(0x198)&&_0x1f005f[_0x4ea08f][_0x5eb72b(0x1b9)]!='Holiday')_0x2c938f[_0x5eb72b(0x156)](_0x1f005f[_0x4ea08f]['AttendanceType']);else _0x1f005f[_0x4ea08f]['AttendanceType']=='On-Leave'&&TotalLeavesorAbsent[_0x5eb72b(0x156)](_0x1f005f[_0x4ea08f][_0x5eb72b(0x1b9)]);}var _0x27003c=$['grep'](_0x1f005f,function(_0x39971c){var _0x1d6c27=_0x5eb72b;return _0x39971c[_0x1d6c27(0x1b9)]!=_0x1d6c27(0x198)&&_0x39971c['AttendanceType']!=_0x1d6c27(0x1ce);});$(_0x5eb72b(0x1fe))[_0x5eb72b(0x1e8)](_0x27003c[_0x5eb72b(0x1d0)]);},'error':function(_0x1c6925,_0x191326){var _0x54f692=_0x37d824;console[_0x54f692(0x20d)](JSON[_0x54f692(0x1c5)](_0x1c6925));}});}var G_Validateholiday=![];function GetHolidays(_0x424395){var _0x5021c4=a44_0x2c48b1,_0x29dbff=_spPageContextInfo['webAbsoluteUrl']+_0x5021c4(0x1b5)+LocID+_0x5021c4(0x1a9)+_0x424395+'\x27\x20and\x20CompanyID\x20eq\x20\x27'+titanForWork[_0x5021c4(0x20b)](_0x5021c4(0x16e))+'\x27&$top=200&$orderby=Holiday_start\x20asc';$[_0x5021c4(0x19b)]({'url':_0x29dbff,'headers':{'Accept':_0x5021c4(0x177)},'async':![],'success':function(_0x31d50a){var _0x3ff031=_0x5021c4,_0x593b33=_0x31d50a['d'][_0x3ff031(0x14e)];_0x593b33[_0x3ff031(0x1d0)]>0x0?($('#HolidayMessagediv')['text'](_0x593b33[0x0][_0x3ff031(0x1ab)]),$(_0x3ff031(0x1de))[_0x3ff031(0x170)]('display',_0x3ff031(0x205)),G_Validateholiday=!![]):($(_0x3ff031(0x17c))[_0x3ff031(0x1e8)](''),$('#HolidayMessage')[_0x3ff031(0x170)]('display','none'),G_Validateholiday=![]);},'error':function(_0x5efefa){var _0x4c7312=_0x5021c4;alert(_0x4c7312(0x194));}});}var EmpAttendanceData=[],TotalLeavesorAbsent=[];function UpdateHeaderfields(_0x470a25){var _0x22f0e2=a44_0x2c48b1;jQuery['ajax']({'url':_0x470a25,'headers':{'Accept':_0x22f0e2(0x177)},'async':!![],'success':function(_0x3e1dd3){var _0x517654=_0x22f0e2;EmpAttendanceData=[];var _0x48f688=_0x3e1dd3['d'][_0x517654(0x14e)],_0x1fda84=[];TotalLeavesorAbsent=[];for(var _0xb6426a=0x0;_0xb6426a<_0x48f688[_0x517654(0x1d0)];_0xb6426a++){if(_0x48f688[_0xb6426a]['AttendanceType']!=_0x517654(0x198)&&_0x48f688[_0xb6426a][_0x517654(0x1b9)]!='Holiday')_0x1fda84[_0x517654(0x156)](_0x48f688[_0xb6426a][_0x517654(0x1b9)]);else{if(_0x48f688[_0xb6426a][_0x517654(0x1b9)]==_0x517654(0x198))TotalLeavesorAbsent[_0x517654(0x156)](_0x48f688[_0xb6426a][_0x517654(0x1b9)]);else _0x48f688[_0xb6426a][_0x517654(0x1b9)]==_0x517654(0x1ce)&&TotalLeavesorAbsent['push'](_0x48f688[_0xb6426a][_0x517654(0x1b9)]);}var _0x41e0be=_0x48f688[_0xb6426a]['ID'],_0x575a6d=_0x48f688[_0xb6426a][_0x517654(0x202)][_0x517654(0x1ab)],_0x5a312a=_0x48f688[_0xb6426a]['Employee']['ID'],_0x1c3c3a=formatDateReportEmp(_0x48f688[_0xb6426a][_0x517654(0x1b8)]),_0x2f0259=_0x48f688[_0xb6426a][_0x517654(0x1b9)],_0x242c23=_0x48f688[_0xb6426a][_0x517654(0x1b2)],_0x371d45=_0x48f688[_0xb6426a]['HrAction'];EmpAttendanceData[_0x517654(0x156)]({'UserId':_0x5a312a,'EmpName':_0x575a6d,'AttendanceDate':_0x1c3c3a,'AttendanceType':_0x2f0259,'AttendanceItemId':_0x41e0be,'EmpWorkHours':_0x242c23,'HrAction':_0x371d45});}var _0x44bf58='',_0x55bb8d=0x0,_0x40d4fb=0x0;for(var _0xf2f0a2=0x0;_0xf2f0a2<Totaldays;_0xf2f0a2++){var _0x1f6bf9=new Date(GstartDate);_0x1f6bf9['setDate'](_0x1f6bf9[_0x517654(0x172)]()+_0xf2f0a2);var _0x500e39=moment(_0x1f6bf9,_0x517654(0x195))[_0x517654(0x20f)](_0x517654(0x176)),_0x500e39=_0x500e39[_0x517654(0x209)]('-')[_0x517654(0x1f8)](''),_0x2995a8=formatDateReportEmp(_0x1f6bf9),_0x1e0959=EmpAttendanceData[_0x517654(0x16f)](function(_0x530e24){var _0x19f9b0=_0x517654;return _0x530e24[_0x19f9b0(0x1b8)];})[_0x517654(0x14f)](_0x2995a8);if(_0x1e0959!=-0x1){var _0x27ff00=EmpAttendanceData[_0x1e0959][_0x517654(0x1b9)],_0x2f7b6c=EmpAttendanceData[_0x1e0959][_0x517654(0x1dd)],_0x371d45=EmpAttendanceData[_0x1e0959][_0x517654(0x213)],_0x267863=EmpAttendanceData[_0x1e0959]['UserId'],_0xbbfc1d=EmpAttendanceData[_0x1e0959]['AttendanceItemId'];_0x40d4fb=_0x40d4fb+0x1;}else _0x55bb8d=_0x55bb8d+0x1;}var _0x21c4bf=parseInt(TotalLeavesorAbsent['length'])+parseInt(_0x55bb8d)-parseInt($(_0x517654(0x1d3))[_0x517654(0x1e8)]());_0x21c4bf<0x0&&(_0x21c4bf=0x0);$('#EmpTotalItemscount')[_0x517654(0x1e8)](Totaldays);var _0xf90d88=parseInt(_0x40d4fb)-parseInt(TotalLeavesorAbsent[_0x517654(0x1d0)]),_0x5c0cd0=$[_0x517654(0x171)](_0x48f688,function(_0x5c3456){var _0x57392b=_0x517654;return _0x5c3456[_0x57392b(0x1b9)]!='On-Leave'&&_0x5c3456['AttendanceType']!=_0x57392b(0x1ce);});$('#Total-Attendance')[_0x517654(0x1e8)](_0x5c0cd0[_0x517654(0x1d0)]);},'error':function(_0x54be13,_0x44bff3){var _0x5bb7d2=_0x22f0e2;console[_0x5bb7d2(0x20d)](JSON[_0x5bb7d2(0x1c5)](_0x54be13));}});}