var _0x4116c9=_0x40fa;(function(_0x21a686,_0x2fd577){var _0x244619=_0x40fa,_0x14c9f8=_0x21a686();while(!![]){try{var _0x1ddf4b=-parseInt(_0x244619(0x173))/0x1*(parseInt(_0x244619(0xf9))/0x2)+parseInt(_0x244619(0x1b9))/0x3+parseInt(_0x244619(0x17b))/0x4+parseInt(_0x244619(0x127))/0x5+parseInt(_0x244619(0x178))/0x6*(parseInt(_0x244619(0x1a7))/0x7)+parseInt(_0x244619(0x15c))/0x8+-parseInt(_0x244619(0x122))/0x9*(parseInt(_0x244619(0x150))/0xa);if(_0x1ddf4b===_0x2fd577)break;else _0x14c9f8['push'](_0x14c9f8['shift']());}catch(_0x2eefc5){_0x14c9f8['push'](_0x14c9f8['shift']());}}}(_0x28aa,0xea6e4));var Totaldays=0x0,CompanyID='',GstartDate='',GEmpID=0x0;$(document)[_0x4116c9(0x195)](function(){var _0x3690d7=_0x4116c9;ValidateHrAdmin(),CompanyID=titanForWork['getQueryStringParameter']('CompanyId');var _0x38ef86=$['urlParam'](_0x3690d7(0x16c)),_0x4ec480=$[_0x3690d7(0x16b)]('start'),_0x84a0ad=$[_0x3690d7(0x16b)](_0x3690d7(0x19a));if(_0x38ef86!=null){GEmpID=_0x38ef86;var _0x348fbc=_0x4ec480['slice'](0x0,0x4)+'-'+_0x4ec480['slice'](0x4,0x6)+'-'+_0x4ec480['slice'](0x6,0x8),_0x21fbd8=_0x84a0ad[_0x3690d7(0x138)](0x0,0x4)+'-'+_0x84a0ad['slice'](0x4,0x6)+'-'+_0x84a0ad[_0x3690d7(0x138)](0x6,0x8),_0x54a3ee=new Date(_0x21fbd8),_0x28fda2=_0x54a3ee[_0x3690d7(0x1d0)](),_0x18f35c=_0x28fda2[_0x3690d7(0x1ae)]('T');GstartDate=_0x348fbc,$(_0x3690d7(0x190))[_0x3690d7(0x1aa)]({'dateFormat':_0x3690d7(0x16f)})[_0x3690d7(0x1aa)](_0x3690d7(0x13e),new Date(_0x348fbc)),$(_0x3690d7(0x133))[_0x3690d7(0x1aa)]({'dateFormat':_0x3690d7(0x16f)})['datepicker'](_0x3690d7(0x13e),new Date(_0x21fbd8));var _0x23cc26=$(_0x3690d7(0x190))[_0x3690d7(0x1aa)]('getDate'),_0x1ec4c8=$(_0x3690d7(0x133))[_0x3690d7(0x1aa)]('getDate');days=(_0x1ec4c8-_0x23cc26)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math[_0x3690d7(0x119)](days)+0x1,$(_0x3690d7(0x17e))[_0x3690d7(0x13a)](formatDateReportEmp($(_0x3690d7(0x190))[_0x3690d7(0x12e)]())),$('#EndDate')[_0x3690d7(0x13a)](formatDateReportEmp($(_0x3690d7(0x133))[_0x3690d7(0x12e)]()));var _0x5eee8e=_spPageContextInfo['webAbsoluteUrl']+_0x3690d7(0xf7)+_0x38ef86+_0x3690d7(0x116)+CompanyID+'\x27';EmployeeListDat(_0x5eee8e),LoadAllHolidays();var _0x40ae76=_spPageContextInfo[_0x3690d7(0x14a)]+_0x3690d7(0x113)+_0x348fbc+_0x3690d7(0x17a)+_0x18f35c[0x0]+'\x27\x20and\x20Employee\x20eq\x20\x27'+_0x38ef86+'\x27\x20';getFileData(_0x40ae76);var _0x5eee8e=_spPageContextInfo[_0x3690d7(0x14a)]+_0x3690d7(0xf7)+_0x38ef86+'\x27\x20and\x20Company/ID\x20\x20eq\x20\x27'+CompanyID+'\x27';EmployeeListDat(_0x5eee8e),LoadAllHolidays(),initializePeoplePicker(_0x3690d7(0x12c));}});var EmployeeID='',ItemID='',SelectedDate='',TDID='';function attendanceEditModal(_0x349ec8,_0x3f545e,_0x2074ec){var _0x1581e3=_0x4116c9;EmployeeID=0x0,ItemID=0x0,SelectedDate='',TDID=_0x2074ec,EmployeeID=_0x349ec8,ItemID=_0x3f545e;var _0x5178d7=_0x2074ec[_0x1581e3(0x1ab)](),_0x4281e6=_0x5178d7[_0x1581e3(0x138)](0x0,0x4)+'-'+_0x5178d7[_0x1581e3(0x138)](0x4,0x6)+'-'+_0x5178d7[_0x1581e3(0x138)](0x6,0x8),_0x310c2a=new Date(_0x4281e6);SelectedDate=_0x310c2a[_0x1581e3(0x1d0)]()[_0x1581e3(0x1ae)]('T')[0x0];var _0x4eb67a=formatDateReportEmp(_0x310c2a);$('#SelDate')[_0x1581e3(0x13a)](_0x4eb67a),GetHolidays(_0x4281e6);}function UpdateAttendance(){var _0x461462=_0x4116c9;ItemID==0x0?(G_Validateholiday==!![]?confirm(_0x461462(0x17f))&&PushNewAttendance():PushNewAttendance(),Applyfilter(),LoadAllHolidays()):(G_Validateholiday==!![]?confirm(_0x461462(0x17f))&&ModifyAttendance():ModifyAttendance(),Applyfilter(),LoadAllHolidays());}function PushNewAttendance(){var _0x534642=_0x4116c9;$(_0x534642(0x141))[_0x534642(0x12e)]()!=_0x534642(0x134)||G_Validateholiday==!![]?$['ajax']({'url':_spPageContextInfo[_0x534642(0x14a)]+_0x534642(0x13b),'type':_0x534642(0x10d),'async':![],'data':JSON[_0x534642(0x103)]({'__metadata':{'type':_0x534642(0x193)},'AttendanceDate':SelectedDate,'EmployeeId':EmployeeID,'AttendanceType':$(_0x534642(0x141))[_0x534642(0x12e)]()}),'headers':{'Accept':'application/json;odata=verbose','Content-Type':'application/json;odata=verbose','X-RequestDigest':$(_0x534642(0xff))[_0x534642(0x12e)](),'X-HTTP-Method':_0x534642(0x10d)},'success':function(_0xd6f2d5,_0x25cb8c,_0x180f77){var _0x17abcc=_0x534642;$(_0x17abcc(0x1c1)+TDID)['text']($(_0x17abcc(0x141))['val']()),alert(_0x17abcc(0x1a6)),$(_0x17abcc(0x1a4))[_0x17abcc(0x1cb)](_0x17abcc(0x10b)),GetAttendanceorLeaves();},'error':function(_0x24868a,_0x2c650c,_0x527210){var _0x28ee2e=_0x534642;alert(_0x28ee2e(0x158));}}):alert(_0x534642(0x18c));}function ModifyAttendance(){var _0x1ba8ee=_0x4116c9;$(_0x1ba8ee(0x141))['val']()!=_0x1ba8ee(0x134)||G_Validateholiday==!![]?$[_0x1ba8ee(0x177)]({'url':_spPageContextInfo[_0x1ba8ee(0x14a)]+_0x1ba8ee(0x191)+ItemID+')','type':_0x1ba8ee(0x10d),'async':![],'data':JSON[_0x1ba8ee(0x103)]({'__metadata':{'type':'SP.Data.EmpAttendanceListItem'},'AttendanceType':$(_0x1ba8ee(0x141))[_0x1ba8ee(0x12e)]()}),'headers':{'Accept':'application/json;odata=verbose','Content-Type':_0x1ba8ee(0x126),'X-RequestDigest':$(_0x1ba8ee(0xff))['val'](),'IF-MATCH':'*','X-HTTP-Method':_0x1ba8ee(0x105)},'success':function(_0x486a10,_0x124f15,_0x1f0ed7){var _0x2612c5=_0x1ba8ee;$('#Att'+TDID)[_0x2612c5(0x13a)]($(_0x2612c5(0x141))[_0x2612c5(0x12e)]()),$('#Timeview'+TDID)[_0x2612c5(0x13a)](_0x2612c5(0x1b3)),alert(_0x2612c5(0x1a6)),$('#attendance-reportEdit')['modal'](_0x2612c5(0x10b)),GetAttendanceorLeaves();},'error':function(_0x49ac63,_0x3d1374,_0x50ffe3){alert('Error!\x20Something\x20went\x20wrong.');}}):alert('Plese\x20select\x20proper\x20attandence.');}function initializePeoplePicker(_0x4926e9){var _0x3f8187=_0x4116c9,_0x3542a6={};_0x3542a6['PrincipalAccountType']=_0x3f8187(0x131),_0x3542a6[_0x3f8187(0x154)]=0xf,_0x3542a6[_0x3f8187(0x1ca)]=0xf,_0x3542a6[_0x3f8187(0x166)]=![],_0x3542a6[_0x3f8187(0x15d)]=0x32,_0x3542a6[_0x3f8187(0x146)]=_0x3f8187(0x187),this[_0x3f8187(0x1a1)](_0x4926e9,null,_0x3542a6);}function Applyfilter(){var _0x4a711a=_0x4116c9,_0x1f7075=moment($(_0x4a711a(0x190))[_0x4a711a(0x12e)](),'LL')[_0x4a711a(0x169)](_0x4a711a(0x1b7)),_0x2439b9=moment($('#EmpreportTo')[_0x4a711a(0x12e)](),'LL')[_0x4a711a(0x169)](_0x4a711a(0x1b7));if(Date['parse'](_0x1f7075)>Date[_0x4a711a(0x170)](_0x2439b9))alert('Invalid\x20date\x20range.\x0aFrom\x20Date\x20should\x20not\x20be\x20bigger\x20than\x20To\x20Date');else{$('#attendance-report-filter')[_0x4a711a(0x1cb)]('hide');var _0x4cb40e=$['urlParam']('EID'),_0x11c984=$(_0x4a711a(0x190))['datepicker'](_0x4a711a(0x11a)),_0xe4e6c2=$(_0x4a711a(0x133))[_0x4a711a(0x1aa)](_0x4a711a(0x11a));days=(_0xe4e6c2-_0x11c984)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math[_0x4a711a(0x119)](days)+0x1,$(_0x4a711a(0x17e))['text'](formatDateReportEmp($(_0x4a711a(0x190))[_0x4a711a(0x12e)]())),$(_0x4a711a(0x1a3))[_0x4a711a(0x13a)](formatDateReportEmp($(_0x4a711a(0x133))[_0x4a711a(0x12e)]()));var _0x1f7075=moment($('#EmpreportFrom')[_0x4a711a(0x12e)](),'LL')[_0x4a711a(0x169)](_0x4a711a(0x194)),_0x2439b9=moment($(_0x4a711a(0x133))[_0x4a711a(0x12e)](),'LL')['format'](_0x4a711a(0x194)),_0x213977=new Date(_0x2439b9),_0x5058c7=_0x213977[_0x4a711a(0x1d0)](),_0x271175=_0x5058c7['split']('T');GstartDate=_0x1f7075;var _0x400736=ensureUser($(_0x4a711a(0x174))['children']()[_0x4a711a(0x118)]()[_0x4a711a(0x115)]('id'));if(_0x400736==0x0){_0x4cb40e=_0x4cb40e,GEmpID=_0x4cb40e;var _0xc99acc=_spPageContextInfo['webAbsoluteUrl']+'/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27'+_0x1f7075+_0x4a711a(0x17a)+_0x271175[0x0]+_0x4a711a(0x1b2)+_0x4cb40e+'\x27\x20';getFileData(_0xc99acc);var _0x3ae47e=_spPageContextInfo['webAbsoluteUrl']+_0x4a711a(0xf7)+_0x4cb40e+_0x4a711a(0x116)+CompanyID+'\x27';EmployeeListDat(_0x3ae47e);}else{if(ISHRADMIN==!![]){_0x4cb40e=_0x400736,GEmpID=_0x400736;var _0xc99acc=_spPageContextInfo[_0x4a711a(0x14a)]+'/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27'+_0x1f7075+_0x4a711a(0x17a)+_0x271175[0x0]+'\x27\x20and\x20Employee\x20eq\x20\x27'+_0x4cb40e+'\x27\x20';getFileData(_0xc99acc);var _0x3ae47e=_spPageContextInfo['webAbsoluteUrl']+_0x4a711a(0xf7)+_0x4cb40e+_0x4a711a(0x116)+CompanyID+'\x27';EmployeeListDat(_0x3ae47e);}else alert(_0x4a711a(0x14b));}LoadAllHolidays();}}var DataIdList=[],EmpAttendanceData=[],TotalLeavesorAbsent=[];function _0x40fa(_0x28d0f7,_0x4f1cf8){var _0x28aab2=_0x28aa();return _0x40fa=function(_0x40fa07,_0x395e23){_0x40fa07=_0x40fa07-0xf7;var _0x377428=_0x28aab2[_0x40fa07];return _0x377428;},_0x40fa(_0x28d0f7,_0x4f1cf8);}function getFileData(_0x40c865){var _0xeff461=_0x4116c9;jQuery[_0xeff461(0x177)]({'url':_0x40c865,'headers':{'Accept':_0xeff461(0x126)},'async':![],'success':function(_0x1d9f1f){var _0x3baf2a=_0xeff461;EmpAttendanceData=[];var _0x2ebde4=_0x1d9f1f['d'][_0x3baf2a(0x188)];DataIdList=[];var _0x39d44b=[];TotalLeavesorAbsent=[];for(var _0x2c5584=0x0;_0x2c5584<_0x2ebde4[_0x3baf2a(0x19d)];_0x2c5584++){if(_0x2ebde4[_0x2c5584][_0x3baf2a(0x139)]!=_0x3baf2a(0x147)&&_0x2ebde4[_0x2c5584][_0x3baf2a(0x139)]!=_0x3baf2a(0x134))_0x39d44b['push'](_0x2ebde4[_0x2c5584][_0x3baf2a(0x139)]);else{if(_0x2ebde4[_0x2c5584][_0x3baf2a(0x139)]=='On-Leave')TotalLeavesorAbsent['push'](_0x2ebde4[_0x2c5584][_0x3baf2a(0x139)]);else _0x2ebde4[_0x2c5584][_0x3baf2a(0x139)]==_0x3baf2a(0x134)&&TotalLeavesorAbsent[_0x3baf2a(0x1c8)](_0x2ebde4[_0x2c5584]['AttendanceType']);}var _0x4e2af0=_0x2ebde4[_0x2c5584]['ID'],_0x28ab03=_0x2ebde4[_0x2c5584][_0x3baf2a(0x19f)][_0x3baf2a(0x156)],_0x5cf023=_0x2ebde4[_0x2c5584][_0x3baf2a(0x19f)]['ID'],_0x19ffae=formatDateReportEmp(_0x2ebde4[_0x2c5584][_0x3baf2a(0x117)]),_0x3c7394=_0x2ebde4[_0x2c5584]['AttendanceType'],_0x3e077e=_0x2ebde4[_0x2c5584][_0x3baf2a(0x1c0)],_0x570801=_0x2ebde4[_0x2c5584]['HrAction'];EmpAttendanceData['push']({'UserId':_0x5cf023,'EmpName':_0x28ab03,'AttendanceDate':_0x19ffae,'AttendanceType':_0x3c7394,'AttendanceItemId':_0x4e2af0,'EmpWorkHours':_0x3e077e,'HrAction':_0x570801});}var _0x103a02='';$(_0x3baf2a(0x1bb))[_0x3baf2a(0x1c9)]();var _0x1e7f83=0x0,_0x369eee=0x0;for(var _0x333710=0x0;_0x333710<Totaldays;_0x333710++){var _0x57137b=new Date(GstartDate);_0x57137b['setDate'](_0x57137b[_0x3baf2a(0x11a)]()+_0x333710);var _0x187f4c=moment(_0x57137b,_0x3baf2a(0x137))[_0x3baf2a(0x169)](_0x3baf2a(0x194)),_0x187f4c=_0x187f4c[_0x3baf2a(0x1ae)]('-')[_0x3baf2a(0x152)]('');DataIdList[_0x3baf2a(0x1c8)](_0x187f4c);var _0x25ca46=formatDateReportEmp(_0x57137b),_0x1e33b6=EmpAttendanceData[_0x3baf2a(0xfb)](function(_0x3e63e9){var _0x53b5e6=_0x3baf2a;return _0x3e63e9[_0x53b5e6(0x117)];})[_0x3baf2a(0xfa)](_0x25ca46);if(_0x1e33b6!=-0x1){var _0x2e12d7=EmpAttendanceData[_0x1e33b6][_0x3baf2a(0x139)],_0x3c0ab6=EmpAttendanceData[_0x1e33b6][_0x3baf2a(0x1b5)],_0x570801=EmpAttendanceData[_0x1e33b6]['HrAction'],_0xabc560=EmpAttendanceData[_0x1e33b6][_0x3baf2a(0x124)],_0x2b5007=EmpAttendanceData[_0x1e33b6][_0x3baf2a(0x198)],_0x3abde8=EmpAttendanceData[_0x1e33b6][_0x3baf2a(0x117)],_0x9d6077=_0x3baf2a(0x109),_0x149580=_0x3baf2a(0x110);_0x570801==!![]&&(_0x9d6077='block',_0x149580=_0x3baf2a(0x109));if(_0x2e12d7!='On-Leave'&&_0x2e12d7!=_0x3baf2a(0x134)){if(_0x3c0ab6==null)var _0x289a9a='<a\x20class=\x27LinkBtn\x27\x20href=\x27'+_spPageContextInfo[_0x3baf2a(0x14a)]+_0x3baf2a(0x120)+_0x187f4c+_0x3baf2a(0x106)+window['btoa']('View')+'&sourcelocation=../Pages/Myworkplace.aspx\x27\x20><span\x20id=\x27Timeview'+_0x187f4c+_0x3baf2a(0x19c);else var _0x289a9a='<a\x20href=\x27'+_spPageContextInfo[_0x3baf2a(0x14a)]+'/Pages/TimeSheetEntry.aspx?WebAppId=2&Recall='+_0x187f4c+_0x3baf2a(0x106)+window[_0x3baf2a(0x11f)](_0x3baf2a(0x111))+'&sourcelocation=../Pages/Myworkplace.aspx\x27>'+ConvertHHMM(_0x3c0ab6)+_0x3baf2a(0x157);}else var _0x289a9a='';var _0x2f8dfe=![],_0x334872=Date['parse'](_0x3abde8[_0x3baf2a(0x1ae)](',')[0x0]),_0x11be7e=new Date(),_0x527a34=Date['parse'](moment(_0x11be7e)['format'](_0x3baf2a(0x1b7)));_0x334872>_0x527a34&&(_0x2f8dfe=!![]),_0x369eee=_0x369eee+0x1,_0x2f8dfe!=!![]?(_0x103a02+=_0x3baf2a(0x16d),_0x103a02+=_0x3baf2a(0x1cd)+_0x187f4c+_0x3baf2a(0x135)+formatDateReportEmp(_0x57137b)+'</span><span\x20id=\x27H'+_0x187f4c+_0x3baf2a(0xf8),_0x103a02+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Att'+_0x187f4c+'>'+_0x2e12d7+'</div></td>',_0x103a02+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Time'+_0x187f4c+'>'+_0x289a9a+_0x3baf2a(0x14d),_0x103a02+=_0x3baf2a(0x1b4)+_0x9d6077+_0x3baf2a(0x1b8),_0x103a02+='<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27\x20style=\x27display:\x20'+_0x149580+_0x3baf2a(0x176)+GEmpID+','+_0x2b5007+','+_0x187f4c+_0x3baf2a(0x1cc),_0x103a02+='</tr>'):(_0x103a02+='<tr\x20class=\x27text-center\x27\x20>',_0x103a02+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id='+_0x187f4c+_0x3baf2a(0x135)+formatDateReportEmp(_0x57137b)+_0x3baf2a(0x1a5)+_0x187f4c+_0x3baf2a(0xf8),_0x103a02+=_0x3baf2a(0x196)+_0x187f4c+'>'+_0x2e12d7+_0x3baf2a(0x181)+_0x2b5007+','+_0x187f4c+')\x27>Withdraw</a></div></td>',_0x103a02+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Time'+_0x187f4c+'>'+_0x289a9a+'</div></td>',_0x103a02+=_0x3baf2a(0x1b4)+_0x9d6077+'\x20\x27><label><i\x20class=\x27fa\x20fa-check\x27\x20aria-hidden=\x27true\x27\x20style=\x27color:\x20red;\x27></i></label></div></td>',_0x103a02+=_0x3baf2a(0x17d)+_0x149580+_0x3baf2a(0x104),_0x103a02+='</tr>');}else{var _0x38b199=formatDateReportEmp(_0x57137b),_0x2f8dfe=![],_0x334872=Date[_0x3baf2a(0x170)](_0x38b199[_0x3baf2a(0x1ae)](',')[0x0]),_0x11be7e=new Date(),_0x527a34=Date[_0x3baf2a(0x170)](moment(_0x11be7e)[_0x3baf2a(0x169)](_0x3baf2a(0x1b7)));_0x334872>_0x527a34&&(_0x2f8dfe=!![]);_0x1e7f83=_0x1e7f83+0x1;if(_0x2f8dfe!=!![]){var _0x6df3e0=_0x3baf2a(0x10e)+_spPageContextInfo[_0x3baf2a(0x14a)]+'/Pages/TimeSheetEntry.aspx?WebAppId=2&Recall='+_0x187f4c+_0x3baf2a(0x106)+window[_0x3baf2a(0x11f)](_0x3baf2a(0x111))+_0x3baf2a(0x1ac)+_0x187f4c+_0x3baf2a(0x19c);_0x103a02+='<tr\x20class=\x27text-center\x27\x20>',_0x103a02+=_0x3baf2a(0x1cd)+_0x187f4c+'><span>'+formatDateReportEmp(_0x57137b)+_0x3baf2a(0x1a5)+_0x187f4c+_0x3baf2a(0xf8),_0x103a02+=_0x3baf2a(0x196)+_0x187f4c+_0x3baf2a(0x112),_0x103a02+=_0x3baf2a(0x12f)+_0x187f4c+_0x3baf2a(0x112),_0x103a02+=_0x3baf2a(0x164),_0x103a02+=_0x3baf2a(0x145)+GEmpID+_0x3baf2a(0x1a0)+_0x187f4c+_0x3baf2a(0x1cc),_0x103a02+=_0x3baf2a(0x1bc);}else{var _0x6df3e0=_0x3baf2a(0x10e)+_spPageContextInfo['webAbsoluteUrl']+_0x3baf2a(0x120)+_0x187f4c+'&Mode='+window[_0x3baf2a(0x11f)]('View')+_0x3baf2a(0x1ac)+_0x187f4c+'\x27>Fill</span></a>';_0x103a02+='<tr\x20class=\x27text-center\x27\x20>',_0x103a02+=_0x3baf2a(0x1cd)+_0x187f4c+_0x3baf2a(0x135)+formatDateReportEmp(_0x57137b)+_0x3baf2a(0x1a5)+_0x187f4c+_0x3baf2a(0xf8),_0x103a02+=_0x3baf2a(0x196)+_0x187f4c+'></div></td>',_0x103a02+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Time'+_0x187f4c+_0x3baf2a(0x112),_0x103a02+=_0x3baf2a(0x164),_0x103a02+=_0x3baf2a(0x184),_0x103a02+=_0x3baf2a(0x1bc);}}}var _0x1ccc37=$['grep'](_0x2ebde4,function(_0x4b19d3){var _0x3a4155=_0x3baf2a;return _0x4b19d3[_0x3a4155(0x139)]!=_0x3a4155(0x147)&&_0x4b19d3[_0x3a4155(0x139)]!=_0x3a4155(0x134);}),_0x256922=parseInt(TotalLeavesorAbsent['length'])+parseInt(_0x1e7f83)-parseInt($(_0x3baf2a(0x163))[_0x3baf2a(0x13a)]());_0x256922<0x0&&(_0x256922=0x0);$(_0x3baf2a(0x15b))[_0x3baf2a(0x10b)](),$('#EmpTotalItemscount')[_0x3baf2a(0x13a)](Totaldays);var _0x456f3f=parseInt(_0x369eee)-parseInt(TotalLeavesorAbsent['length']);$('#Total-Attendance')[_0x3baf2a(0x13a)](_0x1ccc37[_0x3baf2a(0x19d)]),$(_0x3baf2a(0x1bb))[_0x3baf2a(0x162)](_0x103a02),EmpTableConfiguration();},'error':function(_0x2620e0,_0x5dd6e0){var _0x3e262c=_0xeff461;console[_0x3e262c(0x1af)](JSON['stringify'](_0x2620e0));}});}function _0x28aa(){var _0xeb9e5e=['/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?$filter=OfficeLocationID\x20eq\x20(\x27','AttendanceItemId','#HolidayMessage','end','getQueryStringParameter','\x27>Fill</span></a>','length','Emppagedropdown','Employee',',0,','SPClientPeoplePicker_InitStandaloneControlWrapper','#Total-Attendance','#EndDate','#attendance-reportEdit','</span><span\x20id=\x27H','Data\x20has\x20been\x20saved.','279559BzZoEM','#TotalWorkdayTH','Sept','datepicker','toString','&sourcelocation=../Pages/Myworkplace.aspx\x27\x20><span\x20id=\x27Timeview','OfficeLocation','split','log','asc','CompanyId','\x27\x20and\x20Employee\x20eq\x20\x27','00:00','<td><div\x20class=\x27checkbox\x20m-0\x27\x20style=\x27display:\x20','EmpWorkHours','nodeType','DD\x20MMM\x20YYYY','\x20\x27><label><i\x20class=\x27fa\x20fa-check\x27\x20aria-hidden=\x27true\x27\x20style=\x27color:\x20red;\x27></i></label></div></td>','1107477dCBmwL','SPClientPeoplePickerDict','#EmpReportTable','</tr>','color','#ResultDiv','css','WorkHours','#Att','#EmpTotalItemscount','innerHTML','replace','#EmpName','userId','Emptotalpages','push','empty','ResolvePrincipalSource','modal',')\x27><i\x20class=\x27fa\x20fa-pencil\x27></i></a></div></td>','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=','href','Feb','toISOString','/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27','\x27\x20class=\x27employee-report-holiday\x27></span></div></td>','2lmKrlM','indexOf','map','oddselected','On-LeaveWithdraw','\x27\x20and\x20ContributorsId\x20eq\x20\x27','#__REQUESTDIGEST','Jul','Withdraw','Aug','stringify','\x20\x27></div></td>','MERGE','&Mode=','responseJSON','Key','none','Hdate','hide','Saturday','POST','<a\x20class=\x27LinkBtn\x27\x20href=\x27','\x27)/items?$select=*,Department/DepartmentName,Department/ID&$expand=Department&$filter=CompanyId\x20eq\x20\x27','block','View','></div></td>','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27','table','attr','\x27\x20and\x20Company/ID\x20\x20eq\x20\x27','AttendanceDate','children','round','getDate','getFullYear','/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?select=*,ID,Title&$filter=OfficeLocationID\x20eq\x20\x27','sorter','\x27\x20and\x20(WebPartName\x20eq\x20\x27HR\x20Admin\x27)','btoa','/Pages/TimeSheetEntry.aspx?WebAppId=2&Recall=','display','45yeoprh','floor','UserId','SPClientPeoplePicker','application/json;odata=verbose','9296510cOMAvd','red','[?&]','Oct','\x27)and\x20Holiday_start\x20eq\x20\x27','EmployeeName','OfficeName','val','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Time','oddrow','User,DL,SecGroup,SPGroup','location','#EmpreportTo','Holiday','><span>','#Workingdays','DD/MM/YYYY','slice','AttendanceType','text','/_api/web/lists/GetByTitle(\x27EmpAttendance\x27)/items','Apr','#EmpTitle','setDate','EmpReportTableData','Empstartrecord','#AttendanceDDL','evenselected','exec','Are\x20you\x20sure\x20to\x20withdraw\x20the\x20Leave?','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27><a\x20href=\x27#\x27\x20class=\x27custom-edit-btn\x27\x20data-toggle=\x27modal\x27\x20data-target=\x27#attendance-reportEdit\x27\x20onclick=\x27attendanceEditModal(','Width','On-Leave','#HolidayMessagediv','getDay','webAbsoluteUrl','Unauthorized\x20access!','getElementById','</div></td>','Emptotalrecords','\x27\x20and\x20CompanyID\x20eq\x20\x27','6827050oELjIN','Jan','join','tablenav','SearchPrincipalSource','Tuesday','Title','</a>','Error!\x20Something\x20went\x20wrong.','GetAllUserInfo','/_api/web/lists/getbytitle(\x27','.NoRecordFound','12201432cqQbsF','MaximumEntitySuggestions','Thursday','get','getMonth','#OfficeLoc','append','#HoliaysTotal','<td><div\x20class=\x27checkbox\x20m-0\x27></div></td>','Jun','AllowMultipleValues','Wednesday','\x20,\x20','format','HrAction','urlParam','EID','<tr\x20class=\x27text-center\x27\x20>','Empendrecord','MM\x20dd,\x20yy','parse','Monday','#EmpRow','613864XcdYAD','#EmployeeName','May','\x20\x27><a\x20href=\x27#\x27\x20class=\x27custom-edit-btn\x27\x20data-toggle=\x27modal\x27\x20data-target=\x27#attendance-reportEdit\x27\x20onclick=\x27attendanceEditModal(','ajax','96mquBng','Dec','\x27\x20and\x20AttendanceDate\x20le\x20\x27','2379940pZIMwH','\x27\x20and\x20Holiday_start\x20le\x20\x27','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27\x20style=\x27display:\x20','#StartDate','This\x20is\x20a\x20Holiday,\x20are\x20you\x20sure\x20to\x20submit\x20your\x20attendance.','Friday','<a\x20href=\x27#\x27\x20class=\x27Withdraw-Leave-link\x27\x20onclick=\x27WithdrawLeave(','#Total-Leave-Absent','columns','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27></div></td>','/_api/web/ensureuser','Sunday','280px','results','Holiday_start','Nov','LogonName','Plese\x20select\x20proper\x20attandence.','grep','Mar','Empcurrentpage','#EmpreportFrom','/_api/web/lists/GetByTitle(\x27EmpAttendance\x27)/items(','error','SP.Data.EmpAttendanceListItem','YYYY-MM-DD','ready','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Att'];_0x28aa=function(){return _0xeb9e5e;};return _0x28aa();}function WithdrawLeave(_0x342e38,_0x20818a){var _0x4760d1=_0x4116c9;confirm(_0x4760d1(0x144))&&$[_0x4760d1(0x177)]({'url':_spPageContextInfo[_0x4760d1(0x14a)]+_0x4760d1(0x191)+_0x342e38+')','type':_0x4760d1(0x10d),'headers':{'X-RequestDigest':$('#__REQUESTDIGEST')[_0x4760d1(0x12e)](),'IF-MATCH':'*','X-HTTP-Method':'DELETE'},'success':function(_0x3c23cb,_0x3b9be7,_0x268c27){var _0x2c142c=_0x4760d1;$(_0x2c142c(0x1c1)+_0x20818a)[_0x2c142c(0x1bf)](_0x2c142c(0x121),_0x2c142c(0x109)),alert('Leave\x20withdrawal\x20Successfully\x20Completed.');},'error':function(_0x3d7be1,_0x52908b,_0x343e7e){var _0x581377=_0x4760d1;$(_0x581377(0x1be))[_0x581377(0x1c9)]()[_0x581377(0x13a)](data[_0x581377(0x107)][_0x581377(0x192)]);}});}function ConvertDateTimeFormat(_0x1119f3,_0x2665ea){var _0x360a6d=_0x4116c9;return _0x1119f3[_0x360a6d(0x1ae)](_0x2665ea)[0x1]+''+_0x2665ea+''+_0x1119f3[_0x360a6d(0x1ae)](_0x2665ea)[0x0]+''+_0x2665ea+''+_0x1119f3['split'](_0x2665ea)[0x2];}var GEmployeeID=0x0,LocID=0x0;function EmployeeListDat(_0x363970){var _0x3c12e9=_0x4116c9;GEmployeeID=0x0,$[_0x3c12e9(0x177)]({'url':_0x363970,'headers':{'Accept':_0x3c12e9(0x126)},'async':![],'success':function(_0x4fa3b3){var _0x55cc71=_0x3c12e9,_0x2d3c90=_0x4fa3b3['d'][_0x55cc71(0x188)];_0x2d3c90[_0x55cc71(0x19d)]>0x0?($(_0x55cc71(0x1c5))[_0x55cc71(0x13a)](_0x2d3c90[0x0][_0x55cc71(0x18b)][_0x55cc71(0x156)]),GEmployeeID=_0x2d3c90[0x0][_0x55cc71(0x18b)]['ID'],$(_0x55cc71(0x13d))['text'](_0x2d3c90[0x0][_0x55cc71(0x18b)][_0x55cc71(0x156)]),$(_0x55cc71(0x161))[_0x55cc71(0x13a)](_0x2d3c90[0x0][_0x55cc71(0x1ad)][_0x55cc71(0x12d)]),$('#officeLocTH')[_0x55cc71(0x13a)](_0x2d3c90[0x0][_0x55cc71(0x1ad)][_0x55cc71(0x12d)]),LocID=_0x2d3c90[0x0][_0x55cc71(0x1ad)]['ID']):($('#EmpName')[_0x55cc71(0x13a)](''),$(_0x55cc71(0x161))[_0x55cc71(0x13a)](''),LocID=0x0);},'error':function(_0x3d31a5){var _0x5c1a7c=_0x3c12e9;console[_0x5c1a7c(0x1af)](_0x3d31a5);}});}function EmpTableConfiguration(){var _0x109104=_0x4116c9;sorter=new TINY[(_0x109104(0x114))][(_0x109104(0x11d))]('sorter',_0x109104(0x13f),{'ascclass':_0x109104(0x1b0),'descclass':'desc','evenclass':'evenrow','oddclass':_0x109104(0x130),'evenselclass':_0x109104(0x142),'oddselclass':_0x109104(0xfc),'paginate':!![],'size':0xa,'colddid':_0x109104(0x183),'currentid':_0x109104(0x18f),'totalid':_0x109104(0x1c7),'startingrecid':_0x109104(0x140),'endingrecid':_0x109104(0x16e),'totalrecid':_0x109104(0x14e),'hoverid':'selectedrow','pageddid':_0x109104(0x19e),'navid':_0x109104(0x153),'sortdir':0x1,'init':!![]});}$['urlParam']=function(_0x236531){var _0x222702=_0x4116c9,_0x16ca1d=new RegExp(_0x222702(0x129)+_0x236531+'=([^&#]*)')[_0x222702(0x143)](window[_0x222702(0x132)][_0x222702(0x1ce)]);if(_0x16ca1d==null)return null;return decodeURI(_0x16ca1d[0x1])||0x0;};function formatDateReportEmp(_0x1463f7){var _0x42ca5e=_0x4116c9,_0x520844=[_0x42ca5e(0x186),_0x42ca5e(0x171),_0x42ca5e(0x155),_0x42ca5e(0x167),_0x42ca5e(0x15e),_0x42ca5e(0x180),_0x42ca5e(0x10c)],_0x573955=new Date(_0x1463f7);if(isNaN(_0x573955['getTime']()))return _0x1463f7;else{var _0x2032b8=new Array();return _0x2032b8[0x0]=_0x42ca5e(0x151),_0x2032b8[0x1]=_0x42ca5e(0x1cf),_0x2032b8[0x2]=_0x42ca5e(0x18e),_0x2032b8[0x3]=_0x42ca5e(0x13c),_0x2032b8[0x4]=_0x42ca5e(0x175),_0x2032b8[0x5]=_0x42ca5e(0x165),_0x2032b8[0x6]=_0x42ca5e(0x100),_0x2032b8[0x7]=_0x42ca5e(0x102),_0x2032b8[0x8]=_0x42ca5e(0x1a9),_0x2032b8[0x9]=_0x42ca5e(0x12a),_0x2032b8[0xa]=_0x42ca5e(0x18a),_0x2032b8[0xb]=_0x42ca5e(0x179),day=_0x573955['getDate'](),day<0xa&&(day='0'+day),day+'\x20'+_0x2032b8[_0x573955['getMonth']()]+'\x20'+_0x573955[_0x42ca5e(0x11b)]()+',\x20'+_0x520844[_0x573955[_0x42ca5e(0x149)]()];}}function ConvertHHMM(_0xb5912){var _0x403bf3=_0x4116c9;if(_0xb5912!=null){var _0x1800e3=Math[_0x403bf3(0x123)](_0xb5912/0x3c),_0x5c0c2b=_0xb5912%0x3c;_0x1800e3<0xa&&(_0x1800e3='0'+_0x1800e3);_0x5c0c2b<0xa&&(_0x5c0c2b='0'+_0x5c0c2b);var _0x376d53=_0x1800e3+':'+_0x5c0c2b;}else var _0x376d53='';return _0x376d53;}var AttandenceOnHolidays=0x0,HolidaysListDTL=[];function LoadAllHolidays(){var _0x3c7de8=_0x4116c9;TotalOfficeDays=0x0,HolidaysListDTL=[];var _0x28d91f=new Date($('#EmpreportFrom')[_0x3c7de8(0x12e)]()),_0x5c88b2=_0x28d91f[_0x3c7de8(0x11b)]()+'-'+(_0x28d91f['getMonth']()+0x1)+'-'+_0x28d91f[_0x3c7de8(0x11a)](),_0x3bcbc5=new Date($(_0x3c7de8(0x133))[_0x3c7de8(0x12e)]()),_0x46fa29=_0x3bcbc5[_0x3c7de8(0x11b)]()+'-'+(_0x3bcbc5[_0x3c7de8(0x160)]()+0x1)+'-'+_0x3bcbc5[_0x3c7de8(0x11a)](),_0x362cb3=_spPageContextInfo[_0x3c7de8(0x14a)]+_0x3c7de8(0x11c)+LocID+_0x3c7de8(0x14f)+CompanyID+'\x27\x20and\x20Holiday_start\x20ge\x20\x27'+_0x5c88b2+_0x3c7de8(0x17c)+_0x46fa29+'\x27';$['ajax']({'url':_0x362cb3,'headers':{'Accept':_0x3c7de8(0x126)},'async':![],'success':function(_0xd36be8){var _0x9647cb=_0x3c7de8,_0x1f1d37=_0xd36be8['d'][_0x9647cb(0x188)][_0x9647cb(0x19d)],_0x31e4af=0x0;for(var _0x5dfd74=0x0;_0x5dfd74<_0x1f1d37;_0x5dfd74++){var _0x34ab67=new Date(_0xd36be8['d'][_0x9647cb(0x188)][_0x5dfd74][_0x9647cb(0x189)]),_0x435a3c=moment(_0x34ab67,_0x9647cb(0x137))[_0x9647cb(0x169)](_0x9647cb(0x194)),_0x435a3c=_0x435a3c['split']('-')[_0x9647cb(0x152)](''),_0x1a665f=_0xd36be8['d'][_0x9647cb(0x188)][_0x5dfd74][_0x9647cb(0x156)];HolidaysListDTL[_0x9647cb(0x1c8)]({'Hdate':_0x435a3c,'Title':_0x1a665f}),$('#'+_0x435a3c)['css'](_0x9647cb(0x1bd),_0x9647cb(0x128)),$('#H'+_0x435a3c)[_0x9647cb(0x13a)](_0x9647cb(0x168)+_0x1a665f),$('#Att'+_0x435a3c)[_0x9647cb(0x13a)]()!=''&&(_0x31e4af=_0x31e4af+0x1);}AttandenceOnHolidays=0x0;for(var _0xe003e8=0x0;_0xe003e8<HolidaysListDTL[_0x9647cb(0x19d)];_0xe003e8++){var _0x255bbd=$(_0x9647cb(0x1c1)+HolidaysListDTL[_0xe003e8][_0x9647cb(0x10a)])['text']();_0x255bbd!=''&&_0x255bbd!='On-Leave'&&_0x255bbd!='Holiday'&&(AttandenceOnHolidays=AttandenceOnHolidays+0x1);}var _0x485868=0x0,_0x3d2b4e=0x0,_0x2c8eb8=0x0;for(var _0x25aabf=0x0;_0x25aabf<DataIdList['length'];_0x25aabf++){var _0x4c40ec=$(_0x9647cb(0x1c1)+DataIdList[_0x25aabf])[_0x9647cb(0x13a)]();_0x4c40ec==_0x9647cb(0xfd)&&(_0x4c40ec=_0x4c40ec[_0x9647cb(0x1ae)](_0x9647cb(0x101))[0x0]),(_0x4c40ec==''||_0x4c40ec=='On-Leave')&&(_0x3d2b4e=_0x3d2b4e+0x1),_0x4c40ec==_0x9647cb(0x147)&&(_0x2c8eb8=_0x2c8eb8+0x1),_0x4c40ec==_0x9647cb(0x134)&&(_0x485868=_0x485868+0x1);}var _0x3b6e26=_0x3d2b4e+AttandenceOnHolidays-(_0x1f1d37-_0x485868);_0x3b6e26<0x0&&(_0x3b6e26=0x0),_0x3b6e26!='0'?$(_0x9647cb(0x182))['text'](_0x3b6e26):_0x2c8eb8>0x0&&$(_0x9647cb(0x182))['text'](_0x2c8eb8),$(_0x9647cb(0x163))['text'](_0x1f1d37),$(_0x9647cb(0x136))[_0x9647cb(0x13a)](parseInt(Totaldays)-parseInt(_0x1f1d37)),$('#FdateTH')[_0x9647cb(0x13a)](formatDateReportEmp(ConvertDateTimeFormat($('#EmpreportFrom')[_0x9647cb(0x12e)](),'/'))),$('#EdateTH')[_0x9647cb(0x13a)](formatDateReportEmp(ConvertDateTimeFormat($(_0x9647cb(0x133))[_0x9647cb(0x12e)](),'/'))),$(_0x9647cb(0x1a8))[_0x9647cb(0x13a)](parseInt(Totaldays)-parseInt(_0x1f1d37)),$('#HolidaysTH')[_0x9647cb(0x13a)](_0x1f1d37);},'myError':function(_0x5a11a3){}});}function ensureUser(_0x45cb00){var _0x4a3ce5=_0x4116c9,_0x29e497=0x0,_0x38ec44=_0x45cb00,_0x856339=this[_0x4a3ce5(0x125)][_0x4a3ce5(0x1ba)][_0x38ec44],_0x2a89e7=_0x856339[_0x4a3ce5(0x159)](),_0x35e565=_0x2a89e7[0x0];if(_0x35e565){var _0x5ca647={'logonName':_0x35e565[_0x4a3ce5(0x108)]};$[_0x4a3ce5(0x177)]({'url':_spPageContextInfo[_0x4a3ce5(0x14a)]+_0x4a3ce5(0x185),'type':_0x4a3ce5(0x10d),'async':![],'contentType':'application/json;odata=verbose','data':JSON[_0x4a3ce5(0x103)](_0x5ca647),'headers':{'X-RequestDigest':$('#__REQUESTDIGEST')['val'](),'accept':'application/json;odata=verbose'},'success':function(_0x154784,_0x5273fb,_0x298c77){_0x29e497=_0x154784['d']['Id'];},'error':function(_0x1c2c69,_0x39950e,_0x22e56d){}});}else _0x29e497=0x0;return _0x29e497;}var tableToExcel=(function(){var _0xb6466d='data:application/vnd.ms-excel;base64,',_0xf26fa6='<html\x20xmlns:o=\x22urn:schemas-microsoft-com:office:office\x22\x20xmlns:x=\x22urn:schemas-microsoft-com:office:excel\x22\x20xmlns=\x22http://www.w3.org/TR/REC-html40\x22><head><!--[if\x20gte\x20mso\x209]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>',_0x3740f0=function(_0x2b314c){var _0x36dcd2=_0x40fa;return window[_0x36dcd2(0x11f)](unescape(encodeURIComponent(_0x2b314c)));},_0x445522=function(_0x4e97aa,_0x481105){var _0x586e8c=_0x40fa;return _0x4e97aa[_0x586e8c(0x1c4)](/{(\w+)}/g,function(_0x58b4e3,_0x3a0646){return _0x481105[_0x3a0646];});};return function(_0x2311bb,_0x32bbc0){var _0xa8a909=_0x40fa;if(!_0x2311bb[_0xa8a909(0x1b6)])_0x2311bb=document[_0xa8a909(0x14c)](_0x2311bb);var _0x13ab53={'worksheet':_0x32bbc0||'Worksheet','table':_0x2311bb[_0xa8a909(0x1c3)]};window[_0xa8a909(0x132)][_0xa8a909(0x1ce)]=_0xb6466d+_0x3740f0(_0x445522(_0xf26fa6,_0x13ab53));};}()),ISHRADMIN=![];function ValidateHrAdmin(){var _0x4d779d=_0x4116c9,_0x4853c3='ProcessApprovers',_0x4464a6=_spPageContextInfo['webAbsoluteUrl']+_0x4d779d(0x15a)+_0x4853c3+_0x4d779d(0x10f)+titanForWork[_0x4d779d(0x19b)](_0x4d779d(0x1b1))+_0x4d779d(0xfe)+_spPageContextInfo[_0x4d779d(0x1c6)]+_0x4d779d(0x11e);$[_0x4d779d(0x177)]({'url':_0x4464a6,'async':![],'type':_0x4d779d(0x15f),'headers':{'Accept':_0x4d779d(0x126)},'success':function(_0x5f42ce){var _0x475f23=_0x4d779d,_0x2a4e8e=_0x5f42ce['d'][_0x475f23(0x188)];_0x2a4e8e[_0x475f23(0x19d)]>0x0?($(_0x475f23(0x172))[_0x475f23(0x1bf)]('display',_0x475f23(0x110)),ISHRADMIN=!![]):(ISHRADMIN=![],$(_0x475f23(0x172))[_0x475f23(0x10b)]());},'error':function(_0x22df31){var _0x431cd7=_0x4d779d;console['log'](_0x22df31[_0x431cd7(0x107)]['error']);}});}function GetAttendanceorLeaves(){var _0x59e90a=_0x4116c9,_0xb79f5=$['urlParam']('EID'),_0x4694da=$('#EmpreportFrom')[_0x59e90a(0x1aa)](_0x59e90a(0x11a)),_0x44beff=$(_0x59e90a(0x133))['datepicker'](_0x59e90a(0x11a));days=(_0x44beff-_0x4694da)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math[_0x59e90a(0x119)](days)+0x1,$(_0x59e90a(0x17e))['text'](formatDateReportEmp($(_0x59e90a(0x190))[_0x59e90a(0x12e)]())),$(_0x59e90a(0x1a3))['text'](formatDateReportEmp($('#EmpreportTo')[_0x59e90a(0x12e)]()));var _0x573b9b=moment($('#EmpreportFrom')['val'](),'LL')['format'](_0x59e90a(0x194)),_0x3e7fb5=moment($(_0x59e90a(0x133))[_0x59e90a(0x12e)](),'LL')[_0x59e90a(0x169)]('YYYY-MM-DD'),_0x406b06=new Date(_0x3e7fb5),_0x36027d=_0x406b06['toISOString'](),_0x34e545=_0x36027d[_0x59e90a(0x1ae)]('T');GstartDate=_0x573b9b;var _0x4e8cea=ensureUser($(_0x59e90a(0x174))[_0x59e90a(0x118)]()[_0x59e90a(0x118)]()[_0x59e90a(0x115)]('id'));if(_0x4e8cea==0x0){var _0x3cfbdf=_spPageContextInfo[_0x59e90a(0x14a)]+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27'+_0xb79f5+_0x59e90a(0x116)+CompanyID+'\x27';EmployeeListDat(_0x3cfbdf),LoadAllHolidays(),_0xb79f5=_0xb79f5,GEmpID=_0xb79f5;var _0x4c0553=_spPageContextInfo['webAbsoluteUrl']+_0x59e90a(0x113)+_0x573b9b+_0x59e90a(0x17a)+_0x34e545+_0x59e90a(0x1b2)+_0xb79f5+'\x27\x20';UpdateHeaderfields(_0x4c0553);}else{if(ISHRADMIN==!![]){_0xb79f5=_0x4e8cea,GEmpID=_0x4e8cea;var _0x3cfbdf=_spPageContextInfo[_0x59e90a(0x14a)]+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27'+_0xb79f5+_0x59e90a(0x116)+CompanyID+'\x27';EmployeeListDat(_0x3cfbdf),LoadAllHolidays();var _0x4c0553=_spPageContextInfo[_0x59e90a(0x14a)]+_0x59e90a(0x113)+_0x573b9b+_0x59e90a(0x17a)+_0x34e545+_0x59e90a(0x1b2)+_0xb79f5+'\x27\x20';UpdateHeaderfields(_0x4c0553);var _0x3cfbdf=_spPageContextInfo[_0x59e90a(0x14a)]+_0x59e90a(0xf7)+_0xb79f5+_0x59e90a(0x116)+CompanyID+'\x27';}else alert(_0x59e90a(0x14b));}LoadAllHolidays();}function GetFilterData(_0x523324){var _0x362dba=_0x4116c9;jQuery['ajax']({'url':_0x523324,'headers':{'Accept':_0x362dba(0x126)},'async':![],'success':function(_0x1247f4){var _0x340f31=_0x362dba,_0x56db4c=_0x1247f4['d'][_0x340f31(0x188)],_0x21c40f=[];TotalLeavesorAbsent=[];for(var _0x1a6649=0x0;_0x1a6649<_0x56db4c[_0x340f31(0x19d)];_0x1a6649++){if(_0x56db4c[_0x1a6649][_0x340f31(0x139)]!=_0x340f31(0x147)&&_0x56db4c[_0x1a6649][_0x340f31(0x139)]!=_0x340f31(0x134))_0x21c40f[_0x340f31(0x1c8)](_0x56db4c[_0x1a6649][_0x340f31(0x139)]);else _0x56db4c[_0x1a6649][_0x340f31(0x139)]==_0x340f31(0x147)&&TotalLeavesorAbsent['push'](_0x56db4c[_0x1a6649][_0x340f31(0x139)]);}var _0x31f692=$[_0x340f31(0x18d)](_0x56db4c,function(_0x1007c3){var _0x3ef730=_0x340f31;return _0x1007c3[_0x3ef730(0x139)]!='On-Leave'&&_0x1007c3[_0x3ef730(0x139)]!=_0x3ef730(0x134);});$(_0x340f31(0x1a2))[_0x340f31(0x13a)](_0x31f692[_0x340f31(0x19d)]);},'error':function(_0x477068,_0xad151c){var _0x98670a=_0x362dba;console[_0x98670a(0x1af)](JSON[_0x98670a(0x103)](_0x477068));}});}var G_Validateholiday=![];function GetHolidays(_0x2803c9){var _0x493066=_0x4116c9,_0x4e6661=_spPageContextInfo[_0x493066(0x14a)]+_0x493066(0x197)+LocID+_0x493066(0x12b)+_0x2803c9+'\x27\x20and\x20CompanyID\x20eq\x20\x27'+titanForWork['getQueryStringParameter']('CompanyId')+'\x27&$top=200&$orderby=Holiday_start\x20asc';$[_0x493066(0x177)]({'url':_0x4e6661,'headers':{'Accept':_0x493066(0x126)},'async':![],'success':function(_0x2bc59d){var _0x8d4299=_0x493066,_0x4e8397=_0x2bc59d['d']['results'];_0x4e8397[_0x8d4299(0x19d)]>0x0?($('#HolidayMessagediv')[_0x8d4299(0x13a)](_0x4e8397[0x0][_0x8d4299(0x156)]),$('#HolidayMessage')[_0x8d4299(0x1bf)](_0x8d4299(0x121),_0x8d4299(0x110)),G_Validateholiday=!![]):($(_0x8d4299(0x148))[_0x8d4299(0x13a)](''),$(_0x8d4299(0x199))[_0x8d4299(0x1bf)](_0x8d4299(0x121),'none'),G_Validateholiday=![]);},'error':function(_0x2e10ea){alert('An\x20error\x20occurred.\x20Please\x20try\x20again.');}});}var EmpAttendanceData=[],TotalLeavesorAbsent=[];function UpdateHeaderfields(_0xee4673){var _0x4da05f=_0x4116c9;jQuery['ajax']({'url':_0xee4673,'headers':{'Accept':_0x4da05f(0x126)},'async':!![],'success':function(_0x1798cd){var _0x59fcee=_0x4da05f;EmpAttendanceData=[];var _0x1e79d1=_0x1798cd['d'][_0x59fcee(0x188)],_0x77d1dd=[];TotalLeavesorAbsent=[];for(var _0x36b736=0x0;_0x36b736<_0x1e79d1[_0x59fcee(0x19d)];_0x36b736++){if(_0x1e79d1[_0x36b736][_0x59fcee(0x139)]!='On-Leave'&&_0x1e79d1[_0x36b736][_0x59fcee(0x139)]!=_0x59fcee(0x134))_0x77d1dd[_0x59fcee(0x1c8)](_0x1e79d1[_0x36b736][_0x59fcee(0x139)]);else{if(_0x1e79d1[_0x36b736][_0x59fcee(0x139)]==_0x59fcee(0x147))TotalLeavesorAbsent[_0x59fcee(0x1c8)](_0x1e79d1[_0x36b736][_0x59fcee(0x139)]);else _0x1e79d1[_0x36b736][_0x59fcee(0x139)]==_0x59fcee(0x134)&&TotalLeavesorAbsent[_0x59fcee(0x1c8)](_0x1e79d1[_0x36b736]['AttendanceType']);}var _0x5b3247=_0x1e79d1[_0x36b736]['ID'],_0x4a6cfb=_0x1e79d1[_0x36b736][_0x59fcee(0x19f)]['Title'],_0x2b8e2b=_0x1e79d1[_0x36b736][_0x59fcee(0x19f)]['ID'],_0x51b2c0=formatDateReportEmp(_0x1e79d1[_0x36b736][_0x59fcee(0x117)]),_0x3fda50=_0x1e79d1[_0x36b736][_0x59fcee(0x139)],_0x15a6c1=_0x1e79d1[_0x36b736][_0x59fcee(0x1c0)],_0x4e744a=_0x1e79d1[_0x36b736][_0x59fcee(0x16a)];EmpAttendanceData[_0x59fcee(0x1c8)]({'UserId':_0x2b8e2b,'EmpName':_0x4a6cfb,'AttendanceDate':_0x51b2c0,'AttendanceType':_0x3fda50,'AttendanceItemId':_0x5b3247,'EmpWorkHours':_0x15a6c1,'HrAction':_0x4e744a});}var _0x1278c6='',_0x46ef5d=0x0,_0x1c9920=0x0;for(var _0x3bef63=0x0;_0x3bef63<Totaldays;_0x3bef63++){var _0x44874a=new Date(GstartDate);_0x44874a['setDate'](_0x44874a['getDate']()+_0x3bef63);var _0x505f85=moment(_0x44874a,_0x59fcee(0x137))['format'](_0x59fcee(0x194)),_0x505f85=_0x505f85['split']('-')[_0x59fcee(0x152)](''),_0x5b408a=formatDateReportEmp(_0x44874a),_0xec2b67=EmpAttendanceData[_0x59fcee(0xfb)](function(_0x39ded1){var _0x4e8e15=_0x59fcee;return _0x39ded1[_0x4e8e15(0x117)];})[_0x59fcee(0xfa)](_0x5b408a);if(_0xec2b67!=-0x1){var _0x4ae61a=EmpAttendanceData[_0xec2b67]['AttendanceType'],_0x31964d=EmpAttendanceData[_0xec2b67][_0x59fcee(0x1b5)],_0x4e744a=EmpAttendanceData[_0xec2b67][_0x59fcee(0x16a)],_0x3a8490=EmpAttendanceData[_0xec2b67][_0x59fcee(0x124)],_0x138c40=EmpAttendanceData[_0xec2b67][_0x59fcee(0x198)];_0x1c9920=_0x1c9920+0x1;}else _0x46ef5d=_0x46ef5d+0x1;}var _0x25a2af=parseInt(TotalLeavesorAbsent[_0x59fcee(0x19d)])+parseInt(_0x46ef5d)-parseInt($(_0x59fcee(0x163))[_0x59fcee(0x13a)]());_0x25a2af<0x0&&(_0x25a2af=0x0);$(_0x59fcee(0x1c2))[_0x59fcee(0x13a)](Totaldays);var _0x1434cc=parseInt(_0x1c9920)-parseInt(TotalLeavesorAbsent[_0x59fcee(0x19d)]),_0x50b6fb=$[_0x59fcee(0x18d)](_0x1e79d1,function(_0x402004){var _0x3a3eea=_0x59fcee;return _0x402004[_0x3a3eea(0x139)]!='On-Leave'&&_0x402004['AttendanceType']!=_0x3a3eea(0x134);});$(_0x59fcee(0x1a2))[_0x59fcee(0x13a)](_0x50b6fb[_0x59fcee(0x19d)]);},'error':function(_0x21f707,_0x56322d){var _0x30a773=_0x4da05f;console[_0x30a773(0x1af)](JSON[_0x30a773(0x103)](_0x21f707));}});}