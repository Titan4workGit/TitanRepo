var _0x34cc20=_0x2cfa;(function(_0x1a7ea5,_0x21e160){var _0x3de156=_0x2cfa,_0x39b746=_0x1a7ea5();while(!![]){try{var _0x30858f=-parseInt(_0x3de156(0x144))/0x1+-parseInt(_0x3de156(0x169))/0x2*(parseInt(_0x3de156(0x15c))/0x3)+parseInt(_0x3de156(0x17c))/0x4+parseInt(_0x3de156(0x1a6))/0x5*(-parseInt(_0x3de156(0x193))/0x6)+parseInt(_0x3de156(0xf0))/0x7+parseInt(_0x3de156(0x151))/0x8*(-parseInt(_0x3de156(0x13f))/0x9)+-parseInt(_0x3de156(0x12a))/0xa*(-parseInt(_0x3de156(0x18b))/0xb);if(_0x30858f===_0x21e160)break;else _0x39b746['push'](_0x39b746['shift']());}catch(_0x3fa653){_0x39b746['push'](_0x39b746['shift']());}}}(_0x1dbe,0x23baa));var GCompanyId='',GOfficeDays='';$(document)[_0x34cc20(0xfa)](function(){var _0x48a23b=_0x34cc20;userActivityNotificationEntry(_spPageContextInfo[_0x48a23b(0xef)],window[_0x48a23b(0x117)]),authentication(),GCompanyId=titanForWork[_0x48a23b(0x147)](_0x48a23b(0xf4)),$(_0x48a23b(0x19e))[_0x48a23b(0x14a)]({'dateFormat':'dd/mm/yy','maxDate':new Date()})['datepicker'](_0x48a23b(0x172),new Date()),$(_0x48a23b(0x159))['datepicker']({'dateFormat':'dd/mm/yy'})['datepicker'](_0x48a23b(0x172),_0x48a23b(0x10e)),$(_0x48a23b(0x16b))[_0x48a23b(0x13d)](formatDateReport(ConvertDateTimeFormat($(_0x48a23b(0x159))['val'](),'/'))),$(_0x48a23b(0x16f))[_0x48a23b(0x13d)](formatDateReport(ConvertDateTimeFormat($('#attendance-reportTo')[_0x48a23b(0x11a)](),'/')));var _0x31d717=$('#attendance-reportFrom')[_0x48a23b(0x14a)](_0x48a23b(0xec)),_0x19bdd6=$(_0x48a23b(0x19e))[_0x48a23b(0x14a)]('getDate');days=(_0x19bdd6-_0x31d717)/(0x3e8*0x3c*0x3c*0x18);var _0x47ac9=Math[_0x48a23b(0x156)](days);GOfficeDays=Math[_0x48a23b(0x156)](days),LoadAllOfficeLocation(),LoadAllDepartment(),LoadAllHolidays(),$('#SelectedLocation')[_0x48a23b(0x13d)]($(_0x48a23b(0x111))[_0x48a23b(0x13d)]()),initializePeoplePicker(_0x48a23b(0x13c)),initializePeoplePicker('Employee'),$(_0x48a23b(0x101))[_0x48a23b(0x181)](_0x48a23b(0x142));});function initializePeoplePicker(_0x27da46){var _0xb189e1=_0x34cc20,_0x2e6555={};_0x2e6555[_0xb189e1(0x139)]='User,DL,SecGroup,SPGroup',_0x2e6555[_0xb189e1(0x1a5)]=0xf,_0x2e6555[_0xb189e1(0x17f)]=0xf,_0x2e6555[_0xb189e1(0x109)]=![],_0x2e6555['MaximumEntitySuggestions']=0x32,_0x2e6555['Width']='280px',this[_0xb189e1(0x12c)](_0x27da46,null,_0x2e6555);}function ensureUser(_0x344acf){var _0x17ec0e=_0x34cc20,_0x41aa43=0x0,_0x50b7c0=_0x344acf,_0xae58bb=this[_0x17ec0e(0x1af)][_0x17ec0e(0x158)][_0x50b7c0],_0x6e3765=_0xae58bb[_0x17ec0e(0x196)](),_0x49a998=_0x6e3765[0x0];if(_0x49a998){var _0x2527f1={'logonName':_0x49a998[_0x17ec0e(0x120)]};$[_0x17ec0e(0x16c)]({'url':_spPageContextInfo[_0x17ec0e(0x1a4)]+_0x17ec0e(0x133),'type':_0x17ec0e(0x122),'async':![],'contentType':_0x17ec0e(0x105),'data':JSON[_0x17ec0e(0x18f)](_0x2527f1),'headers':{'X-RequestDigest':$(_0x17ec0e(0x11d))[_0x17ec0e(0x11a)](),'accept':_0x17ec0e(0x105)},'success':function(_0x56d8a2,_0x577a59,_0x3cd095){_0x41aa43=_0x56d8a2['d']['Id'];},'error':function(_0x150290,_0x2ff6ac,_0x4f8df1){}});}else _0x41aa43=0x0;return _0x41aa43;}function GetUserTitle(_0x5e02ca){var _0x3363e8=_0x34cc20,_0x3c15ab=0x0,_0x50a048=_0x5e02ca,_0x1d33a0=this[_0x3363e8(0x1af)][_0x3363e8(0x158)][_0x50a048],_0x3e6e40=_0x1d33a0[_0x3363e8(0x196)](),_0x370087=_0x3e6e40[0x0];if(_0x370087){var _0x54d951={'logonName':_0x370087[_0x3363e8(0x120)]};$[_0x3363e8(0x16c)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x3363e8(0x133),'type':_0x3363e8(0x122),'async':![],'contentType':_0x3363e8(0x105),'data':JSON['stringify'](_0x54d951),'headers':{'X-RequestDigest':$(_0x3363e8(0x11d))['val'](),'accept':_0x3363e8(0x105)},'success':function(_0x41fb18,_0x4cffe7,_0x1376d6){var _0x4556dc=_0x3363e8;_0x3c15ab=_0x41fb18['d'][_0x4556dc(0x12b)];},'error':function(_0x42f48c,_0x4d1ee9,_0x44c149){}});}else _0x3c15ab=0x0;return _0x3c15ab;}function ConvertDateTimeFormat(_0x3e3933,_0x1c23dd){var _0x44258a=_0x34cc20;return _0x3e3933[_0x44258a(0x1b6)](_0x1c23dd)[0x1]+''+_0x1c23dd+''+_0x3e3933[_0x44258a(0x1b6)](_0x1c23dd)[0x0]+''+_0x1c23dd+''+_0x3e3933['split'](_0x1c23dd)[0x2];}function formatDateReport(_0x5e2867){var _0x1895e5=_0x34cc20,_0x1fc060=new Date(_0x5e2867);if(isNaN(_0x1fc060[_0x1895e5(0x1b5)]()))return _0x5e2867;else{var _0x416cb7=new Array();return _0x416cb7[0x0]=_0x1895e5(0xe9),_0x416cb7[0x1]=_0x1895e5(0x134),_0x416cb7[0x2]='Mar',_0x416cb7[0x3]=_0x1895e5(0x112),_0x416cb7[0x4]=_0x1895e5(0x126),_0x416cb7[0x5]=_0x1895e5(0x15d),_0x416cb7[0x6]=_0x1895e5(0x115),_0x416cb7[0x7]=_0x1895e5(0x130),_0x416cb7[0x8]=_0x1895e5(0x118),_0x416cb7[0x9]=_0x1895e5(0x11f),_0x416cb7[0xa]='Nov',_0x416cb7[0xb]='Dec',day=_0x1fc060[_0x1895e5(0xec)](),day<0xa&&(day='0'+day),day+'\x20'+_0x416cb7[_0x1fc060[_0x1895e5(0x166)]()]+'\x20'+_0x1fc060[_0x1895e5(0xe7)]();}}function LoadAllOfficeLocation(){var _0x1beba4=_0x34cc20;$(_0x1beba4(0x16e))[_0x1beba4(0x185)]();var _0x48ef03=_spPageContextInfo[_0x1beba4(0x1a4)]+_0x1beba4(0x1a7)+GCompanyId+_0x1beba4(0xff);$[_0x1beba4(0x16c)]({'url':_0x48ef03,'headers':{'Accept':_0x1beba4(0x105)},'async':![],'success':function(_0x2f3a5a){var _0x2f8e42=_0x1beba4;for(var _0x21b0f1=0x0;_0x21b0f1<_0x2f3a5a['d']['results'][_0x2f8e42(0x104)];_0x21b0f1++){$(_0x2f8e42(0x16e))['append']('<option\x20value=\x22'+_0x2f3a5a['d']['results'][_0x21b0f1]['ID']+'\x22>'+_0x2f3a5a['d'][_0x2f8e42(0x143)][_0x21b0f1]['OfficeName']+'</option>');}},'myError':function(_0x2ccaa6){}});}function LoadAllDepartment(){var _0x7a1283=_0x34cc20;$(_0x7a1283(0x145))['empty']();var _0x2f0802=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/getbytitle(\x27Departments\x27)/items?select=ID,Title&$filter=CompanyID\x20eq\x20\x27'+GCompanyId+_0x7a1283(0x1ae);$['ajax']({'url':_0x2f0802,'headers':{'Accept':_0x7a1283(0x105)},'async':!![],'success':function(_0x5de51b){var _0x3c0734=_0x7a1283;$(_0x3c0734(0x17d))[_0x3c0734(0x179)]('#DepartmentDDL');for(var _0x2ec483=0x0;_0x2ec483<_0x5de51b['d'][_0x3c0734(0x143)]['length'];_0x2ec483++){$(_0x3c0734(0x145))[_0x3c0734(0x110)](_0x3c0734(0x114)+_0x5de51b['d'][_0x3c0734(0x143)][_0x2ec483]['ID']+'\x22>'+_0x5de51b['d'][_0x3c0734(0x143)][_0x2ec483][_0x3c0734(0x12b)]+_0x3c0734(0x15a));}},'myError':function(_0x21fe33){}});}var TotalOfficeDays=0x0,GtotalHolidays=0x0;function LoadAllHolidays(){var _0x3c9ee3=_0x34cc20,_0x56b022=$(_0x3c9ee3(0x16e))[_0x3c9ee3(0x11a)]();TotalOfficeDays=0x0,GtotalHolidays=0x0;var _0x11cbf1=new Date(ConvertDateTimeFormat($('#attendance-reportFrom')[_0x3c9ee3(0x11a)](),'/')),_0x8ea71e=_0x11cbf1[_0x3c9ee3(0xe7)]()+'-'+(_0x11cbf1['getMonth']()+0x1)+'-'+_0x11cbf1[_0x3c9ee3(0xec)](),_0x143ebe=new Date(ConvertDateTimeFormat($(_0x3c9ee3(0x19e))[_0x3c9ee3(0x11a)](),'/')),_0x5ef623=_0x143ebe[_0x3c9ee3(0xe7)]()+'-'+(_0x143ebe[_0x3c9ee3(0x166)]()+0x1)+'-'+_0x143ebe[_0x3c9ee3(0xec)](),_0x54817d=_spPageContextInfo[_0x3c9ee3(0x1a4)]+_0x3c9ee3(0x15e)+_0x56b022+_0x3c9ee3(0x15b)+GCompanyId+'\x27\x20and\x20Holiday_start\x20ge\x20\x27'+_0x8ea71e+_0x3c9ee3(0x10b)+_0x5ef623+'\x27';$[_0x3c9ee3(0x16c)]({'url':_0x54817d,'headers':{'Accept':_0x3c9ee3(0x105)},'async':![],'success':function(_0x4ef269){var _0x45e73e=_0x3c9ee3,_0x214ba2=_0x4ef269['d'][_0x45e73e(0x143)]['length'];GtotalHolidays=_0x214ba2,$(_0x45e73e(0x125))[_0x45e73e(0x13d)](_0x214ba2),$('#TotalOfficeDays')[_0x45e73e(0x13d)](parseInt(GOfficeDays)-parseInt(_0x214ba2)),TotalOfficeDays=parseInt(GOfficeDays)-parseInt(_0x214ba2);},'myError':function(_0x120165){}});}function Applyfilter(){var _0x35fd74=_0x34cc20;$('#FromDate')[_0x35fd74(0x13d)](formatDateReport(ConvertDateTimeFormat($(_0x35fd74(0x159))['val'](),'/'))),$(_0x35fd74(0x16f))[_0x35fd74(0x13d)](formatDateReport(ConvertDateTimeFormat($(_0x35fd74(0x19e))[_0x35fd74(0x11a)](),'/'))),$(_0x35fd74(0x191))['text']($(_0x35fd74(0x111))['text']()),$(_0x35fd74(0x184))[_0x35fd74(0x13d)](formatDateReport(ConvertDateTimeFormat($(_0x35fd74(0x159))[_0x35fd74(0x11a)](),'/'))),$(_0x35fd74(0x170))[_0x35fd74(0x13d)](formatDateReport(ConvertDateTimeFormat($(_0x35fd74(0x19e))[_0x35fd74(0x11a)](),'/'))),$(_0x35fd74(0x12e))[_0x35fd74(0x13d)]($(_0x35fd74(0x111))[_0x35fd74(0x13d)]()),$(_0x35fd74(0x194))['text'](TotalOfficeDays),$(_0x35fd74(0x187))[_0x35fd74(0x13d)](GtotalHolidays);var _0x5780cd=$(_0x35fd74(0x159))['datepicker'](_0x35fd74(0xec)),_0x340a97=$(_0x35fd74(0x19e))['datepicker'](_0x35fd74(0xec));days=(_0x340a97-_0x5780cd)/(0x3e8*0x3c*0x3c*0x18),GOfficeDays=Math[_0x35fd74(0x156)](days)+0x1,LoadAllHolidays(),$(_0x35fd74(0x131))[_0x35fd74(0x11a)]('');var _0x9c78c4=$(_0x35fd74(0x159))[_0x35fd74(0x11a)](),_0x725d2e=moment($('#attendance-reportFrom')[_0x35fd74(0x11a)](),'DD/MM/YYYY')['format'](_0x35fd74(0x171)),_0x1b8680=moment($(_0x35fd74(0x19e))[_0x35fd74(0x11a)](),_0x35fd74(0xf3))['format'](_0x35fd74(0x171));$(_0x35fd74(0xf2))[_0x35fd74(0x13d)]($[_0x35fd74(0x14a)][_0x35fd74(0x138)](_0x35fd74(0x19b),new Date(_0x725d2e))),$('#monthhyear')[_0x35fd74(0x13d)]($['datepicker'][_0x35fd74(0x138)]('M\x20\x20yy',new Date(_0x725d2e)));var _0x5734fb='',_0x2f87a4='';$(_0x35fd74(0x16e))['val']()!=_0x35fd74(0x199)&&(_0x5734fb+=_0x35fd74(0x188)+$(_0x35fd74(0x16e))['val']()+'\x27\x20',_0x2f87a4+=_0x35fd74(0xeb)+$(_0x35fd74(0x111))['text']()+'</div>');$(_0x35fd74(0x145))[_0x35fd74(0x11a)]()!='All'&&(_0x5734fb+=_0x35fd74(0x11c)+$(_0x35fd74(0x145))['val']()+'\x27\x20',_0x2f87a4+=_0x35fd74(0xeb)+$(_0x35fd74(0xfd))[_0x35fd74(0x13d)]()+_0x35fd74(0xf6));var _0x366e58=ensureUser($('#Manager')['children']()['children']()[_0x35fd74(0x17a)]('id')),_0x2c0789=ensureUser($(_0x35fd74(0x160))[_0x35fd74(0x113)]()[_0x35fd74(0x113)]()['attr']('id'));_0x366e58!=0x0&&(_0x5734fb+=_0x35fd74(0x186)+_0x366e58+'\x27\x20',_0x2f87a4+=_0x35fd74(0xeb)+GetUserTitle($(_0x35fd74(0x18e))[_0x35fd74(0x113)]()[_0x35fd74(0x113)]()[_0x35fd74(0x17a)]('id'))+_0x35fd74(0xf6)),_0x2c0789!=0x0&&(_0x5734fb+=_0x35fd74(0x16a)+_0x2c0789+'\x27\x20',_0x2f87a4+=_0x35fd74(0xeb)+GetUserTitle($('#Employee')[_0x35fd74(0x113)]()['children']()['attr']('id'))+_0x35fd74(0xf6)),$(_0x35fd74(0xf9))[_0x35fd74(0x185)](),$(_0x35fd74(0xf9))[_0x35fd74(0x110)](_0x2f87a4),$(_0x35fd74(0x148))['fadeIn'](),setTimeout(function(){var _0x5306c6=_0x35fd74,_0x1029d3=_spPageContextInfo[_0x5306c6(0x1a4)]+_0x5306c6(0x192)+_0x725d2e+'\x27\x20and\x20AttendanceDate\x20le\x20\x27'+_0x1b8680+'\x27\x20';$['when'](getFileData(_0x1029d3))[_0x5306c6(0x17e)](function(_0x545e8b){var _0x346e28=_0x5306c6,_0x4fc189=_spPageContextInfo[_0x346e28(0x1a4)]+_0x346e28(0x197)+GCompanyId+'\x27'+_0x5734fb;EmployeeListDat(_0x4fc189),$(_0x346e28(0x148))[_0x346e28(0x163)]();});},0x5dc);}function _0x2cfa(_0x15054b,_0x566287){var _0x1dbee2=_0x1dbe();return _0x2cfa=function(_0x2cfa7c,_0x51f16b){_0x2cfa7c=_0x2cfa7c-0xe6;var _0xecd05d=_0x1dbee2[_0x2cfa7c];return _0xecd05d;},_0x2cfa(_0x15054b,_0x566287);}var TempStore=[],unique='';function getFileData(_0x459f99){var _0x59e58d=_0x34cc20;jQuery[_0x59e58d(0x16c)]({'url':_0x459f99,'headers':{'Accept':_0x59e58d(0x105)},'async':![],'success':function(_0xa7ee63){var _0xe9658d=_0x59e58d;EmpAttendanceData=[];var _0x49adcb=_0xa7ee63['d']['results'];if(_0x49adcb['length']>0x0){TempStore=[];for(var _0x3925e2=0x0;_0x3925e2<_0x49adcb[_0xe9658d(0x104)];_0x3925e2++){TempStore[_0xe9658d(0x14e)](_0x49adcb[_0x3925e2][_0xe9658d(0x175)]['ID']);}unique=TempStore[_0xe9658d(0x14b)](function(_0x4d1a47,_0x373859,_0x447b92){var _0x15168a=_0xe9658d;return _0x373859==_0x447b92[_0x15168a(0x140)](_0x4d1a47);});if(unique[_0xe9658d(0x104)]>0x0){EmpAttendanceData=[];for(var _0x354b43=0x0;_0x354b43<unique[_0xe9658d(0x104)];_0x354b43++){var _0x39cb08=0x0,_0x4011df=[],_0x3fd3be=[],_0x2b0627=moment($('#attendance-reportFrom')[_0xe9658d(0x11a)](),_0xe9658d(0xf3))[_0xe9658d(0xfc)]('YYYY-MM-DD'),_0x1d4a6b=moment($(_0xe9658d(0x19e))[_0xe9658d(0x11a)](),_0xe9658d(0xf3))[_0xe9658d(0xfc)]('YYYY-MM-DD'),_0x3fd122=unique[_0x354b43],_0xb7acc0=_spPageContextInfo[_0xe9658d(0x1a4)]+_0xe9658d(0x192)+_0x2b0627+_0xe9658d(0x18a)+_0x1d4a6b+_0xe9658d(0x19c)+_0x3fd122+'\x27\x20';jQuery['ajax']({'url':_0xb7acc0,'headers':{'Accept':_0xe9658d(0x105)},'async':![],'success':function(_0x213804){var _0x3587c6=_0xe9658d,_0x44addf=_0x213804['d'][_0x3587c6(0x143)];if(_0x44addf[_0x3587c6(0x104)]>0x0){for(var _0x42fbce=0x0;_0x42fbce<_0x44addf[_0x3587c6(0x104)];_0x42fbce++){var _0x3e3dc7=_0x44addf[_0x42fbce]['ID'],_0x51ed7e=_0x44addf[_0x42fbce][_0x3587c6(0x175)][_0x3587c6(0x12b)],_0x372598=_0x44addf[_0x42fbce]['Employee']['ID'],_0x3dd38f=_0x44addf[_0x42fbce][_0x3587c6(0x198)],_0x157b91=_0x44addf[_0x42fbce][_0x3587c6(0x1b7)];if(_0x157b91==_0x3587c6(0x177)||_0x157b91==_0x3587c6(0x1a0)||_0x157b91==_0x3587c6(0x162))_0x4011df[_0x3587c6(0x14e)](_0x157b91);else _0x157b91==_0x3587c6(0x18c)&&_0x3fd3be[_0x3587c6(0x14e)](_0x157b91);_0x44addf[_0x42fbce][_0x3587c6(0xfe)]!=null&&(_0x39cb08=parseInt(_0x39cb08)+parseInt(_0x44addf[_0x42fbce][_0x3587c6(0xfe)]));var _0x5122e8=_0x44addf[_0x42fbce][_0x3587c6(0x178)],_0x3097d6=parseInt(_0x4011df[_0x3587c6(0x104)])+parseInt(_0x3fd3be[_0x3587c6(0x104)]),_0x28b0ee=parseInt(TotalOfficeDays)-parseInt(_0x3097d6);_0x28b0ee<0x0&&(_0x28b0ee=0x0);}var _0x53c839=Math[_0x3587c6(0x156)](parseInt(_0x3097d6)/parseInt(TotalOfficeDays)*0x64)+'%';TotalOfficeDays=='0'&&(_0x53c839='-'),EmpAttendanceData['push']({'UserId':_0x372598,'EmpName':_0x51ed7e,'AttendanceDate':_0x3dd38f,'AttendanceType':_0x157b91,'AttendanceItemId':_0x3e3dc7,'EmpWorkHours':_0x39cb08,'HrAction':_0x5122e8,'AttendancDays':_0x4011df[_0x3587c6(0x104)],'LeavesDay':_0x3fd3be[_0x3587c6(0x104)],'NotActionDays':_0x28b0ee,'percentage':_0x53c839});}},'error':function(_0x3a41e8,_0x5dd503){var _0x41128f=_0xe9658d;console[_0x41128f(0x135)](JSON['stringify'](_0x3a41e8));}});}}}},'error':function(_0x50964c,_0x5b8b14,_0x19b80c){var _0x421221=_0x59e58d;console[_0x421221(0x135)](_0x421221(0x116)),console['log'](_0x50964c['responseJSON'][_0x421221(0x102)][_0x421221(0xfb)][_0x421221(0x195)]);var _0x1f319b=_0x50964c['responseJSON']['error'][_0x421221(0xfb)]['value'],_0x5d1e03=_0x1f319b[_0x421221(0x1a2)](_0x421221(0x141));_0x5d1e03==!![]&&(AttendanceReportUsageData=[],AttendanceReportUsageUrl=_spPageContextInfo['webAbsoluteUrl']+_0x421221(0x1a9),ReadEmpReportUsageData());}});}var AttendanceReportUsageData=AttendanceReportUsageData||[],AttendanceReportUsageUrl='';function _0x1dbe(){var _0x19138a=['Reptotalpages','<tr\x20class=\x27text-center\x27>','-7d','LogonName','append','#OfficeLoc\x20option:selected','Apr','children','<option\x20value=\x22','Jul','Error\x20in\x20getFileData.','location','Sept','NotActionDays','val','LeavesDay','and\x20Department\x20eq\x20\x27','#__REQUESTDIGEST','&end=','Oct','Key','/Pages/Myworkplace.aspx?WebAppId=232SHDFGHJF22B2526DFG','POST','grep','Attendance\x20Entry','#TotalHolidays','May','application/json;\x20odata=verbose','btoa','getElementById','1130JtuSji','Title','SPClientPeoplePicker_InitStandaloneControlWrapper','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>-</div></td>','#officeLocTH','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>','Aug','#attendencedateValue','UserId','/_api/web/ensureuser','Feb','log','selectedrow','blue','formatDate','PrincipalAccountType','pagedropdown','Repcurrentpage','Manager','text','__next','117bEOlgL','indexOf','it\x20exceeds\x20the\x20list\x20view\x20threshold','show','results','122695INgTkn','#DepartmentDDL','black','getQueryStringParameter','#overlaysearch','Department','datepicker','filter','Holiday','hide','push','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27><a\x20href=\x27','\x27\x20class=\x27custom-edit-btn\x27><i\x20class=\x27fa\x20fa-chevron-right\x27></i></a></div></td>','62432nzFBnj','ReportTableData','</div></td>','data:application/vnd.ms-excel;base64,','#TotalItemscount','round','desc','SPClientPeoplePickerDict','#attendance-reportFrom','</option>','\x27\x20and\x20CompanyID\x20eq\x20\x27','5409ESBIWx','Jun','/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?select=*,ID,Title&$filter=OfficeLocationID\x20eq\x20\x27','#ReportTable','#Employee','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>00:00</div></td>','2nd\x20Half','fadeOut','00:00\x20(H:M)','Repstartrecord','getMonth','/Pages/EmployeeReport.aspx?EID=','Active','2RQegTe','and\x20LogonName/ID\x20eq\x20\x27','#FromDate','ajax','checked','#OfficeLoc','#ToDate','#EdateTH','YYYY-MM-DD','setDate','</tr>','MM/DD/YYYY','Employee','<html\x20xmlns:o=\x22urn:schemas-microsoft-com:office:office\x22\x20xmlns:x=\x22urn:schemas-microsoft-com:office:excel\x22\x20xmlns=\x22http://www.w3.org/TR/REC-html40\x22><head><!--[if\x20gte\x20mso\x209]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>','Full\x20Day','HrAction','appendTo','attr','<br\x20/>Please\x20wait!!','587436dgdzxX','<option\x20value=\x22All\x22>All</option>','done','ResolvePrincipalSource','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27>','modal','.NoRecordFound','&start=','#FdateTH','empty','and\x20ManagerLoginName\x20eq\x20\x27','#HolidaysTH','and\x20OfficeLocation\x20eq\x20\x27','userDisplayName','\x27\x20and\x20AttendanceDate\x20le\x20\x27','27819faxLll','On\x20Leave','asc','#Manager','stringify','Loading...','#SelectedLocation','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27','516282YSWbJJ','#TotalWorkdayTH','value','GetAllUserInfo','/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,ManagerLoginName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,ManagerLoginName,OfficeLocation,Company,Department&$filter=Status\x20eq\x20\x27Active\x27\x20and\x20Company/ID\x20\x20eq\x20\x27','AttendanceDate','All','/_api/web/lists/getbytitle(\x27EnvironmentalSettings\x27)/items?$select=Title,Active,ListOfUsers/Title&$filter=Title\x20eq\x20\x27Attendance\x20Entry\x27\x20&$expand=ListOfUsers/Id','D,\x20dd','\x27\x20and\x20Employee\x20eq\x20\x27','tablenav','#attendance-reportTo','percentage','1st\x20Half','evenrow','includes','#totalemp','webAbsoluteUrl','SearchPrincipalSource','15spImne','/_api/web/lists/GetByTitle(\x27OfficeLocation\x27)/items?$select=ID,OfficeName,CompanyID/ID&$expand=CompanyID&$top=5000&$filter=CompanyID/ID\x20eq\x20\x27','nodeType','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000','join','AttendancDays','Reptotalrecords','oddrow','\x27&$orderby=Title\x20asc&$top=5000','SPClientPeoplePicker','#ReportTableData>tbody\x20>tr','concat','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>0</div></td>','map','values','getTime','split','AttendanceType','Designation','AuthorId','getFullYear','evenselected','Jan','&WebAppId=','<div\x20class=\x27upload-chip\x27>','getDate','href','sorter','userId','1384607xHzzYK','promise','#daydate','DD/MM/YYYY','CompanyId','AttendanceItemId','</div>','table','showWaitScreenWithNoClose','#chips','ready','message','format','#DepartmentDDL\x20option:selected','WorkHours','\x27&$orderby=OfficeName\x20asc','EmpWorkHours','#attendance-report-filter','error','replace','length','application/json;odata=verbose','Worksheet','floor','Deferred','AllowMultipleValues','GET','\x27\x20and\x20Holiday_start\x20le\x20\x27'];_0x1dbe=function(){return _0x19138a;};return _0x1dbe();}function ReadEmpReportUsageData(){var _0x5f0e6a=_0x34cc20;return dfds=$[_0x5f0e6a(0x108)](),$[_0x5f0e6a(0x16c)]({'url':AttendanceReportUsageUrl,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x2e8ce5){var _0x576004=_0x5f0e6a;FilterState=0x0,AttendanceReportUsageData=AttendanceReportUsageData[_0x576004(0x1b1)](_0x2e8ce5['d'][_0x576004(0x143)]);if(_0x2e8ce5['d']['__next'])AttendanceReportUsageUrl=_0x2e8ce5['d'][_0x576004(0x13e)],ReadEmpReportUsageData();else{if(AttendanceReportUsageData['length']>0x0){var _0xc2138d=moment(ConvertDateTimeFormat($(_0x576004(0x159))[_0x576004(0x11a)](),'/'))[_0x576004(0xfc)](_0x576004(0x174)),_0x2bcbd9=moment(ConvertDateTimeFormat($('#attendance-reportTo')[_0x576004(0x11a)](),'/'))[_0x576004(0xfc)](_0x576004(0x174)),_0x85e44c=AttendanceReportUsageData['filter'](function(_0x255137){var _0x1a8cca=_0x576004;return Created=moment(_0x255137[_0x1a8cca(0x198)])[_0x1a8cca(0xfc)](_0x1a8cca(0x174)),(_0xc2138d==''?Created!='':Created>=_0xc2138d)&&(_0x2bcbd9==''?Created!='':Created<=_0x2bcbd9);});AttendanceReportUsageData=_0x85e44c;var _0x3c4911=[...new Map(AttendanceReportUsageData[_0x576004(0x1b3)](_0x517b37=>[_0x517b37[_0x576004(0xe6)],_0x517b37]))[_0x576004(0x1b4)]()];TempStore=[];for(var _0x23b91f=0x0;_0x23b91f<AttendanceReportUsageData[_0x576004(0x104)];_0x23b91f++){TempStore[_0x576004(0x14e)](AttendanceReportUsageData[_0x23b91f][_0x576004(0x175)]['ID']);}unique=TempStore[_0x576004(0x14b)](function(_0x44163c,_0x5b6c45,_0x4a85e5){var _0x2f7ffa=_0x576004;return _0x5b6c45==_0x4a85e5[_0x2f7ffa(0x140)](_0x44163c);});if(unique[_0x576004(0x104)]>0x0){EmpAttendanceData=[];for(var _0x468394=0x0;_0x468394<unique['length'];_0x468394++){var _0x2d0f02=0x0,_0x21c878=[],_0xd16660=[],_0x4720eb=moment($(_0x576004(0x159))[_0x576004(0x11a)](),'DD/MM/YYYY')[_0x576004(0xfc)](_0x576004(0x171)),_0x5278e1=moment($(_0x576004(0x19e))[_0x576004(0x11a)](),'DD/MM/YYYY')[_0x576004(0xfc)](_0x576004(0x171)),_0x90609d=unique[_0x468394],_0x18088c=$[_0x576004(0x123)](AttendanceReportUsageData,function(_0x58a968){var _0x4bc425=_0x576004;return _0x58a968[_0x4bc425(0x175)]['ID']==_0x90609d;}),_0x14c859=_0x18088c;if(_0x14c859[_0x576004(0x104)]>0x0){for(var _0x584fa7=0x0;_0x584fa7<_0x14c859[_0x576004(0x104)];_0x584fa7++){var _0x28baa5=_0x14c859[_0x584fa7]['ID'],_0x30761b=_0x14c859[_0x584fa7][_0x576004(0x175)][_0x576004(0x12b)],_0x334290=_0x14c859[_0x584fa7]['Employee']['ID'],_0x249839=_0x14c859[_0x584fa7]['AttendanceDate'],_0x1482f5=_0x14c859[_0x584fa7][_0x576004(0x1b7)];if(_0x1482f5==_0x576004(0x177)||_0x1482f5==_0x576004(0x1a0)||_0x1482f5==_0x576004(0x162))_0x21c878[_0x576004(0x14e)](_0x1482f5);else _0x1482f5=='On\x20Leave'&&_0xd16660[_0x576004(0x14e)](_0x1482f5);_0x14c859[_0x584fa7][_0x576004(0xfe)]!=null&&(_0x2d0f02=parseInt(_0x2d0f02)+parseInt(_0x14c859[_0x584fa7]['WorkHours']));var _0x1a46f4=_0x14c859[_0x584fa7][_0x576004(0x178)],_0x225159=parseInt(_0x21c878[_0x576004(0x104)])+parseInt(_0xd16660[_0x576004(0x104)]),_0x49c7f1=parseInt(TotalOfficeDays)-parseInt(_0x225159);_0x49c7f1<0x0&&(_0x49c7f1=0x0);}var _0x3d34d1=Math['round'](parseInt(_0x225159)/parseInt(TotalOfficeDays)*0x64)+'%';TotalOfficeDays=='0'&&(_0x3d34d1='-'),EmpAttendanceData['push']({'UserId':_0x334290,'EmpName':_0x30761b,'AttendanceDate':_0x249839,'AttendanceType':_0x1482f5,'AttendanceItemId':_0x28baa5,'EmpWorkHours':_0x2d0f02,'HrAction':_0x1a46f4,'AttendancDays':_0x21c878['length'],'LeavesDay':_0xd16660[_0x576004(0x104)],'NotActionDays':_0x49c7f1,'percentage':_0x3d34d1});}}}}}},'error':function(_0x4603cf,_0x235dc6,_0x29774f){}}),dfds[_0x5f0e6a(0xf1)]();}function OpenMyCustomLoader(){var _0x5d1f2b=_0x34cc20,_0x2441da=_0x5d1f2b(0x190),_0x57715e=_0x5d1f2b(0x17b),_0x21d891=0xc8,_0x25afb9=0x190;currentDlg=SP['UI']['ModalDialog'][_0x5d1f2b(0xf8)](_0x2441da,_0x57715e,_0x21d891,_0x25afb9);}function CloseMyCustomLoader(){currentDlg['close']();}function EmployeeListDat(_0x412826){var _0xae857d=_0x34cc20;$[_0xae857d(0x16c)]({'url':_0x412826,'headers':{'Accept':_0xae857d(0x105)},'async':![],'success':function(_0x35310d){var _0x440ca4=_0xae857d,_0x33eed6=_0x35310d['d']['results'];$(_0x440ca4(0x15f))[_0x440ca4(0x185)]();var _0x54b6c2='';if(_0x33eed6[_0x440ca4(0x104)]>0x0){var _0x2d8fa0=0x0,_0x2a723e=0x0,_0x4fdeef=0x0;for(var _0x51ae4b=0x0;_0x51ae4b<_0x33eed6['length'];_0x51ae4b++){var _0x2e577f=_0x33eed6[_0x51ae4b]['ID'],_0x2705bc=_0x33eed6[_0x51ae4b][_0x440ca4(0x10f)]['ID'],_0x14bb92=_0x33eed6[_0x51ae4b][_0x440ca4(0x10f)][_0x440ca4(0x12b)],_0x5846d8=_0x33eed6[_0x51ae4b][_0x440ca4(0x1b8)],_0x473b12=_0x33eed6[_0x51ae4b][_0x440ca4(0x149)]['DepartmentName'],_0x5946eb=_0x33eed6[_0x51ae4b]['ManagerLoginName'][_0x440ca4(0x12b)];_0x5946eb==undefined&&(_0x5946eb='');var _0x4fd9b9=_0x440ca4(0x164),_0x3081de='',_0x57be6b=_0x440ca4(0x146);_0x5846d8==null&&(_0x5846d8='');var _0x36f220=_0x33eed6[_0x51ae4b]['OfficeLocation']['OfficeName'];_0x36f220==null&&(_0x36f220='');EmployeeId=_0x33eed6[_0x51ae4b][_0x440ca4(0x10f)]['ID'];var _0xddf0de=moment($('#attendance-reportFrom')[_0x440ca4(0x11a)](),_0x440ca4(0xf3))[_0x440ca4(0xfc)]('YYYY-MM-DD'),_0x1bf16e=moment($(_0x440ca4(0x19e))['val'](),'DD/MM/YYYY')[_0x440ca4(0xfc)]('YYYY-MM-DD'),_0xddf0de=_0xddf0de['split']('-')[_0x440ca4(0x1aa)](''),_0x1bf16e=_0x1bf16e[_0x440ca4(0x1b6)]('-')[_0x440ca4(0x1aa)](''),_0x5c2876=_spPageContextInfo['webServerRelativeUrl']+_0x440ca4(0x167)+_0x2705bc+_0x440ca4(0x183)+_0xddf0de+_0x440ca4(0x11e)+_0x1bf16e+_0x440ca4(0xea)+titanForWork[_0x440ca4(0x147)](_0x440ca4(0xf4))+'&sourcelocation=../Pages/Report.aspx#',_0x569ca9=EmpAttendanceData[_0x440ca4(0x1b3)](function(_0x190266){return _0x190266['UserId'];})[_0x440ca4(0x140)](EmployeeId);if(_0x569ca9!=-0x1){var _0xc4cdb=EmpAttendanceData[_0x569ca9][_0x440ca4(0x132)],_0x1bfffb=EmpAttendanceData[_0x569ca9][_0x440ca4(0x1b7)],_0x191665=EmpAttendanceData[_0x569ca9][_0x440ca4(0xf5)];_0x4fd9b9=EmpAttendanceData[_0x569ca9][_0x440ca4(0x100)];var _0x3ebbdf=EmpAttendanceData[_0x569ca9]['EmpWorkHours'];_0x3081de=EmpAttendanceData[_0x569ca9][_0x440ca4(0xf5)];var _0x17916c=EmpAttendanceData[_0x569ca9][_0x440ca4(0x1ab)],_0xb0e021=EmpAttendanceData[_0x569ca9][_0x440ca4(0x11b)],_0x6a580f=EmpAttendanceData[_0x569ca9][_0x440ca4(0x119)],_0x34cf1b=EmpAttendanceData[_0x569ca9][_0x440ca4(0x19f)],_0x301885='';EmpAttendanceData[_0x569ca9][_0x440ca4(0x178)]==!![]?_0x301885=_0x440ca4(0x16d):_0x301885='',_0x4fd9b9==null&&(_0x4fd9b9='00:00\x20(H:M)'),_0x1bfffb==_0x440ca4(0x18c)&&(_0x57be6b='red',_0x4fdeef++),_0x1bfffb==_0x440ca4(0x14c)&&(_0x57be6b=_0x440ca4(0x137)),_0x54b6c2+=_0x440ca4(0x10d),_0x54b6c2+=_0x440ca4(0x180)+_0x14bb92+_0x440ca4(0x153),_0x54b6c2+=_0x440ca4(0x180)+_0x5846d8+_0x440ca4(0x153),_0x54b6c2+=_0x440ca4(0x12f)+_0x473b12+_0x440ca4(0x153),_0x54b6c2+=_0x440ca4(0x180)+_0x5946eb+'</div></td>',_0x54b6c2+=_0x440ca4(0x12f)+_0x17916c+'</div></td>',_0x54b6c2+=_0x440ca4(0x12f)+_0x6a580f+'</div></td>',_0x54b6c2+=_0x440ca4(0x12f)+_0xb0e021+_0x440ca4(0x153),_0x54b6c2+=_0x440ca4(0x12f)+ConvertHHMM(_0x4fd9b9)+'</div></td>',_0x54b6c2+=_0x440ca4(0x12f)+_0x34cf1b+_0x440ca4(0x153),_0x54b6c2+=_0x440ca4(0x14f)+_0x5c2876+_0x440ca4(0x150),_0x54b6c2+='</tr>';}else _0x54b6c2+=_0x440ca4(0x10d),_0x54b6c2+=_0x440ca4(0x180)+_0x14bb92+'</div></td>',_0x54b6c2+=_0x440ca4(0x180)+_0x5846d8+_0x440ca4(0x153),_0x54b6c2+=_0x440ca4(0x12f)+_0x473b12+'</div></td>',_0x54b6c2+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x5946eb+_0x440ca4(0x153),_0x54b6c2+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>0</div></td>',_0x54b6c2+=_0x440ca4(0x12f)+TotalOfficeDays+_0x440ca4(0x153),_0x54b6c2+=_0x440ca4(0x1b2),_0x54b6c2+=_0x440ca4(0x161),_0x54b6c2+=_0x440ca4(0x12d),_0x54b6c2+=_0x440ca4(0x14f)+_0x5c2876+'\x27\x20class=\x27custom-edit-btn\x27><i\x20class=\x27fa\x20fa-chevron-right\x27></i></a></div></td>',_0x54b6c2+=_0x440ca4(0x173);}}else{}_0x33eed6['length']==0x0?$(_0x440ca4(0x182))['show']():$('.NoRecordFound')[_0x440ca4(0x14d)]();$('#ReportTable')[_0x440ca4(0x110)](_0x54b6c2);var _0x5dfd08=$(_0x440ca4(0x1b0))[_0x440ca4(0x104)];$(_0x440ca4(0x155))['text'](_0x5dfd08),$(_0x440ca4(0x1a3))['text'](_0x5dfd08),_0x5dfd08>0x0&&ReportTableConfiguration();},'error':function(_0x1b5790){var _0x1db8fe=_0xae857d;console[_0x1db8fe(0x135)](_0x1b5790);}});}function ReportTableConfiguration(){var _0x2302cb=_0x34cc20;sorter=new TINY[(_0x2302cb(0xf7))][(_0x2302cb(0xee))](_0x2302cb(0xee),_0x2302cb(0x152),{'ascclass':_0x2302cb(0x18d),'descclass':_0x2302cb(0x157),'evenclass':_0x2302cb(0x1a1),'oddclass':_0x2302cb(0x1ad),'evenselclass':_0x2302cb(0xe8),'oddselclass':'oddselected','paginate':!![],'size':0xa,'colddid':'columns','currentid':_0x2302cb(0x13b),'totalid':_0x2302cb(0x10c),'startingrecid':_0x2302cb(0x165),'endingrecid':'Rependrecord','totalrecid':_0x2302cb(0x1ac),'hoverid':_0x2302cb(0x136),'pageddid':_0x2302cb(0x13a),'navid':_0x2302cb(0x19d),'sortdir':0x1,'init':!![]});}function ConvertHHMM(_0x55679c){var _0x1d25fe=_0x34cc20,_0x3c68d5=Math[_0x1d25fe(0x107)](_0x55679c/0x3c),_0x231d03=_0x55679c%0x3c;_0x3c68d5<0xa&&(_0x3c68d5='0'+_0x3c68d5);_0x231d03<0xa&&(_0x231d03='0'+_0x231d03);var _0x377215=_0x3c68d5+':'+_0x231d03;return _0x377215;}function CloseModel(){var _0x5752e0=_0x34cc20;initializePeoplePicker(_0x5752e0(0x13c)),initializePeoplePicker(_0x5752e0(0x175));}var tableToExcel=(function(){var _0x519dd0=_0x34cc20,_0xe283cd=_0x519dd0(0x154),_0x43945b=_0x519dd0(0x176),_0x4943c2=function(_0x12ffd8){var _0x1a1710=_0x519dd0;return window[_0x1a1710(0x128)](unescape(encodeURIComponent(_0x12ffd8)));},_0x39d7b4=function(_0x9d46ad,_0x540928){var _0x595a56=_0x519dd0;return _0x9d46ad[_0x595a56(0x103)](/{(\w+)}/g,function(_0x476edd,_0x1eb7f4){return _0x540928[_0x1eb7f4];});};return function(_0x5727e9,_0x284376){var _0xb4e824=_0x519dd0;if(!_0x5727e9[_0xb4e824(0x1a8)])_0x5727e9=document[_0xb4e824(0x129)](_0x5727e9);var _0x553e99={'worksheet':_0x284376||_0xb4e824(0x106),'table':_0x5727e9['innerHTML']};window[_0xb4e824(0x117)][_0xb4e824(0xed)]=_0xe283cd+_0x4943c2(_0x39d7b4(_0x43945b,_0x553e99));};}()),authentication=function(){var _0xdbca88=_0x34cc20,_0x637932=_spPageContextInfo[_0xdbca88(0x189)],_0x23a250=_spPageContextInfo[_0xdbca88(0x1a4)]+_0xdbca88(0x19a);$[_0xdbca88(0x16c)]({'url':_0x23a250,'async':![],'type':_0xdbca88(0x10a),'headers':{'accept':_0xdbca88(0x127)},'success':function(_0xae3a82){var _0x182d1f=_0xdbca88;debugger;var _0x287147=_0xae3a82['d'][_0x182d1f(0x143)];if(_0x287147['length']>0x0)for(var _0x41afcb=0x0;_0x41afcb<_0x287147[_0x182d1f(0x104)];_0x41afcb++){if(_0x287147[_0x41afcb][_0x182d1f(0x12b)]==_0x182d1f(0x124)){if(_0x287147[_0x41afcb][_0x182d1f(0x168)]==![])return alert('This\x20feature\x20has\x20been\x20deactivated\x20!'),window[_0x182d1f(0x117)]=_spPageContextInfo[_0x182d1f(0x1a4)]+_0x182d1f(0x121),![];}}},'error':function(_0xcb8c73){var _0x3f419f=_0xdbca88;alert(JSON[_0x3f419f(0x18f)](_0xcb8c73));}});};