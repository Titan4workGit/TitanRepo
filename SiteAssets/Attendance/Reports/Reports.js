var _0x59b5ec=_0x3a6f;(function(_0x8c85bd,_0x1cbdfa){var _0x5b84dc=_0x3a6f,_0x40844d=_0x8c85bd();while(!![]){try{var _0x33f042=-parseInt(_0x5b84dc(0x20f))/0x1+parseInt(_0x5b84dc(0x214))/0x2+-parseInt(_0x5b84dc(0x204))/0x3+-parseInt(_0x5b84dc(0x20d))/0x4+-parseInt(_0x5b84dc(0x241))/0x5*(-parseInt(_0x5b84dc(0x1e9))/0x6)+-parseInt(_0x5b84dc(0x1fc))/0x7*(parseInt(_0x5b84dc(0x275))/0x8)+-parseInt(_0x5b84dc(0x282))/0x9*(-parseInt(_0x5b84dc(0x227))/0xa);if(_0x33f042===_0x1cbdfa)break;else _0x40844d['push'](_0x40844d['shift']());}catch(_0x3fdf38){_0x40844d['push'](_0x40844d['shift']());}}}(_0x3c2c,0x4fa2f));var GCompanyId='',GOfficeDays='';$(document)[_0x59b5ec(0x2a2)](function(){var _0x2b5d05=_0x59b5ec;userActivityNotificationEntry(_spPageContextInfo[_0x2b5d05(0x2a0)],window[_0x2b5d05(0x276)]),authentication(),GCompanyId=titanForWork[_0x2b5d05(0x23b)](_0x2b5d05(0x218)),$('#attendance-reportTo')[_0x2b5d05(0x23c)]({'dateFormat':_0x2b5d05(0x273),'maxDate':new Date()})[_0x2b5d05(0x23c)](_0x2b5d05(0x20b),new Date()),$(_0x2b5d05(0x1f0))[_0x2b5d05(0x23c)]({'dateFormat':_0x2b5d05(0x273)})[_0x2b5d05(0x23c)]('setDate',_0x2b5d05(0x1ec)),$('#FromDate')[_0x2b5d05(0x231)](formatDateReport(ConvertDateTimeFormat($(_0x2b5d05(0x1f0))[_0x2b5d05(0x205)](),'/'))),$(_0x2b5d05(0x29a))[_0x2b5d05(0x231)](formatDateReport(ConvertDateTimeFormat($(_0x2b5d05(0x27c))[_0x2b5d05(0x205)](),'/')));var _0x334a2d=$(_0x2b5d05(0x1f0))['datepicker']('getDate'),_0x517f13=$(_0x2b5d05(0x27c))['datepicker'](_0x2b5d05(0x2ab));days=(_0x517f13-_0x334a2d)/(0x3e8*0x3c*0x3c*0x18);var _0x1820c8=Math[_0x2b5d05(0x25a)](days);GOfficeDays=Math[_0x2b5d05(0x25a)](days),LoadAllOfficeLocation(),LoadAllDepartment(),LoadAllHolidays(),$(_0x2b5d05(0x250))[_0x2b5d05(0x231)]($(_0x2b5d05(0x291))[_0x2b5d05(0x231)]()),initializePeoplePicker(_0x2b5d05(0x23e)),initializePeoplePicker(_0x2b5d05(0x1fd)),$(_0x2b5d05(0x22e))[_0x2b5d05(0x228)]('show');});function initializePeoplePicker(_0x39dceb){var _0x328b95=_0x59b5ec,_0x399285={};_0x399285[_0x328b95(0x1ed)]=_0x328b95(0x216),_0x399285[_0x328b95(0x26d)]=0xf,_0x399285[_0x328b95(0x1ee)]=0xf,_0x399285[_0x328b95(0x25e)]=![],_0x399285[_0x328b95(0x220)]=0x32,_0x399285[_0x328b95(0x219)]='280px',this[_0x328b95(0x20c)](_0x39dceb,null,_0x399285);}function ensureUser(_0xeed297){var _0x5448cb=_0x59b5ec,_0x37fa34=0x0,_0x2c35da=_0xeed297,_0x1c45bc=this[_0x5448cb(0x261)][_0x5448cb(0x272)][_0x2c35da],_0x22c2b7=_0x1c45bc[_0x5448cb(0x256)](),_0x5a65c6=_0x22c2b7[0x0];if(_0x5a65c6){var _0x40f0f9={'logonName':_0x5a65c6[_0x5448cb(0x281)]};$[_0x5448cb(0x28f)]({'url':_spPageContextInfo[_0x5448cb(0x1eb)]+_0x5448cb(0x23d),'type':_0x5448cb(0x1ef),'async':![],'contentType':_0x5448cb(0x2ad),'data':JSON[_0x5448cb(0x249)](_0x40f0f9),'headers':{'X-RequestDigest':$(_0x5448cb(0x2a3))[_0x5448cb(0x205)](),'accept':_0x5448cb(0x2ad)},'success':function(_0x2fa91a,_0x40019f,_0x162b73){_0x37fa34=_0x2fa91a['d']['Id'];},'error':function(_0xf72462,_0xef8208,_0x223017){}});}else _0x37fa34=0x0;return _0x37fa34;}function GetUserTitle(_0x59b0a4){var _0x3d9d31=_0x59b5ec,_0x3fa536=0x0,_0x47fc08=_0x59b0a4,_0x44e2d2=this[_0x3d9d31(0x261)][_0x3d9d31(0x272)][_0x47fc08],_0x125951=_0x44e2d2['GetAllUserInfo'](),_0x1dafdc=_0x125951[0x0];if(_0x1dafdc){var _0x47e8a3={'logonName':_0x1dafdc[_0x3d9d31(0x281)]};$['ajax']({'url':_spPageContextInfo[_0x3d9d31(0x1eb)]+_0x3d9d31(0x23d),'type':_0x3d9d31(0x1ef),'async':![],'contentType':_0x3d9d31(0x2ad),'data':JSON[_0x3d9d31(0x249)](_0x47e8a3),'headers':{'X-RequestDigest':$(_0x3d9d31(0x2a3))[_0x3d9d31(0x205)](),'accept':_0x3d9d31(0x2ad)},'success':function(_0x448c9f,_0xb8fff3,_0x3c78f0){_0x3fa536=_0x448c9f['d']['Title'];},'error':function(_0x24bee8,_0x2b5d50,_0x1f8cf8){}});}else _0x3fa536=0x0;return _0x3fa536;}function ConvertDateTimeFormat(_0x144be5,_0x5f2de7){var _0x1e80c4=_0x59b5ec;return _0x144be5[_0x1e80c4(0x248)](_0x5f2de7)[0x1]+''+_0x5f2de7+''+_0x144be5[_0x1e80c4(0x248)](_0x5f2de7)[0x0]+''+_0x5f2de7+''+_0x144be5[_0x1e80c4(0x248)](_0x5f2de7)[0x2];}function formatDateReport(_0x49214a){var _0x5c3cac=_0x59b5ec,_0x5952c=new Date(_0x49214a);if(isNaN(_0x5952c[_0x5c3cac(0x26f)]()))return _0x49214a;else{var _0xa9b073=new Array();return _0xa9b073[0x0]=_0x5c3cac(0x277),_0xa9b073[0x1]=_0x5c3cac(0x217),_0xa9b073[0x2]=_0x5c3cac(0x25b),_0xa9b073[0x3]=_0x5c3cac(0x209),_0xa9b073[0x4]=_0x5c3cac(0x234),_0xa9b073[0x5]=_0x5c3cac(0x1ff),_0xa9b073[0x6]=_0x5c3cac(0x28c),_0xa9b073[0x7]=_0x5c3cac(0x223),_0xa9b073[0x8]=_0x5c3cac(0x28e),_0xa9b073[0x9]=_0x5c3cac(0x22b),_0xa9b073[0xa]=_0x5c3cac(0x271),_0xa9b073[0xb]=_0x5c3cac(0x29d),day=_0x5952c[_0x5c3cac(0x2ab)](),day<0xa&&(day='0'+day),day+'\x20'+_0xa9b073[_0x5952c['getMonth']()]+'\x20'+_0x5952c['getFullYear']();}}function LoadAllOfficeLocation(){var _0x3afae2=_0x59b5ec;$('#OfficeLoc')['empty']();var _0x347a57=_spPageContextInfo['webAbsoluteUrl']+_0x3afae2(0x299)+GCompanyId+_0x3afae2(0x210);$[_0x3afae2(0x28f)]({'url':_0x347a57,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x1d151a){var _0x4fc6cd=_0x3afae2;for(var _0x4360a5=0x0;_0x4360a5<_0x1d151a['d'][_0x4fc6cd(0x255)]['length'];_0x4360a5++){$('#OfficeLoc')[_0x4fc6cd(0x246)]('<option\x20value=\x22'+_0x1d151a['d'][_0x4fc6cd(0x255)][_0x4360a5]['ID']+'\x22>'+_0x1d151a['d']['results'][_0x4360a5][_0x4fc6cd(0x224)]+_0x4fc6cd(0x208));}},'myError':function(_0x343e29){}});}function LoadAllDepartment(){var _0x58db46=_0x59b5ec;$(_0x58db46(0x24e))[_0x58db46(0x27b)]();var _0x2c1038=_spPageContextInfo[_0x58db46(0x1eb)]+_0x58db46(0x1e8)+GCompanyId+'\x27&$orderby=Title\x20asc&$top=5000';$[_0x58db46(0x28f)]({'url':_0x2c1038,'headers':{'Accept':'application/json;odata=verbose'},'async':!![],'success':function(_0x46b5b1){var _0x190afc=_0x58db46;$(_0x190afc(0x289))[_0x190afc(0x1f1)](_0x190afc(0x24e));for(var _0x3eefde=0x0;_0x3eefde<_0x46b5b1['d'][_0x190afc(0x255)][_0x190afc(0x230)];_0x3eefde++){$(_0x190afc(0x24e))[_0x190afc(0x246)]('<option\x20value=\x22'+_0x46b5b1['d']['results'][_0x3eefde]['ID']+'\x22>'+_0x46b5b1['d'][_0x190afc(0x255)][_0x3eefde][_0x190afc(0x235)]+_0x190afc(0x208));}},'myError':function(_0x2ef676){}});}var TotalOfficeDays=0x0,GtotalHolidays=0x0;function LoadAllHolidays(){var _0x35c803=_0x59b5ec,_0x1c0a48=$(_0x35c803(0x296))['val']();TotalOfficeDays=0x0,GtotalHolidays=0x0;var _0xeb6054=new Date(ConvertDateTimeFormat($(_0x35c803(0x1f0))[_0x35c803(0x205)](),'/')),_0x4790cf=_0xeb6054['getFullYear']()+'-'+(_0xeb6054[_0x35c803(0x269)]()+0x1)+'-'+_0xeb6054[_0x35c803(0x2ab)](),_0x233708=new Date(ConvertDateTimeFormat($(_0x35c803(0x27c))[_0x35c803(0x205)](),'/')),_0x343e05=_0x233708[_0x35c803(0x207)]()+'-'+(_0x233708[_0x35c803(0x269)]()+0x1)+'-'+_0x233708[_0x35c803(0x2ab)](),_0x23a426=_spPageContextInfo[_0x35c803(0x1eb)]+_0x35c803(0x254)+_0x1c0a48+'\x27\x20and\x20CompanyID\x20eq\x20\x27'+GCompanyId+_0x35c803(0x245)+_0x4790cf+'\x27\x20and\x20Holiday_start\x20le\x20\x27'+_0x343e05+'\x27';$[_0x35c803(0x28f)]({'url':_0x23a426,'headers':{'Accept':_0x35c803(0x2ad)},'async':![],'success':function(_0xf9664d){var _0x4f2830=_0x35c803,_0xbbacd2=_0xf9664d['d'][_0x4f2830(0x255)][_0x4f2830(0x230)];GtotalHolidays=_0xbbacd2,$(_0x4f2830(0x22d))[_0x4f2830(0x231)](_0xbbacd2),$(_0x4f2830(0x29e))[_0x4f2830(0x231)](parseInt(GOfficeDays)-parseInt(_0xbbacd2)),TotalOfficeDays=parseInt(GOfficeDays)-parseInt(_0xbbacd2);},'myError':function(_0x2e000d){}});}function Applyfilter(){var _0x185463=_0x59b5ec;$(_0x185463(0x2aa))[_0x185463(0x231)](formatDateReport(ConvertDateTimeFormat($(_0x185463(0x1f0))[_0x185463(0x205)](),'/'))),$('#ToDate')[_0x185463(0x231)](formatDateReport(ConvertDateTimeFormat($('#attendance-reportTo')[_0x185463(0x205)](),'/'))),$('#SelectedLocation')[_0x185463(0x231)]($(_0x185463(0x291))['text']()),$('#FdateTH')['text'](formatDateReport(ConvertDateTimeFormat($('#attendance-reportFrom')['val'](),'/'))),$(_0x185463(0x1fe))[_0x185463(0x231)](formatDateReport(ConvertDateTimeFormat($(_0x185463(0x27c))[_0x185463(0x205)](),'/'))),$(_0x185463(0x26c))['text']($('#OfficeLoc\x20option:selected')[_0x185463(0x231)]()),$(_0x185463(0x232))['text'](TotalOfficeDays),$(_0x185463(0x23f))['text'](GtotalHolidays);var _0x45ad00=$(_0x185463(0x1f0))[_0x185463(0x23c)](_0x185463(0x2ab)),_0x28910f=$('#attendance-reportTo')[_0x185463(0x23c)](_0x185463(0x2ab));days=(_0x28910f-_0x45ad00)/(0x3e8*0x3c*0x3c*0x18),GOfficeDays=Math[_0x185463(0x25a)](days)+0x1,LoadAllHolidays(),$(_0x185463(0x1f9))[_0x185463(0x205)]('');var _0x2ff282=$(_0x185463(0x1f0))[_0x185463(0x205)](),_0x1d260f=moment($('#attendance-reportFrom')[_0x185463(0x205)](),_0x185463(0x21f))['format']('YYYY-MM-DD'),_0x1a03a5=moment($(_0x185463(0x27c))['val'](),_0x185463(0x21f))[_0x185463(0x267)](_0x185463(0x252));$(_0x185463(0x244))['text']($[_0x185463(0x23c)][_0x185463(0x22c)]('D,\x20dd',new Date(_0x1d260f))),$(_0x185463(0x286))[_0x185463(0x231)]($[_0x185463(0x23c)][_0x185463(0x22c)](_0x185463(0x26a),new Date(_0x1d260f)));var _0x1f7df1='',_0x2adea9='';$('#OfficeLoc')[_0x185463(0x205)]()!='All'&&(_0x1f7df1+=_0x185463(0x265)+$(_0x185463(0x296))[_0x185463(0x205)]()+'\x27\x20',_0x2adea9+=_0x185463(0x240)+$(_0x185463(0x291))['text']()+_0x185463(0x290));$(_0x185463(0x24e))['val']()!=_0x185463(0x29c)&&(_0x1f7df1+=_0x185463(0x29b)+$(_0x185463(0x24e))[_0x185463(0x205)]()+'\x27\x20',_0x2adea9+='<div\x20class=\x27upload-chip\x27>'+$(_0x185463(0x1fa))['text']()+_0x185463(0x290));var _0x9a35b6=ensureUser($(_0x185463(0x2a7))[_0x185463(0x20a)]()[_0x185463(0x20a)]()['attr']('id')),_0x158fe8=ensureUser($('#Employee')['children']()['children']()[_0x185463(0x287)]('id'));_0x9a35b6!=0x0&&(_0x1f7df1+=_0x185463(0x242)+_0x9a35b6+'\x27\x20',_0x2adea9+='<div\x20class=\x27upload-chip\x27>'+GetUserTitle($('#Manager')['children']()[_0x185463(0x20a)]()[_0x185463(0x287)]('id'))+_0x185463(0x290)),_0x158fe8!=0x0&&(_0x1f7df1+='and\x20LogonName/ID\x20eq\x20\x27'+_0x158fe8+'\x27\x20',_0x2adea9+='<div\x20class=\x27upload-chip\x27>'+GetUserTitle($(_0x185463(0x215))[_0x185463(0x20a)]()[_0x185463(0x20a)]()[_0x185463(0x287)]('id'))+_0x185463(0x290)),$('#chips')[_0x185463(0x27b)](),$(_0x185463(0x21e))[_0x185463(0x246)](_0x2adea9),$('#overlaysearch')['fadeIn'](),setTimeout(function(){var _0x43ad3d=_0x185463,_0x57ed7f=_spPageContextInfo[_0x43ad3d(0x1eb)]+_0x43ad3d(0x274)+_0x1d260f+'\x27\x20and\x20AttendanceDate\x20le\x20\x27'+_0x1a03a5+'\x27\x20';$[_0x43ad3d(0x259)](getFileData(_0x57ed7f))['done'](function(_0x3b9315){var _0x59619b=_0x43ad3d,_0x224d19=_spPageContextInfo[_0x59619b(0x1eb)]+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,ManagerLoginName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,ManagerLoginName,OfficeLocation,Company,Department&$filter=Status\x20eq\x20\x27Active\x27\x20and\x20Company/ID\x20\x20eq\x20\x27'+GCompanyId+'\x27'+_0x1f7df1;EmployeeListDat(_0x224d19),$(_0x59619b(0x221))[_0x59619b(0x212)]();});},0x5dc);}var TempStore=[],unique='';function _0x3c2c(){var _0x1d1c82=['POST','#attendance-reportFrom','appendTo','\x27\x20and\x20AttendanceDate\x20le\x20\x27','#ReportTable','data:application/vnd.ms-excel;base64,','Attendance\x20Entry','Holiday','indexOf','</tr>','#attendencedateValue','#DepartmentDDL\x20option:selected','WorkHours','896kbdhFz','Employee','#EdateTH','Jun','Error\x20in\x20getFileData.','Full\x20Day','MM/DD/YYYY','UserId','1513680AYglxq','val','nodeType','getFullYear','</option>','Apr','children','setDate','SPClientPeoplePicker_InitStandaloneControlWrapper','1366928FzqnjU','Designation','138212ZtyqsM','\x27&$orderby=OfficeName\x20asc','Active','fadeOut','Reptotalpages','1289704fvdPTk','#Employee','User,DL,SecGroup,SPGroup','Feb','CompanyId','Width','value','This\x20feature\x20has\x20been\x20deactivated\x20!','LogonName','columns','#chips','DD/MM/YYYY','MaximumEntitySuggestions','#overlaysearch','show','Aug','OfficeName','evenrow','EmpWorkHours','7390aoxbeb','modal','asc','.NoRecordFound','Oct','formatDate','#TotalHolidays','#attendance-report-filter','percentage','length','text','#TotalWorkdayTH','sorter','May','Title','getElementById','message','showWaitScreenWithNoClose','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>0</div></td>','HrAction','getQueryStringParameter','datepicker','/_api/web/ensureuser','Manager','#HolidaysTH','<div\x20class=\x27upload-chip\x27>','201210jqrJBq','and\x20ManagerLoginName\x20eq\x20\x27','Rependrecord','#daydate','\x27\x20and\x20Holiday_start\x20ge\x20\x27','append','AttendanceDate','split','stringify','</div></td>','grep','2nd\x20Half','#totalemp','#DepartmentDDL','&WebAppId=','#SelectedLocation','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27>','YYYY-MM-DD','checked','/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?select=*,ID,Title&$filter=OfficeLocationID\x20eq\x20\x27','results','GetAllUserInfo','table','Repstartrecord','when','round','Mar','close','responseJSON','AllowMultipleValues','/Pages/Myworkplace.aspx?WebAppId=232SHDFGHJF22B2526DFG','ManagerLoginName','SPClientPeoplePicker','AttendanceItemId','promise','Department','and\x20OfficeLocation\x20eq\x20\x27','DepartmentName','format','innerHTML','getMonth','M\x20\x20yy','log','#officeLocTH','SearchPrincipalSource','map','getTime','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>-</div></td>','Nov','SPClientPeoplePickerDict','dd/mm/yy','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27','11744SxhDwX','location','Jan','application/json;\x20odata=verbose','blue','btoa','empty','#attendance-reportTo','userDisplayName','On\x20Leave','red','replace','Key','7947EpcXvD','\x27\x20class=\x27custom-edit-btn\x27><i\x20class=\x27fa\x20fa-chevron-right\x27></i></a></div></td>','push','<tr\x20class=\x27text-center\x27>','#monthhyear','attr','1st\x20Half','<option\x20value=\x22All\x22>All</option>','AttendancDays','GET','Jul','it\x20exceeds\x20the\x20list\x20view\x20threshold','Sept','ajax','</div>','#OfficeLoc\x20option:selected','floor','00:00\x20(H:M)','Loading...','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>','#OfficeLoc','AuthorId','join','/_api/web/lists/GetByTitle(\x27OfficeLocation\x27)/items?$select=ID,OfficeName,CompanyID/ID&$expand=CompanyID&$top=5000&$filter=CompanyID/ID\x20eq\x20\x27','#ToDate','and\x20Department\x20eq\x20\x27','All','Dec','#TotalOfficeDays','webServerRelativeUrl','userId','__next','ready','#__REQUESTDIGEST','href','desc','&end=','#Manager','LeavesDay','hide','#FromDate','getDate','includes','application/json;odata=verbose','filter','AttendanceType','/_api/web/lists/getbytitle(\x27Departments\x27)/items?select=ID,Title&$filter=CompanyID\x20eq\x20\x27','30ggCrzr','evenselected','webAbsoluteUrl','-7d','PrincipalAccountType','ResolvePrincipalSource'];_0x3c2c=function(){return _0x1d1c82;};return _0x3c2c();}function getFileData(_0x4b5683){var _0x36e583=_0x59b5ec;jQuery[_0x36e583(0x28f)]({'url':_0x4b5683,'headers':{'Accept':_0x36e583(0x2ad)},'async':![],'success':function(_0x1b8efc){var _0x5b27a0=_0x36e583;EmpAttendanceData=[];var _0x27bf91=_0x1b8efc['d'][_0x5b27a0(0x255)];if(_0x27bf91[_0x5b27a0(0x230)]>0x0){TempStore=[];for(var _0x3e728f=0x0;_0x3e728f<_0x27bf91[_0x5b27a0(0x230)];_0x3e728f++){TempStore[_0x5b27a0(0x284)](_0x27bf91[_0x3e728f][_0x5b27a0(0x1fd)]['ID']);}unique=TempStore[_0x5b27a0(0x2ae)](function(_0x2261f4,_0x8b4acc,_0x25d112){var _0x30ea58=_0x5b27a0;return _0x8b4acc==_0x25d112[_0x30ea58(0x1f7)](_0x2261f4);});if(unique['length']>0x0){EmpAttendanceData=[];for(var _0x47dccb=0x0;_0x47dccb<unique[_0x5b27a0(0x230)];_0x47dccb++){var _0x47f892=0x0,_0x39f14d=[],_0x53c03b=[],_0x4f8b93=moment($(_0x5b27a0(0x1f0))[_0x5b27a0(0x205)](),_0x5b27a0(0x21f))[_0x5b27a0(0x267)]('YYYY-MM-DD'),_0x297ee7=moment($('#attendance-reportTo')[_0x5b27a0(0x205)](),_0x5b27a0(0x21f))[_0x5b27a0(0x267)](_0x5b27a0(0x252)),_0x5e7826=unique[_0x47dccb],_0x1cd0ef=_spPageContextInfo[_0x5b27a0(0x1eb)]+'/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27'+_0x4f8b93+_0x5b27a0(0x1f2)+_0x297ee7+'\x27\x20and\x20Employee\x20eq\x20\x27'+_0x5e7826+'\x27\x20';jQuery[_0x5b27a0(0x28f)]({'url':_0x1cd0ef,'headers':{'Accept':_0x5b27a0(0x2ad)},'async':![],'success':function(_0x2c40a8){var _0x29d34e=_0x5b27a0,_0x365302=_0x2c40a8['d'][_0x29d34e(0x255)];if(_0x365302[_0x29d34e(0x230)]>0x0){for(var _0x4c499c=0x0;_0x4c499c<_0x365302[_0x29d34e(0x230)];_0x4c499c++){var _0x270148=_0x365302[_0x4c499c]['ID'],_0x492034=_0x365302[_0x4c499c][_0x29d34e(0x1fd)][_0x29d34e(0x235)],_0x586b23=_0x365302[_0x4c499c][_0x29d34e(0x1fd)]['ID'],_0x1ce2a4=_0x365302[_0x4c499c][_0x29d34e(0x247)],_0x41bd09=_0x365302[_0x4c499c][_0x29d34e(0x1e7)];if(_0x41bd09==_0x29d34e(0x201)||_0x41bd09==_0x29d34e(0x288)||_0x41bd09==_0x29d34e(0x24c))_0x39f14d[_0x29d34e(0x284)](_0x41bd09);else _0x41bd09==_0x29d34e(0x27e)&&_0x53c03b[_0x29d34e(0x284)](_0x41bd09);_0x365302[_0x4c499c][_0x29d34e(0x1fb)]!=null&&(_0x47f892=parseInt(_0x47f892)+parseInt(_0x365302[_0x4c499c][_0x29d34e(0x1fb)]));var _0x434bb3=_0x365302[_0x4c499c]['HrAction'],_0xb59328=parseInt(_0x39f14d[_0x29d34e(0x230)])+parseInt(_0x53c03b[_0x29d34e(0x230)]),_0x1999df=parseInt(TotalOfficeDays)-parseInt(_0xb59328);_0x1999df<0x0&&(_0x1999df=0x0);}var _0x521fd8=Math['round'](parseInt(_0xb59328)/parseInt(TotalOfficeDays)*0x64)+'%';TotalOfficeDays=='0'&&(_0x521fd8='-'),EmpAttendanceData[_0x29d34e(0x284)]({'UserId':_0x586b23,'EmpName':_0x492034,'AttendanceDate':_0x1ce2a4,'AttendanceType':_0x41bd09,'AttendanceItemId':_0x270148,'EmpWorkHours':_0x47f892,'HrAction':_0x434bb3,'AttendancDays':_0x39f14d[_0x29d34e(0x230)],'LeavesDay':_0x53c03b['length'],'NotActionDays':_0x1999df,'percentage':_0x521fd8});}},'error':function(_0x13138d,_0x504c58){var _0x4d7a52=_0x5b27a0;console[_0x4d7a52(0x26b)](JSON[_0x4d7a52(0x249)](_0x13138d));}});}}}},'error':function(_0x50130e,_0x575e61,_0xac5b0e){var _0x41413d=_0x36e583;console[_0x41413d(0x26b)](_0x41413d(0x200)),console[_0x41413d(0x26b)](_0x50130e[_0x41413d(0x25d)]['error'][_0x41413d(0x237)][_0x41413d(0x21a)]);var _0x5b0560=_0x50130e['responseJSON']['error']['message'][_0x41413d(0x21a)],_0x1974ac=_0x5b0560[_0x41413d(0x2ac)](_0x41413d(0x28d));_0x1974ac==!![]&&(AttendanceReportUsageData=[],AttendanceReportUsageUrl=_spPageContextInfo['webAbsoluteUrl']+'/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000',ReadEmpReportUsageData());}});}var AttendanceReportUsageData=AttendanceReportUsageData||[],AttendanceReportUsageUrl='';function ReadEmpReportUsageData(){var _0x162e37=_0x59b5ec;return dfds=$['Deferred'](),$[_0x162e37(0x28f)]({'url':AttendanceReportUsageUrl,'headers':{'Accept':_0x162e37(0x2ad)},'async':![],'success':function(_0x13788b){var _0x27ebe8=_0x162e37;FilterState=0x0,AttendanceReportUsageData=AttendanceReportUsageData['concat'](_0x13788b['d'][_0x27ebe8(0x255)]);if(_0x13788b['d'][_0x27ebe8(0x2a1)])AttendanceReportUsageUrl=_0x13788b['d'][_0x27ebe8(0x2a1)],ReadEmpReportUsageData();else{if(AttendanceReportUsageData[_0x27ebe8(0x230)]>0x0){var _0x446d31=moment(ConvertDateTimeFormat($(_0x27ebe8(0x1f0))[_0x27ebe8(0x205)](),'/'))['format'](_0x27ebe8(0x202)),_0x18f3c5=moment(ConvertDateTimeFormat($('#attendance-reportTo')[_0x27ebe8(0x205)](),'/'))['format'](_0x27ebe8(0x202)),_0x5bc9d8=AttendanceReportUsageData[_0x27ebe8(0x2ae)](function(_0x1f5f58){var _0x11b334=_0x27ebe8;return Created=moment(_0x1f5f58[_0x11b334(0x247)])[_0x11b334(0x267)](_0x11b334(0x202)),(_0x446d31==''?Created!='':Created>=_0x446d31)&&(_0x18f3c5==''?Created!='':Created<=_0x18f3c5);});AttendanceReportUsageData=_0x5bc9d8;var _0x3c31f5=[...new Map(AttendanceReportUsageData[_0x27ebe8(0x26e)](_0x3704eb=>[_0x3704eb[_0x27ebe8(0x297)],_0x3704eb]))['values']()];TempStore=[];for(var _0x5f1f9d=0x0;_0x5f1f9d<AttendanceReportUsageData[_0x27ebe8(0x230)];_0x5f1f9d++){TempStore['push'](AttendanceReportUsageData[_0x5f1f9d][_0x27ebe8(0x1fd)]['ID']);}unique=TempStore[_0x27ebe8(0x2ae)](function(_0x5330ba,_0x11488e,_0x3c2412){var _0x4aa8b2=_0x27ebe8;return _0x11488e==_0x3c2412[_0x4aa8b2(0x1f7)](_0x5330ba);});if(unique[_0x27ebe8(0x230)]>0x0){EmpAttendanceData=[];for(var _0x342a1e=0x0;_0x342a1e<unique[_0x27ebe8(0x230)];_0x342a1e++){var _0x1362d7=0x0,_0x5d89ee=[],_0x4688f9=[],_0x30e9c8=moment($(_0x27ebe8(0x1f0))['val'](),_0x27ebe8(0x21f))['format'](_0x27ebe8(0x252)),_0x364742=moment($('#attendance-reportTo')[_0x27ebe8(0x205)](),_0x27ebe8(0x21f))[_0x27ebe8(0x267)](_0x27ebe8(0x252)),_0x5eb9e9=unique[_0x342a1e],_0x51a2b5=$[_0x27ebe8(0x24b)](AttendanceReportUsageData,function(_0x3f881c){var _0x20cf84=_0x27ebe8;return _0x3f881c[_0x20cf84(0x1fd)]['ID']==_0x5eb9e9;}),_0x3ae440=_0x51a2b5;if(_0x3ae440[_0x27ebe8(0x230)]>0x0){for(var _0x3045bd=0x0;_0x3045bd<_0x3ae440[_0x27ebe8(0x230)];_0x3045bd++){var _0xaf5971=_0x3ae440[_0x3045bd]['ID'],_0x470027=_0x3ae440[_0x3045bd][_0x27ebe8(0x1fd)][_0x27ebe8(0x235)],_0x45acc0=_0x3ae440[_0x3045bd][_0x27ebe8(0x1fd)]['ID'],_0x593586=_0x3ae440[_0x3045bd][_0x27ebe8(0x247)],_0x9c456e=_0x3ae440[_0x3045bd][_0x27ebe8(0x1e7)];if(_0x9c456e=='Full\x20Day'||_0x9c456e==_0x27ebe8(0x288)||_0x9c456e==_0x27ebe8(0x24c))_0x5d89ee[_0x27ebe8(0x284)](_0x9c456e);else _0x9c456e==_0x27ebe8(0x27e)&&_0x4688f9[_0x27ebe8(0x284)](_0x9c456e);_0x3ae440[_0x3045bd][_0x27ebe8(0x1fb)]!=null&&(_0x1362d7=parseInt(_0x1362d7)+parseInt(_0x3ae440[_0x3045bd][_0x27ebe8(0x1fb)]));var _0x44ed3b=_0x3ae440[_0x3045bd][_0x27ebe8(0x23a)],_0x507a0d=parseInt(_0x5d89ee[_0x27ebe8(0x230)])+parseInt(_0x4688f9[_0x27ebe8(0x230)]),_0x2f73fb=parseInt(TotalOfficeDays)-parseInt(_0x507a0d);_0x2f73fb<0x0&&(_0x2f73fb=0x0);}var _0x18cf25=Math[_0x27ebe8(0x25a)](parseInt(_0x507a0d)/parseInt(TotalOfficeDays)*0x64)+'%';TotalOfficeDays=='0'&&(_0x18cf25='-'),EmpAttendanceData['push']({'UserId':_0x45acc0,'EmpName':_0x470027,'AttendanceDate':_0x593586,'AttendanceType':_0x9c456e,'AttendanceItemId':_0xaf5971,'EmpWorkHours':_0x1362d7,'HrAction':_0x44ed3b,'AttendancDays':_0x5d89ee[_0x27ebe8(0x230)],'LeavesDay':_0x4688f9[_0x27ebe8(0x230)],'NotActionDays':_0x2f73fb,'percentage':_0x18cf25});}}}}}},'error':function(_0x93f7a,_0x2c8242,_0x215098){}}),dfds[_0x162e37(0x263)]();}function _0x3a6f(_0x25a438,_0x20bf28){var _0x3c2c62=_0x3c2c();return _0x3a6f=function(_0x3a6f65,_0x1f70d4){_0x3a6f65=_0x3a6f65-0x1e7;var _0x427c81=_0x3c2c62[_0x3a6f65];return _0x427c81;},_0x3a6f(_0x25a438,_0x20bf28);}function OpenMyCustomLoader(){var _0x3ae2fd=_0x59b5ec,_0x1fc6a6=_0x3ae2fd(0x294),_0x48ea75='<br\x20/>Please\x20wait!!',_0x24e34f=0xc8,_0x8184e2=0x190;currentDlg=SP['UI']['ModalDialog'][_0x3ae2fd(0x238)](_0x1fc6a6,_0x48ea75,_0x24e34f,_0x8184e2);}function CloseMyCustomLoader(){var _0x3c2c71=_0x59b5ec;currentDlg[_0x3c2c71(0x25c)]();}function EmployeeListDat(_0x4adb45){var _0x58e1d5=_0x59b5ec;$[_0x58e1d5(0x28f)]({'url':_0x4adb45,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x4dd792){var _0x586fbb=_0x58e1d5,_0x39224c=_0x4dd792['d'][_0x586fbb(0x255)];$(_0x586fbb(0x1f3))[_0x586fbb(0x27b)]();var _0x2546e3='';if(_0x39224c[_0x586fbb(0x230)]>0x0){var _0x364752=0x0,_0x2d5272=0x0,_0x2a06c3=0x0;for(var _0x9d56de=0x0;_0x9d56de<_0x39224c[_0x586fbb(0x230)];_0x9d56de++){var _0x3be04f=_0x39224c[_0x9d56de]['ID'],_0x3d99fd=_0x39224c[_0x9d56de]['LogonName']['ID'],_0x1c0c1d=_0x39224c[_0x9d56de][_0x586fbb(0x21c)]['Title'],_0x449a0e=_0x39224c[_0x9d56de][_0x586fbb(0x20e)],_0x1bb025=_0x39224c[_0x9d56de][_0x586fbb(0x264)][_0x586fbb(0x266)],_0xc990d3=_0x39224c[_0x9d56de][_0x586fbb(0x260)][_0x586fbb(0x235)];_0xc990d3==undefined&&(_0xc990d3='');var _0x33dfd2=_0x586fbb(0x293),_0x25a41c='',_0xef0179='black';_0x449a0e==null&&(_0x449a0e='');var _0x25040c=_0x39224c[_0x9d56de]['OfficeLocation'][_0x586fbb(0x224)];_0x25040c==null&&(_0x25040c='');EmployeeId=_0x39224c[_0x9d56de]['LogonName']['ID'];var _0x1f122a=moment($('#attendance-reportFrom')[_0x586fbb(0x205)](),_0x586fbb(0x21f))[_0x586fbb(0x267)](_0x586fbb(0x252)),_0xe3f1f1=moment($('#attendance-reportTo')[_0x586fbb(0x205)](),_0x586fbb(0x21f))[_0x586fbb(0x267)](_0x586fbb(0x252)),_0x1f122a=_0x1f122a['split']('-')[_0x586fbb(0x298)](''),_0xe3f1f1=_0xe3f1f1[_0x586fbb(0x248)]('-')['join'](''),_0x11cc2e=_spPageContextInfo[_0x586fbb(0x29f)]+'/Pages/EmployeeReport.aspx?EID='+_0x3d99fd+'&start='+_0x1f122a+_0x586fbb(0x2a6)+_0xe3f1f1+_0x586fbb(0x24f)+titanForWork['getQueryStringParameter'](_0x586fbb(0x218))+'&sourcelocation=../Pages/Report.aspx#',_0x1a6507=EmpAttendanceData[_0x586fbb(0x26e)](function(_0x55a23c){var _0x32465a=_0x586fbb;return _0x55a23c[_0x32465a(0x203)];})[_0x586fbb(0x1f7)](EmployeeId);if(_0x1a6507!=-0x1){var _0x3e374b=EmpAttendanceData[_0x1a6507][_0x586fbb(0x203)],_0x1d9ea5=EmpAttendanceData[_0x1a6507]['AttendanceType'],_0x59e71d=EmpAttendanceData[_0x1a6507][_0x586fbb(0x262)];_0x33dfd2=EmpAttendanceData[_0x1a6507][_0x586fbb(0x226)];var _0x234eac=EmpAttendanceData[_0x1a6507][_0x586fbb(0x226)];_0x25a41c=EmpAttendanceData[_0x1a6507]['AttendanceItemId'];var _0xf3e562=EmpAttendanceData[_0x1a6507][_0x586fbb(0x28a)],_0x2dd137=EmpAttendanceData[_0x1a6507][_0x586fbb(0x2a8)],_0x1de398=EmpAttendanceData[_0x1a6507]['NotActionDays'],_0x20a15e=EmpAttendanceData[_0x1a6507][_0x586fbb(0x22f)],_0x572c85='';EmpAttendanceData[_0x1a6507]['HrAction']==!![]?_0x572c85=_0x586fbb(0x253):_0x572c85='',_0x33dfd2==null&&(_0x33dfd2=_0x586fbb(0x293)),_0x1d9ea5==_0x586fbb(0x27e)&&(_0xef0179=_0x586fbb(0x27f),_0x2a06c3++),_0x1d9ea5==_0x586fbb(0x1f6)&&(_0xef0179=_0x586fbb(0x279)),_0x2546e3+=_0x586fbb(0x285),_0x2546e3+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x1c0c1d+_0x586fbb(0x24a),_0x2546e3+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x449a0e+'</div></td>',_0x2546e3+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x1bb025+_0x586fbb(0x24a),_0x2546e3+=_0x586fbb(0x251)+_0xc990d3+_0x586fbb(0x24a),_0x2546e3+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0xf3e562+_0x586fbb(0x24a),_0x2546e3+=_0x586fbb(0x295)+_0x1de398+_0x586fbb(0x24a),_0x2546e3+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x2dd137+'</div></td>',_0x2546e3+=_0x586fbb(0x295)+ConvertHHMM(_0x33dfd2)+'</div></td>',_0x2546e3+=_0x586fbb(0x295)+_0x20a15e+_0x586fbb(0x24a),_0x2546e3+='<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27><a\x20href=\x27'+_0x11cc2e+_0x586fbb(0x283),_0x2546e3+=_0x586fbb(0x1f8);}else _0x2546e3+=_0x586fbb(0x285),_0x2546e3+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x1c0c1d+_0x586fbb(0x24a),_0x2546e3+=_0x586fbb(0x251)+_0x449a0e+_0x586fbb(0x24a),_0x2546e3+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x1bb025+'</div></td>',_0x2546e3+=_0x586fbb(0x251)+_0xc990d3+_0x586fbb(0x24a),_0x2546e3+=_0x586fbb(0x239),_0x2546e3+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+TotalOfficeDays+_0x586fbb(0x24a),_0x2546e3+=_0x586fbb(0x239),_0x2546e3+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>00:00</div></td>',_0x2546e3+=_0x586fbb(0x270),_0x2546e3+='<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27><a\x20href=\x27'+_0x11cc2e+'\x27\x20class=\x27custom-edit-btn\x27><i\x20class=\x27fa\x20fa-chevron-right\x27></i></a></div></td>',_0x2546e3+=_0x586fbb(0x1f8);}}else{}_0x39224c[_0x586fbb(0x230)]==0x0?$(_0x586fbb(0x22a))[_0x586fbb(0x222)]():$(_0x586fbb(0x22a))[_0x586fbb(0x2a9)]();$(_0x586fbb(0x1f3))['append'](_0x2546e3);var _0x6909e4=$('#ReportTableData>tbody\x20>tr')[_0x586fbb(0x230)];$('#TotalItemscount')[_0x586fbb(0x231)](_0x6909e4),$(_0x586fbb(0x24d))[_0x586fbb(0x231)](_0x6909e4),_0x6909e4>0x0&&ReportTableConfiguration();},'error':function(_0x4bfa87){var _0x51708c=_0x58e1d5;console[_0x51708c(0x26b)](_0x4bfa87);}});}function ReportTableConfiguration(){var _0x1a6870=_0x59b5ec;sorter=new TINY[(_0x1a6870(0x257))][(_0x1a6870(0x233))](_0x1a6870(0x233),'ReportTableData',{'ascclass':_0x1a6870(0x229),'descclass':_0x1a6870(0x2a5),'evenclass':_0x1a6870(0x225),'oddclass':'oddrow','evenselclass':_0x1a6870(0x1ea),'oddselclass':'oddselected','paginate':!![],'size':0xa,'colddid':_0x1a6870(0x21d),'currentid':'Repcurrentpage','totalid':_0x1a6870(0x213),'startingrecid':_0x1a6870(0x258),'endingrecid':_0x1a6870(0x243),'totalrecid':'Reptotalrecords','hoverid':'selectedrow','pageddid':'pagedropdown','navid':'tablenav','sortdir':0x1,'init':!![]});}function ConvertHHMM(_0x386c79){var _0x1f63df=_0x59b5ec,_0x580b8c=Math[_0x1f63df(0x292)](_0x386c79/0x3c),_0x5a9e12=_0x386c79%0x3c;_0x580b8c<0xa&&(_0x580b8c='0'+_0x580b8c);_0x5a9e12<0xa&&(_0x5a9e12='0'+_0x5a9e12);var _0x390901=_0x580b8c+':'+_0x5a9e12;return _0x390901;}function CloseModel(){var _0x7fa440=_0x59b5ec;initializePeoplePicker(_0x7fa440(0x23e)),initializePeoplePicker('Employee');}var tableToExcel=(function(){var _0x42feef=_0x59b5ec,_0x6fdd80=_0x42feef(0x1f4),_0x35a3bd='<html\x20xmlns:o=\x22urn:schemas-microsoft-com:office:office\x22\x20xmlns:x=\x22urn:schemas-microsoft-com:office:excel\x22\x20xmlns=\x22http://www.w3.org/TR/REC-html40\x22><head><!--[if\x20gte\x20mso\x209]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>',_0x1f49c5=function(_0x19246f){var _0xfb6dab=_0x42feef;return window[_0xfb6dab(0x27a)](unescape(encodeURIComponent(_0x19246f)));},_0x3430a2=function(_0x4398a1,_0x5c4d13){var _0x4f0796=_0x42feef;return _0x4398a1[_0x4f0796(0x280)](/{(\w+)}/g,function(_0x5753ed,_0x28aaec){return _0x5c4d13[_0x28aaec];});};return function(_0x4eccb9,_0x2decbc){var _0x1f4838=_0x42feef;if(!_0x4eccb9[_0x1f4838(0x206)])_0x4eccb9=document[_0x1f4838(0x236)](_0x4eccb9);var _0xfd8a0f={'worksheet':_0x2decbc||'Worksheet','table':_0x4eccb9[_0x1f4838(0x268)]};window[_0x1f4838(0x276)][_0x1f4838(0x2a4)]=_0x6fdd80+_0x1f49c5(_0x3430a2(_0x35a3bd,_0xfd8a0f));};}()),authentication=function(){var _0xe3c372=_0x59b5ec,_0x5af0e2=_spPageContextInfo[_0xe3c372(0x27d)],_0x210631=_spPageContextInfo[_0xe3c372(0x1eb)]+'/_api/web/lists/getbytitle(\x27EnvironmentalSettings\x27)/items?$select=Title,Active,ListOfUsers/Title&$filter=Title\x20eq\x20\x27Attendance\x20Entry\x27\x20&$expand=ListOfUsers/Id';$[_0xe3c372(0x28f)]({'url':_0x210631,'async':![],'type':_0xe3c372(0x28b),'headers':{'accept':_0xe3c372(0x278)},'success':function(_0x5a30f6){var _0x4e606d=_0xe3c372;debugger;var _0x53b26b=_0x5a30f6['d'][_0x4e606d(0x255)];if(_0x53b26b[_0x4e606d(0x230)]>0x0)for(var _0x51afff=0x0;_0x51afff<_0x53b26b[_0x4e606d(0x230)];_0x51afff++){if(_0x53b26b[_0x51afff]['Title']==_0x4e606d(0x1f5)){if(_0x53b26b[_0x51afff][_0x4e606d(0x211)]==![])return alert(_0x4e606d(0x21b)),window['location']=_spPageContextInfo['webAbsoluteUrl']+_0x4e606d(0x25f),![];}}},'error':function(_0x1abbb0){var _0x3fa336=_0xe3c372;alert(JSON[_0x3fa336(0x249)](_0x1abbb0));}});};