var a58_0x1e1f45=a58_0xc331;function a58_0x5c42(){var _0x59bab8=['ReportTableData','AuthorId','empty','\x27\x20and\x20Holiday_start\x20le\x20\x27','userDisplayName','\x27\x20class=\x27custom-edit-btn\x27><i\x20class=\x27fa\x20fa-chevron-right\x27></i></a></div></td>','Dec','</option>','792PcYkyF','Error\x20in\x20getFileData.','&end=','38032RtZDeG','280px','split','getDate','LeavesDay','and\x20OfficeLocation\x20eq\x20\x27','All','DepartmentName','912164QkvShn','EmpWorkHours','#OfficeLoc\x20option:selected','Department','#TotalItemscount','Aug','DD/MM/YYYY','#TotalWorkdayTH','children','/Pages/Myworkplace.aspx?WebAppId=232SHDFGHJF22B2526DFG','7cMKUeT','when','#attendance-reportTo','.NoRecordFound','May','includes','#daydate','round','ajax','\x27\x20and\x20CompanyID\x20eq\x20\x27','join','Loading...','#SelectedLocation','indexOf','pagedropdown','#overlaysearch','setDate','Title','userId','SPClientPeoplePicker','table','On\x20Leave','#DepartmentDDL','fadeOut','PrincipalAccountType','#attendencedateValue','ModalDialog','message','POST','and\x20Department\x20eq\x20\x27','hide','#HolidaysTH','and\x20LogonName/ID\x20eq\x20\x27','121548bSPBdv','\x27&$orderby=Title\x20asc&$top=5000','application/json;\x20odata=verbose','Key','<html\x20xmlns:o=\x22urn:schemas-microsoft-com:office:office\x22\x20xmlns:x=\x22urn:schemas-microsoft-com:office:excel\x22\x20xmlns=\x22http://www.w3.org/TR/REC-html40\x22><head><!--[if\x20gte\x20mso\x209]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>','HrAction','location','appendTo','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>-</div></td>','showWaitScreenWithNoClose','</tr>','#monthhyear','#FdateTH','\x27\x20and\x20Employee\x20eq\x20\x27','WorkHours','Holiday','Mar','Nov','/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,ManagerLoginName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,ManagerLoginName,OfficeLocation,Company,Department&$filter=Status\x20eq\x20\x27Active\x27\x20and\x20Company/ID\x20\x20eq\x20\x27','</div>','Oct','#attendance-report-filter','getElementById','getTime','ready','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>','#DepartmentDDL\x20option:selected','push','Jan','<tr\x20class=\x27text-center\x27>','LogonName','AttendanceItemId','evenselected','145794RvNVqD','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>0</div></td>','floor','append','__next','#TotalHolidays','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27><a\x20href=\x27','21090SNgmqI','<option\x20value=\x22All\x22>All</option>','2nd\x20Half','Active','#ToDate','AttendanceDate','Attendance\x20Entry','#__REQUESTDIGEST','<option\x20value=\x22','&sourcelocation=../Pages/Report.aspx#','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27>','#chips','\x27\x20and\x20AttendanceDate\x20le\x20\x27','selectedrow','M\x20\x20yy','Full\x20Day','1st\x20Half','Repcurrentpage','modal','SPClientPeoplePickerDict','and\x20ManagerLoginName\x20eq\x20\x27','desc','\x27\x20and\x20Holiday_start\x20ge\x20\x27','1323012wwgEjU','columns','close','#Employee','values','#TotalOfficeDays','#ReportTable','attr','results','&WebAppId=','stringify','#OfficeLoc','SearchPrincipalSource','webAbsoluteUrl','OfficeLocation','00:00\x20(H:M)','YYYY-MM-DD','GET','Deferred','AllowMultipleValues','text','done','href','getFullYear','CompanyId','#Manager','Apr','percentage','value','filter','sorter','</div></td>','&start=','black','data:application/vnd.ms-excel;base64,','Repstartrecord','#totalemp','211495yuzoDY','getMonth','Employee','application/json;odata=verbose','3179hIVvjD','UserId','#EdateTH','AttendancDays','Manager','/_api/web/lists/GetByTitle(\x27OfficeLocation\x27)/items?$select=ID,OfficeName,CompanyID/ID&$expand=CompanyID&$top=5000&$filter=CompanyID/ID\x20eq\x20\x27','#attendance-reportFrom','7iKqYsB','val','length','fadeIn','GetAllUserInfo','datepicker','Reptotalrecords','format','blue','responseJSON','SPClientPeoplePicker_InitStandaloneControlWrapper','dd/mm/yy','/_api/web/ensureuser','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27','#FromDate','red','This\x20feature\x20has\x20been\x20deactivated\x20!','AttendanceType','Reptotalpages','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>00:00</div></td>','/Pages/EmployeeReport.aspx?EID=','Jul','#officeLocTH','MM/DD/YYYY','MaximumEntitySuggestions','#ReportTableData>tbody\x20>tr','<div\x20class=\x27upload-chip\x27>','grep','innerHTML','Jun','evenrow','log','ManagerLoginName','\x27&$orderby=OfficeName\x20asc'];a58_0x5c42=function(){return _0x59bab8;};return a58_0x5c42();}(function(_0x2c74fd,_0x7d0e45){var _0xfc6a2b=a58_0xc331,_0x29630d=_0x2c74fd();while(!![]){try{var _0x26ea30=-parseInt(_0xfc6a2b(0x1e5))/0x1*(parseInt(_0xfc6a2b(0x197))/0x2)+parseInt(_0xfc6a2b(0x1b5))/0x3+parseInt(_0xfc6a2b(0x21a))/0x4+-parseInt(_0xfc6a2b(0x1da))/0x5+-parseInt(_0xfc6a2b(0x175))/0x6*(parseInt(_0xfc6a2b(0x224))/0x7)+parseInt(_0xfc6a2b(0x212))/0x8*(-parseInt(_0xfc6a2b(0x20f))/0x9)+parseInt(_0xfc6a2b(0x19e))/0xa*(parseInt(_0xfc6a2b(0x1de))/0xb);if(_0x26ea30===_0x7d0e45)break;else _0x29630d['push'](_0x29630d['shift']());}catch(_0xb7e899){_0x29630d['push'](_0x29630d['shift']());}}}(a58_0x5c42,0x4627e));var GCompanyId='',GOfficeDays='';$(document)[a58_0x1e1f45(0x18e)](function(){var _0x55ef61=a58_0x1e1f45;userActivityNotificationEntry(_spPageContextInfo[_0x55ef61(0x236)],window[_0x55ef61(0x17b)]),authentication(),GCompanyId=titanForWork['getQueryStringParameter'](_0x55ef61(0x1cd)),$('#attendance-reportTo')[_0x55ef61(0x1ea)]({'dateFormat':_0x55ef61(0x1f0),'maxDate':new Date()})[_0x55ef61(0x1ea)](_0x55ef61(0x234),new Date()),$(_0x55ef61(0x1e4))[_0x55ef61(0x1ea)]({'dateFormat':_0x55ef61(0x1f0)})['datepicker'](_0x55ef61(0x234),'-7d'),$(_0x55ef61(0x1f3))[_0x55ef61(0x1c9)](formatDateReport(ConvertDateTimeFormat($(_0x55ef61(0x1e4))['val'](),'/'))),$(_0x55ef61(0x1a2))['text'](formatDateReport(ConvertDateTimeFormat($(_0x55ef61(0x226))[_0x55ef61(0x1e6)](),'/')));var _0x1942fa=$(_0x55ef61(0x1e4))[_0x55ef61(0x1ea)](_0x55ef61(0x215)),_0x4a0dff=$(_0x55ef61(0x226))[_0x55ef61(0x1ea)](_0x55ef61(0x215));days=(_0x4a0dff-_0x1942fa)/(0x3e8*0x3c*0x3c*0x18);var _0x3c739a=Math[_0x55ef61(0x22b)](days);GOfficeDays=Math[_0x55ef61(0x22b)](days),LoadAllOfficeLocation(),LoadAllDepartment(),LoadAllHolidays(),$(_0x55ef61(0x230))['text']($(_0x55ef61(0x21c))[_0x55ef61(0x1c9)]()),initializePeoplePicker(_0x55ef61(0x1e2)),initializePeoplePicker(_0x55ef61(0x1dc)),$(_0x55ef61(0x18b))[_0x55ef61(0x1b0)]('show');});function initializePeoplePicker(_0x66964d){var _0x5d390a=a58_0x1e1f45,_0xbc3e4f={};_0xbc3e4f[_0x5d390a(0x23c)]='User,DL,SecGroup,SPGroup',_0xbc3e4f[_0x5d390a(0x1c1)]=0xf,_0xbc3e4f['ResolvePrincipalSource']=0xf,_0xbc3e4f[_0x5d390a(0x1c8)]=![],_0xbc3e4f[_0x5d390a(0x1fd)]=0x32,_0xbc3e4f['Width']=_0x5d390a(0x213),this[_0x5d390a(0x1ef)](_0x66964d,null,_0xbc3e4f);}function ensureUser(_0xa30a68){var _0x19cfaf=a58_0x1e1f45,_0x272838=0x0,_0x539d7e=_0xa30a68,_0x4ad040=this[_0x19cfaf(0x237)]['SPClientPeoplePickerDict'][_0x539d7e],_0x472eff=_0x4ad040[_0x19cfaf(0x1e9)](),_0x1c9ff6=_0x472eff[0x0];if(_0x1c9ff6){var _0xd0fd27={'logonName':_0x1c9ff6[_0x19cfaf(0x178)]};$[_0x19cfaf(0x22c)]({'url':_spPageContextInfo[_0x19cfaf(0x1c2)]+_0x19cfaf(0x1f1),'type':_0x19cfaf(0x240),'async':![],'contentType':_0x19cfaf(0x1dd),'data':JSON[_0x19cfaf(0x1bf)](_0xd0fd27),'headers':{'X-RequestDigest':$(_0x19cfaf(0x1a5))[_0x19cfaf(0x1e6)](),'accept':_0x19cfaf(0x1dd)},'success':function(_0x2bc14e,_0x33a2f4,_0x10580a){_0x272838=_0x2bc14e['d']['Id'];},'error':function(_0x2294a2,_0x19d2a3,_0x39b555){}});}else _0x272838=0x0;return _0x272838;}function GetUserTitle(_0x348ee9){var _0x89d62d=a58_0x1e1f45,_0x46b453=0x0,_0x5b3e6f=_0x348ee9,_0x1f0a7f=this[_0x89d62d(0x237)][_0x89d62d(0x1b1)][_0x5b3e6f],_0x462063=_0x1f0a7f[_0x89d62d(0x1e9)](),_0x2a8172=_0x462063[0x0];if(_0x2a8172){var _0x99c0d9={'logonName':_0x2a8172['Key']};$[_0x89d62d(0x22c)]({'url':_spPageContextInfo[_0x89d62d(0x1c2)]+_0x89d62d(0x1f1),'type':'POST','async':![],'contentType':_0x89d62d(0x1dd),'data':JSON[_0x89d62d(0x1bf)](_0x99c0d9),'headers':{'X-RequestDigest':$(_0x89d62d(0x1a5))['val'](),'accept':_0x89d62d(0x1dd)},'success':function(_0x14bd53,_0x260b89,_0x3fcdae){var _0x3ee2b0=_0x89d62d;_0x46b453=_0x14bd53['d'][_0x3ee2b0(0x235)];},'error':function(_0x2fbef9,_0x138802,_0x5a6c51){}});}else _0x46b453=0x0;return _0x46b453;}function ConvertDateTimeFormat(_0x467ac6,_0x36df8a){var _0x19e91e=a58_0x1e1f45;return _0x467ac6[_0x19e91e(0x214)](_0x36df8a)[0x1]+''+_0x36df8a+''+_0x467ac6[_0x19e91e(0x214)](_0x36df8a)[0x0]+''+_0x36df8a+''+_0x467ac6[_0x19e91e(0x214)](_0x36df8a)[0x2];}function formatDateReport(_0x4945f5){var _0x408e53=a58_0x1e1f45,_0x2e95ea=new Date(_0x4945f5);if(isNaN(_0x2e95ea[_0x408e53(0x18d)]()))return _0x4945f5;else{var _0xfba555=new Array();return _0xfba555[0x0]=_0x408e53(0x192),_0xfba555[0x1]='Feb',_0xfba555[0x2]=_0x408e53(0x186),_0xfba555[0x3]=_0x408e53(0x1cf),_0xfba555[0x4]=_0x408e53(0x228),_0xfba555[0x5]=_0x408e53(0x202),_0xfba555[0x6]=_0x408e53(0x1fa),_0xfba555[0x7]=_0x408e53(0x21f),_0xfba555[0x8]='Sept',_0xfba555[0x9]=_0x408e53(0x18a),_0xfba555[0xa]=_0x408e53(0x187),_0xfba555[0xb]=_0x408e53(0x20d),day=_0x2e95ea[_0x408e53(0x215)](),day<0xa&&(day='0'+day),day+'\x20'+_0xfba555[_0x2e95ea[_0x408e53(0x1db)]()]+'\x20'+_0x2e95ea[_0x408e53(0x1cc)]();}}function LoadAllOfficeLocation(){var _0x30be5c=a58_0x1e1f45;$(_0x30be5c(0x1c0))[_0x30be5c(0x209)]();var _0x3e7aa9=_spPageContextInfo[_0x30be5c(0x1c2)]+_0x30be5c(0x1e3)+GCompanyId+_0x30be5c(0x206);$[_0x30be5c(0x22c)]({'url':_0x3e7aa9,'headers':{'Accept':_0x30be5c(0x1dd)},'async':![],'success':function(_0x36e5dd){var _0x40db7d=_0x30be5c;for(var _0x17b8b5=0x0;_0x17b8b5<_0x36e5dd['d']['results'][_0x40db7d(0x1e7)];_0x17b8b5++){$(_0x40db7d(0x1c0))[_0x40db7d(0x19a)](_0x40db7d(0x1a6)+_0x36e5dd['d'][_0x40db7d(0x1bd)][_0x17b8b5]['ID']+'\x22>'+_0x36e5dd['d'][_0x40db7d(0x1bd)][_0x17b8b5]['OfficeName']+_0x40db7d(0x20e));}},'myError':function(_0x16909c){}});}function LoadAllDepartment(){var _0x4b8edf=a58_0x1e1f45;$(_0x4b8edf(0x23a))[_0x4b8edf(0x209)]();var _0x51e256=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/getbytitle(\x27Departments\x27)/items?select=ID,Title&$filter=CompanyID\x20eq\x20\x27'+GCompanyId+_0x4b8edf(0x176);$['ajax']({'url':_0x51e256,'headers':{'Accept':_0x4b8edf(0x1dd)},'async':!![],'success':function(_0x46d3d3){var _0x41aaec=_0x4b8edf;$(_0x41aaec(0x19f))[_0x41aaec(0x17c)](_0x41aaec(0x23a));for(var _0x59e070=0x0;_0x59e070<_0x46d3d3['d'][_0x41aaec(0x1bd)][_0x41aaec(0x1e7)];_0x59e070++){$(_0x41aaec(0x23a))['append'](_0x41aaec(0x1a6)+_0x46d3d3['d'][_0x41aaec(0x1bd)][_0x59e070]['ID']+'\x22>'+_0x46d3d3['d'][_0x41aaec(0x1bd)][_0x59e070][_0x41aaec(0x235)]+'</option>');}},'myError':function(_0x1f453e){}});}var TotalOfficeDays=0x0,GtotalHolidays=0x0;function LoadAllHolidays(){var _0x359409=a58_0x1e1f45,_0x598a2d=$(_0x359409(0x1c0))[_0x359409(0x1e6)]();TotalOfficeDays=0x0,GtotalHolidays=0x0;var _0x188ff2=new Date(ConvertDateTimeFormat($(_0x359409(0x1e4))[_0x359409(0x1e6)](),'/')),_0x45611e=_0x188ff2['getFullYear']()+'-'+(_0x188ff2[_0x359409(0x1db)]()+0x1)+'-'+_0x188ff2[_0x359409(0x215)](),_0x2d61e9=new Date(ConvertDateTimeFormat($(_0x359409(0x226))[_0x359409(0x1e6)](),'/')),_0x18b3fb=_0x2d61e9['getFullYear']()+'-'+(_0x2d61e9[_0x359409(0x1db)]()+0x1)+'-'+_0x2d61e9[_0x359409(0x215)](),_0x2cd881=_spPageContextInfo[_0x359409(0x1c2)]+'/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?select=*,ID,Title&$filter=OfficeLocationID\x20eq\x20\x27'+_0x598a2d+_0x359409(0x22d)+GCompanyId+_0x359409(0x1b4)+_0x45611e+_0x359409(0x20a)+_0x18b3fb+'\x27';$[_0x359409(0x22c)]({'url':_0x2cd881,'headers':{'Accept':_0x359409(0x1dd)},'async':![],'success':function(_0x339cde){var _0x57747a=_0x359409,_0x5af555=_0x339cde['d'][_0x57747a(0x1bd)][_0x57747a(0x1e7)];GtotalHolidays=_0x5af555,$(_0x57747a(0x19c))[_0x57747a(0x1c9)](_0x5af555),$(_0x57747a(0x1ba))[_0x57747a(0x1c9)](parseInt(GOfficeDays)-parseInt(_0x5af555)),TotalOfficeDays=parseInt(GOfficeDays)-parseInt(_0x5af555);},'myError':function(_0x49bba3){}});}function Applyfilter(){var _0x91b777=a58_0x1e1f45;$(_0x91b777(0x1f3))[_0x91b777(0x1c9)](formatDateReport(ConvertDateTimeFormat($(_0x91b777(0x1e4))[_0x91b777(0x1e6)](),'/'))),$(_0x91b777(0x1a2))[_0x91b777(0x1c9)](formatDateReport(ConvertDateTimeFormat($('#attendance-reportTo')['val'](),'/'))),$(_0x91b777(0x230))[_0x91b777(0x1c9)]($('#OfficeLoc\x20option:selected')[_0x91b777(0x1c9)]()),$(_0x91b777(0x182))[_0x91b777(0x1c9)](formatDateReport(ConvertDateTimeFormat($(_0x91b777(0x1e4))[_0x91b777(0x1e6)](),'/'))),$(_0x91b777(0x1e0))[_0x91b777(0x1c9)](formatDateReport(ConvertDateTimeFormat($(_0x91b777(0x226))[_0x91b777(0x1e6)](),'/'))),$(_0x91b777(0x1fb))[_0x91b777(0x1c9)]($(_0x91b777(0x21c))[_0x91b777(0x1c9)]()),$(_0x91b777(0x221))[_0x91b777(0x1c9)](TotalOfficeDays),$(_0x91b777(0x173))['text'](GtotalHolidays);var _0x24a369=$(_0x91b777(0x1e4))['datepicker'](_0x91b777(0x215)),_0x352d2b=$(_0x91b777(0x226))['datepicker'](_0x91b777(0x215));days=(_0x352d2b-_0x24a369)/(0x3e8*0x3c*0x3c*0x18),GOfficeDays=Math[_0x91b777(0x22b)](days)+0x1,LoadAllHolidays(),$(_0x91b777(0x23d))['val']('');var _0x52ceb7=$(_0x91b777(0x1e4))['val'](),_0x319cfc=moment($(_0x91b777(0x1e4))['val'](),_0x91b777(0x220))['format'](_0x91b777(0x1c5)),_0x5f0763=moment($(_0x91b777(0x226))[_0x91b777(0x1e6)](),_0x91b777(0x220))[_0x91b777(0x1ec)](_0x91b777(0x1c5));$(_0x91b777(0x22a))['text']($[_0x91b777(0x1ea)]['formatDate']('D,\x20dd',new Date(_0x319cfc))),$(_0x91b777(0x181))[_0x91b777(0x1c9)]($[_0x91b777(0x1ea)]['formatDate'](_0x91b777(0x1ac),new Date(_0x319cfc)));var _0x21dffb='',_0x472ba7='';$('#OfficeLoc')['val']()!='All'&&(_0x21dffb+=_0x91b777(0x217)+$(_0x91b777(0x1c0))[_0x91b777(0x1e6)]()+'\x27\x20',_0x472ba7+='<div\x20class=\x27upload-chip\x27>'+$(_0x91b777(0x21c))[_0x91b777(0x1c9)]()+_0x91b777(0x189));$(_0x91b777(0x23a))[_0x91b777(0x1e6)]()!=_0x91b777(0x218)&&(_0x21dffb+=_0x91b777(0x171)+$(_0x91b777(0x23a))['val']()+'\x27\x20',_0x472ba7+=_0x91b777(0x1ff)+$(_0x91b777(0x190))['text']()+'</div>');var _0x2f7c8c=ensureUser($(_0x91b777(0x1ce))[_0x91b777(0x222)]()[_0x91b777(0x222)]()[_0x91b777(0x1bc)]('id')),_0x5c795f=ensureUser($(_0x91b777(0x1b8))[_0x91b777(0x222)]()[_0x91b777(0x222)]()[_0x91b777(0x1bc)]('id'));_0x2f7c8c!=0x0&&(_0x21dffb+=_0x91b777(0x1b2)+_0x2f7c8c+'\x27\x20',_0x472ba7+=_0x91b777(0x1ff)+GetUserTitle($(_0x91b777(0x1ce))[_0x91b777(0x222)]()[_0x91b777(0x222)]()[_0x91b777(0x1bc)]('id'))+_0x91b777(0x189)),_0x5c795f!=0x0&&(_0x21dffb+=_0x91b777(0x174)+_0x5c795f+'\x27\x20',_0x472ba7+=_0x91b777(0x1ff)+GetUserTitle($(_0x91b777(0x1b8))[_0x91b777(0x222)]()[_0x91b777(0x222)]()[_0x91b777(0x1bc)]('id'))+_0x91b777(0x189)),$(_0x91b777(0x1a9))[_0x91b777(0x209)](),$(_0x91b777(0x1a9))['append'](_0x472ba7),$(_0x91b777(0x233))[_0x91b777(0x1e8)](),setTimeout(function(){var _0x4c3640=_0x91b777,_0x40c256=_spPageContextInfo['webAbsoluteUrl']+_0x4c3640(0x1f2)+_0x319cfc+'\x27\x20and\x20AttendanceDate\x20le\x20\x27'+_0x5f0763+'\x27\x20';$[_0x4c3640(0x225)](getFileData(_0x40c256))[_0x4c3640(0x1ca)](function(_0x483d0a){var _0x3c36e1=_0x4c3640,_0x135e13=_spPageContextInfo[_0x3c36e1(0x1c2)]+_0x3c36e1(0x188)+GCompanyId+'\x27'+_0x21dffb;EmployeeListDat(_0x135e13),$(_0x3c36e1(0x233))[_0x3c36e1(0x23b)]();});},0x5dc);}var TempStore=[],unique='';function getFileData(_0x1f45e0){var _0x288969=a58_0x1e1f45;jQuery['ajax']({'url':_0x1f45e0,'headers':{'Accept':_0x288969(0x1dd)},'async':![],'success':function(_0x178638){var _0x551584=_0x288969;EmpAttendanceData=[];var _0x4f6054=_0x178638['d'][_0x551584(0x1bd)];if(_0x4f6054['length']>0x0){TempStore=[];for(var _0x59047b=0x0;_0x59047b<_0x4f6054[_0x551584(0x1e7)];_0x59047b++){TempStore[_0x551584(0x191)](_0x4f6054[_0x59047b]['Employee']['ID']);}unique=TempStore[_0x551584(0x1d2)](function(_0x3a24b8,_0x59ddd1,_0x6c1e11){var _0x8e2b4f=_0x551584;return _0x59ddd1==_0x6c1e11[_0x8e2b4f(0x231)](_0x3a24b8);});if(unique['length']>0x0){EmpAttendanceData=[];for(var _0x5e4592=0x0;_0x5e4592<unique['length'];_0x5e4592++){var _0x319496=0x0,_0x4a8d4c=[],_0x50b46d=[],_0x342118=moment($(_0x551584(0x1e4))[_0x551584(0x1e6)](),_0x551584(0x220))[_0x551584(0x1ec)](_0x551584(0x1c5)),_0x4034b7=moment($(_0x551584(0x226))[_0x551584(0x1e6)](),_0x551584(0x220))[_0x551584(0x1ec)](_0x551584(0x1c5)),_0x2daffe=unique[_0x5e4592],_0x291ccb=_spPageContextInfo[_0x551584(0x1c2)]+_0x551584(0x1f2)+_0x342118+_0x551584(0x1aa)+_0x4034b7+_0x551584(0x183)+_0x2daffe+'\x27\x20';jQuery[_0x551584(0x22c)]({'url':_0x291ccb,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0xa6b810){var _0x1768de=_0x551584,_0x3b1452=_0xa6b810['d']['results'];if(_0x3b1452[_0x1768de(0x1e7)]>0x0){for(var _0x5d5ac5=0x0;_0x5d5ac5<_0x3b1452[_0x1768de(0x1e7)];_0x5d5ac5++){var _0x586868=_0x3b1452[_0x5d5ac5]['ID'],_0x291542=_0x3b1452[_0x5d5ac5]['Employee'][_0x1768de(0x235)],_0x58b80e=_0x3b1452[_0x5d5ac5][_0x1768de(0x1dc)]['ID'],_0xf3d711=_0x3b1452[_0x5d5ac5][_0x1768de(0x1a3)],_0x8f77c7=_0x3b1452[_0x5d5ac5][_0x1768de(0x1f6)];if(_0x8f77c7==_0x1768de(0x1ad)||_0x8f77c7==_0x1768de(0x1ae)||_0x8f77c7==_0x1768de(0x1a0))_0x4a8d4c[_0x1768de(0x191)](_0x8f77c7);else _0x8f77c7==_0x1768de(0x239)&&_0x50b46d[_0x1768de(0x191)](_0x8f77c7);_0x3b1452[_0x5d5ac5][_0x1768de(0x184)]!=null&&(_0x319496=parseInt(_0x319496)+parseInt(_0x3b1452[_0x5d5ac5][_0x1768de(0x184)]));var _0x313457=_0x3b1452[_0x5d5ac5][_0x1768de(0x17a)],_0x2ecfb2=parseInt(_0x4a8d4c['length'])+parseInt(_0x50b46d[_0x1768de(0x1e7)]),_0x85a8da=parseInt(TotalOfficeDays)-parseInt(_0x2ecfb2);_0x85a8da<0x0&&(_0x85a8da=0x0);}var _0x54fa8d=Math['round'](parseInt(_0x2ecfb2)/parseInt(TotalOfficeDays)*0x64)+'%';TotalOfficeDays=='0'&&(_0x54fa8d='-'),EmpAttendanceData['push']({'UserId':_0x58b80e,'EmpName':_0x291542,'AttendanceDate':_0xf3d711,'AttendanceType':_0x8f77c7,'AttendanceItemId':_0x586868,'EmpWorkHours':_0x319496,'HrAction':_0x313457,'AttendancDays':_0x4a8d4c[_0x1768de(0x1e7)],'LeavesDay':_0x50b46d['length'],'NotActionDays':_0x85a8da,'percentage':_0x54fa8d});}},'error':function(_0x1c39ef,_0x238559){var _0x43ecf8=_0x551584;console[_0x43ecf8(0x204)](JSON[_0x43ecf8(0x1bf)](_0x1c39ef));}});}}}},'error':function(_0x25d7bd,_0x14f518,_0x52e0dc){var _0x3dca7a=_0x288969;console['log'](_0x3dca7a(0x210)),console[_0x3dca7a(0x204)](_0x25d7bd[_0x3dca7a(0x1ee)]['error'][_0x3dca7a(0x23f)][_0x3dca7a(0x1d1)]);var _0x535b61=_0x25d7bd[_0x3dca7a(0x1ee)]['error'][_0x3dca7a(0x23f)][_0x3dca7a(0x1d1)],_0x544c4f=_0x535b61[_0x3dca7a(0x229)]('it\x20exceeds\x20the\x20list\x20view\x20threshold');_0x544c4f==!![]&&(AttendanceReportUsageData=[],AttendanceReportUsageUrl=_spPageContextInfo[_0x3dca7a(0x1c2)]+_0x3dca7a(0x17d),ReadEmpReportUsageData());}});}var AttendanceReportUsageData=AttendanceReportUsageData||[],AttendanceReportUsageUrl='';function a58_0xc331(_0x337ae8,_0x4b7a18){var _0x5c425d=a58_0x5c42();return a58_0xc331=function(_0xc331a1,_0x4f9cde){_0xc331a1=_0xc331a1-0x171;var _0x1a75aa=_0x5c425d[_0xc331a1];return _0x1a75aa;},a58_0xc331(_0x337ae8,_0x4b7a18);}function ReadEmpReportUsageData(){var _0x22c37e=a58_0x1e1f45;return dfds=$[_0x22c37e(0x1c7)](),$[_0x22c37e(0x22c)]({'url':AttendanceReportUsageUrl,'headers':{'Accept':_0x22c37e(0x1dd)},'async':![],'success':function(_0x2ce704){var _0x12f437=_0x22c37e;FilterState=0x0,AttendanceReportUsageData=AttendanceReportUsageData['concat'](_0x2ce704['d'][_0x12f437(0x1bd)]);if(_0x2ce704['d'][_0x12f437(0x19b)])AttendanceReportUsageUrl=_0x2ce704['d'][_0x12f437(0x19b)],ReadEmpReportUsageData();else{if(AttendanceReportUsageData[_0x12f437(0x1e7)]>0x0){var _0x10aad3=moment(ConvertDateTimeFormat($(_0x12f437(0x1e4))[_0x12f437(0x1e6)](),'/'))[_0x12f437(0x1ec)]('MM/DD/YYYY'),_0x413611=moment(ConvertDateTimeFormat($(_0x12f437(0x226))[_0x12f437(0x1e6)](),'/'))[_0x12f437(0x1ec)](_0x12f437(0x1fc)),_0x1b5157=AttendanceReportUsageData[_0x12f437(0x1d2)](function(_0x52a765){var _0xb1fd2a=_0x12f437;return Created=moment(_0x52a765[_0xb1fd2a(0x1a3)])[_0xb1fd2a(0x1ec)]('MM/DD/YYYY'),(_0x10aad3==''?Created!='':Created>=_0x10aad3)&&(_0x413611==''?Created!='':Created<=_0x413611);});AttendanceReportUsageData=_0x1b5157;var _0x6728fa=[...new Map(AttendanceReportUsageData['map'](_0x234de5=>[_0x234de5[_0x12f437(0x208)],_0x234de5]))[_0x12f437(0x1b9)]()];TempStore=[];for(var _0x9c0994=0x0;_0x9c0994<AttendanceReportUsageData['length'];_0x9c0994++){TempStore[_0x12f437(0x191)](AttendanceReportUsageData[_0x9c0994][_0x12f437(0x1dc)]['ID']);}unique=TempStore[_0x12f437(0x1d2)](function(_0x13eb2c,_0x3ed13c,_0x253e86){var _0x7f9f05=_0x12f437;return _0x3ed13c==_0x253e86[_0x7f9f05(0x231)](_0x13eb2c);});if(unique[_0x12f437(0x1e7)]>0x0){EmpAttendanceData=[];for(var _0x53f325=0x0;_0x53f325<unique[_0x12f437(0x1e7)];_0x53f325++){var _0x5b6314=0x0,_0x5dea42=[],_0x9e6a8a=[],_0x3facbb=moment($(_0x12f437(0x1e4))[_0x12f437(0x1e6)](),_0x12f437(0x220))[_0x12f437(0x1ec)](_0x12f437(0x1c5)),_0x2c7fa3=moment($(_0x12f437(0x226))['val'](),'DD/MM/YYYY')[_0x12f437(0x1ec)](_0x12f437(0x1c5)),_0x539fe8=unique[_0x53f325],_0xdaa5d2=$[_0x12f437(0x200)](AttendanceReportUsageData,function(_0x3fd791){var _0x5571e4=_0x12f437;return _0x3fd791[_0x5571e4(0x1dc)]['ID']==_0x539fe8;}),_0x3c5c45=_0xdaa5d2;if(_0x3c5c45[_0x12f437(0x1e7)]>0x0){for(var _0x45d042=0x0;_0x45d042<_0x3c5c45[_0x12f437(0x1e7)];_0x45d042++){var _0x58d978=_0x3c5c45[_0x45d042]['ID'],_0x4ff04c=_0x3c5c45[_0x45d042][_0x12f437(0x1dc)][_0x12f437(0x235)],_0x5340bc=_0x3c5c45[_0x45d042][_0x12f437(0x1dc)]['ID'],_0x32b390=_0x3c5c45[_0x45d042][_0x12f437(0x1a3)],_0x2c8c00=_0x3c5c45[_0x45d042]['AttendanceType'];if(_0x2c8c00==_0x12f437(0x1ad)||_0x2c8c00==_0x12f437(0x1ae)||_0x2c8c00==_0x12f437(0x1a0))_0x5dea42['push'](_0x2c8c00);else _0x2c8c00=='On\x20Leave'&&_0x9e6a8a[_0x12f437(0x191)](_0x2c8c00);_0x3c5c45[_0x45d042][_0x12f437(0x184)]!=null&&(_0x5b6314=parseInt(_0x5b6314)+parseInt(_0x3c5c45[_0x45d042][_0x12f437(0x184)]));var _0x2f45ca=_0x3c5c45[_0x45d042][_0x12f437(0x17a)],_0x205712=parseInt(_0x5dea42[_0x12f437(0x1e7)])+parseInt(_0x9e6a8a[_0x12f437(0x1e7)]),_0x4cbea4=parseInt(TotalOfficeDays)-parseInt(_0x205712);_0x4cbea4<0x0&&(_0x4cbea4=0x0);}var _0x1eedc3=Math[_0x12f437(0x22b)](parseInt(_0x205712)/parseInt(TotalOfficeDays)*0x64)+'%';TotalOfficeDays=='0'&&(_0x1eedc3='-'),EmpAttendanceData[_0x12f437(0x191)]({'UserId':_0x5340bc,'EmpName':_0x4ff04c,'AttendanceDate':_0x32b390,'AttendanceType':_0x2c8c00,'AttendanceItemId':_0x58d978,'EmpWorkHours':_0x5b6314,'HrAction':_0x2f45ca,'AttendancDays':_0x5dea42[_0x12f437(0x1e7)],'LeavesDay':_0x9e6a8a[_0x12f437(0x1e7)],'NotActionDays':_0x4cbea4,'percentage':_0x1eedc3});}}}}}},'error':function(_0x2bcc52,_0x29e6d6,_0x4c647b){}}),dfds['promise']();}function OpenMyCustomLoader(){var _0xe7588a=a58_0x1e1f45,_0x308ca6=_0xe7588a(0x22f),_0x3877ed='<br\x20/>Please\x20wait!!',_0x58680d=0xc8,_0x23eea2=0x190;currentDlg=SP['UI'][_0xe7588a(0x23e)][_0xe7588a(0x17f)](_0x308ca6,_0x3877ed,_0x58680d,_0x23eea2);}function CloseMyCustomLoader(){var _0x4a658e=a58_0x1e1f45;currentDlg[_0x4a658e(0x1b7)]();}function EmployeeListDat(_0x17b518){var _0x304201=a58_0x1e1f45;$[_0x304201(0x22c)]({'url':_0x17b518,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x282207){var _0x27d94c=_0x304201,_0x3cf02d=_0x282207['d']['results'];$(_0x27d94c(0x1bb))[_0x27d94c(0x209)]();var _0x47bae4='';if(_0x3cf02d[_0x27d94c(0x1e7)]>0x0){var _0x276687=0x0,_0x42f27c=0x0,_0x389ece=0x0;for(var _0x2e8cbe=0x0;_0x2e8cbe<_0x3cf02d[_0x27d94c(0x1e7)];_0x2e8cbe++){var _0x541927=_0x3cf02d[_0x2e8cbe]['ID'],_0x59acb7=_0x3cf02d[_0x2e8cbe][_0x27d94c(0x194)]['ID'],_0x56f316=_0x3cf02d[_0x2e8cbe][_0x27d94c(0x194)][_0x27d94c(0x235)],_0xb277af=_0x3cf02d[_0x2e8cbe]['Designation'],_0x3d07c3=_0x3cf02d[_0x2e8cbe][_0x27d94c(0x21d)][_0x27d94c(0x219)],_0x29b86f=_0x3cf02d[_0x2e8cbe][_0x27d94c(0x205)][_0x27d94c(0x235)];_0x29b86f==undefined&&(_0x29b86f='');var _0x51a61f=_0x27d94c(0x1c4),_0x4b89b1='',_0x22c47c=_0x27d94c(0x1d6);_0xb277af==null&&(_0xb277af='');var _0x13ca79=_0x3cf02d[_0x2e8cbe][_0x27d94c(0x1c3)]['OfficeName'];_0x13ca79==null&&(_0x13ca79='');EmployeeId=_0x3cf02d[_0x2e8cbe]['LogonName']['ID'];var _0x21bb52=moment($(_0x27d94c(0x1e4))[_0x27d94c(0x1e6)](),_0x27d94c(0x220))[_0x27d94c(0x1ec)](_0x27d94c(0x1c5)),_0x578e75=moment($(_0x27d94c(0x226))[_0x27d94c(0x1e6)](),_0x27d94c(0x220))[_0x27d94c(0x1ec)](_0x27d94c(0x1c5)),_0x21bb52=_0x21bb52[_0x27d94c(0x214)]('-')[_0x27d94c(0x22e)](''),_0x578e75=_0x578e75['split']('-')[_0x27d94c(0x22e)](''),_0x20a53e=_spPageContextInfo['webServerRelativeUrl']+_0x27d94c(0x1f9)+_0x59acb7+_0x27d94c(0x1d5)+_0x21bb52+_0x27d94c(0x211)+_0x578e75+_0x27d94c(0x1be)+titanForWork['getQueryStringParameter'](_0x27d94c(0x1cd))+_0x27d94c(0x1a7),_0x28b91d=EmpAttendanceData['map'](function(_0x3fe32a){var _0x4fd479=_0x27d94c;return _0x3fe32a[_0x4fd479(0x1df)];})['indexOf'](EmployeeId);if(_0x28b91d!=-0x1){var _0x4a1417=EmpAttendanceData[_0x28b91d]['UserId'],_0x2df96f=EmpAttendanceData[_0x28b91d][_0x27d94c(0x1f6)],_0x51fb6b=EmpAttendanceData[_0x28b91d][_0x27d94c(0x195)];_0x51a61f=EmpAttendanceData[_0x28b91d][_0x27d94c(0x21b)];var _0x248d2b=EmpAttendanceData[_0x28b91d][_0x27d94c(0x21b)];_0x4b89b1=EmpAttendanceData[_0x28b91d][_0x27d94c(0x195)];var _0x372c1f=EmpAttendanceData[_0x28b91d][_0x27d94c(0x1e1)],_0xaf57ba=EmpAttendanceData[_0x28b91d][_0x27d94c(0x216)],_0x513c24=EmpAttendanceData[_0x28b91d]['NotActionDays'],_0x5759e2=EmpAttendanceData[_0x28b91d][_0x27d94c(0x1d0)],_0x1de237='';EmpAttendanceData[_0x28b91d]['HrAction']==!![]?_0x1de237='checked':_0x1de237='',_0x51a61f==null&&(_0x51a61f=_0x27d94c(0x1c4)),_0x2df96f==_0x27d94c(0x239)&&(_0x22c47c=_0x27d94c(0x1f4),_0x389ece++),_0x2df96f==_0x27d94c(0x185)&&(_0x22c47c=_0x27d94c(0x1ed)),_0x47bae4+=_0x27d94c(0x193),_0x47bae4+=_0x27d94c(0x1a8)+_0x56f316+_0x27d94c(0x1d4),_0x47bae4+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0xb277af+_0x27d94c(0x1d4),_0x47bae4+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x3d07c3+_0x27d94c(0x1d4),_0x47bae4+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x29b86f+_0x27d94c(0x1d4),_0x47bae4+=_0x27d94c(0x18f)+_0x372c1f+_0x27d94c(0x1d4),_0x47bae4+=_0x27d94c(0x18f)+_0x513c24+_0x27d94c(0x1d4),_0x47bae4+=_0x27d94c(0x18f)+_0xaf57ba+_0x27d94c(0x1d4),_0x47bae4+=_0x27d94c(0x18f)+ConvertHHMM(_0x51a61f)+_0x27d94c(0x1d4),_0x47bae4+=_0x27d94c(0x18f)+_0x5759e2+'</div></td>',_0x47bae4+=_0x27d94c(0x19d)+_0x20a53e+_0x27d94c(0x20c),_0x47bae4+=_0x27d94c(0x180);}else _0x47bae4+=_0x27d94c(0x193),_0x47bae4+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x56f316+_0x27d94c(0x1d4),_0x47bae4+=_0x27d94c(0x1a8)+_0xb277af+_0x27d94c(0x1d4),_0x47bae4+=_0x27d94c(0x18f)+_0x3d07c3+_0x27d94c(0x1d4),_0x47bae4+=_0x27d94c(0x1a8)+_0x29b86f+_0x27d94c(0x1d4),_0x47bae4+=_0x27d94c(0x198),_0x47bae4+=_0x27d94c(0x18f)+TotalOfficeDays+_0x27d94c(0x1d4),_0x47bae4+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>0</div></td>',_0x47bae4+=_0x27d94c(0x1f8),_0x47bae4+=_0x27d94c(0x17e),_0x47bae4+=_0x27d94c(0x19d)+_0x20a53e+_0x27d94c(0x20c),_0x47bae4+=_0x27d94c(0x180);}}else{}_0x3cf02d[_0x27d94c(0x1e7)]==0x0?$(_0x27d94c(0x227))['show']():$('.NoRecordFound')[_0x27d94c(0x172)]();$(_0x27d94c(0x1bb))[_0x27d94c(0x19a)](_0x47bae4);var _0x43f0af=$(_0x27d94c(0x1fe))[_0x27d94c(0x1e7)];$(_0x27d94c(0x21e))['text'](_0x43f0af),$(_0x27d94c(0x1d9))[_0x27d94c(0x1c9)](_0x43f0af),_0x43f0af>0x0&&ReportTableConfiguration();},'error':function(_0x4960d8){var _0xf95b4f=_0x304201;console[_0xf95b4f(0x204)](_0x4960d8);}});}function ReportTableConfiguration(){var _0x4f7f13=a58_0x1e1f45;sorter=new TINY[(_0x4f7f13(0x238))]['sorter'](_0x4f7f13(0x1d3),_0x4f7f13(0x207),{'ascclass':'asc','descclass':_0x4f7f13(0x1b3),'evenclass':_0x4f7f13(0x203),'oddclass':'oddrow','evenselclass':_0x4f7f13(0x196),'oddselclass':'oddselected','paginate':!![],'size':0xa,'colddid':_0x4f7f13(0x1b6),'currentid':_0x4f7f13(0x1af),'totalid':_0x4f7f13(0x1f7),'startingrecid':_0x4f7f13(0x1d8),'endingrecid':'Rependrecord','totalrecid':_0x4f7f13(0x1eb),'hoverid':_0x4f7f13(0x1ab),'pageddid':_0x4f7f13(0x232),'navid':'tablenav','sortdir':0x1,'init':!![]});}function ConvertHHMM(_0x57f978){var _0xda60e5=a58_0x1e1f45,_0xecb590=Math[_0xda60e5(0x199)](_0x57f978/0x3c),_0x36314a=_0x57f978%0x3c;_0xecb590<0xa&&(_0xecb590='0'+_0xecb590);_0x36314a<0xa&&(_0x36314a='0'+_0x36314a);var _0x5e6f31=_0xecb590+':'+_0x36314a;return _0x5e6f31;}function CloseModel(){var _0x520bb3=a58_0x1e1f45;initializePeoplePicker(_0x520bb3(0x1e2)),initializePeoplePicker(_0x520bb3(0x1dc));}var tableToExcel=(function(){var _0x405f1c=a58_0x1e1f45,_0x2bc9b4=_0x405f1c(0x1d7),_0x45d219=_0x405f1c(0x179),_0x5f20be=function(_0x19edb8){return window['btoa'](unescape(encodeURIComponent(_0x19edb8)));},_0x225865=function(_0x2c088f,_0x45c5c5){return _0x2c088f['replace'](/{(\w+)}/g,function(_0xaed6b3,_0x20a759){return _0x45c5c5[_0x20a759];});};return function(_0x96b06b,_0x5e9995){var _0x3a7636=_0x405f1c;if(!_0x96b06b['nodeType'])_0x96b06b=document[_0x3a7636(0x18c)](_0x96b06b);var _0x40d092={'worksheet':_0x5e9995||'Worksheet','table':_0x96b06b[_0x3a7636(0x201)]};window[_0x3a7636(0x17b)][_0x3a7636(0x1cb)]=_0x2bc9b4+_0x5f20be(_0x225865(_0x45d219,_0x40d092));};}()),authentication=function(){var _0x4a3e86=a58_0x1e1f45,_0x1e1187=_spPageContextInfo[_0x4a3e86(0x20b)],_0x52a9fe=_spPageContextInfo[_0x4a3e86(0x1c2)]+'/_api/web/lists/getbytitle(\x27EnvironmentalSettings\x27)/items?$select=Title,Active,ListOfUsers/Title&$filter=Title\x20eq\x20\x27Attendance\x20Entry\x27\x20&$expand=ListOfUsers/Id';$[_0x4a3e86(0x22c)]({'url':_0x52a9fe,'async':![],'type':_0x4a3e86(0x1c6),'headers':{'accept':_0x4a3e86(0x177)},'success':function(_0x517878){var _0x20be6b=_0x4a3e86;debugger;var _0x255b3d=_0x517878['d'][_0x20be6b(0x1bd)];if(_0x255b3d[_0x20be6b(0x1e7)]>0x0)for(var _0x3e8ccd=0x0;_0x3e8ccd<_0x255b3d['length'];_0x3e8ccd++){if(_0x255b3d[_0x3e8ccd]['Title']==_0x20be6b(0x1a4)){if(_0x255b3d[_0x3e8ccd][_0x20be6b(0x1a1)]==![])return alert(_0x20be6b(0x1f5)),window[_0x20be6b(0x17b)]=_spPageContextInfo[_0x20be6b(0x1c2)]+_0x20be6b(0x223),![];}}},'error':function(_0x28ba97){var _0x4791e1=_0x4a3e86;alert(JSON[_0x4791e1(0x1bf)](_0x28ba97));}});};