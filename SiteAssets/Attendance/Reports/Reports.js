var a7_0x483f53=a7_0x19b3;(function(_0x48d9bf,_0xaef0d8){var _0x3a88b5=a7_0x19b3,_0x58cb9b=_0x48d9bf();while(!![]){try{var _0x15c3be=parseInt(_0x3a88b5(0x23b))/0x1*(parseInt(_0x3a88b5(0x28f))/0x2)+parseInt(_0x3a88b5(0x21d))/0x3+-parseInt(_0x3a88b5(0x1e4))/0x4*(parseInt(_0x3a88b5(0x24f))/0x5)+parseInt(_0x3a88b5(0x226))/0x6*(parseInt(_0x3a88b5(0x1fc))/0x7)+-parseInt(_0x3a88b5(0x1f0))/0x8*(-parseInt(_0x3a88b5(0x1ee))/0x9)+parseInt(_0x3a88b5(0x249))/0xa+-parseInt(_0x3a88b5(0x269))/0xb;if(_0x15c3be===_0xaef0d8)break;else _0x58cb9b['push'](_0x58cb9b['shift']());}catch(_0x35c576){_0x58cb9b['push'](_0x58cb9b['shift']());}}}(a7_0x51b8,0x6aba6));var GCompanyId='',GOfficeDays='';$(document)[a7_0x483f53(0x291)](function(){var _0xddb5ca=a7_0x483f53;userActivityNotificationEntry(_spPageContextInfo[_0xddb5ca(0x27d)],window[_0xddb5ca(0x28c)]),authentication(),GCompanyId=titanForWork[_0xddb5ca(0x250)](_0xddb5ca(0x246)),$(_0xddb5ca(0x219))['datepicker']({'dateFormat':_0xddb5ca(0x222),'maxDate':new Date()})['datepicker'](_0xddb5ca(0x259),new Date()),$(_0xddb5ca(0x232))[_0xddb5ca(0x26c)]({'dateFormat':_0xddb5ca(0x222)})[_0xddb5ca(0x26c)](_0xddb5ca(0x259),'-7d'),$(_0xddb5ca(0x202))[_0xddb5ca(0x27a)](formatDateReport(ConvertDateTimeFormat($('#attendance-reportFrom')['val'](),'/'))),$(_0xddb5ca(0x21c))['text'](formatDateReport(ConvertDateTimeFormat($('#attendance-reportTo')[_0xddb5ca(0x255)](),'/')));var _0x30b2be=$(_0xddb5ca(0x232))['datepicker'](_0xddb5ca(0x20b)),_0x45b60e=$('#attendance-reportTo')[_0xddb5ca(0x26c)]('getDate');days=(_0x45b60e-_0x30b2be)/(0x3e8*0x3c*0x3c*0x18);var _0x48b630=Math[_0xddb5ca(0x283)](days);GOfficeDays=Math[_0xddb5ca(0x283)](days),LoadAllOfficeLocation(),LoadAllDepartment(),LoadAllHolidays(),$('#SelectedLocation')[_0xddb5ca(0x27a)]($(_0xddb5ca(0x26a))['text']()),initializePeoplePicker(_0xddb5ca(0x1f9)),initializePeoplePicker('Employee'),$('#attendance-report-filter')[_0xddb5ca(0x233)]('show');});function initializePeoplePicker(_0x39cc9e){var _0x222532=a7_0x483f53,_0xfcea30={};_0xfcea30[_0x222532(0x225)]=_0x222532(0x1fe),_0xfcea30[_0x222532(0x248)]=0xf,_0xfcea30['ResolvePrincipalSource']=0xf,_0xfcea30[_0x222532(0x1fb)]=![],_0xfcea30['MaximumEntitySuggestions']=0x32,_0xfcea30[_0x222532(0x23f)]=_0x222532(0x227),this['SPClientPeoplePicker_InitStandaloneControlWrapper'](_0x39cc9e,null,_0xfcea30);}function ensureUser(_0x3e4a41){var _0x40b14f=a7_0x483f53,_0x5658a2=0x0,_0x527769=_0x3e4a41,_0x686ea4=this[_0x40b14f(0x209)]['SPClientPeoplePickerDict'][_0x527769],_0x18a27e=_0x686ea4[_0x40b14f(0x278)](),_0x278a9d=_0x18a27e[0x0];if(_0x278a9d){var _0x1cd45d={'logonName':_0x278a9d[_0x40b14f(0x238)]};$[_0x40b14f(0x211)]({'url':_spPageContextInfo[_0x40b14f(0x263)]+_0x40b14f(0x203),'type':_0x40b14f(0x282),'async':![],'contentType':_0x40b14f(0x1f2),'data':JSON[_0x40b14f(0x1e7)](_0x1cd45d),'headers':{'X-RequestDigest':$('#__REQUESTDIGEST')[_0x40b14f(0x255)](),'accept':'application/json;odata=verbose'},'success':function(_0x4a64b1,_0x2e430b,_0x2dd485){_0x5658a2=_0x4a64b1['d']['Id'];},'error':function(_0x32fd61,_0x2ad6d0,_0x184d20){}});}else _0x5658a2=0x0;return _0x5658a2;}function GetUserTitle(_0xa441d8){var _0x281f77=a7_0x483f53,_0x7277ee=0x0,_0x2de7fe=_0xa441d8,_0xa94b03=this[_0x281f77(0x209)][_0x281f77(0x22b)][_0x2de7fe],_0x3b43f7=_0xa94b03[_0x281f77(0x278)](),_0x5369cc=_0x3b43f7[0x0];if(_0x5369cc){var _0xfeb487={'logonName':_0x5369cc[_0x281f77(0x238)]};$[_0x281f77(0x211)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x281f77(0x203),'type':'POST','async':![],'contentType':_0x281f77(0x1f2),'data':JSON[_0x281f77(0x1e7)](_0xfeb487),'headers':{'X-RequestDigest':$(_0x281f77(0x240))[_0x281f77(0x255)](),'accept':_0x281f77(0x1f2)},'success':function(_0x4174db,_0x2c732d,_0x242674){var _0x3869e5=_0x281f77;_0x7277ee=_0x4174db['d'][_0x3869e5(0x262)];},'error':function(_0x5cf8e4,_0x4ead3b,_0x30a374){}});}else _0x7277ee=0x0;return _0x7277ee;}function ConvertDateTimeFormat(_0x36d17b,_0x4b7d0c){var _0x259f76=a7_0x483f53;return _0x36d17b[_0x259f76(0x28e)](_0x4b7d0c)[0x1]+''+_0x4b7d0c+''+_0x36d17b[_0x259f76(0x28e)](_0x4b7d0c)[0x0]+''+_0x4b7d0c+''+_0x36d17b[_0x259f76(0x28e)](_0x4b7d0c)[0x2];}function formatDateReport(_0x4d7bf4){var _0xa59f7b=a7_0x483f53,_0x3014d4=new Date(_0x4d7bf4);if(isNaN(_0x3014d4['getTime']()))return _0x4d7bf4;else{var _0xd1807=new Array();return _0xd1807[0x0]=_0xa59f7b(0x1ed),_0xd1807[0x1]='Feb',_0xd1807[0x2]=_0xa59f7b(0x25d),_0xd1807[0x3]=_0xa59f7b(0x29b),_0xd1807[0x4]='May',_0xd1807[0x5]=_0xa59f7b(0x273),_0xd1807[0x6]=_0xa59f7b(0x237),_0xd1807[0x7]=_0xa59f7b(0x212),_0xd1807[0x8]=_0xa59f7b(0x25e),_0xd1807[0x9]=_0xa59f7b(0x22e),_0xd1807[0xa]=_0xa59f7b(0x256),_0xd1807[0xb]=_0xa59f7b(0x223),day=_0x3014d4[_0xa59f7b(0x20b)](),day<0xa&&(day='0'+day),day+'\x20'+_0xd1807[_0x3014d4[_0xa59f7b(0x29e)]()]+'\x20'+_0x3014d4[_0xa59f7b(0x28d)]();}}function LoadAllOfficeLocation(){var _0x193515=a7_0x483f53;$('#OfficeLoc')[_0x193515(0x204)]();var _0xc1a26e=_spPageContextInfo[_0x193515(0x263)]+'/_api/web/lists/GetByTitle(\x27OfficeLocation\x27)/items?$select=ID,OfficeName,CompanyID/ID&$expand=CompanyID&$top=5000&$filter=CompanyID/ID\x20eq\x20\x27'+GCompanyId+'\x27&$orderby=OfficeName\x20asc';$[_0x193515(0x211)]({'url':_0xc1a26e,'headers':{'Accept':_0x193515(0x1f2)},'async':![],'success':function(_0x16ea22){var _0x4015f0=_0x193515;for(var _0x60905f=0x0;_0x60905f<_0x16ea22['d'][_0x4015f0(0x205)][_0x4015f0(0x264)];_0x60905f++){$(_0x4015f0(0x25b))['append'](_0x4015f0(0x1f6)+_0x16ea22['d'][_0x4015f0(0x205)][_0x60905f]['ID']+'\x22>'+_0x16ea22['d'][_0x4015f0(0x205)][_0x60905f][_0x4015f0(0x1f3)]+_0x4015f0(0x21a));}},'myError':function(_0x1d611e){}});}function LoadAllDepartment(){var _0x20605d=a7_0x483f53;$(_0x20605d(0x287))[_0x20605d(0x204)]();var _0x39e6cd=_spPageContextInfo[_0x20605d(0x263)]+_0x20605d(0x23e)+GCompanyId+_0x20605d(0x260);$[_0x20605d(0x211)]({'url':_0x39e6cd,'headers':{'Accept':'application/json;odata=verbose'},'async':!![],'success':function(_0x387bd5){var _0xb13ff4=_0x20605d;$(_0xb13ff4(0x29d))[_0xb13ff4(0x200)](_0xb13ff4(0x287));for(var _0x5f172f=0x0;_0x5f172f<_0x387bd5['d'][_0xb13ff4(0x205)][_0xb13ff4(0x264)];_0x5f172f++){$(_0xb13ff4(0x287))[_0xb13ff4(0x22a)](_0xb13ff4(0x1f6)+_0x387bd5['d'][_0xb13ff4(0x205)][_0x5f172f]['ID']+'\x22>'+_0x387bd5['d'][_0xb13ff4(0x205)][_0x5f172f]['Title']+'</option>');}},'myError':function(_0x1e3bad){}});}var TotalOfficeDays=0x0,GtotalHolidays=0x0;function LoadAllHolidays(){var _0x3a08a4=a7_0x483f53,_0x289901=$(_0x3a08a4(0x25b))[_0x3a08a4(0x255)]();TotalOfficeDays=0x0,GtotalHolidays=0x0;var _0x466b77=new Date(ConvertDateTimeFormat($(_0x3a08a4(0x232))['val'](),'/')),_0x5121b9=_0x466b77['getFullYear']()+'-'+(_0x466b77[_0x3a08a4(0x29e)]()+0x1)+'-'+_0x466b77['getDate'](),_0x4f2a77=new Date(ConvertDateTimeFormat($(_0x3a08a4(0x219))[_0x3a08a4(0x255)](),'/')),_0x4b0b37=_0x4f2a77[_0x3a08a4(0x28d)]()+'-'+(_0x4f2a77[_0x3a08a4(0x29e)]()+0x1)+'-'+_0x4f2a77[_0x3a08a4(0x20b)](),_0x16b0a3=_spPageContextInfo[_0x3a08a4(0x263)]+'/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?select=*,ID,Title&$filter=OfficeLocationID\x20eq\x20\x27'+_0x289901+_0x3a08a4(0x1e2)+GCompanyId+'\x27\x20and\x20Holiday_start\x20ge\x20\x27'+_0x5121b9+_0x3a08a4(0x28a)+_0x4b0b37+'\x27';$[_0x3a08a4(0x211)]({'url':_0x16b0a3,'headers':{'Accept':_0x3a08a4(0x1f2)},'async':![],'success':function(_0x3b0933){var _0x4f2d95=_0x3a08a4,_0x1b342b=_0x3b0933['d']['results'][_0x4f2d95(0x264)];GtotalHolidays=_0x1b342b,$(_0x4f2d95(0x207))[_0x4f2d95(0x27a)](_0x1b342b),$(_0x4f2d95(0x25c))[_0x4f2d95(0x27a)](parseInt(GOfficeDays)-parseInt(_0x1b342b)),TotalOfficeDays=parseInt(GOfficeDays)-parseInt(_0x1b342b);},'myError':function(_0x21284b){}});}function Applyfilter(){var _0x5d556e=a7_0x483f53;$(_0x5d556e(0x202))[_0x5d556e(0x27a)](formatDateReport(ConvertDateTimeFormat($(_0x5d556e(0x232))['val'](),'/'))),$(_0x5d556e(0x21c))[_0x5d556e(0x27a)](formatDateReport(ConvertDateTimeFormat($(_0x5d556e(0x219))[_0x5d556e(0x255)](),'/'))),$('#SelectedLocation')['text']($(_0x5d556e(0x26a))[_0x5d556e(0x27a)]()),$(_0x5d556e(0x252))[_0x5d556e(0x27a)](formatDateReport(ConvertDateTimeFormat($(_0x5d556e(0x232))['val'](),'/'))),$(_0x5d556e(0x276))[_0x5d556e(0x27a)](formatDateReport(ConvertDateTimeFormat($(_0x5d556e(0x219))[_0x5d556e(0x255)](),'/'))),$('#officeLocTH')[_0x5d556e(0x27a)]($(_0x5d556e(0x26a))[_0x5d556e(0x27a)]()),$(_0x5d556e(0x27c))[_0x5d556e(0x27a)](TotalOfficeDays),$('#HolidaysTH')[_0x5d556e(0x27a)](GtotalHolidays);var _0x43ec33=$(_0x5d556e(0x232))['datepicker'](_0x5d556e(0x20b)),_0x246551=$(_0x5d556e(0x219))['datepicker']('getDate');days=(_0x246551-_0x43ec33)/(0x3e8*0x3c*0x3c*0x18),GOfficeDays=Math[_0x5d556e(0x283)](days)+0x1,LoadAllHolidays(),$('#attendencedateValue')[_0x5d556e(0x255)]('');var _0x385955=$(_0x5d556e(0x232))[_0x5d556e(0x255)](),_0x573b52=moment($(_0x5d556e(0x232))[_0x5d556e(0x255)](),'DD/MM/YYYY')[_0x5d556e(0x296)](_0x5d556e(0x235)),_0x232bad=moment($(_0x5d556e(0x219))[_0x5d556e(0x255)](),_0x5d556e(0x220))[_0x5d556e(0x296)](_0x5d556e(0x235));$(_0x5d556e(0x1f5))['text']($[_0x5d556e(0x26c)][_0x5d556e(0x261)](_0x5d556e(0x20a),new Date(_0x573b52))),$('#monthhyear')[_0x5d556e(0x27a)]($[_0x5d556e(0x26c)][_0x5d556e(0x261)](_0x5d556e(0x289),new Date(_0x573b52)));var _0x29cb36='',_0x2fe1e9='';$(_0x5d556e(0x25b))[_0x5d556e(0x255)]()!='All'&&(_0x29cb36+=_0x5d556e(0x267)+$(_0x5d556e(0x25b))[_0x5d556e(0x255)]()+'\x27\x20',_0x2fe1e9+=_0x5d556e(0x1e6)+$(_0x5d556e(0x26a))[_0x5d556e(0x27a)]()+_0x5d556e(0x221));$(_0x5d556e(0x287))[_0x5d556e(0x255)]()!='All'&&(_0x29cb36+='and\x20Department\x20eq\x20\x27'+$('#DepartmentDDL')['val']()+'\x27\x20',_0x2fe1e9+='<div\x20class=\x27upload-chip\x27>'+$(_0x5d556e(0x1ef))[_0x5d556e(0x27a)]()+_0x5d556e(0x221));var _0x374608=ensureUser($(_0x5d556e(0x229))['children']()[_0x5d556e(0x26e)]()[_0x5d556e(0x266)]('id')),_0x15bc86=ensureUser($('#Employee')['children']()[_0x5d556e(0x26e)]()[_0x5d556e(0x266)]('id'));_0x374608!=0x0&&(_0x29cb36+=_0x5d556e(0x201)+_0x374608+'\x27\x20',_0x2fe1e9+='<div\x20class=\x27upload-chip\x27>'+GetUserTitle($(_0x5d556e(0x229))[_0x5d556e(0x26e)]()[_0x5d556e(0x26e)]()[_0x5d556e(0x266)]('id'))+_0x5d556e(0x221)),_0x15bc86!=0x0&&(_0x29cb36+='and\x20LogonName/ID\x20eq\x20\x27'+_0x15bc86+'\x27\x20',_0x2fe1e9+=_0x5d556e(0x1e6)+GetUserTitle($(_0x5d556e(0x284))[_0x5d556e(0x26e)]()[_0x5d556e(0x26e)]()[_0x5d556e(0x266)]('id'))+_0x5d556e(0x221)),$(_0x5d556e(0x214))[_0x5d556e(0x204)](),$(_0x5d556e(0x214))[_0x5d556e(0x22a)](_0x2fe1e9),$(_0x5d556e(0x1ea))[_0x5d556e(0x234)](),setTimeout(function(){var _0x38fa01=_0x5d556e,_0x18005c=_spPageContextInfo['webAbsoluteUrl']+_0x38fa01(0x293)+_0x573b52+_0x38fa01(0x274)+_0x232bad+'\x27\x20';$[_0x38fa01(0x277)](getFileData(_0x18005c))[_0x38fa01(0x239)](function(_0xfcc718){var _0x140b1e=_0x38fa01,_0x13e0c3=_spPageContextInfo[_0x140b1e(0x263)]+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,ManagerLoginName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,ManagerLoginName,OfficeLocation,Company,Department&$filter=Status\x20eq\x20\x27Active\x27\x20and\x20Company/ID\x20\x20eq\x20\x27'+GCompanyId+'\x27'+_0x29cb36;EmployeeListDat(_0x13e0c3),$(_0x140b1e(0x1ea))[_0x140b1e(0x27e)]();});},0x5dc);}var TempStore=[],unique='';function a7_0x51b8(){var _0x2a8710=['SearchPrincipalSource','496170BKewGo','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27>','value','map','LeavesDay','HrAction','1122990uCFhFz','getQueryStringParameter','log','#FdateTH','&sourcelocation=../Pages/Report.aspx#','innerHTML','val','Nov','AttendanceDate','1st\x20Half','setDate','pagedropdown','#OfficeLoc','#TotalOfficeDays','Mar','Sept','MM/DD/YYYY','\x27&$orderby=Title\x20asc&$top=5000','formatDate','Title','webAbsoluteUrl','length','blue','attr','and\x20OfficeLocation\x20eq\x20\x27','EmpWorkHours','5566913iFsDFb','#OfficeLoc\x20option:selected','percentage','datepicker','LogonName','children','/Pages/EmployeeReport.aspx?EID=','Department','responseJSON','__next','Jun','\x27\x20and\x20AttendanceDate\x20le\x20\x27','&end=','#EdateTH','when','GetAllUserInfo','AttendanceType','text','Full\x20Day','#TotalWorkdayTH','userId','fadeOut','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>0</div></td>','concat','asc','POST','round','#Employee','Reptotalpages','Loading...','#DepartmentDDL','userDisplayName','M\x20\x20yy','\x27\x20and\x20Holiday_start\x20le\x20\x27','.NoRecordFound','location','getFullYear','split','58HDeOth','<tr\x20class=\x27text-center\x27>','ready','join','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27','Worksheet','AuthorId','format','replace','Deferred','AttendancDays','UserId','Apr','tablenav','<option\x20value=\x22All\x22>All</option>','getMonth','nodeType','&start=','error','\x27\x20and\x20CompanyID\x20eq\x20\x27','GET','4EmSJXI','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>-</div></td>','<div\x20class=\x27upload-chip\x27>','stringify','Reptotalrecords','Employee','#overlaysearch','floor','/_api/web/lists/getbytitle(\x27EnvironmentalSettings\x27)/items?$select=Title,Active,ListOfUsers/Title&$filter=Title\x20eq\x20\x27Attendance\x20Entry\x27\x20&$expand=ListOfUsers/Id','Jan','2464173LrLaFI','#DepartmentDDL\x20option:selected','8dIWVYA','Active','application/json;odata=verbose','OfficeName','This\x20feature\x20has\x20been\x20deactivated\x20!','#daydate','<option\x20value=\x22','00:00\x20(H:M)','ModalDialog','Manager','black','AllowMultipleValues','777RRtfuU','desc','User,DL,SecGroup,SPGroup','Rependrecord','appendTo','and\x20ManagerLoginName\x20eq\x20\x27','#FromDate','/_api/web/ensureuser','empty','results','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>','#TotalHolidays','filter','SPClientPeoplePicker','D,\x20dd','getDate','red','oddselected','includes','WorkHours','NotActionDays','ajax','Aug','selectedrow','#chips','ReportTableData','#ReportTableData>tbody\x20>tr','getElementById','#TotalItemscount','#attendance-reportTo','</option>','data:application/vnd.ms-excel;base64,','#ToDate','360192faTSid','push','On\x20Leave','DD/MM/YYYY','</div>','dd/mm/yy','Dec','OfficeLocation','PrincipalAccountType','32748rhDpVL','280px','</tr>','#Manager','append','SPClientPeoplePickerDict','table','grep','Oct','promise','2nd\x20Half','Attendance\x20Entry','#attendance-reportFrom','modal','fadeIn','YYYY-MM-DD','</div></td>','Jul','Key','done','Error\x20in\x20getFileData.','4087rtrjmA','href','#ReportTable','/_api/web/lists/getbytitle(\x27Departments\x27)/items?select=ID,Title&$filter=CompanyID\x20eq\x20\x27','Width','#__REQUESTDIGEST','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>00:00</div></td>','btoa','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000','indexOf','sorter','CompanyId','showWaitScreenWithNoClose'];a7_0x51b8=function(){return _0x2a8710;};return a7_0x51b8();}function getFileData(_0x2eb9b3){var _0x25fc8e=a7_0x483f53;jQuery[_0x25fc8e(0x211)]({'url':_0x2eb9b3,'headers':{'Accept':_0x25fc8e(0x1f2)},'async':![],'success':function(_0x32b1f5){var _0x39d98b=_0x25fc8e;EmpAttendanceData=[];var _0x4790cf=_0x32b1f5['d']['results'];if(_0x4790cf[_0x39d98b(0x264)]>0x0){TempStore=[];for(var _0x5400ac=0x0;_0x5400ac<_0x4790cf[_0x39d98b(0x264)];_0x5400ac++){TempStore[_0x39d98b(0x21e)](_0x4790cf[_0x5400ac][_0x39d98b(0x1e9)]['ID']);}unique=TempStore[_0x39d98b(0x208)](function(_0xf30327,_0x3bf5d5,_0x3ed5ef){var _0x5984d6=_0x39d98b;return _0x3bf5d5==_0x3ed5ef[_0x5984d6(0x244)](_0xf30327);});if(unique[_0x39d98b(0x264)]>0x0){EmpAttendanceData=[];for(var _0x22eada=0x0;_0x22eada<unique['length'];_0x22eada++){var _0x537e71=0x0,_0x202277=[],_0xfc899a=[],_0x31b901=moment($(_0x39d98b(0x232))[_0x39d98b(0x255)](),_0x39d98b(0x220))[_0x39d98b(0x296)](_0x39d98b(0x235)),_0x1fbeb8=moment($('#attendance-reportTo')[_0x39d98b(0x255)](),_0x39d98b(0x220))[_0x39d98b(0x296)](_0x39d98b(0x235)),_0x12d47e=unique[_0x22eada],_0x479297=_spPageContextInfo['webAbsoluteUrl']+'/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27'+_0x31b901+_0x39d98b(0x274)+_0x1fbeb8+'\x27\x20and\x20Employee\x20eq\x20\x27'+_0x12d47e+'\x27\x20';jQuery[_0x39d98b(0x211)]({'url':_0x479297,'headers':{'Accept':_0x39d98b(0x1f2)},'async':![],'success':function(_0x5ac151){var _0x5d2d30=_0x39d98b,_0x5066d7=_0x5ac151['d'][_0x5d2d30(0x205)];if(_0x5066d7[_0x5d2d30(0x264)]>0x0){for(var _0x24508c=0x0;_0x24508c<_0x5066d7[_0x5d2d30(0x264)];_0x24508c++){var _0x152f95=_0x5066d7[_0x24508c]['ID'],_0x49ecc7=_0x5066d7[_0x24508c][_0x5d2d30(0x1e9)][_0x5d2d30(0x262)],_0xb3ccd4=_0x5066d7[_0x24508c][_0x5d2d30(0x1e9)]['ID'],_0x389df7=_0x5066d7[_0x24508c][_0x5d2d30(0x257)],_0x197702=_0x5066d7[_0x24508c][_0x5d2d30(0x279)];if(_0x197702=='Full\x20Day'||_0x197702==_0x5d2d30(0x258)||_0x197702==_0x5d2d30(0x230))_0x202277['push'](_0x197702);else _0x197702==_0x5d2d30(0x21f)&&_0xfc899a['push'](_0x197702);_0x5066d7[_0x24508c][_0x5d2d30(0x20f)]!=null&&(_0x537e71=parseInt(_0x537e71)+parseInt(_0x5066d7[_0x24508c][_0x5d2d30(0x20f)]));var _0x51d7af=_0x5066d7[_0x24508c][_0x5d2d30(0x24e)],_0x23bc7b=parseInt(_0x202277['length'])+parseInt(_0xfc899a['length']),_0x5a8066=parseInt(TotalOfficeDays)-parseInt(_0x23bc7b);_0x5a8066<0x0&&(_0x5a8066=0x0);}var _0x5a5de0=Math[_0x5d2d30(0x283)](parseInt(_0x23bc7b)/parseInt(TotalOfficeDays)*0x64)+'%';TotalOfficeDays=='0'&&(_0x5a5de0='-'),EmpAttendanceData[_0x5d2d30(0x21e)]({'UserId':_0xb3ccd4,'EmpName':_0x49ecc7,'AttendanceDate':_0x389df7,'AttendanceType':_0x197702,'AttendanceItemId':_0x152f95,'EmpWorkHours':_0x537e71,'HrAction':_0x51d7af,'AttendancDays':_0x202277[_0x5d2d30(0x264)],'LeavesDay':_0xfc899a[_0x5d2d30(0x264)],'NotActionDays':_0x5a8066,'percentage':_0x5a5de0});}},'error':function(_0x4ddbe9,_0x32cfe7){var _0x570dcf=_0x39d98b;console[_0x570dcf(0x251)](JSON[_0x570dcf(0x1e7)](_0x4ddbe9));}});}}}},'error':function(_0x4b7d4e,_0xa814ef,_0x4537af){var _0xa0085b=_0x25fc8e;console[_0xa0085b(0x251)](_0xa0085b(0x23a)),console[_0xa0085b(0x251)](_0x4b7d4e[_0xa0085b(0x271)][_0xa0085b(0x1e1)]['message']['value']);var _0x23e41b=_0x4b7d4e[_0xa0085b(0x271)][_0xa0085b(0x1e1)]['message'][_0xa0085b(0x24b)],_0x268371=_0x23e41b[_0xa0085b(0x20e)]('it\x20exceeds\x20the\x20list\x20view\x20threshold');_0x268371==!![]&&(AttendanceReportUsageData=[],AttendanceReportUsageUrl=_spPageContextInfo[_0xa0085b(0x263)]+_0xa0085b(0x243),ReadEmpReportUsageData());}});}var AttendanceReportUsageData=AttendanceReportUsageData||[],AttendanceReportUsageUrl='';function ReadEmpReportUsageData(){var _0x540c5f=a7_0x483f53;return dfds=$[_0x540c5f(0x298)](),$['ajax']({'url':AttendanceReportUsageUrl,'headers':{'Accept':_0x540c5f(0x1f2)},'async':![],'success':function(_0x3a4352){var _0x1237c4=_0x540c5f;FilterState=0x0,AttendanceReportUsageData=AttendanceReportUsageData[_0x1237c4(0x280)](_0x3a4352['d'][_0x1237c4(0x205)]);if(_0x3a4352['d'][_0x1237c4(0x272)])AttendanceReportUsageUrl=_0x3a4352['d'][_0x1237c4(0x272)],ReadEmpReportUsageData();else{if(AttendanceReportUsageData[_0x1237c4(0x264)]>0x0){var _0x5e8060=moment(ConvertDateTimeFormat($(_0x1237c4(0x232))[_0x1237c4(0x255)](),'/'))['format'](_0x1237c4(0x25f)),_0x2004e9=moment(ConvertDateTimeFormat($(_0x1237c4(0x219))[_0x1237c4(0x255)](),'/'))[_0x1237c4(0x296)](_0x1237c4(0x25f)),_0x1b0451=AttendanceReportUsageData['filter'](function(_0x16149a){var _0x2de40e=_0x1237c4;return Created=moment(_0x16149a['AttendanceDate'])['format'](_0x2de40e(0x25f)),(_0x5e8060==''?Created!='':Created>=_0x5e8060)&&(_0x2004e9==''?Created!='':Created<=_0x2004e9);});AttendanceReportUsageData=_0x1b0451;var _0x2fdefb=[...new Map(AttendanceReportUsageData[_0x1237c4(0x24c)](_0x309932=>[_0x309932[_0x1237c4(0x295)],_0x309932]))['values']()];TempStore=[];for(var _0x3e416a=0x0;_0x3e416a<AttendanceReportUsageData[_0x1237c4(0x264)];_0x3e416a++){TempStore['push'](AttendanceReportUsageData[_0x3e416a][_0x1237c4(0x1e9)]['ID']);}unique=TempStore[_0x1237c4(0x208)](function(_0xae46e5,_0x1bdbf2,_0x47a542){var _0x2444c8=_0x1237c4;return _0x1bdbf2==_0x47a542[_0x2444c8(0x244)](_0xae46e5);});if(unique[_0x1237c4(0x264)]>0x0){EmpAttendanceData=[];for(var _0x14839c=0x0;_0x14839c<unique[_0x1237c4(0x264)];_0x14839c++){var _0x30d375=0x0,_0x1156cf=[],_0x1bace2=[],_0x4dd2ac=moment($(_0x1237c4(0x232))['val'](),_0x1237c4(0x220))[_0x1237c4(0x296)](_0x1237c4(0x235)),_0x24f5a1=moment($('#attendance-reportTo')['val'](),'DD/MM/YYYY')[_0x1237c4(0x296)](_0x1237c4(0x235)),_0x400458=unique[_0x14839c],_0xd583bc=$[_0x1237c4(0x22d)](AttendanceReportUsageData,function(_0x4f8d33){var _0x12e729=_0x1237c4;return _0x4f8d33[_0x12e729(0x1e9)]['ID']==_0x400458;}),_0x492037=_0xd583bc;if(_0x492037[_0x1237c4(0x264)]>0x0){for(var _0x13a58d=0x0;_0x13a58d<_0x492037[_0x1237c4(0x264)];_0x13a58d++){var _0x140ffd=_0x492037[_0x13a58d]['ID'],_0x40ab18=_0x492037[_0x13a58d][_0x1237c4(0x1e9)][_0x1237c4(0x262)],_0x3bc0c4=_0x492037[_0x13a58d]['Employee']['ID'],_0x4f8ca1=_0x492037[_0x13a58d][_0x1237c4(0x257)],_0x2374de=_0x492037[_0x13a58d][_0x1237c4(0x279)];if(_0x2374de==_0x1237c4(0x27b)||_0x2374de=='1st\x20Half'||_0x2374de==_0x1237c4(0x230))_0x1156cf[_0x1237c4(0x21e)](_0x2374de);else _0x2374de==_0x1237c4(0x21f)&&_0x1bace2['push'](_0x2374de);_0x492037[_0x13a58d][_0x1237c4(0x20f)]!=null&&(_0x30d375=parseInt(_0x30d375)+parseInt(_0x492037[_0x13a58d][_0x1237c4(0x20f)]));var _0x286c66=_0x492037[_0x13a58d][_0x1237c4(0x24e)],_0x177e5c=parseInt(_0x1156cf['length'])+parseInt(_0x1bace2[_0x1237c4(0x264)]),_0x40cff1=parseInt(TotalOfficeDays)-parseInt(_0x177e5c);_0x40cff1<0x0&&(_0x40cff1=0x0);}var _0x39ee3b=Math['round'](parseInt(_0x177e5c)/parseInt(TotalOfficeDays)*0x64)+'%';TotalOfficeDays=='0'&&(_0x39ee3b='-'),EmpAttendanceData[_0x1237c4(0x21e)]({'UserId':_0x3bc0c4,'EmpName':_0x40ab18,'AttendanceDate':_0x4f8ca1,'AttendanceType':_0x2374de,'AttendanceItemId':_0x140ffd,'EmpWorkHours':_0x30d375,'HrAction':_0x286c66,'AttendancDays':_0x1156cf[_0x1237c4(0x264)],'LeavesDay':_0x1bace2[_0x1237c4(0x264)],'NotActionDays':_0x40cff1,'percentage':_0x39ee3b});}}}}}},'error':function(_0x585438,_0x66895b,_0x211148){}}),dfds[_0x540c5f(0x22f)]();}function OpenMyCustomLoader(){var _0x5480a2=a7_0x483f53,_0x477674=_0x5480a2(0x286),_0x4962db='<br\x20/>Please\x20wait!!',_0x3aafcf=0xc8,_0x554b12=0x190;currentDlg=SP['UI'][_0x5480a2(0x1f8)][_0x5480a2(0x247)](_0x477674,_0x4962db,_0x3aafcf,_0x554b12);}function CloseMyCustomLoader(){currentDlg['close']();}function EmployeeListDat(_0xcdaaf4){var _0x1633e8=a7_0x483f53;$[_0x1633e8(0x211)]({'url':_0xcdaaf4,'headers':{'Accept':_0x1633e8(0x1f2)},'async':![],'success':function(_0x32f3d2){var _0x1a4d79=_0x1633e8,_0x26a08b=_0x32f3d2['d'][_0x1a4d79(0x205)];$(_0x1a4d79(0x23d))[_0x1a4d79(0x204)]();var _0x4067f1='';if(_0x26a08b[_0x1a4d79(0x264)]>0x0){var _0x4cd1fb=0x0,_0x402730=0x0,_0x47b087=0x0;for(var _0x79d0a2=0x0;_0x79d0a2<_0x26a08b[_0x1a4d79(0x264)];_0x79d0a2++){var _0x595b24=_0x26a08b[_0x79d0a2]['ID'],_0x1832b2=_0x26a08b[_0x79d0a2]['LogonName']['ID'],_0x32dcaf=_0x26a08b[_0x79d0a2][_0x1a4d79(0x26d)][_0x1a4d79(0x262)],_0xe49e74=_0x26a08b[_0x79d0a2]['Designation'],_0x1006a7=_0x26a08b[_0x79d0a2][_0x1a4d79(0x270)]['DepartmentName'],_0x5410e3=_0x26a08b[_0x79d0a2]['ManagerLoginName'][_0x1a4d79(0x262)];_0x5410e3==undefined&&(_0x5410e3='');var _0x1eea4b=_0x1a4d79(0x1f7),_0x2de984='',_0x4095f2=_0x1a4d79(0x1fa);_0xe49e74==null&&(_0xe49e74='');var _0x2865ef=_0x26a08b[_0x79d0a2][_0x1a4d79(0x224)][_0x1a4d79(0x1f3)];_0x2865ef==null&&(_0x2865ef='');EmployeeId=_0x26a08b[_0x79d0a2][_0x1a4d79(0x26d)]['ID'];var _0x50d6a0=moment($(_0x1a4d79(0x232))[_0x1a4d79(0x255)](),_0x1a4d79(0x220))[_0x1a4d79(0x296)](_0x1a4d79(0x235)),_0x3db000=moment($(_0x1a4d79(0x219))[_0x1a4d79(0x255)](),_0x1a4d79(0x220))['format'](_0x1a4d79(0x235)),_0x50d6a0=_0x50d6a0[_0x1a4d79(0x28e)]('-')['join'](''),_0x3db000=_0x3db000[_0x1a4d79(0x28e)]('-')[_0x1a4d79(0x292)](''),_0x2eee29=_spPageContextInfo['webServerRelativeUrl']+_0x1a4d79(0x26f)+_0x1832b2+_0x1a4d79(0x2a0)+_0x50d6a0+_0x1a4d79(0x275)+_0x3db000+'&WebAppId='+titanForWork[_0x1a4d79(0x250)](_0x1a4d79(0x246))+_0x1a4d79(0x253),_0x31acfc=EmpAttendanceData[_0x1a4d79(0x24c)](function(_0x49240c){return _0x49240c['UserId'];})[_0x1a4d79(0x244)](EmployeeId);if(_0x31acfc!=-0x1){var _0x40d23d=EmpAttendanceData[_0x31acfc][_0x1a4d79(0x29a)],_0x15c078=EmpAttendanceData[_0x31acfc][_0x1a4d79(0x279)],_0x3794b5=EmpAttendanceData[_0x31acfc]['AttendanceItemId'];_0x1eea4b=EmpAttendanceData[_0x31acfc][_0x1a4d79(0x268)];var _0x5a49d4=EmpAttendanceData[_0x31acfc][_0x1a4d79(0x268)];_0x2de984=EmpAttendanceData[_0x31acfc]['AttendanceItemId'];var _0x7b312f=EmpAttendanceData[_0x31acfc][_0x1a4d79(0x299)],_0x5e5957=EmpAttendanceData[_0x31acfc][_0x1a4d79(0x24d)],_0x1a8dee=EmpAttendanceData[_0x31acfc][_0x1a4d79(0x210)],_0x208fb2=EmpAttendanceData[_0x31acfc][_0x1a4d79(0x26b)],_0x2bad44='';EmpAttendanceData[_0x31acfc][_0x1a4d79(0x24e)]==!![]?_0x2bad44='checked':_0x2bad44='',_0x1eea4b==null&&(_0x1eea4b=_0x1a4d79(0x1f7)),_0x15c078=='On\x20Leave'&&(_0x4095f2=_0x1a4d79(0x20c),_0x47b087++),_0x15c078=='Holiday'&&(_0x4095f2=_0x1a4d79(0x265)),_0x4067f1+=_0x1a4d79(0x290),_0x4067f1+=_0x1a4d79(0x24a)+_0x32dcaf+'</div></td>',_0x4067f1+=_0x1a4d79(0x24a)+_0xe49e74+_0x1a4d79(0x236),_0x4067f1+=_0x1a4d79(0x206)+_0x1006a7+_0x1a4d79(0x236),_0x4067f1+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x5410e3+_0x1a4d79(0x236),_0x4067f1+=_0x1a4d79(0x206)+_0x7b312f+_0x1a4d79(0x236),_0x4067f1+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x1a8dee+'</div></td>',_0x4067f1+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x5e5957+_0x1a4d79(0x236),_0x4067f1+=_0x1a4d79(0x206)+ConvertHHMM(_0x1eea4b)+'</div></td>',_0x4067f1+=_0x1a4d79(0x206)+_0x208fb2+_0x1a4d79(0x236),_0x4067f1+='<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27><a\x20href=\x27'+_0x2eee29+'\x27\x20class=\x27custom-edit-btn\x27><i\x20class=\x27fa\x20fa-chevron-right\x27></i></a></div></td>',_0x4067f1+=_0x1a4d79(0x228);}else _0x4067f1+=_0x1a4d79(0x290),_0x4067f1+=_0x1a4d79(0x24a)+_0x32dcaf+'</div></td>',_0x4067f1+=_0x1a4d79(0x24a)+_0xe49e74+_0x1a4d79(0x236),_0x4067f1+=_0x1a4d79(0x206)+_0x1006a7+_0x1a4d79(0x236),_0x4067f1+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x5410e3+'</div></td>',_0x4067f1+=_0x1a4d79(0x27f),_0x4067f1+=_0x1a4d79(0x206)+TotalOfficeDays+_0x1a4d79(0x236),_0x4067f1+=_0x1a4d79(0x27f),_0x4067f1+=_0x1a4d79(0x241),_0x4067f1+=_0x1a4d79(0x1e5),_0x4067f1+='<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27><a\x20href=\x27'+_0x2eee29+'\x27\x20class=\x27custom-edit-btn\x27><i\x20class=\x27fa\x20fa-chevron-right\x27></i></a></div></td>',_0x4067f1+=_0x1a4d79(0x228);}}else{}_0x26a08b['length']==0x0?$(_0x1a4d79(0x28b))['show']():$(_0x1a4d79(0x28b))['hide']();$(_0x1a4d79(0x23d))[_0x1a4d79(0x22a)](_0x4067f1);var _0xb847e1=$(_0x1a4d79(0x216))[_0x1a4d79(0x264)];$(_0x1a4d79(0x218))[_0x1a4d79(0x27a)](_0xb847e1),$('#totalemp')[_0x1a4d79(0x27a)](_0xb847e1),_0xb847e1>0x0&&ReportTableConfiguration();},'error':function(_0x28d35f){var _0xe5b87a=_0x1633e8;console[_0xe5b87a(0x251)](_0x28d35f);}});}function a7_0x19b3(_0x196ef5,_0x27cfe8){var _0x51b897=a7_0x51b8();return a7_0x19b3=function(_0x19b35b,_0x513326){_0x19b35b=_0x19b35b-0x1e1;var _0x3928a2=_0x51b897[_0x19b35b];return _0x3928a2;},a7_0x19b3(_0x196ef5,_0x27cfe8);}function ReportTableConfiguration(){var _0x15abf8=a7_0x483f53;sorter=new TINY[(_0x15abf8(0x22c))][(_0x15abf8(0x245))](_0x15abf8(0x245),_0x15abf8(0x215),{'ascclass':_0x15abf8(0x281),'descclass':_0x15abf8(0x1fd),'evenclass':'evenrow','oddclass':'oddrow','evenselclass':'evenselected','oddselclass':_0x15abf8(0x20d),'paginate':!![],'size':0xa,'colddid':'columns','currentid':'Repcurrentpage','totalid':_0x15abf8(0x285),'startingrecid':'Repstartrecord','endingrecid':_0x15abf8(0x1ff),'totalrecid':_0x15abf8(0x1e8),'hoverid':_0x15abf8(0x213),'pageddid':_0x15abf8(0x25a),'navid':_0x15abf8(0x29c),'sortdir':0x1,'init':!![]});}function ConvertHHMM(_0x1431c7){var _0x38ddae=a7_0x483f53,_0x5410fd=Math[_0x38ddae(0x1eb)](_0x1431c7/0x3c),_0x461163=_0x1431c7%0x3c;_0x5410fd<0xa&&(_0x5410fd='0'+_0x5410fd);_0x461163<0xa&&(_0x461163='0'+_0x461163);var _0x3a5a7b=_0x5410fd+':'+_0x461163;return _0x3a5a7b;}function CloseModel(){var _0x103661=a7_0x483f53;initializePeoplePicker(_0x103661(0x1f9)),initializePeoplePicker('Employee');}var tableToExcel=(function(){var _0x44a9f0=a7_0x483f53,_0x567ca6=_0x44a9f0(0x21b),_0x5cb7b2='<html\x20xmlns:o=\x22urn:schemas-microsoft-com:office:office\x22\x20xmlns:x=\x22urn:schemas-microsoft-com:office:excel\x22\x20xmlns=\x22http://www.w3.org/TR/REC-html40\x22><head><!--[if\x20gte\x20mso\x209]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>',_0x35c41e=function(_0x503d4c){var _0x369622=_0x44a9f0;return window[_0x369622(0x242)](unescape(encodeURIComponent(_0x503d4c)));},_0x283078=function(_0x556b2d,_0x36fbda){var _0xe6b50b=_0x44a9f0;return _0x556b2d[_0xe6b50b(0x297)](/{(\w+)}/g,function(_0x40b143,_0x51f2e6){return _0x36fbda[_0x51f2e6];});};return function(_0x1d05ed,_0x3a7f4d){var _0x17fe23=_0x44a9f0;if(!_0x1d05ed[_0x17fe23(0x29f)])_0x1d05ed=document[_0x17fe23(0x217)](_0x1d05ed);var _0x28c040={'worksheet':_0x3a7f4d||_0x17fe23(0x294),'table':_0x1d05ed[_0x17fe23(0x254)]};window[_0x17fe23(0x28c)][_0x17fe23(0x23c)]=_0x567ca6+_0x35c41e(_0x283078(_0x5cb7b2,_0x28c040));};}()),authentication=function(){var _0x2adb57=a7_0x483f53,_0x1677c2=_spPageContextInfo[_0x2adb57(0x288)],_0x422e95=_spPageContextInfo[_0x2adb57(0x263)]+_0x2adb57(0x1ec);$[_0x2adb57(0x211)]({'url':_0x422e95,'async':![],'type':_0x2adb57(0x1e3),'headers':{'accept':'application/json;\x20odata=verbose'},'success':function(_0x32c10d){var _0x1779d3=_0x2adb57;debugger;var _0x10aeff=_0x32c10d['d'][_0x1779d3(0x205)];if(_0x10aeff['length']>0x0)for(var _0x3f7873=0x0;_0x3f7873<_0x10aeff[_0x1779d3(0x264)];_0x3f7873++){if(_0x10aeff[_0x3f7873]['Title']==_0x1779d3(0x231)){if(_0x10aeff[_0x3f7873][_0x1779d3(0x1f1)]==![])return alert(_0x1779d3(0x1f4)),window[_0x1779d3(0x28c)]=_spPageContextInfo[_0x1779d3(0x263)]+'/Pages/Myworkplace.aspx?WebAppId=232SHDFGHJF22B2526DFG',![];}}},'error':function(_0x3770b5){alert(JSON['stringify'](_0x3770b5));}});};