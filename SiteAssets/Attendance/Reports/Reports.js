var a45_0xd0d100=a45_0x2dda;(function(_0x4d8c05,_0x3853ed){var _0xfc84c2=a45_0x2dda,_0xbaf79=_0x4d8c05();while(!![]){try{var _0x4b9efa=-parseInt(_0xfc84c2(0x230))/0x1*(parseInt(_0xfc84c2(0x233))/0x2)+parseInt(_0xfc84c2(0x204))/0x3+parseInt(_0xfc84c2(0x22f))/0x4+parseInt(_0xfc84c2(0x254))/0x5*(-parseInt(_0xfc84c2(0x21b))/0x6)+-parseInt(_0xfc84c2(0x259))/0x7+parseInt(_0xfc84c2(0x251))/0x8+-parseInt(_0xfc84c2(0x23f))/0x9;if(_0x4b9efa===_0x3853ed)break;else _0xbaf79['push'](_0xbaf79['shift']());}catch(_0x26f85c){_0xbaf79['push'](_0xbaf79['shift']());}}}(a45_0x87ef,0x51742));var GCompanyId='',GOfficeDays='';$(document)[a45_0xd0d100(0x20e)](function(){var _0x311a30=a45_0xd0d100;userActivityNotificationEntry(_spPageContextInfo[_0x311a30(0x1dd)],window[_0x311a30(0x20d)]),authentication(),GCompanyId=titanForWork[_0x311a30(0x25b)](_0x311a30(0x1e7)),$('#attendance-reportTo')[_0x311a30(0x1f5)]({'dateFormat':_0x311a30(0x24d),'maxDate':new Date()})[_0x311a30(0x1f5)](_0x311a30(0x25f),new Date()),$(_0x311a30(0x210))[_0x311a30(0x1f5)]({'dateFormat':_0x311a30(0x24d)})[_0x311a30(0x1f5)]('setDate',_0x311a30(0x242)),$(_0x311a30(0x238))['text'](formatDateReport(ConvertDateTimeFormat($(_0x311a30(0x210))[_0x311a30(0x1cd)](),'/'))),$('#ToDate')['text'](formatDateReport(ConvertDateTimeFormat($(_0x311a30(0x21e))['val'](),'/')));var _0x297c58=$('#attendance-reportFrom')['datepicker']('getDate'),_0x5a2c3a=$(_0x311a30(0x21e))[_0x311a30(0x1f5)](_0x311a30(0x244));days=(_0x5a2c3a-_0x297c58)/(0x3e8*0x3c*0x3c*0x18);var _0x1357eb=Math[_0x311a30(0x20a)](days);GOfficeDays=Math[_0x311a30(0x20a)](days),LoadAllOfficeLocation(),LoadAllDepartment(),LoadAllHolidays(),$('#SelectedLocation')[_0x311a30(0x1d9)]($(_0x311a30(0x1ae))['text']()),initializePeoplePicker(_0x311a30(0x1dc)),initializePeoplePicker(_0x311a30(0x256)),$(_0x311a30(0x23b))[_0x311a30(0x1f2)]('show');});function initializePeoplePicker(_0x505511){var _0x374bf0=a45_0xd0d100,_0xa31e43={};_0xa31e43[_0x374bf0(0x1f1)]=_0x374bf0(0x1ab),_0xa31e43[_0x374bf0(0x1a5)]=0xf,_0xa31e43[_0x374bf0(0x1de)]=0xf,_0xa31e43['AllowMultipleValues']=![],_0xa31e43[_0x374bf0(0x1c0)]=0x32,_0xa31e43[_0x374bf0(0x1e8)]=_0x374bf0(0x202),this['SPClientPeoplePicker_InitStandaloneControlWrapper'](_0x505511,null,_0xa31e43);}function ensureUser(_0x1c50ba){var _0xa9e2b9=a45_0xd0d100,_0x1919fb=0x0,_0x329230=_0x1c50ba,_0x48147d=this['SPClientPeoplePicker'][_0xa9e2b9(0x219)][_0x329230],_0x436eaf=_0x48147d[_0xa9e2b9(0x1e3)](),_0x34615d=_0x436eaf[0x0];if(_0x34615d){var _0x3ffa2b={'logonName':_0x34615d[_0xa9e2b9(0x24e)]};$['ajax']({'url':_spPageContextInfo['webAbsoluteUrl']+_0xa9e2b9(0x1c4),'type':_0xa9e2b9(0x213),'async':![],'contentType':_0xa9e2b9(0x22a),'data':JSON[_0xa9e2b9(0x1a2)](_0x3ffa2b),'headers':{'X-RequestDigest':$(_0xa9e2b9(0x1fe))['val'](),'accept':_0xa9e2b9(0x22a)},'success':function(_0x63990a,_0x30fe96,_0x23e197){_0x1919fb=_0x63990a['d']['Id'];},'error':function(_0x3bf5fe,_0xc269aa,_0x16117a){}});}else _0x1919fb=0x0;return _0x1919fb;}function GetUserTitle(_0x5708a2){var _0x2b9ef3=a45_0xd0d100,_0x40bf3a=0x0,_0x3fdf85=_0x5708a2,_0x36c81c=this['SPClientPeoplePicker']['SPClientPeoplePickerDict'][_0x3fdf85],_0x276eeb=_0x36c81c[_0x2b9ef3(0x1e3)](),_0x850f79=_0x276eeb[0x0];if(_0x850f79){var _0x11c6e6={'logonName':_0x850f79['Key']};$[_0x2b9ef3(0x1ac)]({'url':_spPageContextInfo[_0x2b9ef3(0x224)]+_0x2b9ef3(0x1c4),'type':_0x2b9ef3(0x213),'async':![],'contentType':_0x2b9ef3(0x22a),'data':JSON[_0x2b9ef3(0x1a2)](_0x11c6e6),'headers':{'X-RequestDigest':$(_0x2b9ef3(0x1fe))[_0x2b9ef3(0x1cd)](),'accept':_0x2b9ef3(0x22a)},'success':function(_0x24f2fe,_0x5ccd9c,_0x3c7420){var _0x5b7bae=_0x2b9ef3;_0x40bf3a=_0x24f2fe['d'][_0x5b7bae(0x257)];},'error':function(_0x59c796,_0x174741,_0x49b8f5){}});}else _0x40bf3a=0x0;return _0x40bf3a;}function ConvertDateTimeFormat(_0x4dff47,_0x18a05c){var _0x1cca46=a45_0xd0d100;return _0x4dff47[_0x1cca46(0x223)](_0x18a05c)[0x1]+''+_0x18a05c+''+_0x4dff47[_0x1cca46(0x223)](_0x18a05c)[0x0]+''+_0x18a05c+''+_0x4dff47[_0x1cca46(0x223)](_0x18a05c)[0x2];}function formatDateReport(_0xc14022){var _0x4d35a4=a45_0xd0d100,_0x30a2ff=new Date(_0xc14022);if(isNaN(_0x30a2ff[_0x4d35a4(0x25d)]()))return _0xc14022;else{var _0x26b7f8=new Array();return _0x26b7f8[0x0]='Jan',_0x26b7f8[0x1]=_0x4d35a4(0x260),_0x26b7f8[0x2]=_0x4d35a4(0x253),_0x26b7f8[0x3]=_0x4d35a4(0x232),_0x26b7f8[0x4]='May',_0x26b7f8[0x5]=_0x4d35a4(0x1a1),_0x26b7f8[0x6]=_0x4d35a4(0x25a),_0x26b7f8[0x7]='Aug',_0x26b7f8[0x8]='Sept',_0x26b7f8[0x9]=_0x4d35a4(0x1f4),_0x26b7f8[0xa]=_0x4d35a4(0x209),_0x26b7f8[0xb]=_0x4d35a4(0x1cc),day=_0x30a2ff[_0x4d35a4(0x244)](),day<0xa&&(day='0'+day),day+'\x20'+_0x26b7f8[_0x30a2ff[_0x4d35a4(0x1ce)]()]+'\x20'+_0x30a2ff['getFullYear']();}}function a45_0x87ef(){var _0x2d53e7=['application/json;odata=verbose','#ToDate','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>','show','grep','2617504kcwOoO','19419BimWYX','AttendanceItemId','Apr','18kcpYfK','\x27&$orderby=Title\x20asc&$top=5000','#OfficeLoc','NotActionDays','attr','#FromDate','<option\x20value=\x22All\x22>All</option>','getFullYear','#attendance-report-filter','HrAction','checked','<option\x20value=\x22','167409QLCKNy','log','ReportTableData','-7d','Rependrecord','getDate','black','join','includes','AttendanceType','OfficeLocation','sorter','desc','/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?select=*,ID,Title&$filter=OfficeLocationID\x20eq\x20\x27','dd/mm/yy','Key','This\x20feature\x20has\x20been\x20deactivated\x20!','2nd\x20Half','3470768gmsNaA','WorkHours','Mar','80345lMvCru','</div></td>','Employee','Title','#attendencedateValue','3108007MyrUgT','Jul','getQueryStringParameter','LogonName','getTime','\x27\x20and\x20CompanyID\x20eq\x20\x27','setDate','Feb','Jun','stringify','All','&start=','SearchPrincipalSource','AuthorId','/Pages/EmployeeReport.aspx?EID=','M\x20\x20yy','ModalDialog','Attendance\x20Entry','User,DL,SecGroup,SPGroup','ajax','#HolidaysTH','#OfficeLoc\x20option:selected','columns','btoa','message','\x27\x20class=\x27custom-edit-btn\x27><i\x20class=\x27fa\x20fa-chevron-right\x27></i></a></div></td>','#ReportTableData>tbody\x20>tr','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27','getElementById','webServerRelativeUrl','.NoRecordFound','nodeType','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000','AttendanceDate','#overlaysearch','#Manager','application/json;\x20odata=verbose','when','floor','MaximumEntitySuggestions','Holiday','On\x20Leave','GET','/_api/web/ensureuser','OfficeName','DD/MM/YYYY','__next','filter','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27>','value','formatDate','Dec','val','getMonth','&end=','</div>','Deferred','append','Repstartrecord','percentage','#TotalHolidays','values','&WebAppId=','1st\x20Half','text','and\x20Department\x20eq\x20\x27','/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,ManagerLoginName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,ManagerLoginName,OfficeLocation,Company,Department&$filter=Status\x20eq\x20\x27Active\x27\x20and\x20Company/ID\x20\x20eq\x20\x27','Manager','userId','ResolvePrincipalSource','AttendancDays','asc','Loading...','length','GetAllUserInfo','hide','empty','\x27\x20and\x20Holiday_start\x20ge\x20\x27','CompanyId','Width','<div\x20class=\x27upload-chip\x27>','ManagerLoginName','href','it\x20exceeds\x20the\x20list\x20view\x20threshold','format','indexOf','fadeIn','data:application/vnd.ms-excel;base64,','PrincipalAccountType','modal','\x27&$orderby=OfficeName\x20asc','Oct','datepicker','\x27\x20and\x20Employee\x20eq\x20\x27','fadeOut','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>0</div></td>','done','EmpWorkHours','promise','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27><a\x20href=\x27','UserId','#__REQUESTDIGEST','#officeLocTH','Department','<html\x20xmlns:o=\x22urn:schemas-microsoft-com:office:office\x22\x20xmlns:x=\x22urn:schemas-microsoft-com:office:excel\x22\x20xmlns=\x22http://www.w3.org/TR/REC-html40\x22><head><!--[if\x20gte\x20mso\x209]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>','280px','close','853530TtwkWU','MM/DD/YYYY','DepartmentName','results','#EdateTH','Nov','round','LeavesDay','replace','location','ready','appendTo','#attendance-reportFrom','00:00\x20(H:M)','error','POST','</option>','Full\x20Day','\x27\x20and\x20AttendanceDate\x20le\x20\x27','showWaitScreenWithNoClose','oddselected','SPClientPeoplePickerDict','YYYY-MM-DD','150dFHuwD','children','responseJSON','#attendance-reportTo','#chips','pagedropdown','push','innerHTML','split','webAbsoluteUrl','Active','#DepartmentDDL','evenselected','map','#ReportTable'];a45_0x87ef=function(){return _0x2d53e7;};return a45_0x87ef();}function LoadAllOfficeLocation(){var _0x2c6caf=a45_0xd0d100;$(_0x2c6caf(0x235))[_0x2c6caf(0x1e5)]();var _0x2294e4=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/GetByTitle(\x27OfficeLocation\x27)/items?$select=ID,OfficeName,CompanyID/ID&$expand=CompanyID&$top=5000&$filter=CompanyID/ID\x20eq\x20\x27'+GCompanyId+_0x2c6caf(0x1f3);$[_0x2c6caf(0x1ac)]({'url':_0x2294e4,'headers':{'Accept':_0x2c6caf(0x22a)},'async':![],'success':function(_0x24bf3f){var _0x4f1ec5=_0x2c6caf;for(var _0x3d3158=0x0;_0x3d3158<_0x24bf3f['d'][_0x4f1ec5(0x207)][_0x4f1ec5(0x1e2)];_0x3d3158++){$(_0x4f1ec5(0x235))[_0x4f1ec5(0x1d2)](_0x4f1ec5(0x23e)+_0x24bf3f['d'][_0x4f1ec5(0x207)][_0x3d3158]['ID']+'\x22>'+_0x24bf3f['d'][_0x4f1ec5(0x207)][_0x3d3158]['OfficeName']+_0x4f1ec5(0x214));}},'myError':function(_0x3e1a6d){}});}function LoadAllDepartment(){var _0x5d0a37=a45_0xd0d100;$(_0x5d0a37(0x226))[_0x5d0a37(0x1e5)]();var _0x579d38=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/getbytitle(\x27Departments\x27)/items?select=ID,Title&$filter=CompanyID\x20eq\x20\x27'+GCompanyId+_0x5d0a37(0x234);$[_0x5d0a37(0x1ac)]({'url':_0x579d38,'headers':{'Accept':_0x5d0a37(0x22a)},'async':!![],'success':function(_0x311b36){var _0x41a2c5=_0x5d0a37;$(_0x41a2c5(0x239))[_0x41a2c5(0x20f)](_0x41a2c5(0x226));for(var _0x47c7bf=0x0;_0x47c7bf<_0x311b36['d'][_0x41a2c5(0x207)]['length'];_0x47c7bf++){$(_0x41a2c5(0x226))[_0x41a2c5(0x1d2)](_0x41a2c5(0x23e)+_0x311b36['d']['results'][_0x47c7bf]['ID']+'\x22>'+_0x311b36['d'][_0x41a2c5(0x207)][_0x47c7bf]['Title']+_0x41a2c5(0x214));}},'myError':function(_0x2ba734){}});}function a45_0x2dda(_0x4655c3,_0x193f2e){var _0x87ef90=a45_0x87ef();return a45_0x2dda=function(_0x2dda59,_0x58e756){_0x2dda59=_0x2dda59-0x1a1;var _0x58496e=_0x87ef90[_0x2dda59];return _0x58496e;},a45_0x2dda(_0x4655c3,_0x193f2e);}var TotalOfficeDays=0x0,GtotalHolidays=0x0;function LoadAllHolidays(){var _0x3a3d32=a45_0xd0d100,_0x5e0901=$(_0x3a3d32(0x235))[_0x3a3d32(0x1cd)]();TotalOfficeDays=0x0,GtotalHolidays=0x0;var _0x17fcc7=new Date(ConvertDateTimeFormat($(_0x3a3d32(0x210))[_0x3a3d32(0x1cd)](),'/')),_0x321b28=_0x17fcc7[_0x3a3d32(0x23a)]()+'-'+(_0x17fcc7[_0x3a3d32(0x1ce)]()+0x1)+'-'+_0x17fcc7[_0x3a3d32(0x244)](),_0x196dd4=new Date(ConvertDateTimeFormat($(_0x3a3d32(0x21e))[_0x3a3d32(0x1cd)](),'/')),_0x189797=_0x196dd4['getFullYear']()+'-'+(_0x196dd4[_0x3a3d32(0x1ce)]()+0x1)+'-'+_0x196dd4[_0x3a3d32(0x244)](),_0x17c8f3=_spPageContextInfo[_0x3a3d32(0x224)]+_0x3a3d32(0x24c)+_0x5e0901+_0x3a3d32(0x25e)+GCompanyId+_0x3a3d32(0x1e6)+_0x321b28+'\x27\x20and\x20Holiday_start\x20le\x20\x27'+_0x189797+'\x27';$[_0x3a3d32(0x1ac)]({'url':_0x17c8f3,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x49b0f1){var _0x1391a7=_0x3a3d32,_0x383bf5=_0x49b0f1['d'][_0x1391a7(0x207)][_0x1391a7(0x1e2)];GtotalHolidays=_0x383bf5,$(_0x1391a7(0x1d5))[_0x1391a7(0x1d9)](_0x383bf5),$('#TotalOfficeDays')[_0x1391a7(0x1d9)](parseInt(GOfficeDays)-parseInt(_0x383bf5)),TotalOfficeDays=parseInt(GOfficeDays)-parseInt(_0x383bf5);},'myError':function(_0x4488de){}});}function Applyfilter(){var _0x3221fc=a45_0xd0d100;$('#FromDate')['text'](formatDateReport(ConvertDateTimeFormat($(_0x3221fc(0x210))[_0x3221fc(0x1cd)](),'/'))),$(_0x3221fc(0x22b))[_0x3221fc(0x1d9)](formatDateReport(ConvertDateTimeFormat($(_0x3221fc(0x21e))['val'](),'/'))),$('#SelectedLocation')[_0x3221fc(0x1d9)]($(_0x3221fc(0x1ae))['text']()),$('#FdateTH')[_0x3221fc(0x1d9)](formatDateReport(ConvertDateTimeFormat($(_0x3221fc(0x210))['val'](),'/'))),$(_0x3221fc(0x208))[_0x3221fc(0x1d9)](formatDateReport(ConvertDateTimeFormat($(_0x3221fc(0x21e))[_0x3221fc(0x1cd)](),'/'))),$(_0x3221fc(0x1ff))['text']($(_0x3221fc(0x1ae))[_0x3221fc(0x1d9)]()),$('#TotalWorkdayTH')[_0x3221fc(0x1d9)](TotalOfficeDays),$(_0x3221fc(0x1ad))['text'](GtotalHolidays);var _0x13da3e=$(_0x3221fc(0x210))['datepicker'](_0x3221fc(0x244)),_0x2f2e54=$(_0x3221fc(0x21e))[_0x3221fc(0x1f5)]('getDate');days=(_0x2f2e54-_0x13da3e)/(0x3e8*0x3c*0x3c*0x18),GOfficeDays=Math[_0x3221fc(0x20a)](days)+0x1,LoadAllHolidays(),$(_0x3221fc(0x258))[_0x3221fc(0x1cd)]('');var _0x14d9ae=$(_0x3221fc(0x210))[_0x3221fc(0x1cd)](),_0x7d40a8=moment($(_0x3221fc(0x210))['val'](),_0x3221fc(0x1c6))[_0x3221fc(0x1ed)](_0x3221fc(0x21a)),_0x3e244d=moment($(_0x3221fc(0x21e))[_0x3221fc(0x1cd)](),_0x3221fc(0x1c6))['format']('YYYY-MM-DD');$('#daydate')['text']($[_0x3221fc(0x1f5)][_0x3221fc(0x1cb)]('D,\x20dd',new Date(_0x7d40a8))),$('#monthhyear')[_0x3221fc(0x1d9)]($[_0x3221fc(0x1f5)][_0x3221fc(0x1cb)](_0x3221fc(0x1a8),new Date(_0x7d40a8)));var _0x5718c6='',_0x12e65b='';$('#OfficeLoc')[_0x3221fc(0x1cd)]()!=_0x3221fc(0x1a3)&&(_0x5718c6+='and\x20OfficeLocation\x20eq\x20\x27'+$('#OfficeLoc')[_0x3221fc(0x1cd)]()+'\x27\x20',_0x12e65b+=_0x3221fc(0x1e9)+$('#OfficeLoc\x20option:selected')[_0x3221fc(0x1d9)]()+'</div>');$('#DepartmentDDL')[_0x3221fc(0x1cd)]()!='All'&&(_0x5718c6+=_0x3221fc(0x1da)+$('#DepartmentDDL')[_0x3221fc(0x1cd)]()+'\x27\x20',_0x12e65b+=_0x3221fc(0x1e9)+$('#DepartmentDDL\x20option:selected')['text']()+_0x3221fc(0x1d0));var _0x2a3f03=ensureUser($('#Manager')[_0x3221fc(0x21c)]()[_0x3221fc(0x21c)]()[_0x3221fc(0x237)]('id')),_0x6b1db0=ensureUser($('#Employee')[_0x3221fc(0x21c)]()[_0x3221fc(0x21c)]()[_0x3221fc(0x237)]('id'));_0x2a3f03!=0x0&&(_0x5718c6+='and\x20ManagerLoginName\x20eq\x20\x27'+_0x2a3f03+'\x27\x20',_0x12e65b+=_0x3221fc(0x1e9)+GetUserTitle($(_0x3221fc(0x1bc))['children']()[_0x3221fc(0x21c)]()[_0x3221fc(0x237)]('id'))+_0x3221fc(0x1d0)),_0x6b1db0!=0x0&&(_0x5718c6+='and\x20LogonName/ID\x20eq\x20\x27'+_0x6b1db0+'\x27\x20',_0x12e65b+=_0x3221fc(0x1e9)+GetUserTitle($('#Employee')[_0x3221fc(0x21c)]()[_0x3221fc(0x21c)]()[_0x3221fc(0x237)]('id'))+_0x3221fc(0x1d0)),$(_0x3221fc(0x21f))[_0x3221fc(0x1e5)](),$(_0x3221fc(0x21f))['append'](_0x12e65b),$(_0x3221fc(0x1bb))[_0x3221fc(0x1ef)](),setTimeout(function(){var _0x11f306=_0x3221fc,_0x11e25b=_spPageContextInfo[_0x11f306(0x224)]+_0x11f306(0x1b4)+_0x7d40a8+'\x27\x20and\x20AttendanceDate\x20le\x20\x27'+_0x3e244d+'\x27\x20';$[_0x11f306(0x1be)](getFileData(_0x11e25b))[_0x11f306(0x1f9)](function(_0x5496be){var _0x487551=_0x11f306,_0x52065a=_spPageContextInfo['webAbsoluteUrl']+_0x487551(0x1db)+GCompanyId+'\x27'+_0x5718c6;EmployeeListDat(_0x52065a),$(_0x487551(0x1bb))[_0x487551(0x1f7)]();});},0x5dc);}var TempStore=[],unique='';function getFileData(_0x10dd0c){var _0x20414e=a45_0xd0d100;jQuery[_0x20414e(0x1ac)]({'url':_0x10dd0c,'headers':{'Accept':_0x20414e(0x22a)},'async':![],'success':function(_0x39b091){var _0x1f0649=_0x20414e;EmpAttendanceData=[];var _0x19d715=_0x39b091['d']['results'];if(_0x19d715[_0x1f0649(0x1e2)]>0x0){TempStore=[];for(var _0x79f188=0x0;_0x79f188<_0x19d715['length'];_0x79f188++){TempStore[_0x1f0649(0x221)](_0x19d715[_0x79f188][_0x1f0649(0x256)]['ID']);}unique=TempStore['filter'](function(_0x3a6d5d,_0x29a7a2,_0x15bc47){var _0x25ccd1=_0x1f0649;return _0x29a7a2==_0x15bc47[_0x25ccd1(0x1ee)](_0x3a6d5d);});if(unique[_0x1f0649(0x1e2)]>0x0){EmpAttendanceData=[];for(var _0x59a08a=0x0;_0x59a08a<unique[_0x1f0649(0x1e2)];_0x59a08a++){var _0x4cb785=0x0,_0x13839c=[],_0x45d4be=[],_0x221509=moment($(_0x1f0649(0x210))['val'](),_0x1f0649(0x1c6))[_0x1f0649(0x1ed)]('YYYY-MM-DD'),_0x347647=moment($(_0x1f0649(0x21e))[_0x1f0649(0x1cd)](),'DD/MM/YYYY')['format'](_0x1f0649(0x21a)),_0x1a217f=unique[_0x59a08a],_0x147b2a=_spPageContextInfo[_0x1f0649(0x224)]+_0x1f0649(0x1b4)+_0x221509+_0x1f0649(0x216)+_0x347647+_0x1f0649(0x1f6)+_0x1a217f+'\x27\x20';jQuery[_0x1f0649(0x1ac)]({'url':_0x147b2a,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x7ca8b8){var _0x3b7a66=_0x1f0649,_0x46be2d=_0x7ca8b8['d'][_0x3b7a66(0x207)];if(_0x46be2d[_0x3b7a66(0x1e2)]>0x0){for(var _0xe71a5d=0x0;_0xe71a5d<_0x46be2d[_0x3b7a66(0x1e2)];_0xe71a5d++){var _0x14a009=_0x46be2d[_0xe71a5d]['ID'],_0x1bf3c3=_0x46be2d[_0xe71a5d][_0x3b7a66(0x256)][_0x3b7a66(0x257)],_0x369c7c=_0x46be2d[_0xe71a5d]['Employee']['ID'],_0x5b6e6a=_0x46be2d[_0xe71a5d][_0x3b7a66(0x1ba)],_0x13113a=_0x46be2d[_0xe71a5d][_0x3b7a66(0x248)];if(_0x13113a==_0x3b7a66(0x215)||_0x13113a==_0x3b7a66(0x1d8)||_0x13113a==_0x3b7a66(0x250))_0x13839c['push'](_0x13113a);else _0x13113a=='On\x20Leave'&&_0x45d4be[_0x3b7a66(0x221)](_0x13113a);_0x46be2d[_0xe71a5d][_0x3b7a66(0x252)]!=null&&(_0x4cb785=parseInt(_0x4cb785)+parseInt(_0x46be2d[_0xe71a5d][_0x3b7a66(0x252)]));var _0x2e4a72=_0x46be2d[_0xe71a5d][_0x3b7a66(0x23c)],_0x3d23ab=parseInt(_0x13839c['length'])+parseInt(_0x45d4be[_0x3b7a66(0x1e2)]),_0x480494=parseInt(TotalOfficeDays)-parseInt(_0x3d23ab);_0x480494<0x0&&(_0x480494=0x0);}var _0x44746d=Math[_0x3b7a66(0x20a)](parseInt(_0x3d23ab)/parseInt(TotalOfficeDays)*0x64)+'%';TotalOfficeDays=='0'&&(_0x44746d='-'),EmpAttendanceData['push']({'UserId':_0x369c7c,'EmpName':_0x1bf3c3,'AttendanceDate':_0x5b6e6a,'AttendanceType':_0x13113a,'AttendanceItemId':_0x14a009,'EmpWorkHours':_0x4cb785,'HrAction':_0x2e4a72,'AttendancDays':_0x13839c[_0x3b7a66(0x1e2)],'LeavesDay':_0x45d4be[_0x3b7a66(0x1e2)],'NotActionDays':_0x480494,'percentage':_0x44746d});}},'error':function(_0x31d170,_0xbd804d){var _0x3310cf=_0x1f0649;console[_0x3310cf(0x240)](JSON[_0x3310cf(0x1a2)](_0x31d170));}});}}}},'error':function(_0x4e01db,_0x16d78f,_0x1d179b){var _0x46f6b4=_0x20414e;console[_0x46f6b4(0x240)]('Error\x20in\x20getFileData.'),console[_0x46f6b4(0x240)](_0x4e01db[_0x46f6b4(0x21d)]['error'][_0x46f6b4(0x1b1)]['value']);var _0x408115=_0x4e01db[_0x46f6b4(0x21d)][_0x46f6b4(0x212)]['message'][_0x46f6b4(0x1ca)],_0x2dcfd1=_0x408115[_0x46f6b4(0x247)](_0x46f6b4(0x1ec));_0x2dcfd1==!![]&&(AttendanceReportUsageData=[],AttendanceReportUsageUrl=_spPageContextInfo[_0x46f6b4(0x224)]+_0x46f6b4(0x1b9),ReadEmpReportUsageData());}});}var AttendanceReportUsageData=AttendanceReportUsageData||[],AttendanceReportUsageUrl='';function ReadEmpReportUsageData(){var _0x4b4b5c=a45_0xd0d100;return dfds=$[_0x4b4b5c(0x1d1)](),$['ajax']({'url':AttendanceReportUsageUrl,'headers':{'Accept':_0x4b4b5c(0x22a)},'async':![],'success':function(_0xa9ab1a){var _0xf8cdfb=_0x4b4b5c;FilterState=0x0,AttendanceReportUsageData=AttendanceReportUsageData['concat'](_0xa9ab1a['d']['results']);if(_0xa9ab1a['d'][_0xf8cdfb(0x1c7)])AttendanceReportUsageUrl=_0xa9ab1a['d'][_0xf8cdfb(0x1c7)],ReadEmpReportUsageData();else{if(AttendanceReportUsageData[_0xf8cdfb(0x1e2)]>0x0){var _0x5b75f5=moment(ConvertDateTimeFormat($(_0xf8cdfb(0x210))[_0xf8cdfb(0x1cd)](),'/'))[_0xf8cdfb(0x1ed)](_0xf8cdfb(0x205)),_0x1c123d=moment(ConvertDateTimeFormat($(_0xf8cdfb(0x21e))[_0xf8cdfb(0x1cd)](),'/'))[_0xf8cdfb(0x1ed)](_0xf8cdfb(0x205)),_0x42506e=AttendanceReportUsageData[_0xf8cdfb(0x1c8)](function(_0x25f6c1){var _0x4c97a9=_0xf8cdfb;return Created=moment(_0x25f6c1['AttendanceDate'])[_0x4c97a9(0x1ed)]('MM/DD/YYYY'),(_0x5b75f5==''?Created!='':Created>=_0x5b75f5)&&(_0x1c123d==''?Created!='':Created<=_0x1c123d);});AttendanceReportUsageData=_0x42506e;var _0x4ed9c6=[...new Map(AttendanceReportUsageData[_0xf8cdfb(0x228)](_0x59c8b3=>[_0x59c8b3[_0xf8cdfb(0x1a6)],_0x59c8b3]))[_0xf8cdfb(0x1d6)]()];TempStore=[];for(var _0x56c25e=0x0;_0x56c25e<AttendanceReportUsageData[_0xf8cdfb(0x1e2)];_0x56c25e++){TempStore[_0xf8cdfb(0x221)](AttendanceReportUsageData[_0x56c25e][_0xf8cdfb(0x256)]['ID']);}unique=TempStore[_0xf8cdfb(0x1c8)](function(_0x436d3b,_0x2ea0a4,_0x2fa551){var _0x95ce63=_0xf8cdfb;return _0x2ea0a4==_0x2fa551[_0x95ce63(0x1ee)](_0x436d3b);});if(unique[_0xf8cdfb(0x1e2)]>0x0){EmpAttendanceData=[];for(var _0x391cd6=0x0;_0x391cd6<unique[_0xf8cdfb(0x1e2)];_0x391cd6++){var _0x47dd14=0x0,_0xd3f4db=[],_0x32fcb4=[],_0x936554=moment($(_0xf8cdfb(0x210))[_0xf8cdfb(0x1cd)](),_0xf8cdfb(0x1c6))['format'](_0xf8cdfb(0x21a)),_0x42be9a=moment($(_0xf8cdfb(0x21e))['val'](),_0xf8cdfb(0x1c6))[_0xf8cdfb(0x1ed)](_0xf8cdfb(0x21a)),_0x164b1a=unique[_0x391cd6],_0x3edccf=$[_0xf8cdfb(0x22e)](AttendanceReportUsageData,function(_0x1275f6){var _0x2ab0c3=_0xf8cdfb;return _0x1275f6[_0x2ab0c3(0x256)]['ID']==_0x164b1a;}),_0x1e6615=_0x3edccf;if(_0x1e6615[_0xf8cdfb(0x1e2)]>0x0){for(var _0x4ddf9b=0x0;_0x4ddf9b<_0x1e6615[_0xf8cdfb(0x1e2)];_0x4ddf9b++){var _0x201fde=_0x1e6615[_0x4ddf9b]['ID'],_0x290437=_0x1e6615[_0x4ddf9b][_0xf8cdfb(0x256)][_0xf8cdfb(0x257)],_0x357343=_0x1e6615[_0x4ddf9b][_0xf8cdfb(0x256)]['ID'],_0x43d3ce=_0x1e6615[_0x4ddf9b][_0xf8cdfb(0x1ba)],_0x2d59ce=_0x1e6615[_0x4ddf9b]['AttendanceType'];if(_0x2d59ce=='Full\x20Day'||_0x2d59ce==_0xf8cdfb(0x1d8)||_0x2d59ce==_0xf8cdfb(0x250))_0xd3f4db[_0xf8cdfb(0x221)](_0x2d59ce);else _0x2d59ce==_0xf8cdfb(0x1c2)&&_0x32fcb4[_0xf8cdfb(0x221)](_0x2d59ce);_0x1e6615[_0x4ddf9b][_0xf8cdfb(0x252)]!=null&&(_0x47dd14=parseInt(_0x47dd14)+parseInt(_0x1e6615[_0x4ddf9b][_0xf8cdfb(0x252)]));var _0x481691=_0x1e6615[_0x4ddf9b]['HrAction'],_0x20f5ca=parseInt(_0xd3f4db[_0xf8cdfb(0x1e2)])+parseInt(_0x32fcb4[_0xf8cdfb(0x1e2)]),_0x508d3c=parseInt(TotalOfficeDays)-parseInt(_0x20f5ca);_0x508d3c<0x0&&(_0x508d3c=0x0);}var _0x35d587=Math[_0xf8cdfb(0x20a)](parseInt(_0x20f5ca)/parseInt(TotalOfficeDays)*0x64)+'%';TotalOfficeDays=='0'&&(_0x35d587='-'),EmpAttendanceData[_0xf8cdfb(0x221)]({'UserId':_0x357343,'EmpName':_0x290437,'AttendanceDate':_0x43d3ce,'AttendanceType':_0x2d59ce,'AttendanceItemId':_0x201fde,'EmpWorkHours':_0x47dd14,'HrAction':_0x481691,'AttendancDays':_0xd3f4db[_0xf8cdfb(0x1e2)],'LeavesDay':_0x32fcb4['length'],'NotActionDays':_0x508d3c,'percentage':_0x35d587});}}}}}},'error':function(_0x59e100,_0x3b45e1,_0x1b3802){}}),dfds[_0x4b4b5c(0x1fb)]();}function OpenMyCustomLoader(){var _0x5c8d12=a45_0xd0d100,_0x28740d=_0x5c8d12(0x1e1),_0x5038c6='<br\x20/>Please\x20wait!!',_0x47ed20=0xc8,_0x2bcbc3=0x190;currentDlg=SP['UI'][_0x5c8d12(0x1a9)][_0x5c8d12(0x217)](_0x28740d,_0x5038c6,_0x47ed20,_0x2bcbc3);}function CloseMyCustomLoader(){var _0x3c64eb=a45_0xd0d100;currentDlg[_0x3c64eb(0x203)]();}function EmployeeListDat(_0x1f11ac){var _0x5bc139=a45_0xd0d100;$[_0x5bc139(0x1ac)]({'url':_0x1f11ac,'headers':{'Accept':_0x5bc139(0x22a)},'async':![],'success':function(_0x5d150c){var _0x30094e=_0x5bc139,_0x330b21=_0x5d150c['d'][_0x30094e(0x207)];$(_0x30094e(0x229))[_0x30094e(0x1e5)]();var _0x40de2a='';if(_0x330b21[_0x30094e(0x1e2)]>0x0){var _0x292972=0x0,_0x2dec83=0x0,_0x28c434=0x0;for(var _0x3ef044=0x0;_0x3ef044<_0x330b21[_0x30094e(0x1e2)];_0x3ef044++){var _0x1073ea=_0x330b21[_0x3ef044]['ID'],_0x1a5ac0=_0x330b21[_0x3ef044][_0x30094e(0x25c)]['ID'],_0x1fedc0=_0x330b21[_0x3ef044][_0x30094e(0x25c)]['Title'],_0x5190d0=_0x330b21[_0x3ef044]['Designation'],_0x54f008=_0x330b21[_0x3ef044][_0x30094e(0x200)][_0x30094e(0x206)],_0xede406=_0x330b21[_0x3ef044][_0x30094e(0x1ea)]['Title'];_0xede406==undefined&&(_0xede406='');var _0x9a3da2=_0x30094e(0x211),_0x4fcd9e='',_0x1f681f=_0x30094e(0x245);_0x5190d0==null&&(_0x5190d0='');var _0x29d814=_0x330b21[_0x3ef044][_0x30094e(0x249)][_0x30094e(0x1c5)];_0x29d814==null&&(_0x29d814='');EmployeeId=_0x330b21[_0x3ef044]['LogonName']['ID'];var _0x3cfa8c=moment($(_0x30094e(0x210))[_0x30094e(0x1cd)](),_0x30094e(0x1c6))[_0x30094e(0x1ed)](_0x30094e(0x21a)),_0x431bd8=moment($(_0x30094e(0x21e))[_0x30094e(0x1cd)](),'DD/MM/YYYY')[_0x30094e(0x1ed)](_0x30094e(0x21a)),_0x3cfa8c=_0x3cfa8c[_0x30094e(0x223)]('-')[_0x30094e(0x246)](''),_0x431bd8=_0x431bd8['split']('-')[_0x30094e(0x246)](''),_0x3934cf=_spPageContextInfo[_0x30094e(0x1b6)]+_0x30094e(0x1a7)+_0x1a5ac0+_0x30094e(0x1a4)+_0x3cfa8c+_0x30094e(0x1cf)+_0x431bd8+_0x30094e(0x1d7)+titanForWork[_0x30094e(0x25b)](_0x30094e(0x1e7))+'&sourcelocation=../Pages/Report.aspx#',_0x30bba3=EmpAttendanceData['map'](function(_0x4ed32c){var _0x38df80=_0x30094e;return _0x4ed32c[_0x38df80(0x1fd)];})[_0x30094e(0x1ee)](EmployeeId);if(_0x30bba3!=-0x1){var _0x542477=EmpAttendanceData[_0x30bba3][_0x30094e(0x1fd)],_0x32bc5c=EmpAttendanceData[_0x30bba3]['AttendanceType'],_0x219479=EmpAttendanceData[_0x30bba3][_0x30094e(0x231)];_0x9a3da2=EmpAttendanceData[_0x30bba3][_0x30094e(0x1fa)];var _0x49c8f7=EmpAttendanceData[_0x30bba3][_0x30094e(0x1fa)];_0x4fcd9e=EmpAttendanceData[_0x30bba3][_0x30094e(0x231)];var _0x21caf1=EmpAttendanceData[_0x30bba3][_0x30094e(0x1df)],_0x2abcfe=EmpAttendanceData[_0x30bba3][_0x30094e(0x20b)],_0x559e5c=EmpAttendanceData[_0x30bba3][_0x30094e(0x236)],_0x3171ca=EmpAttendanceData[_0x30bba3][_0x30094e(0x1d4)],_0x4b0acf='';EmpAttendanceData[_0x30bba3][_0x30094e(0x23c)]==!![]?_0x4b0acf=_0x30094e(0x23d):_0x4b0acf='',_0x9a3da2==null&&(_0x9a3da2=_0x30094e(0x211)),_0x32bc5c==_0x30094e(0x1c2)&&(_0x1f681f='red',_0x28c434++),_0x32bc5c==_0x30094e(0x1c1)&&(_0x1f681f='blue'),_0x40de2a+='<tr\x20class=\x27text-center\x27>',_0x40de2a+=_0x30094e(0x1c9)+_0x1fedc0+_0x30094e(0x255),_0x40de2a+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x5190d0+_0x30094e(0x255),_0x40de2a+=_0x30094e(0x22c)+_0x54f008+'</div></td>',_0x40de2a+=_0x30094e(0x1c9)+_0xede406+'</div></td>',_0x40de2a+=_0x30094e(0x22c)+_0x21caf1+_0x30094e(0x255),_0x40de2a+=_0x30094e(0x22c)+_0x559e5c+_0x30094e(0x255),_0x40de2a+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x2abcfe+_0x30094e(0x255),_0x40de2a+=_0x30094e(0x22c)+ConvertHHMM(_0x9a3da2)+'</div></td>',_0x40de2a+=_0x30094e(0x22c)+_0x3171ca+'</div></td>',_0x40de2a+=_0x30094e(0x1fc)+_0x3934cf+_0x30094e(0x1b2),_0x40de2a+='</tr>';}else _0x40de2a+='<tr\x20class=\x27text-center\x27>',_0x40de2a+=_0x30094e(0x1c9)+_0x1fedc0+'</div></td>',_0x40de2a+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x5190d0+'</div></td>',_0x40de2a+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x54f008+'</div></td>',_0x40de2a+=_0x30094e(0x1c9)+_0xede406+_0x30094e(0x255),_0x40de2a+=_0x30094e(0x1f8),_0x40de2a+=_0x30094e(0x22c)+TotalOfficeDays+_0x30094e(0x255),_0x40de2a+=_0x30094e(0x1f8),_0x40de2a+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>00:00</div></td>',_0x40de2a+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>-</div></td>',_0x40de2a+=_0x30094e(0x1fc)+_0x3934cf+_0x30094e(0x1b2),_0x40de2a+='</tr>';}}else{}_0x330b21[_0x30094e(0x1e2)]==0x0?$(_0x30094e(0x1b7))[_0x30094e(0x22d)]():$('.NoRecordFound')[_0x30094e(0x1e4)]();$(_0x30094e(0x229))[_0x30094e(0x1d2)](_0x40de2a);var _0xa314d1=$(_0x30094e(0x1b3))['length'];$('#TotalItemscount')['text'](_0xa314d1),$('#totalemp')[_0x30094e(0x1d9)](_0xa314d1),_0xa314d1>0x0&&ReportTableConfiguration();},'error':function(_0x4403fb){var _0x51418f=_0x5bc139;console[_0x51418f(0x240)](_0x4403fb);}});}function ReportTableConfiguration(){var _0x525077=a45_0xd0d100;sorter=new TINY['table'][(_0x525077(0x24a))](_0x525077(0x24a),_0x525077(0x241),{'ascclass':_0x525077(0x1e0),'descclass':_0x525077(0x24b),'evenclass':'evenrow','oddclass':'oddrow','evenselclass':_0x525077(0x227),'oddselclass':_0x525077(0x218),'paginate':!![],'size':0xa,'colddid':_0x525077(0x1af),'currentid':'Repcurrentpage','totalid':'Reptotalpages','startingrecid':_0x525077(0x1d3),'endingrecid':_0x525077(0x243),'totalrecid':'Reptotalrecords','hoverid':'selectedrow','pageddid':_0x525077(0x220),'navid':'tablenav','sortdir':0x1,'init':!![]});}function ConvertHHMM(_0x4dace0){var _0x2067d2=a45_0xd0d100,_0x31af0e=Math[_0x2067d2(0x1bf)](_0x4dace0/0x3c),_0x44789d=_0x4dace0%0x3c;_0x31af0e<0xa&&(_0x31af0e='0'+_0x31af0e);_0x44789d<0xa&&(_0x44789d='0'+_0x44789d);var _0x2427b6=_0x31af0e+':'+_0x44789d;return _0x2427b6;}function CloseModel(){var _0xa0f38a=a45_0xd0d100;initializePeoplePicker(_0xa0f38a(0x1dc)),initializePeoplePicker(_0xa0f38a(0x256));}var tableToExcel=(function(){var _0x517201=a45_0xd0d100,_0x231c3d=_0x517201(0x1f0),_0x479978=_0x517201(0x201),_0x546613=function(_0x34ab82){var _0x21ba8d=_0x517201;return window[_0x21ba8d(0x1b0)](unescape(encodeURIComponent(_0x34ab82)));},_0x2c17d0=function(_0x1c9a9d,_0x258547){var _0x4290ec=_0x517201;return _0x1c9a9d[_0x4290ec(0x20c)](/{(\w+)}/g,function(_0x150000,_0x12fc82){return _0x258547[_0x12fc82];});};return function(_0x58ee00,_0x4c5797){var _0x498627=_0x517201;if(!_0x58ee00[_0x498627(0x1b8)])_0x58ee00=document[_0x498627(0x1b5)](_0x58ee00);var _0x32386d={'worksheet':_0x4c5797||'Worksheet','table':_0x58ee00[_0x498627(0x222)]};window[_0x498627(0x20d)][_0x498627(0x1eb)]=_0x231c3d+_0x546613(_0x2c17d0(_0x479978,_0x32386d));};}()),authentication=function(){var _0x3c6698=a45_0xd0d100,_0x5a7766=_spPageContextInfo['userDisplayName'],_0x4b8bef=_spPageContextInfo[_0x3c6698(0x224)]+'/_api/web/lists/getbytitle(\x27EnvironmentalSettings\x27)/items?$select=Title,Active,ListOfUsers/Title&$filter=Title\x20eq\x20\x27Attendance\x20Entry\x27\x20&$expand=ListOfUsers/Id';$[_0x3c6698(0x1ac)]({'url':_0x4b8bef,'async':![],'type':_0x3c6698(0x1c3),'headers':{'accept':_0x3c6698(0x1bd)},'success':function(_0x44fa7d){var _0xd47bd9=_0x3c6698;debugger;var _0x3c7b55=_0x44fa7d['d']['results'];if(_0x3c7b55['length']>0x0)for(var _0x20a780=0x0;_0x20a780<_0x3c7b55[_0xd47bd9(0x1e2)];_0x20a780++){if(_0x3c7b55[_0x20a780][_0xd47bd9(0x257)]==_0xd47bd9(0x1aa)){if(_0x3c7b55[_0x20a780][_0xd47bd9(0x225)]==![])return alert(_0xd47bd9(0x24f)),window[_0xd47bd9(0x20d)]=_spPageContextInfo[_0xd47bd9(0x224)]+'/Pages/Myworkplace.aspx?WebAppId=232SHDFGHJF22B2526DFG',![];}}},'error':function(_0x21b9d0){var _0x9d08f7=_0x3c6698;alert(JSON[_0x9d08f7(0x1a2)](_0x21b9d0));}});};