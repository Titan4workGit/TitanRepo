var a295_0x3b2f59=a295_0x10f2;(function(_0x4ec5b0,_0x10d51a){var _0x289f25=a295_0x10f2,_0x4084a8=_0x4ec5b0();while(!![]){try{var _0x53269d=-parseInt(_0x289f25(0xe5))/0x1+-parseInt(_0x289f25(0xf1))/0x2+-parseInt(_0x289f25(0xcd))/0x3*(-parseInt(_0x289f25(0xd1))/0x4)+-parseInt(_0x289f25(0x102))/0x5+parseInt(_0x289f25(0xb9))/0x6*(-parseInt(_0x289f25(0xfc))/0x7)+-parseInt(_0x289f25(0xed))/0x8*(-parseInt(_0x289f25(0xfd))/0x9)+parseInt(_0x289f25(0x100))/0xa;if(_0x53269d===_0x10d51a)break;else _0x4084a8['push'](_0x4084a8['shift']());}catch(_0x20ac7f){_0x4084a8['push'](_0x4084a8['shift']());}}}(a295_0x13dd,0x7a9f0));var itemid='';function a295_0x10f2(_0x589eaf,_0x1925fc){var _0x13dd35=a295_0x13dd();return a295_0x10f2=function(_0x10f24b,_0xbeaa29){_0x10f24b=_0x10f24b-0xb5;var _0x2da83c=_0x13dd35[_0x10f24b];return _0x2da83c;},a295_0x10f2(_0x589eaf,_0x1925fc);}$(document)[a295_0x3b2f59(0xd9)](function(){var _0x503e84=a295_0x3b2f59;$(_0x503e84(0xdb))['click'](function(){FindDuplicate();});});function FindDuplicate(){var _0x4b2310=a295_0x3b2f59,_0x162f52=titanForWork[_0x4b2310(0xd2)](_0x4b2310(0xd3)),_0x3a7aa8=![],_0xe3df18=$(_0x4b2310(0xf4))[_0x4b2310(0xbd)](),_0x753bca=$('#input1')[_0x4b2310(0xbd)](),_0x59e0c8=$(_0x4b2310(0xee))['val']();if(_0xe3df18[_0x4b2310(0xf0)]()['length']==0x0||_0x753bca[_0x4b2310(0xf0)]()[_0x4b2310(0xb8)]==0x0)return alert('Please\x20fill\x20all\x20required\x20fields.'),![];var _0x3b2d87=_0x162f52+'/_api/Web/Lists/getbytitle(\x27Magazine_items\x27)/Items?$filter=((Title\x20eq\x20\x27'+_0xe3df18+_0x4b2310(0xe4)+_0x753bca+_0x4b2310(0xbf);return itemid!=null&&(_0x3b2d87=_0x162f52+'/_api/Web/Lists/getbytitle(\x27Magazine_items\x27)/Items?$filter=((Title\x20eq\x20\x27'+_0xe3df18+_0x4b2310(0xe4)+_0x753bca+_0x4b2310(0xe0)+itemid+_0x4b2310(0xb6)),$[_0x4b2310(0x109)]({'url':_0x3b2d87,'type':'GET','cache':!![],'async':![],'headers':{'ACCEPT':_0x4b2310(0xe1)},'success':function(_0xb2e966){var _0x4b9c49=_0x4b2310;$(_0xb2e966['d'][_0x4b9c49(0xd0)])[_0x4b9c49(0xb8)]==0x0?(_0x3a7aa8=!![],AddCurrentUserasTechAdmin()):alert(_0x4b9c49(0xbc));},'error':function(){}}),_0x3a7aa8;}function AddCurrentUserasTechAdmin(){var _0x5125ac=a295_0x3b2f59,_0x380e16=$(_0x5125ac(0xf4))[_0x5125ac(0xbd)]()[_0x5125ac(0xf0)](),_0x118ef2=$('#input1')[_0x5125ac(0xbd)](),_0x3850e9=$(_0x5125ac(0xee))[_0x5125ac(0xbd)]()['trim'](),_0x297df5=new Date(_0x118ef2),_0x3e645e=_0x297df5[_0x5125ac(0xff)](),_0x392af3=_0x297df5['getMonth']()+0x1,_0x2cbdf1=_0x297df5[_0x5125ac(0xf9)](),_0x45e035=new Array();_0x45e035[_0x5125ac(0xd6)]();(_0x380e16==''||_0x118ef2=='')&&alert(_0x5125ac(0xda));var _0x3c89fe=_0x5125ac(0x105),_0x59a8dd,_0x89fd99='SP.Data.Magazine_x005f_ItemsListItem';_0x59a8dd={'__metadata':{'type':_0x89fd99},'Title':_0x380e16,'Publish_Date':_0x118ef2,'Volume':_0x3850e9,'Month':_0x392af3[_0x5125ac(0xde)](),'Year':_0x2cbdf1[_0x5125ac(0xde)]()};if(itemid==''){if($(_0x5125ac(0xc9))['val']()=='')return alert(_0x5125ac(0xc6)),![];if($(_0x5125ac(0xbe))[_0x5125ac(0xbd)]()=='')return alert('Please\x20attach\x20a\x20magazine.\x20'),![];$[_0x5125ac(0xf2)](AddItemToList(_0x3c89fe,_0x59a8dd))[_0x5125ac(0xd5)](function(_0x1843fe){var _0x1c1840=_0x5125ac;AddAttachments(_0x1843fe['d']['Id']),alert('Added\x20successfully.'),$('#input2')[_0x1c1840(0xbd)](''),$('#input1')['val'](''),$('#input')[_0x1c1840(0xbd)](''),location[_0x1c1840(0x103)]=_0x1c1840(0xb5);});}else $[_0x5125ac(0xf2)](updateMagazineItemWithID(_0x3c89fe,_0x59a8dd,itemid))[_0x5125ac(0xd5)](function(_0x4a435f){var _0x57e4ed=_0x5125ac;checkFileExists(itemid),alert(_0x57e4ed(0xbb)),$('#mazinemodle')['hide'](),$(_0x57e4ed(0xf4))['val'](''),$('#input1')[_0x57e4ed(0xbd)](''),$(_0x57e4ed(0xee))[_0x57e4ed(0xbd)](''),location[_0x57e4ed(0x103)]=_0x57e4ed(0xb5);});}function updateMagazineItemWithID(_0xd2e3b5,_0x43eed9,_0x3d5598){var _0x27b3e5=a295_0x3b2f59,_0x522c62=titanForWork[_0x27b3e5(0xd2)](_0x27b3e5(0xd3)),_0x38c09f=$['Deferred']();return $[_0x27b3e5(0x109)]({'url':_0x522c62+_0x27b3e5(0xcb)+_0xd2e3b5+_0x27b3e5(0xdc)+_0x3d5598+'\x27)','type':_0x27b3e5(0xc0),'headers':{'accept':_0x27b3e5(0xe1),'X-RequestDigest':$(_0x27b3e5(0xe9))['val'](),'content-Type':'application/json;odata=verbose','X-Http-Method':_0x27b3e5(0xc1),'If-Match':'*'},'data':JSON[_0x27b3e5(0xea)](_0x43eed9),'async':![],'success':function(_0x231ed9){var _0x535922=_0x27b3e5;_0x38c09f[_0x535922(0xc7)](!![]);},'error':function(_0xc74551){var _0x329775=_0x27b3e5;alert(JSON[_0x329775(0xea)](_0xc74551)),_0x38c09f[_0x329775(0xe6)](_0xc74551);}}),_0x38c09f['promise']();}function a295_0x13dd(){var _0x3aa9fa=['push','Volume','Error\x20occured.','ready','Fill\x20all\x20mandatory\x20fields!','#Submit','\x27)/GetItemById(\x27','/_api/web/lists/getbytitle(\x27Magazine_Items\x27)/items(\x27','toString','Deferred','\x27))and\x20ID\x20ne\x20\x27','application/json;odata=verbose','application/json;\x20odata=verbose','pop','\x27)\x20and\x20(Publish_Date\x20eq\x20\x27','505554inDKkb','reject','__REQUESTDIGEST','value','#__REQUESTDIGEST','stringify','/_api/web/lists/getbytitle(\x27Magazine_items\x27)/items?$select=','log','7064xYJiQT','#input','Save\x20img','trim','1431598hqQnVz','when','files','#input2','\x27)/AttachmentFiles/\x20add(FileName=\x27',')/AttachmentFiles/getByFileName(\x27','promise','\x27)?$select=*&$expand=AttachmentFiles','getFullYear','Attachments','Title','92519nrqAOX','9954XScqeH','webAbsoluteUrl','getDate','13428100bCdOEh','Failure\x20:\x20','2310950MjPGpH','href','name','Magazine_Items','FileName','ID,Title,Publish_Date,Volume,Month,Year&$filter=ID\x20eq\x20\x27','/_api/web/Lists/GetByTitle(\x27Magazine_items\x27)/Items(\x27','ajax','../Pages/MagazineViewAll.aspx?WebAppId=12','\x27&$expand=AttachmentFiles','readAsArrayBuffer','length','438aFcuJd','responseText','Updated\x20successfully.','Duplicate\x20Magazine\x20found.','val','#file2','\x27))&$expand=AttachmentFiles','POST','PATCH','#input1','/_api/contextinfo','target','AttachmentFiles','Please\x20attach\x20a\x20cover.\x20','resolve','result','#file1','#mazinemodle','/_api/web/lists/getbytitle(\x27','Save\x20pdf','2493696CZNpaP','Magazine_items','\x27)/items','results','4PsTlFN','getQueryStringParameter','CompanySiteUrl','Publish_Date','done'];a295_0x13dd=function(){return _0x3aa9fa;};return a295_0x13dd();}function AddItemToList(_0x50f949,_0xdbc4ea){var _0x316604=a295_0x3b2f59,_0xafa6aa=titanForWork[_0x316604(0xd2)]('CompanySiteUrl'),_0x2d4489=$[_0x316604(0xdf)]();return $[_0x316604(0x109)]({'url':_0xafa6aa+'/_api/web/lists/getbytitle(\x27'+_0x50f949+_0x316604(0xcf),'type':_0x316604(0xc0),'async':![],'headers':{'accept':_0x316604(0xe1),'X-RequestDigest':$(_0x316604(0xe9))[_0x316604(0xbd)](),'content-Type':_0x316604(0xe1)},'data':JSON[_0x316604(0xea)](_0xdbc4ea),'success':function(_0x2d956c){var _0x4de159=_0x316604;console['log'](_0x50f949),_0x2d4489[_0x4de159(0xc7)](_0x2d956c);},'error':function(_0x5330b4){var _0x324535=_0x316604;alert(_0x324535(0x101)+JSON[_0x324535(0xea)](_0x5330b4)),_0x2d4489[_0x324535(0xe6)](_0x5330b4);}}),_0x2d4489[_0x316604(0xf7)]();}function AddAttachments(_0x1e0433){var _0x1db18d=a295_0x3b2f59,_0x2a6eff=titanForWork[_0x1db18d(0xd2)](_0x1db18d(0xd3)),_0x1abe88='';$['ajax']({'url':_spPageContextInfo[_0x1db18d(0xfe)]+_0x1db18d(0xc3),'method':_0x1db18d(0xc0),'async':![],'headers':{'ACCEPT':_0x1db18d(0xe1),'content-type':_0x1db18d(0xe1)},'success':function(_0x181ac1){_0x1abe88=_0x181ac1['d']['GetContextWebInformation']['FormDigestValue'];},'error':function(_0x572f8c){}})[_0x1db18d(0xd5)](function(){var _0x32b3b6=_0x1db18d,_0x1e025a=$('#file1'),_0x257609=$(_0x32b3b6(0xc9))[_0x32b3b6(0xbd)]();if(_0x257609[_0x32b3b6(0xb8)]>0x0){var _0x4bdc66=_0x1e025a[0x0][_0x32b3b6(0xf3)][0x0][_0x32b3b6(0x104)],_0x4c6d19=new FileReader();_0x4c6d19['onload']=function(_0x3ca97d){var _0x4150e0=_0x32b3b6,_0x571113=_0x3ca97d[_0x4150e0(0xc4)][_0x4150e0(0xc8)],_0x3171b3=$[_0x4150e0(0x109)]({'url':_0x2a6eff+_0x4150e0(0xdd)+_0x1e0433+_0x4150e0(0xf5)+_0x4bdc66+'\x27)','method':_0x4150e0(0xc0),'binaryStringRequestBody':!![],'data':_0x571113,'processData':![],'async':![],'headers':{'ACCEPT':_0x4150e0(0xe1),'X-RequestDigest':_0x1abe88},'success':function(_0x47aafa){var _0x3ad06a=_0x4150e0;console[_0x3ad06a(0xec)](_0x3ad06a(0xef));},'error':function(_0xcc5a2c){var _0x237577=_0x4150e0;alert('Error\x20occured.'+_0xcc5a2c[_0x237577(0xba)]);}});};};_0x257609['length']>0x1&&_0x4c6d19[_0x32b3b6(0xb7)](_0x1e025a[0x0][_0x32b3b6(0xf3)][0x0]);})[_0x1db18d(0xd5)](function(){var _0x1a0749=_0x1db18d;debugger;var _0x4b9e46=$(_0x1a0749(0xbe)),_0x54f9ab=$(_0x1a0749(0xbe))[_0x1a0749(0xbd)]();if(_0x54f9ab[_0x1a0749(0xb8)]>0x1){var _0x53b269=_0x4b9e46[0x0][_0x1a0749(0xf3)][0x0]['name'],_0x239640=new FileReader();_0x239640['onload']=function(_0x4fee95){var _0x14b574=_0x1a0749,_0x79371b=_0x4fee95[_0x14b574(0xc4)][_0x14b574(0xc8)],_0x5a4089=$[_0x14b574(0x109)]({'url':_0x2a6eff+_0x14b574(0xdd)+_0x1e0433+'\x27)/AttachmentFiles/\x20add(FileName=\x27'+_0x53b269+'\x27)','method':_0x14b574(0xc0),'binaryStringRequestBody':!![],'data':_0x79371b,'processData':![],'async':![],'headers':{'ACCEPT':_0x14b574(0xe1),'X-RequestDigest':_0x1abe88},'success':function(_0x2610b7){var _0x5147cd=_0x14b574;console[_0x5147cd(0xec)](_0x5147cd(0xcc)+_0x2610b7);},'error':function(_0x5ed83a){var _0x167758=_0x14b574;alert(_0x167758(0xd8)+_0x5ed83a['responseText']);}});};};_0x54f9ab['length']>0x1&&_0x239640[_0x1a0749(0xb7)](_0x4b9e46[0x0][_0x1a0749(0xf3)][0x0]);});}function BindMagazine(_0x13364f){var _0x190a6c=a295_0x3b2f59;debugger;$(_0x190a6c(0xca))['modal'](),itemid=_0x13364f;var _0x39a1f3=titanForWork[_0x190a6c(0xd2)](_0x190a6c(0xd3)),_0x5d912d='';_0x5d912d=_0x190a6c(0x107)+itemid+'\x27';var _0x3a36da=_0x39a1f3+_0x190a6c(0xeb)+_0x5d912d;$[_0x190a6c(0x109)]({'url':_0x3a36da,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x26367b){var _0x1f0a1d=_0x190a6c,_0x51eaba=_0x26367b['d'][_0x1f0a1d(0xd0)];for(var _0x1ddf79=0x0;_0x1ddf79<_0x51eaba[_0x1f0a1d(0xb8)];_0x1ddf79++){var _0x1d2173=new Date(_0x51eaba[_0x1ddf79][_0x1f0a1d(0xd4)]),_0x4b899a=_0x1d2173[_0x1f0a1d(0xff)](),_0x24d5a7=_0x1d2173['getMonth']()+0x1,_0x22b984=_0x1d2173[_0x1f0a1d(0xf9)](),_0x5c1f0a=_0x24d5a7+'/'+_0x4b899a+'/'+_0x22b984,_0x3c6c1c=_0x51eaba[_0x1ddf79][_0x1f0a1d(0xfb)],_0x1bba8e=_0x5c1f0a[_0x1f0a1d(0xde)](),_0x1063a2=_0x51eaba[_0x1ddf79][_0x1f0a1d(0xd7)];$('#input2')[_0x1f0a1d(0xbd)](_0x3c6c1c),$('#input1')[_0x1f0a1d(0xbd)](_0x1bba8e),$(_0x1f0a1d(0xee))[_0x1f0a1d(0xbd)](_0x1063a2);}},'eror':function(_0xa89c59){var _0x5ed493=_0x190a6c;console[_0x5ed493(0xec)]('error');}});}function checkFileExists(_0x407159){var _0x2c6ac1=a295_0x3b2f59;Handler=this;var _0x8c44d2='',_0x4f0a15=titanForWork[_0x2c6ac1(0xd2)]('CompanySiteUrl');$[_0x2c6ac1(0x109)]({'url':_0x4f0a15+_0x2c6ac1(0x108)+_0x407159+_0x2c6ac1(0xf8),'method':'GET','headers':{'Accept':_0x2c6ac1(0xe2)},'async':![],'success':function(_0x2e7510){var _0x52a91d=_0x2c6ac1,_0xaa072c=_0x2e7510['d'];if(_0x2e7510['d'][_0x52a91d(0xfa)]==!![])for(var _0x56a567=0x0;_0x56a567<_0x2e7510['d']['AttachmentFiles'][_0x52a91d(0xd0)][_0x52a91d(0xb8)];_0x56a567++){var _0x58c730=$(_0x52a91d(0xc9))[_0x52a91d(0xbd)](),_0x1d6fcc=$(_0x52a91d(0xbe))[_0x52a91d(0xbd)](),_0x4b08ad=_0x2e7510['d'][_0x52a91d(0xc5)]['results'][_0x56a567][_0x52a91d(0x106)],_0x4bbf76=_0x4b08ad['split']('.')[_0x52a91d(0xe3)]();_0x4bbf76=='pdf'?_0x1d6fcc[_0x52a91d(0xb8)]>0x0&&DeleteFile(_0x407159,_0x2e7510['d'][_0x52a91d(0xc5)]['results'][_0x56a567][_0x52a91d(0x106)]):_0x58c730[_0x52a91d(0xb8)]>0x0&&DeleteFile(_0x407159,_0x2e7510['d'][_0x52a91d(0xc5)][_0x52a91d(0xd0)][_0x56a567]['FileName']);}AddAttachments(_0x407159);},'error':function(_0x2972ee){}});}function DeleteFile(_0x1ff727,_0x56f6f){var _0xa1bf47=a295_0x3b2f59;Handler=this;var _0x3db5b8=_0xa1bf47(0xce),_0x20a9d0=titanForWork[_0xa1bf47(0xd2)](_0xa1bf47(0xd3));$[_0xa1bf47(0x109)]({'url':_0x20a9d0+'/_api/web/lists/GetByTitle(\x27'+_0x3db5b8+'\x27)/GetItemById('+_0x1ff727+_0xa1bf47(0xf6)+_0x56f6f+'\x27)\x20\x20','method':'DELETE','async':![],'headers':{'X-RequestDigest':document['getElementById'](_0xa1bf47(0xe7))[_0xa1bf47(0xe8)]},'success':function(_0x5b6952){},'error':function(_0x14e66f){}});}function ClearFields(){var _0x353399=a295_0x3b2f59;$(_0x353399(0xf4))[_0x353399(0xbd)](''),$(_0x353399(0xc2))['val'](''),$(_0x353399(0xee))['val']('');}