var _0x298a69=_0x4fae;function _0x21d6(){var _0x2c76b0=['reject','12769910MoKBuM','click','results','ID,Title,Publish_Date,Volume,Month,Year&$filter=ID\x20eq\x20\x27','onload','#Submit','105fnBZOu','log','Magazine_items','Please\x20attach\x20a\x20magazine.\x20','Error\x20occured.','responseText','Magazine\x20updated\x20successfully.','getElementById','\x27))&$expand=AttachmentFiles','stringify','application/json;\x20odata=verbose','\x27)/GetItemById(\x27','GET','294126cwkbZj','application/json;odata=verbose','getDate','Deferred','#__REQUESTDIGEST','split','readAsArrayBuffer','#mazinemodle','\x27)\x20\x20','__REQUESTDIGEST','12693qDXpIa','Save\x20pdf','\x27)/GetItemById(','9vXjKJT','Title','Attachments','result','CompanySiteUrl','FormDigestValue','/_api/web/lists/GetByTitle(\x27','value','#file2','name','\x27))and\x20ID\x20ne\x20\x27','href','trim','files','#file1','/_api/web/lists/getbytitle(\x27','hide','GetContextWebInformation','error','val','Please\x20enter\x20Volume\x20!','\x27)\x20and\x20(Publish_Date\x20eq\x20\x27','when','resolve','FileName','631464zVbwnx','ajax','/_api/web/lists/getbytitle(\x27Magazine_Items\x27)/items(\x27','#input1','done','getMonth','ready','AttachmentFiles','79874iVmuUl','\x27)/AttachmentFiles/\x20add(FileName=\x27','\x27)?$select=*&$expand=AttachmentFiles','Failure\x20:\x20','15930GpSDRa','POST','length','436GmvqHj','2715576rXBdaz','Duplicate\x20Magazine\x20found.','getQueryStringParameter','pdf','toString','pop','promise','Please\x20fill\x20all\x20required\x20fields.','DELETE','/_api/Web/Lists/getbytitle(\x27Magazine_items\x27)/Items?$filter=((Title\x20eq\x20\x27','#input2','/_api/web/Lists/GetByTitle(\x27Magazine_items\x27)/Items(\x27','#input','Please\x20attach\x20a\x20cover.\x20','Fill\x20all\x20mandatory\x20fields!','\x27&$expand=AttachmentFiles','/_api/contextinfo','webAbsoluteUrl','PATCH'];_0x21d6=function(){return _0x2c76b0;};return _0x21d6();}(function(_0xd447a6,_0x982a4a){var _0x5ec6ed=_0x4fae,_0x4baadf=_0xd447a6();while(!![]){try{var _0x5560e8=parseInt(_0x5ec6ed(0x18c))/0x1+-parseInt(_0x5ec6ed(0x184))/0x2+parseInt(_0x5ec6ed(0x168))/0x3*(-parseInt(_0x5ec6ed(0x193))/0x4)+parseInt(_0x5ec6ed(0x1ae))/0x5*(parseInt(_0x5ec6ed(0x190))/0x6)+-parseInt(_0x5ec6ed(0x15e))/0x7+-parseInt(_0x5ec6ed(0x194))/0x8+parseInt(_0x5ec6ed(0x16b))/0x9*(parseInt(_0x5ec6ed(0x1a8))/0xa);if(_0x5560e8===_0x982a4a)break;else _0x4baadf['push'](_0x4baadf['shift']());}catch(_0x39673d){_0x4baadf['push'](_0x4baadf['shift']());}}}(_0x21d6,0x3e124));var itemid='';$(document)[_0x298a69(0x18a)](function(){var _0xbf09d7=_0x298a69;$(_0xbf09d7(0x1ad))[_0xbf09d7(0x1a9)](function(){FindDuplicate();});});function FindDuplicate(){var _0x51e542=_0x298a69,_0x712bcd=titanForWork[_0x51e542(0x196)]('CompanySiteUrl'),_0x16ea45=![],_0x21e418=$(_0x51e542(0x19e))[_0x51e542(0x17e)](),_0x2e05fb=$('#input1')[_0x51e542(0x17e)](),_0x1e6b2c=$(_0x51e542(0x1a0))['val']();if(_0x21e418[_0x51e542(0x177)]()[_0x51e542(0x192)]==0x0||_0x2e05fb['trim']()[_0x51e542(0x192)]==0x0)return alert(_0x51e542(0x19b)),![];if(_0x1e6b2c=='')return alert(_0x51e542(0x17f)),![];var _0xe1e246=_0x712bcd+_0x51e542(0x19d)+_0x21e418+_0x51e542(0x180)+_0x2e05fb+_0x51e542(0x159);return itemid!=null&&(_0xe1e246=_0x712bcd+'/_api/Web/Lists/getbytitle(\x27Magazine_items\x27)/Items?$filter=((Title\x20eq\x20\x27'+_0x21e418+'\x27)\x20and\x20(Publish_Date\x20eq\x20\x27'+_0x2e05fb+_0x51e542(0x175)+itemid+_0x51e542(0x1a3)),$['ajax']({'url':_0xe1e246,'type':_0x51e542(0x15d),'cache':!![],'async':![],'headers':{'ACCEPT':_0x51e542(0x15f)},'success':function(_0x496b52){var _0x4e6855=_0x51e542;$(_0x496b52['d'][_0x4e6855(0x1aa)])[_0x4e6855(0x192)]==0x0?(_0x16ea45=!![],AddCurrentUserasTechAdmin()):alert(_0x4e6855(0x195));},'error':function(){}}),_0x16ea45;}function AddCurrentUserasTechAdmin(){var _0xa567e5=_0x298a69,_0x343347=$(_0xa567e5(0x19e))[_0xa567e5(0x17e)]()[_0xa567e5(0x177)](),_0x48f778=$(_0xa567e5(0x187))[_0xa567e5(0x17e)](),_0x1d490c=$(_0xa567e5(0x1a0))[_0xa567e5(0x17e)]()['trim'](),_0x2c4655=new Date(_0x48f778),_0x251609=_0x2c4655['getDate'](),_0x55c685=_0x2c4655[_0xa567e5(0x189)]()+0x1,_0x58901c=_0x2c4655['getFullYear'](),_0x3ac1fa=new Array();_0x3ac1fa['push']();(_0x343347==''||_0x48f778=='')&&alert(_0xa567e5(0x1a2));var _0x2644b6='Magazine_Items',_0x41b36f,_0x1236b0='SP.Data.Magazine_x005f_ItemsListItem';_0x41b36f={'__metadata':{'type':_0x1236b0},'Title':_0x343347,'Publish_Date':_0x48f778,'Volume':_0x1d490c,'Month':_0x55c685[_0xa567e5(0x198)](),'Year':_0x58901c['toString']()};if(itemid==''){if($(_0xa567e5(0x179))['val']()=='')return alert(_0xa567e5(0x1a1)),![];if($(_0xa567e5(0x173))[_0xa567e5(0x17e)]()=='')return alert(_0xa567e5(0x1b1)),![];$[_0xa567e5(0x181)](AddItemToList(_0x2644b6,_0x41b36f))[_0xa567e5(0x188)](function(_0x1b3d84){var _0x492f6d=_0xa567e5;AddAttachments(_0x1b3d84['d']['Id']),alert('Magazine\x20added\x20successfully.'),$(_0x492f6d(0x19e))['val'](''),$(_0x492f6d(0x187))['val'](''),$('#input')[_0x492f6d(0x17e)](''),location[_0x492f6d(0x176)]='../Pages/MagazineViewAll.aspx?WebAppId=12';});}else $[_0xa567e5(0x181)](updateMagazineItemWithID(_0x2644b6,_0x41b36f,itemid))[_0xa567e5(0x188)](function(_0x541d03){var _0x17a08f=_0xa567e5;checkFileExists(itemid),alert(_0x17a08f(0x1b4)),$(_0x17a08f(0x165))[_0x17a08f(0x17b)](),$('#input2')[_0x17a08f(0x17e)](''),$('#input1')[_0x17a08f(0x17e)](''),$(_0x17a08f(0x1a0))['val']('');});}function updateMagazineItemWithID(_0x374e3c,_0x5716d7,_0x208e6a){var _0x5b1f51=_0x298a69,_0x273ff4=titanForWork[_0x5b1f51(0x196)](_0x5b1f51(0x16f)),_0x2c5166=$[_0x5b1f51(0x161)]();return $[_0x5b1f51(0x185)]({'url':_0x273ff4+_0x5b1f51(0x17a)+_0x374e3c+_0x5b1f51(0x15c)+_0x208e6a+'\x27)','type':'POST','headers':{'accept':_0x5b1f51(0x15f),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x5b1f51(0x17e)](),'content-Type':_0x5b1f51(0x15f),'X-Http-Method':_0x5b1f51(0x1a6),'If-Match':'*'},'data':JSON[_0x5b1f51(0x15a)](_0x5716d7),'async':![],'success':function(_0x5aa047){var _0x417a38=_0x5b1f51;_0x2c5166[_0x417a38(0x182)](!![]);},'error':function(_0x4e732c){var _0xad8197=_0x5b1f51;alert(JSON[_0xad8197(0x15a)](_0x4e732c)),_0x2c5166[_0xad8197(0x1a7)](_0x4e732c);}}),_0x2c5166[_0x5b1f51(0x19a)]();}function _0x4fae(_0x5ac545,_0x4dc5d7){var _0x21d62d=_0x21d6();return _0x4fae=function(_0x4fae2a,_0x45705c){_0x4fae2a=_0x4fae2a-0x159;var _0x1ac50a=_0x21d62d[_0x4fae2a];return _0x1ac50a;},_0x4fae(_0x5ac545,_0x4dc5d7);}function AddItemToList(_0x2a71ba,_0x2e7b70){var _0x29ecd1=_0x298a69,_0x56bec6=titanForWork['getQueryStringParameter'](_0x29ecd1(0x16f)),_0x271ee4=$['Deferred']();return $['ajax']({'url':_0x56bec6+_0x29ecd1(0x17a)+_0x2a71ba+'\x27)/items','type':_0x29ecd1(0x191),'async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x29ecd1(0x162))[_0x29ecd1(0x17e)](),'content-Type':'application/json;odata=verbose'},'data':JSON['stringify'](_0x2e7b70),'success':function(_0x2a9897){var _0x19fb9b=_0x29ecd1;console[_0x19fb9b(0x1af)](_0x2a71ba),_0x271ee4['resolve'](_0x2a9897);},'error':function(_0x300305){var _0x3dfecb=_0x29ecd1;alert(_0x3dfecb(0x18f)+JSON['stringify'](_0x300305)),_0x271ee4[_0x3dfecb(0x1a7)](_0x300305);}}),_0x271ee4[_0x29ecd1(0x19a)]();}function AddAttachments(_0x38736c){var _0x312340=_0x298a69,_0xc37bf5=titanForWork[_0x312340(0x196)](_0x312340(0x16f)),_0x34d64b='';$[_0x312340(0x185)]({'url':_spPageContextInfo[_0x312340(0x1a5)]+_0x312340(0x1a4),'method':_0x312340(0x191),'async':![],'headers':{'ACCEPT':_0x312340(0x15f),'content-type':_0x312340(0x15f)},'success':function(_0x982cd5){var _0x574277=_0x312340;_0x34d64b=_0x982cd5['d'][_0x574277(0x17c)][_0x574277(0x170)];},'error':function(_0xb79e14){}})[_0x312340(0x188)](function(){var _0x9b248e=_0x312340,_0x2f6656=$(_0x9b248e(0x179)),_0x2964cc=$(_0x9b248e(0x179))['val']();if(_0x2964cc[_0x9b248e(0x192)]>0x0){var _0xfa058f=_0x2f6656[0x0]['files'][0x0][_0x9b248e(0x174)],_0x944611=new FileReader();_0x944611['onload']=function(_0x4d8f67){var _0x160cb1=_0x9b248e,_0x1fac1c=_0x4d8f67['target'][_0x160cb1(0x16e)],_0x13e813=$['ajax']({'url':_0xc37bf5+_0x160cb1(0x186)+_0x38736c+_0x160cb1(0x18d)+_0xfa058f+'\x27)','method':'POST','binaryStringRequestBody':!![],'data':_0x1fac1c,'processData':![],'async':![],'headers':{'ACCEPT':'application/json;odata=verbose','X-RequestDigest':_0x34d64b},'success':function(_0x186c84){var _0x244b3b=_0x160cb1;console[_0x244b3b(0x1af)]('Save\x20img');},'error':function(_0x34fae2){var _0x4864d3=_0x160cb1;alert(_0x4864d3(0x1b2)+_0x34fae2[_0x4864d3(0x1b3)]);}});};};_0x2964cc[_0x9b248e(0x192)]>0x1&&_0x944611[_0x9b248e(0x164)](_0x2f6656[0x0][_0x9b248e(0x178)][0x0]);})[_0x312340(0x188)](function(){var _0x90f027=_0x312340;debugger;var _0x178276=$(_0x90f027(0x173)),_0x5d6e05=$('#file2')['val']();if(_0x5d6e05[_0x90f027(0x192)]>0x1){var _0x4ae0cb=_0x178276[0x0][_0x90f027(0x178)][0x0][_0x90f027(0x174)],_0x547038=new FileReader();_0x547038[_0x90f027(0x1ac)]=function(_0xcb0cef){var _0x46f25c=_0x90f027,_0x342ddc=_0xcb0cef['target']['result'],_0x3dbe45=$[_0x46f25c(0x185)]({'url':_0xc37bf5+_0x46f25c(0x186)+_0x38736c+_0x46f25c(0x18d)+_0x4ae0cb+'\x27)','method':'POST','binaryStringRequestBody':!![],'data':_0x342ddc,'processData':![],'async':![],'headers':{'ACCEPT':_0x46f25c(0x15f),'X-RequestDigest':_0x34d64b},'success':function(_0x405071){var _0x5cf7b8=_0x46f25c;console[_0x5cf7b8(0x1af)](_0x5cf7b8(0x169)+_0x405071);},'error':function(_0x2d3ef7){var _0x15f2fb=_0x46f25c;alert(_0x15f2fb(0x1b2)+_0x2d3ef7[_0x15f2fb(0x1b3)]);}});};};_0x5d6e05[_0x90f027(0x192)]>0x1&&_0x547038[_0x90f027(0x164)](_0x178276[0x0]['files'][0x0]);});}function BindMagazine(_0x450cdf){var _0x57bf68=_0x298a69;debugger;$(_0x57bf68(0x165))['modal'](),itemid=_0x450cdf;var _0x95f66=titanForWork[_0x57bf68(0x196)]('CompanySiteUrl'),_0x56b691='';_0x56b691=_0x57bf68(0x1ab)+itemid+'\x27';var _0x3a3fc3=_0x95f66+'/_api/web/lists/getbytitle(\x27Magazine_items\x27)/items?$select='+_0x56b691;$['ajax']({'url':_0x3a3fc3,'headers':{'Accept':_0x57bf68(0x15f)},'async':![],'success':function(_0x2fd434){var _0x390a46=_0x57bf68,_0x387bc1=_0x2fd434['d'][_0x390a46(0x1aa)];for(var _0x29cc07=0x0;_0x29cc07<_0x387bc1[_0x390a46(0x192)];_0x29cc07++){var _0x4c774f=new Date(_0x387bc1[_0x29cc07]['Publish_Date']),_0x4fb26a=_0x4c774f[_0x390a46(0x160)](),_0x2dc652=_0x4c774f[_0x390a46(0x189)]()+0x1,_0x315624=_0x4c774f['getFullYear'](),_0x21a1c1=_0x2dc652+'/'+_0x4fb26a+'/'+_0x315624,_0x4aa698=_0x387bc1[_0x29cc07][_0x390a46(0x16c)],_0x43e1d8=_0x21a1c1[_0x390a46(0x198)](),_0x6402d1=_0x387bc1[_0x29cc07]['Volume'];$(_0x390a46(0x19e))[_0x390a46(0x17e)](_0x4aa698),$(_0x390a46(0x187))['val'](_0x43e1d8),$(_0x390a46(0x1a0))['val'](_0x6402d1);}},'eror':function(_0x2208f9){var _0x19efa3=_0x57bf68;console['log'](_0x19efa3(0x17d));}});}function checkFileExists(_0xa326f1){var _0x479be9=_0x298a69;Handler=this;var _0x10a5d1='',_0x70f4be=titanForWork[_0x479be9(0x196)](_0x479be9(0x16f));$[_0x479be9(0x185)]({'url':_0x70f4be+_0x479be9(0x19f)+_0xa326f1+_0x479be9(0x18e),'method':_0x479be9(0x15d),'headers':{'Accept':_0x479be9(0x15b)},'async':![],'success':function(_0x3b5043){var _0x511299=_0x479be9,_0x34c3e3=_0x3b5043['d'];if(_0x3b5043['d'][_0x511299(0x16d)]==!![])for(var _0x10be6b=0x0;_0x10be6b<_0x3b5043['d']['AttachmentFiles'][_0x511299(0x1aa)]['length'];_0x10be6b++){var _0x844c35=$(_0x511299(0x179))['val'](),_0x4e10b7=$(_0x511299(0x173))[_0x511299(0x17e)](),_0x300cd6=_0x3b5043['d']['AttachmentFiles'][_0x511299(0x1aa)][_0x10be6b][_0x511299(0x183)],_0x27ef86=_0x300cd6[_0x511299(0x163)]('.')[_0x511299(0x199)]();_0x27ef86==_0x511299(0x197)?_0x4e10b7[_0x511299(0x192)]>0x0&&DeleteFile(_0xa326f1,_0x3b5043['d'][_0x511299(0x18b)][_0x511299(0x1aa)][_0x10be6b]['FileName']):_0x844c35[_0x511299(0x192)]>0x0&&DeleteFile(_0xa326f1,_0x3b5043['d'][_0x511299(0x18b)][_0x511299(0x1aa)][_0x10be6b][_0x511299(0x183)]);}AddAttachments(_0xa326f1);},'error':function(_0x5aaecb){}});}function DeleteFile(_0x3d418b,_0x3102f6){var _0x3dd56a=_0x298a69;Handler=this;var _0x646aea=_0x3dd56a(0x1b0),_0x412bed=titanForWork[_0x3dd56a(0x196)](_0x3dd56a(0x16f));$[_0x3dd56a(0x185)]({'url':_0x412bed+_0x3dd56a(0x171)+_0x646aea+_0x3dd56a(0x16a)+_0x3d418b+')/AttachmentFiles/getByFileName(\x27'+_0x3102f6+_0x3dd56a(0x166),'method':_0x3dd56a(0x19c),'async':![],'headers':{'X-RequestDigest':document[_0x3dd56a(0x1b5)](_0x3dd56a(0x167))[_0x3dd56a(0x172)]},'success':function(_0x4ab5bb){},'error':function(_0x269404){}});}function ClearFields(){var _0x16ec37=_0x298a69;$(_0x16ec37(0x19e))[_0x16ec37(0x17e)](''),$(_0x16ec37(0x187))[_0x16ec37(0x17e)](''),$(_0x16ec37(0x1a0))[_0x16ec37(0x17e)]('');}